;(function(e,t,n){function i(n,s){if(!t[n]){if(!e[n]){var o=typeof require=="function"&&require;if(!s&&o)return o(n,!0);if(r)return r(n,!0);throw new Error("Cannot find module '"+n+"'")}var u=t[n]={exports:{}};e[n][0].call(u.exports,function(t){var r=e[n][1][t];return i(r?r:t)},u,u.exports)}return t[n].exports}var r=typeof require=="function"&&require;for(var s=0;s<n.length;s++)i(n[s]);return i})({1:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  ComponentRegistry,
  webAliases,
  nodeAliases
) {
  var c = new ComponentRegistry();


  c.registerMany([
    {
      module: require("./util/component-loader"),
      as: "component-loader"
    },

    {
      module: require("./util/periodic"),
      as: "periodic"
    },

    {
      module: require("./util/retryable"),
      as: "retryable"
    },

    {
      module: require("./util/timer"),
      as: "timer"
    },

    {
      module: require("./core/dispatcher"),
      as: "dispatcher"
    },

    {
      module: require("./core/countdown-latch"),
      as: "countdown-latch"
    },

    {
      module: require("./core/options"),
      as: "options"
    },

    {
      module: require("./core/lang"),
      as: "lang"
    },

    {
      module: require("./core/ref"),
      as: "ref"
    },

    {
      module: require("./core/state-guard"),
      as: "state-guard"
    },


    {
      module: require("./core/pub-sub"),
      as: "pub-sub"
    },

    {
      module: require("./core/sequencer/unit-sequencer"),
      as: ["unit-sequencer", "sequencer"]
    },


    {
      module: require("./core/sequencer/clock-sequencer"),
      as: "clock-sequencer"
    },

    {
      module: require("./core/sequencer/delegating-composite-sequencer"),
      as: "delegating-composite-sequencer"
    },

    {
      module: require("./core/sequencer/delegating-forwarding-sequencer"),
      as: "delegating-forwarding-sequencer"
    },

    {
      module: require("./collection/doubly-linked-list"),
      as: "doubly-linked-list"
    },

    {
      module: require("./collection/object-hash-map"),
      as: ["hash-map", "object-hash-map"]
    },

    {
      module: require("./collection/lru-hash-map"),
      as: "lru-hash-map"
    },

    {
      module: require("./storage/caching-data-store"),
      as: "caching-data-store"
    },

    {
      module: require("./storage/in-memory-data-store"),
      as: "in-memory-data-store"
    },

    {
      module: require("./storage/lru-data-store"),
      as: "lru-data-store"
    },

    {
      module: require("./storage/signaling-data-store"),
      as: "signaling-data-store"
    },

    {
      module: require("./time/clock/logical-clock"),
      as: "logical-clock"
    },

    {
      module: require("./time/clock/system-clock"),
      as: "system-clock"
    },

    {
      module: require("./appkit/configuration-magic"),
      as: "configuration-magic"
    },

    {
      module: require("./appkit/config/scoped-configuration-resolver"),
      as: "scoped-configuration-resolver"
    },

    {
      module: require("./appkit/config/scoped-configuration"),
      as: ["scoped-configuration", "config/scoped-configuration"]
    },

    {
      module: require("./appkit/app"),
      as: "app"
    },

    {
      module: require("./runtime"),
      as: "runtime"
    },

    {
      module: require("./core/logging/logger"),
      as: "logger"
    },

    {
      module: require("./core/logging/appenders/console-log-appender"),
      as: ["appenders/console-log", "console-log-appender"]
    },

    {
      module: require("./core/channel/channel"),
      as: "channel"
    },

    {
      module: require("./core/channel/chained-channel"),
      as: "chained-channel"
    },

    {
      module: require("./core/channel/composite-channel"),
      as: "composite-channel"
    },

    {
      module: require("./messaging/exchange"),
      as: "messaging/exchange"
    },

    {
      module: require("./messaging/courier"),
      as: "messaging/courier"
    },

    {
      module: require("./messaging/fiber/in-memory-fiber"),
      as: "messaging/fibers/in-memory"
    },

    {
      module: require("./messaging/fiber/linkable-fiber"),
      as: "messaging/fibers/linkable"
    },

    {
      module: require("./core/uuid"),
      as: "uuid"
    },

    {
      module: require("./core/serde/json-serde"),
      as: ["serde/json", "json-serde"]
    }
  ]);

  c.selfRegister({
    as: "component-registry"
  });

  webAliases(c);
  nodeAliases(c);

  return c;
};

var g = (typeof window === "undefined" ? {} : window);
g.thicket = module.exports = mod(
  require("./util/component-registry"),
  require("./web"),
  require("./node")
);

})()
},{"./util/component-loader":2,"./util/periodic":3,"./util/retryable":4,"./core/dispatcher":5,"./core/countdown-latch":6,"./util/timer":7,"./core/options":8,"./core/state-guard":9,"./core/lang":10,"./core/pub-sub":11,"./core/sequencer/clock-sequencer":12,"./core/sequencer/delegating-composite-sequencer":13,"./core/sequencer/unit-sequencer":14,"./core/sequencer/delegating-forwarding-sequencer":15,"./collection/doubly-linked-list":16,"./collection/object-hash-map":17,"./storage/caching-data-store":18,"./storage/in-memory-data-store":19,"./collection/lru-hash-map":20,"./storage/signaling-data-store":21,"./storage/lru-data-store":22,"./time/clock/logical-clock":23,"./time/clock/system-clock":24,"./appkit/configuration-magic":25,"./appkit/config/scoped-configuration-resolver":26,"./appkit/config/scoped-configuration":27,"./appkit/app":28,"./core/logging/logger":29,"./core/logging/appenders/console-log-appender":30,"./core/channel/channel":31,"./core/channel/chained-channel":32,"./messaging/exchange":33,"./core/channel/composite-channel":34,"./messaging/courier":35,"./messaging/fiber/in-memory-fiber":36,"./messaging/fiber/linkable-fiber":37,"./core/uuid":38,"./core/serde/json-serde":39,"./util/component-registry":40,"./node":41,"./web":42,"./core/ref":43,"./runtime":44}],41:[function(require,module,exports){
module.exports = function(c) {};

},{}],42:[function(require,module,exports){
module.exports = function(c) {
  c.registerMany([
    {
      module: require("./appkit/bootstrapper"),
      as: "bootstrapper"
    },
    {
      module: require("./appkit/web-app-container"),
      as: "app-container"
    },
    {
      module: require("./scheduler/web-scheduler"),
      as: "scheduler"
    }
  ]);

  require("./browserify2-list");
};

},{"./appkit/bootstrapper":45,"./appkit/web-app-container":46,"./scheduler/web-scheduler":47,"./browserify2-list":48}],44:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

module.exports = require("./default-runtime");

})()
},{"./default-runtime":49}],48:[function(require,module,exports){
(function(){require("./runtime/default-runtime.js");
require("./runtime/index.js");
require("./node.js");
require("./core/serde/json-serde.js");
require("./core/uuid.js");
require("./core/logging/logger.js");
require("./core/logging/appenders/console-log-appender.js");
require("./core/options.js");
require("./core/pub-sub.js");
require("./core/dispatcher.js");
require("./core/ref/delegating-ref.js");
require("./core/ref/ref.js");
require("./core/ref/index.js");
require("./core/sequencer/delegating-forwarding-sequencer.js");
require("./core/sequencer/clock-sequencer.js");
require("./core/sequencer/unit-sequencer.js");
require("./core/sequencer/delegating-composite-sequencer.js");
require("./core/state-guard.js");
require("./core/scheduler/set-timeout-scheduler.js");
require("./core/countdown-latch.js");
require("./core/lang.js");
require("./core/channel/chained-channel.js");
require("./core/channel/channel.js");
require("./core/channel/composite-channel.js");
require("./web.js");
require("./storage/signaling-data-store.js");
require("./storage/lru-data-store.js");
require("./storage/in-memory-data-store.js");
require("./storage/internals/expiring-entry.js");
require("./storage/caching-data-store.js");
require("./util/component-loader.js");
require("./util/component-registry.js");
require("./util/timer.js");
require("./util/retryable.js");
require("./util/periodic.js");
require("./messaging/internals/mailbox.js");
require("./messaging/courier.js");
require("./messaging/fiber/linkable-fiber.js");
require("./messaging/fiber/in-memory-fiber.js");
require("./messaging/exchange.js");
require("./appkit/app.js");
require("./appkit/internal/process-keep-alive.js");
require("./appkit/config/scoped-configuration-resolver.js");
require("./appkit/config/scoped-configuration.js");
require("./appkit/web-app-container.js");
require("./appkit/configuration-magic.js");
require("./appkit/bootstrapper.js");
require("./scheduler/web-scheduler.js");
require("./scheduler/index.js");
require("./index.js");
require("./time/clock/logical-clock.js");
require("./time/clock/system-clock.js");
require("./collection/lru-hash-map.js");
require("./collection/object-hash-map.js");
require("./collection/doubly-linked-list.js");

})()
},{"./runtime/default-runtime.js":49,"./runtime/index.js":44,"./node.js":41,"./core/serde/json-serde.js":39,"./core/uuid.js":38,"./core/logging/logger.js":29,"./core/logging/appenders/console-log-appender.js":30,"./core/options.js":8,"./core/pub-sub.js":11,"./core/dispatcher.js":5,"./core/ref/delegating-ref.js":50,"./core/ref/ref.js":51,"./core/ref/index.js":43,"./core/sequencer/delegating-forwarding-sequencer.js":15,"./core/sequencer/clock-sequencer.js":12,"./core/sequencer/unit-sequencer.js":14,"./core/sequencer/delegating-composite-sequencer.js":13,"./core/state-guard.js":9,"./core/scheduler/set-timeout-scheduler.js":52,"./core/countdown-latch.js":6,"./core/lang.js":10,"./core/channel/chained-channel.js":32,"./core/channel/channel.js":31,"./core/channel/composite-channel.js":34,"./storage/signaling-data-store.js":21,"./web.js":42,"./storage/lru-data-store.js":22,"./storage/in-memory-data-store.js":19,"./storage/internals/expiring-entry.js":53,"./storage/caching-data-store.js":18,"./util/component-loader.js":2,"./util/component-registry.js":40,"./util/retryable.js":4,"./util/timer.js":7,"./util/periodic.js":3,"./messaging/courier.js":35,"./messaging/internals/mailbox.js":54,"./messaging/fiber/linkable-fiber.js":37,"./messaging/exchange.js":33,"./messaging/fiber/in-memory-fiber.js":36,"./appkit/app.js":28,"./appkit/internal/process-keep-alive.js":55,"./appkit/config/scoped-configuration-resolver.js":26,"./appkit/config/scoped-configuration.js":27,"./appkit/web-app-container.js":46,"./appkit/configuration-magic.js":25,"./appkit/bootstrapper.js":45,"./scheduler/web-scheduler.js":47,"./scheduler/index.js":56,"./index.js":1,"./time/clock/logical-clock.js":23,"./time/clock/system-clock.js":24,"./collection/lru-hash-map.js":20,"./collection/object-hash-map.js":17,"./collection/doubly-linked-list.js":16}],2:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var factory = function(
  _,
  Options
) {
  var ComponentLoader = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(ComponentLoader.prototype, {
    initialize: function(requireFun) {
      this._requireFun = requireFun;
      this._aliases = {};
      this._pathTransform = function(id) { return id;};
    },

    setPathTransform: function(pathTransform) {
      this._pathTransform = pathTransform;
      return this;
    },

    alias: function(opts) {
      opts = Options.fromObject(opts);
      var aliasName  = opts.getOrError("as");
      this._aliases[aliasName] = opts.getOrError("module");
    },

    bulkAlias: function(aliases) {
      _.each(aliases, function(aliasNames, moduleName) {
        if (!_.isArray(aliasNames)) {
          aliasNames = [aliasNames]
        }
        _.each(aliasNames, function(aliasName) {
          this.alias({module: moduleName, as: aliasName});
        }, this);
      }, this);
    },

    component: function(alias) {
      var mod = this._aliases[alias];
      if (!mod) {
        throw new Error("Invalid alias provided (no such module): `"+alias+"'");
      }
      return this._requireFun(this._pathTransform(mod));
    },

    c: function(alias) {
      return this.component.apply(this, arguments);
    }
  });

  return ComponentLoader;
};

module.exports = factory(
  require("underscore"),
  require("../core/options")
);

})()
},{"../core/options":8,"underscore":57}],4:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options,
  Lang,
  StateGuard,
  Logger
) {

  var Log = Logger.create("Retryable");

  var Retryable = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Retryable.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._scheduler  = opts.getOrError("scheduler");
      this._task       = opts.getOrError("task");
      // If not provided, go on forever.
      this._retries    = opts.getOrElse("retries");
      this._currentTry = 0;
      this._deferred   = Lang.deferred();

      var backoff = Options.fromObject(opts.getOrElseFn("backoff", function() {
        return {
          strategy: Retryable.Backoff.Linear,
          factor: 1,
          coefficient: 250
        };
      }));

      var StrategyClass = BackoffStrategy[backoff.getOrError("strategy")];

      this._backoffStrategy = new StrategyClass(backoff.toObject());
      this._disposedGuard   = StateGuard.scoped("disposed");

      _.bindAll(this, "_attempt");
      this._currentRun = null;
      this._scheduler.get().runSoon(this._attempt);
    },

    dispose: function() {
      if (this._disposedGuard.applied()) {
        return;
      }

      if (this._currentRun) {
        this._currentRun.cancel(new Retryable.Error.DisposedError());
        this._currentRun = null;
      }

      this._task = null;

      this._disposedGuard.apply();
    },

    result: function() {
      return this._deferred.promise;
    },

    _attempt: function() {
      if (this._disposedGuard.applied()) {
        return;
      }

      this._currentRun = Promise
        .bind(this)
        .cancellable()
        .then(function() {
          return this._task();
        })
        .then(function(result) {
          if (this._deferred.promise.isPending()) {
            this._deferred.resolve(result);
          }
        })
        .caught(Retryable.Error.DisposedError, function() {
          this._deferred.promise.cancel(new Promise.CancellationError());
        })
        .caught(function(err) {
          if (this._disposedGuard.applied()) {
            Log.warn("Caught retryable run error, but retryable is already disposed");
            return;
          }

          Log.debug("Received error in attempt", this._currentTry);
          var nextTry = this._currentTry + 1;

          if (this._retries >= 0 && nextTry > this._retries) {
            Log.debug("Hit max number of retries:", this._retries);
            var e = new Retryable.Error.MaxRetriesError();
            e.cause = err;
            throw e;
          }

          // Schedule us up to try again;
          this._currentRun = null;
          this._currentTry = nextTry;

          var time = this._backoffStrategy.time(this._currentTry);
          this._scheduler.get().schedule(this._attempt, time);
        })
        .caught(Retryable.Error.MaxRetriesError, function(err) {
          if (this._deferred.promise.isPending()) {
            this._deferred.reject(err.cause);
          }
        });
    }
  });

  _.extend(Retryable, {
    Backoff: {
      Linear:      "linear",
      Exponential: "exponential"
    },
    Error: {
      DisposedError: Lang.makeErrorClass("DisposedError", "Retryable was disposed"),
      MaxRetriesError: Lang.makeErrorClass("MaxRetriesError", "Retryable was retried too many times")
    }
  })

  var BackoffStrategy = (function() {
    var Linear = function() {
      this.initialize.apply(this, arguments);
    };

    _.extend(Linear.prototype, {
      initialize: function(opts) {
        opts = Options.fromObject(opts);
        this._factor        = opts.getOrElse("factor", 1);
        this._coefficient   = opts.getOrElse("coefficient", 250);
      },

      time: function(iteration) {
        return this._factor * this._coefficient * iteration;
      }
    });

    var Exponential = function() {
      this.initialize.apply(this, arguments);
    };

    _.extend(Exponential.prototype, {
      initialize: function(opts) {
        opts = Options.fromObject(opts);

        this._base        = opts.getOrElse("base", 2);
        this._coefficient = opts.getOrElse("coefficient", 250);
      },

      time: function(iteration) {
        return this._coefficient * (Math.pow(this._base, iteration));
      }
    })


    var backoffs = {};

    backoffs[Retryable.Backoff.Linear]      = Linear;
    backoffs[Retryable.Backoff.Exponential] = Exponential;

    return backoffs;
  }());

  return Retryable;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../core/options"),
  require("../core/lang"),
  require("../core/state-guard"),
  require("../core/logging/logger")
);

})()
},{"../core/options":8,"../core/lang":10,"../core/state-guard":9,"../core/logging/logger":29,"bluebird":58,"underscore":57}],3:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options,
  StateGuard,
  Channel,
  ChainedChannel,
  Logger
) {

  var Periodic = function() {
    this.initialize.apply(this, arguments);
  };

  var Log = Logger.create("Periodic");

  _.extend(Periodic.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._schedulerRef = opts.getOrError("scheduler");
      this._task         = opts.getOrElse("task");
      this._interval     = opts.getOrError("interval");

      this._stateGuard   = new StateGuard(["disposed", "started"]);
      this._channel      = new Channel({ sentinel: this });
      this._taskId       = null;

      _.bindAll(this, "_runTask");
    },


    start: function(){
      this._stateGuard
        .deny("disposed", "started")
        .apply("started");

      this._scheduleNext(true);
    },


    stop: function() {
      this._cancelPending();
      this._cancelOutstanding();
      this._stateGuard.unapply("started");
    },

    egressChannel: function() {
      return new ChainedChannel({
        sentinel: this,
        chainTo: this._channel
      });
    },

    _runTask: function() {
      var results = {
        mT: "results",
        result: null,
        err: null
      };

      this._taskId = null;
      this._currentRun = Promise
        .bind(this)
        .cancellable()
        .then(function() {
          return this._task();
        })
        .then(function(result) {
          results.result = result;
        })
        .caught(Promise.CancellationError, function() {
          // Let it be. Don't want it to trickle into the results.
        })
        .caught(function(err) {
          results.err = err;
        })
        .lastly(function() {
          this._currentRun = null;
          this._notifyResults(results);
          this._scheduleNext();
        });
    },


    _notifyResults: function(results) {
      this._schedulerRef.get().runSoon(_.bind(function() {

        if (this._stateGuard.applied("disposed") || !this._stateGuard.applied("started")) {
          return;
        }

        if (Log.isTraceEnabled()) {
          Log.trace("Notifying results", results);
        }

        this._channel.publish(this, results);
      }, this));
    },


    _scheduleNext: function(now) {
      if (this._stateGuard.applied("disposed") || !this._stateGuard.applied("started")) {
        return;
      }
      this._taskId = this._schedulerRef.get().schedule(this._runTask, now ? 0 : this._interval);
      Log.trace("Scheduled task", this._taskId);
    },


    _cancelPending: function() {
      Log.trace("cancelPending requested, looking for pending task.");
      if (this._taskId) {
        Log.trace("Found pending task; cancelling", this._taskId);
        this._schedulerRef.get().unschedule(this._taskId);
        this._taskId = null;
      }
    },

    _cancelOutstanding: function() {
      Log.trace("cancelOutstanding requested, looking for outstanding work.");
      if (this._currentRun) {
        Log.trace("Outstanding work found; cancelling");
        this._currentRun.cancel();
        this._currentRun = null;
      }
    },

    dispose: function(){
      if (this._stateGuard.applied("disposed")) {
        return;
      }

      this._cancelPending();
      this._cancelOutstanding();

      this._stateGuard.apply("disposed");
    }
  });

  return Periodic;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../core/options"),
  require("../core/state-guard"),
  require("../core/channel/channel"),
  require("../core/channel/chained-channel"),
  require("../core/logging/logger")
);

})()
},{"../core/options":8,"../core/channel/channel":31,"../core/state-guard":9,"../core/channel/chained-channel":32,"../core/logging/logger":29,"underscore":57,"bluebird":58}],5:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  M,
  Options,
  StateGuard
) {

  /**
   * Attempts to intelligently dispatch an object with an mT attribute, using
   * the rules provided at instantiation.
   *
   * For a given mTyped object, searches the provided `delegate` for a method
   * named [prefix][camel-cased mT], and if present, calls it. If not found,
   * looks for [prefix]Else. If the mT attribute isn't found, dispatches to
   * [prefix]Malformed.
   */
  var Dispatcher = function() {
    this.initialize.apply(this, arguments);
  };

  var DEFAULT_CONTEXT_DELEGATE = function() {
    return {};
  };

  _.extend(Dispatcher.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._delegate        = opts.getOrError("delegate"),
      this._prefix          = opts.getOrElse("prefix", "onMsg");
      this._elseSuffix      = opts.getOrElse("elseSuffix", "else");
      this._malformedSuffix = opts.getOrElse("malformedSuffix", "malformed");
      this._contextDelegate = opts.getOrElse("contextDelegate", DEFAULT_CONTEXT_DELEGATE);
      this._stateGuard      = new StateGuard(["disposed"]);
      this._subs            = M.hash_map();

      var channels = opts.getOrElse("listen", []);

      if (!_.isArray(channels)) {
        channels = [channels];
      }

      _.each(channels, _.bind(function(c) {
        this.listen(c)
      }, this));
    },

    listen: function(channel) {
      this._stateGuard.deny("disposed");

      var sub = channel.subscribe(_.bind(function(msg) {
        this.dispatch(msg);
      }, this));

      this._subs = M.assoc(this._subs, sub.id(), sub);

      return {
        dispose: _.bind(function(){
          var nSub = M.get(this._subs, sub.id());
          if (nSub) {
            this._subs = M.dissoc(this._subs, sub.id());
            nSub.dispose();
          }
        }, this)
      }
    },

    dispatch: function(mTyped, ctx) {
      if (this._stateGuard.applied("disposed")) {
        return;
      }

      var handler = this._getVettedHandlerName(mTyped);

      if (handler) {
        this._delegate[handler](mTyped, this._contextDelegate(mTyped, ctx));
      }
    },

    /**
     * Like `dispatch`, but expects delegate to return a Promise<object>
     */
    dispatchAsync: function(mTyped, ctx) {
      if (this._stateGuard.applied("disposed")) {
        return;
      }

      var handler = this._getVettedHandlerName(mTyped);
      if (handler) {
        return this._delegate[handler](mTyped, this._contextDelegate(mTyped, ctx));
      }
    },

    dispose: function() {
      if (this._stateGuard.applied("disposed")) {
        return;
      }

      var subs = this._subs;
      this._subs = M.hash_map();

      M.each(subs, function(pair) {
        M.nth(pair, 1).dispose();
      });

      this._delegate = null;

      this._stateGuard.apply("disposed");
    },

    _getHandlerName: function(prefix, suffix) {
      return prefix + suffix.charAt(0).toUpperCase() + suffix.substr(1);
    },

    _getVettedHandlerName: function(mTyped) {
      var mT = mTyped.mT,
          prefix = this._prefix,
          potentialHandlerName,
          finalHandlerName;

      if (!mT) {
        finalHandlerName = this._getHandlerName(prefix, this._malformedSuffix);
      } else {
        potentialHandlerName = this._getHandlerName(prefix, mT);
        if (_.isFunction(this._delegate[potentialHandlerName])) {
          finalHandlerName = potentialHandlerName;
        } else {
          finalHandlerName = this._getHandlerName(prefix, this._elseSuffix);
        }
      }

      if (_.isFunction(this._delegate[finalHandlerName])) {
        return finalHandlerName;
      }
    }
  });

  return Dispatcher;
};

module.exports = mod(
  require("underscore"),
  require("mori"),
  require("./options"),
  require("./state-guard")
);

})()
},{"./options":8,"./state-guard":9,"underscore":57,"mori":59}],7:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _
) {

  var Timer = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Timer.prototype, {
    initialize: function() {
      this._startTime = null;
      this._endTime = null;
      this._lastLap = null;
    },


    start: function() {
      this._startTime = this._lastLap = +new Date();
      return this;
    },


    stop: function() {
      this._endTime = +new Date();
      return this;
    },

    lap: function() {
      if (!this._lastLap) return 0;

      var oldLastLap = this._lastLap;
      this._lastLap = +new Date();
      return (this._lastLap - oldLastLap);
    },


    delta: function() {
      return (this._endTime - this._startTime);
    }
  });

  return Timer;
};

module.exports = mod(
  require("underscore")
);

})()
},{"underscore":57}],8:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var factory = function(
  _
) {

  /**
   *
   * Helper for dealing with hash-style function arguments, which can be useful
   * in methods with optional/default values.
   *
   * Usage:
   *
   *   var foo = function(opts) {
   *       opts = Options.fromObject(opts);
   *
   *       var one = opts.getOrError("one"),
   *           two = opts.getOrElse("two", 2),
   *           three = opts.getOrElseFn("three", function() {
   *             return 3;
   *           });
   *
   *     console.log(one, two, three);
   *   };
   *
   *   foo({ one: 1 }); // logs "1, 2, 3"
   *   foo(); // throws Error
   *   foo({one: 1, two: false, three: 4}); // logs "1, false, 4"
   *
   */
  var Options = function(opts) {
    this.initialize.apply(this, arguments);
  }

  _.extend(Options.prototype, {
    initialize: function(opts) {
      this._providedOpts = opts || {};
    },

    /**
     * Attempts to return the value for the requested `key`. If the value
     * is undefined or null, instead returns the provided `fallbackValue`.
     *
     * @param key (required) attribute to be read
     * @param fallbackValue  returned if `key` attribute is null or undefined
     *
     * @returns requested value for `key`, or fallbackValue`
     */
    getOrElse: function(key, defaultValue) {
      if (this._isUndefOrNull(key)) {
        return defaultValue;
      } else {
        return this._providedOpts[key];
      }
    },

    /**
     * Attempts to return the value for the requested `key`. If the value
     * is undefined or null, throws an error.
     *
     * @param key (required) attribute to be read
     * @param err            message provided to Error constructor if `key`
     *                       is null or not defined
     *
     * @returns the value for the requested key
     */
    getOrError: function(key, errorMsg) {
      if (this._isUndefOrNull(key)) {
        errorMsg = errorMsg || "Option requested but not found: `"+key+"`";
        throw new Error(errorMsg);
      }

      return this._providedOpts[key];
    },

    /**
     * Attempts to return the value for the requested `key`. If the value
     * is undefined or null, instead evaluates `fallbackValueFn` and returns
     * its value.
     *
     * This is useful for simulating non-strict evaluation.
     *
     * @param key (required)  attribute to be read
     * @param fallbackValueFn evaluated and return value returned if `key`
     *                        attribute is null or undefined
     *
     * @returns requested value for `key` or the return value of evaluated
     *          `fallbackValueFn`
     */
    getOrElseFn: function(key, defaultValueFn) {
      if (typeof defaultValueFn !== "function") {
        throw new Error("Options#getOrElseFn requires a defaultValueFn");
      }

      if (this._isUndefOrNull(key)) {
        return defaultValueFn();
      } else {
        return this._providedOpts[key];
      }
    },


    toObject: function() {
      return _.clone(this._providedOpts);
    },

    scope: function(prefix) {
      return Options.fromObjectWithPrefix(this.toObject(), prefix);
    },

    _isUndefOrNull: function(key) {
      return typeof this._providedOpts[key] === "undefined" || this._providedOpts[key] === null;
    }
  });

  _.extend(Options, {
    fromObject: function(opts) {
      return new Options(opts);
    },


    fromObjectWithPrefix: function(opts, prefix) {
      opts = _.reduce(opts, function(memo, val, key) {
        var rest, newKey;
        if (key.indexOf(prefix) === 0) {
          rest = key.substr(prefix.length);
          if (rest.length > 1) {
            newKey = rest.charAt(0).toLowerCase() + rest.substr(1);
            memo[newKey] = val;
          }
        }
        return memo;
      }, {});

      return new Options(opts);
    }
  })

  return Options;
};

module.exports = factory(
  require("underscore")
);

})()
},{"underscore":57}],6:[function(require,module,exports){
(function(){/*global require: false, module: false */

var mod = function (
  _
  ) {

  var CountdownLatch = function () {
        this.initialize.apply(this, arguments);
      },
      noop = function() {};

  _.extend(CountdownLatch.prototype, {
    initialize: function (steps, completionCallback) {
      this._steps = steps || 0;
      this._completionCallback = completionCallback || noop;
      _.bindAll(this, "_completionCallback", "_triggerCompletion");
      if(isNaN(this._steps) || this._steps < 0) {
        throw new Error("CountdownLatch: Number of steps are invalid.");
      }
      this._current = 0;
      this._complete = false;
      this._error = null;
      if(this._steps === 0) {
        _.defer(this._triggerCompletion);
        return;
      }
    },
    step: function (steps) {
      if (this._complete || this._steps === 0) {
        return;
      }
      this._current += steps || 1;
      if (this._current >= this._steps) {
        this._triggerCompletion();
      }
    },
    error: function (err) {
      if (this._complete || this._steps === 0) {
        return;
      }
      this._error = err;
      this._triggerCompletion();
    },
    _triggerCompletion: function () {
      if (this._complete) {
        return;
      }
      this._complete = true;
      if (this._error) {
        _.defer(_.bind(this._completionCallback, null, this._error));
      } else {
        _.defer(this._completionCallback);
      }
    }
  });

  return CountdownLatch;
};

module.exports = mod(
  require("underscore")
);

})()
},{"underscore":57}],9:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise
) {

  /**
   * A StateGuard does what its name implies. Valid states are provided during instantiation, and are applied, ensured,
   * denied, etc, through the course of the owner's lifetime.
   *
   * For example, if you'd like to ensure that Foo#bar raises an error after Foo#dispose is called, you might do the
   * following:
   *
   *   var Foo = function() {
   *     this.initialize.apply(this, arguments);
   *   };
   *
   *   _.extend(Foo.prototype, {
   *     initialize: function() {
   *       this._expensiveResource = new ExpensiveResource();
   *       this._stateGuard = new StateGuard(["disposed"]);
   *     },
   *     dispose: function() {
   *       // #dispose should be idempotent, so here we just check to see if we've already disposed, and return.
   *       // Note that if dispose were async, we'd need to add a "disposing" state.
   *       if (this._stateGuard.applied("disposed")) {
   *         return;
   *       }
   *
   *       if (this._expensiveResource) {
   *         this._expensiveResource.dispose();
   *         this._expensiveResource = null;
   *       }
   *       this._stateGuard.apply("disposed");
   *     },
   *     bar: function() {
   *       this._stateGuard.deny("disposed"); // Throws exception if #dispose was called
   *
   *       return this._expensiveResource.someMethod();
   *     }
   *   });
   *
   * In this case, where we have only one state, it's useful to simply create a scoped StateGuard, which behaves
   * identically to a regular one, except every enforcement/query method has the scope provided during instantiation
   * as a first, implicit argument:
   *
   *   // Identical to previous version.
   *
   *   var Foo = function() {
   *     this.initialize.apply(this, arguments);
   *   };
   *
   *   _.extend(Foo.prototype, {
   *     initialize: function() {
   *       this._expensiveResource = new ExpensiveResource();
   *       this._stateGuard = StateGuard.scoped("disposed");
   *     },
   *     dispose: function() {
   *       // #dispose should be idempotent, so here we just check to see if we've already disposed, and return.
   *       // Note that if dispose were async, we'd need to add a "disposing" state.
   *       if (this._stateGuard.applied()) {
   *         return;
   *       }
   *
   *       if (this._expensiveResource) {
   *         this._expensiveResource.dispose();
   *         this._expensiveResource = null;
   *       }
   *       this._stateGuard.apply();
   *     },
   *     bar: function() {
   *       this._stateGuard.deny(); // Throws exception if #dispose was called
   *
   *       return this._expensiveResource.someMethod();
   *     }
   *   });
   *
   */
  var StateGuard = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(StateGuard.prototype, {
    initialize: function(states) {
      this._validStates = _.reduce(states, function(memo, state) {
        memo[state] = true;
        return memo;
      }, {});

      this._appliedStates = {};
    },

    scope: function(state) {
      var skip = ["scope", "initialize"],
          self = this,
          scoped = {};

      _.each(StateGuard.prototype, function(fun, methodName) {
        if (_.contains(skip, methodName)) {
          return;
        }

        scoped[methodName] = function() {
          var args = _.toArray(arguments);
          args.unshift(state);
          return fun.apply(self, args);
        };
      });

      return scoped;
    },

    apply: function() {
      var states = aryOrVariadicToArray(arguments);
      checkValidStatesOrThrow(this._validStates, states);

      _.each(states, function(state) {
        this._appliedStates[state] = true;
      }, this);

      return this;
    },

    applyAsync: Promise.method(function() {
      return this.apply.apply(this, arguments);
    }),

    applyAsyncFn: function() {
      var args = arguments;
      return _.bind(function() {
        return this.applyAsync.apply(this, args);
      }, this);
    },

    unapply: function() {
      var states = aryOrVariadicToArray(arguments);
      checkValidStatesOrThrow(this._validStates, states);

      _.each(states, function(state) {
        if (this._appliedStates[state]) {
          delete this._appliedStates[state];
        }
      }, this);

      return this;
    },

    unapplyAsync: Promise.method(function() {
      return this.unapply.apply(this, arguments);
    }),

    unapplyAsyncFn: function(states) {
      var args = arguments;
      return _.bind(function() {
        return this.unapplyAsync.apply(this, args)
      }, this);
    },

    deny: function() {
      var states = aryOrVariadicToArray(arguments);
      checkValidStatesOrThrow(this._validStates, states);

      var applied = _.filter(states, function(state) {
        return this._appliedStates[state];
      }, this);

      if (applied.length > 0) {
        throw new Error("State denial requested, but applied: " + pretty(applied));
      }

      return this;
    },

    denyAsync: Promise.method(function() {
      return this.deny.apply(this, arguments);
    }),

    denyAsyncFn: function() {
      var args = arguments;
      return _.bind(function() {
        return this.denyAsync.apply(this, args)
      }, this);
    },

    ensure: function() {
      var states = aryOrVariadicToArray(arguments);
      checkValidStatesOrThrow(this._validStates, states);
      var missing = _.reject(states, function(state) {
        return this._appliedStates[state];
      }, this);

      if (missing.length > 0) {
        throw new Error("State ensurance requested, but not applied: " + pretty(missing));
      }
      return this;
    },

    ensureAsync: Promise.method(function() {
      return this.ensure.apply(this, arguments);
    }),

    ensureAsyncFn: function() {
      var args = arguments;
      return _.bind(function() {
        return this.ensureAsync.apply(this, args);
      }, this);
    },

    applied: function() {
      var states = aryOrVariadicToArray(arguments);
      checkValidStatesOrThrow(this._validStates, states);

      return _.every(states, function(state) {
        return this._appliedStates[state];
      }, this);
    },

    appliedAsync: Promise.method(function() {
      return this.applied.apply(this, arguments);
    }),

    appliedAsyncFn: function() {
      var args = arguments;
      return _.bind(function() {
        return this.appliedAsync.apply(this, args)
      }, this);
    }
  });

  var aryOrVariadicToArray = function(args) {
    return _.chain(args).toArray().flatten().value();
  };

  var checkValidStatesOrThrow = function(validStatesMap, states) {
    var invalidStates = _.reject(states, function(state) {
      return !!validStatesMap[state];
    });

    if (invalidStates.length > 0) {
      throw new Error("Invalid states provided: " + pretty(invalidStates));
    }
  };

  var pretty = function(states) {
    return "["+states.join(",")+"]";
  };

  _.extend(StateGuard, {
    scoped: function(scope) {
      return (new StateGuard([scope])).scope(scope);
    }
  })

  return StateGuard;
};

module.exports = mod(
  require("underscore"),
  require("bluebird")
);

})()
},{"bluebird":58,"underscore":57}],10:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var factory = function(
  _,
  Promise,
  Options
) {

  var Lang = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Lang.prototype, {
    initialize: function(){}
  });

  _.extend(Lang, {
    noop: function() {},

    partiallyApply: function() {
      var args = _.toArray(arguments),
          fun  = args.shift();

      return function() {
        return fun.apply(null, args.concat(arguments));
      };
    },

    makeErrorClass: function(name, defaultMessage) {
      if (!name) {
        throw new Error("makeErrorClass requires `name`");
      }

      var klass = function(message) {
        this.name    = name;
        this.message = this.name + ": " + (message || defaultMessage || "An unexpected error occurred");

        if (Error.captureStackTrace) {
          Error.captureStackTrace(this, klass);
        }
      };

      klass.prototype = Object.create(Error.prototype);
      klass.prototype.constructor = klass;
      return klass;
    },

    pojoClass: function(attributes, options) {
      if (!_.isArray(attributes)) {
        throw new Error("Lang#pojoClass requires attributes array");
      }

      var options = Options.fromObject(options),
          // optional specifies keys that are optional, with values that are default if not provided
          defaults = options.getOrElse("defaults", {}),
          optionalAttributes = _.keys(defaults);

      var toAttributeName = function(attr) {
            return "_" + attr;
          },
          toGetter = function(attr) {
            return attr;
          },
          toSetter = function(attr) {
            return "set" + attr.charAt(0).toUpperCase() + attr.substr(1);
          };

      var klass = function() {
        this.initialize.apply(this, arguments);
      };

      _.extend(klass.prototype, {
        initialize: function(opts) {
          opts = Options.fromObject(opts);
          _.each(attributes, function(attr) {
            if (_.contains(optionalAttributes, attr)) {
              this[toAttributeName(attr)] = opts.getOrElse(attr, defaults[attr]);
            } else {
              this[toAttributeName(attr)] = opts.getOrError(attr);
            }
          }, this);
        }
      });

      _.each(attributes, function(attr) {
        klass.prototype[toGetter(attr)] = function() {
          return this[toAttributeName(attr)];
        };
        klass.prototype[toSetter(attr)] = function(v) {
          this[toAttributeName(attr)] = v;
        };
      });

      return klass;
    },

    deferred: function(promiseClass) {
      promiseClass = promiseClass || Promise;
      var res = null, rej = null;
      var p = new promiseClass(function() {
        res = arguments[0];
        rej = arguments[1];
      });

      return {
        promise: p,
        resolve: res,
        reject: rej
      };
    }
  });

  return Lang;
};

module.exports = factory(
  require("underscore"),
  require("bluebird"),
  require("./options")
);

})()
},{"./options":8,"underscore":57,"bluebird":58}],11:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _
) {

  var PubSub = {
    on: function(eventName, handler, context) {
      var bucket = this.__pubSubBucket(eventName);
      bucket.subscribe(handler, context);
    },
    off: function(eventName, handler, context) {
      var bucket = this.__pubSubBucket(eventName);
      bucket.unsubscribe(handler, context);
    },
    notify: function() {
      var args      = _.toArray(arguments),
          eventName = args.shift();

      var bucket = this.__pubSubBucket(eventName);
      bucket.notify(args);
    },
    __pubSubBucket: function(eventName) {
      this.__pubSubEvents = this.__pubSubEvents || {};
      this.__pubSubEvents[eventName] = this.__pubSubEvents[eventName] || new EventBucket(eventName);
      return this.__pubSubEvents[eventName];
    }
  };

  var EventBucket = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(EventBucket.prototype, {
    initialize: function(eventName) {
      this._eventName = eventName;
      this._subscriptions = [];
    },
    subscribe: function(handler, context) {
      if (handler) {
        this._subscriptions.push(new Subscription(handler, context));
      } else {
        throw new Error("Subscription requires handler: " + this._eventName);
      }
    },
    unsubscribe: function(handler, context) {
      var subs;
      if (handler) {
        subs = _.filter(this._subscriptions, function(sub) {
          return sub.matches(handler, context);
        });
      } else {
        subs = this._subscriptions;
      }

      _.each(subs, function(sub) {
        sub.dispose();
      });

      this._subscriptions = _.difference(this._subscriptions, subs);
    },
    notify: function(args) {
      _.invoke(this._subscriptions, "notify", args);
    }
  });

  var Subscription = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Subscription.prototype, {
    initialize: function(handler, context) {
      this._handler = handler;
      this._context = context;
    },
    matches: function(handler, context) {
      if (this._context) {
        // Compare context refs as refs iff we have a context object
        return (handler === this._handler && context === this._context);
      } else {
        // Otherwise, just make sure we don't have a context (null or undefined are fine)
        return (handler === this._handler && !context);
      }
    },
    notify: function(args) {
      // We shouldn't be called after dispose, but
      // just in case...
      if (this._handler) {
        this._handler.apply(this._context, args);
      } else {
        console.log("WTF");
      }
    },
    dispose: function() {
      this._handler = null;
      this._context = null;
    }
  })

  return PubSub;
};

module.exports = mod(
  require("underscore")
);

})()
},{"underscore":57}],16:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options
) {

  var DoublyLinkedList = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(DoublyLinkedList.prototype, {
    initialize: function() {
      this._front = null;
      this._back = null;
      this._size = 0;
    },

    get: function(idx) {
      this._checkElementIdxOrThrow(idx);
      var node = this._walkToIdx(idx);
      return node.value();
    },

    exists: function(value) {
      var node = this._walkToValue(value);
      return !!node;
    },

    size: function() {
      return this._size;
    },

    add: function(value) {
      return this.addBack.apply(this, arguments);
    },

    addFront: function(value) {
      this._linkFront(value);
    },

    addBack: function(value) {
      this._linkBack(value);
    },

    remove: function(value) {
      var node = this._walkToValue(value);
      return this._unlink(node);
    },

    removeFront: function() {
      if (this._front === null) {
        throw new Error("No such element");
      }
      return this._unlinkFront(this._front);
    },

    removeBack: function() {
      if (this._back === null) {
        throw new Error("No such element");
      }
      return this._unlinkBack(this._back);
    },

    insertAtIndex: function(idx, value) {
      this._checkIsElementPositionOrThrow(idx);

      if (idx === this._size) {
        this.addBack(value);
      } else {
        var node = this._walkToIdx(idx);
        this._linkBefore(value, node);
      }
    },

    removeAtIndex: function(idx) {
      this._checkElementIdxOrThrow(idx);
      if (idx === 0) {
        return this._unlinkFront(this._front);
      } else if ( idx === (this._size - 1) ) {
        return this._unlinkBack(this._back);
      } else {
        var node = this._walkToIdx(idx);
        return this._unlink(node);
      }
    },

    clear: function() {
      var node = this._front,
          next;

      while (node !== null) {
        next = node.next();
        node.dispose();
        node = next;
      }
      this._front = null;
      this._back  = null;
      this._size = 0;
    },

    _linkFront: function(value) {
      var oldFront = this._front,
          newNode = new Node({value: value});
      this._front = newNode;

      if (oldFront === null) {
        this._back = newNode;
      } else {
        oldFront.setPrev(newNode);
        newNode.setNext(oldFront);
      }

      this._size++;
      return newNode;
    },

    _linkBack: function(value) {
      var oldBack = this._back,
          newNode = new Node({value: value});

      this._back = newNode;
      if (oldBack === null) {
        this._front = newNode;
      } else {
        oldBack.setNext(newNode);
        newNode.setPrev(oldBack);
      }

      this._size++;
      return newNode;
    },

    _linkBefore: function(value, node) {
      var pred    = node.prev(),
          newNode = new Node({value: value, prev: pred, next: node});

      node.setPrev(newNode);
      if (pred === null) {
        this._front = newNode;
      } else {
        pred.setNext(newNode);
      }
      this._size++;
      return newNode;
    },

    _unlinkFront: function(node) {
      var value    = node.value(),
          newFront = node.next();

      node.dispose();
      this._front = newFront;
      if (newFront === null) {
        this._back = null;
      } else {
        newFront.setPrev(null);
      }
      this._size--;
      return value;
    },

    _unlinkBack: function(node) {
      var value   = node.value(),
          newBack = node.prev();

      node.dispose();
      this._back = newBack;
      if (newBack == null) {
        this._front = null;
      } else {
        newBack.setNext(null);
      }
      this._size--;
      return value;
    },

    _unlink: function(node) {
      var prev  = node.prev(),
          next  = node.next(),
          value = node.value();

      if (prev === null) {
        this._front = next;
      } else {
        prev.setNext(next);
      }

      if (next === null) {
        this._back = prev;
      } else {
        next.setPrev(prev);
      }

      node.dispose();
      this._size--;
      return value;
    },

    _walkToIdx: function(idx) {
      var node, current;
      if (idx < this._size / 2) {
        node = this._front;
        current = 0;
        while(current !== idx) {
          node = node.next();
          current++;
        }
      } else {
        node = this._back;
        current = this._size - 1;

        while(current !== idx) {
          node = node.prev();
          current--;
        }
      }
      return node;
    },

    _walkToValue: function(value) {
      var n = this._front;
      while (n !==null ) {
        if (n.match(value)) {
          return n;
        }
        n = n.next();
      }
      return null;
    },

    _isElementIdx: function(idx) {
      return (idx >= 0 && idx < this._size);
    },

    _isElementPosition: function(idx) {
      return (idx >= 0 && idx <= this._size);
    },

    _checkElementIdxOrThrow: function(idx) {
      if (!this._isElementIdx(idx)) {
        throw new Error("Index out of bounds; size: " + this._size + "; idx: " + idx);
      }
    },

    _checkIsElementPositionOrThrow: function(idx) {
      if (!this._isElementPosition(idx)) {
        throw new Error("Index out of bounds; size: " + this._size + "; idx: " + idx);
      }
    }

  });

  var Node = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Node.prototype, {
    initialize: function(opts) {
      opts        = Options.fromObject(opts);
      this._next  = opts.getOrElse("next", null);
      this._prev  = opts.getOrElse("prev", null);
      this._value = opts.getOrElse("value", null);
    },

    next: function() {
      return this._next;
    },

    prev: function() {
      return this._prev;
    },

    setNext: function(node) {
      this._next = node;
    },

    setPrev: function(node) {
      this._prev = node;
    },

    value: function() {
      return this._value;
    },

    dispose: function() {
      this._next  = null;
      this._prev  = null;
      this._value = null;
    },

    match: function(value) {
      return this._value === value;
    }
  });

  return DoublyLinkedList;
};

module.exports = mod(
  require("underscore"),
  require("../core/options")
);

})()
},{"../core/options":8,"underscore":57}],17:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options
) {

  /**
   * Delegates storage to a JS object.
   */
  var ObjectHashMap = function() {
    this.initialize.apply(this, arguments);
  };


  _.extend(ObjectHashMap.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._store = {};
      this._keyPrefix = opts.getOrElse("keyPrefix", "ohm-");
    },
    get: function(key){
      return this._store[this._makeKey(key)];
    },
    put: function(key, val) {
      this._store[this._makeKey(key)] = val;
    },
    remove: function(key) {
      var val;
      key = this._makeKey(key);
      if (_.has(this._store, key)) {
        val = this._store[key];
        delete this._store[key];
      }
      return val;
    },
    exists: function(key) {
      return _.has(this._store, this._makeKey(key));
    },
    size: function() {
      return _.size(this._store);
    },
    clear: function() {
      this._store = {};
    },
    _makeKey: function(key) {
      return this._keyPrefix + key;
    }
  });


  return ObjectHashMap;
};

module.exports = mod(
  require("underscore"),
  require("../core/options")
);

})()
},{"../core/options":8,"underscore":57}],18:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options,
  InMemoryDataStore,
  UnitSequencer,
  Entry
) {

  // Appropriate for the default sequencer (non-temporal)
  var DEFAULT_TTL = 1;


  /**
   * A look-aside caching data store. Note: it's generally not useful to allow
   * null/undefined stored values. When an item is evicted from the cache, a
   * subsequent `get` call will return `undefined`, so it can be difficult to
   * determine if there was a cache miss if the value you're storing is, in fact,
   * `undefined`, unless you prefix every check with `exists`, which also does
   * cache eviction on check.
   */
  var CachingDataStore = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(CachingDataStore.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._ttl = opts.getOrElse("ttl", DEFAULT_TTL);

      // Default sequencer is a linear/unit sequencer. The default TTL is
      // 1. Therefore, all values will expire with single advance of the
      // sequencer. Note that the data store doesn't advance the
      // sequencer itself. The store owner is responsible for doing
      // this.
      //
      // This is especially important to note for time-based sequencers.
      // Time will not advance automatically. The store owner is responsible
      // for scheduling the sequencer to advance with time. This keeps the
      // CachingDataStore's lifecycle simple with respect to time.
      this._sequencer = opts.getOrElseFn("sequencer", function() {
        return new UnitSequencer();
      });

      // By default, we delegate to an in-memory store. Fine for simple
      // cases, but not optimal.
      this._backingStore = opts.getOrElseFn("backingStore", function() {
        return new InMemoryDataStore();
      });

      // Updates the lastUpdated time to "now" on read - keeps entries
      // from expiring when they're being accessed, but can cause
      // staleness issues.
      this._shouldTouchOnRead = opts.getOrElse("touchOnRead", false);
    },

    sequencer: function() {
      return this._sequencer;
    },


    /**
     * Gets the value associated with the provided key. If the object has
     * expired, it will be evicted from the cache, and `undefined` will
     * be returned instead.
     *
     * @param key {string} (required)
     * @async
     * @returns {Promise<Object>} requested value
     */
    get: Promise.method(function(key) {
      return Promise
        .bind(this)
        .then(function() {
          return this._backingStore.get(key);
        })
        .then(function(entry){
          if (!entry) {
            return;
          }

          if (!entry.isExpired(this._sequencer.value(), this._ttl)) {
            if (this._shouldTouchOnRead) {
              entry.touch(this._sequencer.value());
            }
            return Promise
              .bind(this)
              .then(function() {
                return this._backingStore.put(key, entry);
              })
              .return(entry.value());
          } else {
            return Promise
              .bind(this)
              .then(function() {
                return this.remove(key)
              })
              .then(function() {
                // .thenReturn is a lie.
                return;
              });
          }
        });
    }),

    /**
     * Stores the provided `val`, identified by `key`
     *
     * @param `key` {string}  (required) identifier for value to be stored
     * @param `val` {dynamic} (required) value to be stored
     * @async
     * @returns {Promise<>}
     */
    put: Promise.method(function(key, val) {
      return Promise
        .bind(this)
        .then(function() {
          return this._backingStore.get(key);
        })
        .then(function(entry) {
          // If we have an entry, we should just update
          // Else, we make new one.
          // Pesist, then return nothing.
          if (entry) {
            entry.update(val, this._sequencer.value());
          } else {
            entry = new Entry({
              value: val,
              initialSequence: this._sequencer.value()
            });
          }

          return Promise
            .bind(this)
            .then(function() {
              return this._backingStore.put(key, entry)
            })
            .then(function() {
              return;
            });
        });
    }),

    /**
     * Removes the value associated with the provided `key`
     *
     * @param `key` {string} (required) identifier for value to be removed
     * @async
     * @returns {Promise<dynamic>} Removed value, if present in store.
     */
    remove: Promise.method(function(key) {
      var val;
      return this._backingStore
        .remove(key)
        .then(function(entry) {
          if (entry) {
            val = entry.value();
            entry.dispose();
            return val;
          }
        });
    }),

    exists: Promise.method(function(key){
      // It's not sufficient to delegate this call to the underlying
      // backing store. We need to perform eviction, as a subsequent call
      // to get would do the same. If the `exists` check says it exists,
      // bet it doesn't when we `get`, then `exists` is a worthless operation.
      //
      // Note that if you're using a CachingDataStore backed by an InMemoryDataStore
      // backed by an LRUHashMap, this will cause the entry to be "touched", whereas
      // a normal "exists" check would not.
      return Promise
        .bind(this)
        .then(function() {
          return this._backingStore.get(key);
        })
        .then(function(entry) {
            if (!entry) {
              return false;
            } else {
              if (!entry.isExpired(this._sequencer.value(), this._ttl)) {
                return true;
              } else {
                return this._backingStore.remove(key)
                  .then(function() {
                    entry.dispose();
                  })
                  .thenReturn(false);
              }
            }
        });
    }),

    clear: Promise.method(function() {
      return this._backingStore.clear();
    })
  });

  return CachingDataStore;

};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../core/options"),
  require("./in-memory-data-store"),
  require("../core/sequencer/unit-sequencer"),
  require("./internals/expiring-entry")
);

})()
},{"../core/options":8,"./in-memory-data-store":19,"../core/sequencer/unit-sequencer":14,"./internals/expiring-entry":53,"underscore":57,"bluebird":58}],19:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options,
  ObjectHashMap
) {

  /**
   * InMemoryDataStore delegates to a backing HashMap. By default, this
   * will be a "poor man's HashMap", a.k.a., the ObjectHashMap.
   */
  var InMemoryDataStore = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(InMemoryDataStore.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._map = opts.getOrElseFn("backingHashMap", function() {
        return new ObjectHashMap();
      });
    },

    get: Promise.method(function(key) {
      return this._map.get(key);
    }),

    put: Promise.method(function(key, val) {
      return this._map.put(key, val);
    }),

    remove: Promise.method(function(key) {
      return this._map.remove(key);
    }),

    exists: Promise.method(function(key){
      return this._map.exists(key);
    }),

    clear: Promise.method(function() {
      return this._map.clear();
    })
  });

  return InMemoryDataStore;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../core/options"),
  require("../collection/object-hash-map")
);

})()
},{"../core/options":8,"../collection/object-hash-map":17,"underscore":57,"bluebird":58}],20:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options,
  ObjectHashMap,
  DoublyLinkedList
) {

  var LRUHashMap = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(LRUHashMap.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._capacity = opts.getOrError("capacity");
      this._keyAccessList = new DoublyLinkedList();
      // TODO: Really need a proper HashMap at some point...
      this._store = new ObjectHashMap();
    },
    get: function(key) {
      var entry = this._store.get(key);
      if (!entry) {
        return;
      }

      // As a perf optimization, we keep a ref
      // to the node in the entry.
      var node = entry.node();
      this._keyAccessList._unlink(node);

      // Get the new node
      node = this._keyAccessList._linkFront(entry.key());

      // Save it
      entry.setNode(node);
      // Return the value
      return entry.value();
    },

    put: function(key, val) {
      var entry = this._store.get(key),
          node;
      if (!entry) {
        // If no entry, make a new entry
        if (this._keyAccessList.size() >= this._capacity) {
          // Have to make room for it
          var evictedKey = this._keyAccessList.removeBack(),
              evictedEntry = this._store.get(evictedKey);

          evictedEntry.dispose();
          this._store.remove(evictedKey);
        }

        node = this._keyAccessList._linkFront(key);
        entry = new Entry({
          key: key,
          value: val,
          node: node
        });
        this._store.put(key, entry);
      } else {
        // "Touch" the entry, set new value
        node = entry.node();
        this._keyAccessList._unlink(node);
        node = this._keyAccessList._linkFront(entry.key());
        // Update with the new node and value
        entry.setNode(node);
        entry.setValue(val);
      }
    },

    remove: function(key) {
      var entry = this._store.get(key),
          value,
          node;
      if (entry) {
        value = entry.value();
        node = entry.node();
        this._keyAccessList._unlink(node);
        entry.dispose();
        this._store.remove(key);
        return value;
      }
    },

    exists: function(key) {
      return this._store.exists(key);
    },

    size: function() {
      return this._store.size();
    },

    clear: function() {
      this._store.clear();
      this._keyAccessList.clear();
    }
  });

  var Entry = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Entry.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      // Though the Node should have the key, if the node
      // is unlinked from the list, its boxed value will disappear
      this._key   = opts.getOrError("key");
      this._value = opts.getOrError("value");
      this._node  = opts.getOrError("node");
    },
    node: function() {
      return this._node;
    },
    setNode: function(node) {
      this._node = node;
    },
    value: function() {
      return this._value;
    },
    setValue: function(value) {
      this._value = value;
    },
    key: function() {
      return this._key;
    },
    dispose: function() {
      this._key = null;
      this._value = null;
      this._node = null;
    }
  });

  return LRUHashMap;
};

module.exports = mod(
  require("underscore"),
  require("../core/options"),
  require("./object-hash-map"),
  require("./doubly-linked-list")
);

})()
},{"../core/options":8,"./object-hash-map":17,"./doubly-linked-list":16,"underscore":57}],22:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options,
  InMemoryDataStore,
  LRUHashMap
) {

  var LRUDataStore = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(LRUDataStore.prototype, InMemoryDataStore.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      var map = new LRUHashMap({
        capacity: opts.getOrError("capacity")
      });
      InMemoryDataStore.prototype.initialize.call(this, {
        backingHashMap: map
      });
    }
  });

  return LRUDataStore;
};

module.exports = mod(
  require("underscore"),
  require("../core/options"),
  require("./in-memory-data-store"),
  require("../collection/lru-hash-map")
);

})()
},{"../core/options":8,"./in-memory-data-store":19,"../collection/lru-hash-map":20,"underscore":57}],21:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  M,
  Options,
  Channel,
  ChainedChannel,
  UnitSequencer,
  DelegatingForwardingSequencer,
  InMemoryDataStore,
  Entry
) {

  /**
   * Semantically similar to a CachingDataStore, except:
   *   1) Expiry is check both on access, and whenever `advance` is
   *      called on the `sentrySequencer`.
   *   2) Records are not automatically removed; instead, a signal is sent
   *      along the `signalChannel`. The signal dispatch is deferred, so
   *      an access-triggered evocation signal won't be received until a
   *      subsequent tick. Since promises are asynchronous, this means
   *      the caller may receive a value from the store, and may also
   *      receive an event from the Store indicating expiry - in non-deterministic
   *      order. It's up to the caller to choose a resolution.
   *      Additionally, there is no guarantee that a single expiry event
   *      will be sent for a given key; instead, the event will continue
   *      to be dispatched for as long as the key remains in the store.
   * @constructor
   */
  var SignalingDataStore = function() {
    this.initialize.apply(this, arguments);
  };

  var DEFAULT_TTL = 1;

  _.extend(SignalingDataStore.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._ttl = opts.getOrElse("ttl", DEFAULT_TTL);

      this._sequencer = opts.getOrElseFn("sequencer", function() {
        return new UnitSequencer();
      });

      _.bindAll(this, "_doCheck");

      this._sentrySequencer = new DelegatingForwardingSequencer({
        delegate: new UnitSequencer(),
        targets: [{
          advance: this._doCheck
        }]
      });

      this._backingStore = opts.getOrElseFn("backingStore", function() {
        return new InMemoryDataStore();
      });

      this._shouldTouchOnRead = opts.getOrElse("touchOnRead", false);

      this._signalChannel = new Channel({ sentinel: this });

      this._keys = M.set();
    },

    sequencer: function() {
      return this._sequencer;
    },

    sentrySequencer: function() {
      return this._sentrySequencer;
    },

    signalChannel: function() {
      return new ChainedChannel({
        sentinel: this,
        chainTo: this._signalChannel
      });
    },

    _doCheck: function() {
      var work = M.map(_.bind(function(key) {
        return Promise
          .bind(this)
          .then(function() {
            return this._backingStore.get(key);
          })
          .then(function(entry) {
            if (entry && entry.isExpired(this._sequencer.value(), this._ttl)) {
              this._signalExpirySoon(key, this._sequencer.value());
            }
          });
        }, this), this._keys);

      return Promise.all(M.into_array(work));
    },

    /**
     * Gets the value associated with the provided `key`. If the object
     * has expired, it will still be returned from the Store, but an mT:expired
     * message will be sent along the `signalChannel`.
     *
     * @param key {string}
     * @async
     * @returns {Promise<object>} requested value
     */
    get: Promise.method(function(key){
      return Promise
        .bind(this)
        .then(function() {
          return this._backingStore.get(key);
        })
        .then(function(entry) {
          if (!entry) {
            return;
          }

          var isExpired = entry.isExpired(this._sequencer.value(), this._ttl);

          if (isExpired) {
            this._signalExpirySoon(key, this._sequencer.value());
          }

          if (!isExpired && this._shouldTouchOnRead) {
            entry.touch(this._sequencer.value());
            return Promise
              .bind(this)
              .then(function() {
                return this._backingStore.put(key, entry);
              })
              .thenReturn(entry.value());
          } else {
            return entry.value();
          }
        });
    }),

    /**
     * Stores the provided `val`, identified by `key`, with a TTL optionally
     * supplied by `opts.ttl` (overrides pre-configured Store TTL.
     *
     * @param key {String}
     * @param val {object} value to be stored
     * @async
     * @returns {Promise<>}
     */
    put: Promise.method(function(key, val, opts) {
      opts = Options.fromObject(opts);

      return Promise
        .bind(this)
        .then(function() {
          return this._backingStore.get(key);
        })
        .then(function(entry) {
          if (entry) {
            entry.update(val, this._sequencer.value(), {
              ttl: opts.getOrElse("ttl")
            });
          } else {
            entry = new Entry({
              value: val,
              initialSequence: this._sequencer.value(),
              ttl: opts.getOrElse("ttl")
            });
          }
          return Promise
            .bind(this)
            .then(function () {
              return this._backingStore.put(key, entry);
            })
            .then(function() {
              this._keys = M.conj(this._keys, key);
              return; // Because thenReturn doesn't work with an empty value.
            });
        });
    }),


    /**
     * Removes the value associated with the provided `key`
     */
    remove: Promise.method(function(key){
      var val;
      return this._backingStore
        .remove(key)
        .bind(this)
        .then(function(entry) {
          if (entry) {
            this._keys = M.disj(this._keys, key);

            val = entry.value();
            entry.dispose();
            return val;
          }
        });
    }),


    exists: Promise.method(function(key){
      // Unlike in the CachingDataStore, where we have to perform eviction rules before
      // returning the answer, here we can just delegate straight to the backing store.
      return this._backingStore.exists(key);
    }),


    clear: Promise.method(function(){
      return this._backingStore.clear();
    }),


    _signalExpirySoon: function(key, sequence) {
      _.defer(_.bind(function(){
        this._signalChannel.publish(this, {
          mT: "expired",
          key: key,
          sequence: sequence
        });
      }, this));
    }
  });

  return SignalingDataStore;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("mori"),
  require("../core/options"),
  require("../core/channel/channel"),
  require("../core/channel/chained-channel"),
  require("../core/sequencer/unit-sequencer"),
  require("../core/sequencer/delegating-forwarding-sequencer"),
  require("./in-memory-data-store"),
  require("./internals/expiring-entry")
);

})()
},{"../core/options":8,"../core/channel/channel":31,"../core/channel/chained-channel":32,"../core/sequencer/unit-sequencer":14,"../core/sequencer/delegating-forwarding-sequencer":15,"./in-memory-data-store":19,"./internals/expiring-entry":53,"underscore":57,"bluebird":58,"mori":59}],25:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  ScopedConfigurationResolver
) {

  var ConfigurationMagic = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(ConfigurationMagic.prototype, {
    initialize: function() {}
  });

  _.extend(ConfigurationMagic, {
    resolveConfig: function(scopes, configObjects) {
      var r = new ScopedConfigurationResolver();
      _.each(configObjects, function(c) {
        r.add(c);
      });
      return r.resolve(scopes);
    }
  });

  return ConfigurationMagic;
};

module.exports = mod(
  require("underscore"),
  require("./config/scoped-configuration-resolver")
);

})()
},{"./config/scoped-configuration-resolver":26,"underscore":57}],28:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Logger,
  Options,
  StateGuard,
  Runtime,
  ProcessKeepAlive
) {
  var Log = Logger.create("App");

  var App = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(App.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._guard = new StateGuard(["starting", "started", "stopping", "stopped"]);
      this._rawConfig = opts.getOrError("configuration");
      this._config = Options.fromObject(this._rawConfig);

      // The default Runtime has sensible defaults.
      this._runtime = opts.getOrElseFn("runtime", function() {
        return new Runtime();
      });

      this._keepAlive = new ProcessKeepAlive({
        scheduler: this._runtime.scheduler()
      });

      var up   = opts.getOrElse("up"),
          down = opts.getOrElse("down");

      if (up) {
        this.up = Promise.method(_.bind(function() {
          return up.call(this, this._config);
        }, this));
      }

      if (down) {
        this.down = Promise.method(_.bind(function() {
          return down.call(this, this._config);
        }, this));
      }

    },

    start: Promise.method(function() {
      Log.debug("Starting App");
      this._guard
        .deny("starting")
        .apply("starting");

      this._keepAlive.start();
      Log.debug("Calling App#up()");

      return this.up()
        .then(this._guard.applyAsyncFn("started"));
    }),

    stop: Promise.method(function() {
      Log.debug("Stopping App");
      this._guard
        .deny("stopping")
        .apply("stopping");

      this._keepAlive.stop();
      Log.debug("Calling App#down()");

      return this.down()
        .then(this._guard.applyAsyncFn("stopped"));
    }),

    /**
     * Returns the requested configuration value, or throws an error.
     * @param key the configuration key request from the Configuration.
     * @returns {Object}
     */
    config: function(key) {
      return this._config.getOrError(key);
    },

    /**
     * TODO: Doc. Subclass should override.
     */
    up: Promise.method(function() {}),

    /**
     * TODO: Doc. Subclass should override.
     */
    down: Promise.method(function() {})
  });

  return App;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../core/logging/logger"),
  require("../core/options"),
  require("../core/state-guard"),
  require("../runtime"),
  require("./internal/process-keep-alive")
);

})()
},{"../core/logging/logger":29,"../core/options":8,"../core/state-guard":9,"./internal/process-keep-alive":55,"../runtime":44,"underscore":57,"bluebird":58}],33:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  M,
  Logger,
  Options,
  UUID,
  DelegatingForwardingSequencer,
  UnitSequencer,
  InMemoryFiber,
  Mailbox,
  Dispatcher,
  SignalingDataStore,
  Periodic,
  ClockSequencer,
  SystemClock,
  Runtime
  ) {

  var Exchange = function() {
    this.initialize.apply(this, arguments);
  };

  var MSG_SEND             = Exchange.MSG_SEND             = "send",
      MSG_SEND_AND_RECEIVE = Exchange.MSG_SEND_AND_RECEIVE = "sendAndReceive",
      MSG_REPLY            = Exchange.MSG_REPLY            = "reply";

  // 7.5 seconds is reasonable, yes?
  var DEFAULT_REPLY_TIMEOUT = 7500;

  var Log = Logger.create("Exchange");


  _.extend(Exchange.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);

      this._identity = opts.getOrElse("identity", UUID.v4());

      this._runtime = opts.getOrElseFn("runtime", function() {
        return new Runtime();
      });

      this._mailboxFiberDelegate = {
        receiveFiberMessage: this._receiveMailboxFiberMessage.bind(this)
      };

      this._mailboxes = M.hash_map();

      this._fiber     = opts.getOrElseFn("fiber", function() {
        return new InMemoryFiber();
      });

      this._fiber.registerEntity({
        identity: this._identity,
        delegate: this
      });

      this._mailboxDispatcher = new Dispatcher({
        delegate: this,
        prefix: "_onMbx"
      });

      var usedDefaultClock = false;

      // For requester-provided requestId to messageId mapping.
      // Used for cancelling outstanding sendAndReceive requests.
      this._reqToMsg = M.hash_map();

      // Data store for pending requests
      this._outstandingRequests = new SignalingDataStore({
        ttl: opts.getOrElse("replyTimeout", DEFAULT_REPLY_TIMEOUT),
        sequencer: new ClockSequencer({
          clock: opts.getOrElseFn("clock", function() {
            usedDefaultClock = true;
            return new SystemClock();
          }),
          // Hax - Since we want time to be async, but provide a default system clock
          // we need to get the initial clock sequence sync, by bypassing the clock call.
          // If you provide an async clock, you should either provide an initial time, or
          // ensure that the first getTime has resolved before instantiating the exchange.
          // OR, in the future, we have to add a start()/stop() to Exchange.
          initialSequence: opts.getOrElse("initialSequence", (usedDefaultClock ? +new Date() : undefined))
        })
      });

      // Dispatches store signals (e.g., expiry)
      this._expiryDispatcher = new Dispatcher({
        delegate: this,
        prefix: "_onStoreSignal",
        listen: this._outstandingRequests.signalChannel()
      });

      this._compositeSeq = new DelegatingForwardingSequencer({
        delegate: new UnitSequencer(),
        targets: [this._outstandingRequests.sequencer(), this._outstandingRequests.sentrySequencer()]
      })

      // This guy triggers periodic expiry checks in the store
      this._checkExpiry = new Periodic({
        scheduler: this._runtime.scheduler(),
        task: _.bind(function() {
          return this._compositeSeq.advance();
        }, this),
        interval: opts.getOrElse("expiryInterval", 1000)
      });

      this._checkExpiry.start();
    },


    dispose: function() {
      // TODO: Cancel outstanding requests

      this._expiryDispatcher.dispose();

      this._outstandingRequests.clear();

      // TODO: Dispose all the things
      this._checkExpiry.dispose();
    },


    /**
     * Builds a Mailbox for the provided `requesterIdentity`. The
     * `RequesterIdentity` must never have been used for requesting
     * a mailbox previously.
     *
     * We attempt to validate unique mailbox names, but because mailbox names
     * are global and there is no checking between fibers, it's only a best-effort.
     *
     * @param requesterIdentity
     * @returns {Mailbox}
     */
    mailbox: function(requesterIdentity) {
      this._assertUniqueOwner(requesterIdentity);

      var mailbox = new Mailbox({
        exchange:      this,
        ownerIdentity: requesterIdentity
      });

      this._mailboxes = M.assoc(this._mailboxes, requesterIdentity, mailbox);

      this._fiber.registerEntity({
        identity: requesterIdentity,
        delegate: this._mailboxFiberDelegate
      });

      return mailbox;
    },


    send: function(env) {
      env = Options.fromObject(env);

      return this._fiber.send({
        from:  env.getOrError("from"),
        to:    env.getOrError("to"),
        body:  env.getOrError("body"),
        mT:    MSG_SEND,
        msgId: UUID.v4()
      });
    },


    reply: function(env) {
      env = Options.fromObject(env);
      return this._fiber.send({
        from:   env.getOrError("from"),
        to:     env.getOrError("to"),
        body:   env.getOrError("body"),
        mT:     MSG_REPLY,
        msgId:  UUID.v4(),
        rMsgId: env.getOrError("rMsgId")
      });
    },


    sendAndReceive: function(env, opts) {
      env  = Options.fromObject(env);
      opts = Options.fromObject(opts);

      var msgId = UUID.v4(),
          reqId    = opts.getOrError("reqId"),
          deferred = defer(),
          fibEnv   = {
            from:  env.getOrError("from"),
            to:    env.getOrError("to"),
            body:  env.getOrError("body"),
            mT:    MSG_SEND_AND_RECEIVE,
            msgId: msgId
          },
          req      = {
            reqId:    reqId,
            deferred: deferred,
            fibEnv:   fibEnv
          };

      this._reqToMsg = M.assoc(this._reqToMsg, reqId, msgId);

      return this
        ._outstandingRequests
        .put(msgId, req, {ttl: opts.getOrElse("replyTimeout")})
        .bind(this)
        .then(function() {
          return this._fiber.send(fibEnv);
        })
        .then(function() {
          return req.deferred.promise;
        });
    },

    cancelSendAndReceive: Promise.method(function(reqId) {
      var msgId = M.get(this._reqToMsg, reqId);

      if (msgId) {
        Log.debug("Canceling request", reqId, "with msgId", msgId);
        this._reqToMsg = M.dissoc(this._reqToMsg, reqId);

        return Promise
          .bind(this)
          .then(function() {
            return this._outstandingRequests.remove(msgId);
          })
          .then(function(req) {
            if (req) {
              req.deferred.reject(new Promise.CancellationError());
            }
          })
      } else {
        Log.warn("Tried to cancel request, but no oustanding request with that ID found;", reqId);
      }
    }),


    _assertUniqueOwner: function(identity) {
      if (M.get(this._mailboxes, identity)) {
        throw new Error("Mailbox registration requires a unique identity");
      }
    },


    /**
     * Fiber delegate protocol method for a message bound for a Mailbox owned by
     * this exchange.
     *
     * @param env
     * @private
     */
    _receiveMailboxFiberMessage: function(env) {
      this._mailboxDispatcher.dispatch(env);
    },


    _onMbxSend: function(env) {
      var oEnv     = Options.fromObject(env),
          identity = oEnv.getOrElse("to"),
          body     = oEnv.getOrElse("body");

      if (!(identity || body)) {
        Log.info("Exchange received a message with missing envelope information", env);
        return;
      }

      var mbox = M.get(this._mailboxes, identity);
      if (mbox) {
        mbox._receiveOneShot(env);
      }
    },

    // TODO: Should this go along the mailbox ingress channel?
    // Or should it be cb-based?
    _onMbxSendAndReceive: function(env) {
      var oEnv = Options.fromObject(env),
          identity = oEnv.getOrElse("to"),
          body = oEnv.getOrElse("body");

      if (!(identity || body)) {
        Log.info("Exchange received a message with missing envelope information", env);
        return;
      }

      var mbox = M.get(this._mailboxes, identity);
      if (mbox) {
        mbox._receiveRequestReply(env);
      }
    },


    _onMbxReply: function(env) {
      var oEnv     = Options.fromObject(env),
          rMsgId   = oEnv.getOrElse("rMsgId");



      // Don't dispatch vetted replies. Just fulfill the promise
      Promise
        .bind(this)
        .then(function(){
          return this._outstandingRequests.remove(rMsgId);
        })
        .then(function(request) {
          if (request) {
            this._reqToMsg = M.dissoc(this._reqToMsg, request.reqId);
            request.deferred.resolve(env);
          }
        });
    },


    /**
     * Fired when a request in the outstanding requests store is past due.
     */
    _onStoreSignalExpired: function(sig) {
      Log.debug("Expired entry in store", sig);
      Promise
        .bind(this)
        .then(function() {
          return this._outstandingRequests.remove(sig.key);
        })
        .then(function(request) {
          if (request) {
            this._reqToMsg = M.dissoc(this._reqToMsg, request.reqId);
            request.deferred.reject(new Promise.TimeoutError());
          }
        });
    },


    /**
     * Fiber delegate protocol method for a message bound for this Exchange directly.
     *
     * @param env
     * @private
     */
    receiveFiberMessage: function(env) {
      throw new Error("Not implemented");
    }
  });


  var defer = function(){
    var res, rej;
    var p = new Promise(function() {
      res = arguments[0];
      rej = arguments[1];
    });

    return {
      promise: p,
      resolve: res,
      reject: rej
    };
  };

  return Exchange;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("mori"),
  require("../core/logging/logger"),
  require("../core/options"),
  require("../core/uuid"),
  require("../core/sequencer/delegating-forwarding-sequencer"),
  require("../core/sequencer/unit-sequencer"),
  require("./fiber/in-memory-fiber"),
  require("./internals/mailbox"),
  require("../core/dispatcher"),
  require("../storage/signaling-data-store"),
  require("../util/periodic"),
  require("../core/sequencer/clock-sequencer"),
  require("../time/clock/system-clock"),
  require("../runtime")
);

})()
},{"../core/options":8,"../core/logging/logger":29,"../core/sequencer/delegating-forwarding-sequencer":15,"./fiber/in-memory-fiber":36,"../core/uuid":38,"../core/sequencer/unit-sequencer":14,"./internals/mailbox":54,"../core/dispatcher":5,"../util/periodic":3,"../core/sequencer/clock-sequencer":12,"../storage/signaling-data-store":21,"../time/clock/system-clock":24,"../runtime":44,"underscore":57,"mori":59,"bluebird":58}],35:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  M,
  Options,
  UUID,
  StateGuard,
  Logger,
  Dispatcher
) {

  var Courier = function() {
    this.initialize.apply(this, arguments);
  };

  var MSG_REPLY = Courier.MSG_REPLY = "cReply";

  var Log = Logger.create("Courier");

  _.extend(Courier.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);

      this._id         = UUID.v4();
      this._delegate   = opts.getOrError("delegate");
      this._mailbox    = opts.getOrError("mailbox");
      this._stateGuard = new StateGuard(["disposed"]);

      _.bindAll(this, "_onOneShotMessage", "_onRequestReplyMessage", "_defaultContextDelegate");

      this._contextDelegate = opts.getOrElse("contextDelegate", this._defaultContextDelegate);

      this._oneShotDispatcher = new Dispatcher({
        delegate: this._delegate,
        prefix: opts.getOrElse("oneShotPrefix", "onMsg"),
        contextDelegate: this._contextDelegate
      });

      this._requestReplyDispatcher = new Dispatcher({
        delegate: this._delegate,
        prefix: opts.getOrElse("requestReplyPrefix", "onReq"),
        contextDelegate: this._contextDelegate
      });

      this._subs = M.vector(
        this._mailbox.oneShotChannel().subscribe(this._onOneShotMessage),
        this._mailbox.requestReplyChannel().subscribe(this._onRequestReplyMessage)
      );
    },


    id: function() {
      return this._id;
    },

    send: Promise.method(function(to, msg) {
      this._stateGuard.deny("disposed");

      return this._mailbox.send({
        to: to,
        body: msg
      });
    }),

    sendAndReceive: Promise.method(function(to, msg, opts) {
      this._stateGuard.deny("disposed");

      return this._mailbox
        .sendAndReceive({
          to: to,
          body: msg
        }, opts)
        .then(function(res) {

          if (res.body && res.body.mT === MSG_REPLY && res.body.body) {
            // Unwrap the remote message
            if (res.body.body.err) {
              throw new Error(res.body.body.err);
            }
            return res.body.body.res;
          } else {
            // Someone is misbehaving
            Log.warn("Received sendAndReceive reply, but it isn't Courier-compatible", this._mailbox.ownerIdentity(), res);
            return res;
          }
        })
    }),

    dispose: function() {
      if (this._stateGuard.applied("disposed")) {
        return;
      }


      M.each(this._subs, function(sub) {
        sub.dispose();
      });

      this._subs     = null;
      this._mailbox  = null;
      this._delegate = null;

      this._stateGuard.apply("disposed");
    },

    _defaultContextDelegate: function(mTyped) {
      return {
        mailbox: this._mailbox
      };
    },

    _onOneShotMessage: function(msg) {
      this._oneShotDispatcher.dispatch(msg.body, msg);
    },


    _onRequestReplyMessage: function(msg) {
      this._requestReplyDispatcher
        .dispatchAsync(msg.body, msg)
        .bind({
          mbox: this._mailbox,
          err: null,
          result: null
        })
        .then(function(result){
          this.result = result;
        })
        .caught(function(err) {
          this.err = err.message;
        })
        .lastly(function() {
          this.mbox.reply(msg.msgId, {
            to: msg.from,
            body: {
              mT: MSG_REPLY,
              body: {
                err: this.err,
                res: this.result
              }
            }
          });
        });
    }
  });

  return Courier;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("mori"),
  require("../core/options"),
  require("../core/uuid"),
  require("../core/state-guard"),
  require("../core/logging/logger"),
  require("../core/dispatcher")
);

})()
},{"../core/options":8,"../core/uuid":38,"../core/state-guard":9,"../core/logging/logger":29,"../core/dispatcher":5,"underscore":57,"mori":59,"bluebird":58}],38:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

/**
 * Exports a singleton
 */

var mod = function(
  _
) {

  var UUID = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(UUID.prototype, {
    initialize: function() {},
    // See: http://en.wikipedia.org/wiki/Universally_unique_identifier#Version_4_.28random.29
    v4: function() {
      return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
        var r = Math.random() * 16 | 0;
        // 0x3       = 0b00011
        // 0x8       = 0b01000
        // 0x3 | 0x8 = 0b01011
        // r & 0x3   = (0b00000 | 0b00001 | 0b00010 | 0b00011)
        var v = (c == 'x' ? r : (r & 0x3 | 0x8));
        return v.toString(16);
      });
    }
  });

  return new UUID();
};

module.exports = mod(
  require("underscore")
);

})()
},{"underscore":57}],40:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options
) {

  var ComponentRegistry = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(ComponentRegistry.prototype, {
    initialize: function() {
      this._modules = {};
    },


    register: function(opts) {
      opts = Options.fromObject(opts);
      var aliases   = opts.getOrError("as"),
          modObject = opts.getOrError("module");

      if (!_.isArray(aliases)) {
        aliases = [ aliases ];
      }

      _.each(aliases, _.bind(function(alias) {
        this._modules[alias] = modObject;
      }, this));

      return this;
    },

    selfRegister: function(opts) {
      opts = Options.fromObject(opts);

      return this.register({
        as: opts.getOrError("as"),
        module: ComponentRegistry
      });
    },


    registerMany: function(aliasesAry) {
      _.each(aliasesAry, _.bind(function(alias) {
        this.register(alias);
      }, this));
      return this;
    },

    component: function(alias) {
      var m = this._modules[alias];
      if (!m) {
        throw new Error("Invalid alias provided (no such module): `"+alias+"'");
      }
      return m;
    }

  });

  ComponentRegistry.prototype.c = ComponentRegistry.prototype.component;

  return ComponentRegistry;
};

module.exports = mod(
  require("underscore"),
  require("../core/options")
);

})()
},{"../core/options":8,"underscore":57}],56:[function(require,module,exports){
"use strict";

module.exports = require("./web-scheduler");

},{"./web-scheduler":47}],57:[function(require,module,exports){
(function(){//     Underscore.js 1.6.0
//     http://underscorejs.org
//     (c) 2009-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.

(function() {

  // Baseline setup
  // --------------

  // Establish the root object, `window` in the browser, or `exports` on the server.
  var root = this;

  // Save the previous value of the `_` variable.
  var previousUnderscore = root._;

  // Establish the object that gets returned to break out of a loop iteration.
  var breaker = {};

  // Save bytes in the minified (but not gzipped) version:
  var ArrayProto = Array.prototype, ObjProto = Object.prototype, FuncProto = Function.prototype;

  // Create quick reference variables for speed access to core prototypes.
  var
    push             = ArrayProto.push,
    slice            = ArrayProto.slice,
    concat           = ArrayProto.concat,
    toString         = ObjProto.toString,
    hasOwnProperty   = ObjProto.hasOwnProperty;

  // All **ECMAScript 5** native function implementations that we hope to use
  // are declared here.
  var
    nativeForEach      = ArrayProto.forEach,
    nativeMap          = ArrayProto.map,
    nativeReduce       = ArrayProto.reduce,
    nativeReduceRight  = ArrayProto.reduceRight,
    nativeFilter       = ArrayProto.filter,
    nativeEvery        = ArrayProto.every,
    nativeSome         = ArrayProto.some,
    nativeIndexOf      = ArrayProto.indexOf,
    nativeLastIndexOf  = ArrayProto.lastIndexOf,
    nativeIsArray      = Array.isArray,
    nativeKeys         = Object.keys,
    nativeBind         = FuncProto.bind;

  // Create a safe reference to the Underscore object for use below.
  var _ = function(obj) {
    if (obj instanceof _) return obj;
    if (!(this instanceof _)) return new _(obj);
    this._wrapped = obj;
  };

  // Export the Underscore object for **Node.js**, with
  // backwards-compatibility for the old `require()` API. If we're in
  // the browser, add `_` as a global object via a string identifier,
  // for Closure Compiler "advanced" mode.
  if (typeof exports !== 'undefined') {
    if (typeof module !== 'undefined' && module.exports) {
      exports = module.exports = _;
    }
    exports._ = _;
  } else {
    root._ = _;
  }

  // Current version.
  _.VERSION = '1.6.0';

  // Collection Functions
  // --------------------

  // The cornerstone, an `each` implementation, aka `forEach`.
  // Handles objects with the built-in `forEach`, arrays, and raw objects.
  // Delegates to **ECMAScript 5**'s native `forEach` if available.
  var each = _.each = _.forEach = function(obj, iterator, context) {
    if (obj == null) return obj;
    if (nativeForEach && obj.forEach === nativeForEach) {
      obj.forEach(iterator, context);
    } else if (obj.length === +obj.length) {
      for (var i = 0, length = obj.length; i < length; i++) {
        if (iterator.call(context, obj[i], i, obj) === breaker) return;
      }
    } else {
      var keys = _.keys(obj);
      for (var i = 0, length = keys.length; i < length; i++) {
        if (iterator.call(context, obj[keys[i]], keys[i], obj) === breaker) return;
      }
    }
    return obj;
  };

  // Return the results of applying the iterator to each element.
  // Delegates to **ECMAScript 5**'s native `map` if available.
  _.map = _.collect = function(obj, iterator, context) {
    var results = [];
    if (obj == null) return results;
    if (nativeMap && obj.map === nativeMap) return obj.map(iterator, context);
    each(obj, function(value, index, list) {
      results.push(iterator.call(context, value, index, list));
    });
    return results;
  };

  var reduceError = 'Reduce of empty array with no initial value';

  // **Reduce** builds up a single result from a list of values, aka `inject`,
  // or `foldl`. Delegates to **ECMAScript 5**'s native `reduce` if available.
  _.reduce = _.foldl = _.inject = function(obj, iterator, memo, context) {
    var initial = arguments.length > 2;
    if (obj == null) obj = [];
    if (nativeReduce && obj.reduce === nativeReduce) {
      if (context) iterator = _.bind(iterator, context);
      return initial ? obj.reduce(iterator, memo) : obj.reduce(iterator);
    }
    each(obj, function(value, index, list) {
      if (!initial) {
        memo = value;
        initial = true;
      } else {
        memo = iterator.call(context, memo, value, index, list);
      }
    });
    if (!initial) throw new TypeError(reduceError);
    return memo;
  };

  // The right-associative version of reduce, also known as `foldr`.
  // Delegates to **ECMAScript 5**'s native `reduceRight` if available.
  _.reduceRight = _.foldr = function(obj, iterator, memo, context) {
    var initial = arguments.length > 2;
    if (obj == null) obj = [];
    if (nativeReduceRight && obj.reduceRight === nativeReduceRight) {
      if (context) iterator = _.bind(iterator, context);
      return initial ? obj.reduceRight(iterator, memo) : obj.reduceRight(iterator);
    }
    var length = obj.length;
    if (length !== +length) {
      var keys = _.keys(obj);
      length = keys.length;
    }
    each(obj, function(value, index, list) {
      index = keys ? keys[--length] : --length;
      if (!initial) {
        memo = obj[index];
        initial = true;
      } else {
        memo = iterator.call(context, memo, obj[index], index, list);
      }
    });
    if (!initial) throw new TypeError(reduceError);
    return memo;
  };

  // Return the first value which passes a truth test. Aliased as `detect`.
  _.find = _.detect = function(obj, predicate, context) {
    var result;
    any(obj, function(value, index, list) {
      if (predicate.call(context, value, index, list)) {
        result = value;
        return true;
      }
    });
    return result;
  };

  // Return all the elements that pass a truth test.
  // Delegates to **ECMAScript 5**'s native `filter` if available.
  // Aliased as `select`.
  _.filter = _.select = function(obj, predicate, context) {
    var results = [];
    if (obj == null) return results;
    if (nativeFilter && obj.filter === nativeFilter) return obj.filter(predicate, context);
    each(obj, function(value, index, list) {
      if (predicate.call(context, value, index, list)) results.push(value);
    });
    return results;
  };

  // Return all the elements for which a truth test fails.
  _.reject = function(obj, predicate, context) {
    return _.filter(obj, function(value, index, list) {
      return !predicate.call(context, value, index, list);
    }, context);
  };

  // Determine whether all of the elements match a truth test.
  // Delegates to **ECMAScript 5**'s native `every` if available.
  // Aliased as `all`.
  _.every = _.all = function(obj, predicate, context) {
    predicate || (predicate = _.identity);
    var result = true;
    if (obj == null) return result;
    if (nativeEvery && obj.every === nativeEvery) return obj.every(predicate, context);
    each(obj, function(value, index, list) {
      if (!(result = result && predicate.call(context, value, index, list))) return breaker;
    });
    return !!result;
  };

  // Determine if at least one element in the object matches a truth test.
  // Delegates to **ECMAScript 5**'s native `some` if available.
  // Aliased as `any`.
  var any = _.some = _.any = function(obj, predicate, context) {
    predicate || (predicate = _.identity);
    var result = false;
    if (obj == null) return result;
    if (nativeSome && obj.some === nativeSome) return obj.some(predicate, context);
    each(obj, function(value, index, list) {
      if (result || (result = predicate.call(context, value, index, list))) return breaker;
    });
    return !!result;
  };

  // Determine if the array or object contains a given value (using `===`).
  // Aliased as `include`.
  _.contains = _.include = function(obj, target) {
    if (obj == null) return false;
    if (nativeIndexOf && obj.indexOf === nativeIndexOf) return obj.indexOf(target) != -1;
    return any(obj, function(value) {
      return value === target;
    });
  };

  // Invoke a method (with arguments) on every item in a collection.
  _.invoke = function(obj, method) {
    var args = slice.call(arguments, 2);
    var isFunc = _.isFunction(method);
    return _.map(obj, function(value) {
      return (isFunc ? method : value[method]).apply(value, args);
    });
  };

  // Convenience version of a common use case of `map`: fetching a property.
  _.pluck = function(obj, key) {
    return _.map(obj, _.property(key));
  };

  // Convenience version of a common use case of `filter`: selecting only objects
  // containing specific `key:value` pairs.
  _.where = function(obj, attrs) {
    return _.filter(obj, _.matches(attrs));
  };

  // Convenience version of a common use case of `find`: getting the first object
  // containing specific `key:value` pairs.
  _.findWhere = function(obj, attrs) {
    return _.find(obj, _.matches(attrs));
  };

  // Return the maximum element or (element-based computation).
  // Can't optimize arrays of integers longer than 65,535 elements.
  // See [WebKit Bug 80797](https://bugs.webkit.org/show_bug.cgi?id=80797)
  _.max = function(obj, iterator, context) {
    if (!iterator && _.isArray(obj) && obj[0] === +obj[0] && obj.length < 65535) {
      return Math.max.apply(Math, obj);
    }
    var result = -Infinity, lastComputed = -Infinity;
    each(obj, function(value, index, list) {
      var computed = iterator ? iterator.call(context, value, index, list) : value;
      if (computed > lastComputed) {
        result = value;
        lastComputed = computed;
      }
    });
    return result;
  };

  // Return the minimum element (or element-based computation).
  _.min = function(obj, iterator, context) {
    if (!iterator && _.isArray(obj) && obj[0] === +obj[0] && obj.length < 65535) {
      return Math.min.apply(Math, obj);
    }
    var result = Infinity, lastComputed = Infinity;
    each(obj, function(value, index, list) {
      var computed = iterator ? iterator.call(context, value, index, list) : value;
      if (computed < lastComputed) {
        result = value;
        lastComputed = computed;
      }
    });
    return result;
  };

  // Shuffle an array, using the modern version of the
  // [Fisher-Yates shuffle](http://en.wikipedia.org/wiki/FisherYates_shuffle).
  _.shuffle = function(obj) {
    var rand;
    var index = 0;
    var shuffled = [];
    each(obj, function(value) {
      rand = _.random(index++);
      shuffled[index - 1] = shuffled[rand];
      shuffled[rand] = value;
    });
    return shuffled;
  };

  // Sample **n** random values from a collection.
  // If **n** is not specified, returns a single random element.
  // The internal `guard` argument allows it to work with `map`.
  _.sample = function(obj, n, guard) {
    if (n == null || guard) {
      if (obj.length !== +obj.length) obj = _.values(obj);
      return obj[_.random(obj.length - 1)];
    }
    return _.shuffle(obj).slice(0, Math.max(0, n));
  };

  // An internal function to generate lookup iterators.
  var lookupIterator = function(value) {
    if (value == null) return _.identity;
    if (_.isFunction(value)) return value;
    return _.property(value);
  };

  // Sort the object's values by a criterion produced by an iterator.
  _.sortBy = function(obj, iterator, context) {
    iterator = lookupIterator(iterator);
    return _.pluck(_.map(obj, function(value, index, list) {
      return {
        value: value,
        index: index,
        criteria: iterator.call(context, value, index, list)
      };
    }).sort(function(left, right) {
      var a = left.criteria;
      var b = right.criteria;
      if (a !== b) {
        if (a > b || a === void 0) return 1;
        if (a < b || b === void 0) return -1;
      }
      return left.index - right.index;
    }), 'value');
  };

  // An internal function used for aggregate "group by" operations.
  var group = function(behavior) {
    return function(obj, iterator, context) {
      var result = {};
      iterator = lookupIterator(iterator);
      each(obj, function(value, index) {
        var key = iterator.call(context, value, index, obj);
        behavior(result, key, value);
      });
      return result;
    };
  };

  // Groups the object's values by a criterion. Pass either a string attribute
  // to group by, or a function that returns the criterion.
  _.groupBy = group(function(result, key, value) {
    _.has(result, key) ? result[key].push(value) : result[key] = [value];
  });

  // Indexes the object's values by a criterion, similar to `groupBy`, but for
  // when you know that your index values will be unique.
  _.indexBy = group(function(result, key, value) {
    result[key] = value;
  });

  // Counts instances of an object that group by a certain criterion. Pass
  // either a string attribute to count by, or a function that returns the
  // criterion.
  _.countBy = group(function(result, key) {
    _.has(result, key) ? result[key]++ : result[key] = 1;
  });

  // Use a comparator function to figure out the smallest index at which
  // an object should be inserted so as to maintain order. Uses binary search.
  _.sortedIndex = function(array, obj, iterator, context) {
    iterator = lookupIterator(iterator);
    var value = iterator.call(context, obj);
    var low = 0, high = array.length;
    while (low < high) {
      var mid = (low + high) >>> 1;
      iterator.call(context, array[mid]) < value ? low = mid + 1 : high = mid;
    }
    return low;
  };

  // Safely create a real, live array from anything iterable.
  _.toArray = function(obj) {
    if (!obj) return [];
    if (_.isArray(obj)) return slice.call(obj);
    if (obj.length === +obj.length) return _.map(obj, _.identity);
    return _.values(obj);
  };

  // Return the number of elements in an object.
  _.size = function(obj) {
    if (obj == null) return 0;
    return (obj.length === +obj.length) ? obj.length : _.keys(obj).length;
  };

  // Array Functions
  // ---------------

  // Get the first element of an array. Passing **n** will return the first N
  // values in the array. Aliased as `head` and `take`. The **guard** check
  // allows it to work with `_.map`.
  _.first = _.head = _.take = function(array, n, guard) {
    if (array == null) return void 0;
    if ((n == null) || guard) return array[0];
    if (n < 0) return [];
    return slice.call(array, 0, n);
  };

  // Returns everything but the last entry of the array. Especially useful on
  // the arguments object. Passing **n** will return all the values in
  // the array, excluding the last N. The **guard** check allows it to work with
  // `_.map`.
  _.initial = function(array, n, guard) {
    return slice.call(array, 0, array.length - ((n == null) || guard ? 1 : n));
  };

  // Get the last element of an array. Passing **n** will return the last N
  // values in the array. The **guard** check allows it to work with `_.map`.
  _.last = function(array, n, guard) {
    if (array == null) return void 0;
    if ((n == null) || guard) return array[array.length - 1];
    return slice.call(array, Math.max(array.length - n, 0));
  };

  // Returns everything but the first entry of the array. Aliased as `tail` and `drop`.
  // Especially useful on the arguments object. Passing an **n** will return
  // the rest N values in the array. The **guard**
  // check allows it to work with `_.map`.
  _.rest = _.tail = _.drop = function(array, n, guard) {
    return slice.call(array, (n == null) || guard ? 1 : n);
  };

  // Trim out all falsy values from an array.
  _.compact = function(array) {
    return _.filter(array, _.identity);
  };

  // Internal implementation of a recursive `flatten` function.
  var flatten = function(input, shallow, output) {
    if (shallow && _.every(input, _.isArray)) {
      return concat.apply(output, input);
    }
    each(input, function(value) {
      if (_.isArray(value) || _.isArguments(value)) {
        shallow ? push.apply(output, value) : flatten(value, shallow, output);
      } else {
        output.push(value);
      }
    });
    return output;
  };

  // Flatten out an array, either recursively (by default), or just one level.
  _.flatten = function(array, shallow) {
    return flatten(array, shallow, []);
  };

  // Return a version of the array that does not contain the specified value(s).
  _.without = function(array) {
    return _.difference(array, slice.call(arguments, 1));
  };

  // Split an array into two arrays: one whose elements all satisfy the given
  // predicate, and one whose elements all do not satisfy the predicate.
  _.partition = function(array, predicate) {
    var pass = [], fail = [];
    each(array, function(elem) {
      (predicate(elem) ? pass : fail).push(elem);
    });
    return [pass, fail];
  };

  // Produce a duplicate-free version of the array. If the array has already
  // been sorted, you have the option of using a faster algorithm.
  // Aliased as `unique`.
  _.uniq = _.unique = function(array, isSorted, iterator, context) {
    if (_.isFunction(isSorted)) {
      context = iterator;
      iterator = isSorted;
      isSorted = false;
    }
    var initial = iterator ? _.map(array, iterator, context) : array;
    var results = [];
    var seen = [];
    each(initial, function(value, index) {
      if (isSorted ? (!index || seen[seen.length - 1] !== value) : !_.contains(seen, value)) {
        seen.push(value);
        results.push(array[index]);
      }
    });
    return results;
  };

  // Produce an array that contains the union: each distinct element from all of
  // the passed-in arrays.
  _.union = function() {
    return _.uniq(_.flatten(arguments, true));
  };

  // Produce an array that contains every item shared between all the
  // passed-in arrays.
  _.intersection = function(array) {
    var rest = slice.call(arguments, 1);
    return _.filter(_.uniq(array), function(item) {
      return _.every(rest, function(other) {
        return _.contains(other, item);
      });
    });
  };

  // Take the difference between one array and a number of other arrays.
  // Only the elements present in just the first array will remain.
  _.difference = function(array) {
    var rest = concat.apply(ArrayProto, slice.call(arguments, 1));
    return _.filter(array, function(value){ return !_.contains(rest, value); });
  };

  // Zip together multiple lists into a single array -- elements that share
  // an index go together.
  _.zip = function() {
    var length = _.max(_.pluck(arguments, 'length').concat(0));
    var results = new Array(length);
    for (var i = 0; i < length; i++) {
      results[i] = _.pluck(arguments, '' + i);
    }
    return results;
  };

  // Converts lists into objects. Pass either a single array of `[key, value]`
  // pairs, or two parallel arrays of the same length -- one of keys, and one of
  // the corresponding values.
  _.object = function(list, values) {
    if (list == null) return {};
    var result = {};
    for (var i = 0, length = list.length; i < length; i++) {
      if (values) {
        result[list[i]] = values[i];
      } else {
        result[list[i][0]] = list[i][1];
      }
    }
    return result;
  };

  // If the browser doesn't supply us with indexOf (I'm looking at you, **MSIE**),
  // we need this function. Return the position of the first occurrence of an
  // item in an array, or -1 if the item is not included in the array.
  // Delegates to **ECMAScript 5**'s native `indexOf` if available.
  // If the array is large and already in sort order, pass `true`
  // for **isSorted** to use binary search.
  _.indexOf = function(array, item, isSorted) {
    if (array == null) return -1;
    var i = 0, length = array.length;
    if (isSorted) {
      if (typeof isSorted == 'number') {
        i = (isSorted < 0 ? Math.max(0, length + isSorted) : isSorted);
      } else {
        i = _.sortedIndex(array, item);
        return array[i] === item ? i : -1;
      }
    }
    if (nativeIndexOf && array.indexOf === nativeIndexOf) return array.indexOf(item, isSorted);
    for (; i < length; i++) if (array[i] === item) return i;
    return -1;
  };

  // Delegates to **ECMAScript 5**'s native `lastIndexOf` if available.
  _.lastIndexOf = function(array, item, from) {
    if (array == null) return -1;
    var hasIndex = from != null;
    if (nativeLastIndexOf && array.lastIndexOf === nativeLastIndexOf) {
      return hasIndex ? array.lastIndexOf(item, from) : array.lastIndexOf(item);
    }
    var i = (hasIndex ? from : array.length);
    while (i--) if (array[i] === item) return i;
    return -1;
  };

  // Generate an integer Array containing an arithmetic progression. A port of
  // the native Python `range()` function. See
  // [the Python documentation](http://docs.python.org/library/functions.html#range).
  _.range = function(start, stop, step) {
    if (arguments.length <= 1) {
      stop = start || 0;
      start = 0;
    }
    step = arguments[2] || 1;

    var length = Math.max(Math.ceil((stop - start) / step), 0);
    var idx = 0;
    var range = new Array(length);

    while(idx < length) {
      range[idx++] = start;
      start += step;
    }

    return range;
  };

  // Function (ahem) Functions
  // ------------------

  // Reusable constructor function for prototype setting.
  var ctor = function(){};

  // Create a function bound to a given object (assigning `this`, and arguments,
  // optionally). Delegates to **ECMAScript 5**'s native `Function.bind` if
  // available.
  _.bind = function(func, context) {
    var args, bound;
    if (nativeBind && func.bind === nativeBind) return nativeBind.apply(func, slice.call(arguments, 1));
    if (!_.isFunction(func)) throw new TypeError;
    args = slice.call(arguments, 2);
    return bound = function() {
      if (!(this instanceof bound)) return func.apply(context, args.concat(slice.call(arguments)));
      ctor.prototype = func.prototype;
      var self = new ctor;
      ctor.prototype = null;
      var result = func.apply(self, args.concat(slice.call(arguments)));
      if (Object(result) === result) return result;
      return self;
    };
  };

  // Partially apply a function by creating a version that has had some of its
  // arguments pre-filled, without changing its dynamic `this` context. _ acts
  // as a placeholder, allowing any combination of arguments to be pre-filled.
  _.partial = function(func) {
    var boundArgs = slice.call(arguments, 1);
    return function() {
      var position = 0;
      var args = boundArgs.slice();
      for (var i = 0, length = args.length; i < length; i++) {
        if (args[i] === _) args[i] = arguments[position++];
      }
      while (position < arguments.length) args.push(arguments[position++]);
      return func.apply(this, args);
    };
  };

  // Bind a number of an object's methods to that object. Remaining arguments
  // are the method names to be bound. Useful for ensuring that all callbacks
  // defined on an object belong to it.
  _.bindAll = function(obj) {
    var funcs = slice.call(arguments, 1);
    if (funcs.length === 0) throw new Error('bindAll must be passed function names');
    each(funcs, function(f) { obj[f] = _.bind(obj[f], obj); });
    return obj;
  };

  // Memoize an expensive function by storing its results.
  _.memoize = function(func, hasher) {
    var memo = {};
    hasher || (hasher = _.identity);
    return function() {
      var key = hasher.apply(this, arguments);
      return _.has(memo, key) ? memo[key] : (memo[key] = func.apply(this, arguments));
    };
  };

  // Delays a function for the given number of milliseconds, and then calls
  // it with the arguments supplied.
  _.delay = function(func, wait) {
    var args = slice.call(arguments, 2);
    return setTimeout(function(){ return func.apply(null, args); }, wait);
  };

  // Defers a function, scheduling it to run after the current call stack has
  // cleared.
  _.defer = function(func) {
    return _.delay.apply(_, [func, 1].concat(slice.call(arguments, 1)));
  };

  // Returns a function, that, when invoked, will only be triggered at most once
  // during a given window of time. Normally, the throttled function will run
  // as much as it can, without ever going more than once per `wait` duration;
  // but if you'd like to disable the execution on the leading edge, pass
  // `{leading: false}`. To disable execution on the trailing edge, ditto.
  _.throttle = function(func, wait, options) {
    var context, args, result;
    var timeout = null;
    var previous = 0;
    options || (options = {});
    var later = function() {
      previous = options.leading === false ? 0 : _.now();
      timeout = null;
      result = func.apply(context, args);
      context = args = null;
    };
    return function() {
      var now = _.now();
      if (!previous && options.leading === false) previous = now;
      var remaining = wait - (now - previous);
      context = this;
      args = arguments;
      if (remaining <= 0) {
        clearTimeout(timeout);
        timeout = null;
        previous = now;
        result = func.apply(context, args);
        context = args = null;
      } else if (!timeout && options.trailing !== false) {
        timeout = setTimeout(later, remaining);
      }
      return result;
    };
  };

  // Returns a function, that, as long as it continues to be invoked, will not
  // be triggered. The function will be called after it stops being called for
  // N milliseconds. If `immediate` is passed, trigger the function on the
  // leading edge, instead of the trailing.
  _.debounce = function(func, wait, immediate) {
    var timeout, args, context, timestamp, result;

    var later = function() {
      var last = _.now() - timestamp;
      if (last < wait) {
        timeout = setTimeout(later, wait - last);
      } else {
        timeout = null;
        if (!immediate) {
          result = func.apply(context, args);
          context = args = null;
        }
      }
    };

    return function() {
      context = this;
      args = arguments;
      timestamp = _.now();
      var callNow = immediate && !timeout;
      if (!timeout) {
        timeout = setTimeout(later, wait);
      }
      if (callNow) {
        result = func.apply(context, args);
        context = args = null;
      }

      return result;
    };
  };

  // Returns a function that will be executed at most one time, no matter how
  // often you call it. Useful for lazy initialization.
  _.once = function(func) {
    var ran = false, memo;
    return function() {
      if (ran) return memo;
      ran = true;
      memo = func.apply(this, arguments);
      func = null;
      return memo;
    };
  };

  // Returns the first function passed as an argument to the second,
  // allowing you to adjust arguments, run code before and after, and
  // conditionally execute the original function.
  _.wrap = function(func, wrapper) {
    return _.partial(wrapper, func);
  };

  // Returns a function that is the composition of a list of functions, each
  // consuming the return value of the function that follows.
  _.compose = function() {
    var funcs = arguments;
    return function() {
      var args = arguments;
      for (var i = funcs.length - 1; i >= 0; i--) {
        args = [funcs[i].apply(this, args)];
      }
      return args[0];
    };
  };

  // Returns a function that will only be executed after being called N times.
  _.after = function(times, func) {
    return function() {
      if (--times < 1) {
        return func.apply(this, arguments);
      }
    };
  };

  // Object Functions
  // ----------------

  // Retrieve the names of an object's properties.
  // Delegates to **ECMAScript 5**'s native `Object.keys`
  _.keys = function(obj) {
    if (!_.isObject(obj)) return [];
    if (nativeKeys) return nativeKeys(obj);
    var keys = [];
    for (var key in obj) if (_.has(obj, key)) keys.push(key);
    return keys;
  };

  // Retrieve the values of an object's properties.
  _.values = function(obj) {
    var keys = _.keys(obj);
    var length = keys.length;
    var values = new Array(length);
    for (var i = 0; i < length; i++) {
      values[i] = obj[keys[i]];
    }
    return values;
  };

  // Convert an object into a list of `[key, value]` pairs.
  _.pairs = function(obj) {
    var keys = _.keys(obj);
    var length = keys.length;
    var pairs = new Array(length);
    for (var i = 0; i < length; i++) {
      pairs[i] = [keys[i], obj[keys[i]]];
    }
    return pairs;
  };

  // Invert the keys and values of an object. The values must be serializable.
  _.invert = function(obj) {
    var result = {};
    var keys = _.keys(obj);
    for (var i = 0, length = keys.length; i < length; i++) {
      result[obj[keys[i]]] = keys[i];
    }
    return result;
  };

  // Return a sorted list of the function names available on the object.
  // Aliased as `methods`
  _.functions = _.methods = function(obj) {
    var names = [];
    for (var key in obj) {
      if (_.isFunction(obj[key])) names.push(key);
    }
    return names.sort();
  };

  // Extend a given object with all the properties in passed-in object(s).
  _.extend = function(obj) {
    each(slice.call(arguments, 1), function(source) {
      if (source) {
        for (var prop in source) {
          obj[prop] = source[prop];
        }
      }
    });
    return obj;
  };

  // Return a copy of the object only containing the whitelisted properties.
  _.pick = function(obj) {
    var copy = {};
    var keys = concat.apply(ArrayProto, slice.call(arguments, 1));
    each(keys, function(key) {
      if (key in obj) copy[key] = obj[key];
    });
    return copy;
  };

   // Return a copy of the object without the blacklisted properties.
  _.omit = function(obj) {
    var copy = {};
    var keys = concat.apply(ArrayProto, slice.call(arguments, 1));
    for (var key in obj) {
      if (!_.contains(keys, key)) copy[key] = obj[key];
    }
    return copy;
  };

  // Fill in a given object with default properties.
  _.defaults = function(obj) {
    each(slice.call(arguments, 1), function(source) {
      if (source) {
        for (var prop in source) {
          if (obj[prop] === void 0) obj[prop] = source[prop];
        }
      }
    });
    return obj;
  };

  // Create a (shallow-cloned) duplicate of an object.
  _.clone = function(obj) {
    if (!_.isObject(obj)) return obj;
    return _.isArray(obj) ? obj.slice() : _.extend({}, obj);
  };

  // Invokes interceptor with the obj, and then returns obj.
  // The primary purpose of this method is to "tap into" a method chain, in
  // order to perform operations on intermediate results within the chain.
  _.tap = function(obj, interceptor) {
    interceptor(obj);
    return obj;
  };

  // Internal recursive comparison function for `isEqual`.
  var eq = function(a, b, aStack, bStack) {
    // Identical objects are equal. `0 === -0`, but they aren't identical.
    // See the [Harmony `egal` proposal](http://wiki.ecmascript.org/doku.php?id=harmony:egal).
    if (a === b) return a !== 0 || 1 / a == 1 / b;
    // A strict comparison is necessary because `null == undefined`.
    if (a == null || b == null) return a === b;
    // Unwrap any wrapped objects.
    if (a instanceof _) a = a._wrapped;
    if (b instanceof _) b = b._wrapped;
    // Compare `[[Class]]` names.
    var className = toString.call(a);
    if (className != toString.call(b)) return false;
    switch (className) {
      // Strings, numbers, dates, and booleans are compared by value.
      case '[object String]':
        // Primitives and their corresponding object wrappers are equivalent; thus, `"5"` is
        // equivalent to `new String("5")`.
        return a == String(b);
      case '[object Number]':
        // `NaN`s are equivalent, but non-reflexive. An `egal` comparison is performed for
        // other numeric values.
        return a != +a ? b != +b : (a == 0 ? 1 / a == 1 / b : a == +b);
      case '[object Date]':
      case '[object Boolean]':
        // Coerce dates and booleans to numeric primitive values. Dates are compared by their
        // millisecond representations. Note that invalid dates with millisecond representations
        // of `NaN` are not equivalent.
        return +a == +b;
      // RegExps are compared by their source patterns and flags.
      case '[object RegExp]':
        return a.source == b.source &&
               a.global == b.global &&
               a.multiline == b.multiline &&
               a.ignoreCase == b.ignoreCase;
    }
    if (typeof a != 'object' || typeof b != 'object') return false;
    // Assume equality for cyclic structures. The algorithm for detecting cyclic
    // structures is adapted from ES 5.1 section 15.12.3, abstract operation `JO`.
    var length = aStack.length;
    while (length--) {
      // Linear search. Performance is inversely proportional to the number of
      // unique nested structures.
      if (aStack[length] == a) return bStack[length] == b;
    }
    // Objects with different constructors are not equivalent, but `Object`s
    // from different frames are.
    var aCtor = a.constructor, bCtor = b.constructor;
    if (aCtor !== bCtor && !(_.isFunction(aCtor) && (aCtor instanceof aCtor) &&
                             _.isFunction(bCtor) && (bCtor instanceof bCtor))
                        && ('constructor' in a && 'constructor' in b)) {
      return false;
    }
    // Add the first object to the stack of traversed objects.
    aStack.push(a);
    bStack.push(b);
    var size = 0, result = true;
    // Recursively compare objects and arrays.
    if (className == '[object Array]') {
      // Compare array lengths to determine if a deep comparison is necessary.
      size = a.length;
      result = size == b.length;
      if (result) {
        // Deep compare the contents, ignoring non-numeric properties.
        while (size--) {
          if (!(result = eq(a[size], b[size], aStack, bStack))) break;
        }
      }
    } else {
      // Deep compare objects.
      for (var key in a) {
        if (_.has(a, key)) {
          // Count the expected number of properties.
          size++;
          // Deep compare each member.
          if (!(result = _.has(b, key) && eq(a[key], b[key], aStack, bStack))) break;
        }
      }
      // Ensure that both objects contain the same number of properties.
      if (result) {
        for (key in b) {
          if (_.has(b, key) && !(size--)) break;
        }
        result = !size;
      }
    }
    // Remove the first object from the stack of traversed objects.
    aStack.pop();
    bStack.pop();
    return result;
  };

  // Perform a deep comparison to check if two objects are equal.
  _.isEqual = function(a, b) {
    return eq(a, b, [], []);
  };

  // Is a given array, string, or object empty?
  // An "empty" object has no enumerable own-properties.
  _.isEmpty = function(obj) {
    if (obj == null) return true;
    if (_.isArray(obj) || _.isString(obj)) return obj.length === 0;
    for (var key in obj) if (_.has(obj, key)) return false;
    return true;
  };

  // Is a given value a DOM element?
  _.isElement = function(obj) {
    return !!(obj && obj.nodeType === 1);
  };

  // Is a given value an array?
  // Delegates to ECMA5's native Array.isArray
  _.isArray = nativeIsArray || function(obj) {
    return toString.call(obj) == '[object Array]';
  };

  // Is a given variable an object?
  _.isObject = function(obj) {
    return obj === Object(obj);
  };

  // Add some isType methods: isArguments, isFunction, isString, isNumber, isDate, isRegExp.
  each(['Arguments', 'Function', 'String', 'Number', 'Date', 'RegExp'], function(name) {
    _['is' + name] = function(obj) {
      return toString.call(obj) == '[object ' + name + ']';
    };
  });

  // Define a fallback version of the method in browsers (ahem, IE), where
  // there isn't any inspectable "Arguments" type.
  if (!_.isArguments(arguments)) {
    _.isArguments = function(obj) {
      return !!(obj && _.has(obj, 'callee'));
    };
  }

  // Optimize `isFunction` if appropriate.
  if (typeof (/./) !== 'function') {
    _.isFunction = function(obj) {
      return typeof obj === 'function';
    };
  }

  // Is a given object a finite number?
  _.isFinite = function(obj) {
    return isFinite(obj) && !isNaN(parseFloat(obj));
  };

  // Is the given value `NaN`? (NaN is the only number which does not equal itself).
  _.isNaN = function(obj) {
    return _.isNumber(obj) && obj != +obj;
  };

  // Is a given value a boolean?
  _.isBoolean = function(obj) {
    return obj === true || obj === false || toString.call(obj) == '[object Boolean]';
  };

  // Is a given value equal to null?
  _.isNull = function(obj) {
    return obj === null;
  };

  // Is a given variable undefined?
  _.isUndefined = function(obj) {
    return obj === void 0;
  };

  // Shortcut function for checking if an object has a given property directly
  // on itself (in other words, not on a prototype).
  _.has = function(obj, key) {
    return hasOwnProperty.call(obj, key);
  };

  // Utility Functions
  // -----------------

  // Run Underscore.js in *noConflict* mode, returning the `_` variable to its
  // previous owner. Returns a reference to the Underscore object.
  _.noConflict = function() {
    root._ = previousUnderscore;
    return this;
  };

  // Keep the identity function around for default iterators.
  _.identity = function(value) {
    return value;
  };

  _.constant = function(value) {
    return function () {
      return value;
    };
  };

  _.property = function(key) {
    return function(obj) {
      return obj[key];
    };
  };

  // Returns a predicate for checking whether an object has a given set of `key:value` pairs.
  _.matches = function(attrs) {
    return function(obj) {
      if (obj === attrs) return true; //avoid comparing an object to itself.
      for (var key in attrs) {
        if (attrs[key] !== obj[key])
          return false;
      }
      return true;
    }
  };

  // Run a function **n** times.
  _.times = function(n, iterator, context) {
    var accum = Array(Math.max(0, n));
    for (var i = 0; i < n; i++) accum[i] = iterator.call(context, i);
    return accum;
  };

  // Return a random integer between min and max (inclusive).
  _.random = function(min, max) {
    if (max == null) {
      max = min;
      min = 0;
    }
    return min + Math.floor(Math.random() * (max - min + 1));
  };

  // A (possibly faster) way to get the current timestamp as an integer.
  _.now = Date.now || function() { return new Date().getTime(); };

  // List of HTML entities for escaping.
  var entityMap = {
    escape: {
      '&': '&amp;',
      '<': '&lt;',
      '>': '&gt;',
      '"': '&quot;',
      "'": '&#x27;'
    }
  };
  entityMap.unescape = _.invert(entityMap.escape);

  // Regexes containing the keys and values listed immediately above.
  var entityRegexes = {
    escape:   new RegExp('[' + _.keys(entityMap.escape).join('') + ']', 'g'),
    unescape: new RegExp('(' + _.keys(entityMap.unescape).join('|') + ')', 'g')
  };

  // Functions for escaping and unescaping strings to/from HTML interpolation.
  _.each(['escape', 'unescape'], function(method) {
    _[method] = function(string) {
      if (string == null) return '';
      return ('' + string).replace(entityRegexes[method], function(match) {
        return entityMap[method][match];
      });
    };
  });

  // If the value of the named `property` is a function then invoke it with the
  // `object` as context; otherwise, return it.
  _.result = function(object, property) {
    if (object == null) return void 0;
    var value = object[property];
    return _.isFunction(value) ? value.call(object) : value;
  };

  // Add your own custom functions to the Underscore object.
  _.mixin = function(obj) {
    each(_.functions(obj), function(name) {
      var func = _[name] = obj[name];
      _.prototype[name] = function() {
        var args = [this._wrapped];
        push.apply(args, arguments);
        return result.call(this, func.apply(_, args));
      };
    });
  };

  // Generate a unique integer id (unique within the entire client session).
  // Useful for temporary DOM ids.
  var idCounter = 0;
  _.uniqueId = function(prefix) {
    var id = ++idCounter + '';
    return prefix ? prefix + id : id;
  };

  // By default, Underscore uses ERB-style template delimiters, change the
  // following template settings to use alternative delimiters.
  _.templateSettings = {
    evaluate    : /<%([\s\S]+?)%>/g,
    interpolate : /<%=([\s\S]+?)%>/g,
    escape      : /<%-([\s\S]+?)%>/g
  };

  // When customizing `templateSettings`, if you don't want to define an
  // interpolation, evaluation or escaping regex, we need one that is
  // guaranteed not to match.
  var noMatch = /(.)^/;

  // Certain characters need to be escaped so that they can be put into a
  // string literal.
  var escapes = {
    "'":      "'",
    '\\':     '\\',
    '\r':     'r',
    '\n':     'n',
    '\t':     't',
    '\u2028': 'u2028',
    '\u2029': 'u2029'
  };

  var escaper = /\\|'|\r|\n|\t|\u2028|\u2029/g;

  // JavaScript micro-templating, similar to John Resig's implementation.
  // Underscore templating handles arbitrary delimiters, preserves whitespace,
  // and correctly escapes quotes within interpolated code.
  _.template = function(text, data, settings) {
    var render;
    settings = _.defaults({}, settings, _.templateSettings);

    // Combine delimiters into one regular expression via alternation.
    var matcher = new RegExp([
      (settings.escape || noMatch).source,
      (settings.interpolate || noMatch).source,
      (settings.evaluate || noMatch).source
    ].join('|') + '|$', 'g');

    // Compile the template source, escaping string literals appropriately.
    var index = 0;
    var source = "__p+='";
    text.replace(matcher, function(match, escape, interpolate, evaluate, offset) {
      source += text.slice(index, offset)
        .replace(escaper, function(match) { return '\\' + escapes[match]; });

      if (escape) {
        source += "'+\n((__t=(" + escape + "))==null?'':_.escape(__t))+\n'";
      }
      if (interpolate) {
        source += "'+\n((__t=(" + interpolate + "))==null?'':__t)+\n'";
      }
      if (evaluate) {
        source += "';\n" + evaluate + "\n__p+='";
      }
      index = offset + match.length;
      return match;
    });
    source += "';\n";

    // If a variable is not specified, place data values in local scope.
    if (!settings.variable) source = 'with(obj||{}){\n' + source + '}\n';

    source = "var __t,__p='',__j=Array.prototype.join," +
      "print=function(){__p+=__j.call(arguments,'');};\n" +
      source + "return __p;\n";

    try {
      render = new Function(settings.variable || 'obj', '_', source);
    } catch (e) {
      e.source = source;
      throw e;
    }

    if (data) return render(data, _);
    var template = function(data) {
      return render.call(this, data, _);
    };

    // Provide the compiled function source as a convenience for precompilation.
    template.source = 'function(' + (settings.variable || 'obj') + '){\n' + source + '}';

    return template;
  };

  // Add a "chain" function, which will delegate to the wrapper.
  _.chain = function(obj) {
    return _(obj).chain();
  };

  // OOP
  // ---------------
  // If Underscore is called as a function, it returns a wrapped object that
  // can be used OO-style. This wrapper holds altered versions of all the
  // underscore functions. Wrapped objects may be chained.

  // Helper function to continue chaining intermediate results.
  var result = function(obj) {
    return this._chain ? _(obj).chain() : obj;
  };

  // Add all of the Underscore functions to the wrapper object.
  _.mixin(_);

  // Add all mutator Array functions to the wrapper.
  each(['pop', 'push', 'reverse', 'shift', 'sort', 'splice', 'unshift'], function(name) {
    var method = ArrayProto[name];
    _.prototype[name] = function() {
      var obj = this._wrapped;
      method.apply(obj, arguments);
      if ((name == 'shift' || name == 'splice') && obj.length === 0) delete obj[0];
      return result.call(this, obj);
    };
  });

  // Add all accessor Array functions to the wrapper.
  each(['concat', 'join', 'slice'], function(name) {
    var method = ArrayProto[name];
    _.prototype[name] = function() {
      return result.call(this, method.apply(this._wrapped, arguments));
    };
  });

  _.extend(_.prototype, {

    // Start chaining a wrapped Underscore object.
    chain: function() {
      this._chain = true;
      return this;
    },

    // Extracts the result from a wrapped and chained object.
    value: function() {
      return this._wrapped;
    }

  });

  // AMD registration happens at the end for compatibility with AMD loaders
  // that may not enforce next-turn semantics on modules. Even though general
  // practice for AMD registration is to be anonymous, underscore registers
  // as a named module because, like jQuery, it is a base library that is
  // popular enough to be bundled in a third party lib, but not be part of
  // an AMD load request. Those cases could generate an error when an
  // anonymous define() is called outside of a loader request.
  if (typeof define === 'function' && define.amd) {
    define('underscore', [], function() {
      return _;
    });
  }
}).call(this);

})()
},{}],59:[function(require,module,exports){
(function(definition){if(typeof exports==="object"){module.exports=definition();}else if(typeof define==="function"&&define.amd){define(definition);}else{mori=definition();}})(function(){return function(){
var g,aa=this;
function m(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";else if("function"==
b&&"undefined"==typeof a.call)return"object";return b}var ba="closure_uid_"+(1E9*Math.random()>>>0),ca=0;function p(a,b){var c=a.split("."),d=aa;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d=d[e]?d[e]:d[e]={}:d[e]=b};function da(a,b){for(var c in a)b.call(void 0,a[c],c,a)};function ea(a,b){null!=a&&this.append.apply(this,arguments)}ea.prototype.Va="";ea.prototype.append=function(a,b,c){this.Va+=a;if(null!=b)for(var d=1;d<arguments.length;d++)this.Va+=arguments[d];return this};ea.prototype.toString=function(){return this.Va};function fa(a,b){a.sort(b||ga)}function ha(a,b){for(var c=0;c<a.length;c++)a[c]={index:c,value:a[c]};var d=b||ga;fa(a,function(a,b){return d(a.value,b.value)||a.index-b.index});for(c=0;c<a.length;c++)a[c]=a[c].value}function ga(a,b){return a>b?1:a<b?-1:0};var ia=null,ja=null;function ka(){return new la(null,5,[ma,!0,oa,!0,pa,!1,qa,!1,ra,ia],null)}function r(a){return null!=a&&!1!==a}function sa(a){return r(a)?!1:!0}function s(a,b){return a[m(null==b?null:b)]?!0:a._?!0:u?!1:null}function ta(a){return null==a?null:a.constructor}function x(a,b){var c=ta(b),c=r(r(c)?c.Db:c)?c.Bb:m(b);return Error(["No protocol method ",a," defined for type ",c,": ",b].join(""))}function ua(a){var b=a.Bb;return r(b)?b:""+A.b(a)}
function va(a){for(var b=a.length,c=Array(b),d=0;;)if(d<b)c[d]=a[d],d+=1;else break;return c}function wa(a){return Array.prototype.slice.call(arguments)}
var xa=function(){function a(a,b){return C.c?C.c(function(a,b){a.push(b);return a},[],b):C.call(null,function(a,b){a.push(b);return a},[],b)}function b(a){return c.a(null,a)}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,0,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),ya={},za={};
function Aa(a){if(a?a.L:a)return a.L(a);var b;b=Aa[m(null==a?null:a)];if(!b&&(b=Aa._,!b))throw x("ICounted.-count",a);return b.call(null,a)}function Ba(a){if(a?a.I:a)return a.I(a);var b;b=Ba[m(null==a?null:a)];if(!b&&(b=Ba._,!b))throw x("IEmptyableCollection.-empty",a);return b.call(null,a)}var Ca={};function Da(a,b){if(a?a.G:a)return a.G(a,b);var c;c=Da[m(null==a?null:a)];if(!c&&(c=Da._,!c))throw x("ICollection.-conj",a);return c.call(null,a,b)}
var Ea={},D=function(){function a(a,b,c){if(a?a.aa:a)return a.aa(a,b,c);var h;h=D[m(null==a?null:a)];if(!h&&(h=D._,!h))throw x("IIndexed.-nth",a);return h.call(null,a,b,c)}function b(a,b){if(a?a.J:a)return a.J(a,b);var c;c=D[m(null==a?null:a)];if(!c&&(c=D._,!c))throw x("IIndexed.-nth",a);return c.call(null,a,b)}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}(),
Fa={};function Ha(a){if(a?a.Q:a)return a.Q(a);var b;b=Ha[m(null==a?null:a)];if(!b&&(b=Ha._,!b))throw x("ISeq.-first",a);return b.call(null,a)}function Ia(a){if(a?a.S:a)return a.S(a);var b;b=Ia[m(null==a?null:a)];if(!b&&(b=Ia._,!b))throw x("ISeq.-rest",a);return b.call(null,a)}
var Ja={},Ka={},La=function(){function a(a,b,c){if(a?a.C:a)return a.C(a,b,c);var h;h=La[m(null==a?null:a)];if(!h&&(h=La._,!h))throw x("ILookup.-lookup",a);return h.call(null,a,b,c)}function b(a,b){if(a?a.u:a)return a.u(a,b);var c;c=La[m(null==a?null:a)];if(!c&&(c=La._,!c))throw x("ILookup.-lookup",a);return c.call(null,a,b)}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=
a;return c}(),Ma={};function Na(a,b){if(a?a.kb:a)return a.kb(a,b);var c;c=Na[m(null==a?null:a)];if(!c&&(c=Na._,!c))throw x("IAssociative.-contains-key?",a);return c.call(null,a,b)}function Oa(a,b,c){if(a?a.ua:a)return a.ua(a,b,c);var d;d=Oa[m(null==a?null:a)];if(!d&&(d=Oa._,!d))throw x("IAssociative.-assoc",a);return d.call(null,a,b,c)}var Pa={};function Qa(a,b){if(a?a.nb:a)return a.nb(a,b);var c;c=Qa[m(null==a?null:a)];if(!c&&(c=Qa._,!c))throw x("IMap.-dissoc",a);return c.call(null,a,b)}var Sa={};
function Ta(a){if(a?a.$a:a)return a.$a(a);var b;b=Ta[m(null==a?null:a)];if(!b&&(b=Ta._,!b))throw x("IMapEntry.-key",a);return b.call(null,a)}function Ua(a){if(a?a.ab:a)return a.ab(a);var b;b=Ua[m(null==a?null:a)];if(!b&&(b=Ua._,!b))throw x("IMapEntry.-val",a);return b.call(null,a)}var Va={};function Wa(a,b){if(a?a.vb:a)return a.vb(a,b);var c;c=Wa[m(null==a?null:a)];if(!c&&(c=Wa._,!c))throw x("ISet.-disjoin",a);return c.call(null,a,b)}
function Xa(a){if(a?a.Ia:a)return a.Ia(a);var b;b=Xa[m(null==a?null:a)];if(!b&&(b=Xa._,!b))throw x("IStack.-peek",a);return b.call(null,a)}function Ya(a){if(a?a.Ja:a)return a.Ja(a);var b;b=Ya[m(null==a?null:a)];if(!b&&(b=Ya._,!b))throw x("IStack.-pop",a);return b.call(null,a)}var Za={};function $a(a,b,c){if(a?a.Pa:a)return a.Pa(a,b,c);var d;d=$a[m(null==a?null:a)];if(!d&&(d=$a._,!d))throw x("IVector.-assoc-n",a);return d.call(null,a,b,c)}
function ab(a){if(a?a.ub:a)return a.ub(a);var b;b=ab[m(null==a?null:a)];if(!b&&(b=ab._,!b))throw x("IDeref.-deref",a);return b.call(null,a)}var bb={};function cb(a){if(a?a.D:a)return a.D(a);var b;b=cb[m(null==a?null:a)];if(!b&&(b=cb._,!b))throw x("IMeta.-meta",a);return b.call(null,a)}var db={};function eb(a,b){if(a?a.F:a)return a.F(a,b);var c;c=eb[m(null==a?null:a)];if(!c&&(c=eb._,!c))throw x("IWithMeta.-with-meta",a);return c.call(null,a,b)}
var fb={},gb=function(){function a(a,b,c){if(a?a.M:a)return a.M(a,b,c);var h;h=gb[m(null==a?null:a)];if(!h&&(h=gb._,!h))throw x("IReduce.-reduce",a);return h.call(null,a,b,c)}function b(a,b){if(a?a.N:a)return a.N(a,b);var c;c=gb[m(null==a?null:a)];if(!c&&(c=gb._,!c))throw x("IReduce.-reduce",a);return c.call(null,a,b)}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}();
function hb(a,b,c){if(a?a.Za:a)return a.Za(a,b,c);var d;d=hb[m(null==a?null:a)];if(!d&&(d=hb._,!d))throw x("IKVReduce.-kv-reduce",a);return d.call(null,a,b,c)}function ib(a,b){if(a?a.v:a)return a.v(a,b);var c;c=ib[m(null==a?null:a)];if(!c&&(c=ib._,!c))throw x("IEquiv.-equiv",a);return c.call(null,a,b)}function jb(a){if(a?a.B:a)return a.B(a);var b;b=jb[m(null==a?null:a)];if(!b&&(b=jb._,!b))throw x("IHash.-hash",a);return b.call(null,a)}var kb={};
function lb(a){if(a?a.H:a)return a.H(a);var b;b=lb[m(null==a?null:a)];if(!b&&(b=lb._,!b))throw x("ISeqable.-seq",a);return b.call(null,a)}var mb={},nb={},ob={};function pb(a){if(a?a.Xa:a)return a.Xa(a);var b;b=pb[m(null==a?null:a)];if(!b&&(b=pb._,!b))throw x("IReversible.-rseq",a);return b.call(null,a)}function qb(a,b){if(a?a.yb:a)return a.yb(a,b);var c;c=qb[m(null==a?null:a)];if(!c&&(c=qb._,!c))throw x("ISorted.-sorted-seq",a);return c.call(null,a,b)}
function rb(a,b,c){if(a?a.zb:a)return a.zb(a,b,c);var d;d=rb[m(null==a?null:a)];if(!d&&(d=rb._,!d))throw x("ISorted.-sorted-seq-from",a);return d.call(null,a,b,c)}function sb(a,b){if(a?a.xb:a)return a.xb(a,b);var c;c=sb[m(null==a?null:a)];if(!c&&(c=sb._,!c))throw x("ISorted.-entry-key",a);return c.call(null,a,b)}function tb(a){if(a?a.wb:a)return a.wb(a);var b;b=tb[m(null==a?null:a)];if(!b&&(b=tb._,!b))throw x("ISorted.-comparator",a);return b.call(null,a)}
function ub(a,b){if(a?a.Sb:a)return a.Sb(0,b);var c;c=ub[m(null==a?null:a)];if(!c&&(c=ub._,!c))throw x("IWriter.-write",a);return c.call(null,a,b)}var vb={};function wb(a,b,c){if(a?a.w:a)return a.w(a,b,c);var d;d=wb[m(null==a?null:a)];if(!d&&(d=wb._,!d))throw x("IPrintWithWriter.-pr-writer",a);return d.call(null,a,b,c)}function xb(a,b,c){if(a?a.Rb:a)return a.Rb(0,b,c);var d;d=xb[m(null==a?null:a)];if(!d&&(d=xb._,!d))throw x("IWatchable.-notify-watches",a);return d.call(null,a,b,c)}
function yb(a){if(a?a.Wa:a)return a.Wa(a);var b;b=yb[m(null==a?null:a)];if(!b&&(b=yb._,!b))throw x("IEditableCollection.-as-transient",a);return b.call(null,a)}function zb(a,b){if(a?a.Ka:a)return a.Ka(a,b);var c;c=zb[m(null==a?null:a)];if(!c&&(c=zb._,!c))throw x("ITransientCollection.-conj!",a);return c.call(null,a,b)}function Ab(a){if(a?a.Oa:a)return a.Oa(a);var b;b=Ab[m(null==a?null:a)];if(!b&&(b=Ab._,!b))throw x("ITransientCollection.-persistent!",a);return b.call(null,a)}
function Bb(a,b,c){if(a?a.cb:a)return a.cb(a,b,c);var d;d=Bb[m(null==a?null:a)];if(!d&&(d=Bb._,!d))throw x("ITransientAssociative.-assoc!",a);return d.call(null,a,b,c)}function Cb(a,b){if(a?a.Ab:a)return a.Ab(a,b);var c;c=Cb[m(null==a?null:a)];if(!c&&(c=Cb._,!c))throw x("ITransientMap.-dissoc!",a);return c.call(null,a,b)}function Db(a,b,c){if(a?a.Pb:a)return a.Pb(0,b,c);var d;d=Db[m(null==a?null:a)];if(!d&&(d=Db._,!d))throw x("ITransientVector.-assoc-n!",a);return d.call(null,a,b,c)}
function Eb(a){if(a?a.Qb:a)return a.Qb();var b;b=Eb[m(null==a?null:a)];if(!b&&(b=Eb._,!b))throw x("ITransientVector.-pop!",a);return b.call(null,a)}function Fb(a,b){if(a?a.Ob:a)return a.Ob(0,b);var c;c=Fb[m(null==a?null:a)];if(!c&&(c=Fb._,!c))throw x("ITransientSet.-disjoin!",a);return c.call(null,a,b)}function Gb(a){if(a?a.Kb:a)return a.Kb();var b;b=Gb[m(null==a?null:a)];if(!b&&(b=Gb._,!b))throw x("IChunk.-drop-first",a);return b.call(null,a)}
function Hb(a){if(a?a.sb:a)return a.sb(a);var b;b=Hb[m(null==a?null:a)];if(!b&&(b=Hb._,!b))throw x("IChunkedSeq.-chunked-first",a);return b.call(null,a)}function Ib(a){if(a?a.tb:a)return a.tb(a);var b;b=Ib[m(null==a?null:a)];if(!b&&(b=Ib._,!b))throw x("IChunkedSeq.-chunked-rest",a);return b.call(null,a)}function Jb(a){if(a?a.rb:a)return a.rb(a);var b;b=Jb[m(null==a?null:a)];if(!b&&(b=Jb._,!b))throw x("IChunkedNext.-chunked-next",a);return b.call(null,a)}
function Kb(a){this.vc=a;this.q=0;this.i=1073741824}Kb.prototype.Sb=function(a,b){return this.vc.append(b)};function Lb(a){var b=new ea;a.w(null,new Kb(b),ka());return""+A.b(b)}var Mb="undefined"!==typeof Math.imul&&0!==(Math.imul.a?Math.imul.a(4294967295,5):Math.imul.call(null,4294967295,5))?function(a,b){return Math.imul(a,b)}:function(a,b){var c=a&65535,d=b&65535;return c*d+((a>>>16&65535)*d+c*(b>>>16&65535)<<16>>>0)|0};function Nb(a){a=Mb(a,3432918353);return Mb(a<<15|a>>>-15,461845907)}
function Ob(a,b){var c=a^b;return Mb(c<<13|c>>>-13,5)+3864292196}function Pb(a,b){var c=a^b,c=Mb(c^c>>>16,2246822507),c=Mb(c^c>>>13,3266489909);return c^c>>>16}var Qb={},Rb=0;function Sb(a){255<Rb&&(Qb={},Rb=0);var b=Qb[a];if("number"!==typeof b){a:if(null!=a)if(b=a.length,0<b){for(var c=0,d=0;;)if(c<b)var e=c+1,d=Mb(31,d)+a.charCodeAt(c),c=e;else{b=d;break a}b=void 0}else b=0;else b=0;Qb[a]=b;Rb+=1}return a=b}
function Tb(a){a&&(a.i&4194304||a.Dc)?a=a.B(null):"number"===typeof a?a=Math.floor(a)%2147483647:!0===a?a=1:!1===a?a=0:"string"===typeof a?(a=Sb(a),0!==a&&(a=Nb(a),a=Ob(0,a),a=Pb(a,4))):a=null==a?0:u?jb(a):null;return a}
function Ub(a){var b;b=a.name;var c;a:{c=1;for(var d=0;;)if(c<b.length){var e=c+2,d=Ob(d,Nb(b.charCodeAt(c-1)|b.charCodeAt(c)<<16));c=e}else{c=d;break a}c=void 0}c=1===(b.length&1)?c^Nb(b.charCodeAt(b.length-1)):c;b=Pb(c,Mb(2,b.length));a=Sb(a.fa);return b^a+2654435769+(b<<6)+(b>>2)}
function Vb(a,b){if(r(Wb.a?Wb.a(a,b):Wb.call(null,a,b)))return 0;var c=sa(a.fa);if(r(c?b.fa:c))return-1;if(r(a.fa)){if(sa(b.fa))return 1;c=Xb.a?Xb.a(a.fa,b.fa):Xb.call(null,a.fa,b.fa);return 0===c?Xb.a?Xb.a(a.name,b.name):Xb.call(null,a.name,b.name):c}return Yb?Xb.a?Xb.a(a.name,b.name):Xb.call(null,a.name,b.name):null}function Zb(a,b,c,d,e){this.fa=a;this.name=b;this.Na=c;this.Ua=d;this.W=e;this.i=2154168321;this.q=4096}g=Zb.prototype;g.w=function(a,b){return ub(b,this.Na)};
g.B=function(){var a=this.Ua;return null!=a?a:this.Ua=a=Ub(this)};g.F=function(a,b){return new Zb(this.fa,this.name,this.Na,this.Ua,b)};g.D=function(){return this.W};g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return La.c(c,this,null);case 3:return La.c(c,this,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return La.c(a,this,null)};
g.a=function(a,b){return La.c(a,this,b)};g.v=function(a,b){return b instanceof Zb?this.Na===b.Na:!1};g.toString=function(){return this.Na};var $b=function(){function a(a,b){var c=null!=a?""+A.b(a)+"/"+A.b(b):b;return new Zb(a,b,c,null,null)}function b(a){return a instanceof Zb?a:c.a(null,a)}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}();
function E(a){if(null==a)return null;if(a&&(a.i&8388608||a.hc))return a.H(null);if(a instanceof Array||"string"===typeof a)return 0===a.length?null:new ac(a,0);if(s(kb,a))return lb(a);if(u)throw Error(""+A.b(a)+" is not ISeqable");return null}function F(a){if(null==a)return null;if(a&&(a.i&64||a.bb))return a.Q(null);a=E(a);return null==a?null:Ha(a)}function G(a){return null!=a?a&&(a.i&64||a.bb)?a.S(null):(a=E(a))?Ia(a):H:H}function I(a){return null==a?null:a&&(a.i&128||a.ob)?a.U(null):E(G(a))}
var Wb=function(){function a(a,b){return null==a?null==b:a===b||ib(a,b)}var b=null,c=function(){function a(b,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,b,d,l)}function c(a,d,e){for(;;)if(b.a(a,d))if(I(e))a=d,d=F(e),e=I(e);else return b.a(d,F(e));else return!1}a.k=2;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};a.d=c;return a}(),b=function(b,e,f){switch(arguments.length){case 1:return!0;case 2:return a.call(this,b,
e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;b.b=function(){return!0};b.a=a;b.d=c.d;return b}();function bc(a,b){var c=Nb(a),c=Ob(0,c);return Pb(c,b)}function cc(a){var b=0,c=1;for(a=E(a);;)if(null!=a)b+=1,c=Mb(31,c)+Tb(F(a))|0,a=I(a);else return bc(c,b)}function dc(a){var b=0,c=0;for(a=E(a);;)if(null!=a)b+=1,c=c+Tb(F(a))|0,a=I(a);else return bc(c,b)}za["null"]=!0;Aa["null"]=function(){return 0};
Date.prototype.v=function(a,b){return b instanceof Date&&this.toString()===b.toString()};ib.number=function(a,b){return a===b};bb["function"]=!0;cb["function"]=function(){return null};ya["function"]=!0;jb._=function(a){return a[ba]||(a[ba]=++ca)};function ec(a){this.l=a;this.q=0;this.i=32768}ec.prototype.ub=function(){return this.l};function fc(a){return a instanceof ec}
var gc=function(){function a(a,b,c,d){for(var l=Aa(a);;)if(d<l){c=b.a?b.a(c,D.a(a,d)):b.call(null,c,D.a(a,d));if(fc(c))return K.b?K.b(c):K.call(null,c);d+=1}else return c}function b(a,b,c){for(var d=Aa(a),l=0;;)if(l<d){c=b.a?b.a(c,D.a(a,l)):b.call(null,c,D.a(a,l));if(fc(c))return K.b?K.b(c):K.call(null,c);l+=1}else return c}function c(a,b){var c=Aa(a);if(0===c)return b.o?b.o():b.call(null);for(var d=D.a(a,0),l=1;;)if(l<c){d=b.a?b.a(d,D.a(a,l)):b.call(null,d,D.a(a,l));if(fc(d))return K.b?K.b(d):K.call(null,
d);l+=1}else return d}var d=null,d=function(d,f,h,k){switch(arguments.length){case 2:return c.call(this,d,f);case 3:return b.call(this,d,f,h);case 4:return a.call(this,d,f,h,k)}throw Error("Invalid arity: "+arguments.length);};d.a=c;d.c=b;d.n=a;return d}(),hc=function(){function a(a,b,c,d){for(var l=a.length;;)if(d<l){c=b.a?b.a(c,a[d]):b.call(null,c,a[d]);if(fc(c))return K.b?K.b(c):K.call(null,c);d+=1}else return c}function b(a,b,c){for(var d=a.length,l=0;;)if(l<d){c=b.a?b.a(c,a[l]):b.call(null,c,
a[l]);if(fc(c))return K.b?K.b(c):K.call(null,c);l+=1}else return c}function c(a,b){var c=a.length;if(0===a.length)return b.o?b.o():b.call(null);for(var d=a[0],l=1;;)if(l<c){d=b.a?b.a(d,a[l]):b.call(null,d,a[l]);if(fc(d))return K.b?K.b(d):K.call(null,d);l+=1}else return d}var d=null,d=function(d,f,h,k){switch(arguments.length){case 2:return c.call(this,d,f);case 3:return b.call(this,d,f,h);case 4:return a.call(this,d,f,h,k)}throw Error("Invalid arity: "+arguments.length);};d.a=c;d.c=b;d.n=a;return d}();
function ic(a){return a?a.i&2||a.Yb?!0:a.i?!1:s(za,a):s(za,a)}function jc(a){return a?a.i&16||a.Lb?!0:a.i?!1:s(Ea,a):s(Ea,a)}function ac(a,b){this.e=a;this.p=b;this.i=166199550;this.q=8192}g=ac.prototype;g.toString=function(){return Lb(this)};g.J=function(a,b){var c=b+this.p;return c<this.e.length?this.e[c]:null};g.aa=function(a,b,c){a=b+this.p;return a<this.e.length?this.e[a]:c};g.U=function(){return this.p+1<this.e.length?new ac(this.e,this.p+1):null};g.L=function(){return this.e.length-this.p};
g.Xa=function(){var a=Aa(this);return 0<a?new kc(this,a-1,null):null};g.B=function(){return cc(this)};g.v=function(a,b){return lc.a?lc.a(this,b):lc.call(null,this,b)};g.I=function(){return H};g.N=function(a,b){return hc.n(this.e,b,this.e[this.p],this.p+1)};g.M=function(a,b,c){return hc.n(this.e,b,c,this.p)};g.Q=function(){return this.e[this.p]};g.S=function(){return this.p+1<this.e.length?new ac(this.e,this.p+1):H};g.H=function(){return this};
g.G=function(a,b){return M.a?M.a(b,this):M.call(null,b,this)};
var mc=function(){function a(a,b){return b<a.length?new ac(a,b):null}function b(a){return c.a(a,0)}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),J=function(){function a(a,b){return mc.a(a,b)}function b(a){return mc.a(a,0)}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+
arguments.length);};c.b=b;c.a=a;return c}();function kc(a,b,c){this.jb=a;this.p=b;this.j=c;this.i=32374990;this.q=8192}g=kc.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.j};g.U=function(){return 0<this.p?new kc(this.jb,this.p-1,null):null};g.L=function(){return this.p+1};g.B=function(){return cc(this)};g.v=function(a,b){return lc.a?lc.a(this,b):lc.call(null,this,b)};g.I=function(){return N.a?N.a(H,this.j):N.call(null,H,this.j)};
g.N=function(a,b){return nc.a?nc.a(b,this):nc.call(null,b,this)};g.M=function(a,b,c){return nc.c?nc.c(b,c,this):nc.call(null,b,c,this)};g.Q=function(){return D.a(this.jb,this.p)};g.S=function(){return 0<this.p?new kc(this.jb,this.p-1,null):H};g.H=function(){return this};g.F=function(a,b){return new kc(this.jb,this.p,b)};g.G=function(a,b){return M.a?M.a(b,this):M.call(null,b,this)};function oc(a){for(;;){var b=I(a);if(null!=b)a=b;else return F(a)}}ib._=function(a,b){return a===b};
var pc=function(){function a(a,b){return null!=a?Da(a,b):Da(H,b)}var b=null,c=function(){function a(b,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,b,d,l)}function c(a,d,e){for(;;)if(r(e))a=b.a(a,d),d=F(e),e=I(e);else return b.a(a,d)}a.k=2;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};a.d=c;return a}(),b=function(b,e,f){switch(arguments.length){case 2:return a.call(this,b,e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+
arguments.length);};b.k=2;b.f=c.f;b.a=a;b.d=c.d;return b}();function qc(a){return null==a?null:Ba(a)}function O(a){if(null!=a)if(a&&(a.i&2||a.Yb))a=a.L(null);else if(a instanceof Array)a=a.length;else if("string"===typeof a)a=a.length;else if(s(za,a))a=Aa(a);else if(u)a:{a=E(a);for(var b=0;;){if(ic(a)){a=b+Aa(a);break a}a=I(a);b+=1}a=void 0}else a=null;else a=0;return a}
var rc=function(){function a(a,b,c){for(;;){if(null==a)return c;if(0===b)return E(a)?F(a):c;if(jc(a))return D.c(a,b,c);if(E(a))a=I(a),b-=1;else return u?c:null}}function b(a,b){for(;;){if(null==a)throw Error("Index out of bounds");if(0===b){if(E(a))return F(a);throw Error("Index out of bounds");}if(jc(a))return D.a(a,b);if(E(a)){var c=I(a),h=b-1;a=c;b=h}else{if(u)throw Error("Index out of bounds");return null}}}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,
c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}(),P=function(){function a(a,b,c){if("number"!==typeof b)throw Error("index argument to nth must be a number.");if(null==a)return c;if(a&&(a.i&16||a.Lb))return a.aa(null,b,c);if(a instanceof Array||"string"===typeof a)return b<a.length?a[b]:c;if(s(Ea,a))return D.a(a,b);if(a?a.i&64||a.bb||(a.i?0:s(Fa,a)):s(Fa,a))return rc.c(a,b,c);if(u)throw Error("nth not supported on this type "+A.b(ua(ta(a))));return null}function b(a,
b){if("number"!==typeof b)throw Error("index argument to nth must be a number");if(null==a)return a;if(a&&(a.i&16||a.Lb))return a.J(null,b);if(a instanceof Array||"string"===typeof a)return b<a.length?a[b]:null;if(s(Ea,a))return D.a(a,b);if(a?a.i&64||a.bb||(a.i?0:s(Fa,a)):s(Fa,a))return rc.a(a,b);if(u)throw Error("nth not supported on this type "+A.b(ua(ta(a))));return null}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+
arguments.length);};c.a=b;c.c=a;return c}(),Q=function(){function a(a,b,c){return null!=a?a&&(a.i&256||a.Mb)?a.C(null,b,c):a instanceof Array?b<a.length?a[b]:c:"string"===typeof a?b<a.length?a[b]:c:s(Ka,a)?La.c(a,b,c):u?c:null:c}function b(a,b){return null==a?null:a&&(a.i&256||a.Mb)?a.u(null,b):a instanceof Array?b<a.length?a[b]:null:"string"===typeof a?b<a.length?a[b]:null:s(Ka,a)?La.a(a,b):null}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,
c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}(),R=function(){function a(a,b,c){return null!=a?Oa(a,b,c):sc.a?sc.a([b],[c]):sc.call(null,[b],[c])}var b=null,c=function(){function a(b,d,k,l){var n=null;3<arguments.length&&(n=J(Array.prototype.slice.call(arguments,3),0));return c.call(this,b,d,k,n)}function c(a,d,e,l){for(;;)if(a=b.c(a,d,e),r(l))d=F(l),e=F(I(l)),l=I(I(l));else return a}a.k=3;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=I(a);var l=F(a);a=G(a);return c(b,
d,l,a)};a.d=c;return a}(),b=function(b,e,f,h){switch(arguments.length){case 3:return a.call(this,b,e,f);default:return c.d(b,e,f,J(arguments,3))}throw Error("Invalid arity: "+arguments.length);};b.k=3;b.f=c.f;b.c=a;b.d=c.d;return b}(),tc=function(){function a(a,b){return null==a?null:Qa(a,b)}var b=null,c=function(){function a(b,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,b,d,l)}function c(a,d,e){for(;;){if(null==a)return null;a=b.a(a,d);
if(r(e))d=F(e),e=I(e);else return a}}a.k=2;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};a.d=c;return a}(),b=function(b,e,f){switch(arguments.length){case 1:return b;case 2:return a.call(this,b,e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;b.b=function(a){return a};b.a=a;b.d=c.d;return b}();function uc(a){var b="function"==m(a);return b?b:a?r(r(null)?null:a.Xb)?!0:a.Cb?!1:s(ya,a):s(ya,a)}
function vc(a,b){this.h=a;this.j=b;this.q=0;this.i=393217}g=vc.prototype;
g.call=function(){var a=null;return a=function(a,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga,Ra,wc){switch(arguments.length){case 1:var z=a,z=this;return z.h.o?z.h.o():z.h.call(null);case 2:return z=a,z=this,z.h.b?z.h.b(c):z.h.call(null,c);case 3:return z=a,z=this,z.h.a?z.h.a(c,d):z.h.call(null,c,d);case 4:return z=a,z=this,z.h.c?z.h.c(c,d,e):z.h.call(null,c,d,e);case 5:return z=a,z=this,z.h.n?z.h.n(c,d,e,f):z.h.call(null,c,d,e,f);case 6:return z=a,z=this,z.h.s?z.h.s(c,d,e,f,h):z.h.call(null,c,d,e,f,
h);case 7:return z=a,z=this,z.h.X?z.h.X(c,d,e,f,h,k):z.h.call(null,c,d,e,f,h,k);case 8:return z=a,z=this,z.h.ga?z.h.ga(c,d,e,f,h,k,l):z.h.call(null,c,d,e,f,h,k,l);case 9:return z=a,z=this,z.h.Ga?z.h.Ga(c,d,e,f,h,k,l,n):z.h.call(null,c,d,e,f,h,k,l,n);case 10:return z=a,z=this,z.h.Ha?z.h.Ha(c,d,e,f,h,k,l,n,q):z.h.call(null,c,d,e,f,h,k,l,n,q);case 11:return z=a,z=this,z.h.va?z.h.va(c,d,e,f,h,k,l,n,q,t):z.h.call(null,c,d,e,f,h,k,l,n,q,t);case 12:return z=a,z=this,z.h.wa?z.h.wa(c,d,e,f,h,k,l,n,q,t,v):
z.h.call(null,c,d,e,f,h,k,l,n,q,t,v);case 13:return z=a,z=this,z.h.xa?z.h.xa(c,d,e,f,h,k,l,n,q,t,v,w):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w);case 14:return z=a,z=this,z.h.ya?z.h.ya(c,d,e,f,h,k,l,n,q,t,v,w,y):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y);case 15:return z=a,z=this,z.h.za?z.h.za(c,d,e,f,h,k,l,n,q,t,v,w,y,B):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B);case 16:return z=a,z=this,z.h.Aa?z.h.Aa(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L);case 17:return z=a,z=this,
z.h.Ba?z.h.Ba(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U);case 18:return z=a,z=this,z.h.Ca?z.h.Ca(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z);case 19:return z=a,z=this,z.h.Da?z.h.Da(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na);case 20:return z=a,z=this,z.h.Ea?z.h.Ea(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga);case 21:return z=
a,z=this,z.h.Fa?z.h.Fa(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga,Ra):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga,Ra);case 22:return z=a,z=this,S.bc?S.bc(z.h,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga,Ra,wc):S.call(null,z.h,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga,Ra,wc)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.o=function(){return this.h.o?this.h.o():this.h.call(null)};
g.b=function(a){return this.h.b?this.h.b(a):this.h.call(null,a)};g.a=function(a,b){return this.h.a?this.h.a(a,b):this.h.call(null,a,b)};g.c=function(a,b,c){return this.h.c?this.h.c(a,b,c):this.h.call(null,a,b,c)};g.n=function(a,b,c,d){return this.h.n?this.h.n(a,b,c,d):this.h.call(null,a,b,c,d)};g.s=function(a,b,c,d,e){return this.h.s?this.h.s(a,b,c,d,e):this.h.call(null,a,b,c,d,e)};g.X=function(a,b,c,d,e,f){return this.h.X?this.h.X(a,b,c,d,e,f):this.h.call(null,a,b,c,d,e,f)};
g.ga=function(a,b,c,d,e,f,h){return this.h.ga?this.h.ga(a,b,c,d,e,f,h):this.h.call(null,a,b,c,d,e,f,h)};g.Ga=function(a,b,c,d,e,f,h,k){return this.h.Ga?this.h.Ga(a,b,c,d,e,f,h,k):this.h.call(null,a,b,c,d,e,f,h,k)};g.Ha=function(a,b,c,d,e,f,h,k,l){return this.h.Ha?this.h.Ha(a,b,c,d,e,f,h,k,l):this.h.call(null,a,b,c,d,e,f,h,k,l)};g.va=function(a,b,c,d,e,f,h,k,l,n){return this.h.va?this.h.va(a,b,c,d,e,f,h,k,l,n):this.h.call(null,a,b,c,d,e,f,h,k,l,n)};
g.wa=function(a,b,c,d,e,f,h,k,l,n,q){return this.h.wa?this.h.wa(a,b,c,d,e,f,h,k,l,n,q):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q)};g.xa=function(a,b,c,d,e,f,h,k,l,n,q,t){return this.h.xa?this.h.xa(a,b,c,d,e,f,h,k,l,n,q,t):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t)};g.ya=function(a,b,c,d,e,f,h,k,l,n,q,t,v){return this.h.ya?this.h.ya(a,b,c,d,e,f,h,k,l,n,q,t,v):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t,v)};
g.za=function(a,b,c,d,e,f,h,k,l,n,q,t,v,w){return this.h.za?this.h.za(a,b,c,d,e,f,h,k,l,n,q,t,v,w):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t,v,w)};g.Aa=function(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y){return this.h.Aa?this.h.Aa(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t,v,w,y)};g.Ba=function(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B){return this.h.Ba?this.h.Ba(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B)};
g.Ca=function(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L){return this.h.Ca?this.h.Ca(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L)};g.Da=function(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U){return this.h.Da?this.h.Da(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U)};
g.Ea=function(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z){return this.h.Ea?this.h.Ea(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z)};g.Fa=function(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na){return this.h.Fa?this.h.Fa(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na)};g.Xb=!0;g.F=function(a,b){return new vc(this.h,b)};g.D=function(){return this.j};
function N(a,b){return uc(a)&&!(a?a.i&262144||a.oc||(a.i?0:s(db,a)):s(db,a))?new vc(a,b):null==a?null:eb(a,b)}function xc(a){var b=null!=a;return(b?a?a.i&131072||a.ec||(a.i?0:s(bb,a)):s(bb,a):b)?cb(a):null}function yc(a){return null==a?null:Xa(a)}function zc(a){return null==a?null:Ya(a)}
var Ac=function(){function a(a,b){return null==a?null:Wa(a,b)}var b=null,c=function(){function a(b,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,b,d,l)}function c(a,d,e){for(;;){if(null==a)return null;a=b.a(a,d);if(r(e))d=F(e),e=I(e);else return a}}a.k=2;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};a.d=c;return a}(),b=function(b,e,f){switch(arguments.length){case 1:return b;case 2:return a.call(this,b,e);default:return c.d(b,
e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;b.b=function(a){return a};b.a=a;b.d=c.d;return b}();function Bc(a){return null==a||sa(E(a))}function Cc(a){return null==a?!1:a?a.i&8||a.Ac?!0:a.i?!1:s(Ca,a):s(Ca,a)}function Dc(a){return null==a?!1:a?a.i&4096||a.jc?!0:a.i?!1:s(Va,a):s(Va,a)}function Ec(a){return a?a.i&512||a.yc?!0:a.i?!1:s(Ma,a):s(Ma,a)}function Fc(a){return a?a.i&16777216||a.ic?!0:a.i?!1:s(mb,a):s(mb,a)}
function Gc(a){return null==a?!1:a?a.i&1024||a.cc?!0:a.i?!1:s(Pa,a):s(Pa,a)}function Hc(a){return a?a.i&16384||a.Gc?!0:a.i?!1:s(Za,a):s(Za,a)}function Ic(a){return a?a.q&512||a.zc?!0:!1:!1}function Jc(a){var b=[];da(a,function(a){return function(b,e){return a.push(e)}}(b));return b}function Kc(a,b,c,d,e){for(;0!==e;)c[d]=a[b],d+=1,e-=1,b+=1}var Lc={};function Mc(a){return null==a?!1:a?a.i&64||a.bb?!0:a.i?!1:s(Fa,a):s(Fa,a)}function Nc(a){return r(a)?!0:!1}
function Oc(a,b){return Q.c(a,b,Lc)===Lc?!1:!0}function Xb(a,b){if(a===b)return 0;if(null==a)return-1;if(null==b)return 1;if(ta(a)===ta(b))return a&&(a.q&2048||a.lb)?a.mb(null,b):ga(a,b);if(u)throw Error("compare on non-nil objects of different types");return null}
var Pc=function(){function a(a,b,c,h){for(;;){var k=Xb(P.a(a,h),P.a(b,h));if(0===k&&h+1<c)h+=1;else return k}}function b(a,b){var f=O(a),h=O(b);return f<h?-1:f>h?1:u?c.n(a,b,f,0):null}var c=null,c=function(c,e,f,h){switch(arguments.length){case 2:return b.call(this,c,e);case 4:return a.call(this,c,e,f,h)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.n=a;return c}();
function Qc(a){return Wb.a(a,Xb)?Xb:function(b,c){var d=a.a?a.a(b,c):a.call(null,b,c);return"number"===typeof d?d:r(d)?-1:r(a.a?a.a(c,b):a.call(null,c,b))?1:0}}
var Sc=function(){function a(a,b){if(E(b)){var c=Rc.b?Rc.b(b):Rc.call(null,b);ha(c,Qc(a));return E(c)}return H}function b(a){return c.a(Xb,a)}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),Tc=function(){function a(a,b,c){return Sc.a(function(c,f){return Qc(b).call(null,a.b?a.b(c):a.call(null,c),a.b?a.b(f):a.call(null,f))},c)}function b(a,b){return c.c(a,Xb,b)}
var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}(),nc=function(){function a(a,b,c){for(c=E(c);;)if(c){b=a.a?a.a(b,F(c)):a.call(null,b,F(c));if(fc(b))return K.b?K.b(b):K.call(null,b);c=I(c)}else return b}function b(a,b){var c=E(b);return c?C.c?C.c(a,F(c),I(c)):C.call(null,a,F(c),I(c)):a.o?a.o():a.call(null)}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,
c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}(),C=function(){function a(a,b,c){return c&&(c.i&524288||c.Nb)?c.M(null,a,b):c instanceof Array?hc.c(c,a,b):"string"===typeof c?hc.c(c,a,b):s(fb,c)?gb.c(c,a,b):u?nc.c(a,b,c):null}function b(a,b){return b&&(b.i&524288||b.Nb)?b.N(null,a):b instanceof Array?hc.a(b,a):"string"===typeof b?hc.a(b,a):s(fb,b)?gb.a(b,a):u?nc.a(a,b):null}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,
c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}(),Uc=function(){var a=null,b=function(){function a(c,f,h){var k=null;2<arguments.length&&(k=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,f,k)}function b(a,c,d){for(;;)if(a>c)if(I(d))a=c,c=F(d),d=I(d);else return c>F(d);else return!1}a.k=2;a.f=function(a){var c=F(a);a=I(a);var h=F(a);a=G(a);return b(c,h,a)};a.d=b;return a}(),a=function(a,d,e){switch(arguments.length){case 1:return!0;
case 2:return a>d;default:return b.d(a,d,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};a.k=2;a.f=b.f;a.b=function(){return!0};a.a=function(a,b){return a>b};a.d=b.d;return a}(),Vc=function(){var a=null,b=function(){function a(c,f,h){var k=null;2<arguments.length&&(k=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,f,k)}function b(a,c,d){for(;;)if(a>=c)if(I(d))a=c,c=F(d),d=I(d);else return c>=F(d);else return!1}a.k=2;a.f=function(a){var c=F(a);a=I(a);var h=F(a);
a=G(a);return b(c,h,a)};a.d=b;return a}(),a=function(a,d,e){switch(arguments.length){case 1:return!0;case 2:return a>=d;default:return b.d(a,d,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};a.k=2;a.f=b.f;a.b=function(){return!0};a.a=function(a,b){return a>=b};a.d=b.d;return a}();function Wc(a){return a-1}
var Xc=function(){function a(a,b){return a>b?a:b}var b=null,c=function(){function a(b,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,b,d,l)}function c(a,d,e){return C.c(b,a>d?a:d,e)}a.k=2;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};a.d=c;return a}(),b=function(b,e,f){switch(arguments.length){case 1:return b;case 2:return a.call(this,b,e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);
};b.k=2;b.f=c.f;b.b=function(a){return a};b.a=a;b.d=c.d;return b}();function Yc(a){a=(a-a%2)/2;return 0<=a?Math.floor.b?Math.floor.b(a):Math.floor.call(null,a):Math.ceil.b?Math.ceil.b(a):Math.ceil.call(null,a)}function Zc(a){a-=a>>1&1431655765;a=(a&858993459)+(a>>2&858993459);return 16843009*(a+(a>>4)&252645135)>>24}function $c(a){var b=1;for(a=E(a);;)if(a&&0<b)b-=1,a=I(a);else return a}
var A=function(){function a(a){return null==a?"":a.toString()}var b=null,c=function(){function a(b,d){var k=null;1<arguments.length&&(k=J(Array.prototype.slice.call(arguments,1),0));return c.call(this,b,k)}function c(a,d){for(var e=new ea(b.b(a)),l=d;;)if(r(l))e=e.append(b.b(F(l))),l=I(l);else return e.toString()}a.k=1;a.f=function(a){var b=F(a);a=G(a);return c(b,a)};a.d=c;return a}(),b=function(b,e){switch(arguments.length){case 0:return"";case 1:return a.call(this,b);default:return c.d(b,J(arguments,
1))}throw Error("Invalid arity: "+arguments.length);};b.k=1;b.f=c.f;b.o=function(){return""};b.b=a;b.d=c.d;return b}(),ad=function(){var a=null,a=function(a,c,d){switch(arguments.length){case 2:return a.substring(c);case 3:return a.substring(c,d)}throw Error("Invalid arity: "+arguments.length);};a.a=function(a,c){return a.substring(c)};a.c=function(a,c,d){return a.substring(c,d)};return a}();
function lc(a,b){return Nc(Fc(b)?function(){for(var c=E(a),d=E(b);;){if(null==c)return null==d;if(null==d)return!1;if(Wb.a(F(c),F(d)))c=I(c),d=I(d);else return u?!1:null}}():null)}function bd(a,b,c,d,e){this.j=a;this.first=b;this.ta=c;this.count=d;this.m=e;this.i=65937646;this.q=8192}g=bd.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.j};g.U=function(){return 1===this.count?null:this.ta};g.L=function(){return this.count};g.Ia=function(){return this.first};g.Ja=function(){return Ia(this)};
g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return H};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return this.first};g.S=function(){return 1===this.count?H:this.ta};g.H=function(){return this};g.F=function(a,b){return new bd(b,this.first,this.ta,this.count,this.m)};g.G=function(a,b){return new bd(this.j,b,this,this.count+1,null)};
function cd(a){this.j=a;this.i=65937614;this.q=8192}g=cd.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.j};g.U=function(){return null};g.L=function(){return 0};g.Ia=function(){return null};g.Ja=function(){throw Error("Can't pop empty list");};g.B=function(){return 0};g.v=function(a,b){return lc(this,b)};g.I=function(){return this};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return null};g.S=function(){return H};
g.H=function(){return null};g.F=function(a,b){return new cd(b)};g.G=function(a,b){return new bd(this.j,b,null,1,null)};var H=new cd(null);function dd(a){return a?a.i&134217728||a.Fc?!0:a.i?!1:s(ob,a):s(ob,a)}function ed(a){return dd(a)?pb(a):C.c(pc,H,a)}
var fd=function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){var b;if(a instanceof ac&&0===a.p)b=a.e;else a:{for(b=[];;)if(null!=a)b.push(a.Q(null)),a=a.U(null);else break a;b=void 0}a=b.length;for(var e=H;;)if(0<a){var f=a-1,e=e.G(null,b[a-1]);a=f}else return e}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}();function gd(a,b,c,d){this.j=a;this.first=b;this.ta=c;this.m=d;this.i=65929452;this.q=8192}
g=gd.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.j};g.U=function(){return null==this.ta?null:E(this.ta)};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.j)};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return this.first};g.S=function(){return null==this.ta?H:this.ta};g.H=function(){return this};
g.F=function(a,b){return new gd(b,this.first,this.ta,this.m)};g.G=function(a,b){return new gd(null,b,this,this.m)};function M(a,b){var c=null==b;return(c?c:b&&(b.i&64||b.bb))?new gd(null,a,b,null):new gd(null,a,E(b),null)}function T(a,b,c,d){this.fa=a;this.name=b;this.sa=c;this.Ua=d;this.i=2153775105;this.q=4096}g=T.prototype;g.w=function(a,b){return ub(b,":"+A.b(this.sa))};g.B=function(){var a=this.Ua;return null!=a?a:this.Ua=a=Ub(this)+2654435769};
g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return Q.a(c,this);case 3:return Q.c(c,this,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return Q.a(a,this)};g.a=function(a,b){return Q.c(a,this,b)};g.v=function(a,b){return b instanceof T?this.sa===b.sa:!1};g.toString=function(){return":"+A.b(this.sa)};
function hd(a,b){return a===b?!0:a instanceof T&&b instanceof T?a.sa===b.sa:!1}
var jd=function(){function a(a,b){return new T(a,b,""+A.b(r(a)?""+A.b(a)+"/":null)+A.b(b),null)}function b(a){if(a instanceof T)return a;if(a instanceof Zb){var b;if(a&&(a.q&4096||a.fc))b=a.fa;else throw Error("Doesn't support namespace: "+A.b(a));return new T(b,id.b?id.b(a):id.call(null,a),a.Na,null)}return"string"===typeof a?(b=a.split("/"),2===b.length?new T(b[0],b[1],a,null):new T(null,b[0],a,null)):null}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,
c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}();function V(a,b,c,d){this.j=a;this.Ya=b;this.r=c;this.m=d;this.q=0;this.i=32374988}g=V.prototype;g.toString=function(){return Lb(this)};function kd(a){null!=a.Ya&&(a.r=a.Ya.o?a.Ya.o():a.Ya.call(null),a.Ya=null);return a.r}g.D=function(){return this.j};g.U=function(){lb(this);return null==this.r?null:I(this.r)};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};
g.I=function(){return N(H,this.j)};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){lb(this);return null==this.r?null:F(this.r)};g.S=function(){lb(this);return null!=this.r?G(this.r):H};g.H=function(){kd(this);if(null==this.r)return null;for(var a=this.r;;)if(a instanceof V)a=kd(a);else return this.r=a,E(this.r)};g.F=function(a,b){return new V(b,this.Ya,this.r,this.m)};g.G=function(a,b){return M(b,this)};
function ld(a,b){this.qb=a;this.end=b;this.q=0;this.i=2}ld.prototype.L=function(){return this.end};ld.prototype.add=function(a){this.qb[this.end]=a;return this.end+=1};ld.prototype.da=function(){var a=new md(this.qb,0,this.end);this.qb=null;return a};function md(a,b,c){this.e=a;this.O=b;this.end=c;this.q=0;this.i=524306}g=md.prototype;g.N=function(a,b){return hc.n(this.e,b,this.e[this.O],this.O+1)};g.M=function(a,b,c){return hc.n(this.e,b,c,this.O)};
g.Kb=function(){if(this.O===this.end)throw Error("-drop-first of empty chunk");return new md(this.e,this.O+1,this.end)};g.J=function(a,b){return this.e[this.O+b]};g.aa=function(a,b,c){return 0<=b&&b<this.end-this.O?this.e[this.O+b]:c};g.L=function(){return this.end-this.O};
var nd=function(){function a(a,b,c){return new md(a,b,c)}function b(a,b){return new md(a,b,a.length)}function c(a){return new md(a,0,a.length)}var d=null,d=function(d,f,h){switch(arguments.length){case 1:return c.call(this,d);case 2:return b.call(this,d,f);case 3:return a.call(this,d,f,h)}throw Error("Invalid arity: "+arguments.length);};d.b=c;d.a=b;d.c=a;return d}();function od(a,b,c,d){this.da=a;this.oa=b;this.j=c;this.m=d;this.i=31850732;this.q=1536}g=od.prototype;g.toString=function(){return Lb(this)};
g.D=function(){return this.j};g.U=function(){if(1<Aa(this.da))return new od(Gb(this.da),this.oa,this.j,null);var a=lb(this.oa);return null==a?null:a};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.j)};g.Q=function(){return D.a(this.da,0)};g.S=function(){return 1<Aa(this.da)?new od(Gb(this.da),this.oa,this.j,null):null==this.oa?H:this.oa};g.H=function(){return this};g.sb=function(){return this.da};
g.tb=function(){return null==this.oa?H:this.oa};g.F=function(a,b){return new od(this.da,this.oa,b,this.m)};g.G=function(a,b){return M(b,this)};g.rb=function(){return null==this.oa?null:this.oa};function pd(a,b){return 0===Aa(a)?b:new od(a,b,null,null)}function Rc(a){for(var b=[];;)if(E(a))b.push(F(a)),a=I(a);else return b}function qd(a,b){if(ic(a))return O(a);for(var c=a,d=b,e=0;;)if(0<d&&E(c))c=I(c),d-=1,e+=1;else return e}
var sd=function rd(b){return null==b?null:null==I(b)?E(F(b)):u?M(F(b),rd(I(b))):null},td=function(){function a(a,b){return new V(null,function(){var c=E(a);return c?Ic(c)?pd(Hb(c),d.a(Ib(c),b)):M(F(c),d.a(G(c),b)):b},null,null)}function b(a){return new V(null,function(){return a},null,null)}function c(){return new V(null,function(){return null},null,null)}var d=null,e=function(){function a(c,d,e){var f=null;2<arguments.length&&(f=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,
d,f)}function b(a,c,e){return function t(a,b){return new V(null,function(){var c=E(a);return c?Ic(c)?pd(Hb(c),t(Ib(c),b)):M(F(c),t(G(c),b)):r(b)?t(F(b),I(b)):null},null,null)}(d.a(a,c),e)}a.k=2;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=G(a);return b(c,d,a)};a.d=b;return a}(),d=function(d,h,k){switch(arguments.length){case 0:return c.call(this);case 1:return b.call(this,d);case 2:return a.call(this,d,h);default:return e.d(d,h,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};d.k=
2;d.f=e.f;d.o=c;d.b=b;d.a=a;d.d=e.d;return d}(),ud=function(){function a(a,b,c,d){return M(a,M(b,M(c,d)))}function b(a,b,c){return M(a,M(b,c))}var c=null,d=function(){function a(c,d,e,n,q){var t=null;4<arguments.length&&(t=J(Array.prototype.slice.call(arguments,4),0));return b.call(this,c,d,e,n,t)}function b(a,c,d,e,f){return M(a,M(c,M(d,M(e,sd(f)))))}a.k=4;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=I(a);var e=F(a);a=I(a);var q=F(a);a=G(a);return b(c,d,e,q,a)};a.d=b;return a}(),c=function(c,f,
h,k,l){switch(arguments.length){case 1:return E(c);case 2:return M(c,f);case 3:return b.call(this,c,f,h);case 4:return a.call(this,c,f,h,k);default:return d.d(c,f,h,k,J(arguments,4))}throw Error("Invalid arity: "+arguments.length);};c.k=4;c.f=d.f;c.b=function(a){return E(a)};c.a=function(a,b){return M(a,b)};c.c=b;c.n=a;c.d=d.d;return c}();function vd(a){return Ab(a)}
var wd=function(){var a=null,b=function(){function a(c,f,h){var k=null;2<arguments.length&&(k=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,f,k)}function b(a,c,d){for(;;)if(a=zb(a,c),r(d))c=F(d),d=I(d);else return a}a.k=2;a.f=function(a){var c=F(a);a=I(a);var h=F(a);a=G(a);return b(c,h,a)};a.d=b;return a}(),a=function(a,d,e){switch(arguments.length){case 2:return zb(a,d);default:return b.d(a,d,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};a.k=2;a.f=b.f;a.a=
function(a,b){return zb(a,b)};a.d=b.d;return a}(),xd=function(){var a=null,b=function(){function a(c,f,h,k){var l=null;3<arguments.length&&(l=J(Array.prototype.slice.call(arguments,3),0));return b.call(this,c,f,h,l)}function b(a,c,d,k){for(;;)if(a=Bb(a,c,d),r(k))c=F(k),d=F(I(k)),k=I(I(k));else return a}a.k=3;a.f=function(a){var c=F(a);a=I(a);var h=F(a);a=I(a);var k=F(a);a=G(a);return b(c,h,k,a)};a.d=b;return a}(),a=function(a,d,e,f){switch(arguments.length){case 3:return Bb(a,d,e);default:return b.d(a,
d,e,J(arguments,3))}throw Error("Invalid arity: "+arguments.length);};a.k=3;a.f=b.f;a.c=function(a,b,e){return Bb(a,b,e)};a.d=b.d;return a}(),yd=function(){var a=null,b=function(){function a(c,f,h){var k=null;2<arguments.length&&(k=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,f,k)}function b(a,c,d){for(;;)if(a=Cb(a,c),r(d))c=F(d),d=I(d);else return a}a.k=2;a.f=function(a){var c=F(a);a=I(a);var h=F(a);a=G(a);return b(c,h,a)};a.d=b;return a}(),a=function(a,d,e){switch(arguments.length){case 2:return Cb(a,
d);default:return b.d(a,d,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};a.k=2;a.f=b.f;a.a=function(a,b){return Cb(a,b)};a.d=b.d;return a}(),zd=function(){var a=null,b=function(){function a(c,f,h){var k=null;2<arguments.length&&(k=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,f,k)}function b(a,c,d){for(;;)if(a=Fb(a,c),r(d))c=F(d),d=I(d);else return a}a.k=2;a.f=function(a){var c=F(a);a=I(a);var h=F(a);a=G(a);return b(c,h,a)};a.d=b;return a}(),a=function(a,d,
e){switch(arguments.length){case 2:return Fb(a,d);default:return b.d(a,d,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};a.k=2;a.f=b.f;a.a=function(a,b){return Fb(a,b)};a.d=b.d;return a}();
function Ad(a,b,c){var d=E(c);if(0===b)return a.o?a.o():a.call(null);c=Ha(d);var e=Ia(d);if(1===b)return a.b?a.b(c):a.b?a.b(c):a.call(null,c);var d=Ha(e),f=Ia(e);if(2===b)return a.a?a.a(c,d):a.a?a.a(c,d):a.call(null,c,d);var e=Ha(f),h=Ia(f);if(3===b)return a.c?a.c(c,d,e):a.c?a.c(c,d,e):a.call(null,c,d,e);var f=Ha(h),k=Ia(h);if(4===b)return a.n?a.n(c,d,e,f):a.n?a.n(c,d,e,f):a.call(null,c,d,e,f);var h=Ha(k),l=Ia(k);if(5===b)return a.s?a.s(c,d,e,f,h):a.s?a.s(c,d,e,f,h):a.call(null,c,d,e,f,h);var k=Ha(l),
n=Ia(l);if(6===b)return a.X?a.X(c,d,e,f,h,k):a.X?a.X(c,d,e,f,h,k):a.call(null,c,d,e,f,h,k);var l=Ha(n),q=Ia(n);if(7===b)return a.ga?a.ga(c,d,e,f,h,k,l):a.ga?a.ga(c,d,e,f,h,k,l):a.call(null,c,d,e,f,h,k,l);var n=Ha(q),t=Ia(q);if(8===b)return a.Ga?a.Ga(c,d,e,f,h,k,l,n):a.Ga?a.Ga(c,d,e,f,h,k,l,n):a.call(null,c,d,e,f,h,k,l,n);var q=Ha(t),v=Ia(t);if(9===b)return a.Ha?a.Ha(c,d,e,f,h,k,l,n,q):a.Ha?a.Ha(c,d,e,f,h,k,l,n,q):a.call(null,c,d,e,f,h,k,l,n,q);var t=Ha(v),w=Ia(v);if(10===b)return a.va?a.va(c,d,e,
f,h,k,l,n,q,t):a.va?a.va(c,d,e,f,h,k,l,n,q,t):a.call(null,c,d,e,f,h,k,l,n,q,t);var v=Ha(w),y=Ia(w);if(11===b)return a.wa?a.wa(c,d,e,f,h,k,l,n,q,t,v):a.wa?a.wa(c,d,e,f,h,k,l,n,q,t,v):a.call(null,c,d,e,f,h,k,l,n,q,t,v);var w=Ha(y),B=Ia(y);if(12===b)return a.xa?a.xa(c,d,e,f,h,k,l,n,q,t,v,w):a.xa?a.xa(c,d,e,f,h,k,l,n,q,t,v,w):a.call(null,c,d,e,f,h,k,l,n,q,t,v,w);var y=Ha(B),L=Ia(B);if(13===b)return a.ya?a.ya(c,d,e,f,h,k,l,n,q,t,v,w,y):a.ya?a.ya(c,d,e,f,h,k,l,n,q,t,v,w,y):a.call(null,c,d,e,f,h,k,l,n,q,
t,v,w,y);var B=Ha(L),U=Ia(L);if(14===b)return a.za?a.za(c,d,e,f,h,k,l,n,q,t,v,w,y,B):a.za?a.za(c,d,e,f,h,k,l,n,q,t,v,w,y,B):a.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B);var L=Ha(U),Z=Ia(U);if(15===b)return a.Aa?a.Aa(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L):a.Aa?a.Aa(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L):a.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L);var U=Ha(Z),na=Ia(Z);if(16===b)return a.Ba?a.Ba(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U):a.Ba?a.Ba(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U):a.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U);var Z=
Ha(na),Ga=Ia(na);if(17===b)return a.Ca?a.Ca(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z):a.Ca?a.Ca(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z):a.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z);var na=Ha(Ga),Ra=Ia(Ga);if(18===b)return a.Da?a.Da(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na):a.Da?a.Da(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na):a.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na);Ga=Ha(Ra);Ra=Ia(Ra);if(19===b)return a.Ea?a.Ea(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga):a.Ea?a.Ea(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga):a.call(null,
c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga);var wc=Ha(Ra);Ia(Ra);if(20===b)return a.Fa?a.Fa(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga,wc):a.Fa?a.Fa(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga,wc):a.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga,wc);throw Error("Only up to 20 arguments supported on functions");}
var S=function(){function a(a,b,c,d,e){b=ud.n(b,c,d,e);c=a.k;return a.f?(d=qd(b,c+1),d<=c?Ad(a,d,b):a.f(b)):a.apply(a,Rc(b))}function b(a,b,c,d){b=ud.c(b,c,d);c=a.k;return a.f?(d=qd(b,c+1),d<=c?Ad(a,d,b):a.f(b)):a.apply(a,Rc(b))}function c(a,b,c){b=ud.a(b,c);c=a.k;if(a.f){var d=qd(b,c+1);return d<=c?Ad(a,d,b):a.f(b)}return a.apply(a,Rc(b))}function d(a,b){var c=a.k;if(a.f){var d=qd(b,c+1);return d<=c?Ad(a,d,b):a.f(b)}return a.apply(a,Rc(b))}var e=null,f=function(){function a(c,d,e,f,h,w){var y=null;
5<arguments.length&&(y=J(Array.prototype.slice.call(arguments,5),0));return b.call(this,c,d,e,f,h,y)}function b(a,c,d,e,f,h){c=M(c,M(d,M(e,M(f,sd(h)))));d=a.k;return a.f?(e=qd(c,d+1),e<=d?Ad(a,e,c):a.f(c)):a.apply(a,Rc(c))}a.k=5;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=I(a);var e=F(a);a=I(a);var f=F(a);a=I(a);var h=F(a);a=G(a);return b(c,d,e,f,h,a)};a.d=b;return a}(),e=function(e,k,l,n,q,t){switch(arguments.length){case 2:return d.call(this,e,k);case 3:return c.call(this,e,k,l);case 4:return b.call(this,
e,k,l,n);case 5:return a.call(this,e,k,l,n,q);default:return f.d(e,k,l,n,q,J(arguments,5))}throw Error("Invalid arity: "+arguments.length);};e.k=5;e.f=f.f;e.a=d;e.c=c;e.n=b;e.s=a;e.d=f.d;return e}(),Bd=function(){function a(a,b){return!Wb.a(a,b)}var b=null,c=function(){function a(c,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,d,l)}function b(a,c,d){return sa(S.n(Wb,a,c,d))}a.k=2;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=G(a);return b(c,
d,a)};a.d=b;return a}(),b=function(b,e,f){switch(arguments.length){case 1:return!1;case 2:return a.call(this,b,e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;b.b=function(){return!1};b.a=a;b.d=c.d;return b}();function Cd(a){return E(a)?a:null}function Dd(a,b){for(;;){if(null==E(b))return!0;if(r(a.b?a.b(F(b)):a.call(null,F(b)))){var c=a,d=I(b);a=c;b=d}else return u?!1:null}}
function Ed(a,b){for(;;)if(E(b)){var c=a.b?a.b(F(b)):a.call(null,F(b));if(r(c))return c;var c=a,d=I(b);a=c;b=d}else return null}function Fd(a){return a}
function Gd(a){return function(){var b=null,c=function(){function b(a,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,a,d,l)}function c(b,d,e){return sa(S.n(a,b,d,e))}b.k=2;b.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};b.d=c;return b}(),b=function(b,e,f){switch(arguments.length){case 0:return sa(a.o?a.o():a.call(null));case 1:var h=b;return sa(a.b?a.b(h):a.call(null,h));case 2:var h=b,k=e;return sa(a.a?a.a(h,k):a.call(null,
h,k));default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;return b}()}
var Hd=function(){function a(a,b,c){return function(){var d=null,l=function(){function d(a,b,c,e){var f=null;3<arguments.length&&(f=J(Array.prototype.slice.call(arguments,3),0));return k.call(this,a,b,c,f)}function k(d,l,n,q){return a.b?a.b(b.b?b.b(S.s(c,d,l,n,q)):b.call(null,S.s(c,d,l,n,q))):a.call(null,b.b?b.b(S.s(c,d,l,n,q)):b.call(null,S.s(c,d,l,n,q)))}d.k=3;d.f=function(a){var b=F(a);a=I(a);var c=F(a);a=I(a);var d=F(a);a=G(a);return k(b,c,d,a)};d.d=k;return d}(),d=function(d,k,t,v){switch(arguments.length){case 0:return a.b?
a.b(b.b?b.b(c.o?c.o():c.call(null)):b.call(null,c.o?c.o():c.call(null))):a.call(null,b.b?b.b(c.o?c.o():c.call(null)):b.call(null,c.o?c.o():c.call(null)));case 1:var w=d;return a.b?a.b(b.b?b.b(c.b?c.b(w):c.call(null,w)):b.call(null,c.b?c.b(w):c.call(null,w))):a.call(null,b.b?b.b(c.b?c.b(w):c.call(null,w)):b.call(null,c.b?c.b(w):c.call(null,w)));case 2:var w=d,y=k;return a.b?a.b(b.b?b.b(c.a?c.a(w,y):c.call(null,w,y)):b.call(null,c.a?c.a(w,y):c.call(null,w,y))):a.call(null,b.b?b.b(c.a?c.a(w,y):c.call(null,
w,y)):b.call(null,c.a?c.a(w,y):c.call(null,w,y)));case 3:var w=d,y=k,B=t;return a.b?a.b(b.b?b.b(c.c?c.c(w,y,B):c.call(null,w,y,B)):b.call(null,c.c?c.c(w,y,B):c.call(null,w,y,B))):a.call(null,b.b?b.b(c.c?c.c(w,y,B):c.call(null,w,y,B)):b.call(null,c.c?c.c(w,y,B):c.call(null,w,y,B)));default:return l.d(d,k,t,J(arguments,3))}throw Error("Invalid arity: "+arguments.length);};d.k=3;d.f=l.f;return d}()}function b(a,b){return function(){var c=null,d=function(){function c(a,b,e,f){var h=null;3<arguments.length&&
(h=J(Array.prototype.slice.call(arguments,3),0));return d.call(this,a,b,e,h)}function d(c,h,k,l){return a.b?a.b(S.s(b,c,h,k,l)):a.call(null,S.s(b,c,h,k,l))}c.k=3;c.f=function(a){var b=F(a);a=I(a);var c=F(a);a=I(a);var e=F(a);a=G(a);return d(b,c,e,a)};c.d=d;return c}(),c=function(c,h,q,t){switch(arguments.length){case 0:return a.b?a.b(b.o?b.o():b.call(null)):a.call(null,b.o?b.o():b.call(null));case 1:var v=c;return a.b?a.b(b.b?b.b(v):b.call(null,v)):a.call(null,b.b?b.b(v):b.call(null,v));case 2:var v=
c,w=h;return a.b?a.b(b.a?b.a(v,w):b.call(null,v,w)):a.call(null,b.a?b.a(v,w):b.call(null,v,w));case 3:var v=c,w=h,y=q;return a.b?a.b(b.c?b.c(v,w,y):b.call(null,v,w,y)):a.call(null,b.c?b.c(v,w,y):b.call(null,v,w,y));default:return d.d(c,h,q,J(arguments,3))}throw Error("Invalid arity: "+arguments.length);};c.k=3;c.f=d.f;return c}()}var c=null,d=function(){function a(c,d,e,n){var q=null;3<arguments.length&&(q=J(Array.prototype.slice.call(arguments,3),0));return b.call(this,c,d,e,q)}function b(a,c,d,
e){return function(a){return function(){function b(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return c.call(this,d)}function c(b){b=S.a(F(a),b);for(var d=I(a);;)if(d)b=F(d).call(null,b),d=I(d);else return b}b.k=0;b.f=function(a){a=E(a);return c(a)};b.d=c;return b}()}(ed(ud.n(a,c,d,e)))}a.k=3;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=I(a);var e=F(a);a=G(a);return b(c,d,e,a)};a.d=b;return a}(),c=function(c,f,h,k){switch(arguments.length){case 0:return Fd;
case 1:return c;case 2:return b.call(this,c,f);case 3:return a.call(this,c,f,h);default:return d.d(c,f,h,J(arguments,3))}throw Error("Invalid arity: "+arguments.length);};c.k=3;c.f=d.f;c.o=function(){return Fd};c.b=function(a){return a};c.a=b;c.c=a;c.d=d.d;return c}(),Id=function(){function a(a,b,c,d){return function(){function e(a){var b=null;0<arguments.length&&(b=J(Array.prototype.slice.call(arguments,0),0));return q.call(this,b)}function q(e){return S.s(a,b,c,d,e)}e.k=0;e.f=function(a){a=E(a);
return q(a)};e.d=q;return e}()}function b(a,b,c){return function(){function d(a){var b=null;0<arguments.length&&(b=J(Array.prototype.slice.call(arguments,0),0));return e.call(this,b)}function e(d){return S.n(a,b,c,d)}d.k=0;d.f=function(a){a=E(a);return e(a)};d.d=e;return d}()}function c(a,b){return function(){function c(a){var b=null;0<arguments.length&&(b=J(Array.prototype.slice.call(arguments,0),0));return d.call(this,b)}function d(c){return S.c(a,b,c)}c.k=0;c.f=function(a){a=E(a);return d(a)};
c.d=d;return c}()}var d=null,e=function(){function a(c,d,e,f,t){var v=null;4<arguments.length&&(v=J(Array.prototype.slice.call(arguments,4),0));return b.call(this,c,d,e,f,v)}function b(a,c,d,e,f){return function(){function b(a){var c=null;0<arguments.length&&(c=J(Array.prototype.slice.call(arguments,0),0));return h.call(this,c)}function h(b){return S.s(a,c,d,e,td.a(f,b))}b.k=0;b.f=function(a){a=E(a);return h(a)};b.d=h;return b}()}a.k=4;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=I(a);var e=F(a);
a=I(a);var f=F(a);a=G(a);return b(c,d,e,f,a)};a.d=b;return a}(),d=function(d,h,k,l,n){switch(arguments.length){case 1:return d;case 2:return c.call(this,d,h);case 3:return b.call(this,d,h,k);case 4:return a.call(this,d,h,k,l);default:return e.d(d,h,k,l,J(arguments,4))}throw Error("Invalid arity: "+arguments.length);};d.k=4;d.f=e.f;d.b=function(a){return a};d.a=c;d.c=b;d.n=a;d.d=e.d;return d}(),Jd=function(){function a(a,b,c,d){return function(){var l=null,n=function(){function l(a,b,c,d){var e=null;
3<arguments.length&&(e=J(Array.prototype.slice.call(arguments,3),0));return n.call(this,a,b,c,e)}function n(l,q,t,B){return S.s(a,null==l?b:l,null==q?c:q,null==t?d:t,B)}l.k=3;l.f=function(a){var b=F(a);a=I(a);var c=F(a);a=I(a);var d=F(a);a=G(a);return n(b,c,d,a)};l.d=n;return l}(),l=function(l,t,v,w){switch(arguments.length){case 2:var y=l,B=t;return a.a?a.a(null==y?b:y,null==B?c:B):a.call(null,null==y?b:y,null==B?c:B);case 3:var y=l,B=t,L=v;return a.c?a.c(null==y?b:y,null==B?c:B,null==L?d:L):a.call(null,
null==y?b:y,null==B?c:B,null==L?d:L);default:return n.d(l,t,v,J(arguments,3))}throw Error("Invalid arity: "+arguments.length);};l.k=3;l.f=n.f;return l}()}function b(a,b,c){return function(){var d=null,l=function(){function d(a,b,c,e){var f=null;3<arguments.length&&(f=J(Array.prototype.slice.call(arguments,3),0));return k.call(this,a,b,c,f)}function k(d,l,n,q){return S.s(a,null==d?b:d,null==l?c:l,n,q)}d.k=3;d.f=function(a){var b=F(a);a=I(a);var c=F(a);a=I(a);var d=F(a);a=G(a);return k(b,c,d,a)};d.d=
k;return d}(),d=function(d,k,t,v){switch(arguments.length){case 2:var w=d,y=k;return a.a?a.a(null==w?b:w,null==y?c:y):a.call(null,null==w?b:w,null==y?c:y);case 3:var w=d,y=k,B=t;return a.c?a.c(null==w?b:w,null==y?c:y,B):a.call(null,null==w?b:w,null==y?c:y,B);default:return l.d(d,k,t,J(arguments,3))}throw Error("Invalid arity: "+arguments.length);};d.k=3;d.f=l.f;return d}()}function c(a,b){return function(){var c=null,d=function(){function c(a,b,e,f){var h=null;3<arguments.length&&(h=J(Array.prototype.slice.call(arguments,
3),0));return d.call(this,a,b,e,h)}function d(c,h,k,l){return S.s(a,null==c?b:c,h,k,l)}c.k=3;c.f=function(a){var b=F(a);a=I(a);var c=F(a);a=I(a);var e=F(a);a=G(a);return d(b,c,e,a)};c.d=d;return c}(),c=function(c,h,q,t){switch(arguments.length){case 1:var v=c;return a.b?a.b(null==v?b:v):a.call(null,null==v?b:v);case 2:var v=c,w=h;return a.a?a.a(null==v?b:v,w):a.call(null,null==v?b:v,w);case 3:var v=c,w=h,y=q;return a.c?a.c(null==v?b:v,w,y):a.call(null,null==v?b:v,w,y);default:return d.d(c,h,q,J(arguments,
3))}throw Error("Invalid arity: "+arguments.length);};c.k=3;c.f=d.f;return c}()}var d=null,d=function(d,f,h,k){switch(arguments.length){case 2:return c.call(this,d,f);case 3:return b.call(this,d,f,h);case 4:return a.call(this,d,f,h,k)}throw Error("Invalid arity: "+arguments.length);};d.a=c;d.c=b;d.n=a;return d}(),Kd=function(){function a(a,b,c,e){return new V(null,function(){var n=E(b),q=E(c),t=E(e);return n&&q&&t?M(a.c?a.c(F(n),F(q),F(t)):a.call(null,F(n),F(q),F(t)),d.n(a,G(n),G(q),G(t))):null},
null,null)}function b(a,b,c){return new V(null,function(){var e=E(b),n=E(c);return e&&n?M(a.a?a.a(F(e),F(n)):a.call(null,F(e),F(n)),d.c(a,G(e),G(n))):null},null,null)}function c(a,b){return new V(null,function(){var c=E(b);if(c){if(Ic(c)){for(var e=Hb(c),n=O(e),q=new ld(Array(n),0),t=0;;)if(t<n){var v=a.b?a.b(D.a(e,t)):a.call(null,D.a(e,t));q.add(v);t+=1}else break;return pd(q.da(),d.a(a,Ib(c)))}return M(a.b?a.b(F(c)):a.call(null,F(c)),d.a(a,G(c)))}return null},null,null)}var d=null,e=function(){function a(c,
d,e,f,t){var v=null;4<arguments.length&&(v=J(Array.prototype.slice.call(arguments,4),0));return b.call(this,c,d,e,f,v)}function b(a,c,e,f,h){var v=function y(a){return new V(null,function(){var b=d.a(E,a);return Dd(Fd,b)?M(d.a(F,b),y(d.a(G,b))):null},null,null)};return d.a(function(){return function(b){return S.a(a,b)}}(v),v(pc.d(h,f,J([e,c],0))))}a.k=4;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=I(a);var e=F(a);a=I(a);var f=F(a);a=G(a);return b(c,d,e,f,a)};a.d=b;return a}(),d=function(d,h,k,l,
n){switch(arguments.length){case 2:return c.call(this,d,h);case 3:return b.call(this,d,h,k);case 4:return a.call(this,d,h,k,l);default:return e.d(d,h,k,l,J(arguments,4))}throw Error("Invalid arity: "+arguments.length);};d.k=4;d.f=e.f;d.a=c;d.c=b;d.n=a;d.d=e.d;return d}(),Md=function Ld(b,c){return new V(null,function(){if(0<b){var d=E(c);return d?M(F(d),Ld(b-1,G(d))):null}return null},null,null)};
function Nd(a,b){return new V(null,function(c){return function(){return c(a,b)}}(function(a,b){for(;;){var e=E(b);if(0<a&&e){var f=a-1,e=G(e);a=f;b=e}else return e}}),null,null)}
var Od=function(){function a(a,b){return Md(a,c.b(b))}function b(a){return new V(null,function(){return M(a,c.b(a))},null,null)}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),Pd=function(){function a(a,b){return Md(a,c.b(b))}function b(a){return new V(null,function(){return M(a.o?a.o():a.call(null),c.b(a))},null,null)}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,
c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),Qd=function(){function a(a,c){return new V(null,function(){var f=E(a),h=E(c);return f&&h?M(F(f),M(F(h),b.a(G(f),G(h)))):null},null,null)}var b=null,c=function(){function a(b,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,b,d,l)}function c(a,d,e){return new V(null,function(){var c=Kd.a(E,pc.d(e,d,J([a],0)));return Dd(Fd,c)?td.a(Kd.a(F,
c),S.a(b,Kd.a(G,c))):null},null,null)}a.k=2;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};a.d=c;return a}(),b=function(b,e,f){switch(arguments.length){case 2:return a.call(this,b,e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;b.a=a;b.d=c.d;return b}();function Rd(a){return function c(a,e){return new V(null,function(){var f=E(a);return f?M(F(f),c(G(f),e)):E(e)?c(F(e),G(e)):null},null,null)}(null,a)}
var Sd=function(){function a(a,b){return Rd(Kd.a(a,b))}var b=null,c=function(){function a(c,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,d,l)}function b(a,c,d){return Rd(S.n(Kd,a,c,d))}a.k=2;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=G(a);return b(c,d,a)};a.d=b;return a}(),b=function(b,e,f){switch(arguments.length){case 2:return a.call(this,b,e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};
b.k=2;b.f=c.f;b.a=a;b.d=c.d;return b}(),Ud=function Td(b,c){return new V(null,function(){var d=E(c);if(d){if(Ic(d)){for(var e=Hb(d),f=O(e),h=new ld(Array(f),0),k=0;;)if(k<f){if(r(b.b?b.b(D.a(e,k)):b.call(null,D.a(e,k)))){var l=D.a(e,k);h.add(l)}k+=1}else break;return pd(h.da(),Td(b,Ib(d)))}e=F(d);d=G(d);return r(b.b?b.b(e):b.call(null,e))?M(e,Td(b,d)):Td(b,d)}return null},null,null)};function Vd(a,b){return Ud(Gd(a),b)}
function Wd(a){var b=Xd;return function d(a){return new V(null,function(){return M(a,r(b.b?b.b(a):b.call(null,a))?Sd.a(d,E.b?E.b(a):E.call(null,a)):null)},null,null)}(a)}function Yd(a,b){return null!=a?a&&(a.q&4||a.Bc)?vd(C.c(zb,yb(a),b)):C.c(Da,a,b):C.c(pc,H,b)}
var Zd=function(){function a(a,b,c,k){return new V(null,function(){var l=E(k);if(l){var n=Md(a,l);return a===O(n)?M(n,d.n(a,b,c,Nd(b,l))):Da(H,Md(a,td.a(n,c)))}return null},null,null)}function b(a,b,c){return new V(null,function(){var k=E(c);if(k){var l=Md(a,k);return a===O(l)?M(l,d.c(a,b,Nd(b,k))):null}return null},null,null)}function c(a,b){return d.c(a,a,b)}var d=null,d=function(d,f,h,k){switch(arguments.length){case 2:return c.call(this,d,f);case 3:return b.call(this,d,f,h);case 4:return a.call(this,
d,f,h,k)}throw Error("Invalid arity: "+arguments.length);};d.a=c;d.c=b;d.n=a;return d}(),$d=function(){function a(a,b,c){var h=Lc;for(b=E(b);;)if(b){var k=a;if(k?k.i&256||k.Mb||(k.i?0:s(Ka,k)):s(Ka,k)){a=Q.c(a,F(b),h);if(h===a)return c;b=I(b)}else return c}else return a}function b(a,b){return c.c(a,b,null)}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}(),ae=
function(){function a(a,b,c,d,f,t){var v=P.c(b,0,null);return(b=$c(b))?R.c(a,v,e.X(Q.a(a,v),b,c,d,f,t)):R.c(a,v,c.n?c.n(Q.a(a,v),d,f,t):c.call(null,Q.a(a,v),d,f,t))}function b(a,b,c,d,f){var t=P.c(b,0,null);return(b=$c(b))?R.c(a,t,e.s(Q.a(a,t),b,c,d,f)):R.c(a,t,c.c?c.c(Q.a(a,t),d,f):c.call(null,Q.a(a,t),d,f))}function c(a,b,c,d){var f=P.c(b,0,null);return(b=$c(b))?R.c(a,f,e.n(Q.a(a,f),b,c,d)):R.c(a,f,c.a?c.a(Q.a(a,f),d):c.call(null,Q.a(a,f),d))}function d(a,b,c){var d=P.c(b,0,null);return(b=$c(b))?
R.c(a,d,e.c(Q.a(a,d),b,c)):R.c(a,d,c.b?c.b(Q.a(a,d)):c.call(null,Q.a(a,d)))}var e=null,f=function(){function a(c,d,e,f,h,w,y){var B=null;6<arguments.length&&(B=J(Array.prototype.slice.call(arguments,6),0));return b.call(this,c,d,e,f,h,w,B)}function b(a,c,d,f,h,k,y){var B=P.c(c,0,null);return(c=$c(c))?R.c(a,B,S.d(e,Q.a(a,B),c,d,f,J([h,k,y],0))):R.c(a,B,S.d(d,Q.a(a,B),f,h,k,J([y],0)))}a.k=6;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=I(a);var e=F(a);a=I(a);var f=F(a);a=I(a);var h=F(a);a=I(a);var y=
F(a);a=G(a);return b(c,d,e,f,h,y,a)};a.d=b;return a}(),e=function(e,k,l,n,q,t,v){switch(arguments.length){case 3:return d.call(this,e,k,l);case 4:return c.call(this,e,k,l,n);case 5:return b.call(this,e,k,l,n,q);case 6:return a.call(this,e,k,l,n,q,t);default:return f.d(e,k,l,n,q,t,J(arguments,6))}throw Error("Invalid arity: "+arguments.length);};e.k=6;e.f=f.f;e.c=d;e.n=c;e.s=b;e.X=a;e.d=f.d;return e}();function be(a,b){this.t=a;this.e=b}
function ce(a){return new be(a,[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null])}function de(a){return new be(a.t,va(a.e))}function ee(a){a=a.g;return 32>a?0:a-1>>>5<<5}function fe(a,b,c){for(;;){if(0===b)return c;var d=ce(a);d.e[0]=c;c=d;b-=5}}var he=function ge(b,c,d,e){var f=de(d),h=b.g-1>>>c&31;5===c?f.e[h]=e:(d=d.e[h],b=null!=d?ge(b,c-5,d,e):fe(null,c-5,e),f.e[h]=b);return f};
function ie(a,b){throw Error("No item "+A.b(a)+" in vector of length "+A.b(b));}function je(a){var b=a.root;for(a=a.shift;;)if(0<a)a-=5,b=b.e[0];else return b.e}function ke(a,b){if(b>=ee(a))return a.R;for(var c=a.root,d=a.shift;;)if(0<d)var e=d-5,c=c.e[b>>>d&31],d=e;else return c.e}function le(a,b){return 0<=b&&b<a.g?ke(a,b):ie(b,a.g)}
var ne=function me(b,c,d,e,f){var h=de(d);if(0===c)h.e[e&31]=f;else{var k=e>>>c&31;b=me(b,c-5,d.e[k],e,f);h.e[k]=b}return h},pe=function oe(b,c,d){var e=b.g-2>>>c&31;if(5<c){b=oe(b,c-5,d.e[e]);if(null==b&&0===e)return null;d=de(d);d.e[e]=b;return d}return 0===e?null:u?(d=de(d),d.e[e]=null,d):null};function W(a,b,c,d,e,f){this.j=a;this.g=b;this.shift=c;this.root=d;this.R=e;this.m=f;this.i=167668511;this.q=8196}g=W.prototype;g.toString=function(){return Lb(this)};
g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){return"number"===typeof b?D.c(this,b,c):c};g.Za=function(a,b,c){a=[0,c];for(c=0;;)if(c<this.g){var d=ke(this,c),e=d.length;a:{for(var f=0,h=a[1];;)if(f<e){h=b.c?b.c(h,f+c,d[f]):b.call(null,h,f+c,d[f]);if(fc(h)){d=h;break a}f+=1}else{a[0]=e;d=a[1]=h;break a}d=void 0}if(fc(d))return K.b?K.b(d):K.call(null,d);c+=a[0]}else return a[1]};g.J=function(a,b){return le(this,b)[b&31]};
g.aa=function(a,b,c){return 0<=b&&b<this.g?ke(this,b)[b&31]:c};g.Pa=function(a,b,c){if(0<=b&&b<this.g)return ee(this)<=b?(a=va(this.R),a[b&31]=c,new W(this.j,this.g,this.shift,this.root,a,null)):new W(this.j,this.g,this.shift,ne(this,this.shift,this.root,b,c),this.R,null);if(b===this.g)return Da(this,c);if(u)throw Error("Index "+A.b(b)+" out of bounds  [0,"+A.b(this.g)+"]");return null};g.D=function(){return this.j};g.L=function(){return this.g};g.$a=function(){return D.a(this,0)};
g.ab=function(){return D.a(this,1)};g.Ia=function(){return 0<this.g?D.a(this,this.g-1):null};g.Ja=function(){if(0===this.g)throw Error("Can't pop empty vector");if(1===this.g)return eb(qe,this.j);if(1<this.g-ee(this))return new W(this.j,this.g-1,this.shift,this.root,this.R.slice(0,-1),null);if(u){var a=ke(this,this.g-2),b=pe(this,this.shift,this.root),b=null==b?X:b,c=this.g-1;return 5<this.shift&&null==b.e[1]?new W(this.j,c,this.shift-5,b.e[0],a,null):new W(this.j,c,this.shift,b,a,null)}return null};
g.Xa=function(){return 0<this.g?new kc(this,this.g-1,null):null};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.Wa=function(){return new re(this.g,this.shift,se.b?se.b(this.root):se.call(null,this.root),te.b?te.b(this.R):te.call(null,this.R))};g.I=function(){return N(qe,this.j)};g.N=function(a,b){return gc.a(this,b)};g.M=function(a,b,c){return gc.c(this,b,c)};
g.ua=function(a,b,c){if("number"===typeof b)return $a(this,b,c);throw Error("Vector's key for assoc must be a number.");};g.H=function(){return 0===this.g?null:32>=this.g?new ac(this.R,0):u?ue.n?ue.n(this,je(this),0,0):ue.call(null,this,je(this),0,0):null};g.F=function(a,b){return new W(b,this.g,this.shift,this.root,this.R,this.m)};
g.G=function(a,b){if(32>this.g-ee(this)){for(var c=this.R.length,d=Array(c+1),e=0;;)if(e<c)d[e]=this.R[e],e+=1;else break;d[c]=b;return new W(this.j,this.g+1,this.shift,this.root,d,null)}c=(d=this.g>>>5>1<<this.shift)?this.shift+5:this.shift;d?(d=ce(null),d.e[0]=this.root,e=fe(null,this.shift,new be(null,this.R)),d.e[1]=e):d=he(this,this.shift,this.root,new be(null,this.R));return new W(this.j,this.g+1,c,d,[b],null)};
g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.J(null,c);case 3:return this.aa(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return this.J(null,a)};g.a=function(a,b){return this.aa(null,a,b)};
var X=new be(null,[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]),qe=new W(null,0,5,X,[],0);function ve(a,b){var c=a.length,d=b?a:va(a);if(32>c)return new W(null,c,5,X,d,null);for(var e=32,f=(new W(null,32,5,X,d.slice(0,32),null)).Wa(null);;)if(e<c)var h=e+1,f=wd.a(f,d[e]),e=h;else return Ab(f)}function we(a){return Ab(C.c(zb,yb(qe),a))}
var xe=function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){return a instanceof ac&&0===a.p?ve.a?ve.a(a.e,!0):ve.call(null,a.e,!0):we(a)}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}();function ye(a,b,c,d,e,f){this.P=a;this.ea=b;this.p=c;this.O=d;this.j=e;this.m=f;this.i=32243948;this.q=1536}g=ye.prototype;g.toString=function(){return Lb(this)};
g.U=function(){if(this.O+1<this.ea.length){var a=ue.n?ue.n(this.P,this.ea,this.p,this.O+1):ue.call(null,this.P,this.ea,this.p,this.O+1);return null==a?null:a}return Jb(this)};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(qe,this.j)};g.N=function(a,b){return gc.a(ze.c?ze.c(this.P,this.p+this.O,O(this.P)):ze.call(null,this.P,this.p+this.O,O(this.P)),b)};
g.M=function(a,b,c){return gc.c(ze.c?ze.c(this.P,this.p+this.O,O(this.P)):ze.call(null,this.P,this.p+this.O,O(this.P)),b,c)};g.Q=function(){return this.ea[this.O]};g.S=function(){if(this.O+1<this.ea.length){var a=ue.n?ue.n(this.P,this.ea,this.p,this.O+1):ue.call(null,this.P,this.ea,this.p,this.O+1);return null==a?H:a}return Ib(this)};g.H=function(){return this};g.sb=function(){return nd.a(this.ea,this.O)};
g.tb=function(){var a=this.p+this.ea.length;return a<Aa(this.P)?ue.n?ue.n(this.P,ke(this.P,a),a,0):ue.call(null,this.P,ke(this.P,a),a,0):H};g.F=function(a,b){return ue.s?ue.s(this.P,this.ea,this.p,this.O,b):ue.call(null,this.P,this.ea,this.p,this.O,b)};g.G=function(a,b){return M(b,this)};g.rb=function(){var a=this.p+this.ea.length;return a<Aa(this.P)?ue.n?ue.n(this.P,ke(this.P,a),a,0):ue.call(null,this.P,ke(this.P,a),a,0):null};
var ue=function(){function a(a,b,c,d,l){return new ye(a,b,c,d,l,null)}function b(a,b,c,d){return new ye(a,b,c,d,null,null)}function c(a,b,c){return new ye(a,le(a,b),b,c,null,null)}var d=null,d=function(d,f,h,k,l){switch(arguments.length){case 3:return c.call(this,d,f,h);case 4:return b.call(this,d,f,h,k);case 5:return a.call(this,d,f,h,k,l)}throw Error("Invalid arity: "+arguments.length);};d.c=c;d.n=b;d.s=a;return d}();
function Ae(a,b,c,d,e){this.j=a;this.ca=b;this.start=c;this.end=d;this.m=e;this.i=166617887;this.q=8192}g=Ae.prototype;g.toString=function(){return Lb(this)};g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){return"number"===typeof b?D.c(this,b,c):c};g.J=function(a,b){return 0>b||this.end<=this.start+b?ie(b,this.end-this.start):D.a(this.ca,this.start+b)};g.aa=function(a,b,c){return 0>b||this.end<=this.start+b?c:D.c(this.ca,this.start+b,c)};
g.Pa=function(a,b,c){var d=this,e=d.start+b;return Be.s?Be.s(d.j,R.c(d.ca,e,c),d.start,function(){var a=d.end,b=e+1;return a>b?a:b}(),null):Be.call(null,d.j,R.c(d.ca,e,c),d.start,function(){var a=d.end,b=e+1;return a>b?a:b}(),null)};g.D=function(){return this.j};g.L=function(){return this.end-this.start};g.Ia=function(){return D.a(this.ca,this.end-1)};
g.Ja=function(){if(this.start===this.end)throw Error("Can't pop empty vector");return Be.s?Be.s(this.j,this.ca,this.start,this.end-1,null):Be.call(null,this.j,this.ca,this.start,this.end-1,null)};g.Xa=function(){return this.start!==this.end?new kc(this,this.end-this.start-1,null):null};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(qe,this.j)};g.N=function(a,b){return gc.a(this,b)};
g.M=function(a,b,c){return gc.c(this,b,c)};g.ua=function(a,b,c){if("number"===typeof b)return $a(this,b,c);throw Error("Subvec's key for assoc must be a number.");};g.H=function(){var a=this;return function(b){return function d(e){return e===a.end?null:M(D.a(a.ca,e),new V(null,function(){return function(){return d(e+1)}}(b),null,null))}}(this)(a.start)};g.F=function(a,b){return Be.s?Be.s(b,this.ca,this.start,this.end,this.m):Be.call(null,b,this.ca,this.start,this.end,this.m)};
g.G=function(a,b){return Be.s?Be.s(this.j,$a(this.ca,this.end,b),this.start,this.end+1,null):Be.call(null,this.j,$a(this.ca,this.end,b),this.start,this.end+1,null)};g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.J(null,c);case 3:return this.aa(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return this.J(null,a)};
g.a=function(a,b){return this.aa(null,a,b)};function Be(a,b,c,d,e){for(;;)if(b instanceof Ae)c=b.start+c,d=b.start+d,b=b.ca;else{var f=O(b);if(0>c||0>d||c>f||d>f)throw Error("Index out of bounds");return new Ae(a,b,c,d,e)}}
var ze=function(){function a(a,b,c){return Be(null,a,b,c,null)}function b(a,b){return c.c(a,b,O(a))}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}();function Ce(a,b){return a===b.t?b:new be(a,va(b.e))}function se(a){return new be({},va(a.e))}
function te(a){var b=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];Kc(a,0,b,0,a.length);return b}
var Ee=function De(b,c,d,e){d=Ce(b.root.t,d);var f=b.g-1>>>c&31;if(5===c)b=e;else{var h=d.e[f];b=null!=h?De(b,c-5,h,e):fe(b.root.t,c-5,e)}d.e[f]=b;return d},Ge=function Fe(b,c,d){d=Ce(b.root.t,d);var e=b.g-2>>>c&31;if(5<c){b=Fe(b,c-5,d.e[e]);if(null==b&&0===e)return null;d.e[e]=b;return d}return 0===e?null:u?(d.e[e]=null,d):null};function re(a,b,c,d){this.g=a;this.shift=b;this.root=c;this.R=d;this.i=275;this.q=88}g=re.prototype;
g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.u(null,c);case 3:return this.C(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return this.u(null,a)};g.a=function(a,b){return this.C(null,a,b)};g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){return"number"===typeof b?D.c(this,b,c):c};
g.J=function(a,b){if(this.root.t)return le(this,b)[b&31];throw Error("nth after persistent!");};g.aa=function(a,b,c){return 0<=b&&b<this.g?D.a(this,b):c};g.L=function(){if(this.root.t)return this.g;throw Error("count after persistent!");};
g.Pb=function(a,b,c){var d=this;if(d.root.t){if(0<=b&&b<d.g)return ee(this)<=b?d.R[b&31]=c:(a=function(){return function f(a,k){var l=Ce(d.root.t,k);if(0===a)l.e[b&31]=c;else{var n=b>>>a&31,q=f(a-5,l.e[n]);l.e[n]=q}return l}}(this).call(null,d.shift,d.root),d.root=a),this;if(b===d.g)return zb(this,c);if(u)throw Error("Index "+A.b(b)+" out of bounds for TransientVector of length"+A.b(d.g));return null}throw Error("assoc! after persistent!");};
g.Qb=function(){if(this.root.t){if(0===this.g)throw Error("Can't pop empty vector");if(1===this.g)return this.g=0,this;if(0<(this.g-1&31))return this.g-=1,this;if(u){var a;a:if(a=this.g-2,a>=ee(this))a=this.R;else{for(var b=this.root,c=b,d=this.shift;;)if(0<d)c=Ce(b.t,c.e[a>>>d&31]),d-=5;else{a=c.e;break a}a=void 0}b=Ge(this,this.shift,this.root);b=null!=b?b:new be(this.root.t,[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,
null,null,null,null,null,null,null,null]);5<this.shift&&null==b.e[1]?(this.root=Ce(this.root.t,b.e[0]),this.shift-=5):this.root=b;this.g-=1;this.R=a;return this}return null}throw Error("pop! after persistent!");};g.cb=function(a,b,c){if("number"===typeof b)return Db(this,b,c);throw Error("TransientVector's key for assoc! must be a number.");};
g.Ka=function(a,b){if(this.root.t){if(32>this.g-ee(this))this.R[this.g&31]=b;else{var c=new be(this.root.t,this.R),d=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];d[0]=b;this.R=d;if(this.g>>>5>1<<this.shift){var d=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],e=this.shift+
5;d[0]=this.root;d[1]=fe(this.root.t,this.shift,c);this.root=new be(this.root.t,d);this.shift=e}else this.root=Ee(this,this.shift,this.root,c)}this.g+=1;return this}throw Error("conj! after persistent!");};g.Oa=function(){if(this.root.t){this.root.t=null;var a=this.g-ee(this),b=Array(a);Kc(this.R,0,b,0,a);return new W(null,this.g,this.shift,this.root,b,null)}throw Error("persistent! called twice");};function He(a,b,c,d){this.j=a;this.ba=b;this.pa=c;this.m=d;this.q=0;this.i=31850572}g=He.prototype;
g.toString=function(){return Lb(this)};g.D=function(){return this.j};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.j)};g.Q=function(){return F(this.ba)};g.S=function(){var a=I(this.ba);return a?new He(this.j,a,this.pa,null):null==this.pa?Ba(this):new He(this.j,this.pa,null,null)};g.H=function(){return this};g.F=function(a,b){return new He(b,this.ba,this.pa,this.m)};g.G=function(a,b){return M(b,this)};
function Ie(a,b,c,d,e){this.j=a;this.count=b;this.ba=c;this.pa=d;this.m=e;this.i=31858766;this.q=8192}g=Ie.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.j};g.L=function(){return this.count};g.Ia=function(){return F(this.ba)};g.Ja=function(){if(r(this.ba)){var a=I(this.ba);return a?new Ie(this.j,this.count-1,a,this.pa,null):new Ie(this.j,this.count-1,E(this.pa),qe,null)}return this};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};
g.v=function(a,b){return lc(this,b)};g.I=function(){return Je};g.Q=function(){return F(this.ba)};g.S=function(){return G(E(this))};g.H=function(){var a=E(this.pa),b=this.ba;return r(r(b)?b:a)?new He(null,this.ba,E(a),null):null};g.F=function(a,b){return new Ie(b,this.count,this.ba,this.pa,this.m)};g.G=function(a,b){var c;r(this.ba)?(c=this.pa,c=new Ie(this.j,this.count+1,this.ba,pc.a(r(c)?c:qe,b),null)):c=new Ie(this.j,this.count+1,pc.a(this.ba,b),qe,null);return c};var Je=new Ie(null,0,null,qe,0);
function Ke(){this.q=0;this.i=2097152}Ke.prototype.v=function(){return!1};var Le=new Ke;function Me(a,b){return Nc(Gc(b)?O(a)===O(b)?Dd(Fd,Kd.a(function(a){return Wb.a(Q.c(b,F(a),Le),F(I(a)))},a)):null:null)}function Ne(a){this.r=a}Ne.prototype.next=function(){if(null!=this.r){var a=F(this.r);this.r=I(this.r);return{done:!1,value:a}}return{done:!0,value:null}};function Oe(a){return new Ne(E(a))}function Pe(a){this.r=a}
Pe.prototype.next=function(){if(null!=this.r){var a=F(this.r),b=P.c(a,0,null),a=P.c(a,1,null);this.r=I(this.r);return{done:!1,value:[b,a]}}return{done:!0,value:null}};function Qe(a){return new Pe(E(a))}function Re(a){this.r=a}Re.prototype.next=function(){if(null!=this.r){var a=F(this.r);this.r=I(this.r);return{done:!1,value:[a,a]}}return{done:!0,value:null}};function Se(a){return new Re(E(a))}
function Te(a,b){var c=a.e;if(b instanceof T)a:{for(var d=c.length,e=b.sa,f=0;;){if(d<=f){c=-1;break a}var h=c[f];if(h instanceof T&&e===h.sa){c=f;break a}if(u)f+=2;else{c=null;break a}}c=void 0}else if("string"==typeof b||"number"===typeof b)a:{d=c.length;for(e=0;;){if(d<=e){c=-1;break a}if(b===c[e]){c=e;break a}if(u)e+=2;else{c=null;break a}}c=void 0}else if(b instanceof Zb)a:{d=c.length;e=b.Na;for(f=0;;){if(d<=f){c=-1;break a}h=c[f];if(h instanceof Zb&&e===h.Na){c=f;break a}if(u)f+=2;else{c=null;
break a}}c=void 0}else if(null==b)a:{d=c.length;for(e=0;;){if(d<=e){c=-1;break a}if(null==c[e]){c=e;break a}if(u)e+=2;else{c=null;break a}}c=void 0}else if(u)a:{d=c.length;for(e=0;;){if(d<=e){c=-1;break a}if(Wb.a(b,c[e])){c=e;break a}if(u)e+=2;else{c=null;break a}}c=void 0}else c=null;return c}function Ue(a,b,c){this.e=a;this.p=b;this.W=c;this.q=0;this.i=32374990}g=Ue.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.W};
g.U=function(){return this.p<this.e.length-2?new Ue(this.e,this.p+2,this.W):null};g.L=function(){return(this.e.length-this.p)/2};g.B=function(){return cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.W)};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return new W(null,2,5,X,[this.e[this.p],this.e[this.p+1]],null)};g.S=function(){return this.p<this.e.length-2?new Ue(this.e,this.p+2,this.W):H};g.H=function(){return this};
g.F=function(a,b){return new Ue(this.e,this.p,b)};g.G=function(a,b){return M(b,this)};function la(a,b,c,d){this.j=a;this.g=b;this.e=c;this.m=d;this.i=16647951;this.q=8196}g=la.prototype;g.toString=function(){return Lb(this)};g.keys=function(){return Oe(Ve.b?Ve.b(this):Ve.call(null,this))};g.entries=function(){return Qe(E(this))};g.values=function(){return Oe(We.b?We.b(this):We.call(null,this))};g.has=function(a){return Oc(this,a)};g.get=function(a){return this.u(null,a)};
g.forEach=function(a){for(var b=E(this),c=null,d=0,e=0;;)if(e<d){var f=c.J(null,e),h=P.c(f,0,null),f=P.c(f,1,null);a.a?a.a(f,h):a.call(null,f,h);e+=1}else if(b=E(b))Ic(b)?(c=Hb(b),b=Ib(b),h=c,d=O(c),c=h):(c=F(b),h=P.c(c,0,null),f=P.c(c,1,null),a.a?a.a(f,h):a.call(null,f,h),b=I(b),c=null,d=0),e=0;else return null};g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){a=Te(this,b);return-1===a?c:this.e[a+1]};
g.Za=function(a,b,c){a=this.e.length;for(var d=0;;)if(d<a){c=b.c?b.c(c,this.e[d],this.e[d+1]):b.call(null,c,this.e[d],this.e[d+1]);if(fc(c))return K.b?K.b(c):K.call(null,c);d+=2}else return c};g.D=function(){return this.j};g.L=function(){return this.g};g.B=function(){var a=this.m;return null!=a?a:this.m=a=dc(this)};g.v=function(a,b){return Me(this,b)};g.Wa=function(){return new Xe({},this.e.length,va(this.e))};g.I=function(){return eb(Ye,this.j)};g.N=function(a,b){return nc.a(b,this)};
g.M=function(a,b,c){return nc.c(b,c,this)};g.nb=function(a,b){if(0<=Te(this,b)){var c=this.e.length,d=c-2;if(0===d)return Ba(this);for(var d=Array(d),e=0,f=0;;){if(e>=c)return new la(this.j,this.g-1,d,null);if(Wb.a(b,this.e[e]))e+=2;else if(u)d[f]=this.e[e],d[f+1]=this.e[e+1],f+=2,e+=2;else return null}}else return this};
g.ua=function(a,b,c){a=Te(this,b);if(-1===a){if(this.g<Ze){a=this.e;for(var d=a.length,e=Array(d+2),f=0;;)if(f<d)e[f]=a[f],f+=1;else break;e[d]=b;e[d+1]=c;return new la(this.j,this.g+1,e,null)}return eb(Oa(Yd($e,this),b,c),this.j)}return c===this.e[a+1]?this:u?(b=va(this.e),b[a+1]=c,new la(this.j,this.g,b,null)):null};g.kb=function(a,b){return-1!==Te(this,b)};g.H=function(){var a=this.e;return 0<=a.length-2?new Ue(a,0,null):null};g.F=function(a,b){return new la(b,this.g,this.e,this.m)};
g.G=function(a,b){if(Hc(b))return Oa(this,D.a(b,0),D.a(b,1));for(var c=this,d=E(b);;){if(null==d)return c;var e=F(d);if(Hc(e))c=Oa(c,D.a(e,0),D.a(e,1)),d=I(d);else throw Error("conj on a map takes map entries or seqables of map entries");}};g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.u(null,c);case 3:return this.C(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};
g.b=function(a){return this.u(null,a)};g.a=function(a,b){return this.C(null,a,b)};var Ye=new la(null,0,[],null),Ze=8;function af(a){for(var b=a.length,c=0,d=yb(Ye);;)if(c<b)var e=c+2,d=Bb(d,a[c],a[c+1]),c=e;else return Ab(d)}function Xe(a,b,c){this.Ra=a;this.ja=b;this.e=c;this.q=56;this.i=258}g=Xe.prototype;
g.Ab=function(a,b){if(r(this.Ra)){var c=Te(this,b);0<=c&&(this.e[c]=this.e[this.ja-2],this.e[c+1]=this.e[this.ja-1],c=this.e,c.pop(),c.pop(),this.ja-=2);return this}throw Error("dissoc! after persistent!");};g.cb=function(a,b,c){if(r(this.Ra)){a=Te(this,b);if(-1===a)return this.ja+2<=2*Ze?(this.ja+=2,this.e.push(b),this.e.push(c),this):xd.c(bf.a?bf.a(this.ja,this.e):bf.call(null,this.ja,this.e),b,c);c!==this.e[a+1]&&(this.e[a+1]=c);return this}throw Error("assoc! after persistent!");};
g.Ka=function(a,b){if(r(this.Ra)){if(b?b.i&2048||b.dc||(b.i?0:s(Sa,b)):s(Sa,b))return Bb(this,cf.b?cf.b(b):cf.call(null,b),df.b?df.b(b):df.call(null,b));for(var c=E(b),d=this;;){var e=F(c);if(r(e))c=I(c),d=Bb(d,cf.b?cf.b(e):cf.call(null,e),df.b?df.b(e):df.call(null,e));else return d}}else throw Error("conj! after persistent!");};g.Oa=function(){if(r(this.Ra))return this.Ra=!1,new la(null,Yc(this.ja),this.e,null);throw Error("persistent! called twice");};g.u=function(a,b){return La.c(this,b,null)};
g.C=function(a,b,c){if(r(this.Ra))return a=Te(this,b),-1===a?c:this.e[a+1];throw Error("lookup after persistent!");};g.L=function(){if(r(this.Ra))return Yc(this.ja);throw Error("count after persistent!");};function bf(a,b){for(var c=yb($e),d=0;;)if(d<a)c=xd.c(c,b[d],b[d+1]),d+=2;else return c}function ef(){this.l=!1}function ff(a,b){return a===b?!0:hd(a,b)?!0:u?Wb.a(a,b):null}
var gf=function(){function a(a,b,c,h,k){a=va(a);a[b]=c;a[h]=k;return a}function b(a,b,c){a=va(a);a[b]=c;return a}var c=null,c=function(c,e,f,h,k){switch(arguments.length){case 3:return b.call(this,c,e,f);case 5:return a.call(this,c,e,f,h,k)}throw Error("Invalid arity: "+arguments.length);};c.c=b;c.s=a;return c}();function hf(a,b){var c=Array(a.length-2);Kc(a,0,c,0,2*b);Kc(a,2*(b+1),c,2*b,c.length-2*b);return c}
var jf=function(){function a(a,b,c,h,k,l){a=a.La(b);a.e[c]=h;a.e[k]=l;return a}function b(a,b,c,h){a=a.La(b);a.e[c]=h;return a}var c=null,c=function(c,e,f,h,k,l){switch(arguments.length){case 4:return b.call(this,c,e,f,h);case 6:return a.call(this,c,e,f,h,k,l)}throw Error("Invalid arity: "+arguments.length);};c.n=b;c.X=a;return c}();
function kf(a,b,c){for(var d=a.length,e=0;;)if(e<d){var f=a[e];null!=f?c=b.c?b.c(c,f,a[e+1]):b.call(null,c,f,a[e+1]):(f=a[e+1],c=null!=f?f.Ta(b,c):c);if(fc(c))return K.b?K.b(c):K.call(null,c);e+=2}else return c}function lf(a,b,c){this.t=a;this.A=b;this.e=c}g=lf.prototype;g.La=function(a){if(a===this.t)return this;var b=Zc(this.A),c=Array(0>b?4:2*(b+1));Kc(this.e,0,c,0,2*b);return new lf(a,this.A,c)};
g.gb=function(a,b,c,d,e){var f=1<<(c>>>b&31);if(0===(this.A&f))return this;var h=Zc(this.A&f-1),k=this.e[2*h],l=this.e[2*h+1];return null==k?(b=l.gb(a,b+5,c,d,e),b===l?this:null!=b?jf.n(this,a,2*h+1,b):this.A===f?null:u?mf(this,a,f,h):null):ff(d,k)?(e[0]=!0,mf(this,a,f,h)):u?this:null};function mf(a,b,c,d){if(a.A===c)return null;a=a.La(b);b=a.e;var e=b.length;a.A^=c;Kc(b,2*(d+1),b,2*d,e-2*(d+1));b[e-2]=null;b[e-1]=null;return a}g.eb=function(){return nf.b?nf.b(this.e):nf.call(null,this.e)};
g.Ta=function(a,b){return kf(this.e,a,b)};g.Ma=function(a,b,c,d){var e=1<<(b>>>a&31);if(0===(this.A&e))return d;var f=Zc(this.A&e-1),e=this.e[2*f],f=this.e[2*f+1];return null==e?f.Ma(a+5,b,c,d):ff(c,e)?f:u?d:null};
g.ia=function(a,b,c,d,e,f){var h=1<<(c>>>b&31),k=Zc(this.A&h-1);if(0===(this.A&h)){var l=Zc(this.A);if(2*l<this.e.length){a=this.La(a);b=a.e;f.l=!0;a:for(c=2*(l-k),f=2*k+(c-1),l=2*(k+1)+(c-1);;){if(0===c)break a;b[l]=b[f];l-=1;c-=1;f-=1}b[2*k]=d;b[2*k+1]=e;a.A|=h;return a}if(16<=l){k=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];k[c>>>b&31]=of.ia(a,b+5,c,d,e,f);for(e=d=0;;)if(32>d)0!==
(this.A>>>d&1)&&(k[d]=null!=this.e[e]?of.ia(a,b+5,Tb(this.e[e]),this.e[e],this.e[e+1],f):this.e[e+1],e+=2),d+=1;else break;return new pf(a,l+1,k)}return u?(b=Array(2*(l+4)),Kc(this.e,0,b,0,2*k),b[2*k]=d,b[2*k+1]=e,Kc(this.e,2*k,b,2*(k+1),2*(l-k)),f.l=!0,a=this.La(a),a.e=b,a.A|=h,a):null}l=this.e[2*k];h=this.e[2*k+1];return null==l?(l=h.ia(a,b+5,c,d,e,f),l===h?this:jf.n(this,a,2*k+1,l)):ff(d,l)?e===h?this:jf.n(this,a,2*k+1,e):u?(f.l=!0,jf.X(this,a,2*k,null,2*k+1,qf.ga?qf.ga(a,b+5,l,h,c,d,e):qf.call(null,
a,b+5,l,h,c,d,e))):null};
g.ha=function(a,b,c,d,e){var f=1<<(b>>>a&31),h=Zc(this.A&f-1);if(0===(this.A&f)){var k=Zc(this.A);if(16<=k){h=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];h[b>>>a&31]=of.ha(a+5,b,c,d,e);for(d=c=0;;)if(32>c)0!==(this.A>>>c&1)&&(h[c]=null!=this.e[d]?of.ha(a+5,Tb(this.e[d]),this.e[d],this.e[d+1],e):this.e[d+1],d+=2),c+=1;else break;return new pf(null,k+1,h)}a=Array(2*(k+1));Kc(this.e,
0,a,0,2*h);a[2*h]=c;a[2*h+1]=d;Kc(this.e,2*h,a,2*(h+1),2*(k-h));e.l=!0;return new lf(null,this.A|f,a)}k=this.e[2*h];f=this.e[2*h+1];return null==k?(k=f.ha(a+5,b,c,d,e),k===f?this:new lf(null,this.A,gf.c(this.e,2*h+1,k))):ff(c,k)?d===f?this:new lf(null,this.A,gf.c(this.e,2*h+1,d)):u?(e.l=!0,new lf(null,this.A,gf.s(this.e,2*h,null,2*h+1,qf.X?qf.X(a+5,k,f,b,c,d):qf.call(null,a+5,k,f,b,c,d)))):null};
g.fb=function(a,b,c){var d=1<<(b>>>a&31);if(0===(this.A&d))return this;var e=Zc(this.A&d-1),f=this.e[2*e],h=this.e[2*e+1];return null==f?(a=h.fb(a+5,b,c),a===h?this:null!=a?new lf(null,this.A,gf.c(this.e,2*e+1,a)):this.A===d?null:u?new lf(null,this.A^d,hf(this.e,e)):null):ff(c,f)?new lf(null,this.A^d,hf(this.e,e)):u?this:null};var of=new lf(null,0,[]);
function rf(a,b,c){var d=a.e;a=2*(a.g-1);for(var e=Array(a),f=0,h=1,k=0;;)if(f<a)f!==c&&null!=d[f]&&(e[h]=d[f],h+=2,k|=1<<f),f+=1;else return new lf(b,k,e)}function pf(a,b,c){this.t=a;this.g=b;this.e=c}g=pf.prototype;g.La=function(a){return a===this.t?this:new pf(a,this.g,va(this.e))};
g.gb=function(a,b,c,d,e){var f=c>>>b&31,h=this.e[f];if(null==h)return this;b=h.gb(a,b+5,c,d,e);if(b===h)return this;if(null==b){if(8>=this.g)return rf(this,a,f);a=jf.n(this,a,f,b);a.g-=1;return a}return u?jf.n(this,a,f,b):null};g.eb=function(){return sf.b?sf.b(this.e):sf.call(null,this.e)};g.Ta=function(a,b){for(var c=this.e.length,d=0,e=b;;)if(d<c){var f=this.e[d];if(null!=f&&(e=f.Ta(a,e),fc(e)))return K.b?K.b(e):K.call(null,e);d+=1}else return e};
g.Ma=function(a,b,c,d){var e=this.e[b>>>a&31];return null!=e?e.Ma(a+5,b,c,d):d};g.ia=function(a,b,c,d,e,f){var h=c>>>b&31,k=this.e[h];if(null==k)return a=jf.n(this,a,h,of.ia(a,b+5,c,d,e,f)),a.g+=1,a;b=k.ia(a,b+5,c,d,e,f);return b===k?this:jf.n(this,a,h,b)};g.ha=function(a,b,c,d,e){var f=b>>>a&31,h=this.e[f];if(null==h)return new pf(null,this.g+1,gf.c(this.e,f,of.ha(a+5,b,c,d,e)));a=h.ha(a+5,b,c,d,e);return a===h?this:new pf(null,this.g,gf.c(this.e,f,a))};
g.fb=function(a,b,c){var d=b>>>a&31,e=this.e[d];return null!=e?(a=e.fb(a+5,b,c),a===e?this:null==a?8>=this.g?rf(this,null,d):new pf(null,this.g-1,gf.c(this.e,d,a)):u?new pf(null,this.g,gf.c(this.e,d,a)):null):this};function tf(a,b,c){b*=2;for(var d=0;;)if(d<b){if(ff(c,a[d]))return d;d+=2}else return-1}function uf(a,b,c,d){this.t=a;this.ra=b;this.g=c;this.e=d}g=uf.prototype;
g.La=function(a){if(a===this.t)return this;var b=Array(2*(this.g+1));Kc(this.e,0,b,0,2*this.g);return new uf(a,this.ra,this.g,b)};g.gb=function(a,b,c,d,e){b=tf(this.e,this.g,d);if(-1===b)return this;e[0]=!0;if(1===this.g)return null;a=this.La(a);e=a.e;e[b]=e[2*this.g-2];e[b+1]=e[2*this.g-1];e[2*this.g-1]=null;e[2*this.g-2]=null;a.g-=1;return a};g.eb=function(){return nf.b?nf.b(this.e):nf.call(null,this.e)};g.Ta=function(a,b){return kf(this.e,a,b)};
g.Ma=function(a,b,c,d){a=tf(this.e,this.g,c);return 0>a?d:ff(c,this.e[a])?this.e[a+1]:u?d:null};
g.ia=function(a,b,c,d,e,f){if(c===this.ra){b=tf(this.e,this.g,d);if(-1===b){if(this.e.length>2*this.g)return a=jf.X(this,a,2*this.g,d,2*this.g+1,e),f.l=!0,a.g+=1,a;c=this.e.length;b=Array(c+2);Kc(this.e,0,b,0,c);b[c]=d;b[c+1]=e;f.l=!0;f=this.g+1;a===this.t?(this.e=b,this.g=f,a=this):a=new uf(this.t,this.ra,f,b);return a}return this.e[b+1]===e?this:jf.n(this,a,b+1,e)}return(new lf(a,1<<(this.ra>>>b&31),[null,this,null,null])).ia(a,b,c,d,e,f)};
g.ha=function(a,b,c,d,e){return b===this.ra?(a=tf(this.e,this.g,c),-1===a?(a=2*this.g,b=Array(a+2),Kc(this.e,0,b,0,a),b[a]=c,b[a+1]=d,e.l=!0,new uf(null,this.ra,this.g+1,b)):Wb.a(this.e[a],d)?this:new uf(null,this.ra,this.g,gf.c(this.e,a+1,d))):(new lf(null,1<<(this.ra>>>a&31),[null,this])).ha(a,b,c,d,e)};g.fb=function(a,b,c){a=tf(this.e,this.g,c);return-1===a?this:1===this.g?null:u?new uf(null,this.ra,this.g-1,hf(this.e,Yc(a))):null};
var qf=function(){function a(a,b,c,h,k,l,n){var q=Tb(c);if(q===k)return new uf(null,q,2,[c,h,l,n]);var t=new ef;return of.ia(a,b,q,c,h,t).ia(a,b,k,l,n,t)}function b(a,b,c,h,k,l){var n=Tb(b);if(n===h)return new uf(null,n,2,[b,c,k,l]);var q=new ef;return of.ha(a,n,b,c,q).ha(a,h,k,l,q)}var c=null,c=function(c,e,f,h,k,l,n){switch(arguments.length){case 6:return b.call(this,c,e,f,h,k,l);case 7:return a.call(this,c,e,f,h,k,l,n)}throw Error("Invalid arity: "+arguments.length);};c.X=b;c.ga=a;return c}();
function vf(a,b,c,d,e){this.j=a;this.ka=b;this.p=c;this.r=d;this.m=e;this.q=0;this.i=32374860}g=vf.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.j};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.j)};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return null==this.r?new W(null,2,5,X,[this.ka[this.p],this.ka[this.p+1]],null):F(this.r)};
g.S=function(){return null==this.r?nf.c?nf.c(this.ka,this.p+2,null):nf.call(null,this.ka,this.p+2,null):nf.c?nf.c(this.ka,this.p,I(this.r)):nf.call(null,this.ka,this.p,I(this.r))};g.H=function(){return this};g.F=function(a,b){return new vf(b,this.ka,this.p,this.r,this.m)};g.G=function(a,b){return M(b,this)};
var nf=function(){function a(a,b,c){if(null==c)for(c=a.length;;)if(b<c){if(null!=a[b])return new vf(null,a,b,null,null);var h=a[b+1];if(r(h)&&(h=h.eb(),r(h)))return new vf(null,a,b+2,h,null);b+=2}else return null;else return new vf(null,a,b,c,null)}function b(a){return c.c(a,0,null)}var c=null,c=function(c,e,f){switch(arguments.length){case 1:return b.call(this,c);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.c=a;return c}();
function wf(a,b,c,d,e){this.j=a;this.ka=b;this.p=c;this.r=d;this.m=e;this.q=0;this.i=32374860}g=wf.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.j};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.j)};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return F(this.r)};
g.S=function(){return sf.n?sf.n(null,this.ka,this.p,I(this.r)):sf.call(null,null,this.ka,this.p,I(this.r))};g.H=function(){return this};g.F=function(a,b){return new wf(b,this.ka,this.p,this.r,this.m)};g.G=function(a,b){return M(b,this)};
var sf=function(){function a(a,b,c,h){if(null==h)for(h=b.length;;)if(c<h){var k=b[c];if(r(k)&&(k=k.eb(),r(k)))return new wf(a,b,c+1,k,null);c+=1}else return null;else return new wf(a,b,c,h,null)}function b(a){return c.n(null,a,0,null)}var c=null,c=function(c,e,f,h){switch(arguments.length){case 1:return b.call(this,c);case 4:return a.call(this,c,e,f,h)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.n=a;return c}();
function xf(a,b,c,d,e,f){this.j=a;this.g=b;this.root=c;this.T=d;this.Y=e;this.m=f;this.i=16123663;this.q=8196}g=xf.prototype;g.toString=function(){return Lb(this)};g.keys=function(){return Oe(Ve.b?Ve.b(this):Ve.call(null,this))};g.entries=function(){return Qe(E(this))};g.values=function(){return Oe(We.b?We.b(this):We.call(null,this))};g.has=function(a){return Oc(this,a)};g.get=function(a){return this.u(null,a)};
g.forEach=function(a){for(var b=E(this),c=null,d=0,e=0;;)if(e<d){var f=c.J(null,e),h=P.c(f,0,null),f=P.c(f,1,null);a.a?a.a(f,h):a.call(null,f,h);e+=1}else if(b=E(b))Ic(b)?(c=Hb(b),b=Ib(b),h=c,d=O(c),c=h):(c=F(b),h=P.c(c,0,null),f=P.c(c,1,null),a.a?a.a(f,h):a.call(null,f,h),b=I(b),c=null,d=0),e=0;else return null};g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){return null==b?this.T?this.Y:c:null==this.root?c:u?this.root.Ma(0,Tb(b),b,c):null};
g.Za=function(a,b,c){a=this.T?b.c?b.c(c,null,this.Y):b.call(null,c,null,this.Y):c;return fc(a)?K.b?K.b(a):K.call(null,a):null!=this.root?this.root.Ta(b,a):u?a:null};g.D=function(){return this.j};g.L=function(){return this.g};g.B=function(){var a=this.m;return null!=a?a:this.m=a=dc(this)};g.v=function(a,b){return Me(this,b)};g.Wa=function(){return new yf({},this.root,this.g,this.T,this.Y)};g.I=function(){return eb($e,this.j)};
g.nb=function(a,b){if(null==b)return this.T?new xf(this.j,this.g-1,this.root,!1,null,null):this;if(null==this.root)return this;if(u){var c=this.root.fb(0,Tb(b),b);return c===this.root?this:new xf(this.j,this.g-1,c,this.T,this.Y,null)}return null};
g.ua=function(a,b,c){if(null==b)return this.T&&c===this.Y?this:new xf(this.j,this.T?this.g:this.g+1,this.root,!0,c,null);a=new ef;b=(null==this.root?of:this.root).ha(0,Tb(b),b,c,a);return b===this.root?this:new xf(this.j,a.l?this.g+1:this.g,b,this.T,this.Y,null)};g.kb=function(a,b){return null==b?this.T:null==this.root?!1:u?this.root.Ma(0,Tb(b),b,Lc)!==Lc:null};g.H=function(){if(0<this.g){var a=null!=this.root?this.root.eb():null;return this.T?M(new W(null,2,5,X,[null,this.Y],null),a):a}return null};
g.F=function(a,b){return new xf(b,this.g,this.root,this.T,this.Y,this.m)};g.G=function(a,b){if(Hc(b))return Oa(this,D.a(b,0),D.a(b,1));for(var c=this,d=E(b);;){if(null==d)return c;var e=F(d);if(Hc(e))c=Oa(c,D.a(e,0),D.a(e,1)),d=I(d);else throw Error("conj on a map takes map entries or seqables of map entries");}};
g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.u(null,c);case 3:return this.C(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return this.u(null,a)};g.a=function(a,b){return this.C(null,a,b)};var $e=new xf(null,0,null,!1,null,0);function sc(a,b){for(var c=a.length,d=0,e=yb($e);;)if(d<c)var f=d+1,e=e.cb(null,a[d],b[d]),d=f;else return Ab(e)}
function yf(a,b,c,d,e){this.t=a;this.root=b;this.count=c;this.T=d;this.Y=e;this.q=56;this.i=258}g=yf.prototype;g.Ab=function(a,b){if(this.t)if(null==b)this.T&&(this.T=!1,this.Y=null,this.count-=1);else{if(null!=this.root){var c=new ef,d=this.root.gb(this.t,0,Tb(b),b,c);d!==this.root&&(this.root=d);r(c[0])&&(this.count-=1)}}else throw Error("dissoc! after persistent!");return this};g.cb=function(a,b,c){return zf(this,b,c)};
g.Ka=function(a,b){var c;a:{if(this.t){if(b?b.i&2048||b.dc||(b.i?0:s(Sa,b)):s(Sa,b)){c=zf(this,cf.b?cf.b(b):cf.call(null,b),df.b?df.b(b):df.call(null,b));break a}c=E(b);for(var d=this;;){var e=F(c);if(r(e))c=I(c),d=zf(d,cf.b?cf.b(e):cf.call(null,e),df.b?df.b(e):df.call(null,e));else{c=d;break a}}}else throw Error("conj! after persistent");c=void 0}return c};
g.Oa=function(){var a;if(this.t)this.t=null,a=new xf(null,this.count,this.root,this.T,this.Y,null);else throw Error("persistent! called twice");return a};g.u=function(a,b){return null==b?this.T?this.Y:null:null==this.root?null:this.root.Ma(0,Tb(b),b)};g.C=function(a,b,c){return null==b?this.T?this.Y:c:null==this.root?c:this.root.Ma(0,Tb(b),b,c)};g.L=function(){if(this.t)return this.count;throw Error("count after persistent!");};
function zf(a,b,c){if(a.t){if(null==b)a.Y!==c&&(a.Y=c),a.T||(a.count+=1,a.T=!0);else{var d=new ef;b=(null==a.root?of:a.root).ia(a.t,0,Tb(b),b,c,d);b!==a.root&&(a.root=b);d.l&&(a.count+=1)}return a}throw Error("assoc! after persistent!");}function Af(a,b,c){for(var d=b;;)if(null!=a)b=c?a.left:a.right,d=pc.a(d,a),a=b;else return d}function Bf(a,b,c,d,e){this.j=a;this.stack=b;this.ib=c;this.g=d;this.m=e;this.q=0;this.i=32374862}g=Bf.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.j};
g.L=function(){return 0>this.g?O(I(this))+1:this.g};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.j)};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return yc(this.stack)};g.S=function(){var a=F(this.stack),a=Af(this.ib?a.right:a.left,I(this.stack),this.ib);return null!=a?new Bf(null,a,this.ib,this.g-1,null):H};g.H=function(){return this};
g.F=function(a,b){return new Bf(b,this.stack,this.ib,this.g,this.m)};g.G=function(a,b){return M(b,this)};function Cf(a,b,c){return new Bf(null,Af(a,null,b),b,c,null)}function Df(a,b,c,d){return c instanceof Y?c.left instanceof Y?new Y(c.key,c.l,c.left.qa(),new $(a,b,c.right,d,null),null):c.right instanceof Y?new Y(c.right.key,c.right.l,new $(c.key,c.l,c.left,c.right.left,null),new $(a,b,c.right.right,d,null),null):u?new $(a,b,c,d,null):null:new $(a,b,c,d,null)}
function Ef(a,b,c,d){return d instanceof Y?d.right instanceof Y?new Y(d.key,d.l,new $(a,b,c,d.left,null),d.right.qa(),null):d.left instanceof Y?new Y(d.left.key,d.left.l,new $(a,b,c,d.left.left,null),new $(d.key,d.l,d.left.right,d.right,null),null):u?new $(a,b,c,d,null):null:new $(a,b,c,d,null)}
function Ff(a,b,c,d){if(c instanceof Y)return new Y(a,b,c.qa(),d,null);if(d instanceof $)return Ef(a,b,c,d.hb());if(d instanceof Y&&d.left instanceof $)return new Y(d.left.key,d.left.l,new $(a,b,c,d.left.left,null),Ef(d.key,d.l,d.left.right,d.right.hb()),null);if(u)throw Error("red-black tree invariant violation");return null}
var Hf=function Gf(b,c,d){d=null!=b.left?Gf(b.left,c,d):d;if(fc(d))return K.b?K.b(d):K.call(null,d);d=c.c?c.c(d,b.key,b.l):c.call(null,d,b.key,b.l);if(fc(d))return K.b?K.b(d):K.call(null,d);b=null!=b.right?Gf(b.right,c,d):d;return fc(b)?K.b?K.b(b):K.call(null,b):b};function $(a,b,c,d,e){this.key=a;this.l=b;this.left=c;this.right=d;this.m=e;this.q=0;this.i=32402207}g=$.prototype;g.Hb=function(a){return a.Jb(this)};g.hb=function(){return new Y(this.key,this.l,this.left,this.right,null)};g.qa=function(){return this};
g.Gb=function(a){return a.Ib(this)};g.replace=function(a,b,c,d){return new $(a,b,c,d,null)};g.Ib=function(a){return new $(a.key,a.l,this,a.right,null)};g.Jb=function(a){return new $(a.key,a.l,a.left,this,null)};g.Ta=function(a,b){return Hf(this,a,b)};g.u=function(a,b){return D.c(this,b,null)};g.C=function(a,b,c){return D.c(this,b,c)};g.J=function(a,b){return 0===b?this.key:1===b?this.l:null};g.aa=function(a,b,c){return 0===b?this.key:1===b?this.l:u?c:null};
g.Pa=function(a,b,c){return(new W(null,2,5,X,[this.key,this.l],null)).Pa(null,b,c)};g.D=function(){return null};g.L=function(){return 2};g.$a=function(){return this.key};g.ab=function(){return this.l};g.Ia=function(){return this.l};g.Ja=function(){return new W(null,1,5,X,[this.key],null)};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return qe};g.N=function(a,b){return gc.a(this,b)};g.M=function(a,b,c){return gc.c(this,b,c)};
g.ua=function(a,b,c){return R.c(new W(null,2,5,X,[this.key,this.l],null),b,c)};g.H=function(){return Da(Da(H,this.l),this.key)};g.F=function(a,b){return N(new W(null,2,5,X,[this.key,this.l],null),b)};g.G=function(a,b){return new W(null,3,5,X,[this.key,this.l,b],null)};g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.u(null,c);case 3:return this.C(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();
g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return this.u(null,a)};g.a=function(a,b){return this.C(null,a,b)};function Y(a,b,c,d,e){this.key=a;this.l=b;this.left=c;this.right=d;this.m=e;this.q=0;this.i=32402207}g=Y.prototype;g.Hb=function(a){return new Y(this.key,this.l,this.left,a,null)};g.hb=function(){throw Error("red-black tree invariant violation");};g.qa=function(){return new $(this.key,this.l,this.left,this.right,null)};
g.Gb=function(a){return new Y(this.key,this.l,a,this.right,null)};g.replace=function(a,b,c,d){return new Y(a,b,c,d,null)};g.Ib=function(a){return this.left instanceof Y?new Y(this.key,this.l,this.left.qa(),new $(a.key,a.l,this.right,a.right,null),null):this.right instanceof Y?new Y(this.right.key,this.right.l,new $(this.key,this.l,this.left,this.right.left,null),new $(a.key,a.l,this.right.right,a.right,null),null):u?new $(a.key,a.l,this,a.right,null):null};
g.Jb=function(a){return this.right instanceof Y?new Y(this.key,this.l,new $(a.key,a.l,a.left,this.left,null),this.right.qa(),null):this.left instanceof Y?new Y(this.left.key,this.left.l,new $(a.key,a.l,a.left,this.left.left,null),new $(this.key,this.l,this.left.right,this.right,null),null):u?new $(a.key,a.l,a.left,this,null):null};g.Ta=function(a,b){return Hf(this,a,b)};g.u=function(a,b){return D.c(this,b,null)};g.C=function(a,b,c){return D.c(this,b,c)};
g.J=function(a,b){return 0===b?this.key:1===b?this.l:null};g.aa=function(a,b,c){return 0===b?this.key:1===b?this.l:u?c:null};g.Pa=function(a,b,c){return(new W(null,2,5,X,[this.key,this.l],null)).Pa(null,b,c)};g.D=function(){return null};g.L=function(){return 2};g.$a=function(){return this.key};g.ab=function(){return this.l};g.Ia=function(){return this.l};g.Ja=function(){return new W(null,1,5,X,[this.key],null)};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};
g.v=function(a,b){return lc(this,b)};g.I=function(){return qe};g.N=function(a,b){return gc.a(this,b)};g.M=function(a,b,c){return gc.c(this,b,c)};g.ua=function(a,b,c){return R.c(new W(null,2,5,X,[this.key,this.l],null),b,c)};g.H=function(){return Da(Da(H,this.l),this.key)};g.F=function(a,b){return N(new W(null,2,5,X,[this.key,this.l],null),b)};g.G=function(a,b){return new W(null,3,5,X,[this.key,this.l,b],null)};
g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.u(null,c);case 3:return this.C(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return this.u(null,a)};g.a=function(a,b){return this.C(null,a,b)};
var Jf=function If(b,c,d,e,f){if(null==c)return new Y(d,e,null,null,null);var h=b.a?b.a(d,c.key):b.call(null,d,c.key);return 0===h?(f[0]=c,null):0>h?(b=If(b,c.left,d,e,f),null!=b?c.Gb(b):null):u?(b=If(b,c.right,d,e,f),null!=b?c.Hb(b):null):null},Lf=function Kf(b,c){if(null==b)return c;if(null==c)return b;if(b instanceof Y){if(c instanceof Y){var d=Kf(b.right,c.left);return d instanceof Y?new Y(d.key,d.l,new Y(b.key,b.l,b.left,d.left,null),new Y(c.key,c.l,d.right,c.right,null),null):new Y(b.key,b.l,
b.left,new Y(c.key,c.l,d,c.right,null),null)}return new Y(b.key,b.l,b.left,Kf(b.right,c),null)}return c instanceof Y?new Y(c.key,c.l,Kf(b,c.left),c.right,null):u?(d=Kf(b.right,c.left),d instanceof Y?new Y(d.key,d.l,new $(b.key,b.l,b.left,d.left,null),new $(c.key,c.l,d.right,c.right,null),null):Ff(b.key,b.l,b.left,new $(c.key,c.l,d,c.right,null))):null},Nf=function Mf(b,c,d,e){if(null!=c){var f=b.a?b.a(d,c.key):b.call(null,d,c.key);if(0===f)return e[0]=c,Lf(c.left,c.right);if(0>f)return b=Mf(b,c.left,
d,e),null!=b||null!=e[0]?c.left instanceof $?Ff(c.key,c.l,b,c.right):new Y(c.key,c.l,b,c.right,null):null;if(u){b=Mf(b,c.right,d,e);if(null!=b||null!=e[0])if(c.right instanceof $)if(e=c.key,d=c.l,c=c.left,b instanceof Y)c=new Y(e,d,c,b.qa(),null);else if(c instanceof $)c=Df(e,d,c.hb(),b);else if(c instanceof Y&&c.right instanceof $)c=new Y(c.right.key,c.right.l,Df(c.key,c.l,c.left.hb(),c.right.left),new $(e,d,c.right.right,b,null),null);else{if(u)throw Error("red-black tree invariant violation");
c=null}else c=new Y(c.key,c.l,c.left,b,null);else c=null;return c}}return null},Pf=function Of(b,c,d,e){var f=c.key,h=b.a?b.a(d,f):b.call(null,d,f);return 0===h?c.replace(f,e,c.left,c.right):0>h?c.replace(f,c.l,Of(b,c.left,d,e),c.right):u?c.replace(f,c.l,c.left,Of(b,c.right,d,e)):null};function Qf(a,b,c,d,e){this.Z=a;this.ma=b;this.g=c;this.j=d;this.m=e;this.i=418776847;this.q=8192}g=Qf.prototype;g.toString=function(){return Lb(this)};g.keys=function(){return Oe(Ve.b?Ve.b(this):Ve.call(null,this))};
g.entries=function(){return Qe(E(this))};g.values=function(){return Oe(We.b?We.b(this):We.call(null,this))};g.has=function(a){return Oc(this,a)};g.get=function(a){return this.u(null,a)};g.forEach=function(a){for(var b=E(this),c=null,d=0,e=0;;)if(e<d){var f=c.J(null,e),h=P.c(f,0,null),f=P.c(f,1,null);a.a?a.a(f,h):a.call(null,f,h);e+=1}else if(b=E(b))Ic(b)?(c=Hb(b),b=Ib(b),h=c,d=O(c),c=h):(c=F(b),h=P.c(c,0,null),f=P.c(c,1,null),a.a?a.a(f,h):a.call(null,f,h),b=I(b),c=null,d=0),e=0;else return null};
function Rf(a,b){for(var c=a.ma;;)if(null!=c){var d=a.Z.a?a.Z.a(b,c.key):a.Z.call(null,b,c.key);if(0===d)return c;if(0>d)c=c.left;else if(u)c=c.right;else return null}else return null}g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){a=Rf(this,b);return null!=a?a.l:c};g.Za=function(a,b,c){return null!=this.ma?Hf(this.ma,b,c):c};g.D=function(){return this.j};g.L=function(){return this.g};g.Xa=function(){return 0<this.g?Cf(this.ma,!1,this.g):null};
g.B=function(){var a=this.m;return null!=a?a:this.m=a=dc(this)};g.v=function(a,b){return Me(this,b)};g.I=function(){return N(Sf,this.j)};g.nb=function(a,b){var c=[null],d=Nf(this.Z,this.ma,b,c);return null==d?null==P.a(c,0)?this:new Qf(this.Z,null,0,this.j,null):new Qf(this.Z,d.qa(),this.g-1,this.j,null)};
g.ua=function(a,b,c){a=[null];var d=Jf(this.Z,this.ma,b,c,a);return null==d?(a=P.a(a,0),Wb.a(c,a.l)?this:new Qf(this.Z,Pf(this.Z,this.ma,b,c),this.g,this.j,null)):new Qf(this.Z,d.qa(),this.g+1,this.j,null)};g.kb=function(a,b){return null!=Rf(this,b)};g.H=function(){return 0<this.g?Cf(this.ma,!0,this.g):null};g.F=function(a,b){return new Qf(this.Z,this.ma,this.g,b,this.m)};
g.G=function(a,b){if(Hc(b))return Oa(this,D.a(b,0),D.a(b,1));for(var c=this,d=E(b);;){if(null==d)return c;var e=F(d);if(Hc(e))c=Oa(c,D.a(e,0),D.a(e,1)),d=I(d);else throw Error("conj on a map takes map entries or seqables of map entries");}};g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.u(null,c);case 3:return this.C(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};
g.b=function(a){return this.u(null,a)};g.a=function(a,b){return this.C(null,a,b)};g.yb=function(a,b){return 0<this.g?Cf(this.ma,b,this.g):null};g.zb=function(a,b,c){if(0<this.g){a=null;for(var d=this.ma;;)if(null!=d){var e=this.Z.a?this.Z.a(b,d.key):this.Z.call(null,b,d.key);if(0===e)return new Bf(null,pc.a(a,d),c,-1,null);if(r(c))0>e?(a=pc.a(a,d),d=d.left):d=d.right;else if(u)0<e?(a=pc.a(a,d),d=d.right):d=d.left;else return null}else return null==a?null:new Bf(null,a,c,-1,null)}else return null};
g.xb=function(a,b){return cf.b?cf.b(b):cf.call(null,b)};g.wb=function(){return this.Z};
var Sf=new Qf(Xb,null,0,null,0),Tf=function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){a=E(a);for(var b=yb($e);;)if(a){var e=I(I(a)),b=xd.c(b,F(a),F(I(a)));a=e}else return Ab(b)}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}(),Uf=function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){return new la(null,Yc(O(a)),S.a(wa,
a),null)}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}(),Vf=function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){a=E(a);for(var b=Sf;;)if(a){var e=I(I(a)),b=R.c(b,F(a),F(I(a)));a=e}else return b}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}(),Wf=function(){function a(a,d){var e=null;1<arguments.length&&(e=J(Array.prototype.slice.call(arguments,1),0));return b.call(this,a,e)}function b(a,
b){for(var e=E(b),f=new Qf(Qc(a),null,0,null,0);;)if(e)var h=I(I(e)),f=R.c(f,F(e),F(I(e))),e=h;else return f}a.k=1;a.f=function(a){var d=F(a);a=G(a);return b(d,a)};a.d=b;return a}();function Xf(a,b){this.V=a;this.W=b;this.q=0;this.i=32374988}g=Xf.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.W};g.U=function(){var a=this.V,a=(a?a.i&128||a.ob||(a.i?0:s(Ja,a)):s(Ja,a))?this.V.U(null):I(this.V);return null==a?null:new Xf(a,this.W)};g.B=function(){return cc(this)};
g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.W)};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return this.V.Q(null).$a(null)};g.S=function(){var a=this.V,a=(a?a.i&128||a.ob||(a.i?0:s(Ja,a)):s(Ja,a))?this.V.U(null):I(this.V);return null!=a?new Xf(a,this.W):H};g.H=function(){return this};g.F=function(a,b){return new Xf(this.V,b)};g.G=function(a,b){return M(b,this)};function Ve(a){return(a=E(a))?new Xf(a,null):null}
function cf(a){return Ta(a)}function Yf(a,b){this.V=a;this.W=b;this.q=0;this.i=32374988}g=Yf.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.W};g.U=function(){var a=this.V,a=(a?a.i&128||a.ob||(a.i?0:s(Ja,a)):s(Ja,a))?this.V.U(null):I(this.V);return null==a?null:new Yf(a,this.W)};g.B=function(){return cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.W)};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return this.V.Q(null).ab(null)};
g.S=function(){var a=this.V,a=(a?a.i&128||a.ob||(a.i?0:s(Ja,a)):s(Ja,a))?this.V.U(null):I(this.V);return null!=a?new Yf(a,this.W):H};g.H=function(){return this};g.F=function(a,b){return new Yf(this.V,b)};g.G=function(a,b){return M(b,this)};function We(a){return(a=E(a))?new Yf(a,null):null}function df(a){return Ua(a)}
var Zf=function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){return r(Ed(Fd,a))?C.a(function(a,b){return pc.a(r(a)?a:Ye,b)},a):null}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}();function $f(a,b,c){this.j=a;this.Sa=b;this.m=c;this.i=15077647;this.q=8196}g=$f.prototype;g.toString=function(){return Lb(this)};g.keys=function(){return Oe(E(this))};g.entries=function(){return Se(E(this))};g.values=function(){return Oe(E(this))};
g.has=function(a){return Oc(this,a)};g.forEach=function(a){for(var b=E(this),c=null,d=0,e=0;;)if(e<d){var f=c.J(null,e),h=P.c(f,0,null),f=P.c(f,1,null);a.a?a.a(f,h):a.call(null,f,h);e+=1}else if(b=E(b))Ic(b)?(c=Hb(b),b=Ib(b),h=c,d=O(c),c=h):(c=F(b),h=P.c(c,0,null),f=P.c(c,1,null),a.a?a.a(f,h):a.call(null,f,h),b=I(b),c=null,d=0),e=0;else return null};g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){return Na(this.Sa,b)?b:c};g.D=function(){return this.j};g.L=function(){return Aa(this.Sa)};
g.B=function(){var a=this.m;return null!=a?a:this.m=a=dc(this)};g.v=function(a,b){return Dc(b)&&O(this)===O(b)&&Dd(function(a){return function(b){return Oc(a,b)}}(this),b)};g.Wa=function(){return new ag(yb(this.Sa))};g.I=function(){return N(bg,this.j)};g.vb=function(a,b){return new $f(this.j,Qa(this.Sa,b),null)};g.H=function(){return Ve(this.Sa)};g.F=function(a,b){return new $f(b,this.Sa,this.m)};g.G=function(a,b){return new $f(this.j,R.c(this.Sa,b,null),null)};
g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.u(null,c);case 3:return this.C(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return this.u(null,a)};g.a=function(a,b){return this.C(null,a,b)};var bg=new $f(null,Ye,0);function ag(a){this.la=a;this.i=259;this.q=136}g=ag.prototype;
g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return La.c(this.la,c,Lc)===Lc?null:c;case 3:return La.c(this.la,c,Lc)===Lc?d:c}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return La.c(this.la,a,Lc)===Lc?null:a};g.a=function(a,b){return La.c(this.la,a,Lc)===Lc?b:a};g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){return La.c(this.la,b,Lc)===Lc?c:b};
g.L=function(){return O(this.la)};g.Ob=function(a,b){this.la=yd.a(this.la,b);return this};g.Ka=function(a,b){this.la=xd.c(this.la,b,null);return this};g.Oa=function(){return new $f(null,Ab(this.la),null)};function cg(a,b,c){this.j=a;this.na=b;this.m=c;this.i=417730831;this.q=8192}g=cg.prototype;g.toString=function(){return Lb(this)};g.keys=function(){return Oe(E(this))};g.entries=function(){return Se(E(this))};g.values=function(){return Oe(E(this))};g.has=function(a){return Oc(this,a)};
g.forEach=function(a){for(var b=E(this),c=null,d=0,e=0;;)if(e<d){var f=c.J(null,e),h=P.c(f,0,null),f=P.c(f,1,null);a.a?a.a(f,h):a.call(null,f,h);e+=1}else if(b=E(b))Ic(b)?(c=Hb(b),b=Ib(b),h=c,d=O(c),c=h):(c=F(b),h=P.c(c,0,null),f=P.c(c,1,null),a.a?a.a(f,h):a.call(null,f,h),b=I(b),c=null,d=0),e=0;else return null};g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){a=Rf(this.na,b);return null!=a?a.key:c};g.D=function(){return this.j};g.L=function(){return O(this.na)};
g.Xa=function(){return 0<O(this.na)?Kd.a(cf,pb(this.na)):null};g.B=function(){var a=this.m;return null!=a?a:this.m=a=dc(this)};g.v=function(a,b){return Dc(b)&&O(this)===O(b)&&Dd(function(a){return function(b){return Oc(a,b)}}(this),b)};g.I=function(){return N(dg,this.j)};g.vb=function(a,b){return new cg(this.j,tc.a(this.na,b),null)};g.H=function(){return Ve(this.na)};g.F=function(a,b){return new cg(b,this.na,this.m)};g.G=function(a,b){return new cg(this.j,R.c(this.na,b,null),null)};
g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.u(null,c);case 3:return this.C(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return this.u(null,a)};g.a=function(a,b){return this.C(null,a,b)};g.yb=function(a,b){return Kd.a(cf,qb(this.na,b))};g.zb=function(a,b,c){return Kd.a(cf,rb(this.na,b,c))};g.xb=function(a,b){return b};g.wb=function(){return tb(this.na)};
var dg=new cg(null,Sf,0);function eg(a){a=E(a);if(null==a)return bg;if(a instanceof ac&&0===a.p){a=a.e;a:{for(var b=0,c=yb(bg);;)if(b<a.length)var d=b+1,c=c.Ka(null,a[b]),b=d;else{a=c;break a}a=void 0}return a.Oa(null)}if(u)for(d=yb(bg);;)if(null!=a)b=a.U(null),d=d.Ka(null,a.Q(null)),a=b;else return d.Oa(null);else return null}
var fg=function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){return C.c(Da,dg,a)}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}(),gg=function(){function a(a,d){var e=null;1<arguments.length&&(e=J(Array.prototype.slice.call(arguments,1),0));return b.call(this,a,e)}function b(a,b){return C.c(Da,new cg(null,Wf(a),0),b)}a.k=1;a.f=function(a){var d=F(a);a=G(a);return b(d,a)};a.d=b;return a}();
function hg(a){for(var b=qe;;)if(I(a))b=pc.a(b,F(a)),a=I(a);else return E(b)}function id(a){if(a&&(a.q&4096||a.fc))return a.name;if("string"===typeof a)return a;throw Error("Doesn't support name: "+A.b(a));}
var ig=function(){function a(a,b,c){return(a.b?a.b(b):a.call(null,b))>(a.b?a.b(c):a.call(null,c))?b:c}var b=null,c=function(){function a(b,d,k,l){var n=null;3<arguments.length&&(n=J(Array.prototype.slice.call(arguments,3),0));return c.call(this,b,d,k,n)}function c(a,d,e,l){return C.c(function(c,d){return b.c(a,c,d)},b.c(a,d,e),l)}a.k=3;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=I(a);var l=F(a);a=G(a);return c(b,d,l,a)};a.d=c;return a}(),b=function(b,e,f,h){switch(arguments.length){case 2:return e;
case 3:return a.call(this,b,e,f);default:return c.d(b,e,f,J(arguments,3))}throw Error("Invalid arity: "+arguments.length);};b.k=3;b.f=c.f;b.a=function(a,b){return b};b.c=a;b.d=c.d;return b}(),jg=function(){function a(a,b,f){return new V(null,function(){var h=E(f);return h?M(Md(a,h),c.c(a,b,Nd(b,h))):null},null,null)}function b(a,b){return c.c(a,a,b)}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);
};c.a=b;c.c=a;return c}(),lg=function kg(b,c){return new V(null,function(){var d=E(c);return d?r(b.b?b.b(F(d)):b.call(null,F(d)))?M(F(d),kg(b,G(d))):null:null},null,null)};function mg(a,b,c){return function(d){var e=tb(a);return b.a?b.a(e.a?e.a(sb(a,d),c):e.call(null,sb(a,d),c),0):b.call(null,e.a?e.a(sb(a,d),c):e.call(null,sb(a,d),c),0)}}
var ng=function(){function a(a,b,c,h,k){var l=rb(a,c,!0);if(r(l)){var n=P.c(l,0,null);return lg(mg(a,h,k),r(mg(a,b,c).call(null,n))?l:I(l))}return null}function b(a,b,c){var h=mg(a,b,c),k;a:{k=[Uc,Vc];var l=k.length;if(l<=Ze)for(var n=0,q=yb(Ye);;)if(n<l)var t=n+1,q=Bb(q,k[n],null),n=t;else{k=new $f(null,Ab(q),null);break a}else for(n=0,q=yb(bg);;)if(n<l)t=n+1,q=zb(q,k[n]),n=t;else{k=Ab(q);break a}k=void 0}return r(k.call(null,b))?(a=rb(a,c,!0),r(a)?(b=P.c(a,0,null),r(h.b?h.b(b):h.call(null,b))?a:
I(a)):null):lg(h,qb(a,!0))}var c=null,c=function(c,e,f,h,k){switch(arguments.length){case 3:return b.call(this,c,e,f);case 5:return a.call(this,c,e,f,h,k)}throw Error("Invalid arity: "+arguments.length);};c.c=b;c.s=a;return c}();function og(a,b,c,d,e){this.j=a;this.start=b;this.end=c;this.step=d;this.m=e;this.i=32375006;this.q=8192}g=og.prototype;g.toString=function(){return Lb(this)};
g.J=function(a,b){if(b<Aa(this))return this.start+b*this.step;if(this.start>this.end&&0===this.step)return this.start;throw Error("Index out of bounds");};g.aa=function(a,b,c){return b<Aa(this)?this.start+b*this.step:this.start>this.end&&0===this.step?this.start:c};g.D=function(){return this.j};
g.U=function(){return 0<this.step?this.start+this.step<this.end?new og(this.j,this.start+this.step,this.end,this.step,null):null:this.start+this.step>this.end?new og(this.j,this.start+this.step,this.end,this.step,null):null};g.L=function(){return sa(lb(this))?0:Math.ceil((this.end-this.start)/this.step)};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.j)};g.N=function(a,b){return gc.a(this,b)};
g.M=function(a,b,c){return gc.c(this,b,c)};g.Q=function(){return null==lb(this)?null:this.start};g.S=function(){return null!=lb(this)?new og(this.j,this.start+this.step,this.end,this.step,null):H};g.H=function(){return 0<this.step?this.start<this.end?this:null:this.start>this.end?this:null};g.F=function(a,b){return new og(b,this.start,this.end,this.step,this.m)};g.G=function(a,b){return M(b,this)};
var pg=function(){function a(a,b,c){return new og(null,a,b,c,null)}function b(a,b){return e.c(a,b,1)}function c(a){return e.c(0,a,1)}function d(){return e.c(0,Number.MAX_VALUE,1)}var e=null,e=function(e,h,k){switch(arguments.length){case 0:return d.call(this);case 1:return c.call(this,e);case 2:return b.call(this,e,h);case 3:return a.call(this,e,h,k)}throw Error("Invalid arity: "+arguments.length);};e.o=d;e.b=c;e.a=b;e.c=a;return e}(),qg=function(){function a(a,b){for(;;)if(E(b)&&0<a){var c=a-1,h=
I(b);a=c;b=h}else return null}function b(a){for(;;)if(E(a))a=I(a);else return null}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),rg=function(){function a(a,b){qg.a(a,b);return b}function b(a){qg.b(a);return a}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);
};c.b=b;c.a=a;return c}();function sg(a,b){if("string"===typeof b){var c=a.exec(b);return Wb.a(F(c),b)?1===O(c)?F(c):we(c):null}throw new TypeError("re-matches must match against a string.");}function tg(a){var b;b=/^(?:\(\?([idmsux]*)\))?(.*)/;if("string"===typeof a)a=b.exec(a),b=null==a?null:1===O(a)?F(a):we(a);else throw new TypeError("re-find must match against a string.");P.c(b,0,null);a=P.c(b,1,null);b=P.c(b,2,null);return new RegExp(b,a)}
function ug(a,b,c,d,e,f,h){var k=ja;try{ja=null==ja?null:ja-1;if(null!=ja&&0>ja)return ub(a,"#");ub(a,c);E(h)&&(b.c?b.c(F(h),a,f):b.call(null,F(h),a,f));for(var l=I(h),n=ra.b(f)-1;;)if(!l||null!=n&&0===n){E(l)&&0===n&&(ub(a,d),ub(a,"..."));break}else{ub(a,d);b.c?b.c(F(l),a,f):b.call(null,F(l),a,f);var q=I(l);c=n-1;l=q;n=c}return ub(a,e)}finally{ja=k}}
var vg=function(){function a(a,d){var e=null;1<arguments.length&&(e=J(Array.prototype.slice.call(arguments,1),0));return b.call(this,a,e)}function b(a,b){for(var e=E(b),f=null,h=0,k=0;;)if(k<h){var l=f.J(null,k);ub(a,l);k+=1}else if(e=E(e))f=e,Ic(f)?(e=Hb(f),h=Ib(f),f=e,l=O(e),e=h,h=l):(l=F(f),ub(a,l),e=I(f),f=null,h=0),k=0;else return null}a.k=1;a.f=function(a){var d=F(a);a=G(a);return b(d,a)};a.d=b;return a}(),wg={'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t"};
function xg(a){return'"'+A.b(a.replace(RegExp('[\\\\"\b\f\n\r\t]',"g"),function(a){return wg[a]}))+'"'}
var Ag=function yg(b,c,d){if(null==b)return ub(c,"nil");if(void 0===b)return ub(c,"#\x3cundefined\x3e");if(u){r(function(){var c=Q.a(d,pa);return r(c)?(c=b?b.i&131072||b.ec?!0:b.i?!1:s(bb,b):s(bb,b))?xc(b):c:c}())&&(ub(c,"^"),yg(xc(b),c,d),ub(c," "));if(null==b)return ub(c,"nil");if(b.Db)return b.Tb(b,c,d);if(b&&(b.i&2147483648||b.K))return b.w(null,c,d);if(ta(b)===Boolean||"number"===typeof b)return ub(c,""+A.b(b));if(null!=b&&b.constructor===Object)return ub(c,"#js "),zg.n?zg.n(Kd.a(function(c){return new W(null,
2,5,X,[jd.b(c),b[c]],null)},Jc(b)),yg,c,d):zg.call(null,Kd.a(function(c){return new W(null,2,5,X,[jd.b(c),b[c]],null)},Jc(b)),yg,c,d);if(b instanceof Array)return ug(c,yg,"#js ["," ","]",d,b);if("string"==typeof b)return r(oa.b(d))?ub(c,xg(b)):ub(c,b);if(uc(b))return vg.d(c,J(["#\x3c",""+A.b(b),"\x3e"],0));if(b instanceof Date){var e=function(b,c){for(var d=""+A.b(b);;)if(O(d)<c)d="0"+A.b(d);else return d};return vg.d(c,J(['#inst "',""+A.b(b.getUTCFullYear()),"-",e(b.getUTCMonth()+1,2),"-",e(b.getUTCDate(),
2),"T",e(b.getUTCHours(),2),":",e(b.getUTCMinutes(),2),":",e(b.getUTCSeconds(),2),".",e(b.getUTCMilliseconds(),3),"-",'00:00"'],0))}return b instanceof RegExp?vg.d(c,J(['#"',b.source,'"'],0)):(b?b.i&2147483648||b.K||(b.i?0:s(vb,b)):s(vb,b))?wb(b,c,d):u?vg.d(c,J(["#\x3c",""+A.b(b),"\x3e"],0)):null}return null};
function Bg(a,b){var c=new ea;a:{var d=new Kb(c);Ag(F(a),d,b);for(var e=E(I(a)),f=null,h=0,k=0;;)if(k<h){var l=f.J(null,k);ub(d," ");Ag(l,d,b);k+=1}else if(e=E(e))f=e,Ic(f)?(e=Hb(f),h=Ib(f),f=e,l=O(e),e=h,h=l):(l=F(f),ub(d," "),Ag(l,d,b),e=I(f),f=null,h=0),k=0;else break a}return c}
var Cg=function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){var b=ka();return Bc(a)?"":""+A.b(Bg(a,b))}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}();function zg(a,b,c,d){return ug(c,function(a,c,d){b.c?b.c(Ta(a),c,d):b.call(null,Ta(a),c,d);ub(c," ");return b.c?b.c(Ua(a),c,d):b.call(null,Ua(a),c,d)},"{",", ","}",d,E(a))}ac.prototype.K=!0;
ac.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};V.prototype.K=!0;V.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};Bf.prototype.K=!0;Bf.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};vf.prototype.K=!0;vf.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};$.prototype.K=!0;$.prototype.w=function(a,b,c){return ug(b,Ag,"["," ","]",c,this)};Ue.prototype.K=!0;Ue.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};
cg.prototype.K=!0;cg.prototype.w=function(a,b,c){return ug(b,Ag,"#{"," ","}",c,this)};ye.prototype.K=!0;ye.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};gd.prototype.K=!0;gd.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};kc.prototype.K=!0;kc.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};xf.prototype.K=!0;xf.prototype.w=function(a,b,c){return zg(this,Ag,b,c)};wf.prototype.K=!0;wf.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};
Ae.prototype.K=!0;Ae.prototype.w=function(a,b,c){return ug(b,Ag,"["," ","]",c,this)};Qf.prototype.K=!0;Qf.prototype.w=function(a,b,c){return zg(this,Ag,b,c)};$f.prototype.K=!0;$f.prototype.w=function(a,b,c){return ug(b,Ag,"#{"," ","}",c,this)};od.prototype.K=!0;od.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};Yf.prototype.K=!0;Yf.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};Y.prototype.K=!0;Y.prototype.w=function(a,b,c){return ug(b,Ag,"["," ","]",c,this)};
W.prototype.K=!0;W.prototype.w=function(a,b,c){return ug(b,Ag,"["," ","]",c,this)};He.prototype.K=!0;He.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};cd.prototype.K=!0;cd.prototype.w=function(a,b){return ub(b,"()")};Ie.prototype.K=!0;Ie.prototype.w=function(a,b,c){return ug(b,Ag,"#queue ["," ","]",c,E(this))};la.prototype.K=!0;la.prototype.w=function(a,b,c){return zg(this,Ag,b,c)};og.prototype.K=!0;og.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};
Xf.prototype.K=!0;Xf.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};bd.prototype.K=!0;bd.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};W.prototype.lb=!0;W.prototype.mb=function(a,b){return Pc.a(this,b)};Ae.prototype.lb=!0;Ae.prototype.mb=function(a,b){return Pc.a(this,b)};T.prototype.lb=!0;T.prototype.mb=function(a,b){return Vb(this,b)};Zb.prototype.lb=!0;Zb.prototype.mb=function(a,b){return Vb(this,b)};
function Dg(a,b){if(a?a.gc:a)return a.gc(a,b);var c;c=Dg[m(null==a?null:a)];if(!c&&(c=Dg._,!c))throw x("IReset.-reset!",a);return c.call(null,a,b)}
var Eg=function(){function a(a,b,c,d,e){if(a?a.nc:a)return a.nc(a,b,c,d,e);var q;q=Eg[m(null==a?null:a)];if(!q&&(q=Eg._,!q))throw x("ISwap.-swap!",a);return q.call(null,a,b,c,d,e)}function b(a,b,c,d){if(a?a.mc:a)return a.mc(a,b,c,d);var e;e=Eg[m(null==a?null:a)];if(!e&&(e=Eg._,!e))throw x("ISwap.-swap!",a);return e.call(null,a,b,c,d)}function c(a,b,c){if(a?a.lc:a)return a.lc(a,b,c);var d;d=Eg[m(null==a?null:a)];if(!d&&(d=Eg._,!d))throw x("ISwap.-swap!",a);return d.call(null,a,b,c)}function d(a,b){if(a?
a.kc:a)return a.kc(a,b);var c;c=Eg[m(null==a?null:a)];if(!c&&(c=Eg._,!c))throw x("ISwap.-swap!",a);return c.call(null,a,b)}var e=null,e=function(e,h,k,l,n){switch(arguments.length){case 2:return d.call(this,e,h);case 3:return c.call(this,e,h,k);case 4:return b.call(this,e,h,k,l);case 5:return a.call(this,e,h,k,l,n)}throw Error("Invalid arity: "+arguments.length);};e.a=d;e.c=c;e.n=b;e.s=a;return e}();function Fg(a,b,c,d){this.state=a;this.j=b;this.wc=c;this.Wb=d;this.i=2153938944;this.q=16386}g=Fg.prototype;
g.B=function(){return this[ba]||(this[ba]=++ca)};g.Rb=function(a,b,c){a=E(this.Wb);for(var d=null,e=0,f=0;;)if(f<e){var h=d.J(null,f),k=P.c(h,0,null),h=P.c(h,1,null);h.n?h.n(k,this,b,c):h.call(null,k,this,b,c);f+=1}else if(a=E(a))Ic(a)?(d=Hb(a),a=Ib(a),k=d,e=O(d),d=k):(d=F(a),k=P.c(d,0,null),h=P.c(d,1,null),h.n?h.n(k,this,b,c):h.call(null,k,this,b,c),a=I(a),d=null,e=0),f=0;else return null};g.w=function(a,b,c){ub(b,"#\x3cAtom: ");Ag(this.state,b,c);return ub(b,"\x3e")};g.D=function(){return this.j};
g.ub=function(){return this.state};g.v=function(a,b){return this===b};
var Hg=function(){function a(a){return new Fg(a,null,null,null)}var b=null,c=function(){function a(c,d){var k=null;1<arguments.length&&(k=J(Array.prototype.slice.call(arguments,1),0));return b.call(this,c,k)}function b(a,c){var d=Mc(c)?S.a(Tf,c):c,e=Q.a(d,Gg),d=Q.a(d,pa);return new Fg(a,d,e,null)}a.k=1;a.f=function(a){var c=F(a);a=G(a);return b(c,a)};a.d=b;return a}(),b=function(b,e){switch(arguments.length){case 1:return a.call(this,b);default:return c.d(b,J(arguments,1))}throw Error("Invalid arity: "+
arguments.length);};b.k=1;b.f=c.f;b.b=a;b.d=c.d;return b}();function Ig(a,b){if(a instanceof Fg){var c=a.wc;if(null!=c&&!r(c.b?c.b(b):c.call(null,b)))throw Error("Assert failed: Validator rejected reference state\n"+A.b(Cg.d(J([fd(new Zb(null,"validate","validate",1439230700,null),new Zb(null,"new-value","new-value",-1567397401,null))],0))));c=a.state;a.state=b;null!=a.Wb&&xb(a,c,b);return b}return Dg(a,b)}function K(a){return ab(a)}
var Jg=function(){function a(a,b,c,d){return a instanceof Fg?Ig(a,b.c?b.c(a.state,c,d):b.call(null,a.state,c,d)):Eg.n(a,b,c,d)}function b(a,b,c){return a instanceof Fg?Ig(a,b.a?b.a(a.state,c):b.call(null,a.state,c)):Eg.c(a,b,c)}function c(a,b){return a instanceof Fg?Ig(a,b.b?b.b(a.state):b.call(null,a.state)):Eg.a(a,b)}var d=null,e=function(){function a(c,d,e,f,t){var v=null;4<arguments.length&&(v=J(Array.prototype.slice.call(arguments,4),0));return b.call(this,c,d,e,f,v)}function b(a,c,d,e,f){return a instanceof
Fg?Ig(a,S.s(c,a.state,d,e,f)):Eg.s(a,c,d,e,f)}a.k=4;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=I(a);var e=F(a);a=I(a);var f=F(a);a=G(a);return b(c,d,e,f,a)};a.d=b;return a}(),d=function(d,h,k,l,n){switch(arguments.length){case 2:return c.call(this,d,h);case 3:return b.call(this,d,h,k);case 4:return a.call(this,d,h,k,l);default:return e.d(d,h,k,l,J(arguments,4))}throw Error("Invalid arity: "+arguments.length);};d.k=4;d.f=e.f;d.a=c;d.c=b;d.n=a;d.d=e.d;return d}(),Kg={};
function Lg(a){if(a?a.ac:a)return a.ac(a);var b;b=Lg[m(null==a?null:a)];if(!b&&(b=Lg._,!b))throw x("IEncodeJS.-clj-\x3ejs",a);return b.call(null,a)}function Mg(a){return(a?r(r(null)?null:a.$b)||(a.Cb?0:s(Kg,a)):s(Kg,a))?Lg(a):"string"===typeof a||"number"===typeof a||a instanceof T||a instanceof Zb?Ng.b?Ng.b(a):Ng.call(null,a):Cg.d(J([a],0))}
var Ng=function Og(b){if(null==b)return null;if(b?r(r(null)?null:b.$b)||(b.Cb?0:s(Kg,b)):s(Kg,b))return Lg(b);if(b instanceof T)return id(b);if(b instanceof Zb)return""+A.b(b);if(Gc(b)){var c={};b=E(b);for(var d=null,e=0,f=0;;)if(f<e){var h=d.J(null,f),k=P.c(h,0,null),h=P.c(h,1,null);c[Mg(k)]=Og(h);f+=1}else if(b=E(b))Ic(b)?(e=Hb(b),b=Ib(b),d=e,e=O(e)):(e=F(b),d=P.c(e,0,null),e=P.c(e,1,null),c[Mg(d)]=Og(e),b=I(b),d=null,e=0),f=0;else break;return c}if(Cc(b)){c=[];b=E(Kd.a(Og,b));d=null;for(f=e=0;;)if(f<
e)k=d.J(null,f),c.push(k),f+=1;else if(b=E(b))d=b,Ic(d)?(b=Hb(d),f=Ib(d),d=b,e=O(b),b=f):(b=F(d),c.push(b),b=I(d),d=null,e=0),f=0;else break;return c}return u?b:null},Pg={};function Qg(a,b){if(a?a.Zb:a)return a.Zb(a,b);var c;c=Qg[m(null==a?null:a)];if(!c&&(c=Qg._,!c))throw x("IEncodeClojure.-js-\x3eclj",a);return c.call(null,a,b)}
var Sg=function(){function a(a){return b.d(a,J([new la(null,1,[Rg,!1],null)],0))}var b=null,c=function(){function a(c,d){var k=null;1<arguments.length&&(k=J(Array.prototype.slice.call(arguments,1),0));return b.call(this,c,k)}function b(a,c){if(a?r(r(null)?null:a.Cc)||(a.Cb?0:s(Pg,a)):s(Pg,a))return Qg(a,S.a(Uf,c));if(E(c)){var d=Mc(c)?S.a(Tf,c):c,e=Q.a(d,Rg);return function(a,b,c,d){return function y(e){return Mc(e)?rg.b(Kd.a(y,e)):Cc(e)?Yd(qc(e),Kd.a(y,e)):e instanceof Array?we(Kd.a(y,e)):ta(e)===
Object?Yd(Ye,function(){return function(a,b,c,d){return function Ra(f){return new V(null,function(a,b,c,d){return function(){for(;;){var a=E(f);if(a){if(Ic(a)){var b=Hb(a),c=O(b),h=new ld(Array(c),0);a:{for(var k=0;;)if(k<c){var l=D.a(b,k),l=new W(null,2,5,X,[d.b?d.b(l):d.call(null,l),y(e[l])],null);h.add(l);k+=1}else{b=!0;break a}b=void 0}return b?pd(h.da(),Ra(Ib(a))):pd(h.da(),null)}h=F(a);return M(new W(null,2,5,X,[d.b?d.b(h):d.call(null,h),y(e[h])],null),Ra(G(a)))}return null}}}(a,b,c,d),null,
null)}}(a,b,c,d)(Jc(e))}()):u?e:null}}(c,d,e,r(e)?jd:A)(a)}return null}a.k=1;a.f=function(a){var c=F(a);a=G(a);return b(c,a)};a.d=b;return a}(),b=function(b,e){switch(arguments.length){case 1:return a.call(this,b);default:return c.d(b,J(arguments,1))}throw Error("Invalid arity: "+arguments.length);};b.k=1;b.f=c.f;b.b=a;b.d=c.d;return b}();function Tg(a){this.pb=a;this.q=0;this.i=2153775104}
Tg.prototype.B=function(){for(var a=Cg.d(J([this],0)),b=0,c=0;c<a.length;++c)b=31*b+a.charCodeAt(c),b%=4294967296;return b};Tg.prototype.w=function(a,b){return ub(b,'#uuid "'+A.b(this.pb)+'"')};Tg.prototype.v=function(a,b){return b instanceof Tg&&this.pb===b.pb};Tg.prototype.toString=function(){return this.pb};var Ug=new T(null,"ppath","ppath"),Vg=new T("zip","branch?","zip/branch?"),Wg=new T(null,"r","r"),Xg=new T("zip","children","zip/children"),pa=new T(null,"meta","meta"),qa=new T(null,"dup","dup"),u=new T(null,"else","else"),Gg=new T(null,"validator","validator"),Yb=new T(null,"default","default"),Yg=new T(null,"sequential","sequential"),ma=new T(null,"flush-on-newline","flush-on-newline"),Zg=new T(null,"l","l"),$g=new T("zip","make-node","zip/make-node"),oa=new T(null,"readably","readably"),ra=new T(null,
"print-length","print-length"),ah=new T(null,"pnodes","pnodes"),bh=new T(null,"changed?","changed?"),ch=new T(null,"tag","tag"),dh=new T(null,"set","set"),eh=new T(null,"end","end"),fh=new T(null,"atom","atom"),Rg=new T(null,"keywordize-keys","keywordize-keys"),gh=new T(null,"map","map"),hh=new T("mori","not-found","mori/not-found"),ih=new T("cljs.core","not-found","cljs.core/not-found");var jh,kh;function lh(a){return a.o?a.o():a.call(null)}function mh(a){return a.o?a.o():a.call(null)}var nh=function(){function a(a,b,c){return Gc(c)?hb(c,a,b):null==c?b:c instanceof Array?hc.c(c,a,b):u?gb.c(c,a,b):null}function b(a,b){return c.c(a,a.o?a.o():a.call(null),b)}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}();
function oh(a,b,c,d){if(a?a.Eb:a)return a.Eb(a,b,c,d);var e;e=oh[m(null==a?null:a)];if(!e&&(e=oh._,!e))throw x("CollFold.coll-fold",a);return e.call(null,a,b,c,d)}
var qh=function ph(b,c){"undefined"===typeof jh&&(jh=function(b,c,f,h){this.$=b;this.Qa=c;this.uc=f;this.sc=h;this.q=0;this.i=917504},jh.Db=!0,jh.Bb="clojure.core.reducers/t6322",jh.Tb=function(b,c){return ub(c,"clojure.core.reducers/t6322")},jh.prototype.N=function(b,c){return gb.c(this,c,c.o?c.o():c.call(null))},jh.prototype.M=function(b,c,f){return gb.c(this.Qa,this.$.b?this.$.b(c):this.$.call(null,c),f)},jh.prototype.D=function(){return this.sc},jh.prototype.F=function(b,c){return new jh(this.$,
this.Qa,this.uc,c)});return new jh(c,b,ph,null)},sh=function rh(b,c){"undefined"===typeof kh&&(kh=function(b,c,f,h){this.$=b;this.Qa=c;this.rc=f;this.tc=h;this.q=0;this.i=917504},kh.Db=!0,kh.Bb="clojure.core.reducers/t6328",kh.Tb=function(b,c){return ub(c,"clojure.core.reducers/t6328")},kh.prototype.Eb=function(b,c,f,h){return oh(this.Qa,c,f,this.$.b?this.$.b(h):this.$.call(null,h))},kh.prototype.N=function(b,c){return gb.c(this.Qa,this.$.b?this.$.b(c):this.$.call(null,c),c.o?c.o():c.call(null))},
kh.prototype.M=function(b,c,f){return gb.c(this.Qa,this.$.b?this.$.b(c):this.$.call(null,c),f)},kh.prototype.D=function(){return this.tc},kh.prototype.F=function(b,c){return new kh(this.$,this.Qa,this.rc,c)});return new kh(c,b,rh,null)},th=function(){function a(a,b){return sh(b,function(b){return function(){var c=null;return c=function(c,e,h){switch(arguments.length){case 0:return b.o?b.o():b.call(null);case 2:return b.a?b.a(c,a.b?a.b(e):a.call(null,e)):b.call(null,c,a.b?a.b(e):a.call(null,e));case 3:return b.a?
b.a(c,a.a?a.a(e,h):a.call(null,e,h)):b.call(null,c,a.a?a.a(e,h):a.call(null,e,h))}throw Error("Invalid arity: "+arguments.length);}}()})}function b(a){return function(b){return c.a(a,b)}}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),uh=function(){function a(a,b){return sh(b,function(b){return function(){var c=null;return c=function(c,e,h){switch(arguments.length){case 0:return b.o?
b.o():b.call(null);case 2:return r(a.b?a.b(e):a.call(null,e))?b.a?b.a(c,e):b.call(null,c,e):c;case 3:return r(a.a?a.a(e,h):a.call(null,e,h))?b.c?b.c(c,e,h):b.call(null,c,e,h):c}throw Error("Invalid arity: "+arguments.length);}}()})}function b(a){return function(b){return c.a(a,b)}}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),vh=function(){function a(a){return sh(a,
function(a){return function(){var b=null;return b=function(b,d){switch(arguments.length){case 0:return a.o?a.o():a.call(null);case 2:return Fc(d)?c.b(d).M(null,a,b):a.a?a.a(b,d):a.call(null,b,d)}throw Error("Invalid arity: "+arguments.length);}}()})}function b(){return function(a){return c.b(a)}}var c=null,c=function(c){switch(arguments.length){case 0:return b.call(this);case 1:return a.call(this,c)}throw Error("Invalid arity: "+arguments.length);};c.o=b;c.b=a;return c}(),wh=function(){function a(a,
b){return uh.a(Gd(a),b)}function b(a){return function(b){return c.a(a,b)}}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),xh=function(){function a(a,b){return qh(b,function(b){return function(){var c=null;return c=function(c,e,h){switch(arguments.length){case 0:return b.o?b.o():b.call(null);case 2:return r(a.b?a.b(e):a.call(null,e))?b.a?b.a(c,e):b.call(null,c,e):
new ec(c);case 3:return r(a.a?a.a(e,h):a.call(null,e,h))?b.c?b.c(c,e,h):b.call(null,c,e,h):new ec(c)}throw Error("Invalid arity: "+arguments.length);}}()})}function b(a){return function(b){return c.a(a,b)}}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),yh=function(){function a(a,b){return qh(b,function(b){return function(a){return function(){var c=null;return c=
function(c,d,e){switch(arguments.length){case 0:return b.o?b.o():b.call(null);case 2:return Jg.a(a,Wc),0>ab(a)?new ec(c):b.a?b.a(c,d):b.call(null,c,d);case 3:return Jg.a(a,Wc),0>ab(a)?new ec(c):b.c?b.c(c,d,e):b.call(null,c,d,e)}throw Error("Invalid arity: "+arguments.length);}}()}(Hg.b(a))})}function b(a){return function(b){return c.a(a,b)}}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);
};c.b=b;c.a=a;return c}(),zh=function(){function a(a,b){return qh(b,function(b){return function(a){return function(){var c=null;return c=function(c,d,e){switch(arguments.length){case 0:return b.o?b.o():b.call(null);case 2:return Jg.a(a,Wc),0>ab(a)?b.a?b.a(c,d):b.call(null,c,d):c;case 3:return Jg.a(a,Wc),0>ab(a)?b.c?b.c(c,d,e):b.call(null,c,d,e):c}throw Error("Invalid arity: "+arguments.length);}}()}(Hg.b(a))})}function b(a){return function(b){return c.a(a,b)}}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,
c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),Bh=function Ah(b,c,d,e){if(Bc(b))return d.o?d.o():d.call(null);if(O(b)<=c)return nh.c(e,d.o?d.o():d.call(null),b);if(u){var f=Yc(O(b)),h=ze.c(b,0,f);b=ze.c(b,f,O(b));return lh(function(b,c,e,f){return function(){var b=f(c),h;h=f(e);return d.a?d.a(b.o?b.o():b.call(null),mh(h)):d.call(null,b.o?b.o():b.call(null),mh(h))}}(f,h,b,function(b,f,h){return function(q){return function(){return function(){return Ah(q,
c,d,e)}}(b,f,h)}}(f,h,b)))}return null};W.prototype.Eb=function(a,b,c,d){return Bh(this,b,c,d)};oh.object=function(a,b,c,d){return nh.c(d,c.o?c.o():c.call(null),a)};oh["null"]=function(a,b,c){return c.o?c.o():c.call(null)};function Ch(a,b){var c=S.c(ig,a,b);return M(c,Vd(function(a){return function(b){return a===b}}(c),b))}
var Dh=function(){function a(a,b){return O(a)<O(b)?C.c(pc,b,a):C.c(pc,a,b)}var b=null,c=function(){function a(c,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,d,l)}function b(a,c,d){a=Ch(O,pc.d(d,c,J([a],0)));return C.c(Yd,F(a),G(a))}a.k=2;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=G(a);return b(c,d,a)};a.d=b;return a}(),b=function(b,e,f){switch(arguments.length){case 0:return bg;case 1:return b;case 2:return a.call(this,b,e);default:return c.d(b,
e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;b.o=function(){return bg};b.b=function(a){return a};b.a=a;b.d=c.d;return b}(),Eh=function(){function a(a,b){for(;;)if(O(b)<O(a)){var c=a;a=b;b=c}else return C.c(function(a,b){return function(a,c){return Oc(b,c)?a:Ac.a(a,c)}}(a,b),a,a)}var b=null,c=function(){function a(b,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,b,d,l)}function c(a,d,e){a=Ch(function(a){return-O(a)},
pc.d(e,d,J([a],0)));return C.c(b,F(a),G(a))}a.k=2;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};a.d=c;return a}(),b=function(b,e,f){switch(arguments.length){case 1:return b;case 2:return a.call(this,b,e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;b.b=function(a){return a};b.a=a;b.d=c.d;return b}(),Fh=function(){function a(a,b){return O(a)<O(b)?C.c(function(a,c){return Oc(b,c)?Ac.a(a,c):a},a,a):C.c(Ac,a,b)}var b=null,
c=function(){function a(b,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,b,d,l)}function c(a,d,e){return C.c(b,a,pc.a(e,d))}a.k=2;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};a.d=c;return a}(),b=function(b,e,f){switch(arguments.length){case 1:return b;case 2:return a.call(this,b,e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;b.b=function(a){return a};b.a=a;b.d=
c.d;return b}();function Gh(a,b){return Wb.a(a,b)?new W(null,3,5,X,[null,null,a],null):new W(null,3,5,X,[a,b,null],null)}function Hh(a){return E(a)?C.c(function(a,c){var d=P.c(c,0,null),e=P.c(c,1,null);return R.c(a,d,e)},we(Od.a(S.a(Xc,Ve(a)),null)),a):null}
function Ih(a,b,c){var d=Q.a(a,c),e=Q.a(b,c),f=Jh.a?Jh.a(d,e):Jh.call(null,d,e),h=P.c(f,0,null),k=P.c(f,1,null),f=P.c(f,2,null);a=Oc(a,c);b=Oc(b,c);d=a&&b&&(null!=f||null==d&&null==e);return new W(null,3,5,X,[!a||null==h&&d?null:new af([c,h]),!b||null==k&&d?null:new af([c,k]),d?new af([c,f]):null],null)}
var Kh=function(){function a(a,b,c){return C.c(function(a,b){return rg.b(Kd.c(Zf,a,b))},new W(null,3,5,X,[null,null,null],null),Kd.a(Id.c(Ih,a,b),c))}function b(a,b){return c.c(a,b,Dh.a(Ve(a),Ve(b)))}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}();
function Lh(a,b){return we(Kd.a(Hh,Kh.c(Hc(a)?a:we(a),Hc(b)?b:we(b),pg.b(function(){var c=O(a),d=O(b);return c>d?c:d}()))))}function Mh(a,b){return new W(null,3,5,X,[Cd(Fh.a(a,b)),Cd(Fh.a(b,a)),Cd(Eh.a(a,b))],null)}function Nh(a){if(a?a.qc:a)return a.qc(a);var b;b=Nh[m(null==a?null:a)];if(!b&&(b=Nh._,!b))throw x("EqualityPartition.equality-partition",a);return b.call(null,a)}
function Oh(a,b){if(a?a.pc:a)return a.pc(a,b);var c;c=Oh[m(null==a?null:a)];if(!c&&(c=Oh._,!c))throw x("Diff.diff-similar",a);return c.call(null,a,b)}Nh._=function(a){return(a?a.i&1024||a.cc||(a.i?0:s(Pa,a)):s(Pa,a))?gh:(a?a.i&4096||a.jc||(a.i?0:s(Va,a)):s(Va,a))?dh:(a?a.i&16777216||a.ic||(a.i?0:s(mb,a)):s(mb,a))?Yg:Yb?fh:null};Nh["boolean"]=function(){return fh};Nh["function"]=function(){return fh};Nh.array=function(){return Yg};Nh.number=function(){return fh};Nh.string=function(){return fh};
Nh["null"]=function(){return fh};Oh._=function(a,b){return function(){switch(Nh(a)instanceof T?Nh(a).sa:null){case "map":return Kh;case "sequential":return Lh;case "set":return Mh;case "atom":return Gh;default:throw Error("No matching clause: "+A.b(Nh(a)));}}().call(null,a,b)};Oh["boolean"]=function(a,b){return Gh(a,b)};Oh["function"]=function(a,b){return Gh(a,b)};Oh.array=function(a,b){return Lh(a,b)};Oh.number=function(a,b){return Gh(a,b)};Oh.string=function(a,b){return Gh(a,b)};
Oh["null"]=function(a,b){return Gh(a,b)};function Jh(a,b){return Wb.a(a,b)?new W(null,3,5,X,[null,null,a],null):Wb.a(Nh(a),Nh(b))?Oh(a,b):Gh(a,b)};function Ph(a){if(a?a.Ub:a)return a.Ub();var b;b=Ph[m(null==a?null:a)];if(!b&&(b=Ph._,!b))throw x("PushbackReader.read-char",a);return b.call(null,a)}function Qh(a,b){if(a?a.Vb:a)return a.Vb(0,b);var c;c=Qh[m(null==a?null:a)];if(!c&&(c=Qh._,!c))throw x("PushbackReader.unread",a);return c.call(null,a,b)}function Rh(a,b,c){this.r=a;this.buffer=b;this.Fb=c}Rh.prototype.Ub=function(){return 0===this.buffer.length?(this.Fb+=1,this.r[this.Fb]):this.buffer.pop()};Rh.prototype.Vb=function(a,b){return this.buffer.push(b)};
function Sh(a){var b=!/[^\t\n\r ]/.test(a);return r(b)?b:","===a}var Th=function(){function a(a,d){var e=null;1<arguments.length&&(e=J(Array.prototype.slice.call(arguments,1),0));return b.call(this,0,e)}function b(a,b){throw Error(S.a(A,b));}a.k=1;a.f=function(a){F(a);a=G(a);return b(0,a)};a.d=b;return a}();
function Uh(a,b){for(var c=new ea(b),d=Ph(a);;){var e;if(!(e=null==d||Sh(d))){e=d;var f="#"!==e;e=f?(f="'"!==e)?(f=":"!==e)?Vh.b?Vh.b(e):Vh.call(null,e):f:f:f}if(e)return Qh(a,d),c.toString();c.append(d);d=Ph(a)}}function Wh(a){for(;;){var b=Ph(a);if("\n"===b||"\r"===b||null==b)return a}}var Xh=tg("^([-+]?)(?:(0)|([1-9][0-9]*)|0[xX]([0-9A-Fa-f]+)|0([0-7]+)|([1-9][0-9]?)[rR]([0-9A-Za-z]+))(N)?$"),Yh=tg("^([-+]?[0-9]+)/([0-9]+)$"),Zh=tg("^([-+]?[0-9]+(\\.[0-9]*)?([eE][-+]?[0-9]+)?)(M)?$"),$h=tg("^[:]?([^0-9/].*/)?([^0-9/][^/]*)$");
function ai(a,b){var c=a.exec(b);return null!=c&&c[0]===b?1===c.length?c[0]:c:null}var bi=tg("^[0-9A-Fa-f]{2}$"),ci=tg("^[0-9A-Fa-f]{4}$");function di(a,b,c,d){return r(sg(a,d))?d:Th.d(b,J(["Unexpected unicode escape \\",c,d],0))}function ei(a){return String.fromCharCode(parseInt(a,16))}
function fi(a){var b=Ph(a),c="t"===b?"\t":"r"===b?"\r":"n"===b?"\n":"\\"===b?"\\":'"'===b?'"':"b"===b?"\b":"f"===b?"\f":null;r(c)?a=c:"x"===b?(c=(new ea(Ph(a),Ph(a))).toString(),a=ei(di(bi,a,b,c))):"u"===b?(c=(new ea(Ph(a),Ph(a),Ph(a),Ph(a))).toString(),a=ei(di(ci,a,b,c))):a=/[^0-9]/.test(b)?u?Th.d(a,J(["Unexpected unicode escape \\",b],0)):null:String.fromCharCode(b);return a}
function gi(a,b){for(var c=yb(qe);;){var d;a:{d=Sh;for(var e=b,f=Ph(e);;)if(r(d.b?d.b(f):d.call(null,f)))f=Ph(e);else{d=f;break a}d=void 0}r(d)||Th.d(b,J(["EOF while reading"],0));if(a===d)return Ab(c);e=Vh.b?Vh.b(d):Vh.call(null,d);r(e)?d=e.a?e.a(b,d):e.call(null,b,d):(Qh(b,d),d=hi.n?hi.n(b,!0,null,!0):hi.call(null,b,!0,null));c=d===b?c:wd.a(c,d)}}function ii(a,b){return Th.d(a,J(["Reader for ",b," not implemented yet"],0))}
function ji(a,b){var c=Ph(a),d=ki.b?ki.b(c):ki.call(null,c);if(r(d))return d.a?d.a(a,b):d.call(null,a,b);d=li.a?li.a(a,c):li.call(null,a,c);return r(d)?d:Th.d(a,J(["No dispatch macro for ",c],0))}function mi(a,b){return Th.d(a,J(["Unmached delimiter ",b],0))}function ni(a){return S.a(fd,gi(")",a))}function oi(a){return gi("]",a)}
function pi(a){var b=gi("}",a),c=O(b);if("number"!==typeof c||isNaN(c)||Infinity===c||parseFloat(c)!==parseInt(c,10))throw Error("Argument must be an integer: "+A.b(c));0!==(c&1)&&Th.d(a,J(["Map literal must contain an even number of forms"],0));return S.a(Tf,b)}function qi(a){for(var b=new ea,c=Ph(a);;){if(null==c)return Th.d(a,J(["EOF while reading"],0));if("\\"===c)b.append(fi(a)),c=Ph(a);else{if('"'===c)return b.toString();if(Yb)b.append(c),c=Ph(a);else return null}}}
function ri(a){for(var b=new ea,c=Ph(a);;){if(null==c)return Th.d(a,J(["EOF while reading"],0));if("\\"===c){b.append(c);var d=Ph(a);if(null==d)return Th.d(a,J(["EOF while reading"],0));var e=function(){var a=b;a.append(d);return a}(),f=Ph(a),b=e,c=f}else{if('"'===c)return b.toString();if(u)e=function(){var a=b;a.append(c);return a}(),f=Ph(a),b=e,c=f;else return null}}}
function si(a,b){var c=Uh(a,b);if(r(-1!=c.indexOf("/")))c=$b.a(ad.c(c,0,c.indexOf("/")),ad.c(c,c.indexOf("/")+1,c.length));else var d=$b.b(c),c="nil"===c?null:"true"===c?!0:"false"===c?!1:u?d:null;return c}function ti(a){var b=Uh(a,Ph(a)),c=ai($h,b),b=c[0],d=c[1],c=c[2];return void 0!==d&&":/"===d.substring(d.length-2,d.length)||":"===c[c.length-1]||-1!==b.indexOf("::",1)?Th.d(a,J(["Invalid token: ",b],0)):null!=d&&0<d.length?jd.a(d.substring(0,d.indexOf("/")),c):jd.b(b)}
function ui(a){return function(b){return Da(Da(H,hi.n?hi.n(b,!0,null,!0):hi.call(null,b,!0,null)),a)}}function vi(){return function(a){return Th.d(a,J(["Unreadable form"],0))}}
function wi(a){var b;b=hi.n?hi.n(a,!0,null,!0):hi.call(null,a,!0,null);b=b instanceof Zb?new la(null,1,[ch,b],null):"string"===typeof b?new la(null,1,[ch,b],null):b instanceof T?new af([b,!0]):u?b:null;Gc(b)||Th.d(a,J(["Metadata must be Symbol,Keyword,String or Map"],0));var c=hi.n?hi.n(a,!0,null,!0):hi.call(null,a,!0,null);return(c?c.i&262144||c.oc||(c.i?0:s(db,c)):s(db,c))?N(c,Zf.d(J([xc(c),b],0))):Th.d(a,J(["Metadata can only be applied to IWithMetas"],0))}function xi(a){return eg(gi("}",a))}
function yi(a){return tg(ri(a))}function zi(a){hi.n?hi.n(a,!0,null,!0):hi.call(null,a,!0,null);return a}function Vh(a){return'"'===a?qi:":"===a?ti:";"===a?Wh:"'"===a?ui(new Zb(null,"quote","quote",1377916282,null)):"@"===a?ui(new Zb(null,"deref","deref",1494944732,null)):"^"===a?wi:"`"===a?ii:"~"===a?ii:"("===a?ni:")"===a?mi:"["===a?oi:"]"===a?mi:"{"===a?pi:"}"===a?mi:"\\"===a?Ph:"#"===a?ji:null}function ki(a){return"{"===a?xi:"\x3c"===a?vi():'"'===a?yi:"!"===a?Wh:"_"===a?zi:null}
function hi(a,b,c){for(;;){var d=Ph(a);if(null==d)return r(b)?Th.d(a,J(["EOF while reading"],0)):c;if(!Sh(d))if(";"===d)a=Wh.a?Wh.a(a,d):Wh.call(null,a);else if(u){var e=Vh(d);if(r(e))e=e.a?e.a(a,d):e.call(null,a,d);else{var e=a,f=void 0;!(f=!/[^0-9]/.test(d))&&(f=void 0,f="+"===d||"-"===d)&&(f=Ph(e),Qh(e,f),f=!/[^0-9]/.test(f));if(f)a:{e=a;d=new ea(d);for(f=Ph(e);;){var h;h=null==f;h||(h=(h=Sh(f))?h:Vh.b?Vh.b(f):Vh.call(null,f));if(r(h)){Qh(e,f);f=d=d.toString();h=void 0;if(r(ai(Xh,f)))if(f=ai(Xh,
f),null!=f[2])h=0;else{h=r(f[3])?[f[3],10]:r(f[4])?[f[4],16]:r(f[5])?[f[5],8]:r(f[6])?[f[7],parseInt(f[6],10)]:u?[null,null]:null;var k=h[0];null==k?h=null:(h=parseInt(k,h[1]),h="-"===f[1]?-h:h)}else h=void 0,r(ai(Yh,f))?(f=ai(Yh,f),h=parseInt(f[1],10)/parseInt(f[2],10)):h=r(ai(Zh,f))?parseFloat(f):null;f=h;e=r(f)?f:Th.d(e,J(["Invalid number format [",d,"]"],0));break a}d.append(f);f=Ph(e)}e=void 0}else e=u?si(a,d):null}if(e!==a)return e}else return null}}
function Ai(a){if(Wb.a(3,O(a)))return a;if(3<O(a))return ad.c(a,0,3);if(u)for(a=new ea(a);;)if(3>a.Va.length)a=a.append("0");else return a.toString();else return null}var Bi=function(a,b){return function(c,d){return Q.a(r(d)?b:a,c)}}(new W(null,13,5,X,[null,31,28,31,30,31,30,31,31,30,31,30,31],null),new W(null,13,5,X,[null,31,29,31,30,31,30,31,31,30,31,30,31],null)),Ci=/(\d\d\d\d)(?:-(\d\d)(?:-(\d\d)(?:[T](\d\d)(?::(\d\d)(?::(\d\d)(?:[.](\d+))?)?)?)?)?)?(?:[Z]|([-+])(\d\d):(\d\d))?/;
function Di(a){a=parseInt(a,10);return sa(isNaN(a))?a:null}function Ei(a,b,c,d){a<=b&&b<=c||Th.d(null,J([""+A.b(d)+" Failed:  "+A.b(a)+"\x3c\x3d"+A.b(b)+"\x3c\x3d"+A.b(c)],0));return b}
function Fi(a){var b=sg(Ci,a);P.c(b,0,null);var c=P.c(b,1,null),d=P.c(b,2,null),e=P.c(b,3,null),f=P.c(b,4,null),h=P.c(b,5,null),k=P.c(b,6,null),l=P.c(b,7,null),n=P.c(b,8,null),q=P.c(b,9,null),t=P.c(b,10,null);if(sa(b))return Th.d(null,J(["Unrecognized date/time syntax: "+A.b(a)],0));a=Di(c);var b=function(){var a=Di(d);return r(a)?a:1}(),c=function(){var a=Di(e);return r(a)?a:1}(),v=function(){var a=Di(f);return r(a)?a:0}(),w=function(){var a=Di(h);return r(a)?a:0}(),y=function(){var a=Di(k);return r(a)?
a:0}(),B=function(){var a=Di(Ai(l));return r(a)?a:0}(),n=(Wb.a(n,"-")?-1:1)*(60*function(){var a=Di(q);return r(a)?a:0}()+function(){var a=Di(t);return r(a)?a:0}());return new W(null,8,5,X,[a,Ei(1,b,12,"timestamp month field must be in range 1..12"),Ei(1,c,Bi.a?Bi.a(b,0===(a%4+4)%4&&(0!==(a%100+100)%100||0===(a%400+400)%400)):Bi.call(null,b,0===(a%4+4)%4&&(0!==(a%100+100)%100||0===(a%400+400)%400)),"timestamp day field must be in range 1..last day in month"),Ei(0,v,23,"timestamp hour field must be in range 0..23"),
Ei(0,w,59,"timestamp minute field must be in range 0..59"),Ei(0,y,Wb.a(w,59)?60:59,"timestamp second field must be in range 0..60"),Ei(0,B,999,"timestamp millisecond field must be in range 0..999"),n],null)}
var Gi=Hg.b(new la(null,4,["inst",function(a){var b;if("string"===typeof a)if(b=Fi(a),r(b)){a=P.c(b,0,null);var c=P.c(b,1,null),d=P.c(b,2,null),e=P.c(b,3,null),f=P.c(b,4,null),h=P.c(b,5,null),k=P.c(b,6,null);b=P.c(b,7,null);b=new Date(Date.UTC(a,c-1,d,e,f,h,k)-6E4*b)}else b=Th.d(null,J(["Unrecognized date/time syntax: "+A.b(a)],0));else b=Th.d(null,J(["Instance literal expects a string for its timestamp."],0));return b},"uuid",function(a){return"string"===typeof a?new Tg(a):Th.d(null,J(["UUID literal expects a string as its representation."],
0))},"queue",function(a){return Hc(a)?Yd(Je,a):Th.d(null,J(["Queue literal expects a vector for its elements."],0))},"js",function(a){if(Hc(a)){var b=[];a=E(a);for(var c=null,d=0,e=0;;)if(e<d){var f=c.J(null,e);b.push(f);e+=1}else if(a=E(a))c=a,Ic(c)?(a=Hb(c),e=Ib(c),c=a,d=O(a),a=e):(a=F(c),b.push(a),a=I(c),c=null,d=0),e=0;else break;return b}if(Gc(a)){b={};a=E(a);c=null;for(e=d=0;;)if(e<d){var h=c.J(null,e),f=P.c(h,0,null),h=P.c(h,1,null);b[id(f)]=h;e+=1}else if(a=E(a))Ic(a)?(d=Hb(a),a=Ib(a),c=d,
d=O(d)):(d=F(a),c=P.c(d,0,null),d=P.c(d,1,null),b[id(c)]=d,a=I(a),c=null,d=0),e=0;else break;return b}return u?Th.d(null,J(["JS literal expects a vector or map containing only string or unqualified keyword keys"],0)):null}],null)),Hi=Hg.b(null);
function li(a,b){var c=si(a,b),d=Q.a(ab(Gi),""+A.b(c)),e=ab(Hi);return r(d)?d.b?d.b(hi(a,!0,null)):d.call(null,hi(a,!0,null)):r(e)?e.a?e.a(c,hi(a,!0,null)):e.call(null,c,hi(a,!0,null)):u?Th.d(a,J(["Could not find tag parser for ",""+A.b(c)," in ",Cg.d(J([Ve(ab(Gi))],0))],0)):null};p("mori.apply",S);p("mori.count",O);p("mori.distinct",function(a){return function c(a,e){return new V(null,function(){return function(a,d){for(;;){var e=a,l=P.c(e,0,null);if(e=E(e))if(Oc(d,l))l=G(e),e=d,a=l,d=e;else return M(l,c(G(e),pc.a(d,l)));else return null}}.call(null,a,e)},null,null)}(a,bg)});p("mori.empty",qc);p("mori.first",F);p("mori.rest",G);p("mori.seq",E);p("mori.conj",pc);p("mori.cons",M);
p("mori.find",function(a,b){return null!=a&&Ec(a)&&Oc(a,b)?new W(null,2,5,X,[b,Q.a(a,b)],null):null});p("mori.nth",P);p("mori.last",oc);p("mori.assoc",R);p("mori.dissoc",tc);p("mori.get_in",$d);p("mori.update_in",ae);p("mori.assoc_in",function Ii(b,c,d){var e=P.c(c,0,null);return(c=$c(c))?R.c(b,e,Ii(Q.a(b,e),c,d)):R.c(b,e,d)});p("mori.fnil",Jd);p("mori.disj",Ac);p("mori.pop",zc);p("mori.peek",yc);p("mori.hash",Tb);p("mori.get",Q);p("mori.has_key",Oc);p("mori.is_empty",Bc);p("mori.reverse",ed);
p("mori.take",Md);p("mori.drop",Nd);p("mori.take_nth",function Ji(b,c){return new V(null,function(){var d=E(c);return d?M(F(d),Ji(b,Nd(b,d))):null},null,null)});p("mori.partition",Zd);p("mori.partition_all",jg);p("mori.partition_by",function Ki(b,c){return new V(null,function(){var d=E(c);if(d){var e=F(d),f=b.b?b.b(e):b.call(null,e),e=M(e,lg(function(c,d){return function(c){return Wb.a(d,b.b?b.b(c):b.call(null,c))}}(e,f,d,d),I(d)));return M(e,Ki(b,E(Nd(O(e),d))))}return null},null,null)});
p("mori.iterate",function Li(b,c){return M(c,new V(null,function(){return Li(b,b.b?b.b(c):b.call(null,c))},null,null))});p("mori.into",Yd);p("mori.merge",Zf);p("mori.subvec",ze);p("mori.take_while",lg);p("mori.drop_while",function(a,b){return new V(null,function(c){return function(){return c(a,b)}}(function(a,b){for(;;){var e=E(b),f;f=(f=e)?a.b?a.b(F(e)):a.call(null,F(e)):f;if(r(f))f=a,e=G(e),a=f,b=e;else return e}}),null,null)});
p("mori.group_by",function(a,b){return C.c(function(b,d){var e=a.b?a.b(d):a.call(null,d);return R.c(b,e,pc.a(Q.c(b,e,qe),d))},Ye,b)});p("mori.interpose",function(a,b){return Nd(1,Qd.a(Od.b(a),b))});p("mori.interleave",Qd);p("mori.concat",td);p("mori.conj1",function(a,b){return a.G(null,b)});function Xd(a){return a instanceof Array||Fc(a)}p("mori.flatten",function(a){return Ud(function(a){return!Xd(a)},G(Wd(a)))});p("mori.lazy_seq",function(a){return new V(null,a,null,null)});p("mori.keys",Ve);
p("mori.select_keys",function(a,b){for(var c=Ye,d=E(b);;)if(d)var e=F(d),f=Q.c(a,e,ih),c=Bd.a(f,ih)?R.c(c,e,f):c,d=I(d);else return c});p("mori.vals",We);p("mori.prim_seq",mc);p("mori.map",Kd);p("mori.mapcat",Sd);p("mori.reduce",C);p("mori.reduce_kv",function(a,b,c){return null!=c?hb(c,a,b):b});p("mori.filter",Ud);p("mori.remove",Vd);p("mori.some",Ed);p("mori.every",Dd);p("mori.equals",Wb);p("mori.range",pg);p("mori.repeat",Od);p("mori.repeatedly",Pd);p("mori.sort",Sc);p("mori.sort_by",Tc);
p("mori.into_array",xa);p("mori.subseq",ng);p("mori.rmap",th);p("mori.rfilter",uh);p("mori.rremove",wh);p("mori.rtake",yh);p("mori.rtake_while",xh);p("mori.rdrop",zh);p("mori.rflatten",vh);p("mori.list",fd);p("mori.vector",xe);p("mori.array_map",Uf);p("mori.hash_map",Tf);p("mori.set",eg);p("mori.sorted_set",fg);p("mori.sorted_set_by",gg);p("mori.sorted_map",Vf);p("mori.sorted_map_by",Wf);
p("mori.queue",function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){return Yd.a?Yd.a(Je,a):Yd.call(null,Je,a)}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}());p("mori.keyword",jd);p("mori.symbol",$b);p("mori.zipmap",function(a,b){for(var c=yb(Ye),d=E(a),e=E(b);;)if(d&&e)c=xd.c(c,F(d),F(e)),d=I(d),e=I(e);else return Ab(c)});
p("mori.is_list",function(a){return a?a.i&33554432||a.Ec?!0:a.i?!1:s(nb,a):s(nb,a)});p("mori.is_seq",Mc);p("mori.is_vector",Hc);p("mori.is_map",Gc);p("mori.is_set",Dc);p("mori.is_keyword",function(a){return a instanceof T});p("mori.is_symbol",function(a){return a instanceof Zb});p("mori.is_collection",Cc);p("mori.is_sequential",Fc);p("mori.is_associative",Ec);p("mori.is_counted",ic);p("mori.is_indexed",jc);p("mori.is_reduceable",function(a){return a?a.i&524288||a.Nb?!0:a.i?!1:s(fb,a):s(fb,a)});
p("mori.is_seqable",function(a){return a?a.i&8388608||a.hc?!0:a.i?!1:s(kb,a):s(kb,a)});p("mori.is_reversible",dd);p("mori.union",Dh);p("mori.intersection",Eh);p("mori.difference",Fh);p("mori.is_subset",function(a,b){return O(a)<=O(b)&&Dd(function(a){return Oc(b,a)},a)});p("mori.is_superset",function(a,b){return O(a)>=O(b)&&Dd(function(b){return Oc(a,b)},b)});p("mori.partial",Id);p("mori.comp",Hd);
p("mori.pipeline",function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){return C.a?C.a(function(a,b){return b.b?b.b(a):b.call(null,a)},a):C.call(null,function(a,b){return b.b?b.b(a):b.call(null,a)},a)}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}());
p("mori.curry",function(){function a(a,d){var e=null;1<arguments.length&&(e=J(Array.prototype.slice.call(arguments,1),0));return b.call(this,a,e)}function b(a,b){return function(e){return S.a(a,M.a?M.a(e,b):M.call(null,e,b))}}a.k=1;a.f=function(a){var d=F(a);a=G(a);return b(d,a)};a.d=b;return a}());
p("mori.juxt",function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){return function(){function b(a){var c=null;0<arguments.length&&(c=J(Array.prototype.slice.call(arguments,0),0));return e.call(this,c)}function e(b){return xa.b?xa.b(Kd.a?Kd.a(function(a){return S.a(a,b)},a):Kd.call(null,function(a){return S.a(a,b)},a)):xa.call(null,Kd.a?Kd.a(function(a){return S.a(a,b)},a):Kd.call(null,function(a){return S.a(a,
b)},a))}b.k=0;b.f=function(a){a=E(a);return e(a)};b.d=e;return b}()}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}());
p("mori.knit",function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){return function(b){return xa.b?xa.b(Kd.c?Kd.c(function(a,b){return a.b?a.b(b):a.call(null,b)},a,b):Kd.call(null,function(a,b){return a.b?a.b(b):a.call(null,b)},a,b)):xa.call(null,Kd.c?Kd.c(function(a,b){return a.b?a.b(b):a.call(null,b)},a,b):Kd.call(null,function(a,b){return a.b?a.b(b):a.call(null,b)},a,b))}}a.k=0;a.f=function(a){a=E(a);return b(a)};
a.d=b;return a}());p("mori.diff",Jh);p("mori.sum",function(a,b){return a+b});p("mori.inc",function(a){return a+1});p("mori.dec",function(a){return a-1});p("mori.is_even",function(a){return 0===(a%2+2)%2});p("mori.is_odd",function(a){return 1===(a%2+2)%2});p("mori.each",function(a,b){for(var c=E(a),d=null,e=0,f=0;;)if(f<e){var h=d.J(null,f);b.b?b.b(h):b.call(null,h);f+=1}else if(c=E(c))d=c,Ic(d)?(c=Hb(d),e=Ib(d),d=c,h=O(c),c=e,e=h):(h=F(d),b.b?b.b(h):b.call(null,h),c=I(d),d=null,e=0),f=0;else return null});
p("mori.identity",Fd);p("mori.constantly",function(a){return function(){function b(b){0<arguments.length&&J(Array.prototype.slice.call(arguments,0),0);return a}b.k=0;b.f=function(b){E(b);return a};b.d=function(){return a};return b}()});p("mori.clj_to_js",Ng);
p("mori.js_to_clj",function(){function a(a,b){return Sg.d(a,J([Rg,b],0))}function b(a){return Sg.b(a)}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}());p("mori.parse",function(a){return hi(new Rh(a,[],-1),!1,null)});
p("mori.configure",function(a,b){switch(a){case "print-length":return ia=b;case "print-level":return ja=b;default:throw Error("No matching clause: "+A.b(a));}});
p("mori.proxy",function(a){if("undefined"!==typeof Proxy)return Proxy.create(function(){return{has:function(b){return Oc(a,b)},hasOwn:function(b){return Oc(a,b)},get:function(b,c){var d=Q.c?Q.c(a,c,hh):Q.call(null,a,c,hh);return hd(d,hh)?ic(a)&&"length"===c?O.b?O.b(a):O.call(null,a):null:u?d:null},set:function(){return null},enumerate:function(){return xa.b?xa.b(Ve.b?Ve.b(a):Ve.call(null,a)):xa.call(null,Ve.b?Ve.b(a):Ve.call(null,a))},keys:function(){return Gc(a)?xa.b?xa.b(Ve.b?Ve.b(a):Ve.call(null,
a)):xa.call(null,Ve.b?Ve.b(a):Ve.call(null,a)):Hc(a)?xa.b?xa.b(pg.b?pg.b(O.b?O.b(a):O.call(null,a)):pg.call(null,O.b?O.b(a):O.call(null,a))):xa.call(null,pg.b?pg.b(O.b?O.b(a):O.call(null,a)):pg.call(null,O.b?O.b(a):O.call(null,a))):null}}}());throw Error("ES6 Proxy not supported!");});V.prototype.inspect=function(){return this.toString()};ac.prototype.inspect=function(){return this.toString()};kc.prototype.inspect=function(){return this.toString()};Bf.prototype.inspect=function(){return this.toString()};
vf.prototype.inspect=function(){return this.toString()};wf.prototype.inspect=function(){return this.toString()};bd.prototype.inspect=function(){return this.toString()};gd.prototype.inspect=function(){return this.toString()};cd.prototype.inspect=function(){return this.toString()};W.prototype.inspect=function(){return this.toString()};od.prototype.inspect=function(){return this.toString()};ye.prototype.inspect=function(){return this.toString()};Ae.prototype.inspect=function(){return this.toString()};
$.prototype.inspect=function(){return this.toString()};Y.prototype.inspect=function(){return this.toString()};la.prototype.inspect=function(){return this.toString()};xf.prototype.inspect=function(){return this.toString()};Qf.prototype.inspect=function(){return this.toString()};$f.prototype.inspect=function(){return this.toString()};cg.prototype.inspect=function(){return this.toString()};og.prototype.inspect=function(){return this.toString()};T.prototype.inspect=function(){return this.toString()};
Zb.prototype.inspect=function(){return this.toString()};Ie.prototype.inspect=function(){return this.toString()};He.prototype.inspect=function(){return this.toString()};p("mori._equiv",function(a,b){return a.Hc(b)});p("mori._keys",function(a){return a.keys()});p("mori._values",function(a){return a.values()});p("mori._entries",function(a){return a.entries()});p("mori._has",function(a){return a.has()});p("mori._get",function(a){return a.get()});p("mori._forEach",function(a){return a.forEach()});
p("mori._next",function(a){return a.next()});p("mori.mutable.thaw",function(a){return yb(a)});p("mori.mutable.freeze",vd);p("mori.mutable.conj1",function(a,b){return a.Ka(null,b)});p("mori.mutable.conj",wd);p("mori.mutable.assoc",xd);p("mori.mutable.dissoc",yd);p("mori.mutable.pop",function(a){return Eb(a)});p("mori.mutable.disj",zd);function Mi(a,b,c,d){return N(new W(null,2,5,X,[d,null],null),new la(null,3,[$g,c,Xg,b,Vg,a],null))}function Ni(a){return a.b?a.b(0):a.call(null,0)}function Oi(a){return Vg.b(xc(a)).call(null,Ni(a))}function Pi(a){if(r(Oi(a)))return Xg.b(xc(a)).call(null,Ni(a));throw"called children on a leaf node";}function Qi(a,b,c){return $g.b(xc(a)).call(null,b,c)}
function Ri(a){if(r(Oi(a))){var b=P.c(a,0,null),c=P.c(a,1,null),d=Pi(a),e=P.c(d,0,null),f=$c(d);return r(d)?N(new W(null,2,5,X,[e,new la(null,4,[Zg,qe,ah,r(c)?pc.a(ah.b(c),b):new W(null,1,5,X,[b],null),Ug,c,Wg,f],null)],null),xc(a)):null}return null}
function Si(a){var b=P.c(a,0,null),c=P.c(a,1,null),d=Mc(c)?S.a(Tf,c):c,c=Q.a(d,Zg),e=Q.a(d,Ug),f=Q.a(d,ah),h=Q.a(d,Wg),d=Q.a(d,bh);return r(f)?(f=yc(f),N(r(d)?new W(null,2,5,X,[Qi(a,f,td.a(c,M(b,h))),r(e)?R.c(e,bh,!0):e],null):new W(null,2,5,X,[f,e],null),xc(a))):null}function Ti(a){var b=P.c(a,0,null),c=P.c(a,1,null),c=Mc(c)?S.a(Tf,c):c,d=Q.a(c,Zg),e=Q.a(c,Wg),f=P.c(e,0,null),h=$c(e);return r(r(c)?e:c)?N(new W(null,2,5,X,[f,R.d(c,Zg,pc.a(d,b),J([Wg,h],0))],null),xc(a)):null}
function Ui(a){var b=P.c(a,0,null),c=P.c(a,1,null),c=Mc(c)?S.a(Tf,c):c,d=Q.a(c,Zg),e=Q.a(c,Wg);return r(r(c)?e:c)?N(new W(null,2,5,X,[oc(e),R.d(c,Zg,S.n(pc,d,b,hg(e)),J([Wg,null],0))],null),xc(a)):a}function Vi(a){var b=P.c(a,0,null),c=P.c(a,1,null),c=Mc(c)?S.a(Tf,c):c,d=Q.a(c,Zg),e=Q.a(c,Wg);return r(r(c)?E(d):c)?N(new W(null,2,5,X,[yc(d),R.d(c,Zg,zc(d),J([Wg,M(b,e)],0))],null),xc(a)):null}
function Wi(a,b){P.c(a,0,null);var c=P.c(a,1,null);return N(new W(null,2,5,X,[b,R.c(c,bh,!0)],null),xc(a))}var Xi=function(){function a(a,d,e){var f=null;2<arguments.length&&(f=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,a,d,f)}function b(a,b,e){return Wi(a,S.c(b,Ni(a),e))}a.k=2;a.f=function(a){var d=F(a);a=I(a);var e=F(a);a=G(a);return b(d,e,a)};a.d=b;return a}();p("mori.zip.zipper",Mi);p("mori.zip.seq_zip",function(a){return Mi(Mc,Fd,function(a,c){return N(c,xc(a))},a)});p("mori.zip.vector_zip",function(a){return Mi(Hc,E,function(a,c){return N(we(c),xc(a))},a)});p("mori.zip.node",Ni);p("mori.zip.is_branch",{}.xc);p("mori.zip.children",Pi);p("mori.zip.make_node",Qi);p("mori.zip.path",function(a){return ah.b(a.b?a.b(1):a.call(null,1))});p("mori.zip.lefts",function(a){return E(Zg.b(a.b?a.b(1):a.call(null,1)))});
p("mori.zip.rights",function(a){return Wg.b(a.b?a.b(1):a.call(null,1))});p("mori.zip.down",Ri);p("mori.zip.up",Si);p("mori.zip.root",function(a){for(;;){if(Wb.a(eh,a.b?a.b(1):a.call(null,1)))return Ni(a);var b=Si(a);if(r(b))a=b;else return Ni(a)}});p("mori.zip.right",Ti);p("mori.zip.rightmost",Ui);p("mori.zip.left",Vi);
p("mori.zip.leftmost",function(a){var b=P.c(a,0,null),c=P.c(a,1,null),c=Mc(c)?S.a(Tf,c):c,d=Q.a(c,Zg),e=Q.a(c,Wg);return r(r(c)?E(d):c)?N(new W(null,2,5,X,[F(d),R.d(c,Zg,qe,J([Wg,td.d(G(d),new W(null,1,5,X,[b],null),J([e],0))],0))],null),xc(a)):a});p("mori.zip.insert_left",function(a,b){var c=P.c(a,0,null),d=P.c(a,1,null),d=Mc(d)?S.a(Tf,d):d,e=Q.a(d,Zg);if(null==d)throw"Insert at top";return N(new W(null,2,5,X,[c,R.d(d,Zg,pc.a(e,b),J([bh,!0],0))],null),xc(a))});
p("mori.zip.insert_right",function(a,b){var c=P.c(a,0,null),d=P.c(a,1,null),d=Mc(d)?S.a(Tf,d):d,e=Q.a(d,Wg);if(null==d)throw"Insert at top";return N(new W(null,2,5,X,[c,R.d(d,Wg,M(b,e),J([bh,!0],0))],null),xc(a))});p("mori.zip.replace",Wi);p("mori.zip.edit",Xi);p("mori.zip.insert_child",function(a,b){return Wi(a,Qi(a,Ni(a),M(b,Pi(a))))});p("mori.zip.append_child",function(a,b){return Wi(a,Qi(a,Ni(a),td.a(Pi(a),new W(null,1,5,X,[b],null))))});
p("mori.zip.next",function(a){if(Wb.a(eh,a.b?a.b(1):a.call(null,1)))return a;var b;b=Oi(a);b=r(b)?Ri(a):b;if(r(b))return b;b=Ti(a);if(r(b))return b;for(;;)if(r(Si(a))){b=Ti(Si(a));if(r(b))return b;a=Si(a)}else return new W(null,2,5,X,[Ni(a),eh],null)});p("mori.zip.prev",function(a){var b=Vi(a);if(r(b))for(a=b;;)if(b=Oi(a),b=r(b)?Ri(a):b,r(b))a=Ui(b);else return a;else return Si(a)});p("mori.zip.is_end",function(a){return Wb.a(eh,a.b?a.b(1):a.call(null,1))});
p("mori.zip.remove",function(a){P.c(a,0,null);var b=P.c(a,1,null),b=Mc(b)?S.a(Tf,b):b,c=Q.a(b,Zg),d=Q.a(b,Ug),e=Q.a(b,ah),f=Q.a(b,Wg);if(null==b)throw"Remove at top";if(0<O(c))for(a=N(new W(null,2,5,X,[yc(c),R.d(b,Zg,zc(c),J([bh,!0],0))],null),xc(a));;)if(b=Oi(a),b=r(b)?Ri(a):b,r(b))a=Ui(b);else return a;else return N(new W(null,2,5,X,[Qi(a,yc(e),f),r(d)?R.c(d,bh,!0):d],null),xc(a))});;return this.mori;}.call({});});

},{}],12:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options
) {

  /**
   * A Sequencer which advances by reading from a Clock.
   * Note that this ClockSequencer relies on the Clock protocol, which
   * only provides `Clock#getTime()`. It does not modify the clock itself.
   * This means if you're using a LogicalClock, it's still up to the clock's
   * owner to advance the clock for the sequencer to advance.
   */
  var ClockSequencer = function() {
    this.initialize.apply(this, arguments);
  }

  _.extend(ClockSequencer.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);

      this._clock    = opts.getOrError("clock");
      this._sequence = opts.getOrElse("initialSequence", 0);
    },

    /**
     * Advances by setting its sequence to the backing clock's time.
     * Note that if this method is called twice within the same time unit,
     * the sequence will not actually advance, since unique time is not
     * guaranteed by our clocks.
     *
     * @async
     * @returns {Promise<>}
     */
    advance: Promise.method(function() {
      return Promise
        .bind(this)
        .then(function() {
          return this._clock.getTime();
        })
        .then(function(t) {
          this._sequence = t;
        });
    }),

    /**
     * Returns the current sequence. This value should always be the same
     * or greater than a value returned previously (in time).
     *
     * @returns {number} the current sequence
     */
    value: function() {
      return this._sequence;
    }
  });

  return ClockSequencer;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../options")
);

})()
},{"../options":8,"underscore":57,"bluebird":58}],13:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options
) {

  /**
   * A UnitSequencer which reports its sequence summed with the sequences
   * of its internal collection of sequencers.
   *
   * This device is useful for tracking the state of data comprised from multiple
   * sources. For instance, you might have CachingDataStore(A) storing data
   * from Source(A), tracked by Sequencer(A), and CachingDataStore(B) storing
   * data from Source(B), tracked by Sequencer(B). Meanwhile, you may have
   * CachingDataStore(C), storing data from Source(A + B), and tracked by
   * Sequencer(C) = Sequencer(A + B) - a DelegatingCompositeSequencer.
   *
   * Thus, if Sequencer(A) is advanced, it may invalidate CachingDataStore(A) or
   * CachingDataStore(C) or both.
   *
   * Note this particular usage is generally only useful for Unit sequencers.
   *
   * If you'd like the above functionality, but with Sequencer(A) and
   * Sequencer(B) as ClockSequencers, and Sequencer(C) merely tracking
   * modification, you'd need to use a DelegatingForwardingSequencer for A and B,
   * forwarding them to UnitSequencer(C).
   *
   * DelegatingCompositeSequencer and DelegatingForwardingSequencer are effectivly
   * opposites of each other. DelegatingCompositeSequencer composes the `value`
   * of multiple underlying sequencers (pull), and DelegatingForwardingSequencer
   * forwards the `advance` call to multiple targets (push).
   */
  var DelegatingCompositeSequencer = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(DelegatingCompositeSequencer.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._delegateSequencer = opts.getOrError("delegate");
      this._sequencers = _.clone(opts.getOrElse("sequencers", []));
    },
    addSequencer: function(seq) {
      this._sequencers.push(seq);
    },
    advance: function() {
      var s = this._delegateSequencer;
      return s.advance.apply(s, arguments);
    },
    value: function() {
      return _
        .chain(this._sequencers)
        .invoke("value")
        .reduce(function(sum, n) {
          return sum + n;
        }, 0)
        .value() + this._delegateSequencer.value();
    }
  });

  return DelegatingCompositeSequencer;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../options")
);

})()
},{"../options":8,"underscore":57,"bluebird":58}],14:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options
) {

  var UnitSequencer = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(UnitSequencer.prototype, {
    initialize: function(opts) {
      opts           = Options.fromObject(opts);
      this._sequence = opts.getOrElse("initialSequence", 0);
    },

    /**
     * Advances its sequence by `by`, or by `1` if `by` is not provided.
     *
     * @param by {number} the amount to advance by. Defaults to `1`.
     * @async
     * @returns {Promise<undefined>}
     */
    advance: Promise.method(function(by) {
      // Wahh wahh - don't use `by || 1`, or you can't advance by 0, which is silly
      // but potentially necessary.
      by             = _.isUndefined(by) ? 1 : by;

      if (by < 0) {
        throw new Error("UnitSequencer#advance() requires positive `by` offset");
      }

      this._sequence = this._sequence + by;
    }),

    /**
     * Returns the current sequence. This value should always be the same
     * or greater than a value returned previously (in time).
     *
     * @returns {number} the current sequence
     */
    value: function() {
      return this._sequence;
    }
  });

  return UnitSequencer;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../options")
);

})()
},{"../options":8,"bluebird":58,"underscore":57}],15:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options
) {

  var DelegatingForwardingSequencer = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(DelegatingForwardingSequencer.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._delegateSequencer = opts.getOrError("delegate");
      this._forwardTargets = _.clone(opts.getOrElse("targets", []));
    },
    addTarget: function(seq) {
      this._forwardTargets.push(seq);
    },
    advance: Promise.method(function() {
      var s = this._delegateSequencer;
      return s.advance.apply(s, arguments)
      .bind(this)
      .then(function(val) {
        return Promise
          .all(_.invoke(this._forwardTargets, "advance"))
          .then(function() {
            // Return the value returned by the delegate sequencer's
            // advance call (if any). The advancement of the forward
            // targets should be transparent.
            return val;
          });
      });
    }),
    value: function() {
      var s = this._delegateSequencer;
      return s.value.apply(s, arguments);
    }
  });

  return DelegatingForwardingSequencer;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../options")
);

})()
},{"../options":8,"underscore":57,"bluebird":58}],23:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options
) {
  /**
   * A Clock which allows manually manipulating the underlying time value,
   * irrespective of real time. Useful for testing.
   */
  var LogicalClock = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(LogicalClock.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._currentTime = opts.getOrElse("initialTime", 0);
    },

    /**
     * @async
     * @returns {Promise<number>} Time in milliseconds since epoch
     * @see Clock#getTime()
     */
    getTime: Promise.method(function() {
      return this._currentTime;
    }),

    /**
     * Advances internal time, either `opts.by` a certain offset, or
     * `opts.to` a particular absolute time. If successful, returns the result
     * of calling `LogicalClock#getTime()` as a convenience.
     *
     * @param opts.to {number} absolute time to set clock to. Must be larger
     *                         than the current time
     * @param opts.by {number} offset to add to current time. Must be positive.
     *                         Defaults to `1` if neither `opts.to` or `opts.by`
     *                         are specified.
     * @async
     * @returns {Promise<number>} result of `LogicalClock#getTime()`
     */
    advanceTime: Promise.method(function(opts){
      opts = Options.fromObject(opts);
      var by = opts.getOrElse("by", 1),
          to = opts.getOrElse("to", undefined);
      if (!_.isUndefined(to)) {
        if (to < this._currentTime) {
          throw new Error("LogicalClock#advanceTime() requires forward movement of time")
        }
        this._currentTime = to;
      } else {
        if (by < 0) {
          throw new Error("LogicalClock#advanceTime() requires forward movement of time");
        }
        this._currentTime = this._currentTime + by;
      }
      return this.getTime();
    })
  });

  return LogicalClock;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../../core/options")
);

})()
},{"../../core/options":8,"bluebird":58,"underscore":57}],24:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise
) {

  /**
   * A Clock which delegates to the system clock.
   */
  var SystemClock = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(SystemClock.prototype, {
    initialize: function() {},
    /**
     * @async
     * @returns {Promise<number>} Time in milliseconds since epoch
     * @see Clock#getTime()
     */
    getTime: Promise.method(function() {
      return Date.now();
    })
  });

  return SystemClock;
};

module.exports = mod(
  require("underscore"),
  require("bluebird")
);

})()
},{"underscore":57,"bluebird":58}],26:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  ScopedConfiguration
) {

  /**
   * A device for resolving a set of raw configurations given a set of
   * scopes.
   *
   * This is useful for having things like region- or stage-specific (and/or both)
   * configurations.
   *
   * Given sets of raw configurations of the form:
   *
   *   {
   *     "scope-1" : {
   *       "key1" : "val1"
   *     },
   *     "scope-1+env1": {
   *       "key2" : "val-env-1"
   *     },
   *     "scope-1+env2": {
   *       "key2" : "val-env-2"
   *     }
   *   }
   *
   * `resolve(["scope-1"])` will return:
   *
   *   {
   *     "key1" : "val2"
   *   }
   *
   * `resolve(["scope-1", "env-1"])` will return:
   *
   *   {
   *     "key1" : "val1",
   *     "key2" : "val-env-1"
   *   }
   *
   * `resolve(["scope-1", "env-2"])` will return:
   *
   *   {
   *     "key1" : "val1",
   *     "key2" : "val-env-2"
   *   }
   *
   * Scopes unions are resolved in the following manner:
   *   1. a given scope union's parts are sorted
   *   2. scope unions as a whole are applied in sorted order
   *   3. repeat the process for a given configuration
   *
   * So, given three configs:
   *
   *  {
   *    "aaa": ... // 1
   *    "ccc": ... // 2
   *  }
   *
   *  {
   *    "aaa+ccc": ... // 3
   *    "ccc"    : ... // 4
   *  }
   *
   *  {
   *    "aaa+bbb": ... // 5
   *    "bbb"    : ... // 6
   *  }
   *
   * The resulting order will be:
   *   1, 2, 4, 3, 6, 5
   *
   * Notice 3 comes before 5 even though it's logically "after" in sorted order,
   * because configuration order overrides scope order. That is, scope unions
   * are ordered within a config, and then in config order.
   *
   */
  var ScopedConfigurationResolver = function() {
    this.initialize.apply(this, arguments);
  }

  _.extend(ScopedConfigurationResolver.prototype, {
    initialize: function() {
      this._configs = [];
    },

    /**
     * A rawConfig is a set of configuration scopes and their configuration
     * values, e.g.:
     *
     *   {
     *     "scope-1" : {
     *       "key1" : "val1"
     *     },
     *     "scope-1+env1": {
     *       "key2" : "val-env-1"
     *     },
     *     "scope-1+env2": {
     *       "key2" : "val-env-2"
     *     }
     *   }
     *
     * Note that the plus (+) sign is reserved for specifying scope unions.
     *
     * @param rawConfig {object} (required)
     *
     * @returns this
     */
    add: function(rawConfig) {
      this._configs.push(new ScopedConfiguration(rawConfig));
      return this;
    },

    /**
     * Resolves a computed final configuration given a set of scopes to apply,
     * and a set of configs loaded via `ScopedConfigurationResolver#add()`.
     *
     * @param scopes {Array<string>}
     *
     * @returns {object} the computed configuration
     */
    resolve: function(scopes) {
      scopes = powerset(_.clone(scopes).sort());
      scopes.shift(); // Get rid of the empty set.

      scopes = _.collect(scopes, function(s) {
        return s.join("+");
      });

      var relevantConfigs = _
        .chain(this._configs)
        .collect(function(c) {
          return _.collect(scopes, function(scope) {
            return c.blobForScope(scope);
          })
        }).flatten().value();

      relevantConfigs.unshift({});
      return _.extend.apply(_, relevantConfigs);
    }
  });

  var powerset = function (ary) {
      var ps = [[]];
      for (var i=0; i < ary.length; i++) {
          for (var j = 0, len = ps.length; j < len; j++) {
              ps.push(ps[j].concat(ary[i]));
          }
      }
      return ps;
  }

  return ScopedConfigurationResolver;
};

module.exports = mod(
  require("underscore"),
  require("./scoped-configuration")
);

})()
},{"./scoped-configuration":27,"underscore":57}],27:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _
) {

  /**
   * Given a raw config, ensures blobs can be fetched regardless of
   * scope union scope (i.e., does union canonicalization).
   *
   * For example, a config with scope union `"bbb+aaa"` can later be
   * fetched using either `"aaa+bbb"` or `"bbb+aaa"`. It does this
   * by uniformly ordering the union's composite scopes.
   *
   * This probably isn't a useful class on its own. Instead, defer to
   * `ScopedConfigurationResolver` or `ConfigurationMagic`.
   */
  var ScopedConfiguration = function() {
    this.initialize.apply(this, arguments);
  }

  _.extend(ScopedConfiguration.prototype, {
    initialize: function(rawConfig) {
      rawConfig = rawConfig || {};
      this._scopes = {};
      // Sort the scope strings
      _.each(rawConfig, function(config, scopeString) {
        var scope = scopeString.split("+").sort().join("+");
        this._scopes[scope] = config;
      }, this);
    },

    blobForScope: function(scope) {
      return _.clone(this._scopes[scope.split("+").sort().join("+")] || {});
    }
  });

  return ScopedConfiguration;
};

module.exports = mod(
  require("underscore")
);

})()
},{"underscore":57}],29:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Ref,
  Options
) {

  var Logger = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Logger.prototype, {

    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._name         = opts.getOrElse("name", "Default");
      this._logLevel     = opts.getOrElse("logLevel", LogUtil.Level.Info);
      this._parent       = opts.getOrElseFn("refParent", function() { return Ref(null) });

      this._appenders = [];
    },

    trace: function() {
      this._log(LogUtil.Level.Trace, _.toArray(arguments));
    },

    debug: function() {
      this._log(LogUtil.Level.Debug, _.toArray(arguments));
    },

    info: function() {
      this._log(LogUtil.Level.Info, _.toArray(arguments));
    },

    warn: function() {
      this._log(LogUtil.Level.Warn, _.toArray(arguments));
    },

    error: function() {
      this._log(LogUtil.Level.Error, _.toArray(arguments));
    },

    fatal: function() {
      this._log(LogUtil.Level.Fatal, _.toArray(arguments));
    },

    isTraceEnabled: function() {
      return this.isLogLevelEnabled(LogUtil.Level.Trace);
    },

    isDebugEnabled: function() {
      return this.isLogLevelEnabled(LogUtil.Level.Debug);
    },

    isInfoEnabled: function() {
      return this.isLogLevelEnabled(LogUtil.Level.Info);
    },

    isWarnEnabled: function() {
      return this.isLogLevelEnabled(LogUtil.Level.Warn);
    },

    isErrorEnabled: function() {
      return this.isLogLevelEnabled(LogUtil.Level.Error);
    },

    isFatalEnabled: function() {
      return this.isLogLevelEnabled(LogUtil.Level.Fatal);
    },

    isLogLevelEnabled: function(logLevel) {
      var coercedLogLevel = b(logLevel);
      return (this._logLevel & coercedLogLevel) === coercedLogLevel;
    },

    addAppender: function(appender) {
      this._appenders.push(appender);
    },

    setLogLevel: function(logLevel) {
      // Save a copy for the potential error message
      var originalLogLevel = logLevel;

      // If name is specified, e.g., "Info", convert to
      // int
      if (_.isString(logLevel)) {
        logLevel = LogUtil.Level[logLevel]
      }

      var exists = _.detect(LogUtil.Level, function(level, name) {
        return level === logLevel;
      });

      if (!exists) {
        throw new Error("Invalid logLevel: " + originalLogLevel);
      }

      this._logLevel = logLevel;
    },


    _log: function(logLevel, logArgs) {
      this._logWithMetadata([], logLevel, logArgs);
    },

    _logWithMetadata: function(descendants, logLevel, args) {
      if (this.isLogLevelEnabled(logLevel)) {
        _.each(this._appenders, function(appender) {
          appender.log(this._name, descendants, logLevel, LogUtil._Label[logLevel], args);
        }, this);
      }

      if (this._parent.get()) {
        this._parent.get()._logWithMetadata([this._name].concat(descendants), logLevel, args);
      }
    }
  });

  var LogUtil = function() {
    this.initialize.apply(this, arguments);
  };

  // Coerce (just use rightmost 8 bits)!; because JS is dumb, and everything is
  // actually a float with 53-bit precision
  var b = function(v) {
    return 0xFF & v;
  };

  _.extend(LogUtil, {
    Level: {
      Trace: b(parseInt("111111", 2)),
      Debug: b(parseInt("011111", 2)),
      Info:  b(parseInt("001111", 2)),
      Warn:  b(parseInt("000111", 2)),
      Error: b(parseInt("000011", 2)),
      Fatal: b(parseInt("000001", 2))
    }
  });

  _.extend(LogUtil.prototype, {
    Level: LogUtil.Level,
    initialize: function() {
      this._rootLogger = Ref(new Logger({
        name: "Root"
      }));
    },

    create: function(name, opts) {
      opts = _.clone(opts || {});

      var parent;
      if (opts.parent) {
        parent = Ref(opts.parent);
        delete(opts.parent);
      } else {
        parent = Ref.delegating(this._rootLogger);
      }

      opts.refParent = parent;

      opts.name = name;

      return new Logger(opts);
    },

    root: function() {
      return this._rootLogger.get();
    },

    resetRootLogger: function() {
      this._rootLogger.set(new Logger({
        name: "Root"
      }));
    }
  });


  LogUtil._Label = _.reduce(LogUtil.Level, function(memo, val, key) {
    memo[val] = key;
    return memo;
  }, {});

  return new LogUtil();
};

module.exports = mod(
  require("underscore"),
  require("../ref"),
  require("../options")
);

})()
},{"../options":8,"../ref":43,"underscore":57}],31:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  M,
  UUID,
  Options,
  StateGuard
) {

  var Channel = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Channel.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);

      this._sentinel      = opts.getOrError("sentinel");
      this._stateGuard    = new StateGuard(["disposed"]);
      this._subscriptions = M.hash_map();
    },

    reset: function() {
      M.each(this._subscriptions, function(pair) {
        M.nth(pair, 1).dispose();
      });
      this._subscriptions = M.hash_map();
    },

    publish: function(sentinel, msg) {
      return this._publish.apply(this, arguments);
    },


    subscribe: function(handler) {
      return this._subscribe.apply(this, arguments);
    },


    dispose: function() {
      return this._dispose.apply(this, arguments);
    },


    isDisposed: function() {
      return this._stateGuard.applied("disposed");
    },


    _publish: function(sentinel, msg) {
      this._stateGuard.deny("disposed");

      if (this._sentinel !== sentinel) {
        throw new Error("Invalid sentinel provided; publisher must have same sentinel provided during instantiation.");
      }
      this._dispatch(msg);
      return true;
    },


    _subscribe: function(handler) {
      this._stateGuard.deny("disposed");

      var sub = new Subscription(this, handler),
          id  = sub.id();

      this._subscriptions = M.assoc(this._subscriptions, id, sub);

      return sub;
    },


    _dispose: function() {
      if (this._stateGuard.applied("disposed")) {
        return;
      }

      // Gnarly, as this hops back and forth between the channel and the sub, but
      // easier than splitting the dispose logic into two methods in the sub.
      M.each(this._subscriptions, function(pair) {
        M.nth(pair, 1).dispose();
      });

      this._subscriptions = M.hash_map();

      this._stateGuard.apply("disposed");
    },


    _dispatch: function(msg) {
      M.each(this._subscriptions, function(pair) {
        M.nth(pair, 1).dispatch(msg);
      });
    },


    _disposeHandle: function(id) {
      this._subscriptions = M.dissoc(this._subscriptions, id);
    }
  });

  var Subscription = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Subscription.prototype, {
    initialize: function(channel, handler) {
      this._id         = UUID.v4();
      this._channel    = channel;
      this._handler    = handler;
      this._stateGuard = new StateGuard(["disposed"]);

      _.bindAll(this, "dispose");
    },


    dispose: function() {
      if (this._stateGuard.applied("disposed")) {
        return;
      }

      this._channel._disposeHandle(this._id);

      this._handler = null;
      this._channel = null;

      this._stateGuard.apply("disposed");
    },


    id: function() {
      return this._id;
    },


    dispatch: function(msg) {
      if (this._stateGuard.applied("disposed")) {
        return;
      }

      this._handler(msg);
    }
  });

  return Channel;
};

module.exports = mod(
  require("underscore"),
  require("mori"),
  require("../uuid"),
  require("../options"),
  require("../state-guard")
);

})()
},{"../options":8,"../state-guard":9,"../uuid":38,"underscore":57,"mori":59}],32:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  M,
  Options,
  Channel
) {

  var ChainedChannel = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(ChainedChannel.prototype, Channel.prototype, {
    initialize: function(opts) {
      Channel.prototype.initialize.apply(this, arguments);
      opts = Options.fromObject(opts);

      _.bindAll(this, "_forward");
      this._chainedSubs = M.vector();

      var initiallyChainedTo = opts.getOrElse("chainTo");
      if (initiallyChainedTo) {
        this.chainTo(initiallyChainedTo);
      }
    },

    chainTo: function(otherChannel) {
      this._chainedSubs = M.conj(this._chainedSubs, otherChannel.subscribe(this._forward));
    },

    dispose: function() {
      var subs = this._chainedSubs;

      this._chainedSubs = M.vector();

      M.each(subs, function(sub) {
        sub.dispose();
      });

      return this._dispose.apply(this, arguments);
    },

    _forward: function(msg) {
      this._publish(this._sentinel, msg);
    }
  });

  return ChainedChannel;
};

module.exports = mod(
  require("underscore"),
  require("mori"),
  require("../options"),
  require("./channel")
);

})()
},{"../options":8,"./channel":31,"underscore":57,"mori":59}],34:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  M,
  Options,
  Channel
) {

  var CompositeChannel = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(CompositeChannel.prototype, Channel.prototype, {
    initialize: function(opts) {
      Channel.prototype.initialize.apply(this, arguments);
      opts = Options.fromObject(opts);

      this._forwarding = M.hash_map();

      var listen = opts.getOrElse("listen", []);
      if (!_.isArray(listen)) {
        listen = [listen];
      }

      _.each(listen, _.bind(function(c) {
        this.listen(c);
      }, this));
    },


    dispose: function() {
      Channel.prototype.dispose.apply(this, arguments);
      var forwarding = this._forwarding;
      this._forwarding = M.hash_map();

      M.each(forwarding, _.bind(function(pair) {
        M.nth(pair, 1).dispose();
      }, this));
    },


    listen: function(channel) {
      var sub = channel.subscribe(_.bind(function(msg) {
        this._forward(msg)
      }, this));
      this._forwarding = M.assoc(this._forwarding, channel, sub);

      return {
        dispose: _.bind(function() {
          this._forwarding = M.dissoc(this._forwarding, channel);
          sub.dispose();
        }, this)
      };
    },


    _forward: function(msg) {
      this.publish(this._sentinel, msg);
    }
  });

  return CompositeChannel;
};

module.exports = mod(
  require("underscore"),
  require("mori"),
  require("../options"),
  require("./channel")
);

})()
},{"../options":8,"./channel":31,"underscore":57,"mori":59}],36:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  M,
  Options,
  UUID,
  StateGuard,
  Logger
) {

  var InMemoryFiber = (function() {
    var Klass = function() {
      this.initialize.apply(this, arguments);
    };

    var Log = Logger.create("InMemoryLogger");

    _.extend(Klass.prototype, {
      initialize: function(opts) {
        opts = Options.fromObject(opts);

        this._entities = M.hash_map();
        this._identity = opts.getOrElse("identity", UUID.v4());

        this._stateGuard = new StateGuard(["disposed"]);

        _.bindAll(this, "_receive");
      },


      id: function() {
        return this._identity;
      },


      dispose: function() {
        if (this._stateGuard.applied("disposed")) {
          return;
        }
        this._dispose();
        this._stateGuard.apply("disposed");
      },

      _dispose: function() {

        var entities = this._entities;
        M.each(entities, function(pair) {
          M.nth(pair, 1).dispose();
        });

        this._entities = null;
      },

      registerEntity: function(opts) {
        opts = Options.fromObject(opts);

        var identity = opts.getOrError("identity"),
            entity   = new LocalEntity({
              identity: identity,
              delegate: opts.getOrError("delegate")
            });

        this._entities = M.assoc(this._entities, identity, entity);
        return true;
      },

      /**
       * Returns a promise which is fulfilled when the message is
       * sent, not received by the remote end. This to let the
       * caller know whether or not the message is stuck
       * in a buffer somewhere when calculating its timeouts.
       */
      send: Promise.method(function(opts) {
        this._stateGuard.deny("disposed");

        opts = Options.fromObject(opts);
        var from   = opts.getOrError("from"),
            to     = opts.getOrError("to"),
            body   = opts.getOrError("body"),
            msgId  = opts.getOrError("msgId"),

            mT     = opts.getOrElse("mT"),
            rMsgId = opts.getOrElse("rMsgId");


        //XXX: This is in-memory, so it's as simple
        // as invoking _receive in a future call stack
        return Promise
          .bind(this)
          .then(function() {
            _.defer(this._receive, {
              from:   from,
              to:     to,
              body:   body,
              msgId:  msgId,
              mT:     mT,
              rMsgId: rMsgId,
              oFib:   this._identity
            });
          })
          .then(function() {
            return msgId;
          });
      }),

      _receive: function(env) {
        if (this._stateGuard.applied("disposed")) {
          return;
        }

        env = Options.fromObject(env);
        var to, from, body, msgId, originFiber, mT, rMsgId;

        try {
          to          = env.getOrError("to");
          from        = env.getOrError("from");
          body        = env.getOrError("body");
          msgId       = env.getOrError("msgId");

          // Future-proofing for multi-fiber fabric.
          originFiber = env.getOrError("oFib");

          mT     = env.getOrElse("mT");
          rMsgId = env.getOrElse("rMsgId");
        } catch (e) {
          Log.error("Received malformed message", env);
        }

        var entity = M.get(this._entities, to);

        if (entity) {
          entity.dispatch({
            to:     to,
            from:   from,
            body:   body,
            msgId:  msgId,
            rMsgId: rMsgId,
            oFib:   originFiber,
            hFib:   this._identity,
            mT: mT
          });
        }
      }
    });

    return Klass;
  })();



  var LocalEntity = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(LocalEntity.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);

      this._identity = opts.getOrError("identity");
      this._delegate = opts.getOrError("delegate");
      this._stateGuard = new StateGuard(["disposed"]);
    },
    dispose: function() {
      if (this._stateGuard.applied("disposed")) {
        return;
      }

      this._delegate = null;

      this._stateGuard.apply("disposed");
    },
    dispatch: function(env) {
      this._stateGuard.deny("disposed");

      this._delegate.receiveFiberMessage(env);
    }
  });

  return InMemoryFiber;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("mori"),
  require("../../core/options"),
  require("../../core/uuid"),
  require("../../core/state-guard"),
  require("../../core/logging/logger")
);

})()
},{"../../core/options":8,"../../core/uuid":38,"../../core/state-guard":9,"../../core/logging/logger":29,"underscore":57,"bluebird":58,"mori":59}],37:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  M,
  Options,
  InMemoryFiber,
  Channel,
  CompositeChannel
) {

  /**
   * LinkableFiber is a reference implementation for implementing a multi-fiber "fabric".
   */
  var LinkableFiber = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(LinkableFiber.prototype, InMemoryFiber.prototype, {
    initialize: function(opts) {
      InMemoryFiber.prototype.initialize.apply(this, arguments);
      opts = Options.fromObject(opts);


      this._localDispatch  = new Channel({ sentinel: this });
      this._ingressChannel = new CompositeChannel({
        sentinel: this,
        listen:   this._localDispatch
      });

      this._egressChannel  = new Channel({ sentinel: this });

      // _receive is defined and bound in InMemoryFiber ("protected" method)
      this._ingressChannel.subscribe(this._receive);
    },


    listen: function(channel) {
      this._ingressChannel.listen(channel);
    },


    egressChannel: function() {
      return this._egressChannel;
    },


    _dispose: function() {
      InMemoryFiber.prototype._dispose.apply(this, arguments);
    },

    send: Promise.method(function(opts) {
      this._stateGuard.deny("disposed");

      opts = Options.fromObject(opts);

      var from   = opts.getOrError("from"),
          to     = opts.getOrError("to"),
          body   = opts.getOrError("body"),
          msgId  = opts.getOrError("msgId"),
          mT     = opts.getOrElse("mT"),
          rMsgId = opts.getOrElse("rMsgId"),
          chan   = null;

      var msg = {
        from:   from,
        to:     to,
        body:   body,
        msgId:  msgId,
        mT:     mT,
        rMsgId: rMsgId,
        oFib:   this._identity
      };

      // Local dispatch, skip the round-trip
      if (M.get(this._entities, to)) {
        chan = this._localDispatch;
      } else {
        chan = this._egressChannel;
      }

      _.defer(_.bind(function() {
        chan.publish(this, msg);
      }, this));

      return msgId;
    })


  });

  return LinkableFiber;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("mori"),
  require("../../core/options"),
  require("./in-memory-fiber"),
  require("../../core/channel/channel"),
  require("../../core/channel/composite-channel")
);

})()
},{"../../core/options":8,"./in-memory-fiber":36,"../../core/channel/channel":31,"../../core/channel/composite-channel":34,"bluebird":58,"underscore":57,"mori":59}],39:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _
) {

  var JSONSerde = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(JSONSerde.prototype, {
    initialize: function() {},


    serialize: function(payload, opts) {
      return JSON.stringify(payload);
    },


    deserialize: function(payload, opts) {
      return JSON.parse(payload);
    }
  });

  return JSONSerde;
};

module.exports = mod(
  require("underscore")
);

})()
},{"underscore":57}],43:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Ref,
  DelegatingRef
) {

  var helper = function(val) {
    return new Ref(val);
  };

  helper.delegating = function(ref) {
    return new DelegatingRef(ref);
  };

  return helper;
};

module.exports = mod(
  require("underscore"),
  require("./ref"),
  require("./delegating-ref")
);

})()
},{"./ref":51,"./delegating-ref":50,"underscore":57}],58:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var Promise = require("./promise.js")();
module.exports = Promise;
},{"./promise.js":60}],30:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options
) {

  var ConsoleLogAppender = function() {
    this.initialize.apply(this, arguments);
  };

  var p = function(num) {
    if (("" + num).length === 1) {
      return "0" + num;
    } else {
      return num;
    }
  };

  _.extend(ConsoleLogAppender.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._console = opts.getOrElse("console", console);
      this._timeDelegate = opts.getOrElse("timeDelegate", function(){
        var d = new Date();
        return [d.getUTCFullYear(), p(d.getUTCMonth()), p(d.getUTCDay())].join("/") +
          " " + [p(d.getUTCHours()), p(d.getUTCMinutes()), p(d.getUTCSeconds())].join(":") +
          "." + d.getUTCMilliseconds();
      });
    },

    log: function(loggerName, descendants, logLevel, logLevelName, args) {
      // Use the furthest ancestor as the logged name (since it originated there)
      var furthestAncestor = descendants[descendants.length - 1];
      if (furthestAncestor) {
        loggerName = furthestAncestor;
      }
      this._log(["["+logLevelName+"]["+this._getTime()+"]["+loggerName+"]"].concat(args));
    },

    _getTime: function() {
      return this._timeDelegate();
    },

    _log: function(logItems) {
      // Why does he do this? Is he insane? Well, yes.
      //
      // But mostly, I do this because console.log isn't, in all cases,
      // something you can call .apply on. Last I checked, in IE calling
      // console.log.apply(console, []) will throw an error. So that's why the
      // big ugly switch.
      //
      // If you need more than 7 items, well, I can't help you (but you can - add another
      // switch case).
      switch(logItems.length) {
        case 0:
          this._console.log();
          break;
        case 1:
          this._console.log(logItems[0]);
          break;
        case 2:
          this._console.log(logItems[0], logItems[1]);
          break;
        case 3:
          this._console.log(logItems[0], logItems[1], logItems[2]);
          break;
        case 4:
          this._console.log(logItems[0], logItems[1], logItems[2], logItems[3]);
          break;
        case 5:
          this._console.log(logItems[0], logItems[1], logItems[2], logItems[3], logItems[4]);
          break;
        case 6:
          this._console.log(logItems[0], logItems[1], logItems[2], logItems[3], logItems[4], logItems[5]);
          break;
        case 7:
          this._console.log(logItems[0], logItems[1], logItems[2], logItems[3], logItems[4], logItems[5], logItems[6]);
          break;
        default:
          var label = logItems.shift();
          this._console.log(label, logItems);
      }
    }
  });

  return ConsoleLogAppender;
};

module.exports = mod(
  require("underscore"),
  require("../../options")
);

})()
},{"../../options":8,"underscore":57}],46:[function(require,module,exports){
(function(){/*global require: false, module: false, process: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options,
  Logger
) {

  var Log = Logger.create("AppContainer");

  var WebAppContainer = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(WebAppContainer.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts)
      this._app = opts.getOrError("app");
    },

    start: Promise.method(function() {
      return Promise
        .bind(this)
        .then(function() {
          return this._app.start();
        });
    }),

    stop: Promise.method(function(reason) {
      return this._app.stop().then(function() {
        if (reason) {
          Log.error("Stopping due to reason:", reason);
        }
      });
    })
  });

  return WebAppContainer;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../core/options"),
  require("../core/logging/logger")
);

})()
},{"../core/options":8,"../core/logging/logger":29,"underscore":57,"bluebird":58}],45:[function(require,module,exports){
"use strict";

var mod = function(
  _,
  Promise,
  Options,
  Logger,
  ConfigurationMagic,
  AppContainer
) {
  var Log = Logger.create("Bootstrapper");

  var Bootstrapper = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Bootstrapper.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._configs = opts.getOrError("configurations");
      this._scopes = opts.getOrError("scopes");
      this._appKlass = opts.getOrError("applicationConstructor");
    },
    bootstrap: Promise.method(function() {
      return Promise
        .bind(this)
        .then(function() {
          var config       = ConfigurationMagic.resolveConfig(this._scopes, this._configs),
              AppKlass     = this._appKlass;

          Log.info("Using resolved configuration: ", JSON.stringify(config));

          var app          = new AppKlass({configuration: config}),
              appContainer = new AppContainer({app: app});

          return appContainer;
        });
    })
  });

  return Bootstrapper;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../core/options"),
  require("../core/logging/logger"),
  require("./configuration-magic"),
  require("./web-app-container")
);

},{"../core/options":8,"../core/logging/logger":29,"./configuration-magic":25,"./web-app-container":46,"underscore":57,"bluebird":58}],47:[function(require,module,exports){
"use strict";

var mod = function(
  _
) {

  var WebScheduler = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(WebScheduler.prototype, {
    initialize: function() {},

    runSoon: function(fn) {
      this.schedule(fn);
    },

    schedule: function(fn, delay) {
      delay = delay || 1;
      return setTimeout(fn, delay);
    },

    unschedule: function(id) {
      return clearTimeout(id);
    }
  });

  return WebScheduler;
};

module.exports = mod(
  require("underscore")
);

},{"underscore":57}],49:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options,
  Ref,
  SetTimeoutScheduler
) {

  var DefaultRuntime = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(DefaultRuntime.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);

      this._schedulerRef = Ref(opts.getOrElseFn("scheduler", function() {
        return new SetTimeoutScheduler();
      }));
    },

    /**
     * @returns {Ref<Scheduler>}
     */
    scheduler: function() {
      return Ref.delegating(this._schedulerRef);
    },

    setScheduler: function(scheduler) {
      this._schedulerRef.set(scheduler);
    }
  });

  return DefaultRuntime;
};

module.exports = mod(
  require("underscore"),
  require("../core/options"),
  require("../core/ref"),
  require("../core/scheduler/set-timeout-scheduler")
);

})()
},{"../core/options":8,"../core/scheduler/set-timeout-scheduler":52,"../core/ref":43,"underscore":57}],53:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options
) {

  var StoreEntry = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(StoreEntry.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      // Perfectly acceptable to pass in undefined...
      this._value = opts.getOrElse("value", undefined);
      this._lastSequence = opts.getOrError("initialSequence");

      this._ttl = opts.getOrElse("ttl");
    },

    isExpired: function(sequence, fallbackTtl) {
      var ttl = this._ttl || fallbackTtl;
      if (!ttl) {
        throw new Error("No TTL specified!");
      }
      // E.g., lastSequence = 4, ttl = 1, sequence = 5: expired
      //       lastSequence = 4, ttl = 1, sequence = 4: not expired
      //       lastSequence = 4, ttl = 2, sequence = 5: not expired
      return !(this._lastSequence + ttl > sequence);
    },

    touch: function(sequence) {
      this._lastSequence = sequence;
    },

    update: function(val, sequence, opts) {
      this._value        = val;
      this._lastSequence = sequence;

      opts = Options.fromObject(opts);
      this._ttl = opts.getOrElse("ttl");
    },

    dispose: function() {
      this._value        = null;
      this._lastSequence = null;
    },

    value: function() {
      return this._value;
    }
  });

  return StoreEntry;
};

module.exports = mod(
  require("underscore"),
  require("../../core/options")
);

})()
},{"../../core/options":8,"underscore":57}],55:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Logger,
  Options
) {

  var TEN_MINUTES_IN_MILLISECONDS = 60 * 1000 * 10;

  var Log = Logger.create("ProcessKeepAlive");

  var ProcessKeepAlive = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(ProcessKeepAlive.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._scheduler = opts.getOrError("scheduler");
      this._timeoutId = null;

      _.bindAll(this, "_cycle");
    },
    start: function() {
      Log.debug("Starting ProcessKeepAlive");
      this._cycle();
    },
    stop: function() {
      Log.debug("Stopping ProcessKeepAlive");
      if (this._timeoutId) {
        this._scheduler.get().unschedule(this._timeoutId);
        this._timeoutId = null;
      }
    },
    _cycle: function() {
      this._timeoutId = this._scheduler.get().schedule(
        this._cycle,
        TEN_MINUTES_IN_MILLISECONDS
      );
    }
  });

  return ProcessKeepAlive;
};

module.exports = mod(
  require("underscore"),
  require("../../core/logging/logger"),
  require("../../core/options")
);

})()
},{"../../core/logging/logger":29,"../../core/options":8,"underscore":57}],54:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  M,
  Options,
  UUID,
  ChainedChannel,
  Channel,
  CompositeChannel,
  StateGuard
) {


  var Mailbox = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Mailbox.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._id                    = UUID.v4();
      this._ownerIdentity         = opts.getOrError("ownerIdentity");
      this._exchange              = opts.getOrError("exchange");
      this._oneShotChannel        = new Channel({ sentinel: this });
      this._requestReplyChannel   = new Channel({ sentinel: this });
      this._ingressChannel        = new CompositeChannel({
        sentinel: this,
        listen: [this._oneShotChannel, this._requestReplyChannel]
      });
      this._stateGuard            = new StateGuard(["disposed"]);

      this._outstandingRequestIds = M.set();
    },

    id: function() {
      return this._id;
    },

    ownerIdentity: function() {
      return this._ownerIdentity;
    },

    dispose: function() {
      if (this._stateGuard.applied("disposed")){
        return;
      }

      this._oneShotChannel.dispose();
      this._requestReplyChannel.dispose();
      this._ingressChannel.dispose();

      // Attempt to cancel all outstanding requests.
      // This is an async request, so we just have to fire and
      // forge them.
      //
      // If you're disposing of a mailbox before requests
      // complete, you might have a bad time. The good
      // news is because responses are ferried back from the fiber
      // to the mailbox caller via the Promise interface rather
      // than channels, they should still get CancellationErrors
      var reqs = this._outstandingRequestIds;
      this._outstandingRequestIds = M.set();

      M.each(reqs, _.bind(function(reqId) {
        this._exchange.cancelSendAndReceive(reqId);
      }, this));

      this._oneShotChannel      = null;
      this._requestReplyChannel = null;
      this._ingressChannel      = null;

      this._stateGuard.apply("disposed");
    },

    /**
     * Returns a new ChainedChannel chained to this Mailbox's
     * privately-owned inbound Channel.
     * @returns {ChainedChannel}
     */
    ingressChannel: function() {
      return this._ingressChannel;
    },

    oneShotChannel: function() {
      return this._oneShotChannel;
    },

    requestReplyChannel: function() {
      return this._requestReplyChannel;
    },

    send: Promise.method(function(env) {
      this._stateGuard.deny("disposed");

      env = _.extend({}, env || {}, {
        from: this._ownerIdentity
      });
      return this._exchange.send(env);
    }),

    reply: Promise.method(function(msgId, env) {
      this._stateGuard.deny("disposed");

      env = _.extend({}, env || {}, {
        rMsgId: msgId,
        from: this._ownerIdentity
      });

      return this._exchange.reply(env);
    }),

    sendAndReceive: Promise.method(function(env, opts) {
      this._stateGuard.deny("disposed");

      var reqId = (opts || {}).reqId || UUID.v4();

      env = _.extend({}, env || {}, {
        from: this._ownerIdentity
      });

      opts = _.extend({}, opts || {}, {
        reqId: reqId
      });

      this._outstandingRequestIds = M.conj(this._outstandingRequestIds, reqId);

      return this._exchange
        .sendAndReceive(env, opts)
        .bind(this)
        .then(function(resp) {
          this._outstandingRequestIds = M.disj(this._outstandingRequestIds, reqId);
          return resp;
        })
        .caught(Promise.CancellationError, function(err) {
          this._outstandingRequestIds = M.disj(this._outstandingRequestIds, reqId);
          throw err;
        })
        .caught(Promise.TimeoutError, function(err) {
          this._outstandingRequestIds = M.disj(this._outstandingRequestIds, reqId);
          throw err;
        });
    }),


    outstandingRequestCount: function() {
      return M.count(this._outstandingRequestIds);
    },


    cancelSendAndReceive: Promise.method(function(reqId) {
      return this._exchange
        .cancelSendAndReceive(reqId)
        .bind(this)
        .then(function() {
          this._outstandingRequestIds = M.disj(this._outstandingRequestIds, reqId);
        });
    }),

    _receiveOneShot: function(msg) {
      this._oneShotChannel.publish(this, msg);
    },

    _receiveRequestReply: function(msg) {
      this._requestReplyChannel.publish(this, msg);
    }
  });

  return Mailbox;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("mori"),
  require("../../core/options"),
  require("../../core/uuid"),
  require("../../core/channel/chained-channel"),
  require("../../core/channel/channel"),
  require("../../core/channel/composite-channel"),
  require("../../core/state-guard")
);

})()
},{"../../core/options":8,"../../core/uuid":38,"../../core/channel/composite-channel":34,"../../core/channel/chained-channel":32,"../../core/channel/channel":31,"../../core/state-guard":9,"underscore":57,"bluebird":58,"mori":59}],61:[function(require,module,exports){
// shim for using process in browser

var process = module.exports = {};

process.nextTick = (function () {
    var canSetImmediate = typeof window !== 'undefined'
    && window.setImmediate;
    var canPost = typeof window !== 'undefined'
    && window.postMessage && window.addEventListener
    ;

    if (canSetImmediate) {
        return function (f) { return window.setImmediate(f) };
    }

    if (canPost) {
        var queue = [];
        window.addEventListener('message', function (ev) {
            var source = ev.source;
            if ((source === window || source === null) && ev.data === 'process-tick') {
                ev.stopPropagation();
                if (queue.length > 0) {
                    var fn = queue.shift();
                    fn();
                }
            }
        }, true);

        return function nextTick(fn) {
            queue.push(fn);
            window.postMessage('process-tick', '*');
        };
    }

    return function nextTick(fn) {
        setTimeout(fn, 0);
    };
})();

process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];

process.binding = function (name) {
    throw new Error('process.binding is not supported');
}

// TODO(shtylman)
process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};

},{}],60:[function(require,module,exports){
(function(process){/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var old;
if (typeof Promise !== "undefined") old = Promise;
function noConflict(bluebird) {
    try { if (Promise === bluebird) Promise = old; }
    catch (e) {}
    return bluebird;
}
module.exports = function() {
var util = require("./util.js");
var async = require("./async.js");
var errors = require("./errors.js");

var INTERNAL = function(){};
var APPLY = {};
var NEXT_FILTER = {e: null};

var cast = require("./thenables.js")(Promise, INTERNAL);
var PromiseArray = require("./promise_array.js")(Promise, INTERNAL, cast);
var CapturedTrace = require("./captured_trace.js")();
var CatchFilter = require("./catch_filter.js")(NEXT_FILTER);
var PromiseResolver = require("./promise_resolver.js");

var isArray = util.isArray;

var errorObj = util.errorObj;
var tryCatch1 = util.tryCatch1;
var tryCatch2 = util.tryCatch2;
var tryCatchApply = util.tryCatchApply;
var RangeError = errors.RangeError;
var TypeError = errors.TypeError;
var CancellationError = errors.CancellationError;
var TimeoutError = errors.TimeoutError;
var OperationalError = errors.OperationalError;
var originatesFromRejection = errors.originatesFromRejection;
var markAsOriginatingFromRejection = errors.markAsOriginatingFromRejection;
var canAttach = errors.canAttach;
var thrower = util.thrower;
var apiRejection = require("./errors_api_rejection")(Promise);


var makeSelfResolutionError = function Promise$_makeSelfResolutionError() {
    return new TypeError("circular promise resolution chain");
};

function Promise(resolver) {
    if (typeof resolver !== "function") {
        throw new TypeError("the promise constructor requires a resolver function");
    }
    if (this.constructor !== Promise) {
        throw new TypeError("the promise constructor cannot be invoked directly");
    }
    this._bitField = 0;
    this._fulfillmentHandler0 = void 0;
    this._rejectionHandler0 = void 0;
    this._promise0 = void 0;
    this._receiver0 = void 0;
    this._settledValue = void 0;
    this._boundTo = void 0;
    if (resolver !== INTERNAL) this._resolveFromResolver(resolver);
}

Promise.prototype.bind = function Promise$bind(thisArg) {
    var ret = new Promise(INTERNAL);
    ret._follow(this);
    ret._propagateFrom(this, 2 | 1);
    ret._setBoundTo(thisArg);
    return ret;
};

Promise.prototype.toString = function Promise$toString() {
    return "[object Promise]";
};

Promise.prototype.caught = Promise.prototype["catch"] =
function Promise$catch(fn) {
    var len = arguments.length;
    if (len > 1) {
        var catchInstances = new Array(len - 1),
            j = 0, i;
        for (i = 0; i < len - 1; ++i) {
            var item = arguments[i];
            if (typeof item === "function") {
                catchInstances[j++] = item;
            } else {
                var catchFilterTypeError =
                    new TypeError(
                        "A catch filter must be an error constructor "
                        + "or a filter function");

                this._attachExtraTrace(catchFilterTypeError);
                async.invoke(this._reject, this, catchFilterTypeError);
                return;
            }
        }
        catchInstances.length = j;
        fn = arguments[i];

        this._resetTrace();
        var catchFilter = new CatchFilter(catchInstances, fn, this);
        return this._then(void 0, catchFilter.doFilter, void 0,
            catchFilter, void 0);
    }
    return this._then(void 0, fn, void 0, void 0, void 0);
};

Promise.prototype.then =
function Promise$then(didFulfill, didReject, didProgress) {
    return this._then(didFulfill, didReject, didProgress,
        void 0, void 0);
};


Promise.prototype.done =
function Promise$done(didFulfill, didReject, didProgress) {
    var promise = this._then(didFulfill, didReject, didProgress,
        void 0, void 0);
    promise._setIsFinal();
};

Promise.prototype.spread = function Promise$spread(didFulfill, didReject) {
    return this._then(didFulfill, didReject, void 0,
        APPLY, void 0);
};

Promise.prototype.isCancellable = function Promise$isCancellable() {
    return !this.isResolved() &&
        this._cancellable();
};

Promise.prototype.toJSON = function Promise$toJSON() {
    var ret = {
        isFulfilled: false,
        isRejected: false,
        fulfillmentValue: void 0,
        rejectionReason: void 0
    };
    if (this.isFulfilled()) {
        ret.fulfillmentValue = this._settledValue;
        ret.isFulfilled = true;
    } else if (this.isRejected()) {
        ret.rejectionReason = this._settledValue;
        ret.isRejected = true;
    }
    return ret;
};

Promise.prototype.all = function Promise$all() {
    return new PromiseArray(this).promise();
};


Promise.is = function Promise$Is(val) {
    return val instanceof Promise;
};

Promise.all = function Promise$All(promises) {
    return new PromiseArray(promises).promise();
};

Promise.prototype.error = function Promise$_error(fn) {
    return this.caught(originatesFromRejection, fn);
};

Promise.prototype._resolveFromSyncValue =
function Promise$_resolveFromSyncValue(value) {
    if (value === errorObj) {
        this._cleanValues();
        this._setRejected();
        this._settledValue = value.e;
        this._ensurePossibleRejectionHandled();
    } else {
        var maybePromise = cast(value, void 0);
        if (maybePromise instanceof Promise) {
            this._follow(maybePromise);
        } else {
            this._cleanValues();
            this._setFulfilled();
            this._settledValue = value;
        }
    }
};

Promise.method = function Promise$_Method(fn) {
    if (typeof fn !== "function") {
        throw new TypeError("fn must be a function");
    }
    return function Promise$_method() {
        var value;
        switch(arguments.length) {
        case 0: value = tryCatch1(fn, this, void 0); break;
        case 1: value = tryCatch1(fn, this, arguments[0]); break;
        case 2: value = tryCatch2(fn, this, arguments[0], arguments[1]); break;
        default:
            var $_len = arguments.length;var args = new Array($_len); for(var $_i = 0; $_i < $_len; ++$_i) {args[$_i] = arguments[$_i];}
            value = tryCatchApply(fn, args, this); break;
        }
        var ret = new Promise(INTERNAL);
        ret._setTrace(void 0);
        ret._resolveFromSyncValue(value);
        return ret;
    };
};

Promise.attempt = Promise["try"] = function Promise$_Try(fn, args, ctx) {
    if (typeof fn !== "function") {
        return apiRejection("fn must be a function");
    }
    var value = isArray(args)
        ? tryCatchApply(fn, args, ctx)
        : tryCatch1(fn, ctx, args);

    var ret = new Promise(INTERNAL);
    ret._setTrace(void 0);
    ret._resolveFromSyncValue(value);
    return ret;
};

Promise.defer = Promise.pending = function Promise$Defer() {
    var promise = new Promise(INTERNAL);
    promise._setTrace(void 0);
    return new PromiseResolver(promise);
};

Promise.bind = function Promise$Bind(thisArg) {
    var ret = new Promise(INTERNAL);
    ret._setTrace(void 0);
    ret._setFulfilled();
    ret._setBoundTo(thisArg);
    return ret;
};

Promise.cast = function Promise$_Cast(obj) {
    var ret = cast(obj, void 0);
    if (!(ret instanceof Promise)) {
        var val = ret;
        ret = new Promise(INTERNAL);
        ret._setTrace(void 0);
        ret._setFulfilled();
        ret._cleanValues();
        ret._settledValue = val;
    }
    return ret;
};

Promise.resolve = Promise.fulfilled = Promise.cast;

Promise.reject = Promise.rejected = function Promise$Reject(reason) {
    var ret = new Promise(INTERNAL);
    ret._setTrace(void 0);
    markAsOriginatingFromRejection(reason);
    ret._cleanValues();
    ret._setRejected();
    ret._settledValue = reason;
    if (!canAttach(reason)) {
        var trace = new Error(reason + "");
        ret._setCarriedStackTrace(trace);
    }
    ret._ensurePossibleRejectionHandled();
    return ret;
};

Promise.onPossiblyUnhandledRejection =
function Promise$OnPossiblyUnhandledRejection(fn) {
        CapturedTrace.possiblyUnhandledRejection = typeof fn === "function"
                                                    ? fn : void 0;
};

var unhandledRejectionHandled;
Promise.onUnhandledRejectionHandled =
function Promise$onUnhandledRejectionHandled(fn) {
    unhandledRejectionHandled = typeof fn === "function" ? fn : void 0;
};

var debugging = false || !!(
    typeof process !== "undefined" &&
    typeof process.execPath === "string" &&
    typeof process.env === "object" &&
    (process.env["BLUEBIRD_DEBUG"] ||
        process.env["NODE_ENV"] === "development")
);


Promise.longStackTraces = function Promise$LongStackTraces() {
    if (async.haveItemsQueued() &&
        debugging === false
   ) {
        throw new Error("cannot enable long stack traces after promises have been created");
    }
    debugging = CapturedTrace.isSupported();
};

Promise.hasLongStackTraces = function Promise$HasLongStackTraces() {
    return debugging && CapturedTrace.isSupported();
};

Promise.prototype._then =
function Promise$_then(
    didFulfill,
    didReject,
    didProgress,
    receiver,
    internalData
) {
    var haveInternalData = internalData !== void 0;
    var ret = haveInternalData ? internalData : new Promise(INTERNAL);

    if (!haveInternalData) {
        if (debugging) {
            var haveSameContext = this._peekContext() === this._traceParent;
            ret._traceParent = haveSameContext ? this._traceParent : this;
        }
        ret._propagateFrom(this, 7);
    }

    var callbackIndex =
        this._addCallbacks(didFulfill, didReject, didProgress, ret, receiver);

    if (this.isResolved()) {
        async.invoke(this._queueSettleAt, this, callbackIndex);
    }

    return ret;
};

Promise.prototype._length = function Promise$_length() {
    return this._bitField & 262143;
};

Promise.prototype._isFollowingOrFulfilledOrRejected =
function Promise$_isFollowingOrFulfilledOrRejected() {
    return (this._bitField & 939524096) > 0;
};

Promise.prototype._isFollowing = function Promise$_isFollowing() {
    return (this._bitField & 536870912) === 536870912;
};

Promise.prototype._setLength = function Promise$_setLength(len) {
    this._bitField = (this._bitField & -262144) |
        (len & 262143);
};

Promise.prototype._setFulfilled = function Promise$_setFulfilled() {
    this._bitField = this._bitField | 268435456;
};

Promise.prototype._setRejected = function Promise$_setRejected() {
    this._bitField = this._bitField | 134217728;
};

Promise.prototype._setFollowing = function Promise$_setFollowing() {
    this._bitField = this._bitField | 536870912;
};

Promise.prototype._setIsFinal = function Promise$_setIsFinal() {
    this._bitField = this._bitField | 33554432;
};

Promise.prototype._isFinal = function Promise$_isFinal() {
    return (this._bitField & 33554432) > 0;
};

Promise.prototype._cancellable = function Promise$_cancellable() {
    return (this._bitField & 67108864) > 0;
};

Promise.prototype._setCancellable = function Promise$_setCancellable() {
    this._bitField = this._bitField | 67108864;
};

Promise.prototype._unsetCancellable = function Promise$_unsetCancellable() {
    this._bitField = this._bitField & (~67108864);
};

Promise.prototype._setRejectionIsUnhandled =
function Promise$_setRejectionIsUnhandled() {
    this._bitField = this._bitField | 2097152;
};

Promise.prototype._unsetRejectionIsUnhandled =
function Promise$_unsetRejectionIsUnhandled() {
    this._bitField = this._bitField & (~2097152);
    if (this._isUnhandledRejectionNotified()) {
        this._unsetUnhandledRejectionIsNotified();
        this._notifyUnhandledRejectionIsHandled();
    }
};

Promise.prototype._isRejectionUnhandled =
function Promise$_isRejectionUnhandled() {
    return (this._bitField & 2097152) > 0;
};

Promise.prototype._setUnhandledRejectionIsNotified =
function Promise$_setUnhandledRejectionIsNotified() {
    this._bitField = this._bitField | 524288;
};

Promise.prototype._unsetUnhandledRejectionIsNotified =
function Promise$_unsetUnhandledRejectionIsNotified() {
    this._bitField = this._bitField & (~524288);
};

Promise.prototype._isUnhandledRejectionNotified =
function Promise$_isUnhandledRejectionNotified() {
    return (this._bitField & 524288) > 0;
};

Promise.prototype._setCarriedStackTrace =
function Promise$_setCarriedStackTrace(capturedTrace) {
    this._bitField = this._bitField | 1048576;
    this._fulfillmentHandler0 = capturedTrace;
};

Promise.prototype._unsetCarriedStackTrace =
function Promise$_unsetCarriedStackTrace() {
    this._bitField = this._bitField & (~1048576);
    this._fulfillmentHandler0 = void 0;
};

Promise.prototype._isCarryingStackTrace =
function Promise$_isCarryingStackTrace() {
    return (this._bitField & 1048576) > 0;
};

Promise.prototype._getCarriedStackTrace =
function Promise$_getCarriedStackTrace() {
    return this._isCarryingStackTrace()
        ? this._fulfillmentHandler0
        : void 0;
};

Promise.prototype._receiverAt = function Promise$_receiverAt(index) {
    var ret = index === 0
        ? this._receiver0
        : this[(index << 2) + index - 5 + 4];
    if (this._isBound() && ret === void 0) {
        return this._boundTo;
    }
    return ret;
};

Promise.prototype._promiseAt = function Promise$_promiseAt(index) {
    return index === 0
        ? this._promise0
        : this[(index << 2) + index - 5 + 3];
};

Promise.prototype._fulfillmentHandlerAt =
function Promise$_fulfillmentHandlerAt(index) {
    return index === 0
        ? this._fulfillmentHandler0
        : this[(index << 2) + index - 5 + 0];
};

Promise.prototype._rejectionHandlerAt =
function Promise$_rejectionHandlerAt(index) {
    return index === 0
        ? this._rejectionHandler0
        : this[(index << 2) + index - 5 + 1];
};

Promise.prototype._addCallbacks = function Promise$_addCallbacks(
    fulfill,
    reject,
    progress,
    promise,
    receiver
) {
    var index = this._length();

    if (index >= 262143 - 5) {
        index = 0;
        this._setLength(0);
    }

    if (index === 0) {
        this._promise0 = promise;
        if (receiver !== void 0) this._receiver0 = receiver;
        if (typeof fulfill === "function" && !this._isCarryingStackTrace())
            this._fulfillmentHandler0 = fulfill;
        if (typeof reject === "function") this._rejectionHandler0 = reject;
        if (typeof progress === "function") this._progressHandler0 = progress;
    } else {
        var base = (index << 2) + index - 5;
        this[base + 3] = promise;
        this[base + 4] = receiver;
        this[base + 0] = typeof fulfill === "function"
                                            ? fulfill : void 0;
        this[base + 1] = typeof reject === "function"
                                            ? reject : void 0;
        this[base + 2] = typeof progress === "function"
                                            ? progress : void 0;
    }
    this._setLength(index + 1);
    return index;
};

Promise.prototype._setProxyHandlers =
function Promise$_setProxyHandlers(receiver, promiseSlotValue) {
    var index = this._length();

    if (index >= 262143 - 5) {
        index = 0;
        this._setLength(0);
    }
    if (index === 0) {
        this._promise0 = promiseSlotValue;
        this._receiver0 = receiver;
    } else {
        var base = (index << 2) + index - 5;
        this[base + 3] = promiseSlotValue;
        this[base + 4] = receiver;
        this[base + 0] =
        this[base + 1] =
        this[base + 2] = void 0;
    }
    this._setLength(index + 1);
};

Promise.prototype._proxyPromiseArray =
function Promise$_proxyPromiseArray(promiseArray, index) {
    this._setProxyHandlers(promiseArray, index);
};

Promise.prototype._proxyPromise = function Promise$_proxyPromise(promise) {
    promise._setProxied();
    this._setProxyHandlers(promise, -1);
};

Promise.prototype._setBoundTo = function Promise$_setBoundTo(obj) {
    if (obj !== void 0) {
        this._bitField = this._bitField | 8388608;
        this._boundTo = obj;
    } else {
        this._bitField = this._bitField & (~8388608);
    }
};

Promise.prototype._isBound = function Promise$_isBound() {
    return (this._bitField & 8388608) === 8388608;
};

Promise.prototype._resolveFromResolver =
function Promise$_resolveFromResolver(resolver) {
    var promise = this;
    this._setTrace(void 0);
    this._pushContext();

    function Promise$_resolver(val) {
        if (promise._tryFollow(val)) {
            return;
        }
        promise._fulfill(val);
    }
    function Promise$_rejecter(val) {
        var trace = canAttach(val) ? val : new Error(val + "");
        promise._attachExtraTrace(trace);
        markAsOriginatingFromRejection(val);
        promise._reject(val, trace === val ? void 0 : trace);
    }
    var r = tryCatch2(resolver, void 0, Promise$_resolver, Promise$_rejecter);
    this._popContext();

    if (r !== void 0 && r === errorObj) {
        var e = r.e;
        var trace = canAttach(e) ? e : new Error(e + "");
        promise._reject(e, trace);
    }
};

Promise.prototype._spreadSlowCase =
function Promise$_spreadSlowCase(targetFn, promise, values, boundTo) {
    var promiseForAll = new PromiseArray(values).promise();
    var promise2 = promiseForAll._then(function() {
        return targetFn.apply(boundTo, arguments);
    }, void 0, void 0, APPLY, void 0);
    promise._follow(promise2);
};

Promise.prototype._callSpread =
function Promise$_callSpread(handler, promise, value) {
    var boundTo = this._boundTo;
    if (isArray(value)) {
        for (var i = 0, len = value.length; i < len; ++i) {
            if (cast(value[i], void 0) instanceof Promise) {
                this._spreadSlowCase(handler, promise, value, boundTo);
                return;
            }
        }
    }
    promise._pushContext();
    return tryCatchApply(handler, value, boundTo);
};

Promise.prototype._callHandler =
function Promise$_callHandler(
    handler, receiver, promise, value) {
    var x;
    if (receiver === APPLY && !this.isRejected()) {
        x = this._callSpread(handler, promise, value);
    } else {
        promise._pushContext();
        x = tryCatch1(handler, receiver, value);
    }
    promise._popContext();
    return x;
};

Promise.prototype._settlePromiseFromHandler =
function Promise$_settlePromiseFromHandler(
    handler, receiver, value, promise
) {
    if (!(promise instanceof Promise)) {
        handler.call(receiver, value, promise);
        return;
    }
    var x = this._callHandler(handler, receiver, promise, value);
    if (promise._isFollowing()) return;

    if (x === errorObj || x === promise || x === NEXT_FILTER) {
        var err = x === promise
                    ? makeSelfResolutionError()
                    : x.e;
        var trace = canAttach(err) ? err : new Error(err + "");
        if (x !== NEXT_FILTER) promise._attachExtraTrace(trace);
        promise._rejectUnchecked(err, trace);
    } else {
        var castValue = cast(x, promise);
        if (castValue instanceof Promise) {
            if (castValue.isRejected() &&
                !castValue._isCarryingStackTrace() &&
                !canAttach(castValue._settledValue)) {
                var trace = new Error(castValue._settledValue + "");
                promise._attachExtraTrace(trace);
                castValue._setCarriedStackTrace(trace);
            }
            promise._follow(castValue);
            promise._propagateFrom(castValue, 1);
        } else {
            promise._fulfillUnchecked(x);
        }
    }
};

Promise.prototype._follow =
function Promise$_follow(promise) {
    this._setFollowing();

    if (promise.isPending()) {
        this._propagateFrom(promise, 1);
        promise._proxyPromise(this);
    } else if (promise.isFulfilled()) {
        this._fulfillUnchecked(promise._settledValue);
    } else {
        this._rejectUnchecked(promise._settledValue,
            promise._getCarriedStackTrace());
    }

    if (promise._isRejectionUnhandled()) promise._unsetRejectionIsUnhandled();

    if (debugging &&
        promise._traceParent == null) {
        promise._traceParent = this;
    }
};

Promise.prototype._tryFollow =
function Promise$_tryFollow(value) {
    if (this._isFollowingOrFulfilledOrRejected() ||
        value === this) {
        return false;
    }
    var maybePromise = cast(value, void 0);
    if (!(maybePromise instanceof Promise)) {
        return false;
    }
    this._follow(maybePromise);
    return true;
};

Promise.prototype._resetTrace = function Promise$_resetTrace() {
    if (debugging) {
        this._trace = new CapturedTrace(this._peekContext() === void 0);
    }
};

Promise.prototype._setTrace = function Promise$_setTrace(parent) {
    if (debugging) {
        var context = this._peekContext();
        this._traceParent = context;
        var isTopLevel = context === void 0;
        if (parent !== void 0 &&
            parent._traceParent === context) {
            this._trace = parent._trace;
        } else {
            this._trace = new CapturedTrace(isTopLevel);
        }
    }
    return this;
};

Promise.prototype._attachExtraTrace =
function Promise$_attachExtraTrace(error) {
    if (debugging) {
        var promise = this;
        var stack = error.stack;
        stack = typeof stack === "string" ? stack.split("\n") : [];
        CapturedTrace.protectErrorMessageNewlines(stack);
        var headerLineCount = 1;
        var combinedTraces = 1;
        while(promise != null &&
            promise._trace != null) {
            stack = CapturedTrace.combine(
                stack,
                promise._trace.stack.split("\n")
            );
            promise = promise._traceParent;
            combinedTraces++;
        }

        var stackTraceLimit = Error.stackTraceLimit || 10;
        var max = (stackTraceLimit + headerLineCount) * combinedTraces;
        var len = stack.length;
        if (len > max) {
            stack.length = max;
        }

        if (len > 0)
            stack[0] = stack[0].split("\u0002\u0000\u0001").join("\n");

        if (stack.length <= headerLineCount) {
            error.stack = "(No stack trace)";
        } else {
            error.stack = stack.join("\n");
        }
    }
};

Promise.prototype._cleanValues = function Promise$_cleanValues() {
    if (this._cancellable()) {
        this._cancellationParent = void 0;
    }
};

Promise.prototype._propagateFrom =
function Promise$_propagateFrom(parent, flags) {
    if ((flags & 1) > 0 && parent._cancellable()) {
        this._setCancellable();
        this._cancellationParent = parent;
    }
    if ((flags & 4) > 0) {
        this._setBoundTo(parent._boundTo);
    }
    if ((flags & 2) > 0) {
        this._setTrace(parent);
    }
};

Promise.prototype._fulfill = function Promise$_fulfill(value) {
    if (this._isFollowingOrFulfilledOrRejected()) return;
    this._fulfillUnchecked(value);
};

Promise.prototype._reject =
function Promise$_reject(reason, carriedStackTrace) {
    if (this._isFollowingOrFulfilledOrRejected()) return;
    this._rejectUnchecked(reason, carriedStackTrace);
};

Promise.prototype._settlePromiseAt = function Promise$_settlePromiseAt(index) {
    var handler = this.isFulfilled()
        ? this._fulfillmentHandlerAt(index)
        : this._rejectionHandlerAt(index);

    var value = this._settledValue;
    var receiver = this._receiverAt(index);
    var promise = this._promiseAt(index);

    if (typeof handler === "function") {
        this._settlePromiseFromHandler(handler, receiver, value, promise);
    } else {
        var done = false;
        var isFulfilled = this.isFulfilled();
        if (receiver !== void 0) {
            if (receiver instanceof Promise &&
                receiver._isProxied()) {
                receiver._unsetProxied();

                if (isFulfilled) receiver._fulfillUnchecked(value);
                else receiver._rejectUnchecked(value,
                    this._getCarriedStackTrace());
                done = true;
            } else if (receiver instanceof PromiseArray) {
                if (isFulfilled) receiver._promiseFulfilled(value, promise);
                else receiver._promiseRejected(value, promise);
                done = true;
            }
        }

        if (!done) {
            if (isFulfilled) promise._fulfill(value);
            else promise._reject(value, this._getCarriedStackTrace());
        }
    }

    if (index >= 256) {
        this._queueGC();
    }
};

Promise.prototype._isProxied = function Promise$_isProxied() {
    return (this._bitField & 4194304) === 4194304;
};

Promise.prototype._setProxied = function Promise$_setProxied() {
    this._bitField = this._bitField | 4194304;
};

Promise.prototype._unsetProxied = function Promise$_unsetProxied() {
    this._bitField = this._bitField & (~4194304);
};

Promise.prototype._isGcQueued = function Promise$_isGcQueued() {
    return (this._bitField & -1073741824) === -1073741824;
};

Promise.prototype._setGcQueued = function Promise$_setGcQueued() {
    this._bitField = this._bitField | -1073741824;
};

Promise.prototype._unsetGcQueued = function Promise$_unsetGcQueued() {
    this._bitField = this._bitField & (~-1073741824);
};

Promise.prototype._queueGC = function Promise$_queueGC() {
    if (this._isGcQueued()) return;
    this._setGcQueued();
    async.invokeLater(this._gc, this, void 0);
};

Promise.prototype._gc = function Promise$gc() {
    var len = this._length() * 5;
    for (var i = 0; i < len; i++) {
        delete this[i];
    }
    this._setLength(0);
    this._unsetGcQueued();
};

Promise.prototype._queueSettleAt = function Promise$_queueSettleAt(index) {
    if (this._isRejectionUnhandled()) this._unsetRejectionIsUnhandled();
    async.invoke(this._settlePromiseAt, this, index);
};

Promise.prototype._fulfillUnchecked =
function Promise$_fulfillUnchecked(value) {
    if (!this.isPending()) return;
    if (value === this) {
        var err = makeSelfResolutionError();
        this._attachExtraTrace(err);
        return this._rejectUnchecked(err, void 0);
    }
    this._cleanValues();
    this._setFulfilled();
    this._settledValue = value;
    var len = this._length();

    if (len > 0) {
        async.invoke(this._settlePromises, this, len);
    }
};

Promise.prototype._rejectUncheckedCheckError =
function Promise$_rejectUncheckedCheckError(reason) {
    var trace = canAttach(reason) ? reason : new Error(reason + "");
    this._rejectUnchecked(reason, trace === reason ? void 0 : trace);
};

Promise.prototype._rejectUnchecked =
function Promise$_rejectUnchecked(reason, trace) {
    if (!this.isPending()) return;
    if (reason === this) {
        var err = makeSelfResolutionError();
        this._attachExtraTrace(err);
        return this._rejectUnchecked(err);
    }
    this._cleanValues();
    this._setRejected();
    this._settledValue = reason;

    if (this._isFinal()) {
        async.invokeLater(thrower, void 0, trace === void 0 ? reason : trace);
        return;
    }
    var len = this._length();

    if (trace !== void 0) this._setCarriedStackTrace(trace);

    if (len > 0) {
        async.invoke(this._rejectPromises, this, null);
    } else {
        this._ensurePossibleRejectionHandled();
    }
};

Promise.prototype._rejectPromises = function Promise$_rejectPromises() {
    this._settlePromises();
    this._unsetCarriedStackTrace();
};

Promise.prototype._settlePromises = function Promise$_settlePromises() {
    var len = this._length();
    for (var i = 0; i < len; i++) {
        this._settlePromiseAt(i);
    }
};

Promise.prototype._ensurePossibleRejectionHandled =
function Promise$_ensurePossibleRejectionHandled() {
    this._setRejectionIsUnhandled();
    if (CapturedTrace.possiblyUnhandledRejection !== void 0) {
        async.invokeLater(this._notifyUnhandledRejection, this, void 0);
    }
};

Promise.prototype._notifyUnhandledRejectionIsHandled =
function Promise$_notifyUnhandledRejectionIsHandled() {
    if (typeof unhandledRejectionHandled === "function") {
        async.invokeLater(unhandledRejectionHandled, void 0, this);
    }
};

Promise.prototype._notifyUnhandledRejection =
function Promise$_notifyUnhandledRejection() {
    if (this._isRejectionUnhandled()) {
        var reason = this._settledValue;
        var trace = this._getCarriedStackTrace();

        this._setUnhandledRejectionIsNotified();

        if (trace !== void 0) {
            this._unsetCarriedStackTrace();
            reason = trace;
        }
        if (typeof CapturedTrace.possiblyUnhandledRejection === "function") {
            CapturedTrace.possiblyUnhandledRejection(reason, this);
        }
    }
};

var contextStack = [];
Promise.prototype._peekContext = function Promise$_peekContext() {
    var lastIndex = contextStack.length - 1;
    if (lastIndex >= 0) {
        return contextStack[lastIndex];
    }
    return void 0;

};

Promise.prototype._pushContext = function Promise$_pushContext() {
    if (!debugging) return;
    contextStack.push(this);
};

Promise.prototype._popContext = function Promise$_popContext() {
    if (!debugging) return;
    contextStack.pop();
};

Promise.noConflict = function Promise$NoConflict() {
    return noConflict(Promise);
};

Promise.setScheduler = function(fn) {
    if (typeof fn !== "function") throw new TypeError("fn must be a function");
    async._schedule = fn;
};

if (!CapturedTrace.isSupported()) {
    Promise.longStackTraces = function(){};
    debugging = false;
}

Promise._makeSelfResolutionError = makeSelfResolutionError;
require("./finally.js")(Promise, NEXT_FILTER, cast);
require("./direct_resolve.js")(Promise);
require("./synchronous_inspection.js")(Promise);
require("./join.js")(Promise, PromiseArray, cast, INTERNAL);
Promise.RangeError = RangeError;
Promise.CancellationError = CancellationError;
Promise.TimeoutError = TimeoutError;
Promise.TypeError = TypeError;
Promise.OperationalError = OperationalError;
Promise.RejectionError = OperationalError;
Promise.AggregateError = errors.AggregateError;

util.toFastProperties(Promise);
util.toFastProperties(Promise.prototype);
Promise.Promise = Promise;
require('./timers.js')(Promise,INTERNAL,cast);
require('./race.js')(Promise,INTERNAL,cast);
require('./call_get.js')(Promise);
require('./generators.js')(Promise,apiRejection,INTERNAL,cast);
require('./map.js')(Promise,PromiseArray,apiRejection,cast,INTERNAL);
require('./nodeify.js')(Promise);
require('./promisify.js')(Promise,INTERNAL);
require('./props.js')(Promise,PromiseArray,cast);
require('./reduce.js')(Promise,PromiseArray,apiRejection,cast,INTERNAL);
require('./settle.js')(Promise,PromiseArray);
require('./some.js')(Promise,PromiseArray,apiRejection);
require('./progress.js')(Promise,PromiseArray);
require('./cancel.js')(Promise,INTERNAL);
require('./filter.js')(Promise,INTERNAL);
require('./any.js')(Promise,PromiseArray);
require('./each.js')(Promise,INTERNAL);
require('./using.js')(Promise,apiRejection,cast);

Promise.prototype = Promise.prototype;
return Promise;

};

})(require("__browserify_process"))
},{"./util.js":62,"./async.js":63,"./errors.js":64,"./thenables.js":65,"./promise_array.js":66,"./captured_trace.js":67,"./catch_filter.js":68,"./promise_resolver.js":69,"./finally.js":70,"./direct_resolve.js":71,"./synchronous_inspection.js":72,"./join.js":73,"./timers.js":74,"./race.js":75,"./call_get.js":76,"./generators.js":77,"./map.js":78,"./nodeify.js":79,"./promisify.js":80,"./props.js":81,"./reduce.js":82,"./settle.js":83,"./some.js":84,"./progress.js":85,"./cancel.js":86,"./filter.js":87,"./any.js":88,"./each.js":89,"./using.js":90,"./errors_api_rejection":91,"__browserify_process":61}],51:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _
) {

  /**
   * A basic Ref serves as a means of indirection between references and their
   * values, allowing an outside agent to modify the underlying value.
   */
  var Ref = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Ref.prototype, {
    initialize: function(val) {
      this._val = val;
    },

    /**
     * Return the value boxed by this Ref
     *
     * @returns {dynamic}
     */
    get: function() {
      return this._val;
    },

    /**
     * Set a new boxed value. Note this method is specific to this Ref
     * implementation, and not the Ref protocol, which only defines
     * `Ref#get()`.
     *
     * @param newVal {dynamic} the value to box
     */
    set: function(newVal) {
      if (newVal instanceof Ref) {
        this._val = newVal.get();
      } else {
        this._val = newVal;
      }
    }
  });

  return Ref;
};

module.exports = mod(
  require("underscore")
);

})()
},{"underscore":57}],50:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _
) {

  /**
   * A ref whose boxed value is another ref
   */
  var DelegatingRef = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(DelegatingRef.prototype, {
    initialize: function(ref) {
      this._delegateRef = ref;
    },
    get: function() {
      return this._delegateRef.get();
    }
  });

  return DelegatingRef;
};

module.exports = mod(
  require("underscore")
);

})()
},{"underscore":57}],72:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise) {
function PromiseInspection(promise) {
    if (promise !== void 0) {
        this._bitField = promise._bitField;
        this._settledValue = promise.isResolved()
            ? promise._settledValue
            : void 0;
    }
    else {
        this._bitField = 0;
        this._settledValue = void 0;
    }
}

PromiseInspection.prototype.isFulfilled =
Promise.prototype.isFulfilled = function Promise$isFulfilled() {
    return (this._bitField & 268435456) > 0;
};

PromiseInspection.prototype.isRejected =
Promise.prototype.isRejected = function Promise$isRejected() {
    return (this._bitField & 134217728) > 0;
};

PromiseInspection.prototype.isPending =
Promise.prototype.isPending = function Promise$isPending() {
    return (this._bitField & 402653184) === 0;
};

PromiseInspection.prototype.value =
Promise.prototype.value = function Promise$value() {
    if (!this.isFulfilled()) {
        throw new TypeError("cannot get fulfillment value of a non-fulfilled promise");
    }
    return this._settledValue;
};

PromiseInspection.prototype.error =
PromiseInspection.prototype.reason =
Promise.prototype.reason = function Promise$reason() {
    if (!this.isRejected()) {
        throw new TypeError("cannot get rejection reason of a non-rejected promise");
    }
    return this._settledValue;
};

PromiseInspection.prototype.isResolved =
Promise.prototype.isResolved = function Promise$isResolved() {
    return (this._bitField & 402653184) > 0;
};

Promise.PromiseInspection = PromiseInspection;
};

},{}],87:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, INTERNAL) {
var PromiseMap = Promise.map;

Promise.prototype.filter = function Promise$filter(fn, options) {
    return PromiseMap(this, fn, options, INTERNAL);
};

Promise.filter = function Promise$Filter(promises, fn, options) {
    return PromiseMap(promises, fn, options, INTERNAL);
};
};

},{}],88:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise) {
var SomePromiseArray = Promise._SomePromiseArray;
function Promise$_Any(promises) {
    var ret = new SomePromiseArray(promises);
    var promise = ret.promise();
    if (promise.isRejected()) {
        return promise;
    }
    ret.setHowMany(1);
    ret.setUnwrap();
    ret.init();
    return promise;
}

Promise.any = function Promise$Any(promises) {
    return Promise$_Any(promises);
};

Promise.prototype.any = function Promise$any() {
    return Promise$_Any(this);
};

};

},{}],89:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, INTERNAL) {
var PromiseReduce = Promise.reduce;

Promise.prototype.each = function Promise$each(fn) {
    return PromiseReduce(this, fn, null, INTERNAL);
};

Promise.each = function Promise$Each(promises, fn) {
    return PromiseReduce(promises, fn, null, INTERNAL);
};
};

},{}],52:[function(require,module,exports){
"use strict";

var mod = function(
  _
) {

  var SetTimeoutScheduler = function() {
    this.initialize.apply(this, arguments);
  }

  _.extend(SetTimeoutScheduler.prototype, {
    initialize: function() {},

    runSoon: function(fn) {
      this.schedule(fn);
    },
    schedule: function(fn, delay) {
      delay = delay || 1;
      return setTimeout(fn, delay);
    },

    unschedule: function(id) {
      return clearTimeout(id);
    }
  });

  return SetTimeoutScheduler;
};

module.exports = mod(
  require("underscore")
);

},{"underscore":57}],62:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var es5 = require("./es5.js");
var haveGetters = (function(){
    try {
        var o = {};
        es5.defineProperty(o, "f", {
            get: function () {
                return 3;
            }
        });
        return o.f === 3;
    }
    catch (e) {
        return false;
    }

})();
var canEvaluate = typeof navigator == "undefined";
var errorObj = {e: {}};
function tryCatch1(fn, receiver, arg) {
    try { return fn.call(receiver, arg); }
    catch (e) {
        errorObj.e = e;
        return errorObj;
    }
}

function tryCatch2(fn, receiver, arg, arg2) {
    try { return fn.call(receiver, arg, arg2); }
    catch (e) {
        errorObj.e = e;
        return errorObj;
    }
}

function tryCatch3(fn, receiver, arg, arg2, arg3) {
    try { return fn.call(receiver, arg, arg2, arg3); }
    catch (e) {
        errorObj.e = e;
        return errorObj;
    }
}

function tryCatch4(fn, receiver, arg, arg2, arg3, arg4) {
    try { return fn.call(receiver, arg, arg2, arg3, arg4); }
    catch (e) {
        errorObj.e = e;
        return errorObj;
    }
}

function tryCatchApply(fn, args, receiver) {
    try { return fn.apply(receiver, args); }
    catch (e) {
        errorObj.e = e;
        return errorObj;
    }
}

var inherits = function(Child, Parent) {
    var hasProp = {}.hasOwnProperty;

    function T() {
        this.constructor = Child;
        this.constructor$ = Parent;
        for (var propertyName in Parent.prototype) {
            if (hasProp.call(Parent.prototype, propertyName) &&
                propertyName.charAt(propertyName.length-1) !== "$"
           ) {
                this[propertyName + "$"] = Parent.prototype[propertyName];
            }
        }
    }
    T.prototype = Parent.prototype;
    Child.prototype = new T();
    return Child.prototype;
};

function asString(val) {
    return typeof val === "string" ? val : ("" + val);
}

function isPrimitive(val) {
    return val == null || val === true || val === false ||
        typeof val === "string" || typeof val === "number";

}

function isObject(value) {
    return !isPrimitive(value);
}

function maybeWrapAsError(maybeError) {
    if (!isPrimitive(maybeError)) return maybeError;

    return new Error(asString(maybeError));
}

function withAppended(target, appendee) {
    var len = target.length;
    var ret = new Array(len + 1);
    var i;
    for (i = 0; i < len; ++i) {
        ret[i] = target[i];
    }
    ret[i] = appendee;
    return ret;
}

function getDataPropertyOrDefault(obj, key, defaultValue) {
    if (es5.isES5) {
        var desc = Object.getOwnPropertyDescriptor(obj, key);
        if (desc != null) {
            return desc.get == null && desc.set == null
                    ? desc.value
                    : defaultValue;
        }
    } else {
        return {}.hasOwnProperty.call(obj, key) ? obj[key] : void 0;
    }
}

function notEnumerableProp(obj, name, value) {
    if (isPrimitive(obj)) return obj;
    var descriptor = {
        value: value,
        configurable: true,
        enumerable: false,
        writable: true
    };
    es5.defineProperty(obj, name, descriptor);
    return obj;
}


var wrapsPrimitiveReceiver = (function() {
    return this !== "string";
}).call("string");

function thrower(r) {
    throw r;
}

var inheritedDataKeys = (function() {
    if (es5.isES5) {
        return function(obj, opts) {
            var ret = [];
            var visitedKeys = Object.create(null);
            var getKeys = Object(opts).includeHidden
                ? Object.getOwnPropertyNames
                : Object.keys;
            while (obj != null) {
                var keys;
                try {
                    keys = getKeys(obj);
                } catch (e) {
                    return ret;
                }
                for (var i = 0; i < keys.length; ++i) {
                    var key = keys[i];
                    if (visitedKeys[key]) continue;
                    visitedKeys[key] = true;
                    var desc = Object.getOwnPropertyDescriptor(obj, key);
                    if (desc != null && desc.get == null && desc.set == null) {
                        ret.push(key);
                    }
                }
                obj = es5.getPrototypeOf(obj);
            }
            return ret;
        };
    } else {
        return function(obj) {
            var ret = [];
            /*jshint forin:false */
            for (var key in obj) {
                ret.push(key);
            }
            return ret;
        };
    }

})();

function isClass(fn) {
    try {
        if (typeof fn === "function") {
            var keys = es5.keys(fn.prototype);
            return keys.length > 0 &&
                   !(keys.length === 1 && keys[0] === "constructor");
        }
        return false;
    } catch (e) {
        return false;
    }
}

function toFastProperties(obj) {
    /*jshint -W027*/
    function f() {}
    f.prototype = obj;
    return f;
    eval(obj);
}

var rident = /^[a-z$_][a-z$_0-9]*$/i;
function isIdentifier(str) {
    return rident.test(str);
}

function filledRange(count, prefix, suffix) {
    var ret = new Array(count);
    for(var i = 0; i < count; ++i) {
        ret[i] = prefix + i + suffix;
    }
    return ret;
}

var ret = {
    isClass: isClass,
    isIdentifier: isIdentifier,
    inheritedDataKeys: inheritedDataKeys,
    getDataPropertyOrDefault: getDataPropertyOrDefault,
    thrower: thrower,
    isArray: es5.isArray,
    haveGetters: haveGetters,
    notEnumerableProp: notEnumerableProp,
    isPrimitive: isPrimitive,
    isObject: isObject,
    canEvaluate: canEvaluate,
    errorObj: errorObj,
    tryCatch1: tryCatch1,
    tryCatch2: tryCatch2,
    tryCatch3: tryCatch3,
    tryCatch4: tryCatch4,
    tryCatchApply: tryCatchApply,
    inherits: inherits,
    withAppended: withAppended,
    asString: asString,
    maybeWrapAsError: maybeWrapAsError,
    wrapsPrimitiveReceiver: wrapsPrimitiveReceiver,
    toFastProperties: toFastProperties,
    filledRange: filledRange
};

module.exports = ret;

},{"./es5.js":92}],63:[function(require,module,exports){
(function(process){/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var schedule = require("./schedule.js");
var Queue = require("./queue.js");
var errorObj = require("./util.js").errorObj;
var tryCatch1 = require("./util.js").tryCatch1;
var _process = typeof process !== "undefined" ? process : void 0;

function Async() {
    this._isTickUsed = false;
    this._schedule = schedule;
    this._length = 0;
    this._lateBuffer = new Queue(16);
    this._functionBuffer = new Queue(65536);
    var self = this;
    this.consumeFunctionBuffer = function Async$consumeFunctionBuffer() {
        self._consumeFunctionBuffer();
    };
}

Async.prototype.haveItemsQueued = function Async$haveItemsQueued() {
    return this._length > 0;
};

Async.prototype.invokeLater = function Async$invokeLater(fn, receiver, arg) {
    if (_process !== void 0 &&
        _process.domain != null &&
        !fn.domain) {
        fn = _process.domain.bind(fn);
    }
    this._lateBuffer.push(fn, receiver, arg);
    this._queueTick();
};

Async.prototype.invoke = function Async$invoke(fn, receiver, arg) {
    if (_process !== void 0 &&
        _process.domain != null &&
        !fn.domain) {
        fn = _process.domain.bind(fn);
    }
    var functionBuffer = this._functionBuffer;
    functionBuffer.push(fn, receiver, arg);
    this._length = functionBuffer.length();
    this._queueTick();
};

Async.prototype._consumeFunctionBuffer =
function Async$_consumeFunctionBuffer() {
    var functionBuffer = this._functionBuffer;
    while (functionBuffer.length() > 0) {
        var fn = functionBuffer.shift();
        var receiver = functionBuffer.shift();
        var arg = functionBuffer.shift();
        fn.call(receiver, arg);
    }
    this._reset();
    this._consumeLateBuffer();
};

Async.prototype._consumeLateBuffer = function Async$_consumeLateBuffer() {
    var buffer = this._lateBuffer;
    while(buffer.length() > 0) {
        var fn = buffer.shift();
        var receiver = buffer.shift();
        var arg = buffer.shift();
        var res = tryCatch1(fn, receiver, arg);
        if (res === errorObj) {
            this._queueTick();
            if (fn.domain != null) {
                fn.domain.emit("error", res.e);
            } else {
                throw res.e;
            }
        }
    }
};

Async.prototype._queueTick = function Async$_queue() {
    if (!this._isTickUsed) {
        this._schedule(this.consumeFunctionBuffer);
        this._isTickUsed = true;
    }
};

Async.prototype._reset = function Async$_reset() {
    this._isTickUsed = false;
    this._length = 0;
};

module.exports = new Async();

})(require("__browserify_process"))
},{"./schedule.js":93,"./queue.js":94,"./util.js":62,"__browserify_process":61}],64:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var Objectfreeze = require("./es5.js").freeze;
var util = require("./util.js");
var inherits = util.inherits;
var notEnumerableProp = util.notEnumerableProp;

function markAsOriginatingFromRejection(e) {
    try {
        notEnumerableProp(e, "isOperational", true);
    }
    catch(ignore) {}
}

function originatesFromRejection(e) {
    if (e == null) return false;
    return ((e instanceof OperationalError) ||
        e["isOperational"] === true);
}

function isError(obj) {
    return obj instanceof Error;
}

function canAttach(obj) {
    return isError(obj);
}

function subError(nameProperty, defaultMessage) {
    function SubError(message) {
        if (!(this instanceof SubError)) return new SubError(message);
        this.message = typeof message === "string" ? message : defaultMessage;
        this.name = nameProperty;
        if (Error.captureStackTrace) {
            Error.captureStackTrace(this, this.constructor);
        }
    }
    inherits(SubError, Error);
    return SubError;
}

var _TypeError, _RangeError;
var CancellationError = subError("CancellationError", "cancellation error");
var TimeoutError = subError("TimeoutError", "timeout error");
var AggregateError = subError("AggregateError", "aggregate error");
try {
    _TypeError = TypeError;
    _RangeError = RangeError;
} catch(e) {
    _TypeError = subError("TypeError", "type error");
    _RangeError = subError("RangeError", "range error");
}

var methods = ("join pop push shift unshift slice filter forEach some " +
    "every map indexOf lastIndexOf reduce reduceRight sort reverse").split(" ");

for (var i = 0; i < methods.length; ++i) {
    if (typeof Array.prototype[methods[i]] === "function") {
        AggregateError.prototype[methods[i]] = Array.prototype[methods[i]];
    }
}

AggregateError.prototype.length = 0;
AggregateError.prototype["isOperational"] = true;
var level = 0;
AggregateError.prototype.toString = function() {
    var indent = Array(level * 4 + 1).join(" ");
    var ret = "\n" + indent + "AggregateError of:" + "\n";
    level++;
    indent = Array(level * 4 + 1).join(" ");
    for (var i = 0; i < this.length; ++i) {
        var str = this[i] === this ? "[Circular AggregateError]" : this[i] + "";
        var lines = str.split("\n");
        for (var j = 0; j < lines.length; ++j) {
            lines[j] = indent + lines[j];
        }
        str = lines.join("\n");
        ret += str + "\n";
    }
    level--;
    return ret;
};

function OperationalError(message) {
    this.name = "OperationalError";
    this.message = message;
    this.cause = message;
    this["isOperational"] = true;

    if (message instanceof Error) {
        this.message = message.message;
        this.stack = message.stack;
    } else if (Error.captureStackTrace) {
        Error.captureStackTrace(this, this.constructor);
    }

}
inherits(OperationalError, Error);

var key = "__BluebirdErrorTypes__";
var errorTypes = Error[key];
if (!errorTypes) {
    errorTypes = Objectfreeze({
        CancellationError: CancellationError,
        TimeoutError: TimeoutError,
        OperationalError: OperationalError,
        RejectionError: OperationalError,
        AggregateError: AggregateError
    });
    notEnumerableProp(Error, key, errorTypes);
}

module.exports = {
    Error: Error,
    TypeError: _TypeError,
    RangeError: _RangeError,
    CancellationError: errorTypes.CancellationError,
    OperationalError: errorTypes.OperationalError,
    TimeoutError: errorTypes.TimeoutError,
    AggregateError: errorTypes.AggregateError,
    originatesFromRejection: originatesFromRejection,
    markAsOriginatingFromRejection: markAsOriginatingFromRejection,
    canAttach: canAttach
};

},{"./es5.js":92,"./util.js":62}],65:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, INTERNAL) {
var util = require("./util.js");
var canAttach = require("./errors.js").canAttach;
var errorObj = util.errorObj;
var isObject = util.isObject;

function getThen(obj) {
    try {
        return obj.then;
    }
    catch(e) {
        errorObj.e = e;
        return errorObj;
    }
}

function Promise$_Cast(obj, originalPromise) {
    if (isObject(obj)) {
        if (obj instanceof Promise) {
            return obj;
        }
        else if (isAnyBluebirdPromise(obj)) {
            var ret = new Promise(INTERNAL);
            ret._setTrace(void 0);
            obj._then(
                ret._fulfillUnchecked,
                ret._rejectUncheckedCheckError,
                ret._progressUnchecked,
                ret,
                null
            );
            ret._setFollowing();
            return ret;
        }
        var then = getThen(obj);
        if (then === errorObj) {
            if (originalPromise !== void 0 && canAttach(then.e)) {
                originalPromise._attachExtraTrace(then.e);
            }
            return Promise.reject(then.e);
        } else if (typeof then === "function") {
            return Promise$_doThenable(obj, then, originalPromise);
        }
    }
    return obj;
}

var hasProp = {}.hasOwnProperty;
function isAnyBluebirdPromise(obj) {
    return hasProp.call(obj, "_promise0");
}

function Promise$_doThenable(x, then, originalPromise) {
    var resolver = Promise.defer();
    var called = false;
    try {
        then.call(
            x,
            Promise$_resolveFromThenable,
            Promise$_rejectFromThenable,
            Promise$_progressFromThenable
        );
    } catch(e) {
        if (!called) {
            called = true;
            var trace = canAttach(e) ? e : new Error(e + "");
            if (originalPromise !== void 0) {
                originalPromise._attachExtraTrace(trace);
            }
            resolver.promise._reject(e, trace);
        }
    }
    return resolver.promise;

    function Promise$_resolveFromThenable(y) {
        if (called) return;
        called = true;

        if (x === y) {
            var e = Promise._makeSelfResolutionError();
            if (originalPromise !== void 0) {
                originalPromise._attachExtraTrace(e);
            }
            resolver.promise._reject(e, void 0);
            return;
        }
        resolver.resolve(y);
    }

    function Promise$_rejectFromThenable(r) {
        if (called) return;
        called = true;
        var trace = canAttach(r) ? r : new Error(r + "");
        if (originalPromise !== void 0) {
            originalPromise._attachExtraTrace(trace);
        }
        resolver.promise._reject(r, trace);
    }

    function Promise$_progressFromThenable(v) {
        if (called) return;
        var promise = resolver.promise;
        if (typeof promise._progress === "function") {
            promise._progress(v);
        }
    }
}

return Promise$_Cast;
};

},{"./util.js":62,"./errors.js":64}],66:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, INTERNAL, cast) {
var canAttach = require("./errors.js").canAttach;
var util = require("./util.js");
var isArray = util.isArray;

function toResolutionValue(val) {
    switch(val) {
    case -1: return void 0;
    case -2: return [];
    case -3: return {};
    }
}

function PromiseArray(values) {
    var promise = this._promise = new Promise(INTERNAL);
    var parent = void 0;
    if (values instanceof Promise) {
        parent = values;
        promise._propagateFrom(parent, 1 | 4);
    }
    promise._setTrace(parent);
    this._values = values;
    this._length = 0;
    this._totalResolved = 0;
    this._init(void 0, -2);
}
PromiseArray.prototype.length = function PromiseArray$length() {
    return this._length;
};

PromiseArray.prototype.promise = function PromiseArray$promise() {
    return this._promise;
};

PromiseArray.prototype._init =
function PromiseArray$_init(_, resolveValueIfEmpty) {
    var values = cast(this._values, void 0);
    if (values instanceof Promise) {
        this._values = values;
        values._setBoundTo(this._promise._boundTo);
        if (values.isFulfilled()) {
            values = values._settledValue;
            if (!isArray(values)) {
                var err = new Promise.TypeError("expecting an array, a promise or a thenable");
                this.__hardReject__(err);
                return;
            }
        } else if (values.isPending()) {
            values._then(
                PromiseArray$_init,
                this._reject,
                void 0,
                this,
                resolveValueIfEmpty
           );
            return;
        } else {
            values._unsetRejectionIsUnhandled();
            this._reject(values._settledValue);
            return;
        }
    } else if (!isArray(values)) {
        var err = new Promise.TypeError("expecting an array, a promise or a thenable");
        this.__hardReject__(err);
        return;
    }

    if (values.length === 0) {
        if (resolveValueIfEmpty === -5) {
            this._resolveEmptyArray();
        }
        else {
            this._resolve(toResolutionValue(resolveValueIfEmpty));
        }
        return;
    }
    var len = this.getActualLength(values.length);
    var newLen = len;
    var newValues = this.shouldCopyValues() ? new Array(len) : this._values;
    var isDirectScanNeeded = false;
    for (var i = 0; i < len; ++i) {
        var maybePromise = cast(values[i], void 0);
        if (maybePromise instanceof Promise) {
            if (maybePromise.isPending()) {
                maybePromise._proxyPromiseArray(this, i);
            } else {
                maybePromise._unsetRejectionIsUnhandled();
                isDirectScanNeeded = true;
            }
        } else {
            isDirectScanNeeded = true;
        }
        newValues[i] = maybePromise;
    }
    this._values = newValues;
    this._length = newLen;
    if (isDirectScanNeeded) {
        this._scanDirectValues(len);
    }
};

PromiseArray.prototype._settlePromiseAt =
function PromiseArray$_settlePromiseAt(index) {
    var value = this._values[index];
    if (!(value instanceof Promise)) {
        this._promiseFulfilled(value, index);
    } else if (value.isFulfilled()) {
        this._promiseFulfilled(value._settledValue, index);
    } else if (value.isRejected()) {
        this._promiseRejected(value._settledValue, index);
    }
};

PromiseArray.prototype._scanDirectValues =
function PromiseArray$_scanDirectValues(len) {
    for (var i = 0; i < len; ++i) {
        if (this._isResolved()) {
            break;
        }
        this._settlePromiseAt(i);
    }
};

PromiseArray.prototype._isResolved = function PromiseArray$_isResolved() {
    return this._values === null;
};

PromiseArray.prototype._resolve = function PromiseArray$_resolve(value) {
    this._values = null;
    this._promise._fulfill(value);
};

PromiseArray.prototype.__hardReject__ =
PromiseArray.prototype._reject = function PromiseArray$_reject(reason) {
    this._values = null;
    var trace = canAttach(reason) ? reason : new Error(reason + "");
    this._promise._attachExtraTrace(trace);
    this._promise._reject(reason, trace);
};

PromiseArray.prototype._promiseProgressed =
function PromiseArray$_promiseProgressed(progressValue, index) {
    if (this._isResolved()) return;
    this._promise._progress({
        index: index,
        value: progressValue
    });
};


PromiseArray.prototype._promiseFulfilled =
function PromiseArray$_promiseFulfilled(value, index) {
    if (this._isResolved()) return;
    this._values[index] = value;
    var totalResolved = ++this._totalResolved;
    if (totalResolved >= this._length) {
        this._resolve(this._values);
    }
};

PromiseArray.prototype._promiseRejected =
function PromiseArray$_promiseRejected(reason, index) {
    if (this._isResolved()) return;
    this._totalResolved++;
    this._reject(reason);
};

PromiseArray.prototype.shouldCopyValues =
function PromiseArray$_shouldCopyValues() {
    return true;
};

PromiseArray.prototype.getActualLength =
function PromiseArray$getActualLength(len) {
    return len;
};

return PromiseArray;
};

},{"./errors.js":64,"./util.js":62}],67:[function(require,module,exports){
(function(){/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function() {
var inherits = require("./util.js").inherits;
var defineProperty = require("./es5.js").defineProperty;

var rignore = new RegExp(
    "\\b(?:[a-zA-Z0-9.]+\\$_\\w+|" +
    "tryCatch(?:1|2|3|4|Apply)|new \\w*PromiseArray|" +
    "\\w*PromiseArray\\.\\w*PromiseArray|" +
    "setTimeout|CatchFilter\\$_\\w+|makeNodePromisified|processImmediate|" +
    "process._tickCallback|nextTick|Async\\$\\w+)\\b"
);

var rtraceline = null;
var formatStack = null;

function formatNonError(obj) {
    var str;
    if (typeof obj === "function") {
        str = "[function " +
            (obj.name || "anonymous") +
            "]";
    } else {
        str = obj.toString();
        var ruselessToString = /\[object [a-zA-Z0-9$_]+\]/;
        if (ruselessToString.test(str)) {
            try {
                var newStr = JSON.stringify(obj);
                str = newStr;
            }
            catch(e) {

            }
        }
        if (str.length === 0) {
            str = "(empty array)";
        }
    }
    return ("(<" + snip(str) + ">, no stack trace)");
}

function snip(str) {
    var maxChars = 41;
    if (str.length < maxChars) {
        return str;
    }
    return str.substr(0, maxChars - 3) + "...";
}

function CapturedTrace(ignoreUntil, isTopLevel) {
    this.captureStackTrace(CapturedTrace, isTopLevel);

}
inherits(CapturedTrace, Error);

CapturedTrace.prototype.captureStackTrace =
function CapturedTrace$captureStackTrace(ignoreUntil, isTopLevel) {
    captureStackTrace(this, ignoreUntil, isTopLevel);
};

CapturedTrace.possiblyUnhandledRejection =
function CapturedTrace$PossiblyUnhandledRejection(reason) {
    if (typeof console === "object") {
        var message;
        if (typeof reason === "object" || typeof reason === "function") {
            var stack = reason.stack;
            message = "Possibly unhandled " + formatStack(stack, reason);
        } else {
            message = "Possibly unhandled " + String(reason);
        }
        if (typeof console.error === "function" ||
            typeof console.error === "object") {
            console.error(message);
        } else if (typeof console.log === "function" ||
            typeof console.log === "object") {
            console.log(message);
        }
    }
};

CapturedTrace.combine = function CapturedTrace$Combine(current, prev) {
    var curLast = current.length - 1;
    for (var i = prev.length - 1; i >= 0; --i) {
        var line = prev[i];
        if (current[curLast] === line) {
            current.pop();
            curLast--;
        } else {
            break;
        }
    }

    current.push("From previous event:");
    var lines = current.concat(prev);

    var ret = [];

    for (var i = 0, len = lines.length; i < len; ++i) {

        if ((rignore.test(lines[i]) ||
            (i > 0 && !rtraceline.test(lines[i])) &&
            lines[i] !== "From previous event:")
       ) {
            continue;
        }
        ret.push(lines[i]);
    }
    return ret;
};

CapturedTrace.protectErrorMessageNewlines = function(stack) {
    for (var i = 0; i < stack.length; ++i) {
        if (rtraceline.test(stack[i])) {
            break;
        }
    }

    if (i <= 1) return;

    var errorMessageLines = [];
    for (var j = 0; j < i; ++j) {
        errorMessageLines.push(stack.shift());
    }
    stack.unshift(errorMessageLines.join("\u0002\u0000\u0001"));
};

CapturedTrace.isSupported = function CapturedTrace$IsSupported() {
    return typeof captureStackTrace === "function";
};

var captureStackTrace = (function stackDetection() {
    if (typeof Error.stackTraceLimit === "number" &&
        typeof Error.captureStackTrace === "function") {
        rtraceline = /^\s*at\s*/;
        formatStack = function(stack, error) {
            if (typeof stack === "string") return stack;

            if (error.name !== void 0 &&
                error.message !== void 0) {
                return error.name + ". " + error.message;
            }
            return formatNonError(error);


        };
        var captureStackTrace = Error.captureStackTrace;
        return function CapturedTrace$_captureStackTrace(
            receiver, ignoreUntil) {
            captureStackTrace(receiver, ignoreUntil);
        };
    }
    var err = new Error();

    if (typeof err.stack === "string" &&
        typeof "".startsWith === "function" &&
        (err.stack.startsWith("stackDetection@")) &&
        stackDetection.name === "stackDetection") {

        defineProperty(Error, "stackTraceLimit", {
            writable: true,
            enumerable: false,
            configurable: false,
            value: 25
        });
        rtraceline = /@/;
        var rline = /[@\n]/;

        formatStack = function(stack, error) {
            if (typeof stack === "string") {
                return (error.name + ". " + error.message + "\n" + stack);
            }

            if (error.name !== void 0 &&
                error.message !== void 0) {
                return error.name + ". " + error.message;
            }
            return formatNonError(error);
        };

        return function captureStackTrace(o) {
            var stack = new Error().stack;
            var split = stack.split(rline);
            var len = split.length;
            var ret = "";
            for (var i = 0; i < len; i += 2) {
                ret += split[i];
                ret += "@";
                ret += split[i + 1];
                ret += "\n";
            }
            o.stack = ret;
        };
    } else {
        formatStack = function(stack, error) {
            if (typeof stack === "string") return stack;

            if ((typeof error === "object" ||
                typeof error === "function") &&
                error.name !== void 0 &&
                error.message !== void 0) {
                return error.name + ". " + error.message;
            }
            return formatNonError(error);
        };

        return null;
    }
})();

return CapturedTrace;
};

})()
},{"./util.js":62,"./es5.js":92}],68:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(NEXT_FILTER) {
var util = require("./util.js");
var errors = require("./errors.js");
var tryCatch1 = util.tryCatch1;
var errorObj = util.errorObj;
var keys = require("./es5.js").keys;
var TypeError = errors.TypeError;

function CatchFilter(instances, callback, promise) {
    this._instances = instances;
    this._callback = callback;
    this._promise = promise;
}

function CatchFilter$_safePredicate(predicate, e) {
    var safeObject = {};
    var retfilter = tryCatch1(predicate, safeObject, e);

    if (retfilter === errorObj) return retfilter;

    var safeKeys = keys(safeObject);
    if (safeKeys.length) {
        errorObj.e = new TypeError(
            "Catch filter must inherit from Error "
          + "or be a simple predicate function");
        return errorObj;
    }
    return retfilter;
}

CatchFilter.prototype.doFilter = function CatchFilter$_doFilter(e) {
    var cb = this._callback;
    var promise = this._promise;
    var boundTo = promise._boundTo;
    for (var i = 0, len = this._instances.length; i < len; ++i) {
        var item = this._instances[i];
        var itemIsErrorType = item === Error ||
            (item != null && item.prototype instanceof Error);

        if (itemIsErrorType && e instanceof item) {
            var ret = tryCatch1(cb, boundTo, e);
            if (ret === errorObj) {
                NEXT_FILTER.e = ret.e;
                return NEXT_FILTER;
            }
            return ret;
        } else if (typeof item === "function" && !itemIsErrorType) {
            var shouldHandle = CatchFilter$_safePredicate(item, e);
            if (shouldHandle === errorObj) {
                var trace = errors.canAttach(errorObj.e)
                    ? errorObj.e
                    : new Error(errorObj.e + "");
                this._promise._attachExtraTrace(trace);
                e = errorObj.e;
                break;
            } else if (shouldHandle) {
                var ret = tryCatch1(cb, boundTo, e);
                if (ret === errorObj) {
                    NEXT_FILTER.e = ret.e;
                    return NEXT_FILTER;
                }
                return ret;
            }
        }
    }
    NEXT_FILTER.e = e;
    return NEXT_FILTER;
};

return CatchFilter;
};

},{"./util.js":62,"./errors.js":64,"./es5.js":92}],69:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var util = require("./util.js");
var maybeWrapAsError = util.maybeWrapAsError;
var errors = require("./errors.js");
var TimeoutError = errors.TimeoutError;
var OperationalError = errors.OperationalError;
var async = require("./async.js");
var haveGetters = util.haveGetters;
var es5 = require("./es5.js");

function isUntypedError(obj) {
    return obj instanceof Error &&
        es5.getPrototypeOf(obj) === Error.prototype;
}

function wrapAsOperationalError(obj) {
    var ret;
    if (isUntypedError(obj)) {
        ret = new OperationalError(obj);
    } else {
        ret = obj;
    }
    errors.markAsOriginatingFromRejection(ret);
    return ret;
}

function nodebackForPromise(promise) {
    function PromiseResolver$_callback(err, value) {
        if (promise === null) return;

        if (err) {
            var wrapped = wrapAsOperationalError(maybeWrapAsError(err));
            promise._attachExtraTrace(wrapped);
            promise._reject(wrapped);
        } else if (arguments.length > 2) {
            var $_len = arguments.length;var args = new Array($_len - 1); for(var $_i = 1; $_i < $_len; ++$_i) {args[$_i - 1] = arguments[$_i];}
            promise._fulfill(args);
        } else {
            promise._fulfill(value);
        }

        promise = null;
    }
    return PromiseResolver$_callback;
}


var PromiseResolver;
if (!haveGetters) {
    PromiseResolver = function PromiseResolver(promise) {
        this.promise = promise;
        this.asCallback = nodebackForPromise(promise);
        this.callback = this.asCallback;
    };
}
else {
    PromiseResolver = function PromiseResolver(promise) {
        this.promise = promise;
    };
}
if (haveGetters) {
    var prop = {
        get: function() {
            return nodebackForPromise(this.promise);
        }
    };
    es5.defineProperty(PromiseResolver.prototype, "asCallback", prop);
    es5.defineProperty(PromiseResolver.prototype, "callback", prop);
}

PromiseResolver._nodebackForPromise = nodebackForPromise;

PromiseResolver.prototype.toString = function PromiseResolver$toString() {
    return "[object PromiseResolver]";
};

PromiseResolver.prototype.resolve =
PromiseResolver.prototype.fulfill = function PromiseResolver$resolve(value) {
    if (!(this instanceof PromiseResolver)) {
        throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");
    }

    var promise = this.promise;
    if (promise._tryFollow(value)) {
        return;
    }
    async.invoke(promise._fulfill, promise, value);
};

PromiseResolver.prototype.reject = function PromiseResolver$reject(reason) {
    if (!(this instanceof PromiseResolver)) {
        throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");
    }

    var promise = this.promise;
    errors.markAsOriginatingFromRejection(reason);
    var trace = errors.canAttach(reason) ? reason : new Error(reason + "");
    promise._attachExtraTrace(trace);
    async.invoke(promise._reject, promise, reason);
    if (trace !== reason) {
        async.invoke(this._setCarriedStackTrace, this, trace);
    }
};

PromiseResolver.prototype.progress =
function PromiseResolver$progress(value) {
    if (!(this instanceof PromiseResolver)) {
        throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");
    }
    async.invoke(this.promise._progress, this.promise, value);
};

PromiseResolver.prototype.cancel = function PromiseResolver$cancel() {
    async.invoke(this.promise.cancel, this.promise, void 0);
};

PromiseResolver.prototype.timeout = function PromiseResolver$timeout() {
    this.reject(new TimeoutError("timeout"));
};

PromiseResolver.prototype.isResolved = function PromiseResolver$isResolved() {
    return this.promise.isResolved();
};

PromiseResolver.prototype.toJSON = function PromiseResolver$toJSON() {
    return this.promise.toJSON();
};

PromiseResolver.prototype._setCarriedStackTrace =
function PromiseResolver$_setCarriedStackTrace(trace) {
    if (this.promise.isRejected()) {
        this.promise._setCarriedStackTrace(trace);
    }
};

module.exports = PromiseResolver;

},{"./util.js":62,"./errors.js":64,"./async.js":63,"./es5.js":92}],70:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, NEXT_FILTER, cast) {
var util = require("./util.js");
var wrapsPrimitiveReceiver = util.wrapsPrimitiveReceiver;
var isPrimitive = util.isPrimitive;
var thrower = util.thrower;

function returnThis() {
    return this;
}
function throwThis() {
    throw this;
}
function return$(r) {
    return function Promise$_returner() {
        return r;
    };
}
function throw$(r) {
    return function Promise$_thrower() {
        throw r;
    };
}
function promisedFinally(ret, reasonOrValue, isFulfilled) {
    var then;
    if (wrapsPrimitiveReceiver && isPrimitive(reasonOrValue)) {
        then = isFulfilled ? return$(reasonOrValue) : throw$(reasonOrValue);
    } else {
        then = isFulfilled ? returnThis : throwThis;
    }
    return ret._then(then, thrower, void 0, reasonOrValue, void 0);
}

function finallyHandler(reasonOrValue) {
    var promise = this.promise;
    var handler = this.handler;

    var ret = promise._isBound()
                    ? handler.call(promise._boundTo)
                    : handler();

    if (ret !== void 0) {
        var maybePromise = cast(ret, void 0);
        if (maybePromise instanceof Promise) {
            return promisedFinally(maybePromise, reasonOrValue,
                                    promise.isFulfilled());
        }
    }

    if (promise.isRejected()) {
        NEXT_FILTER.e = reasonOrValue;
        return NEXT_FILTER;
    } else {
        return reasonOrValue;
    }
}

function tapHandler(value) {
    var promise = this.promise;
    var handler = this.handler;

    var ret = promise._isBound()
                    ? handler.call(promise._boundTo, value)
                    : handler(value);

    if (ret !== void 0) {
        var maybePromise = cast(ret, void 0);
        if (maybePromise instanceof Promise) {
            return promisedFinally(maybePromise, value, true);
        }
    }
    return value;
}

Promise.prototype._passThroughHandler =
function Promise$_passThroughHandler(handler, isFinally) {
    if (typeof handler !== "function") return this.then();

    var promiseAndHandler = {
        promise: this,
        handler: handler
    };

    return this._then(
            isFinally ? finallyHandler : tapHandler,
            isFinally ? finallyHandler : void 0, void 0,
            promiseAndHandler, void 0);
};

Promise.prototype.lastly =
Promise.prototype["finally"] = function Promise$finally(handler) {
    return this._passThroughHandler(handler, true);
};

Promise.prototype.tap = function Promise$tap(handler) {
    return this._passThroughHandler(handler, false);
};
};

},{"./util.js":62}],71:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var util = require("./util.js");
var isPrimitive = util.isPrimitive;
var wrapsPrimitiveReceiver = util.wrapsPrimitiveReceiver;

module.exports = function(Promise) {
var returner = function Promise$_returner() {
    return this;
};
var thrower = function Promise$_thrower() {
    throw this;
};

var wrapper = function Promise$_wrapper(value, action) {
    if (action === 1) {
        return function Promise$_thrower() {
            throw value;
        };
    } else if (action === 2) {
        return function Promise$_returner() {
            return value;
        };
    }
};


Promise.prototype["return"] =
Promise.prototype.thenReturn =
function Promise$thenReturn(value) {
    if (wrapsPrimitiveReceiver && isPrimitive(value)) {
        return this._then(
            wrapper(value, 2),
            void 0,
            void 0,
            void 0,
            void 0
       );
    }
    return this._then(returner, void 0, void 0, value, void 0);
};

Promise.prototype["throw"] =
Promise.prototype.thenThrow =
function Promise$thenThrow(reason) {
    if (wrapsPrimitiveReceiver && isPrimitive(reason)) {
        return this._then(
            wrapper(reason, 1),
            void 0,
            void 0,
            void 0,
            void 0
       );
    }
    return this._then(thrower, void 0, void 0, reason, void 0);
};
};

},{"./util.js":62}],73:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports =
function(Promise, PromiseArray, cast, INTERNAL) {
var util = require("./util.js");
var canEvaluate = util.canEvaluate;
var tryCatch1 = util.tryCatch1;
var errorObj = util.errorObj;


if (canEvaluate) {
    var thenCallback = function(i) {
        return new Function("value", "holder", "                             \n\
            'use strict';                                                    \n\
            holder.pIndex = value;                                           \n\
            holder.checkFulfillment(this);                                   \n\
            ".replace(/Index/g, i));
    };

    var caller = function(count) {
        var values = [];
        for (var i = 1; i <= count; ++i) values.push("holder.p" + i);
        return new Function("holder", "                                      \n\
            'use strict';                                                    \n\
            var callback = holder.fn;                                        \n\
            return callback(values);                                         \n\
            ".replace(/values/g, values.join(", ")));
    };
    var thenCallbacks = [];
    var callers = [void 0];
    for (var i = 1; i <= 5; ++i) {
        thenCallbacks.push(thenCallback(i));
        callers.push(caller(i));
    }

    var Holder = function(total, fn) {
        this.p1 = this.p2 = this.p3 = this.p4 = this.p5 = null;
        this.fn = fn;
        this.total = total;
        this.now = 0;
    };

    Holder.prototype.callers = callers;
    Holder.prototype.checkFulfillment = function(promise) {
        var now = this.now;
        now++;
        var total = this.total;
        if (now >= total) {
            var handler = this.callers[total];
            var ret = tryCatch1(handler, void 0, this);
            if (ret === errorObj) {
                promise._rejectUnchecked(ret.e);
            } else if (!promise._tryFollow(ret)) {
                promise._fulfillUnchecked(ret);
            }
        } else {
            this.now = now;
        }
    };
}




Promise.join = function Promise$Join() {
    var last = arguments.length - 1;
    var fn;
    if (last > 0 && typeof arguments[last] === "function") {
        fn = arguments[last];
        if (last < 6 && canEvaluate) {
            var ret = new Promise(INTERNAL);
            ret._setTrace(void 0);
            var holder = new Holder(last, fn);
            var reject = ret._reject;
            var callbacks = thenCallbacks;
            for (var i = 0; i < last; ++i) {
                var maybePromise = cast(arguments[i], void 0);
                if (maybePromise instanceof Promise) {
                    if (maybePromise.isPending()) {
                        maybePromise._then(callbacks[i], reject,
                                           void 0, ret, holder);
                    } else if (maybePromise.isFulfilled()) {
                        callbacks[i].call(ret,
                                          maybePromise._settledValue, holder);
                    } else {
                        ret._reject(maybePromise._settledValue);
                        maybePromise._unsetRejectionIsUnhandled();
                    }
                } else {
                    callbacks[i].call(ret, maybePromise, holder);
                }
            }
            return ret;
        }
    }
    var $_len = arguments.length;var args = new Array($_len); for(var $_i = 0; $_i < $_len; ++$_i) {args[$_i] = arguments[$_i];}
    var ret = new PromiseArray(args).promise();
    return fn !== void 0 ? ret.spread(fn) : ret;
};

};

},{"./util.js":62}],75:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, INTERNAL, cast) {
var apiRejection = require("./errors_api_rejection.js")(Promise);
var isArray = require("./util.js").isArray;

var raceLater = function Promise$_raceLater(promise) {
    return promise.then(function(array) {
        return Promise$_Race(array, promise);
    });
};

var hasOwn = {}.hasOwnProperty;
function Promise$_Race(promises, parent) {
    var maybePromise = cast(promises, void 0);

    if (maybePromise instanceof Promise) {
        return raceLater(maybePromise);
    } else if (!isArray(promises)) {
        return apiRejection("expecting an array, a promise or a thenable");
    }

    var ret = new Promise(INTERNAL);
    if (parent !== void 0) {
        ret._propagateFrom(parent, 7);
    } else {
        ret._setTrace(void 0);
    }
    var fulfill = ret._fulfill;
    var reject = ret._reject;
    for (var i = 0, len = promises.length; i < len; ++i) {
        var val = promises[i];

        if (val === void 0 && !(hasOwn.call(promises, i))) {
            continue;
        }

        Promise.cast(val)._then(fulfill, reject, void 0, ret, null);
    }
    return ret;
}

Promise.race = function Promise$Race(promises) {
    return Promise$_Race(promises, void 0);
};

Promise.prototype.race = function Promise$race() {
    return Promise$_Race(this, void 0);
};

};

},{"./errors_api_rejection.js":91,"./util.js":62}],76:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var cr = Object.create;
if (cr) {
    var callerCache = cr(null);
    var getterCache = cr(null);
    callerCache[" size"] = getterCache[" size"] = 0;
}

module.exports = function(Promise) {
var util = require("./util.js");
var canEvaluate = util.canEvaluate;
var isIdentifier = util.isIdentifier;

function makeMethodCaller (methodName) {
    return new Function("obj", "                                             \n\
        'use strict'                                                         \n\
        var len = this.length;                                               \n\
        switch(len) {                                                        \n\
            case 1: return obj.methodName(this[0]);                          \n\
            case 2: return obj.methodName(this[0], this[1]);                 \n\
            case 3: return obj.methodName(this[0], this[1], this[2]);        \n\
            case 0: return obj.methodName();                                 \n\
            default: return obj.methodName.apply(obj, this);                 \n\
        }                                                                    \n\
        ".replace(/methodName/g, methodName));
}

function makeGetter (propertyName) {
    return new Function("obj", "                                             \n\
        'use strict';                                                        \n\
        return obj.propertyName;                                             \n\
        ".replace("propertyName", propertyName));
}

function getCompiled(name, compiler, cache) {
    var ret = cache[name];
    if (typeof ret !== "function") {
        if (!isIdentifier(name)) {
            return null;
        }
        ret = compiler(name);
        cache[name] = ret;
        cache[" size"]++;
        if (cache[" size"] > 512) {
            var keys = Object.keys(cache);
            for (var i = 0; i < 256; ++i) delete cache[keys[i]];
            cache[" size"] = keys.length - 256;
        }
    }
    return ret;
}

function getMethodCaller(name) {
    return getCompiled(name, makeMethodCaller, callerCache);
}

function getGetter(name) {
    return getCompiled(name, makeGetter, getterCache);
}

function caller(obj) {
    return obj[this.pop()].apply(obj, this);
}
Promise.prototype.call = function Promise$call(methodName) {
    var $_len = arguments.length;var args = new Array($_len - 1); for(var $_i = 1; $_i < $_len; ++$_i) {args[$_i - 1] = arguments[$_i];}
    if (canEvaluate) {
        var maybeCaller = getMethodCaller(methodName);
        if (maybeCaller !== null) {
            return this._then(maybeCaller, void 0, void 0, args, void 0);
        }
    }
    args.push(methodName);
    return this._then(caller, void 0, void 0, args, void 0);
};

function namedGetter(obj) {
    return obj[this];
}
function indexedGetter(obj) {
    return obj[this];
}
Promise.prototype.get = function Promise$get(propertyName) {
    var isIndex = (typeof propertyName === "number");
    var getter;
    if (!isIndex) {
        if (canEvaluate) {
            var maybeGetter = getGetter(propertyName);
            getter = maybeGetter !== null ? maybeGetter : namedGetter;
        } else {
            getter = namedGetter;
        }
    } else {
        getter = indexedGetter;
    }
    return this._then(getter, void 0, void 0, propertyName, void 0);
};
};

},{"./util.js":62}],77:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, apiRejection, INTERNAL, cast) {
var errors = require("./errors.js");
var TypeError = errors.TypeError;
var deprecated = require("./util.js").deprecated;
var util = require("./util.js");
var errorObj = util.errorObj;
var tryCatch1 = util.tryCatch1;
var yieldHandlers = [];

function promiseFromYieldHandler(value, yieldHandlers) {
    var _errorObj = errorObj;
    var _Promise = Promise;
    var len = yieldHandlers.length;
    for (var i = 0; i < len; ++i) {
        var result = tryCatch1(yieldHandlers[i], void 0, value);
        if (result === _errorObj) {
            return _Promise.reject(_errorObj.e);
        }
        var maybePromise = cast(result, promiseFromYieldHandler);
        if (maybePromise instanceof _Promise) return maybePromise;
    }
    return null;
}

function PromiseSpawn(generatorFunction, receiver, yieldHandler) {
    var promise = this._promise = new Promise(INTERNAL);
    promise._setTrace(void 0);
    this._generatorFunction = generatorFunction;
    this._receiver = receiver;
    this._generator = void 0;
    this._yieldHandlers = typeof yieldHandler === "function"
        ? [yieldHandler].concat(yieldHandlers)
        : yieldHandlers;
}

PromiseSpawn.prototype.promise = function PromiseSpawn$promise() {
    return this._promise;
};

PromiseSpawn.prototype._run = function PromiseSpawn$_run() {
    this._generator = this._generatorFunction.call(this._receiver);
    this._receiver =
        this._generatorFunction = void 0;
    this._next(void 0);
};

PromiseSpawn.prototype._continue = function PromiseSpawn$_continue(result) {
    if (result === errorObj) {
        this._generator = void 0;
        var trace = errors.canAttach(result.e)
            ? result.e : new Error(result.e + "");
        this._promise._attachExtraTrace(trace);
        this._promise._reject(result.e, trace);
        return;
    }

    var value = result.value;
    if (result.done === true) {
        this._generator = void 0;
        if (!this._promise._tryFollow(value)) {
            this._promise._fulfill(value);
        }
    } else {
        var maybePromise = cast(value, void 0);
        if (!(maybePromise instanceof Promise)) {
            maybePromise =
                promiseFromYieldHandler(maybePromise, this._yieldHandlers);
            if (maybePromise === null) {
                this._throw(new TypeError("A value was yielded that could not be treated as a promise"));
                return;
            }
        }
        maybePromise._then(
            this._next,
            this._throw,
            void 0,
            this,
            null
       );
    }
};

PromiseSpawn.prototype._throw = function PromiseSpawn$_throw(reason) {
    if (errors.canAttach(reason))
        this._promise._attachExtraTrace(reason);
    this._continue(
        tryCatch1(this._generator["throw"], this._generator, reason)
   );
};

PromiseSpawn.prototype._next = function PromiseSpawn$_next(value) {
    this._continue(
        tryCatch1(this._generator.next, this._generator, value)
   );
};

Promise.coroutine =
function Promise$Coroutine(generatorFunction, options) {
    if (typeof generatorFunction !== "function") {
        throw new TypeError("generatorFunction must be a function");
    }
    var yieldHandler = Object(options).yieldHandler;
    var PromiseSpawn$ = PromiseSpawn;
    return function () {
        var generator = generatorFunction.apply(this, arguments);
        var spawn = new PromiseSpawn$(void 0, void 0, yieldHandler);
        spawn._generator = generator;
        spawn._next(void 0);
        return spawn.promise();
    };
};

Promise.coroutine.addYieldHandler = function(fn) {
    if (typeof fn !== "function") throw new TypeError("fn must be a function");
    yieldHandlers.push(fn);
};

Promise.spawn = function Promise$Spawn(generatorFunction) {
    deprecated("Promise.spawn is deprecated. Use Promise.coroutine instead.");
    if (typeof generatorFunction !== "function") {
        return apiRejection("generatorFunction must be a function");
    }
    var spawn = new PromiseSpawn(generatorFunction, this);
    var ret = spawn.promise();
    spawn._run(Promise.spawn);
    return ret;
};
};

},{"./errors.js":64,"./util.js":62}],78:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, PromiseArray, apiRejection, cast, INTERNAL) {
var util = require("./util.js");
var tryCatch3 = util.tryCatch3;
var errorObj = util.errorObj;
var PENDING = {};
var EMPTY_ARRAY = [];

function MappingPromiseArray(promises, fn, limit, _filter) {
    this.constructor$(promises);
    this._callback = fn;
    this._preservedValues = _filter === INTERNAL
        ? new Array(this.length())
        : null;
    this._limit = limit;
    this._inFlight = 0;
    this._queue = limit >= 1 ? [] : EMPTY_ARRAY;
    this._init$(void 0, -2);
}
util.inherits(MappingPromiseArray, PromiseArray);

MappingPromiseArray.prototype._init = function MappingPromiseArray$_init() {};

MappingPromiseArray.prototype._promiseFulfilled =
function MappingPromiseArray$_promiseFulfilled(value, index) {
    var values = this._values;
    if (values === null) return;

    var length = this.length();
    var preservedValues = this._preservedValues;
    var limit = this._limit;
    if (values[index] === PENDING) {
        values[index] = value;
        if (limit >= 1) {
            this._inFlight--;
            this._drainQueue();
            if (this._isResolved()) return;
        }
    } else {
        if (limit >= 1 && this._inFlight >= limit) {
            values[index] = value;
            this._queue.push(index);
            return;
        }
        if (preservedValues !== null) preservedValues[index] = value;

        var callback = this._callback;
        var receiver = this._promise._boundTo;
        var ret = tryCatch3(callback, receiver, value, index, length);
        if (ret === errorObj) return this._reject(ret.e);

        var maybePromise = cast(ret, void 0);
        if (maybePromise instanceof Promise) {
            if (maybePromise.isPending()) {
                if (limit >= 1) this._inFlight++;
                values[index] = PENDING;
                return maybePromise._proxyPromiseArray(this, index);
            } else if (maybePromise.isFulfilled()) {
                ret = maybePromise.value();
            } else {
                maybePromise._unsetRejectionIsUnhandled();
                return this._reject(maybePromise.reason());
            }
        }
        values[index] = ret;
    }
    var totalResolved = ++this._totalResolved;
    if (totalResolved >= length) {
        if (preservedValues !== null) {
            this._filter(values, preservedValues);
        } else {
            this._resolve(values);
        }

    }
};

MappingPromiseArray.prototype._drainQueue =
function MappingPromiseArray$_drainQueue() {
    var queue = this._queue;
    var limit = this._limit;
    var values = this._values;
    while (queue.length > 0 && this._inFlight < limit) {
        var index = queue.pop();
        this._promiseFulfilled(values[index], index);
    }
};

MappingPromiseArray.prototype._filter =
function MappingPromiseArray$_filter(booleans, values) {
    var len = values.length;
    var ret = new Array(len);
    var j = 0;
    for (var i = 0; i < len; ++i) {
        if (booleans[i]) ret[j++] = values[i];
    }
    ret.length = j;
    this._resolve(ret);
};

MappingPromiseArray.prototype.preservedValues =
function MappingPromiseArray$preserveValues() {
    return this._preservedValues;
};

function map(promises, fn, options, _filter) {
    var limit = typeof options === "object" && options !== null
        ? options.concurrency
        : 0;
    limit = typeof limit === "number" &&
        isFinite(limit) && limit >= 1 ? limit : 0;
    return new MappingPromiseArray(promises, fn, limit, _filter);
}

Promise.prototype.map = function Promise$map(fn, options) {
    if (typeof fn !== "function") return apiRejection("fn must be a function");

    return map(this, fn, options, null).promise();
};

Promise.map = function Promise$Map(promises, fn, options, _filter) {
    if (typeof fn !== "function") return apiRejection("fn must be a function");
    return map(promises, fn, options, _filter).promise();
};


};

},{"./util.js":62}],79:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise) {
var util = require("./util.js");
var async = require("./async.js");
var tryCatch2 = util.tryCatch2;
var tryCatch1 = util.tryCatch1;
var errorObj = util.errorObj;

function thrower(r) {
    throw r;
}

function Promise$_spreadAdapter(val, receiver) {
    if (!util.isArray(val)) return Promise$_successAdapter(val, receiver);
    var ret = util.tryCatchApply(this, [null].concat(val), receiver);
    if (ret === errorObj) {
        async.invokeLater(thrower, void 0, ret.e);
    }
}

function Promise$_successAdapter(val, receiver) {
    var nodeback = this;
    var ret = val === void 0
        ? tryCatch1(nodeback, receiver, null)
        : tryCatch2(nodeback, receiver, null, val);
    if (ret === errorObj) {
        async.invokeLater(thrower, void 0, ret.e);
    }
}
function Promise$_errorAdapter(reason, receiver) {
    var nodeback = this;
    var ret = tryCatch1(nodeback, receiver, reason);
    if (ret === errorObj) {
        async.invokeLater(thrower, void 0, ret.e);
    }
}

Promise.prototype.nodeify = function Promise$nodeify(nodeback, options) {
    if (typeof nodeback == "function") {
        var adapter = Promise$_successAdapter;
        if (options !== void 0 && Object(options).spread) {
            adapter = Promise$_spreadAdapter;
        }
        this._then(
            adapter,
            Promise$_errorAdapter,
            void 0,
            nodeback,
            this._boundTo
        );
    }
    return this;
};
};

},{"./util.js":62,"./async.js":63}],82:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, PromiseArray, apiRejection, cast, INTERNAL) {
var util = require("./util.js");
var tryCatch4 = util.tryCatch4;
var tryCatch3 = util.tryCatch3;
var errorObj = util.errorObj;
function ReductionPromiseArray(promises, fn, accum, _each) {
    this.constructor$(promises);
    this._preservedValues = _each === INTERNAL ? [] : null;
    this._zerothIsAccum = (accum === void 0);
    this._gotAccum = false;
    this._reducingIndex = (this._zerothIsAccum ? 1 : 0);
    this._valuesPhase = undefined;

    var maybePromise = cast(accum, void 0);
    var rejected = false;
    var isPromise = maybePromise instanceof Promise;
    if (isPromise) {
        if (maybePromise.isPending()) {
            maybePromise._proxyPromiseArray(this, -1);
        } else if (maybePromise.isFulfilled()) {
            accum = maybePromise.value();
            this._gotAccum = true;
        } else {
            maybePromise._unsetRejectionIsUnhandled();
            this._reject(maybePromise.reason());
            rejected = true;
        }
    }
    if (!(isPromise || this._zerothIsAccum)) this._gotAccum = true;
    this._callback = fn;
    this._accum = accum;
    if (!rejected) this._init$(void 0, -5);
}
util.inherits(ReductionPromiseArray, PromiseArray);

ReductionPromiseArray.prototype._init =
function ReductionPromiseArray$_init() {};

ReductionPromiseArray.prototype._resolveEmptyArray =
function ReductionPromiseArray$_resolveEmptyArray() {
    if (this._gotAccum || this._zerothIsAccum) {
        this._resolve(this._preservedValues !== null
                        ? [] : this._accum);
    }
};

ReductionPromiseArray.prototype._promiseFulfilled =
function ReductionPromiseArray$_promiseFulfilled(value, index) {
    var values = this._values;
    if (values === null) return;
    var length = this.length();
    var preservedValues = this._preservedValues;
    var isEach = preservedValues !== null;
    var gotAccum = this._gotAccum;
    var valuesPhase = this._valuesPhase;
    var valuesPhaseIndex;
    if (!valuesPhase) {
        valuesPhase = this._valuesPhase = Array(length);
        for (valuesPhaseIndex=0; valuesPhaseIndex<length; ++valuesPhaseIndex) {
            valuesPhase[valuesPhaseIndex] = 0;
        }
    }
    valuesPhaseIndex = valuesPhase[index];

    if (index === 0 && this._zerothIsAccum) {
        if (!gotAccum) {
            this._accum = value;
            this._gotAccum = gotAccum = true;
        }
        valuesPhase[index] = ((valuesPhaseIndex === 0)
            ? 1 : 2);
    } else if (index === -1) {
        if (!gotAccum) {
            this._accum = value;
            this._gotAccum = gotAccum = true;
        }
    } else {
        if (valuesPhaseIndex === 0) {
            valuesPhase[index] = 1;
        }
        else {
            valuesPhase[index] = 2;
            if (gotAccum) {
                this._accum = value;
            }
        }
    }
    if (!gotAccum) return;

    var callback = this._callback;
    var receiver = this._promise._boundTo;
    var ret;

    for (var i = this._reducingIndex; i < length; ++i) {
        valuesPhaseIndex = valuesPhase[i];
        if (valuesPhaseIndex === 2) {
            this._reducingIndex = i + 1;
            continue;
        }
        if (valuesPhaseIndex !== 1) return;

        value = values[i];
        if (value instanceof Promise) {
            if (value.isFulfilled()) {
                value = value._settledValue;
            } else if (value.isPending()) {
                return;
            } else {
                value._unsetRejectionIsUnhandled();
                return this._reject(value.reason());
            }
        }

        if (isEach) {
            preservedValues.push(value);
            ret = tryCatch3(callback, receiver, value, i, length);
        }
        else {
            ret = tryCatch4(callback, receiver, this._accum, value, i, length);
        }

        if (ret === errorObj) return this._reject(ret.e);

        var maybePromise = cast(ret, void 0);
        if (maybePromise instanceof Promise) {
            if (maybePromise.isPending()) {
                valuesPhase[i] = 4;
                return maybePromise._proxyPromiseArray(this, i);
            } else if (maybePromise.isFulfilled()) {
                ret = maybePromise.value();
            } else {
                maybePromise._unsetRejectionIsUnhandled();
                return this._reject(maybePromise.reason());
            }
        }

        this._reducingIndex = i + 1;
        this._accum = ret;
    }

    if (this._reducingIndex < length) return;
    this._resolve(isEach ? preservedValues : this._accum);
};

function reduce(promises, fn, initialValue, _each) {
    if (typeof fn !== "function") return apiRejection("fn must be a function");
    var array = new ReductionPromiseArray(promises, fn, initialValue, _each);
    return array.promise();
}

Promise.prototype.reduce = function Promise$reduce(fn, initialValue) {
    return reduce(this, fn, initialValue, null);
};

Promise.reduce = function Promise$Reduce(promises, fn, initialValue, _each) {
    return reduce(promises, fn, initialValue, _each);
};
};

},{"./util.js":62}],83:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports =
    function(Promise, PromiseArray) {
var PromiseInspection = Promise.PromiseInspection;
var util = require("./util.js");

function SettledPromiseArray(values) {
    this.constructor$(values);
}
util.inherits(SettledPromiseArray, PromiseArray);

SettledPromiseArray.prototype._promiseResolved =
function SettledPromiseArray$_promiseResolved(index, inspection) {
    this._values[index] = inspection;
    var totalResolved = ++this._totalResolved;
    if (totalResolved >= this._length) {
        this._resolve(this._values);
    }
};

SettledPromiseArray.prototype._promiseFulfilled =
function SettledPromiseArray$_promiseFulfilled(value, index) {
    if (this._isResolved()) return;
    var ret = new PromiseInspection();
    ret._bitField = 268435456;
    ret._settledValue = value;
    this._promiseResolved(index, ret);
};
SettledPromiseArray.prototype._promiseRejected =
function SettledPromiseArray$_promiseRejected(reason, index) {
    if (this._isResolved()) return;
    var ret = new PromiseInspection();
    ret._bitField = 134217728;
    ret._settledValue = reason;
    this._promiseResolved(index, ret);
};

Promise.settle = function Promise$Settle(promises) {
    return new SettledPromiseArray(promises).promise();
};

Promise.prototype.settle = function Promise$settle() {
    return new SettledPromiseArray(this).promise();
};
};

},{"./util.js":62}],84:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports =
function(Promise, PromiseArray, apiRejection) {
var util = require("./util.js");
var RangeError = require("./errors.js").RangeError;
var AggregateError = require("./errors.js").AggregateError;
var isArray = util.isArray;


function SomePromiseArray(values) {
    this.constructor$(values);
    this._howMany = 0;
    this._unwrap = false;
    this._initialized = false;
}
util.inherits(SomePromiseArray, PromiseArray);

SomePromiseArray.prototype._init = function SomePromiseArray$_init() {
    if (!this._initialized) {
        return;
    }
    if (this._howMany === 0) {
        this._resolve([]);
        return;
    }
    this._init$(void 0, -5);
    var isArrayResolved = isArray(this._values);
    if (!this._isResolved() &&
        isArrayResolved &&
        this._howMany > this._canPossiblyFulfill()) {
        this._reject(this._getRangeError(this.length()));
    }
};

SomePromiseArray.prototype.init = function SomePromiseArray$init() {
    this._initialized = true;
    this._init();
};

SomePromiseArray.prototype.setUnwrap = function SomePromiseArray$setUnwrap() {
    this._unwrap = true;
};

SomePromiseArray.prototype.howMany = function SomePromiseArray$howMany() {
    return this._howMany;
};

SomePromiseArray.prototype.setHowMany =
function SomePromiseArray$setHowMany(count) {
    if (this._isResolved()) return;
    this._howMany = count;
};

SomePromiseArray.prototype._promiseFulfilled =
function SomePromiseArray$_promiseFulfilled(value) {
    if (this._isResolved()) return;
    this._addFulfilled(value);
    if (this._fulfilled() === this.howMany()) {
        this._values.length = this.howMany();
        if (this.howMany() === 1 && this._unwrap) {
            this._resolve(this._values[0]);
        } else {
            this._resolve(this._values);
        }
    }

};
SomePromiseArray.prototype._promiseRejected =
function SomePromiseArray$_promiseRejected(reason) {
    if (this._isResolved()) return;
    this._addRejected(reason);
    if (this.howMany() > this._canPossiblyFulfill()) {
        var e = new AggregateError();
        for (var i = this.length(); i < this._values.length; ++i) {
            e.push(this._values[i]);
        }
        this._reject(e);
    }
};

SomePromiseArray.prototype._fulfilled = function SomePromiseArray$_fulfilled() {
    return this._totalResolved;
};

SomePromiseArray.prototype._rejected = function SomePromiseArray$_rejected() {
    return this._values.length - this.length();
};

SomePromiseArray.prototype._addRejected =
function SomePromiseArray$_addRejected(reason) {
    this._values.push(reason);
};

SomePromiseArray.prototype._addFulfilled =
function SomePromiseArray$_addFulfilled(value) {
    this._values[this._totalResolved++] = value;
};

SomePromiseArray.prototype._canPossiblyFulfill =
function SomePromiseArray$_canPossiblyFulfill() {
    return this.length() - this._rejected();
};

SomePromiseArray.prototype._getRangeError =
function SomePromiseArray$_getRangeError(count) {
    var message = "Input array must contain at least " +
            this._howMany + " items but contains only " + count + " items";
    return new RangeError(message);
};

SomePromiseArray.prototype._resolveEmptyArray =
function SomePromiseArray$_resolveEmptyArray() {
    this._reject(this._getRangeError(0));
};

function Promise$_Some(promises, howMany) {
    if ((howMany | 0) !== howMany || howMany < 0) {
        return apiRejection("expecting a positive integer");
    }
    var ret = new SomePromiseArray(promises);
    var promise = ret.promise();
    if (promise.isRejected()) {
        return promise;
    }
    ret.setHowMany(howMany);
    ret.init();
    return promise;
}

Promise.some = function Promise$Some(promises, howMany) {
    return Promise$_Some(promises, howMany);
};

Promise.prototype.some = function Promise$some(howMany) {
    return Promise$_Some(this, howMany);
};

Promise._SomePromiseArray = SomePromiseArray;
};

},{"./util.js":62,"./errors.js":64}],85:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, PromiseArray) {
var util = require("./util.js");
var async = require("./async.js");
var errors = require("./errors.js");
var tryCatch1 = util.tryCatch1;
var errorObj = util.errorObj;

Promise.prototype.progressed = function Promise$progressed(handler) {
    return this._then(void 0, void 0, handler, void 0, void 0);
};

Promise.prototype._progress = function Promise$_progress(progressValue) {
    if (this._isFollowingOrFulfilledOrRejected()) return;
    this._progressUnchecked(progressValue);

};

Promise.prototype._progressHandlerAt =
function Promise$_progressHandlerAt(index) {
    return index === 0
        ? this._progressHandler0
        : this[(index << 2) + index - 5 + 2];
};

Promise.prototype._doProgressWith =
function Promise$_doProgressWith(progression) {
    var progressValue = progression.value;
    var handler = progression.handler;
    var promise = progression.promise;
    var receiver = progression.receiver;

    var ret = tryCatch1(handler, receiver, progressValue);
    if (ret === errorObj) {
        if (ret.e != null &&
            ret.e.name !== "StopProgressPropagation") {
            var trace = errors.canAttach(ret.e)
                ? ret.e : new Error(ret.e + "");
            promise._attachExtraTrace(trace);
            promise._progress(ret.e);
        }
    } else if (ret instanceof Promise) {
        ret._then(promise._progress, null, null, promise, void 0);
    } else {
        promise._progress(ret);
    }
};


Promise.prototype._progressUnchecked =
function Promise$_progressUnchecked(progressValue) {
    if (!this.isPending()) return;
    var len = this._length();
    var progress = this._progress;
    for (var i = 0; i < len; i++) {
        var handler = this._progressHandlerAt(i);
        var promise = this._promiseAt(i);
        if (!(promise instanceof Promise)) {
            var receiver = this._receiverAt(i);
            if (typeof handler === "function") {
                handler.call(receiver, progressValue, promise);
            } else if (receiver instanceof Promise && receiver._isProxied()) {
                receiver._progressUnchecked(progressValue);
            } else if (receiver instanceof PromiseArray) {
                receiver._promiseProgressed(progressValue, promise);
            }
            continue;
        }

        if (typeof handler === "function") {
            async.invoke(this._doProgressWith, this, {
                handler: handler,
                promise: promise,
                receiver: this._receiverAt(i),
                value: progressValue
            });
        } else {
            async.invoke(progress, promise, progressValue);
        }
    }
};
};

},{"./util.js":62,"./async.js":63,"./errors.js":64}],86:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, INTERNAL) {
var errors = require("./errors.js");
var canAttach = errors.canAttach;
var async = require("./async.js");
var CancellationError = errors.CancellationError;

Promise.prototype._cancel = function Promise$_cancel(reason) {
    if (!this.isCancellable()) return this;
    var parent;
    var promiseToReject = this;
    while ((parent = promiseToReject._cancellationParent) !== void 0 &&
        parent.isCancellable()) {
        promiseToReject = parent;
    }
    promiseToReject._attachExtraTrace(reason);
    promiseToReject._rejectUnchecked(reason);
};

Promise.prototype.cancel = function Promise$cancel(reason) {
    if (!this.isCancellable()) return this;
    reason = reason !== void 0
        ? (canAttach(reason) ? reason : new Error(reason + ""))
        : new CancellationError();
    async.invokeLater(this._cancel, this, reason);
    return this;
};

Promise.prototype.cancellable = function Promise$cancellable() {
    if (this._cancellable()) return this;
    this._setCancellable();
    this._cancellationParent = void 0;
    return this;
};

Promise.prototype.uncancellable = function Promise$uncancellable() {
    var ret = new Promise(INTERNAL);
    ret._propagateFrom(this, 2 | 4);
    ret._follow(this);
    ret._unsetCancellable();
    return ret;
};

Promise.prototype.fork =
function Promise$fork(didFulfill, didReject, didProgress) {
    var ret = this._then(didFulfill, didReject, didProgress,
                         void 0, void 0);

    ret._setCancellable();
    ret._cancellationParent = void 0;
    return ret;
};
};

},{"./errors.js":64,"./async.js":63}],90:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function (Promise, apiRejection, cast) {
    var TypeError = require("./errors.js").TypeError;
    var inherits = require("./util.js").inherits;
    var PromiseInspection = Promise.PromiseInspection;

    function inspectionMapper(inspections) {
        var len = inspections.length;
        for (var i = 0; i < len; ++i) {
            var inspection = inspections[i];
            if (inspection.isRejected()) {
                return Promise.reject(inspection.error());
            }
            inspections[i] = inspection.value();
        }
        return inspections;
    }

    function thrower(e) {
        setTimeout(function(){throw e;}, 0);
    }

    function dispose(resources, inspection) {
        var i = 0;
        var len = resources.length;
        var ret = Promise.defer();
        function iterator() {
            if (i >= len) return ret.resolve();
            var maybePromise = cast(resources[i++], void 0);
            if (maybePromise instanceof Promise &&
                maybePromise._isDisposable()) {
                try {
                    maybePromise = cast(maybePromise._getDisposer()
                                        .tryDispose(inspection), void 0);
                } catch (e) {
                    return thrower(e);
                }
                if (maybePromise instanceof Promise) {
                    return maybePromise._then(iterator, thrower,
                                              null, null, null);
                }
            }
            iterator();
        }
        iterator();
        return ret.promise;
    }

    function disposerSuccess(value) {
        var inspection = new PromiseInspection();
        inspection._settledValue = value;
        inspection._bitField = 268435456;
        return dispose(this, inspection).thenReturn(value);
    }

    function disposerFail(reason) {
        var inspection = new PromiseInspection();
        inspection._settledValue = reason;
        inspection._bitField = 134217728;
        return dispose(this, inspection).thenThrow(reason);
    }

    function Disposer(data, promise) {
        this._data = data;
        this._promise = promise;
    }

    Disposer.prototype.data = function Disposer$data() {
        return this._data;
    };

    Disposer.prototype.promise = function Disposer$promise() {
        return this._promise;
    };

    Disposer.prototype.resource = function Disposer$resource() {
        if (this.promise().isFulfilled()) {
            return this.promise().value();
        }
        return null;
    };

    Disposer.prototype.tryDispose = function(inspection) {
        var resource = this.resource();
        var ret = resource !== null
            ? this.doDispose(resource, inspection) : null;
        this._promise._unsetDisposable();
        this._data = this._promise = null;
        return ret;
    };

    function FunctionDisposer(fn, promise) {
        this.constructor$(fn, promise);
    }
    inherits(FunctionDisposer, Disposer);

    FunctionDisposer.prototype.doDispose = function (resource, inspection) {
        var fn = this.data();
        return fn.call(resource, resource, inspection);
    };

    Promise.using = function Promise$using() {
        var len = arguments.length;
        if (len < 2) return apiRejection(
                        "you must pass at least 2 arguments to Promise.using");
        var fn = arguments[len - 1];
        if (typeof fn !== "function") return apiRejection("fn must be a function");
        len--;
        var resources = new Array(len);
        for (var i = 0; i < len; ++i) {
            var resource = arguments[i];
            if (resource instanceof Disposer) {
                var disposer = resource;
                resource = resource.promise();
                resource._setDisposable(disposer);
            }
            resources[i] = resource;
        }

        return Promise.settle(resources)
            .then(inspectionMapper)
            .spread(fn)
            ._then(disposerSuccess, disposerFail, void 0, resources, void 0);
    };

    Promise.prototype._setDisposable =
    function Promise$_setDisposable(disposer) {
        this._bitField = this._bitField | 262144;
        this._disposer = disposer;
    };

    Promise.prototype._isDisposable = function Promise$_isDisposable() {
        return (this._bitField & 262144) > 0;
    };

    Promise.prototype._getDisposer = function Promise$_getDisposer() {
        return this._disposer;
    };

    Promise.prototype._unsetDisposable = function Promise$_unsetDisposable() {
        this._bitField = this._bitField & (~262144);
        this._disposer = void 0;
    };

    Promise.prototype.disposer = function Promise$disposer(fn) {
        if (typeof fn === "function") {
            return new FunctionDisposer(fn, this);
        }
        throw new TypeError();
    };

};

},{"./errors.js":64,"./util.js":62}],91:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise) {
var TypeError = require('./errors.js').TypeError;

function apiRejection(msg) {
    var error = new TypeError(msg);
    var ret = Promise.rejected(error);
    var parent = ret._peekContext();
    if (parent != null) {
        parent._attachExtraTrace(error);
    }
    return ret;
}

return apiRejection;
};

},{"./errors.js":64}],74:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var _setTimeout = function(fn, ms) {
    var len = arguments.length;
    var arg0 = arguments[2];
    var arg1 = arguments[3];
    var arg2 = len >= 5 ? arguments[4] : void 0;
    setTimeout(function() {
        fn(arg0, arg1, arg2);
    }, ms);
};

module.exports = function(Promise, INTERNAL, cast) {
var util = require("./util.js");
var errors = require("./errors.js");
var apiRejection = require("./errors_api_rejection")(Promise);
var TimeoutError = Promise.TimeoutError;

var afterTimeout = function Promise$_afterTimeout(promise, message, ms) {
    if (!promise.isPending()) return;
    if (typeof message !== "string") {
        message = "operation timed out after" + " " + ms + " ms"
    }
    var err = new TimeoutError(message);
    errors.markAsOriginatingFromRejection(err);
    promise._attachExtraTrace(err);
    promise._cancel(err);
};

var afterDelay = function Promise$_afterDelay(value, promise) {
    promise._fulfill(value);
};

var delay = Promise.delay = function Promise$Delay(value, ms) {
    if (ms === void 0) {
        ms = value;
        value = void 0;
    }
    ms = +ms;
    var maybePromise = cast(value, void 0);
    var promise = new Promise(INTERNAL);

    if (maybePromise instanceof Promise) {
        promise._propagateFrom(maybePromise, 7);
        promise._follow(maybePromise);
        return promise.then(function(value) {
            return Promise.delay(value, ms);
        });
    } else {
        promise._setTrace(void 0);
        _setTimeout(afterDelay, ms, value, promise);
    }
    return promise;
};

Promise.prototype.delay = function Promise$delay(ms) {
    return delay(this, ms);
};

Promise.prototype.timeout = function Promise$timeout(ms, message) {
    ms = +ms;

    var ret = new Promise(INTERNAL);
    ret._propagateFrom(this, 7);
    ret._follow(this);
    _setTimeout(afterTimeout, ms, ret, message, ms);
    return ret.cancellable();
};

};

},{"./util.js":62,"./errors.js":64,"./errors_api_rejection":91}],80:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, INTERNAL) {
var THIS = {};
var util = require("./util.js");
var nodebackForPromise = require("./promise_resolver.js")
    ._nodebackForPromise;
var withAppended = util.withAppended;
var maybeWrapAsError = util.maybeWrapAsError;
var canEvaluate = util.canEvaluate;
var TypeError = require("./errors").TypeError;
var defaultSuffix = "Async";
var defaultFilter = function(name, func) {
    return util.isIdentifier(name) &&
        name.charAt(0) !== "_" &&
        !util.isClass(func);
};
var defaultPromisified = {__isPromisified__: true};


function escapeIdentRegex(str) {
    return str.replace(/([$])/, "\\$");
}

function isPromisified(fn) {
    try {
        return fn.__isPromisified__ === true;
    }
    catch (e) {
        return false;
    }
}

function hasPromisified(obj, key, suffix) {
    var val = util.getDataPropertyOrDefault(obj, key + suffix,
                                            defaultPromisified);
    return val ? isPromisified(val) : false;
}
function checkValid(ret, suffix, suffixRegexp) {
    for (var i = 0; i < ret.length; i += 2) {
        var key = ret[i];
        if (suffixRegexp.test(key)) {
            var keyWithoutAsyncSuffix = key.replace(suffixRegexp, "");
            for (var j = 0; j < ret.length; j += 2) {
                if (ret[j] === keyWithoutAsyncSuffix) {
                    throw new TypeError("Cannot promisify an API " +
                        "that has normal methods with '"+suffix+"'-suffix");
                }
            }
        }
    }
}

function promisifiableMethods(obj, suffix, suffixRegexp, filter) {
    var keys = util.inheritedDataKeys(obj);
    var ret = [];
    for (var i = 0; i < keys.length; ++i) {
        var key = keys[i];
        var value = obj[key];
        if (typeof value === "function" &&
            !isPromisified(value) &&
            !hasPromisified(obj, key, suffix) &&
            filter(key, value, obj)) {
            ret.push(key, value);
        }
    }
    checkValid(ret, suffix, suffixRegexp);
    return ret;
}

function switchCaseArgumentOrder(likelyArgumentCount) {
    var ret = [likelyArgumentCount];
    var min = Math.max(0, likelyArgumentCount - 1 - 5);
    for(var i = likelyArgumentCount - 1; i >= min; --i) {
        if (i === likelyArgumentCount) continue;
        ret.push(i);
    }
    for(var i = likelyArgumentCount + 1; i <= 5; ++i) {
        ret.push(i);
    }
    return ret;
}

function argumentSequence(argumentCount) {
    return util.filledRange(argumentCount, "arguments[", "]");
}

function parameterDeclaration(parameterCount) {
    return util.filledRange(parameterCount, "_arg", "");
}

function parameterCount(fn) {
    if (typeof fn.length === "number") {
        return Math.max(Math.min(fn.length, 1023 + 1), 0);
    }
    return 0;
}

function generatePropertyAccess(key) {
    if (util.isIdentifier(key)) {
        return "." + key;
    }
    else return "['" + key.replace(/(['\\])/g, "\\$1") + "']";
}

function makeNodePromisifiedEval(callback, receiver, originalName, fn, suffix) {
    var newParameterCount = Math.max(0, parameterCount(fn) - 1);
    var argumentOrder = switchCaseArgumentOrder(newParameterCount);
    var callbackName =
        (typeof originalName === "string" && util.isIdentifier(originalName)
            ? originalName + suffix
            : "promisified");

    function generateCallForArgumentCount(count) {
        var args = argumentSequence(count).join(", ");
        var comma = count > 0 ? ", " : "";
        var ret;
        if (typeof callback === "string") {
            ret = "                                                          \n\
                this.method(args, fn);                                       \n\
                break;                                                       \n\
            ".replace(".method", generatePropertyAccess(callback));
        } else if (receiver === THIS) {
            ret =  "                                                         \n\
                callback.call(this, args, fn);                               \n\
                break;                                                       \n\
            ";
        } else if (receiver !== void 0) {
            ret =  "                                                         \n\
                callback.call(receiver, args, fn);                           \n\
                break;                                                       \n\
            ";
        } else {
            ret =  "                                                         \n\
                callback(args, fn);                                          \n\
                break;                                                       \n\
            ";
        }
        return ret.replace("args", args).replace(", ", comma);
    }

    function generateArgumentSwitchCase() {
        var ret = "";
        for(var i = 0; i < argumentOrder.length; ++i) {
            ret += "case " + argumentOrder[i] +":" +
                generateCallForArgumentCount(argumentOrder[i]);
        }
        var codeForCall;
        if (typeof callback === "string") {
            codeForCall = "                                                  \n\
                this.property.apply(this, args);                             \n\
            "
                .replace(".property", generatePropertyAccess(callback));
        } else if (receiver === THIS) {
            codeForCall = "                                                  \n\
                callback.apply(this, args);                                  \n\
            ";
        } else {
            codeForCall = "                                                  \n\
                callback.apply(receiver, args);                              \n\
            ";
        }

        ret += "                                                             \n\
        default:                                                             \n\
            var args = new Array(len + 1);                                   \n\
            var i = 0;                                                       \n\
            for (var i = 0; i < len; ++i) {                                  \n\
               args[i] = arguments[i];                                       \n\
            }                                                                \n\
            args[i] = fn;                                                    \n\
            [CodeForCall]                                                    \n\
            break;                                                           \n\
        ".replace("[CodeForCall]", codeForCall);
        return ret;
    }

    return new Function("Promise",
                        "callback",
                        "receiver",
                        "withAppended",
                        "maybeWrapAsError",
                        "nodebackForPromise",
                        "INTERNAL","                                         \n\
        var ret = function FunctionName(Parameters) {                        \n\
            'use strict';                                                    \n\
            var len = arguments.length;                                      \n\
            var promise = new Promise(INTERNAL);                             \n\
            promise._setTrace(void 0);                                       \n\
            var fn = nodebackForPromise(promise);                            \n\
            try {                                                            \n\
                switch(len) {                                                \n\
                    [CodeForSwitchCase]                                      \n\
                }                                                            \n\
            } catch (e) {                                                    \n\
                var wrapped = maybeWrapAsError(e);                           \n\
                promise._attachExtraTrace(wrapped);                          \n\
                promise._reject(wrapped);                                    \n\
            }                                                                \n\
            return promise;                                                  \n\
        };                                                                   \n\
        ret.__isPromisified__ = true;                                        \n\
        return ret;                                                          \n\
        "
        .replace("FunctionName", callbackName)
        .replace("Parameters", parameterDeclaration(newParameterCount))
        .replace("[CodeForSwitchCase]", generateArgumentSwitchCase()))(
            Promise,
            callback,
            receiver,
            withAppended,
            maybeWrapAsError,
            nodebackForPromise,
            INTERNAL
        );
}

function makeNodePromisifiedClosure(callback, receiver) {
    function promisified() {
        var _receiver = receiver;
        if (receiver === THIS) _receiver = this;
        if (typeof callback === "string") {
            callback = _receiver[callback];
        }
        var promise = new Promise(INTERNAL);
        promise._setTrace(void 0);
        var fn = nodebackForPromise(promise);
        try {
            callback.apply(_receiver, withAppended(arguments, fn));
        } catch(e) {
            var wrapped = maybeWrapAsError(e);
            promise._attachExtraTrace(wrapped);
            promise._reject(wrapped);
        }
        return promise;
    }
    promisified.__isPromisified__ = true;
    return promisified;
}

var makeNodePromisified = canEvaluate
    ? makeNodePromisifiedEval
    : makeNodePromisifiedClosure;

function promisifyAll(obj, suffix, filter, promisifier) {
    var suffixRegexp = new RegExp(escapeIdentRegex(suffix) + "$");
    var methods =
        promisifiableMethods(obj, suffix, suffixRegexp, filter);

    for (var i = 0, len = methods.length; i < len; i+= 2) {
        var key = methods[i];
        var fn = methods[i+1];
        var promisifiedKey = key + suffix;
        obj[promisifiedKey] = promisifier === makeNodePromisified
                ? makeNodePromisified(key, THIS, key, fn, suffix)
                : promisifier(fn);
    }
    util.toFastProperties(obj);
    return obj;
}

function promisify(callback, receiver) {
    return makeNodePromisified(callback, receiver, void 0, callback);
}

Promise.promisify = function Promise$Promisify(fn, receiver) {
    if (typeof fn !== "function") {
        throw new TypeError("fn must be a function");
    }
    if (isPromisified(fn)) {
        return fn;
    }
    return promisify(fn, arguments.length < 2 ? THIS : receiver);
};

Promise.promisifyAll = function Promise$PromisifyAll(target, options) {
    if (typeof target !== "function" && typeof target !== "object") {
        throw new TypeError("the target of promisifyAll must be an object or a function");
    }
    options = Object(options);
    var suffix = options.suffix;
    if (typeof suffix !== "string") suffix = defaultSuffix;
    var filter = options.filter;
    if (typeof filter !== "function") filter = defaultFilter;
    var promisifier = options.promisifier;
    if (typeof promisifier !== "function") promisifier = makeNodePromisified;

    if (!util.isIdentifier(suffix)) {
        throw new RangeError("suffix must be a valid identifier");
    }

    var keys = util.inheritedDataKeys(target, {includeHidden: true});
    for (var i = 0; i < keys.length; ++i) {
        var value = target[keys[i]];
        if (keys[i] !== "constructor" &&
            util.isClass(value)) {
            promisifyAll(value.prototype, suffix, filter, promisifier);
            promisifyAll(value, suffix, filter, promisifier);
        }
    }

    return promisifyAll(target, suffix, filter, promisifier);
};
};


},{"./util.js":62,"./promise_resolver.js":69,"./errors":64}],81:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, PromiseArray, cast) {
var util = require("./util.js");
var apiRejection = require("./errors_api_rejection")(Promise);
var isObject = util.isObject;
var es5 = require("./es5.js");

function PropertiesPromiseArray(obj) {
    var keys = es5.keys(obj);
    var len = keys.length;
    var values = new Array(len * 2);
    for (var i = 0; i < len; ++i) {
        var key = keys[i];
        values[i] = obj[key];
        values[i + len] = key;
    }
    this.constructor$(values);
}
util.inherits(PropertiesPromiseArray, PromiseArray);

PropertiesPromiseArray.prototype._init =
function PropertiesPromiseArray$_init() {
    this._init$(void 0, -3) ;
};

PropertiesPromiseArray.prototype._promiseFulfilled =
function PropertiesPromiseArray$_promiseFulfilled(value, index) {
    if (this._isResolved()) return;
    this._values[index] = value;
    var totalResolved = ++this._totalResolved;
    if (totalResolved >= this._length) {
        var val = {};
        var keyOffset = this.length();
        for (var i = 0, len = this.length(); i < len; ++i) {
            val[this._values[i + keyOffset]] = this._values[i];
        }
        this._resolve(val);
    }
};

PropertiesPromiseArray.prototype._promiseProgressed =
function PropertiesPromiseArray$_promiseProgressed(value, index) {
    if (this._isResolved()) return;

    this._promise._progress({
        key: this._values[index + this.length()],
        value: value
    });
};

PropertiesPromiseArray.prototype.shouldCopyValues =
function PropertiesPromiseArray$_shouldCopyValues() {
    return false;
};

PropertiesPromiseArray.prototype.getActualLength =
function PropertiesPromiseArray$getActualLength(len) {
    return len >> 1;
};

function Promise$_Props(promises) {
    var ret;
    var castValue = cast(promises, void 0);

    if (!isObject(castValue)) {
        return apiRejection("cannot await properties of a non-object");
    } else if (castValue instanceof Promise) {
        ret = castValue._then(Promise.props, void 0, void 0, void 0, void 0);
    } else {
        ret = new PropertiesPromiseArray(castValue).promise();
    }

    if (castValue instanceof Promise) {
        ret._propagateFrom(castValue, 4);
    }
    return ret;
}

Promise.prototype.props = function Promise$props() {
    return Promise$_Props(this);
};

Promise.props = function Promise$Props(promises) {
    return Promise$_Props(promises);
};
};

},{"./util.js":62,"./es5.js":92,"./errors_api_rejection":91}],92:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
var isES5 = (function(){
    "use strict";
    return this === void 0;
})();

if (isES5) {
    module.exports = {
        freeze: Object.freeze,
        defineProperty: Object.defineProperty,
        keys: Object.keys,
        getPrototypeOf: Object.getPrototypeOf,
        isArray: Array.isArray,
        isES5: isES5
    };
} else {
    var has = {}.hasOwnProperty;
    var str = {}.toString;
    var proto = {}.constructor.prototype;

    var ObjectKeys = function ObjectKeys(o) {
        var ret = [];
        for (var key in o) {
            if (has.call(o, key)) {
                ret.push(key);
            }
        }
        return ret;
    }

    var ObjectDefineProperty = function ObjectDefineProperty(o, key, desc) {
        o[key] = desc.value;
        return o;
    }

    var ObjectFreeze = function ObjectFreeze(obj) {
        return obj;
    }

    var ObjectGetPrototypeOf = function ObjectGetPrototypeOf(obj) {
        try {
            return Object(obj).constructor.prototype;
        }
        catch (e) {
            return proto;
        }
    }

    var ArrayIsArray = function ArrayIsArray(obj) {
        try {
            return str.call(obj) === "[object Array]";
        }
        catch(e) {
            return false;
        }
    }

    module.exports = {
        isArray: ArrayIsArray,
        keys: ObjectKeys,
        defineProperty: ObjectDefineProperty,
        freeze: ObjectFreeze,
        getPrototypeOf: ObjectGetPrototypeOf,
        isES5: isES5
    };
}

},{}],93:[function(require,module,exports){
(function(process){/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var schedule;
var _MutationObserver;
if (typeof process === "object" && typeof process.version === "string") {
    schedule = function Promise$_Scheduler(fn) {
        process.nextTick(fn);
    };
}
else if ((typeof MutationObserver !== "undefined" &&
         (_MutationObserver = MutationObserver)) ||
         (typeof WebKitMutationObserver !== "undefined" &&
         (_MutationObserver = WebKitMutationObserver))) {
    schedule = (function() {
        var div = document.createElement("div");
        var queuedFn = void 0;
        var observer = new _MutationObserver(
            function Promise$_Scheduler() {
                var fn = queuedFn;
                queuedFn = void 0;
                fn();
            }
       );
        observer.observe(div, {
            attributes: true
        });
        return function Promise$_Scheduler(fn) {
            queuedFn = fn;
            div.setAttribute("class", "foo");
        };

    })();
}
else if (typeof setTimeout !== "undefined") {
    schedule = function Promise$_Scheduler(fn) {
        setTimeout(fn, 0);
    };
}
else throw new Error("no async scheduler available");
module.exports = schedule;

})(require("__browserify_process"))
},{"__browserify_process":61}],94:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
function arrayCopy(src, srcIndex, dst, dstIndex, len) {
    for (var j = 0; j < len; ++j) {
        dst[j + dstIndex] = src[j + srcIndex];
    }
}

function Queue(capacity) {
    this._capacity = capacity;
    this._length = 0;
    this._front = 0;
    this._makeCapacity();
}

Queue.prototype._willBeOverCapacity =
function Queue$_willBeOverCapacity(size) {
    return this._capacity < size;
};

Queue.prototype._pushOne = function Queue$_pushOne(arg) {
    var length = this.length();
    this._checkCapacity(length + 1);
    var i = (this._front + length) & (this._capacity - 1);
    this[i] = arg;
    this._length = length + 1;
};

Queue.prototype.push = function Queue$push(fn, receiver, arg) {
    var length = this.length() + 3;
    if (this._willBeOverCapacity(length)) {
        this._pushOne(fn);
        this._pushOne(receiver);
        this._pushOne(arg);
        return;
    }
    var j = this._front + length - 3;
    this._checkCapacity(length);
    var wrapMask = this._capacity - 1;
    this[(j + 0) & wrapMask] = fn;
    this[(j + 1) & wrapMask] = receiver;
    this[(j + 2) & wrapMask] = arg;
    this._length = length;
};

Queue.prototype.shift = function Queue$shift() {
    var front = this._front,
        ret = this[front];

    this[front] = void 0;
    this._front = (front + 1) & (this._capacity - 1);
    this._length--;
    return ret;
};

Queue.prototype.length = function Queue$length() {
    return this._length;
};

Queue.prototype._makeCapacity = function Queue$_makeCapacity() {
    var len = this._capacity;
    for (var i = 0; i < len; ++i) {
        this[i] = void 0;
    }
};

Queue.prototype._checkCapacity = function Queue$_checkCapacity(size) {
    if (this._capacity < size) {
        this._resizeTo(this._capacity << 3);
    }
};

Queue.prototype._resizeTo = function Queue$_resizeTo(capacity) {
    var oldFront = this._front;
    var oldCapacity = this._capacity;
    var oldQueue = new Array(oldCapacity);
    var length = this.length();

    arrayCopy(this, 0, oldQueue, 0, oldCapacity);
    this._capacity = capacity;
    this._makeCapacity();
    this._front = 0;
    if (oldFront + length <= oldCapacity) {
        arrayCopy(oldQueue, oldFront, this, 0, length);
    } else {        var lengthBeforeWrapping =
            length - ((oldFront + length) & (oldCapacity - 1));

        arrayCopy(oldQueue, oldFront, this, 0, lengthBeforeWrapping);
        arrayCopy(oldQueue, 0, this, lengthBeforeWrapping,
                    length - lengthBeforeWrapping);
    }
};

module.exports = Queue;

},{}]},{},[1])
//@ sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9pbmRleC5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9ub2RlLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L3dlYi5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9ydW50aW1lL2luZGV4LmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2Jyb3dzZXJpZnkyLWxpc3QuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvdXRpbC9jb21wb25lbnQtbG9hZGVyLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L3V0aWwvcmV0cnlhYmxlLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L3V0aWwvcGVyaW9kaWMuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS9kaXNwYXRjaGVyLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L3V0aWwvdGltZXIuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS9vcHRpb25zLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2NvcmUvY291bnRkb3duLWxhdGNoLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2NvcmUvc3RhdGUtZ3VhcmQuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS9sYW5nLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2NvcmUvcHViLXN1Yi5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9jb2xsZWN0aW9uL2RvdWJseS1saW5rZWQtbGlzdC5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9jb2xsZWN0aW9uL29iamVjdC1oYXNoLW1hcC5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9zdG9yYWdlL2NhY2hpbmctZGF0YS1zdG9yZS5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9zdG9yYWdlL2luLW1lbW9yeS1kYXRhLXN0b3JlLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2NvbGxlY3Rpb24vbHJ1LWhhc2gtbWFwLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L3N0b3JhZ2UvbHJ1LWRhdGEtc3RvcmUuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvc3RvcmFnZS9zaWduYWxpbmctZGF0YS1zdG9yZS5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9hcHBraXQvY29uZmlndXJhdGlvbi1tYWdpYy5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9hcHBraXQvYXBwLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L21lc3NhZ2luZy9leGNoYW5nZS5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9tZXNzYWdpbmcvY291cmllci5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9jb3JlL3V1aWQuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvdXRpbC9jb21wb25lbnQtcmVnaXN0cnkuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvc2NoZWR1bGVyL2luZGV4LmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbm9kZV9tb2R1bGVzL3VuZGVyc2NvcmUvdW5kZXJzY29yZS5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L25vZGVfbW9kdWxlcy9tb3JpL21vcmkuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS9zZXF1ZW5jZXIvY2xvY2stc2VxdWVuY2VyLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2NvcmUvc2VxdWVuY2VyL2RlbGVnYXRpbmctY29tcG9zaXRlLXNlcXVlbmNlci5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9jb3JlL3NlcXVlbmNlci91bml0LXNlcXVlbmNlci5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9jb3JlL3NlcXVlbmNlci9kZWxlZ2F0aW5nLWZvcndhcmRpbmctc2VxdWVuY2VyLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L3RpbWUvY2xvY2svbG9naWNhbC1jbG9jay5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC90aW1lL2Nsb2NrL3N5c3RlbS1jbG9jay5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9hcHBraXQvY29uZmlnL3Njb3BlZC1jb25maWd1cmF0aW9uLXJlc29sdmVyLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2FwcGtpdC9jb25maWcvc2NvcGVkLWNvbmZpZ3VyYXRpb24uanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS9sb2dnaW5nL2xvZ2dlci5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9jb3JlL2NoYW5uZWwvY2hhbm5lbC5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9jb3JlL2NoYW5uZWwvY2hhaW5lZC1jaGFubmVsLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2NvcmUvY2hhbm5lbC9jb21wb3NpdGUtY2hhbm5lbC5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9tZXNzYWdpbmcvZmliZXIvaW4tbWVtb3J5LWZpYmVyLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L21lc3NhZ2luZy9maWJlci9saW5rYWJsZS1maWJlci5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9jb3JlL3NlcmRlL2pzb24tc2VyZGUuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS9yZWYvaW5kZXguanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9ibHVlYmlyZC5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9jb3JlL2xvZ2dpbmcvYXBwZW5kZXJzL2NvbnNvbGUtbG9nLWFwcGVuZGVyLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2FwcGtpdC93ZWItYXBwLWNvbnRhaW5lci5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9hcHBraXQvYm9vdHN0cmFwcGVyLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L3NjaGVkdWxlci93ZWItc2NoZWR1bGVyLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L3J1bnRpbWUvZGVmYXVsdC1ydW50aW1lLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L3N0b3JhZ2UvaW50ZXJuYWxzL2V4cGlyaW5nLWVudHJ5LmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2FwcGtpdC9pbnRlcm5hbC9wcm9jZXNzLWtlZXAtYWxpdmUuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvbWVzc2FnaW5nL2ludGVybmFscy9tYWlsYm94LmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbm9kZV9tb2R1bGVzL2dydW50LWJyb3dzZXJpZnkyL25vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9pbnNlcnQtbW9kdWxlLWdsb2JhbHMvbm9kZV9tb2R1bGVzL3Byb2Nlc3MvYnJvd3Nlci5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL3Byb21pc2UuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS9yZWYvcmVmLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2NvcmUvcmVmL2RlbGVnYXRpbmctcmVmLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vc3luY2hyb25vdXNfaW5zcGVjdGlvbi5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL2ZpbHRlci5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL2FueS5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL2VhY2guanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS9zY2hlZHVsZXIvc2V0LXRpbWVvdXQtc2NoZWR1bGVyLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vdXRpbC5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL2FzeW5jLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vZXJyb3JzLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vdGhlbmFibGVzLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vcHJvbWlzZV9hcnJheS5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL2NhcHR1cmVkX3RyYWNlLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vY2F0Y2hfZmlsdGVyLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vcHJvbWlzZV9yZXNvbHZlci5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL2ZpbmFsbHkuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9kaXJlY3RfcmVzb2x2ZS5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL2pvaW4uanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9yYWNlLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vY2FsbF9nZXQuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9nZW5lcmF0b3JzLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vbWFwLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vbm9kZWlmeS5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL3JlZHVjZS5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL3NldHRsZS5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL3NvbWUuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9wcm9ncmVzcy5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL2NhbmNlbC5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL3VzaW5nLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vZXJyb3JzX2FwaV9yZWplY3Rpb24uanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi90aW1lcnMuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9wcm9taXNpZnkuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9wcm9wcy5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL2VzNS5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL3NjaGVkdWxlLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vcXVldWUuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeE9BO0FBQ0E7O0FDREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckxBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pUQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoUEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3WEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZFQTtBQUNBO0FBQ0E7QUFDQTs7QUNIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoMENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqWkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25EQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9EQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6TEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2aENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaEhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcklBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckxBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RVQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIENvbXBvbmVudFJlZ2lzdHJ5LFxuICB3ZWJBbGlhc2VzLFxuICBub2RlQWxpYXNlc1xuKSB7XG4gIHZhciBjID0gbmV3IENvbXBvbmVudFJlZ2lzdHJ5KCk7XG5cblxuICBjLnJlZ2lzdGVyTWFueShbXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi91dGlsL2NvbXBvbmVudC1sb2FkZXJcIiksXG4gICAgICBhczogXCJjb21wb25lbnQtbG9hZGVyXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi91dGlsL3BlcmlvZGljXCIpLFxuICAgICAgYXM6IFwicGVyaW9kaWNcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL3V0aWwvcmV0cnlhYmxlXCIpLFxuICAgICAgYXM6IFwicmV0cnlhYmxlXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi91dGlsL3RpbWVyXCIpLFxuICAgICAgYXM6IFwidGltZXJcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL2NvcmUvZGlzcGF0Y2hlclwiKSxcbiAgICAgIGFzOiBcImRpc3BhdGNoZXJcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL2NvcmUvY291bnRkb3duLWxhdGNoXCIpLFxuICAgICAgYXM6IFwiY291bnRkb3duLWxhdGNoXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9jb3JlL29wdGlvbnNcIiksXG4gICAgICBhczogXCJvcHRpb25zXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9jb3JlL2xhbmdcIiksXG4gICAgICBhczogXCJsYW5nXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9jb3JlL3JlZlwiKSxcbiAgICAgIGFzOiBcInJlZlwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29yZS9zdGF0ZS1ndWFyZFwiKSxcbiAgICAgIGFzOiBcInN0YXRlLWd1YXJkXCJcbiAgICB9LFxuXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL2NvcmUvcHViLXN1YlwiKSxcbiAgICAgIGFzOiBcInB1Yi1zdWJcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL2NvcmUvc2VxdWVuY2VyL3VuaXQtc2VxdWVuY2VyXCIpLFxuICAgICAgYXM6IFtcInVuaXQtc2VxdWVuY2VyXCIsIFwic2VxdWVuY2VyXCJdXG4gICAgfSxcblxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9jb3JlL3NlcXVlbmNlci9jbG9jay1zZXF1ZW5jZXJcIiksXG4gICAgICBhczogXCJjbG9jay1zZXF1ZW5jZXJcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL2NvcmUvc2VxdWVuY2VyL2RlbGVnYXRpbmctY29tcG9zaXRlLXNlcXVlbmNlclwiKSxcbiAgICAgIGFzOiBcImRlbGVnYXRpbmctY29tcG9zaXRlLXNlcXVlbmNlclwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29yZS9zZXF1ZW5jZXIvZGVsZWdhdGluZy1mb3J3YXJkaW5nLXNlcXVlbmNlclwiKSxcbiAgICAgIGFzOiBcImRlbGVnYXRpbmctZm9yd2FyZGluZy1zZXF1ZW5jZXJcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL2NvbGxlY3Rpb24vZG91Ymx5LWxpbmtlZC1saXN0XCIpLFxuICAgICAgYXM6IFwiZG91Ymx5LWxpbmtlZC1saXN0XCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9jb2xsZWN0aW9uL29iamVjdC1oYXNoLW1hcFwiKSxcbiAgICAgIGFzOiBbXCJoYXNoLW1hcFwiLCBcIm9iamVjdC1oYXNoLW1hcFwiXVxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL2NvbGxlY3Rpb24vbHJ1LWhhc2gtbWFwXCIpLFxuICAgICAgYXM6IFwibHJ1LWhhc2gtbWFwXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9zdG9yYWdlL2NhY2hpbmctZGF0YS1zdG9yZVwiKSxcbiAgICAgIGFzOiBcImNhY2hpbmctZGF0YS1zdG9yZVwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vc3RvcmFnZS9pbi1tZW1vcnktZGF0YS1zdG9yZVwiKSxcbiAgICAgIGFzOiBcImluLW1lbW9yeS1kYXRhLXN0b3JlXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9zdG9yYWdlL2xydS1kYXRhLXN0b3JlXCIpLFxuICAgICAgYXM6IFwibHJ1LWRhdGEtc3RvcmVcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL3N0b3JhZ2Uvc2lnbmFsaW5nLWRhdGEtc3RvcmVcIiksXG4gICAgICBhczogXCJzaWduYWxpbmctZGF0YS1zdG9yZVwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vdGltZS9jbG9jay9sb2dpY2FsLWNsb2NrXCIpLFxuICAgICAgYXM6IFwibG9naWNhbC1jbG9ja1wiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vdGltZS9jbG9jay9zeXN0ZW0tY2xvY2tcIiksXG4gICAgICBhczogXCJzeXN0ZW0tY2xvY2tcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL2FwcGtpdC9jb25maWd1cmF0aW9uLW1hZ2ljXCIpLFxuICAgICAgYXM6IFwiY29uZmlndXJhdGlvbi1tYWdpY1wiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vYXBwa2l0L2NvbmZpZy9zY29wZWQtY29uZmlndXJhdGlvbi1yZXNvbHZlclwiKSxcbiAgICAgIGFzOiBcInNjb3BlZC1jb25maWd1cmF0aW9uLXJlc29sdmVyXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9hcHBraXQvY29uZmlnL3Njb3BlZC1jb25maWd1cmF0aW9uXCIpLFxuICAgICAgYXM6IFtcInNjb3BlZC1jb25maWd1cmF0aW9uXCIsIFwiY29uZmlnL3Njb3BlZC1jb25maWd1cmF0aW9uXCJdXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vYXBwa2l0L2FwcFwiKSxcbiAgICAgIGFzOiBcImFwcFwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vcnVudGltZVwiKSxcbiAgICAgIGFzOiBcInJ1bnRpbWVcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL2NvcmUvbG9nZ2luZy9sb2dnZXJcIiksXG4gICAgICBhczogXCJsb2dnZXJcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL2NvcmUvbG9nZ2luZy9hcHBlbmRlcnMvY29uc29sZS1sb2ctYXBwZW5kZXJcIiksXG4gICAgICBhczogW1wiYXBwZW5kZXJzL2NvbnNvbGUtbG9nXCIsIFwiY29uc29sZS1sb2ctYXBwZW5kZXJcIl1cbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9jb3JlL2NoYW5uZWwvY2hhbm5lbFwiKSxcbiAgICAgIGFzOiBcImNoYW5uZWxcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL2NvcmUvY2hhbm5lbC9jaGFpbmVkLWNoYW5uZWxcIiksXG4gICAgICBhczogXCJjaGFpbmVkLWNoYW5uZWxcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL2NvcmUvY2hhbm5lbC9jb21wb3NpdGUtY2hhbm5lbFwiKSxcbiAgICAgIGFzOiBcImNvbXBvc2l0ZS1jaGFubmVsXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9tZXNzYWdpbmcvZXhjaGFuZ2VcIiksXG4gICAgICBhczogXCJtZXNzYWdpbmcvZXhjaGFuZ2VcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL21lc3NhZ2luZy9jb3VyaWVyXCIpLFxuICAgICAgYXM6IFwibWVzc2FnaW5nL2NvdXJpZXJcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL21lc3NhZ2luZy9maWJlci9pbi1tZW1vcnktZmliZXJcIiksXG4gICAgICBhczogXCJtZXNzYWdpbmcvZmliZXJzL2luLW1lbW9yeVwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vbWVzc2FnaW5nL2ZpYmVyL2xpbmthYmxlLWZpYmVyXCIpLFxuICAgICAgYXM6IFwibWVzc2FnaW5nL2ZpYmVycy9saW5rYWJsZVwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29yZS91dWlkXCIpLFxuICAgICAgYXM6IFwidXVpZFwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29yZS9zZXJkZS9qc29uLXNlcmRlXCIpLFxuICAgICAgYXM6IFtcInNlcmRlL2pzb25cIiwgXCJqc29uLXNlcmRlXCJdXG4gICAgfVxuICBdKTtcblxuICBjLnNlbGZSZWdpc3Rlcih7XG4gICAgYXM6IFwiY29tcG9uZW50LXJlZ2lzdHJ5XCJcbiAgfSk7XG5cbiAgd2ViQWxpYXNlcyhjKTtcbiAgbm9kZUFsaWFzZXMoYyk7XG5cbiAgcmV0dXJuIGM7XG59O1xuXG52YXIgZyA9ICh0eXBlb2Ygd2luZG93ID09PSBcInVuZGVmaW5lZFwiID8ge30gOiB3aW5kb3cpO1xuZy50aGlja2V0ID0gbW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCIuL3V0aWwvY29tcG9uZW50LXJlZ2lzdHJ5XCIpLFxuICByZXF1aXJlKFwiLi93ZWJcIiksXG4gIHJlcXVpcmUoXCIuL25vZGVcIilcbik7XG5cbn0pKCkiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGMpIHt9O1xuIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihjKSB7XG4gIGMucmVnaXN0ZXJNYW55KFtcbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL2FwcGtpdC9ib290c3RyYXBwZXJcIiksXG4gICAgICBhczogXCJib290c3RyYXBwZXJcIlxuICAgIH0sXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9hcHBraXQvd2ViLWFwcC1jb250YWluZXJcIiksXG4gICAgICBhczogXCJhcHAtY29udGFpbmVyXCJcbiAgICB9LFxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vc2NoZWR1bGVyL3dlYi1zY2hlZHVsZXJcIiksXG4gICAgICBhczogXCJzY2hlZHVsZXJcIlxuICAgIH1cbiAgXSk7XG5cbiAgcmVxdWlyZShcIi4vYnJvd3NlcmlmeTItbGlzdFwiKTtcbn07XG4iLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIi4vZGVmYXVsdC1ydW50aW1lXCIpO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7cmVxdWlyZShcIi4vcnVudGltZS9kZWZhdWx0LXJ1bnRpbWUuanNcIik7XG5yZXF1aXJlKFwiLi9ydW50aW1lL2luZGV4LmpzXCIpO1xucmVxdWlyZShcIi4vbm9kZS5qc1wiKTtcbnJlcXVpcmUoXCIuL2NvcmUvc2VyZGUvanNvbi1zZXJkZS5qc1wiKTtcbnJlcXVpcmUoXCIuL2NvcmUvdXVpZC5qc1wiKTtcbnJlcXVpcmUoXCIuL2NvcmUvbG9nZ2luZy9sb2dnZXIuanNcIik7XG5yZXF1aXJlKFwiLi9jb3JlL2xvZ2dpbmcvYXBwZW5kZXJzL2NvbnNvbGUtbG9nLWFwcGVuZGVyLmpzXCIpO1xucmVxdWlyZShcIi4vY29yZS9vcHRpb25zLmpzXCIpO1xucmVxdWlyZShcIi4vY29yZS9wdWItc3ViLmpzXCIpO1xucmVxdWlyZShcIi4vY29yZS9kaXNwYXRjaGVyLmpzXCIpO1xucmVxdWlyZShcIi4vY29yZS9yZWYvZGVsZWdhdGluZy1yZWYuanNcIik7XG5yZXF1aXJlKFwiLi9jb3JlL3JlZi9yZWYuanNcIik7XG5yZXF1aXJlKFwiLi9jb3JlL3JlZi9pbmRleC5qc1wiKTtcbnJlcXVpcmUoXCIuL2NvcmUvc2VxdWVuY2VyL2RlbGVnYXRpbmctZm9yd2FyZGluZy1zZXF1ZW5jZXIuanNcIik7XG5yZXF1aXJlKFwiLi9jb3JlL3NlcXVlbmNlci9jbG9jay1zZXF1ZW5jZXIuanNcIik7XG5yZXF1aXJlKFwiLi9jb3JlL3NlcXVlbmNlci91bml0LXNlcXVlbmNlci5qc1wiKTtcbnJlcXVpcmUoXCIuL2NvcmUvc2VxdWVuY2VyL2RlbGVnYXRpbmctY29tcG9zaXRlLXNlcXVlbmNlci5qc1wiKTtcbnJlcXVpcmUoXCIuL2NvcmUvc3RhdGUtZ3VhcmQuanNcIik7XG5yZXF1aXJlKFwiLi9jb3JlL3NjaGVkdWxlci9zZXQtdGltZW91dC1zY2hlZHVsZXIuanNcIik7XG5yZXF1aXJlKFwiLi9jb3JlL2NvdW50ZG93bi1sYXRjaC5qc1wiKTtcbnJlcXVpcmUoXCIuL2NvcmUvbGFuZy5qc1wiKTtcbnJlcXVpcmUoXCIuL2NvcmUvY2hhbm5lbC9jaGFpbmVkLWNoYW5uZWwuanNcIik7XG5yZXF1aXJlKFwiLi9jb3JlL2NoYW5uZWwvY2hhbm5lbC5qc1wiKTtcbnJlcXVpcmUoXCIuL2NvcmUvY2hhbm5lbC9jb21wb3NpdGUtY2hhbm5lbC5qc1wiKTtcbnJlcXVpcmUoXCIuL3dlYi5qc1wiKTtcbnJlcXVpcmUoXCIuL3N0b3JhZ2Uvc2lnbmFsaW5nLWRhdGEtc3RvcmUuanNcIik7XG5yZXF1aXJlKFwiLi9zdG9yYWdlL2xydS1kYXRhLXN0b3JlLmpzXCIpO1xucmVxdWlyZShcIi4vc3RvcmFnZS9pbi1tZW1vcnktZGF0YS1zdG9yZS5qc1wiKTtcbnJlcXVpcmUoXCIuL3N0b3JhZ2UvaW50ZXJuYWxzL2V4cGlyaW5nLWVudHJ5LmpzXCIpO1xucmVxdWlyZShcIi4vc3RvcmFnZS9jYWNoaW5nLWRhdGEtc3RvcmUuanNcIik7XG5yZXF1aXJlKFwiLi91dGlsL2NvbXBvbmVudC1sb2FkZXIuanNcIik7XG5yZXF1aXJlKFwiLi91dGlsL2NvbXBvbmVudC1yZWdpc3RyeS5qc1wiKTtcbnJlcXVpcmUoXCIuL3V0aWwvdGltZXIuanNcIik7XG5yZXF1aXJlKFwiLi91dGlsL3JldHJ5YWJsZS5qc1wiKTtcbnJlcXVpcmUoXCIuL3V0aWwvcGVyaW9kaWMuanNcIik7XG5yZXF1aXJlKFwiLi9tZXNzYWdpbmcvaW50ZXJuYWxzL21haWxib3guanNcIik7XG5yZXF1aXJlKFwiLi9tZXNzYWdpbmcvY291cmllci5qc1wiKTtcbnJlcXVpcmUoXCIuL21lc3NhZ2luZy9maWJlci9saW5rYWJsZS1maWJlci5qc1wiKTtcbnJlcXVpcmUoXCIuL21lc3NhZ2luZy9maWJlci9pbi1tZW1vcnktZmliZXIuanNcIik7XG5yZXF1aXJlKFwiLi9tZXNzYWdpbmcvZXhjaGFuZ2UuanNcIik7XG5yZXF1aXJlKFwiLi9hcHBraXQvYXBwLmpzXCIpO1xucmVxdWlyZShcIi4vYXBwa2l0L2ludGVybmFsL3Byb2Nlc3Mta2VlcC1hbGl2ZS5qc1wiKTtcbnJlcXVpcmUoXCIuL2FwcGtpdC9jb25maWcvc2NvcGVkLWNvbmZpZ3VyYXRpb24tcmVzb2x2ZXIuanNcIik7XG5yZXF1aXJlKFwiLi9hcHBraXQvY29uZmlnL3Njb3BlZC1jb25maWd1cmF0aW9uLmpzXCIpO1xucmVxdWlyZShcIi4vYXBwa2l0L3dlYi1hcHAtY29udGFpbmVyLmpzXCIpO1xucmVxdWlyZShcIi4vYXBwa2l0L2NvbmZpZ3VyYXRpb24tbWFnaWMuanNcIik7XG5yZXF1aXJlKFwiLi9hcHBraXQvYm9vdHN0cmFwcGVyLmpzXCIpO1xucmVxdWlyZShcIi4vc2NoZWR1bGVyL3dlYi1zY2hlZHVsZXIuanNcIik7XG5yZXF1aXJlKFwiLi9zY2hlZHVsZXIvaW5kZXguanNcIik7XG5yZXF1aXJlKFwiLi9pbmRleC5qc1wiKTtcbnJlcXVpcmUoXCIuL3RpbWUvY2xvY2svbG9naWNhbC1jbG9jay5qc1wiKTtcbnJlcXVpcmUoXCIuL3RpbWUvY2xvY2svc3lzdGVtLWNsb2NrLmpzXCIpO1xucmVxdWlyZShcIi4vY29sbGVjdGlvbi9scnUtaGFzaC1tYXAuanNcIik7XG5yZXF1aXJlKFwiLi9jb2xsZWN0aW9uL29iamVjdC1oYXNoLW1hcC5qc1wiKTtcbnJlcXVpcmUoXCIuL2NvbGxlY3Rpb24vZG91Ymx5LWxpbmtlZC1saXN0LmpzXCIpO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgZmFjdG9yeSA9IGZ1bmN0aW9uKFxuICBfLFxuICBPcHRpb25zXG4pIHtcbiAgdmFyIENvbXBvbmVudExvYWRlciA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKENvbXBvbmVudExvYWRlci5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihyZXF1aXJlRnVuKSB7XG4gICAgICB0aGlzLl9yZXF1aXJlRnVuID0gcmVxdWlyZUZ1bjtcbiAgICAgIHRoaXMuX2FsaWFzZXMgPSB7fTtcbiAgICAgIHRoaXMuX3BhdGhUcmFuc2Zvcm0gPSBmdW5jdGlvbihpZCkgeyByZXR1cm4gaWQ7fTtcbiAgICB9LFxuXG4gICAgc2V0UGF0aFRyYW5zZm9ybTogZnVuY3Rpb24ocGF0aFRyYW5zZm9ybSkge1xuICAgICAgdGhpcy5fcGF0aFRyYW5zZm9ybSA9IHBhdGhUcmFuc2Zvcm07XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gICAgYWxpYXM6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB2YXIgYWxpYXNOYW1lICA9IG9wdHMuZ2V0T3JFcnJvcihcImFzXCIpO1xuICAgICAgdGhpcy5fYWxpYXNlc1thbGlhc05hbWVdID0gb3B0cy5nZXRPckVycm9yKFwibW9kdWxlXCIpO1xuICAgIH0sXG5cbiAgICBidWxrQWxpYXM6IGZ1bmN0aW9uKGFsaWFzZXMpIHtcbiAgICAgIF8uZWFjaChhbGlhc2VzLCBmdW5jdGlvbihhbGlhc05hbWVzLCBtb2R1bGVOYW1lKSB7XG4gICAgICAgIGlmICghXy5pc0FycmF5KGFsaWFzTmFtZXMpKSB7XG4gICAgICAgICAgYWxpYXNOYW1lcyA9IFthbGlhc05hbWVzXVxuICAgICAgICB9XG4gICAgICAgIF8uZWFjaChhbGlhc05hbWVzLCBmdW5jdGlvbihhbGlhc05hbWUpIHtcbiAgICAgICAgICB0aGlzLmFsaWFzKHttb2R1bGU6IG1vZHVsZU5hbWUsIGFzOiBhbGlhc05hbWV9KTtcbiAgICAgICAgfSwgdGhpcyk7XG4gICAgICB9LCB0aGlzKTtcbiAgICB9LFxuXG4gICAgY29tcG9uZW50OiBmdW5jdGlvbihhbGlhcykge1xuICAgICAgdmFyIG1vZCA9IHRoaXMuX2FsaWFzZXNbYWxpYXNdO1xuICAgICAgaWYgKCFtb2QpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBhbGlhcyBwcm92aWRlZCAobm8gc3VjaCBtb2R1bGUpOiBgXCIrYWxpYXMrXCInXCIpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMuX3JlcXVpcmVGdW4odGhpcy5fcGF0aFRyYW5zZm9ybShtb2QpKTtcbiAgICB9LFxuXG4gICAgYzogZnVuY3Rpb24oYWxpYXMpIHtcbiAgICAgIHJldHVybiB0aGlzLmNvbXBvbmVudC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIENvbXBvbmVudExvYWRlcjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL29wdGlvbnNcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgUHJvbWlzZSxcbiAgT3B0aW9ucyxcbiAgTGFuZyxcbiAgU3RhdGVHdWFyZCxcbiAgTG9nZ2VyXG4pIHtcblxuICB2YXIgTG9nID0gTG9nZ2VyLmNyZWF0ZShcIlJldHJ5YWJsZVwiKTtcblxuICB2YXIgUmV0cnlhYmxlID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoUmV0cnlhYmxlLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB0aGlzLl9zY2hlZHVsZXIgID0gb3B0cy5nZXRPckVycm9yKFwic2NoZWR1bGVyXCIpO1xuICAgICAgdGhpcy5fdGFzayAgICAgICA9IG9wdHMuZ2V0T3JFcnJvcihcInRhc2tcIik7XG4gICAgICAvLyBJZiBub3QgcHJvdmlkZWQsIGdvIG9uIGZvcmV2ZXIuXG4gICAgICB0aGlzLl9yZXRyaWVzICAgID0gb3B0cy5nZXRPckVsc2UoXCJyZXRyaWVzXCIpO1xuICAgICAgdGhpcy5fY3VycmVudFRyeSA9IDA7XG4gICAgICB0aGlzLl9kZWZlcnJlZCAgID0gTGFuZy5kZWZlcnJlZCgpO1xuXG4gICAgICB2YXIgYmFja29mZiA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzLmdldE9yRWxzZUZuKFwiYmFja29mZlwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdHJhdGVneTogUmV0cnlhYmxlLkJhY2tvZmYuTGluZWFyLFxuICAgICAgICAgIGZhY3RvcjogMSxcbiAgICAgICAgICBjb2VmZmljaWVudDogMjUwXG4gICAgICAgIH07XG4gICAgICB9KSk7XG5cbiAgICAgIHZhciBTdHJhdGVneUNsYXNzID0gQmFja29mZlN0cmF0ZWd5W2JhY2tvZmYuZ2V0T3JFcnJvcihcInN0cmF0ZWd5XCIpXTtcblxuICAgICAgdGhpcy5fYmFja29mZlN0cmF0ZWd5ID0gbmV3IFN0cmF0ZWd5Q2xhc3MoYmFja29mZi50b09iamVjdCgpKTtcbiAgICAgIHRoaXMuX2Rpc3Bvc2VkR3VhcmQgICA9IFN0YXRlR3VhcmQuc2NvcGVkKFwiZGlzcG9zZWRcIik7XG5cbiAgICAgIF8uYmluZEFsbCh0aGlzLCBcIl9hdHRlbXB0XCIpO1xuICAgICAgdGhpcy5fY3VycmVudFJ1biA9IG51bGw7XG4gICAgICB0aGlzLl9zY2hlZHVsZXIuZ2V0KCkucnVuU29vbih0aGlzLl9hdHRlbXB0KTtcbiAgICB9LFxuXG4gICAgZGlzcG9zZTogZnVuY3Rpb24oKSB7XG4gICAgICBpZiAodGhpcy5fZGlzcG9zZWRHdWFyZC5hcHBsaWVkKCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5fY3VycmVudFJ1bikge1xuICAgICAgICB0aGlzLl9jdXJyZW50UnVuLmNhbmNlbChuZXcgUmV0cnlhYmxlLkVycm9yLkRpc3Bvc2VkRXJyb3IoKSk7XG4gICAgICAgIHRoaXMuX2N1cnJlbnRSdW4gPSBudWxsO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl90YXNrID0gbnVsbDtcblxuICAgICAgdGhpcy5fZGlzcG9zZWRHdWFyZC5hcHBseSgpO1xuICAgIH0sXG5cbiAgICByZXN1bHQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2RlZmVycmVkLnByb21pc2U7XG4gICAgfSxcblxuICAgIF9hdHRlbXB0OiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICh0aGlzLl9kaXNwb3NlZEd1YXJkLmFwcGxpZWQoKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuX2N1cnJlbnRSdW4gPSBQcm9taXNlXG4gICAgICAgIC5iaW5kKHRoaXMpXG4gICAgICAgIC5jYW5jZWxsYWJsZSgpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLl90YXNrKCk7XG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgIGlmICh0aGlzLl9kZWZlcnJlZC5wcm9taXNlLmlzUGVuZGluZygpKSB7XG4gICAgICAgICAgICB0aGlzLl9kZWZlcnJlZC5yZXNvbHZlKHJlc3VsdCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAuY2F1Z2h0KFJldHJ5YWJsZS5FcnJvci5EaXNwb3NlZEVycm9yLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICB0aGlzLl9kZWZlcnJlZC5wcm9taXNlLmNhbmNlbChuZXcgUHJvbWlzZS5DYW5jZWxsYXRpb25FcnJvcigpKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdWdodChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICBpZiAodGhpcy5fZGlzcG9zZWRHdWFyZC5hcHBsaWVkKCkpIHtcbiAgICAgICAgICAgIExvZy53YXJuKFwiQ2F1Z2h0IHJldHJ5YWJsZSBydW4gZXJyb3IsIGJ1dCByZXRyeWFibGUgaXMgYWxyZWFkeSBkaXNwb3NlZFwiKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBMb2cuZGVidWcoXCJSZWNlaXZlZCBlcnJvciBpbiBhdHRlbXB0XCIsIHRoaXMuX2N1cnJlbnRUcnkpO1xuICAgICAgICAgIHZhciBuZXh0VHJ5ID0gdGhpcy5fY3VycmVudFRyeSArIDE7XG5cbiAgICAgICAgICBpZiAodGhpcy5fcmV0cmllcyA+PSAwICYmIG5leHRUcnkgPiB0aGlzLl9yZXRyaWVzKSB7XG4gICAgICAgICAgICBMb2cuZGVidWcoXCJIaXQgbWF4IG51bWJlciBvZiByZXRyaWVzOlwiLCB0aGlzLl9yZXRyaWVzKTtcbiAgICAgICAgICAgIHZhciBlID0gbmV3IFJldHJ5YWJsZS5FcnJvci5NYXhSZXRyaWVzRXJyb3IoKTtcbiAgICAgICAgICAgIGUuY2F1c2UgPSBlcnI7XG4gICAgICAgICAgICB0aHJvdyBlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIFNjaGVkdWxlIHVzIHVwIHRvIHRyeSBhZ2FpbjtcbiAgICAgICAgICB0aGlzLl9jdXJyZW50UnVuID0gbnVsbDtcbiAgICAgICAgICB0aGlzLl9jdXJyZW50VHJ5ID0gbmV4dFRyeTtcblxuICAgICAgICAgIHZhciB0aW1lID0gdGhpcy5fYmFja29mZlN0cmF0ZWd5LnRpbWUodGhpcy5fY3VycmVudFRyeSk7XG4gICAgICAgICAgdGhpcy5fc2NoZWR1bGVyLmdldCgpLnNjaGVkdWxlKHRoaXMuX2F0dGVtcHQsIHRpbWUpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F1Z2h0KFJldHJ5YWJsZS5FcnJvci5NYXhSZXRyaWVzRXJyb3IsIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgIGlmICh0aGlzLl9kZWZlcnJlZC5wcm9taXNlLmlzUGVuZGluZygpKSB7XG4gICAgICAgICAgICB0aGlzLl9kZWZlcnJlZC5yZWplY3QoZXJyLmNhdXNlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG5cbiAgXy5leHRlbmQoUmV0cnlhYmxlLCB7XG4gICAgQmFja29mZjoge1xuICAgICAgTGluZWFyOiAgICAgIFwibGluZWFyXCIsXG4gICAgICBFeHBvbmVudGlhbDogXCJleHBvbmVudGlhbFwiXG4gICAgfSxcbiAgICBFcnJvcjoge1xuICAgICAgRGlzcG9zZWRFcnJvcjogTGFuZy5tYWtlRXJyb3JDbGFzcyhcIkRpc3Bvc2VkRXJyb3JcIiwgXCJSZXRyeWFibGUgd2FzIGRpc3Bvc2VkXCIpLFxuICAgICAgTWF4UmV0cmllc0Vycm9yOiBMYW5nLm1ha2VFcnJvckNsYXNzKFwiTWF4UmV0cmllc0Vycm9yXCIsIFwiUmV0cnlhYmxlIHdhcyByZXRyaWVkIHRvbyBtYW55IHRpbWVzXCIpXG4gICAgfVxuICB9KVxuXG4gIHZhciBCYWNrb2ZmU3RyYXRlZ3kgPSAoZnVuY3Rpb24oKSB7XG4gICAgdmFyIExpbmVhciA9IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfTtcblxuICAgIF8uZXh0ZW5kKExpbmVhci5wcm90b3R5cGUsIHtcbiAgICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgICAgdGhpcy5fZmFjdG9yICAgICAgICA9IG9wdHMuZ2V0T3JFbHNlKFwiZmFjdG9yXCIsIDEpO1xuICAgICAgICB0aGlzLl9jb2VmZmljaWVudCAgID0gb3B0cy5nZXRPckVsc2UoXCJjb2VmZmljaWVudFwiLCAyNTApO1xuICAgICAgfSxcblxuICAgICAgdGltZTogZnVuY3Rpb24oaXRlcmF0aW9uKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9mYWN0b3IgKiB0aGlzLl9jb2VmZmljaWVudCAqIGl0ZXJhdGlvbjtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHZhciBFeHBvbmVudGlhbCA9IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfTtcblxuICAgIF8uZXh0ZW5kKEV4cG9uZW50aWFsLnByb3RvdHlwZSwge1xuICAgICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuXG4gICAgICAgIHRoaXMuX2Jhc2UgICAgICAgID0gb3B0cy5nZXRPckVsc2UoXCJiYXNlXCIsIDIpO1xuICAgICAgICB0aGlzLl9jb2VmZmljaWVudCA9IG9wdHMuZ2V0T3JFbHNlKFwiY29lZmZpY2llbnRcIiwgMjUwKTtcbiAgICAgIH0sXG5cbiAgICAgIHRpbWU6IGZ1bmN0aW9uKGl0ZXJhdGlvbikge1xuICAgICAgICByZXR1cm4gdGhpcy5fY29lZmZpY2llbnQgKiAoTWF0aC5wb3codGhpcy5fYmFzZSwgaXRlcmF0aW9uKSk7XG4gICAgICB9XG4gICAgfSlcblxuXG4gICAgdmFyIGJhY2tvZmZzID0ge307XG5cbiAgICBiYWNrb2Zmc1tSZXRyeWFibGUuQmFja29mZi5MaW5lYXJdICAgICAgPSBMaW5lYXI7XG4gICAgYmFja29mZnNbUmV0cnlhYmxlLkJhY2tvZmYuRXhwb25lbnRpYWxdID0gRXhwb25lbnRpYWw7XG5cbiAgICByZXR1cm4gYmFja29mZnM7XG4gIH0oKSk7XG5cbiAgcmV0dXJuIFJldHJ5YWJsZTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcImJsdWViaXJkXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9vcHRpb25zXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9sYW5nXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9zdGF0ZS1ndWFyZFwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvbG9nZ2luZy9sb2dnZXJcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgUHJvbWlzZSxcbiAgT3B0aW9ucyxcbiAgU3RhdGVHdWFyZCxcbiAgQ2hhbm5lbCxcbiAgQ2hhaW5lZENoYW5uZWwsXG4gIExvZ2dlclxuKSB7XG5cbiAgdmFyIFBlcmlvZGljID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgdmFyIExvZyA9IExvZ2dlci5jcmVhdGUoXCJQZXJpb2RpY1wiKTtcblxuICBfLmV4dGVuZChQZXJpb2RpYy5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdGhpcy5fc2NoZWR1bGVyUmVmID0gb3B0cy5nZXRPckVycm9yKFwic2NoZWR1bGVyXCIpO1xuICAgICAgdGhpcy5fdGFzayAgICAgICAgID0gb3B0cy5nZXRPckVsc2UoXCJ0YXNrXCIpO1xuICAgICAgdGhpcy5faW50ZXJ2YWwgICAgID0gb3B0cy5nZXRPckVycm9yKFwiaW50ZXJ2YWxcIik7XG5cbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQgICA9IG5ldyBTdGF0ZUd1YXJkKFtcImRpc3Bvc2VkXCIsIFwic3RhcnRlZFwiXSk7XG4gICAgICB0aGlzLl9jaGFubmVsICAgICAgPSBuZXcgQ2hhbm5lbCh7IHNlbnRpbmVsOiB0aGlzIH0pO1xuICAgICAgdGhpcy5fdGFza0lkICAgICAgID0gbnVsbDtcblxuICAgICAgXy5iaW5kQWxsKHRoaXMsIFwiX3J1blRhc2tcIik7XG4gICAgfSxcblxuXG4gICAgc3RhcnQ6IGZ1bmN0aW9uKCl7XG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkXG4gICAgICAgIC5kZW55KFwiZGlzcG9zZWRcIiwgXCJzdGFydGVkXCIpXG4gICAgICAgIC5hcHBseShcInN0YXJ0ZWRcIik7XG5cbiAgICAgIHRoaXMuX3NjaGVkdWxlTmV4dCh0cnVlKTtcbiAgICB9LFxuXG5cbiAgICBzdG9wOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX2NhbmNlbFBlbmRpbmcoKTtcbiAgICAgIHRoaXMuX2NhbmNlbE91dHN0YW5kaW5nKCk7XG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkLnVuYXBwbHkoXCJzdGFydGVkXCIpO1xuICAgIH0sXG5cbiAgICBlZ3Jlc3NDaGFubmVsOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBuZXcgQ2hhaW5lZENoYW5uZWwoe1xuICAgICAgICBzZW50aW5lbDogdGhpcyxcbiAgICAgICAgY2hhaW5UbzogdGhpcy5fY2hhbm5lbFxuICAgICAgfSk7XG4gICAgfSxcblxuICAgIF9ydW5UYXNrOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciByZXN1bHRzID0ge1xuICAgICAgICBtVDogXCJyZXN1bHRzXCIsXG4gICAgICAgIHJlc3VsdDogbnVsbCxcbiAgICAgICAgZXJyOiBudWxsXG4gICAgICB9O1xuXG4gICAgICB0aGlzLl90YXNrSWQgPSBudWxsO1xuICAgICAgdGhpcy5fY3VycmVudFJ1biA9IFByb21pc2VcbiAgICAgICAgLmJpbmQodGhpcylcbiAgICAgICAgLmNhbmNlbGxhYmxlKClcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX3Rhc2soKTtcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgcmVzdWx0cy5yZXN1bHQgPSByZXN1bHQ7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXVnaHQoUHJvbWlzZS5DYW5jZWxsYXRpb25FcnJvciwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgLy8gTGV0IGl0IGJlLiBEb24ndCB3YW50IGl0IHRvIHRyaWNrbGUgaW50byB0aGUgcmVzdWx0cy5cbiAgICAgICAgfSlcbiAgICAgICAgLmNhdWdodChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICByZXN1bHRzLmVyciA9IGVycjtcbiAgICAgICAgfSlcbiAgICAgICAgLmxhc3RseShmdW5jdGlvbigpIHtcbiAgICAgICAgICB0aGlzLl9jdXJyZW50UnVuID0gbnVsbDtcbiAgICAgICAgICB0aGlzLl9ub3RpZnlSZXN1bHRzKHJlc3VsdHMpO1xuICAgICAgICAgIHRoaXMuX3NjaGVkdWxlTmV4dCgpO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG5cbiAgICBfbm90aWZ5UmVzdWx0czogZnVuY3Rpb24ocmVzdWx0cykge1xuICAgICAgdGhpcy5fc2NoZWR1bGVyUmVmLmdldCgpLnJ1blNvb24oXy5iaW5kKGZ1bmN0aW9uKCkge1xuXG4gICAgICAgIGlmICh0aGlzLl9zdGF0ZUd1YXJkLmFwcGxpZWQoXCJkaXNwb3NlZFwiKSB8fCAhdGhpcy5fc3RhdGVHdWFyZC5hcHBsaWVkKFwic3RhcnRlZFwiKSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChMb2cuaXNUcmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgIExvZy50cmFjZShcIk5vdGlmeWluZyByZXN1bHRzXCIsIHJlc3VsdHMpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fY2hhbm5lbC5wdWJsaXNoKHRoaXMsIHJlc3VsdHMpO1xuICAgICAgfSwgdGhpcykpO1xuICAgIH0sXG5cblxuICAgIF9zY2hlZHVsZU5leHQ6IGZ1bmN0aW9uKG5vdykge1xuICAgICAgaWYgKHRoaXMuX3N0YXRlR3VhcmQuYXBwbGllZChcImRpc3Bvc2VkXCIpIHx8ICF0aGlzLl9zdGF0ZUd1YXJkLmFwcGxpZWQoXCJzdGFydGVkXCIpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRoaXMuX3Rhc2tJZCA9IHRoaXMuX3NjaGVkdWxlclJlZi5nZXQoKS5zY2hlZHVsZSh0aGlzLl9ydW5UYXNrLCBub3cgPyAwIDogdGhpcy5faW50ZXJ2YWwpO1xuICAgICAgTG9nLnRyYWNlKFwiU2NoZWR1bGVkIHRhc2tcIiwgdGhpcy5fdGFza0lkKTtcbiAgICB9LFxuXG5cbiAgICBfY2FuY2VsUGVuZGluZzogZnVuY3Rpb24oKSB7XG4gICAgICBMb2cudHJhY2UoXCJjYW5jZWxQZW5kaW5nIHJlcXVlc3RlZCwgbG9va2luZyBmb3IgcGVuZGluZyB0YXNrLlwiKTtcbiAgICAgIGlmICh0aGlzLl90YXNrSWQpIHtcbiAgICAgICAgTG9nLnRyYWNlKFwiRm91bmQgcGVuZGluZyB0YXNrOyBjYW5jZWxsaW5nXCIsIHRoaXMuX3Rhc2tJZCk7XG4gICAgICAgIHRoaXMuX3NjaGVkdWxlclJlZi5nZXQoKS51bnNjaGVkdWxlKHRoaXMuX3Rhc2tJZCk7XG4gICAgICAgIHRoaXMuX3Rhc2tJZCA9IG51bGw7XG4gICAgICB9XG4gICAgfSxcblxuICAgIF9jYW5jZWxPdXRzdGFuZGluZzogZnVuY3Rpb24oKSB7XG4gICAgICBMb2cudHJhY2UoXCJjYW5jZWxPdXRzdGFuZGluZyByZXF1ZXN0ZWQsIGxvb2tpbmcgZm9yIG91dHN0YW5kaW5nIHdvcmsuXCIpO1xuICAgICAgaWYgKHRoaXMuX2N1cnJlbnRSdW4pIHtcbiAgICAgICAgTG9nLnRyYWNlKFwiT3V0c3RhbmRpbmcgd29yayBmb3VuZDsgY2FuY2VsbGluZ1wiKTtcbiAgICAgICAgdGhpcy5fY3VycmVudFJ1bi5jYW5jZWwoKTtcbiAgICAgICAgdGhpcy5fY3VycmVudFJ1biA9IG51bGw7XG4gICAgICB9XG4gICAgfSxcblxuICAgIGRpc3Bvc2U6IGZ1bmN0aW9uKCl7XG4gICAgICBpZiAodGhpcy5fc3RhdGVHdWFyZC5hcHBsaWVkKFwiZGlzcG9zZWRcIikpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9jYW5jZWxQZW5kaW5nKCk7XG4gICAgICB0aGlzLl9jYW5jZWxPdXRzdGFuZGluZygpO1xuXG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkLmFwcGx5KFwiZGlzcG9zZWRcIik7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gUGVyaW9kaWM7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJibHVlYmlyZFwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvc3RhdGUtZ3VhcmRcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL2NoYW5uZWwvY2hhbm5lbFwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvY2hhbm5lbC9jaGFpbmVkLWNoYW5uZWxcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL2xvZ2dpbmcvbG9nZ2VyXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIE0sXG4gIE9wdGlvbnMsXG4gIFN0YXRlR3VhcmRcbikge1xuXG4gIC8qKlxuICAgKiBBdHRlbXB0cyB0byBpbnRlbGxpZ2VudGx5IGRpc3BhdGNoIGFuIG9iamVjdCB3aXRoIGFuIG1UIGF0dHJpYnV0ZSwgdXNpbmdcbiAgICogdGhlIHJ1bGVzIHByb3ZpZGVkIGF0IGluc3RhbnRpYXRpb24uXG4gICAqXG4gICAqIEZvciBhIGdpdmVuIG1UeXBlZCBvYmplY3QsIHNlYXJjaGVzIHRoZSBwcm92aWRlZCBgZGVsZWdhdGVgIGZvciBhIG1ldGhvZFxuICAgKiBuYW1lZCBbcHJlZml4XVtjYW1lbC1jYXNlZCBtVF0sIGFuZCBpZiBwcmVzZW50LCBjYWxscyBpdC4gSWYgbm90IGZvdW5kLFxuICAgKiBsb29rcyBmb3IgW3ByZWZpeF1FbHNlLiBJZiB0aGUgbVQgYXR0cmlidXRlIGlzbid0IGZvdW5kLCBkaXNwYXRjaGVzIHRvXG4gICAqIFtwcmVmaXhdTWFsZm9ybWVkLlxuICAgKi9cbiAgdmFyIERpc3BhdGNoZXIgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICB2YXIgREVGQVVMVF9DT05URVhUX0RFTEVHQVRFID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHt9O1xuICB9O1xuXG4gIF8uZXh0ZW5kKERpc3BhdGNoZXIucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIHRoaXMuX2RlbGVnYXRlICAgICAgICA9IG9wdHMuZ2V0T3JFcnJvcihcImRlbGVnYXRlXCIpLFxuICAgICAgdGhpcy5fcHJlZml4ICAgICAgICAgID0gb3B0cy5nZXRPckVsc2UoXCJwcmVmaXhcIiwgXCJvbk1zZ1wiKTtcbiAgICAgIHRoaXMuX2Vsc2VTdWZmaXggICAgICA9IG9wdHMuZ2V0T3JFbHNlKFwiZWxzZVN1ZmZpeFwiLCBcImVsc2VcIik7XG4gICAgICB0aGlzLl9tYWxmb3JtZWRTdWZmaXggPSBvcHRzLmdldE9yRWxzZShcIm1hbGZvcm1lZFN1ZmZpeFwiLCBcIm1hbGZvcm1lZFwiKTtcbiAgICAgIHRoaXMuX2NvbnRleHREZWxlZ2F0ZSA9IG9wdHMuZ2V0T3JFbHNlKFwiY29udGV4dERlbGVnYXRlXCIsIERFRkFVTFRfQ09OVEVYVF9ERUxFR0FURSk7XG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkICAgICAgPSBuZXcgU3RhdGVHdWFyZChbXCJkaXNwb3NlZFwiXSk7XG4gICAgICB0aGlzLl9zdWJzICAgICAgICAgICAgPSBNLmhhc2hfbWFwKCk7XG5cbiAgICAgIHZhciBjaGFubmVscyA9IG9wdHMuZ2V0T3JFbHNlKFwibGlzdGVuXCIsIFtdKTtcblxuICAgICAgaWYgKCFfLmlzQXJyYXkoY2hhbm5lbHMpKSB7XG4gICAgICAgIGNoYW5uZWxzID0gW2NoYW5uZWxzXTtcbiAgICAgIH1cblxuICAgICAgXy5lYWNoKGNoYW5uZWxzLCBfLmJpbmQoZnVuY3Rpb24oYykge1xuICAgICAgICB0aGlzLmxpc3RlbihjKVxuICAgICAgfSwgdGhpcykpO1xuICAgIH0sXG5cbiAgICBsaXN0ZW46IGZ1bmN0aW9uKGNoYW5uZWwpIHtcbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQuZGVueShcImRpc3Bvc2VkXCIpO1xuXG4gICAgICB2YXIgc3ViID0gY2hhbm5lbC5zdWJzY3JpYmUoXy5iaW5kKGZ1bmN0aW9uKG1zZykge1xuICAgICAgICB0aGlzLmRpc3BhdGNoKG1zZyk7XG4gICAgICB9LCB0aGlzKSk7XG5cbiAgICAgIHRoaXMuX3N1YnMgPSBNLmFzc29jKHRoaXMuX3N1YnMsIHN1Yi5pZCgpLCBzdWIpO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBkaXNwb3NlOiBfLmJpbmQoZnVuY3Rpb24oKXtcbiAgICAgICAgICB2YXIgblN1YiA9IE0uZ2V0KHRoaXMuX3N1YnMsIHN1Yi5pZCgpKTtcbiAgICAgICAgICBpZiAoblN1Yikge1xuICAgICAgICAgICAgdGhpcy5fc3VicyA9IE0uZGlzc29jKHRoaXMuX3N1YnMsIHN1Yi5pZCgpKTtcbiAgICAgICAgICAgIG5TdWIuZGlzcG9zZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSwgdGhpcylcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgZGlzcGF0Y2g6IGZ1bmN0aW9uKG1UeXBlZCwgY3R4KSB7XG4gICAgICBpZiAodGhpcy5fc3RhdGVHdWFyZC5hcHBsaWVkKFwiZGlzcG9zZWRcIikpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB2YXIgaGFuZGxlciA9IHRoaXMuX2dldFZldHRlZEhhbmRsZXJOYW1lKG1UeXBlZCk7XG5cbiAgICAgIGlmIChoYW5kbGVyKSB7XG4gICAgICAgIHRoaXMuX2RlbGVnYXRlW2hhbmRsZXJdKG1UeXBlZCwgdGhpcy5fY29udGV4dERlbGVnYXRlKG1UeXBlZCwgY3R4KSk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIExpa2UgYGRpc3BhdGNoYCwgYnV0IGV4cGVjdHMgZGVsZWdhdGUgdG8gcmV0dXJuIGEgUHJvbWlzZTxvYmplY3Q+XG4gICAgICovXG4gICAgZGlzcGF0Y2hBc3luYzogZnVuY3Rpb24obVR5cGVkLCBjdHgpIHtcbiAgICAgIGlmICh0aGlzLl9zdGF0ZUd1YXJkLmFwcGxpZWQoXCJkaXNwb3NlZFwiKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciBoYW5kbGVyID0gdGhpcy5fZ2V0VmV0dGVkSGFuZGxlck5hbWUobVR5cGVkKTtcbiAgICAgIGlmIChoYW5kbGVyKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9kZWxlZ2F0ZVtoYW5kbGVyXShtVHlwZWQsIHRoaXMuX2NvbnRleHREZWxlZ2F0ZShtVHlwZWQsIGN0eCkpO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBkaXNwb3NlOiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICh0aGlzLl9zdGF0ZUd1YXJkLmFwcGxpZWQoXCJkaXNwb3NlZFwiKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciBzdWJzID0gdGhpcy5fc3VicztcbiAgICAgIHRoaXMuX3N1YnMgPSBNLmhhc2hfbWFwKCk7XG5cbiAgICAgIE0uZWFjaChzdWJzLCBmdW5jdGlvbihwYWlyKSB7XG4gICAgICAgIE0ubnRoKHBhaXIsIDEpLmRpc3Bvc2UoKTtcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLl9kZWxlZ2F0ZSA9IG51bGw7XG5cbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQuYXBwbHkoXCJkaXNwb3NlZFwiKTtcbiAgICB9LFxuXG4gICAgX2dldEhhbmRsZXJOYW1lOiBmdW5jdGlvbihwcmVmaXgsIHN1ZmZpeCkge1xuICAgICAgcmV0dXJuIHByZWZpeCArIHN1ZmZpeC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHN1ZmZpeC5zdWJzdHIoMSk7XG4gICAgfSxcblxuICAgIF9nZXRWZXR0ZWRIYW5kbGVyTmFtZTogZnVuY3Rpb24obVR5cGVkKSB7XG4gICAgICB2YXIgbVQgPSBtVHlwZWQubVQsXG4gICAgICAgICAgcHJlZml4ID0gdGhpcy5fcHJlZml4LFxuICAgICAgICAgIHBvdGVudGlhbEhhbmRsZXJOYW1lLFxuICAgICAgICAgIGZpbmFsSGFuZGxlck5hbWU7XG5cbiAgICAgIGlmICghbVQpIHtcbiAgICAgICAgZmluYWxIYW5kbGVyTmFtZSA9IHRoaXMuX2dldEhhbmRsZXJOYW1lKHByZWZpeCwgdGhpcy5fbWFsZm9ybWVkU3VmZml4KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHBvdGVudGlhbEhhbmRsZXJOYW1lID0gdGhpcy5fZ2V0SGFuZGxlck5hbWUocHJlZml4LCBtVCk7XG4gICAgICAgIGlmIChfLmlzRnVuY3Rpb24odGhpcy5fZGVsZWdhdGVbcG90ZW50aWFsSGFuZGxlck5hbWVdKSkge1xuICAgICAgICAgIGZpbmFsSGFuZGxlck5hbWUgPSBwb3RlbnRpYWxIYW5kbGVyTmFtZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBmaW5hbEhhbmRsZXJOYW1lID0gdGhpcy5fZ2V0SGFuZGxlck5hbWUocHJlZml4LCB0aGlzLl9lbHNlU3VmZml4KTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoXy5pc0Z1bmN0aW9uKHRoaXMuX2RlbGVnYXRlW2ZpbmFsSGFuZGxlck5hbWVdKSkge1xuICAgICAgICByZXR1cm4gZmluYWxIYW5kbGVyTmFtZTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBEaXNwYXRjaGVyO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwibW9yaVwiKSxcbiAgcmVxdWlyZShcIi4vb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4vc3RhdGUtZ3VhcmRcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgX1xuKSB7XG5cbiAgdmFyIFRpbWVyID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoVGltZXIucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9zdGFydFRpbWUgPSBudWxsO1xuICAgICAgdGhpcy5fZW5kVGltZSA9IG51bGw7XG4gICAgICB0aGlzLl9sYXN0TGFwID0gbnVsbDtcbiAgICB9LFxuXG5cbiAgICBzdGFydDogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9zdGFydFRpbWUgPSB0aGlzLl9sYXN0TGFwID0gK25ldyBEYXRlKCk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG5cbiAgICBzdG9wOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX2VuZFRpbWUgPSArbmV3IERhdGUoKTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbiAgICBsYXA6IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKCF0aGlzLl9sYXN0TGFwKSByZXR1cm4gMDtcblxuICAgICAgdmFyIG9sZExhc3RMYXAgPSB0aGlzLl9sYXN0TGFwO1xuICAgICAgdGhpcy5fbGFzdExhcCA9ICtuZXcgRGF0ZSgpO1xuICAgICAgcmV0dXJuICh0aGlzLl9sYXN0TGFwIC0gb2xkTGFzdExhcCk7XG4gICAgfSxcblxuXG4gICAgZGVsdGE6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuICh0aGlzLl9lbmRUaW1lIC0gdGhpcy5fc3RhcnRUaW1lKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBUaW1lcjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGZhY3RvcnkgPSBmdW5jdGlvbihcbiAgX1xuKSB7XG5cbiAgLyoqXG4gICAqXG4gICAqIEhlbHBlciBmb3IgZGVhbGluZyB3aXRoIGhhc2gtc3R5bGUgZnVuY3Rpb24gYXJndW1lbnRzLCB3aGljaCBjYW4gYmUgdXNlZnVsXG4gICAqIGluIG1ldGhvZHMgd2l0aCBvcHRpb25hbC9kZWZhdWx0IHZhbHVlcy5cbiAgICpcbiAgICogVXNhZ2U6XG4gICAqXG4gICAqICAgdmFyIGZvbyA9IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICogICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICpcbiAgICogICAgICAgdmFyIG9uZSA9IG9wdHMuZ2V0T3JFcnJvcihcIm9uZVwiKSxcbiAgICogICAgICAgICAgIHR3byA9IG9wdHMuZ2V0T3JFbHNlKFwidHdvXCIsIDIpLFxuICAgKiAgICAgICAgICAgdGhyZWUgPSBvcHRzLmdldE9yRWxzZUZuKFwidGhyZWVcIiwgZnVuY3Rpb24oKSB7XG4gICAqICAgICAgICAgICAgIHJldHVybiAzO1xuICAgKiAgICAgICAgICAgfSk7XG4gICAqXG4gICAqICAgICBjb25zb2xlLmxvZyhvbmUsIHR3bywgdGhyZWUpO1xuICAgKiAgIH07XG4gICAqXG4gICAqICAgZm9vKHsgb25lOiAxIH0pOyAvLyBsb2dzIFwiMSwgMiwgM1wiXG4gICAqICAgZm9vKCk7IC8vIHRocm93cyBFcnJvclxuICAgKiAgIGZvbyh7b25lOiAxLCB0d286IGZhbHNlLCB0aHJlZTogNH0pOyAvLyBsb2dzIFwiMSwgZmFsc2UsIDRcIlxuICAgKlxuICAgKi9cbiAgdmFyIE9wdGlvbnMgPSBmdW5jdGlvbihvcHRzKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH1cblxuICBfLmV4dGVuZChPcHRpb25zLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIHRoaXMuX3Byb3ZpZGVkT3B0cyA9IG9wdHMgfHwge307XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEF0dGVtcHRzIHRvIHJldHVybiB0aGUgdmFsdWUgZm9yIHRoZSByZXF1ZXN0ZWQgYGtleWAuIElmIHRoZSB2YWx1ZVxuICAgICAqIGlzIHVuZGVmaW5lZCBvciBudWxsLCBpbnN0ZWFkIHJldHVybnMgdGhlIHByb3ZpZGVkIGBmYWxsYmFja1ZhbHVlYC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBrZXkgKHJlcXVpcmVkKSBhdHRyaWJ1dGUgdG8gYmUgcmVhZFxuICAgICAqIEBwYXJhbSBmYWxsYmFja1ZhbHVlICByZXR1cm5lZCBpZiBga2V5YCBhdHRyaWJ1dGUgaXMgbnVsbCBvciB1bmRlZmluZWRcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHJlcXVlc3RlZCB2YWx1ZSBmb3IgYGtleWAsIG9yIGZhbGxiYWNrVmFsdWVgXG4gICAgICovXG4gICAgZ2V0T3JFbHNlOiBmdW5jdGlvbihrZXksIGRlZmF1bHRWYWx1ZSkge1xuICAgICAgaWYgKHRoaXMuX2lzVW5kZWZPck51bGwoa2V5KSkge1xuICAgICAgICByZXR1cm4gZGVmYXVsdFZhbHVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Byb3ZpZGVkT3B0c1trZXldO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBBdHRlbXB0cyB0byByZXR1cm4gdGhlIHZhbHVlIGZvciB0aGUgcmVxdWVzdGVkIGBrZXlgLiBJZiB0aGUgdmFsdWVcbiAgICAgKiBpcyB1bmRlZmluZWQgb3IgbnVsbCwgdGhyb3dzIGFuIGVycm9yLlxuICAgICAqXG4gICAgICogQHBhcmFtIGtleSAocmVxdWlyZWQpIGF0dHJpYnV0ZSB0byBiZSByZWFkXG4gICAgICogQHBhcmFtIGVyciAgICAgICAgICAgIG1lc3NhZ2UgcHJvdmlkZWQgdG8gRXJyb3IgY29uc3RydWN0b3IgaWYgYGtleWBcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgaXMgbnVsbCBvciBub3QgZGVmaW5lZFxuICAgICAqXG4gICAgICogQHJldHVybnMgdGhlIHZhbHVlIGZvciB0aGUgcmVxdWVzdGVkIGtleVxuICAgICAqL1xuICAgIGdldE9yRXJyb3I6IGZ1bmN0aW9uKGtleSwgZXJyb3JNc2cpIHtcbiAgICAgIGlmICh0aGlzLl9pc1VuZGVmT3JOdWxsKGtleSkpIHtcbiAgICAgICAgZXJyb3JNc2cgPSBlcnJvck1zZyB8fCBcIk9wdGlvbiByZXF1ZXN0ZWQgYnV0IG5vdCBmb3VuZDogYFwiK2tleStcImBcIjtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yTXNnKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMuX3Byb3ZpZGVkT3B0c1trZXldO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBBdHRlbXB0cyB0byByZXR1cm4gdGhlIHZhbHVlIGZvciB0aGUgcmVxdWVzdGVkIGBrZXlgLiBJZiB0aGUgdmFsdWVcbiAgICAgKiBpcyB1bmRlZmluZWQgb3IgbnVsbCwgaW5zdGVhZCBldmFsdWF0ZXMgYGZhbGxiYWNrVmFsdWVGbmAgYW5kIHJldHVybnNcbiAgICAgKiBpdHMgdmFsdWUuXG4gICAgICpcbiAgICAgKiBUaGlzIGlzIHVzZWZ1bCBmb3Igc2ltdWxhdGluZyBub24tc3RyaWN0IGV2YWx1YXRpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ga2V5IChyZXF1aXJlZCkgIGF0dHJpYnV0ZSB0byBiZSByZWFkXG4gICAgICogQHBhcmFtIGZhbGxiYWNrVmFsdWVGbiBldmFsdWF0ZWQgYW5kIHJldHVybiB2YWx1ZSByZXR1cm5lZCBpZiBga2V5YFxuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlIGlzIG51bGwgb3IgdW5kZWZpbmVkXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyByZXF1ZXN0ZWQgdmFsdWUgZm9yIGBrZXlgIG9yIHRoZSByZXR1cm4gdmFsdWUgb2YgZXZhbHVhdGVkXG4gICAgICogICAgICAgICAgYGZhbGxiYWNrVmFsdWVGbmBcbiAgICAgKi9cbiAgICBnZXRPckVsc2VGbjogZnVuY3Rpb24oa2V5LCBkZWZhdWx0VmFsdWVGbikge1xuICAgICAgaWYgKHR5cGVvZiBkZWZhdWx0VmFsdWVGbiAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIk9wdGlvbnMjZ2V0T3JFbHNlRm4gcmVxdWlyZXMgYSBkZWZhdWx0VmFsdWVGblwiKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuX2lzVW5kZWZPck51bGwoa2V5KSkge1xuICAgICAgICByZXR1cm4gZGVmYXVsdFZhbHVlRm4oKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wcm92aWRlZE9wdHNba2V5XTtcbiAgICAgIH1cbiAgICB9LFxuXG5cbiAgICB0b09iamVjdDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gXy5jbG9uZSh0aGlzLl9wcm92aWRlZE9wdHMpO1xuICAgIH0sXG5cbiAgICBzY29wZTogZnVuY3Rpb24ocHJlZml4KSB7XG4gICAgICByZXR1cm4gT3B0aW9ucy5mcm9tT2JqZWN0V2l0aFByZWZpeCh0aGlzLnRvT2JqZWN0KCksIHByZWZpeCk7XG4gICAgfSxcblxuICAgIF9pc1VuZGVmT3JOdWxsOiBmdW5jdGlvbihrZXkpIHtcbiAgICAgIHJldHVybiB0eXBlb2YgdGhpcy5fcHJvdmlkZWRPcHRzW2tleV0gPT09IFwidW5kZWZpbmVkXCIgfHwgdGhpcy5fcHJvdmlkZWRPcHRzW2tleV0gPT09IG51bGw7XG4gICAgfVxuICB9KTtcblxuICBfLmV4dGVuZChPcHRpb25zLCB7XG4gICAgZnJvbU9iamVjdDogZnVuY3Rpb24ob3B0cykge1xuICAgICAgcmV0dXJuIG5ldyBPcHRpb25zKG9wdHMpO1xuICAgIH0sXG5cblxuICAgIGZyb21PYmplY3RXaXRoUHJlZml4OiBmdW5jdGlvbihvcHRzLCBwcmVmaXgpIHtcbiAgICAgIG9wdHMgPSBfLnJlZHVjZShvcHRzLCBmdW5jdGlvbihtZW1vLCB2YWwsIGtleSkge1xuICAgICAgICB2YXIgcmVzdCwgbmV3S2V5O1xuICAgICAgICBpZiAoa2V5LmluZGV4T2YocHJlZml4KSA9PT0gMCkge1xuICAgICAgICAgIHJlc3QgPSBrZXkuc3Vic3RyKHByZWZpeC5sZW5ndGgpO1xuICAgICAgICAgIGlmIChyZXN0Lmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIG5ld0tleSA9IHJlc3QuY2hhckF0KDApLnRvTG93ZXJDYXNlKCkgKyByZXN0LnN1YnN0cigxKTtcbiAgICAgICAgICAgIG1lbW9bbmV3S2V5XSA9IHZhbDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG1lbW87XG4gICAgICB9LCB7fSk7XG5cbiAgICAgIHJldHVybiBuZXcgT3B0aW9ucyhvcHRzKTtcbiAgICB9XG4gIH0pXG5cbiAgcmV0dXJuIE9wdGlvbnM7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblxudmFyIG1vZCA9IGZ1bmN0aW9uIChcbiAgX1xuICApIHtcblxuICB2YXIgQ291bnRkb3duTGF0Y2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgfSxcbiAgICAgIG5vb3AgPSBmdW5jdGlvbigpIHt9O1xuXG4gIF8uZXh0ZW5kKENvdW50ZG93bkxhdGNoLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uIChzdGVwcywgY29tcGxldGlvbkNhbGxiYWNrKSB7XG4gICAgICB0aGlzLl9zdGVwcyA9IHN0ZXBzIHx8IDA7XG4gICAgICB0aGlzLl9jb21wbGV0aW9uQ2FsbGJhY2sgPSBjb21wbGV0aW9uQ2FsbGJhY2sgfHwgbm9vcDtcbiAgICAgIF8uYmluZEFsbCh0aGlzLCBcIl9jb21wbGV0aW9uQ2FsbGJhY2tcIiwgXCJfdHJpZ2dlckNvbXBsZXRpb25cIik7XG4gICAgICBpZihpc05hTih0aGlzLl9zdGVwcykgfHwgdGhpcy5fc3RlcHMgPCAwKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNvdW50ZG93bkxhdGNoOiBOdW1iZXIgb2Ygc3RlcHMgYXJlIGludmFsaWQuXCIpO1xuICAgICAgfVxuICAgICAgdGhpcy5fY3VycmVudCA9IDA7XG4gICAgICB0aGlzLl9jb21wbGV0ZSA9IGZhbHNlO1xuICAgICAgdGhpcy5fZXJyb3IgPSBudWxsO1xuICAgICAgaWYodGhpcy5fc3RlcHMgPT09IDApIHtcbiAgICAgICAgXy5kZWZlcih0aGlzLl90cmlnZ2VyQ29tcGxldGlvbik7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9LFxuICAgIHN0ZXA6IGZ1bmN0aW9uIChzdGVwcykge1xuICAgICAgaWYgKHRoaXMuX2NvbXBsZXRlIHx8IHRoaXMuX3N0ZXBzID09PSAwKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRoaXMuX2N1cnJlbnQgKz0gc3RlcHMgfHwgMTtcbiAgICAgIGlmICh0aGlzLl9jdXJyZW50ID49IHRoaXMuX3N0ZXBzKSB7XG4gICAgICAgIHRoaXMuX3RyaWdnZXJDb21wbGV0aW9uKCk7XG4gICAgICB9XG4gICAgfSxcbiAgICBlcnJvcjogZnVuY3Rpb24gKGVycikge1xuICAgICAgaWYgKHRoaXMuX2NvbXBsZXRlIHx8IHRoaXMuX3N0ZXBzID09PSAwKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRoaXMuX2Vycm9yID0gZXJyO1xuICAgICAgdGhpcy5fdHJpZ2dlckNvbXBsZXRpb24oKTtcbiAgICB9LFxuICAgIF90cmlnZ2VyQ29tcGxldGlvbjogZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKHRoaXMuX2NvbXBsZXRlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRoaXMuX2NvbXBsZXRlID0gdHJ1ZTtcbiAgICAgIGlmICh0aGlzLl9lcnJvcikge1xuICAgICAgICBfLmRlZmVyKF8uYmluZCh0aGlzLl9jb21wbGV0aW9uQ2FsbGJhY2ssIG51bGwsIHRoaXMuX2Vycm9yKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfLmRlZmVyKHRoaXMuX2NvbXBsZXRpb25DYWxsYmFjayk7XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gQ291bnRkb3duTGF0Y2g7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgUHJvbWlzZVxuKSB7XG5cbiAgLyoqXG4gICAqIEEgU3RhdGVHdWFyZCBkb2VzIHdoYXQgaXRzIG5hbWUgaW1wbGllcy4gVmFsaWQgc3RhdGVzIGFyZSBwcm92aWRlZCBkdXJpbmcgaW5zdGFudGlhdGlvbiwgYW5kIGFyZSBhcHBsaWVkLCBlbnN1cmVkLFxuICAgKiBkZW5pZWQsIGV0YywgdGhyb3VnaCB0aGUgY291cnNlIG9mIHRoZSBvd25lcidzIGxpZmV0aW1lLlxuICAgKlxuICAgKiBGb3IgZXhhbXBsZSwgaWYgeW91J2QgbGlrZSB0byBlbnN1cmUgdGhhdCBGb28jYmFyIHJhaXNlcyBhbiBlcnJvciBhZnRlciBGb28jZGlzcG9zZSBpcyBjYWxsZWQsIHlvdSBtaWdodCBkbyB0aGVcbiAgICogZm9sbG93aW5nOlxuICAgKlxuICAgKiAgIHZhciBGb28gPSBmdW5jdGlvbigpIHtcbiAgICogICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgKiAgIH07XG4gICAqXG4gICAqICAgXy5leHRlbmQoRm9vLnByb3RvdHlwZSwge1xuICAgKiAgICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7XG4gICAqICAgICAgIHRoaXMuX2V4cGVuc2l2ZVJlc291cmNlID0gbmV3IEV4cGVuc2l2ZVJlc291cmNlKCk7XG4gICAqICAgICAgIHRoaXMuX3N0YXRlR3VhcmQgPSBuZXcgU3RhdGVHdWFyZChbXCJkaXNwb3NlZFwiXSk7XG4gICAqICAgICB9LFxuICAgKiAgICAgZGlzcG9zZTogZnVuY3Rpb24oKSB7XG4gICAqICAgICAgIC8vICNkaXNwb3NlIHNob3VsZCBiZSBpZGVtcG90ZW50LCBzbyBoZXJlIHdlIGp1c3QgY2hlY2sgdG8gc2VlIGlmIHdlJ3ZlIGFscmVhZHkgZGlzcG9zZWQsIGFuZCByZXR1cm4uXG4gICAqICAgICAgIC8vIE5vdGUgdGhhdCBpZiBkaXNwb3NlIHdlcmUgYXN5bmMsIHdlJ2QgbmVlZCB0byBhZGQgYSBcImRpc3Bvc2luZ1wiIHN0YXRlLlxuICAgKiAgICAgICBpZiAodGhpcy5fc3RhdGVHdWFyZC5hcHBsaWVkKFwiZGlzcG9zZWRcIikpIHtcbiAgICogICAgICAgICByZXR1cm47XG4gICAqICAgICAgIH1cbiAgICpcbiAgICogICAgICAgaWYgKHRoaXMuX2V4cGVuc2l2ZVJlc291cmNlKSB7XG4gICAqICAgICAgICAgdGhpcy5fZXhwZW5zaXZlUmVzb3VyY2UuZGlzcG9zZSgpO1xuICAgKiAgICAgICAgIHRoaXMuX2V4cGVuc2l2ZVJlc291cmNlID0gbnVsbDtcbiAgICogICAgICAgfVxuICAgKiAgICAgICB0aGlzLl9zdGF0ZUd1YXJkLmFwcGx5KFwiZGlzcG9zZWRcIik7XG4gICAqICAgICB9LFxuICAgKiAgICAgYmFyOiBmdW5jdGlvbigpIHtcbiAgICogICAgICAgdGhpcy5fc3RhdGVHdWFyZC5kZW55KFwiZGlzcG9zZWRcIik7IC8vIFRocm93cyBleGNlcHRpb24gaWYgI2Rpc3Bvc2Ugd2FzIGNhbGxlZFxuICAgKlxuICAgKiAgICAgICByZXR1cm4gdGhpcy5fZXhwZW5zaXZlUmVzb3VyY2Uuc29tZU1ldGhvZCgpO1xuICAgKiAgICAgfVxuICAgKiAgIH0pO1xuICAgKlxuICAgKiBJbiB0aGlzIGNhc2UsIHdoZXJlIHdlIGhhdmUgb25seSBvbmUgc3RhdGUsIGl0J3MgdXNlZnVsIHRvIHNpbXBseSBjcmVhdGUgYSBzY29wZWQgU3RhdGVHdWFyZCwgd2hpY2ggYmVoYXZlc1xuICAgKiBpZGVudGljYWxseSB0byBhIHJlZ3VsYXIgb25lLCBleGNlcHQgZXZlcnkgZW5mb3JjZW1lbnQvcXVlcnkgbWV0aG9kIGhhcyB0aGUgc2NvcGUgcHJvdmlkZWQgZHVyaW5nIGluc3RhbnRpYXRpb25cbiAgICogYXMgYSBmaXJzdCwgaW1wbGljaXQgYXJndW1lbnQ6XG4gICAqXG4gICAqICAgLy8gSWRlbnRpY2FsIHRvIHByZXZpb3VzIHZlcnNpb24uXG4gICAqXG4gICAqICAgdmFyIEZvbyA9IGZ1bmN0aW9uKCkge1xuICAgKiAgICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAqICAgfTtcbiAgICpcbiAgICogICBfLmV4dGVuZChGb28ucHJvdG90eXBlLCB7XG4gICAqICAgICBpbml0aWFsaXplOiBmdW5jdGlvbigpIHtcbiAgICogICAgICAgdGhpcy5fZXhwZW5zaXZlUmVzb3VyY2UgPSBuZXcgRXhwZW5zaXZlUmVzb3VyY2UoKTtcbiAgICogICAgICAgdGhpcy5fc3RhdGVHdWFyZCA9IFN0YXRlR3VhcmQuc2NvcGVkKFwiZGlzcG9zZWRcIik7XG4gICAqICAgICB9LFxuICAgKiAgICAgZGlzcG9zZTogZnVuY3Rpb24oKSB7XG4gICAqICAgICAgIC8vICNkaXNwb3NlIHNob3VsZCBiZSBpZGVtcG90ZW50LCBzbyBoZXJlIHdlIGp1c3QgY2hlY2sgdG8gc2VlIGlmIHdlJ3ZlIGFscmVhZHkgZGlzcG9zZWQsIGFuZCByZXR1cm4uXG4gICAqICAgICAgIC8vIE5vdGUgdGhhdCBpZiBkaXNwb3NlIHdlcmUgYXN5bmMsIHdlJ2QgbmVlZCB0byBhZGQgYSBcImRpc3Bvc2luZ1wiIHN0YXRlLlxuICAgKiAgICAgICBpZiAodGhpcy5fc3RhdGVHdWFyZC5hcHBsaWVkKCkpIHtcbiAgICogICAgICAgICByZXR1cm47XG4gICAqICAgICAgIH1cbiAgICpcbiAgICogICAgICAgaWYgKHRoaXMuX2V4cGVuc2l2ZVJlc291cmNlKSB7XG4gICAqICAgICAgICAgdGhpcy5fZXhwZW5zaXZlUmVzb3VyY2UuZGlzcG9zZSgpO1xuICAgKiAgICAgICAgIHRoaXMuX2V4cGVuc2l2ZVJlc291cmNlID0gbnVsbDtcbiAgICogICAgICAgfVxuICAgKiAgICAgICB0aGlzLl9zdGF0ZUd1YXJkLmFwcGx5KCk7XG4gICAqICAgICB9LFxuICAgKiAgICAgYmFyOiBmdW5jdGlvbigpIHtcbiAgICogICAgICAgdGhpcy5fc3RhdGVHdWFyZC5kZW55KCk7IC8vIFRocm93cyBleGNlcHRpb24gaWYgI2Rpc3Bvc2Ugd2FzIGNhbGxlZFxuICAgKlxuICAgKiAgICAgICByZXR1cm4gdGhpcy5fZXhwZW5zaXZlUmVzb3VyY2Uuc29tZU1ldGhvZCgpO1xuICAgKiAgICAgfVxuICAgKiAgIH0pO1xuICAgKlxuICAgKi9cbiAgdmFyIFN0YXRlR3VhcmQgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChTdGF0ZUd1YXJkLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKHN0YXRlcykge1xuICAgICAgdGhpcy5fdmFsaWRTdGF0ZXMgPSBfLnJlZHVjZShzdGF0ZXMsIGZ1bmN0aW9uKG1lbW8sIHN0YXRlKSB7XG4gICAgICAgIG1lbW9bc3RhdGVdID0gdHJ1ZTtcbiAgICAgICAgcmV0dXJuIG1lbW87XG4gICAgICB9LCB7fSk7XG5cbiAgICAgIHRoaXMuX2FwcGxpZWRTdGF0ZXMgPSB7fTtcbiAgICB9LFxuXG4gICAgc2NvcGU6IGZ1bmN0aW9uKHN0YXRlKSB7XG4gICAgICB2YXIgc2tpcCA9IFtcInNjb3BlXCIsIFwiaW5pdGlhbGl6ZVwiXSxcbiAgICAgICAgICBzZWxmID0gdGhpcyxcbiAgICAgICAgICBzY29wZWQgPSB7fTtcblxuICAgICAgXy5lYWNoKFN0YXRlR3VhcmQucHJvdG90eXBlLCBmdW5jdGlvbihmdW4sIG1ldGhvZE5hbWUpIHtcbiAgICAgICAgaWYgKF8uY29udGFpbnMoc2tpcCwgbWV0aG9kTmFtZSkpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBzY29wZWRbbWV0aG9kTmFtZV0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgYXJncyA9IF8udG9BcnJheShhcmd1bWVudHMpO1xuICAgICAgICAgIGFyZ3MudW5zaGlmdChzdGF0ZSk7XG4gICAgICAgICAgcmV0dXJuIGZ1bi5hcHBseShzZWxmLCBhcmdzKTtcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gc2NvcGVkO1xuICAgIH0sXG5cbiAgICBhcHBseTogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgc3RhdGVzID0gYXJ5T3JWYXJpYWRpY1RvQXJyYXkoYXJndW1lbnRzKTtcbiAgICAgIGNoZWNrVmFsaWRTdGF0ZXNPclRocm93KHRoaXMuX3ZhbGlkU3RhdGVzLCBzdGF0ZXMpO1xuXG4gICAgICBfLmVhY2goc3RhdGVzLCBmdW5jdGlvbihzdGF0ZSkge1xuICAgICAgICB0aGlzLl9hcHBsaWVkU3RhdGVzW3N0YXRlXSA9IHRydWU7XG4gICAgICB9LCB0aGlzKTtcblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcblxuICAgIGFwcGx5QXN5bmM6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuYXBwbHkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9KSxcblxuICAgIGFwcGx5QXN5bmNGbjogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgIHJldHVybiBfLmJpbmQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5QXN5bmMuYXBwbHkodGhpcywgYXJncyk7XG4gICAgICB9LCB0aGlzKTtcbiAgICB9LFxuXG4gICAgdW5hcHBseTogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgc3RhdGVzID0gYXJ5T3JWYXJpYWRpY1RvQXJyYXkoYXJndW1lbnRzKTtcbiAgICAgIGNoZWNrVmFsaWRTdGF0ZXNPclRocm93KHRoaXMuX3ZhbGlkU3RhdGVzLCBzdGF0ZXMpO1xuXG4gICAgICBfLmVhY2goc3RhdGVzLCBmdW5jdGlvbihzdGF0ZSkge1xuICAgICAgICBpZiAodGhpcy5fYXBwbGllZFN0YXRlc1tzdGF0ZV0pIHtcbiAgICAgICAgICBkZWxldGUgdGhpcy5fYXBwbGllZFN0YXRlc1tzdGF0ZV07XG4gICAgICAgIH1cbiAgICAgIH0sIHRoaXMpO1xuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gICAgdW5hcHBseUFzeW5jOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLnVuYXBwbHkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9KSxcblxuICAgIHVuYXBwbHlBc3luY0ZuOiBmdW5jdGlvbihzdGF0ZXMpIHtcbiAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzO1xuICAgICAgcmV0dXJuIF8uYmluZChmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudW5hcHBseUFzeW5jLmFwcGx5KHRoaXMsIGFyZ3MpXG4gICAgICB9LCB0aGlzKTtcbiAgICB9LFxuXG4gICAgZGVueTogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgc3RhdGVzID0gYXJ5T3JWYXJpYWRpY1RvQXJyYXkoYXJndW1lbnRzKTtcbiAgICAgIGNoZWNrVmFsaWRTdGF0ZXNPclRocm93KHRoaXMuX3ZhbGlkU3RhdGVzLCBzdGF0ZXMpO1xuXG4gICAgICB2YXIgYXBwbGllZCA9IF8uZmlsdGVyKHN0YXRlcywgZnVuY3Rpb24oc3RhdGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FwcGxpZWRTdGF0ZXNbc3RhdGVdO1xuICAgICAgfSwgdGhpcyk7XG5cbiAgICAgIGlmIChhcHBsaWVkLmxlbmd0aCA+IDApIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiU3RhdGUgZGVuaWFsIHJlcXVlc3RlZCwgYnV0IGFwcGxpZWQ6IFwiICsgcHJldHR5KGFwcGxpZWQpKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcblxuICAgIGRlbnlBc3luYzogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5kZW55LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfSksXG5cbiAgICBkZW55QXN5bmNGbjogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgIHJldHVybiBfLmJpbmQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRlbnlBc3luYy5hcHBseSh0aGlzLCBhcmdzKVxuICAgICAgfSwgdGhpcyk7XG4gICAgfSxcblxuICAgIGVuc3VyZTogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgc3RhdGVzID0gYXJ5T3JWYXJpYWRpY1RvQXJyYXkoYXJndW1lbnRzKTtcbiAgICAgIGNoZWNrVmFsaWRTdGF0ZXNPclRocm93KHRoaXMuX3ZhbGlkU3RhdGVzLCBzdGF0ZXMpO1xuICAgICAgdmFyIG1pc3NpbmcgPSBfLnJlamVjdChzdGF0ZXMsIGZ1bmN0aW9uKHN0YXRlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hcHBsaWVkU3RhdGVzW3N0YXRlXTtcbiAgICAgIH0sIHRoaXMpO1xuXG4gICAgICBpZiAobWlzc2luZy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlN0YXRlIGVuc3VyYW5jZSByZXF1ZXN0ZWQsIGJ1dCBub3QgYXBwbGllZDogXCIgKyBwcmV0dHkobWlzc2luZykpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcblxuICAgIGVuc3VyZUFzeW5jOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLmVuc3VyZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH0pLFxuXG4gICAgZW5zdXJlQXN5bmNGbjogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgIHJldHVybiBfLmJpbmQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVuc3VyZUFzeW5jLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgICAgfSwgdGhpcyk7XG4gICAgfSxcblxuICAgIGFwcGxpZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHN0YXRlcyA9IGFyeU9yVmFyaWFkaWNUb0FycmF5KGFyZ3VtZW50cyk7XG4gICAgICBjaGVja1ZhbGlkU3RhdGVzT3JUaHJvdyh0aGlzLl92YWxpZFN0YXRlcywgc3RhdGVzKTtcblxuICAgICAgcmV0dXJuIF8uZXZlcnkoc3RhdGVzLCBmdW5jdGlvbihzdGF0ZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYXBwbGllZFN0YXRlc1tzdGF0ZV07XG4gICAgICB9LCB0aGlzKTtcbiAgICB9LFxuXG4gICAgYXBwbGllZEFzeW5jOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLmFwcGxpZWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9KSxcblxuICAgIGFwcGxpZWRBc3luY0ZuOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzO1xuICAgICAgcmV0dXJuIF8uYmluZChmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbGllZEFzeW5jLmFwcGx5KHRoaXMsIGFyZ3MpXG4gICAgICB9LCB0aGlzKTtcbiAgICB9XG4gIH0pO1xuXG4gIHZhciBhcnlPclZhcmlhZGljVG9BcnJheSA9IGZ1bmN0aW9uKGFyZ3MpIHtcbiAgICByZXR1cm4gXy5jaGFpbihhcmdzKS50b0FycmF5KCkuZmxhdHRlbigpLnZhbHVlKCk7XG4gIH07XG5cbiAgdmFyIGNoZWNrVmFsaWRTdGF0ZXNPclRocm93ID0gZnVuY3Rpb24odmFsaWRTdGF0ZXNNYXAsIHN0YXRlcykge1xuICAgIHZhciBpbnZhbGlkU3RhdGVzID0gXy5yZWplY3Qoc3RhdGVzLCBmdW5jdGlvbihzdGF0ZSkge1xuICAgICAgcmV0dXJuICEhdmFsaWRTdGF0ZXNNYXBbc3RhdGVdO1xuICAgIH0pO1xuXG4gICAgaWYgKGludmFsaWRTdGF0ZXMubGVuZ3RoID4gMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBzdGF0ZXMgcHJvdmlkZWQ6IFwiICsgcHJldHR5KGludmFsaWRTdGF0ZXMpKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIHByZXR0eSA9IGZ1bmN0aW9uKHN0YXRlcykge1xuICAgIHJldHVybiBcIltcIitzdGF0ZXMuam9pbihcIixcIikrXCJdXCI7XG4gIH07XG5cbiAgXy5leHRlbmQoU3RhdGVHdWFyZCwge1xuICAgIHNjb3BlZDogZnVuY3Rpb24oc2NvcGUpIHtcbiAgICAgIHJldHVybiAobmV3IFN0YXRlR3VhcmQoW3Njb3BlXSkpLnNjb3BlKHNjb3BlKTtcbiAgICB9XG4gIH0pXG5cbiAgcmV0dXJuIFN0YXRlR3VhcmQ7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJibHVlYmlyZFwiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGZhY3RvcnkgPSBmdW5jdGlvbihcbiAgXyxcbiAgUHJvbWlzZSxcbiAgT3B0aW9uc1xuKSB7XG5cbiAgdmFyIExhbmcgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChMYW5nLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKCl7fVxuICB9KTtcblxuICBfLmV4dGVuZChMYW5nLCB7XG4gICAgbm9vcDogZnVuY3Rpb24oKSB7fSxcblxuICAgIHBhcnRpYWxseUFwcGx5OiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBhcmdzID0gXy50b0FycmF5KGFyZ3VtZW50cyksXG4gICAgICAgICAgZnVuICA9IGFyZ3Muc2hpZnQoKTtcblxuICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gZnVuLmFwcGx5KG51bGwsIGFyZ3MuY29uY2F0KGFyZ3VtZW50cykpO1xuICAgICAgfTtcbiAgICB9LFxuXG4gICAgbWFrZUVycm9yQ2xhc3M6IGZ1bmN0aW9uKG5hbWUsIGRlZmF1bHRNZXNzYWdlKSB7XG4gICAgICBpZiAoIW5hbWUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwibWFrZUVycm9yQ2xhc3MgcmVxdWlyZXMgYG5hbWVgXCIpO1xuICAgICAgfVxuXG4gICAgICB2YXIga2xhc3MgPSBmdW5jdGlvbihtZXNzYWdlKSB7XG4gICAgICAgIHRoaXMubmFtZSAgICA9IG5hbWU7XG4gICAgICAgIHRoaXMubWVzc2FnZSA9IHRoaXMubmFtZSArIFwiOiBcIiArIChtZXNzYWdlIHx8IGRlZmF1bHRNZXNzYWdlIHx8IFwiQW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnJlZFwiKTtcblxuICAgICAgICBpZiAoRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UpIHtcbiAgICAgICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCBrbGFzcyk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIGtsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlKTtcbiAgICAgIGtsYXNzLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IGtsYXNzO1xuICAgICAgcmV0dXJuIGtsYXNzO1xuICAgIH0sXG5cbiAgICBwb2pvQ2xhc3M6IGZ1bmN0aW9uKGF0dHJpYnV0ZXMsIG9wdGlvbnMpIHtcbiAgICAgIGlmICghXy5pc0FycmF5KGF0dHJpYnV0ZXMpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkxhbmcjcG9qb0NsYXNzIHJlcXVpcmVzIGF0dHJpYnV0ZXMgYXJyYXlcIik7XG4gICAgICB9XG5cbiAgICAgIHZhciBvcHRpb25zID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdGlvbnMpLFxuICAgICAgICAgIC8vIG9wdGlvbmFsIHNwZWNpZmllcyBrZXlzIHRoYXQgYXJlIG9wdGlvbmFsLCB3aXRoIHZhbHVlcyB0aGF0IGFyZSBkZWZhdWx0IGlmIG5vdCBwcm92aWRlZFxuICAgICAgICAgIGRlZmF1bHRzID0gb3B0aW9ucy5nZXRPckVsc2UoXCJkZWZhdWx0c1wiLCB7fSksXG4gICAgICAgICAgb3B0aW9uYWxBdHRyaWJ1dGVzID0gXy5rZXlzKGRlZmF1bHRzKTtcblxuICAgICAgdmFyIHRvQXR0cmlidXRlTmFtZSA9IGZ1bmN0aW9uKGF0dHIpIHtcbiAgICAgICAgICAgIHJldHVybiBcIl9cIiArIGF0dHI7XG4gICAgICAgICAgfSxcbiAgICAgICAgICB0b0dldHRlciA9IGZ1bmN0aW9uKGF0dHIpIHtcbiAgICAgICAgICAgIHJldHVybiBhdHRyO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgdG9TZXR0ZXIgPSBmdW5jdGlvbihhdHRyKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJzZXRcIiArIGF0dHIuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBhdHRyLnN1YnN0cigxKTtcbiAgICAgICAgICB9O1xuXG4gICAgICB2YXIga2xhc3MgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB9O1xuXG4gICAgICBfLmV4dGVuZChrbGFzcy5wcm90b3R5cGUsIHtcbiAgICAgICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICAgICAgXy5lYWNoKGF0dHJpYnV0ZXMsIGZ1bmN0aW9uKGF0dHIpIHtcbiAgICAgICAgICAgIGlmIChfLmNvbnRhaW5zKG9wdGlvbmFsQXR0cmlidXRlcywgYXR0cikpIHtcbiAgICAgICAgICAgICAgdGhpc1t0b0F0dHJpYnV0ZU5hbWUoYXR0cildID0gb3B0cy5nZXRPckVsc2UoYXR0ciwgZGVmYXVsdHNbYXR0cl0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhpc1t0b0F0dHJpYnV0ZU5hbWUoYXR0cildID0gb3B0cy5nZXRPckVycm9yKGF0dHIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sIHRoaXMpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgXy5lYWNoKGF0dHJpYnV0ZXMsIGZ1bmN0aW9uKGF0dHIpIHtcbiAgICAgICAga2xhc3MucHJvdG90eXBlW3RvR2V0dGVyKGF0dHIpXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzW3RvQXR0cmlidXRlTmFtZShhdHRyKV07XG4gICAgICAgIH07XG4gICAgICAgIGtsYXNzLnByb3RvdHlwZVt0b1NldHRlcihhdHRyKV0gPSBmdW5jdGlvbih2KSB7XG4gICAgICAgICAgdGhpc1t0b0F0dHJpYnV0ZU5hbWUoYXR0cildID0gdjtcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4ga2xhc3M7XG4gICAgfSxcblxuICAgIGRlZmVycmVkOiBmdW5jdGlvbihwcm9taXNlQ2xhc3MpIHtcbiAgICAgIHByb21pc2VDbGFzcyA9IHByb21pc2VDbGFzcyB8fCBQcm9taXNlO1xuICAgICAgdmFyIHJlcyA9IG51bGwsIHJlaiA9IG51bGw7XG4gICAgICB2YXIgcCA9IG5ldyBwcm9taXNlQ2xhc3MoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlcyA9IGFyZ3VtZW50c1swXTtcbiAgICAgICAgcmVqID0gYXJndW1lbnRzWzFdO1xuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHByb21pc2U6IHAsXG4gICAgICAgIHJlc29sdmU6IHJlcyxcbiAgICAgICAgcmVqZWN0OiByZWpcbiAgICAgIH07XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gTGFuZztcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJibHVlYmlyZFwiKSxcbiAgcmVxdWlyZShcIi4vb3B0aW9uc1wiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfXG4pIHtcblxuICB2YXIgUHViU3ViID0ge1xuICAgIG9uOiBmdW5jdGlvbihldmVudE5hbWUsIGhhbmRsZXIsIGNvbnRleHQpIHtcbiAgICAgIHZhciBidWNrZXQgPSB0aGlzLl9fcHViU3ViQnVja2V0KGV2ZW50TmFtZSk7XG4gICAgICBidWNrZXQuc3Vic2NyaWJlKGhhbmRsZXIsIGNvbnRleHQpO1xuICAgIH0sXG4gICAgb2ZmOiBmdW5jdGlvbihldmVudE5hbWUsIGhhbmRsZXIsIGNvbnRleHQpIHtcbiAgICAgIHZhciBidWNrZXQgPSB0aGlzLl9fcHViU3ViQnVja2V0KGV2ZW50TmFtZSk7XG4gICAgICBidWNrZXQudW5zdWJzY3JpYmUoaGFuZGxlciwgY29udGV4dCk7XG4gICAgfSxcbiAgICBub3RpZnk6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGFyZ3MgICAgICA9IF8udG9BcnJheShhcmd1bWVudHMpLFxuICAgICAgICAgIGV2ZW50TmFtZSA9IGFyZ3Muc2hpZnQoKTtcblxuICAgICAgdmFyIGJ1Y2tldCA9IHRoaXMuX19wdWJTdWJCdWNrZXQoZXZlbnROYW1lKTtcbiAgICAgIGJ1Y2tldC5ub3RpZnkoYXJncyk7XG4gICAgfSxcbiAgICBfX3B1YlN1YkJ1Y2tldDogZnVuY3Rpb24oZXZlbnROYW1lKSB7XG4gICAgICB0aGlzLl9fcHViU3ViRXZlbnRzID0gdGhpcy5fX3B1YlN1YkV2ZW50cyB8fCB7fTtcbiAgICAgIHRoaXMuX19wdWJTdWJFdmVudHNbZXZlbnROYW1lXSA9IHRoaXMuX19wdWJTdWJFdmVudHNbZXZlbnROYW1lXSB8fCBuZXcgRXZlbnRCdWNrZXQoZXZlbnROYW1lKTtcbiAgICAgIHJldHVybiB0aGlzLl9fcHViU3ViRXZlbnRzW2V2ZW50TmFtZV07XG4gICAgfVxuICB9O1xuXG4gIHZhciBFdmVudEJ1Y2tldCA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKEV2ZW50QnVja2V0LnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKGV2ZW50TmFtZSkge1xuICAgICAgdGhpcy5fZXZlbnROYW1lID0gZXZlbnROYW1lO1xuICAgICAgdGhpcy5fc3Vic2NyaXB0aW9ucyA9IFtdO1xuICAgIH0sXG4gICAgc3Vic2NyaWJlOiBmdW5jdGlvbihoYW5kbGVyLCBjb250ZXh0KSB7XG4gICAgICBpZiAoaGFuZGxlcikge1xuICAgICAgICB0aGlzLl9zdWJzY3JpcHRpb25zLnB1c2gobmV3IFN1YnNjcmlwdGlvbihoYW5kbGVyLCBjb250ZXh0KSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJTdWJzY3JpcHRpb24gcmVxdWlyZXMgaGFuZGxlcjogXCIgKyB0aGlzLl9ldmVudE5hbWUpO1xuICAgICAgfVxuICAgIH0sXG4gICAgdW5zdWJzY3JpYmU6IGZ1bmN0aW9uKGhhbmRsZXIsIGNvbnRleHQpIHtcbiAgICAgIHZhciBzdWJzO1xuICAgICAgaWYgKGhhbmRsZXIpIHtcbiAgICAgICAgc3VicyA9IF8uZmlsdGVyKHRoaXMuX3N1YnNjcmlwdGlvbnMsIGZ1bmN0aW9uKHN1Yikge1xuICAgICAgICAgIHJldHVybiBzdWIubWF0Y2hlcyhoYW5kbGVyLCBjb250ZXh0KTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzdWJzID0gdGhpcy5fc3Vic2NyaXB0aW9ucztcbiAgICAgIH1cblxuICAgICAgXy5lYWNoKHN1YnMsIGZ1bmN0aW9uKHN1Yikge1xuICAgICAgICBzdWIuZGlzcG9zZSgpO1xuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuX3N1YnNjcmlwdGlvbnMgPSBfLmRpZmZlcmVuY2UodGhpcy5fc3Vic2NyaXB0aW9ucywgc3Vicyk7XG4gICAgfSxcbiAgICBub3RpZnk6IGZ1bmN0aW9uKGFyZ3MpIHtcbiAgICAgIF8uaW52b2tlKHRoaXMuX3N1YnNjcmlwdGlvbnMsIFwibm90aWZ5XCIsIGFyZ3MpO1xuICAgIH1cbiAgfSk7XG5cbiAgdmFyIFN1YnNjcmlwdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKFN1YnNjcmlwdGlvbi5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihoYW5kbGVyLCBjb250ZXh0KSB7XG4gICAgICB0aGlzLl9oYW5kbGVyID0gaGFuZGxlcjtcbiAgICAgIHRoaXMuX2NvbnRleHQgPSBjb250ZXh0O1xuICAgIH0sXG4gICAgbWF0Y2hlczogZnVuY3Rpb24oaGFuZGxlciwgY29udGV4dCkge1xuICAgICAgaWYgKHRoaXMuX2NvbnRleHQpIHtcbiAgICAgICAgLy8gQ29tcGFyZSBjb250ZXh0IHJlZnMgYXMgcmVmcyBpZmYgd2UgaGF2ZSBhIGNvbnRleHQgb2JqZWN0XG4gICAgICAgIHJldHVybiAoaGFuZGxlciA9PT0gdGhpcy5faGFuZGxlciAmJiBjb250ZXh0ID09PSB0aGlzLl9jb250ZXh0KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIE90aGVyd2lzZSwganVzdCBtYWtlIHN1cmUgd2UgZG9uJ3QgaGF2ZSBhIGNvbnRleHQgKG51bGwgb3IgdW5kZWZpbmVkIGFyZSBmaW5lKVxuICAgICAgICByZXR1cm4gKGhhbmRsZXIgPT09IHRoaXMuX2hhbmRsZXIgJiYgIWNvbnRleHQpO1xuICAgICAgfVxuICAgIH0sXG4gICAgbm90aWZ5OiBmdW5jdGlvbihhcmdzKSB7XG4gICAgICAvLyBXZSBzaG91bGRuJ3QgYmUgY2FsbGVkIGFmdGVyIGRpc3Bvc2UsIGJ1dFxuICAgICAgLy8ganVzdCBpbiBjYXNlLi4uXG4gICAgICBpZiAodGhpcy5faGFuZGxlcikge1xuICAgICAgICB0aGlzLl9oYW5kbGVyLmFwcGx5KHRoaXMuX2NvbnRleHQsIGFyZ3MpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJXVEZcIik7XG4gICAgICB9XG4gICAgfSxcbiAgICBkaXNwb3NlOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX2hhbmRsZXIgPSBudWxsO1xuICAgICAgdGhpcy5fY29udGV4dCA9IG51bGw7XG4gICAgfVxuICB9KVxuXG4gIHJldHVybiBQdWJTdWI7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgT3B0aW9uc1xuKSB7XG5cbiAgdmFyIERvdWJseUxpbmtlZExpc3QgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChEb3VibHlMaW5rZWRMaXN0LnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fZnJvbnQgPSBudWxsO1xuICAgICAgdGhpcy5fYmFjayA9IG51bGw7XG4gICAgICB0aGlzLl9zaXplID0gMDtcbiAgICB9LFxuXG4gICAgZ2V0OiBmdW5jdGlvbihpZHgpIHtcbiAgICAgIHRoaXMuX2NoZWNrRWxlbWVudElkeE9yVGhyb3coaWR4KTtcbiAgICAgIHZhciBub2RlID0gdGhpcy5fd2Fsa1RvSWR4KGlkeCk7XG4gICAgICByZXR1cm4gbm9kZS52YWx1ZSgpO1xuICAgIH0sXG5cbiAgICBleGlzdHM6IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICB2YXIgbm9kZSA9IHRoaXMuX3dhbGtUb1ZhbHVlKHZhbHVlKTtcbiAgICAgIHJldHVybiAhIW5vZGU7XG4gICAgfSxcblxuICAgIHNpemU6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3NpemU7XG4gICAgfSxcblxuICAgIGFkZDogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHJldHVybiB0aGlzLmFkZEJhY2suYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9LFxuXG4gICAgYWRkRnJvbnQ6IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICB0aGlzLl9saW5rRnJvbnQodmFsdWUpO1xuICAgIH0sXG5cbiAgICBhZGRCYWNrOiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgdGhpcy5fbGlua0JhY2sodmFsdWUpO1xuICAgIH0sXG5cbiAgICByZW1vdmU6IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICB2YXIgbm9kZSA9IHRoaXMuX3dhbGtUb1ZhbHVlKHZhbHVlKTtcbiAgICAgIHJldHVybiB0aGlzLl91bmxpbmsobm9kZSk7XG4gICAgfSxcblxuICAgIHJlbW92ZUZyb250OiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICh0aGlzLl9mcm9udCA9PT0gbnVsbCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyBzdWNoIGVsZW1lbnRcIik7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcy5fdW5saW5rRnJvbnQodGhpcy5fZnJvbnQpO1xuICAgIH0sXG5cbiAgICByZW1vdmVCYWNrOiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICh0aGlzLl9iYWNrID09PSBudWxsKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vIHN1Y2ggZWxlbWVudFwiKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLl91bmxpbmtCYWNrKHRoaXMuX2JhY2spO1xuICAgIH0sXG5cbiAgICBpbnNlcnRBdEluZGV4OiBmdW5jdGlvbihpZHgsIHZhbHVlKSB7XG4gICAgICB0aGlzLl9jaGVja0lzRWxlbWVudFBvc2l0aW9uT3JUaHJvdyhpZHgpO1xuXG4gICAgICBpZiAoaWR4ID09PSB0aGlzLl9zaXplKSB7XG4gICAgICAgIHRoaXMuYWRkQmFjayh2YWx1ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgbm9kZSA9IHRoaXMuX3dhbGtUb0lkeChpZHgpO1xuICAgICAgICB0aGlzLl9saW5rQmVmb3JlKHZhbHVlLCBub2RlKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgcmVtb3ZlQXRJbmRleDogZnVuY3Rpb24oaWR4KSB7XG4gICAgICB0aGlzLl9jaGVja0VsZW1lbnRJZHhPclRocm93KGlkeCk7XG4gICAgICBpZiAoaWR4ID09PSAwKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl91bmxpbmtGcm9udCh0aGlzLl9mcm9udCk7XG4gICAgICB9IGVsc2UgaWYgKCBpZHggPT09ICh0aGlzLl9zaXplIC0gMSkgKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl91bmxpbmtCYWNrKHRoaXMuX2JhY2spO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIG5vZGUgPSB0aGlzLl93YWxrVG9JZHgoaWR4KTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3VubGluayhub2RlKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgY2xlYXI6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIG5vZGUgPSB0aGlzLl9mcm9udCxcbiAgICAgICAgICBuZXh0O1xuXG4gICAgICB3aGlsZSAobm9kZSAhPT0gbnVsbCkge1xuICAgICAgICBuZXh0ID0gbm9kZS5uZXh0KCk7XG4gICAgICAgIG5vZGUuZGlzcG9zZSgpO1xuICAgICAgICBub2RlID0gbmV4dDtcbiAgICAgIH1cbiAgICAgIHRoaXMuX2Zyb250ID0gbnVsbDtcbiAgICAgIHRoaXMuX2JhY2sgID0gbnVsbDtcbiAgICAgIHRoaXMuX3NpemUgPSAwO1xuICAgIH0sXG5cbiAgICBfbGlua0Zyb250OiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgdmFyIG9sZEZyb250ID0gdGhpcy5fZnJvbnQsXG4gICAgICAgICAgbmV3Tm9kZSA9IG5ldyBOb2RlKHt2YWx1ZTogdmFsdWV9KTtcbiAgICAgIHRoaXMuX2Zyb250ID0gbmV3Tm9kZTtcblxuICAgICAgaWYgKG9sZEZyb250ID09PSBudWxsKSB7XG4gICAgICAgIHRoaXMuX2JhY2sgPSBuZXdOb2RlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgb2xkRnJvbnQuc2V0UHJldihuZXdOb2RlKTtcbiAgICAgICAgbmV3Tm9kZS5zZXROZXh0KG9sZEZyb250KTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5fc2l6ZSsrO1xuICAgICAgcmV0dXJuIG5ld05vZGU7XG4gICAgfSxcblxuICAgIF9saW5rQmFjazogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHZhciBvbGRCYWNrID0gdGhpcy5fYmFjayxcbiAgICAgICAgICBuZXdOb2RlID0gbmV3IE5vZGUoe3ZhbHVlOiB2YWx1ZX0pO1xuXG4gICAgICB0aGlzLl9iYWNrID0gbmV3Tm9kZTtcbiAgICAgIGlmIChvbGRCYWNrID09PSBudWxsKSB7XG4gICAgICAgIHRoaXMuX2Zyb250ID0gbmV3Tm9kZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG9sZEJhY2suc2V0TmV4dChuZXdOb2RlKTtcbiAgICAgICAgbmV3Tm9kZS5zZXRQcmV2KG9sZEJhY2spO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9zaXplKys7XG4gICAgICByZXR1cm4gbmV3Tm9kZTtcbiAgICB9LFxuXG4gICAgX2xpbmtCZWZvcmU6IGZ1bmN0aW9uKHZhbHVlLCBub2RlKSB7XG4gICAgICB2YXIgcHJlZCAgICA9IG5vZGUucHJldigpLFxuICAgICAgICAgIG5ld05vZGUgPSBuZXcgTm9kZSh7dmFsdWU6IHZhbHVlLCBwcmV2OiBwcmVkLCBuZXh0OiBub2RlfSk7XG5cbiAgICAgIG5vZGUuc2V0UHJldihuZXdOb2RlKTtcbiAgICAgIGlmIChwcmVkID09PSBudWxsKSB7XG4gICAgICAgIHRoaXMuX2Zyb250ID0gbmV3Tm9kZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHByZWQuc2V0TmV4dChuZXdOb2RlKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuX3NpemUrKztcbiAgICAgIHJldHVybiBuZXdOb2RlO1xuICAgIH0sXG5cbiAgICBfdW5saW5rRnJvbnQ6IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgIHZhciB2YWx1ZSAgICA9IG5vZGUudmFsdWUoKSxcbiAgICAgICAgICBuZXdGcm9udCA9IG5vZGUubmV4dCgpO1xuXG4gICAgICBub2RlLmRpc3Bvc2UoKTtcbiAgICAgIHRoaXMuX2Zyb250ID0gbmV3RnJvbnQ7XG4gICAgICBpZiAobmV3RnJvbnQgPT09IG51bGwpIHtcbiAgICAgICAgdGhpcy5fYmFjayA9IG51bGw7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBuZXdGcm9udC5zZXRQcmV2KG51bGwpO1xuICAgICAgfVxuICAgICAgdGhpcy5fc2l6ZS0tO1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG5cbiAgICBfdW5saW5rQmFjazogZnVuY3Rpb24obm9kZSkge1xuICAgICAgdmFyIHZhbHVlICAgPSBub2RlLnZhbHVlKCksXG4gICAgICAgICAgbmV3QmFjayA9IG5vZGUucHJldigpO1xuXG4gICAgICBub2RlLmRpc3Bvc2UoKTtcbiAgICAgIHRoaXMuX2JhY2sgPSBuZXdCYWNrO1xuICAgICAgaWYgKG5ld0JhY2sgPT0gbnVsbCkge1xuICAgICAgICB0aGlzLl9mcm9udCA9IG51bGw7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBuZXdCYWNrLnNldE5leHQobnVsbCk7XG4gICAgICB9XG4gICAgICB0aGlzLl9zaXplLS07XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcblxuICAgIF91bmxpbms6IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgIHZhciBwcmV2ICA9IG5vZGUucHJldigpLFxuICAgICAgICAgIG5leHQgID0gbm9kZS5uZXh0KCksXG4gICAgICAgICAgdmFsdWUgPSBub2RlLnZhbHVlKCk7XG5cbiAgICAgIGlmIChwcmV2ID09PSBudWxsKSB7XG4gICAgICAgIHRoaXMuX2Zyb250ID0gbmV4dDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHByZXYuc2V0TmV4dChuZXh0KTtcbiAgICAgIH1cblxuICAgICAgaWYgKG5leHQgPT09IG51bGwpIHtcbiAgICAgICAgdGhpcy5fYmFjayA9IHByZXY7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBuZXh0LnNldFByZXYocHJldik7XG4gICAgICB9XG5cbiAgICAgIG5vZGUuZGlzcG9zZSgpO1xuICAgICAgdGhpcy5fc2l6ZS0tO1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG5cbiAgICBfd2Fsa1RvSWR4OiBmdW5jdGlvbihpZHgpIHtcbiAgICAgIHZhciBub2RlLCBjdXJyZW50O1xuICAgICAgaWYgKGlkeCA8IHRoaXMuX3NpemUgLyAyKSB7XG4gICAgICAgIG5vZGUgPSB0aGlzLl9mcm9udDtcbiAgICAgICAgY3VycmVudCA9IDA7XG4gICAgICAgIHdoaWxlKGN1cnJlbnQgIT09IGlkeCkge1xuICAgICAgICAgIG5vZGUgPSBub2RlLm5leHQoKTtcbiAgICAgICAgICBjdXJyZW50Kys7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG5vZGUgPSB0aGlzLl9iYWNrO1xuICAgICAgICBjdXJyZW50ID0gdGhpcy5fc2l6ZSAtIDE7XG5cbiAgICAgICAgd2hpbGUoY3VycmVudCAhPT0gaWR4KSB7XG4gICAgICAgICAgbm9kZSA9IG5vZGUucHJldigpO1xuICAgICAgICAgIGN1cnJlbnQtLTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG5vZGU7XG4gICAgfSxcblxuICAgIF93YWxrVG9WYWx1ZTogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHZhciBuID0gdGhpcy5fZnJvbnQ7XG4gICAgICB3aGlsZSAobiAhPT1udWxsICkge1xuICAgICAgICBpZiAobi5tYXRjaCh2YWx1ZSkpIHtcbiAgICAgICAgICByZXR1cm4gbjtcbiAgICAgICAgfVxuICAgICAgICBuID0gbi5uZXh0KCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9LFxuXG4gICAgX2lzRWxlbWVudElkeDogZnVuY3Rpb24oaWR4KSB7XG4gICAgICByZXR1cm4gKGlkeCA+PSAwICYmIGlkeCA8IHRoaXMuX3NpemUpO1xuICAgIH0sXG5cbiAgICBfaXNFbGVtZW50UG9zaXRpb246IGZ1bmN0aW9uKGlkeCkge1xuICAgICAgcmV0dXJuIChpZHggPj0gMCAmJiBpZHggPD0gdGhpcy5fc2l6ZSk7XG4gICAgfSxcblxuICAgIF9jaGVja0VsZW1lbnRJZHhPclRocm93OiBmdW5jdGlvbihpZHgpIHtcbiAgICAgIGlmICghdGhpcy5faXNFbGVtZW50SWR4KGlkeCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW5kZXggb3V0IG9mIGJvdW5kczsgc2l6ZTogXCIgKyB0aGlzLl9zaXplICsgXCI7IGlkeDogXCIgKyBpZHgpO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBfY2hlY2tJc0VsZW1lbnRQb3NpdGlvbk9yVGhyb3c6IGZ1bmN0aW9uKGlkeCkge1xuICAgICAgaWYgKCF0aGlzLl9pc0VsZW1lbnRQb3NpdGlvbihpZHgpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkluZGV4IG91dCBvZiBib3VuZHM7IHNpemU6IFwiICsgdGhpcy5fc2l6ZSArIFwiOyBpZHg6IFwiICsgaWR4KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgfSk7XG5cbiAgdmFyIE5vZGUgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChOb2RlLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgICAgICAgID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdGhpcy5fbmV4dCAgPSBvcHRzLmdldE9yRWxzZShcIm5leHRcIiwgbnVsbCk7XG4gICAgICB0aGlzLl9wcmV2ICA9IG9wdHMuZ2V0T3JFbHNlKFwicHJldlwiLCBudWxsKTtcbiAgICAgIHRoaXMuX3ZhbHVlID0gb3B0cy5nZXRPckVsc2UoXCJ2YWx1ZVwiLCBudWxsKTtcbiAgICB9LFxuXG4gICAgbmV4dDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fbmV4dDtcbiAgICB9LFxuXG4gICAgcHJldjogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fcHJldjtcbiAgICB9LFxuXG4gICAgc2V0TmV4dDogZnVuY3Rpb24obm9kZSkge1xuICAgICAgdGhpcy5fbmV4dCA9IG5vZGU7XG4gICAgfSxcblxuICAgIHNldFByZXY6IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgIHRoaXMuX3ByZXYgPSBub2RlO1xuICAgIH0sXG5cbiAgICB2YWx1ZTogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fdmFsdWU7XG4gICAgfSxcblxuICAgIGRpc3Bvc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fbmV4dCAgPSBudWxsO1xuICAgICAgdGhpcy5fcHJldiAgPSBudWxsO1xuICAgICAgdGhpcy5fdmFsdWUgPSBudWxsO1xuICAgIH0sXG5cbiAgICBtYXRjaDogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHJldHVybiB0aGlzLl92YWx1ZSA9PT0gdmFsdWU7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gRG91Ymx5TGlua2VkTGlzdDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvb3B0aW9uc1wiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBPcHRpb25zXG4pIHtcblxuICAvKipcbiAgICogRGVsZWdhdGVzIHN0b3JhZ2UgdG8gYSBKUyBvYmplY3QuXG4gICAqL1xuICB2YXIgT2JqZWN0SGFzaE1hcCA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG5cbiAgXy5leHRlbmQoT2JqZWN0SGFzaE1hcC5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdGhpcy5fc3RvcmUgPSB7fTtcbiAgICAgIHRoaXMuX2tleVByZWZpeCA9IG9wdHMuZ2V0T3JFbHNlKFwia2V5UHJlZml4XCIsIFwib2htLVwiKTtcbiAgICB9LFxuICAgIGdldDogZnVuY3Rpb24oa2V5KXtcbiAgICAgIHJldHVybiB0aGlzLl9zdG9yZVt0aGlzLl9tYWtlS2V5KGtleSldO1xuICAgIH0sXG4gICAgcHV0OiBmdW5jdGlvbihrZXksIHZhbCkge1xuICAgICAgdGhpcy5fc3RvcmVbdGhpcy5fbWFrZUtleShrZXkpXSA9IHZhbDtcbiAgICB9LFxuICAgIHJlbW92ZTogZnVuY3Rpb24oa2V5KSB7XG4gICAgICB2YXIgdmFsO1xuICAgICAga2V5ID0gdGhpcy5fbWFrZUtleShrZXkpO1xuICAgICAgaWYgKF8uaGFzKHRoaXMuX3N0b3JlLCBrZXkpKSB7XG4gICAgICAgIHZhbCA9IHRoaXMuX3N0b3JlW2tleV07XG4gICAgICAgIGRlbGV0ZSB0aGlzLl9zdG9yZVtrZXldO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHZhbDtcbiAgICB9LFxuICAgIGV4aXN0czogZnVuY3Rpb24oa2V5KSB7XG4gICAgICByZXR1cm4gXy5oYXModGhpcy5fc3RvcmUsIHRoaXMuX21ha2VLZXkoa2V5KSk7XG4gICAgfSxcbiAgICBzaXplOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBfLnNpemUodGhpcy5fc3RvcmUpO1xuICAgIH0sXG4gICAgY2xlYXI6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fc3RvcmUgPSB7fTtcbiAgICB9LFxuICAgIF9tYWtlS2V5OiBmdW5jdGlvbihrZXkpIHtcbiAgICAgIHJldHVybiB0aGlzLl9rZXlQcmVmaXggKyBrZXk7XG4gICAgfVxuICB9KTtcblxuXG4gIHJldHVybiBPYmplY3RIYXNoTWFwO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9vcHRpb25zXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFByb21pc2UsXG4gIE9wdGlvbnMsXG4gIEluTWVtb3J5RGF0YVN0b3JlLFxuICBVbml0U2VxdWVuY2VyLFxuICBFbnRyeVxuKSB7XG5cbiAgLy8gQXBwcm9wcmlhdGUgZm9yIHRoZSBkZWZhdWx0IHNlcXVlbmNlciAobm9uLXRlbXBvcmFsKVxuICB2YXIgREVGQVVMVF9UVEwgPSAxO1xuXG5cbiAgLyoqXG4gICAqIEEgbG9vay1hc2lkZSBjYWNoaW5nIGRhdGEgc3RvcmUuIE5vdGU6IGl0J3MgZ2VuZXJhbGx5IG5vdCB1c2VmdWwgdG8gYWxsb3dcbiAgICogbnVsbC91bmRlZmluZWQgc3RvcmVkIHZhbHVlcy4gV2hlbiBhbiBpdGVtIGlzIGV2aWN0ZWQgZnJvbSB0aGUgY2FjaGUsIGFcbiAgICogc3Vic2VxdWVudCBgZ2V0YCBjYWxsIHdpbGwgcmV0dXJuIGB1bmRlZmluZWRgLCBzbyBpdCBjYW4gYmUgZGlmZmljdWx0IHRvXG4gICAqIGRldGVybWluZSBpZiB0aGVyZSB3YXMgYSBjYWNoZSBtaXNzIGlmIHRoZSB2YWx1ZSB5b3UncmUgc3RvcmluZyBpcywgaW4gZmFjdCxcbiAgICogYHVuZGVmaW5lZGAsIHVubGVzcyB5b3UgcHJlZml4IGV2ZXJ5IGNoZWNrIHdpdGggYGV4aXN0c2AsIHdoaWNoIGFsc28gZG9lc1xuICAgKiBjYWNoZSBldmljdGlvbiBvbiBjaGVjay5cbiAgICovXG4gIHZhciBDYWNoaW5nRGF0YVN0b3JlID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoQ2FjaGluZ0RhdGFTdG9yZS5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdGhpcy5fdHRsID0gb3B0cy5nZXRPckVsc2UoXCJ0dGxcIiwgREVGQVVMVF9UVEwpO1xuXG4gICAgICAvLyBEZWZhdWx0IHNlcXVlbmNlciBpcyBhIGxpbmVhci91bml0IHNlcXVlbmNlci4gVGhlIGRlZmF1bHQgVFRMIGlzXG4gICAgICAvLyAxLiBUaGVyZWZvcmUsIGFsbCB2YWx1ZXMgd2lsbCBleHBpcmUgd2l0aCBzaW5nbGUgYWR2YW5jZSBvZiB0aGVcbiAgICAgIC8vIHNlcXVlbmNlci4gTm90ZSB0aGF0IHRoZSBkYXRhIHN0b3JlIGRvZXNuJ3QgYWR2YW5jZSB0aGVcbiAgICAgIC8vIHNlcXVlbmNlciBpdHNlbGYuIFRoZSBzdG9yZSBvd25lciBpcyByZXNwb25zaWJsZSBmb3IgZG9pbmdcbiAgICAgIC8vIHRoaXMuXG4gICAgICAvL1xuICAgICAgLy8gVGhpcyBpcyBlc3BlY2lhbGx5IGltcG9ydGFudCB0byBub3RlIGZvciB0aW1lLWJhc2VkIHNlcXVlbmNlcnMuXG4gICAgICAvLyBUaW1lIHdpbGwgbm90IGFkdmFuY2UgYXV0b21hdGljYWxseS4gVGhlIHN0b3JlIG93bmVyIGlzIHJlc3BvbnNpYmxlXG4gICAgICAvLyBmb3Igc2NoZWR1bGluZyB0aGUgc2VxdWVuY2VyIHRvIGFkdmFuY2Ugd2l0aCB0aW1lLiBUaGlzIGtlZXBzIHRoZVxuICAgICAgLy8gQ2FjaGluZ0RhdGFTdG9yZSdzIGxpZmVjeWNsZSBzaW1wbGUgd2l0aCByZXNwZWN0IHRvIHRpbWUuXG4gICAgICB0aGlzLl9zZXF1ZW5jZXIgPSBvcHRzLmdldE9yRWxzZUZuKFwic2VxdWVuY2VyXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gbmV3IFVuaXRTZXF1ZW5jZXIoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBCeSBkZWZhdWx0LCB3ZSBkZWxlZ2F0ZSB0byBhbiBpbi1tZW1vcnkgc3RvcmUuIEZpbmUgZm9yIHNpbXBsZVxuICAgICAgLy8gY2FzZXMsIGJ1dCBub3Qgb3B0aW1hbC5cbiAgICAgIHRoaXMuX2JhY2tpbmdTdG9yZSA9IG9wdHMuZ2V0T3JFbHNlRm4oXCJiYWNraW5nU3RvcmVcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBuZXcgSW5NZW1vcnlEYXRhU3RvcmUoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBVcGRhdGVzIHRoZSBsYXN0VXBkYXRlZCB0aW1lIHRvIFwibm93XCIgb24gcmVhZCAtIGtlZXBzIGVudHJpZXNcbiAgICAgIC8vIGZyb20gZXhwaXJpbmcgd2hlbiB0aGV5J3JlIGJlaW5nIGFjY2Vzc2VkLCBidXQgY2FuIGNhdXNlXG4gICAgICAvLyBzdGFsZW5lc3MgaXNzdWVzLlxuICAgICAgdGhpcy5fc2hvdWxkVG91Y2hPblJlYWQgPSBvcHRzLmdldE9yRWxzZShcInRvdWNoT25SZWFkXCIsIGZhbHNlKTtcbiAgICB9LFxuXG4gICAgc2VxdWVuY2VyOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zZXF1ZW5jZXI7XG4gICAgfSxcblxuXG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgdmFsdWUgYXNzb2NpYXRlZCB3aXRoIHRoZSBwcm92aWRlZCBrZXkuIElmIHRoZSBvYmplY3QgaGFzXG4gICAgICogZXhwaXJlZCwgaXQgd2lsbCBiZSBldmljdGVkIGZyb20gdGhlIGNhY2hlLCBhbmQgYHVuZGVmaW5lZGAgd2lsbFxuICAgICAqIGJlIHJldHVybmVkIGluc3RlYWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ga2V5IHtzdHJpbmd9IChyZXF1aXJlZClcbiAgICAgKiBAYXN5bmNcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxPYmplY3Q+fSByZXF1ZXN0ZWQgdmFsdWVcbiAgICAgKi9cbiAgICBnZXQ6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKGtleSkge1xuICAgICAgcmV0dXJuIFByb21pc2VcbiAgICAgICAgLmJpbmQodGhpcylcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX2JhY2tpbmdTdG9yZS5nZXQoa2V5KTtcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oZW50cnkpe1xuICAgICAgICAgIGlmICghZW50cnkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoIWVudHJ5LmlzRXhwaXJlZCh0aGlzLl9zZXF1ZW5jZXIudmFsdWUoKSwgdGhpcy5fdHRsKSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3Nob3VsZFRvdWNoT25SZWFkKSB7XG4gICAgICAgICAgICAgIGVudHJ5LnRvdWNoKHRoaXMuX3NlcXVlbmNlci52YWx1ZSgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlXG4gICAgICAgICAgICAgIC5iaW5kKHRoaXMpXG4gICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9iYWNraW5nU3RvcmUucHV0KGtleSwgZW50cnkpO1xuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAucmV0dXJuKGVudHJ5LnZhbHVlKCkpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZVxuICAgICAgICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZW1vdmUoa2V5KVxuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAvLyAudGhlblJldHVybiBpcyBhIGxpZS5cbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSksXG5cbiAgICAvKipcbiAgICAgKiBTdG9yZXMgdGhlIHByb3ZpZGVkIGB2YWxgLCBpZGVudGlmaWVkIGJ5IGBrZXlgXG4gICAgICpcbiAgICAgKiBAcGFyYW0gYGtleWAge3N0cmluZ30gIChyZXF1aXJlZCkgaWRlbnRpZmllciBmb3IgdmFsdWUgdG8gYmUgc3RvcmVkXG4gICAgICogQHBhcmFtIGB2YWxgIHtkeW5hbWljfSAocmVxdWlyZWQpIHZhbHVlIHRvIGJlIHN0b3JlZFxuICAgICAqIEBhc3luY1xuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPD59XG4gICAgICovXG4gICAgcHV0OiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbihrZXksIHZhbCkge1xuICAgICAgcmV0dXJuIFByb21pc2VcbiAgICAgICAgLmJpbmQodGhpcylcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX2JhY2tpbmdTdG9yZS5nZXQoa2V5KTtcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oZW50cnkpIHtcbiAgICAgICAgICAvLyBJZiB3ZSBoYXZlIGFuIGVudHJ5LCB3ZSBzaG91bGQganVzdCB1cGRhdGVcbiAgICAgICAgICAvLyBFbHNlLCB3ZSBtYWtlIG5ldyBvbmUuXG4gICAgICAgICAgLy8gUGVzaXN0LCB0aGVuIHJldHVybiBub3RoaW5nLlxuICAgICAgICAgIGlmIChlbnRyeSkge1xuICAgICAgICAgICAgZW50cnkudXBkYXRlKHZhbCwgdGhpcy5fc2VxdWVuY2VyLnZhbHVlKCkpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBlbnRyeSA9IG5ldyBFbnRyeSh7XG4gICAgICAgICAgICAgIHZhbHVlOiB2YWwsXG4gICAgICAgICAgICAgIGluaXRpYWxTZXF1ZW5jZTogdGhpcy5fc2VxdWVuY2VyLnZhbHVlKClcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiBQcm9taXNlXG4gICAgICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzLl9iYWNraW5nU3RvcmUucHV0KGtleSwgZW50cnkpXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9KSxcblxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgdGhlIHZhbHVlIGFzc29jaWF0ZWQgd2l0aCB0aGUgcHJvdmlkZWQgYGtleWBcbiAgICAgKlxuICAgICAqIEBwYXJhbSBga2V5YCB7c3RyaW5nfSAocmVxdWlyZWQpIGlkZW50aWZpZXIgZm9yIHZhbHVlIHRvIGJlIHJlbW92ZWRcbiAgICAgKiBAYXN5bmNcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxkeW5hbWljPn0gUmVtb3ZlZCB2YWx1ZSwgaWYgcHJlc2VudCBpbiBzdG9yZS5cbiAgICAgKi9cbiAgICByZW1vdmU6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKGtleSkge1xuICAgICAgdmFyIHZhbDtcbiAgICAgIHJldHVybiB0aGlzLl9iYWNraW5nU3RvcmVcbiAgICAgICAgLnJlbW92ZShrZXkpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKGVudHJ5KSB7XG4gICAgICAgICAgaWYgKGVudHJ5KSB7XG4gICAgICAgICAgICB2YWwgPSBlbnRyeS52YWx1ZSgpO1xuICAgICAgICAgICAgZW50cnkuZGlzcG9zZSgpO1xuICAgICAgICAgICAgcmV0dXJuIHZhbDtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pLFxuXG4gICAgZXhpc3RzOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbihrZXkpe1xuICAgICAgLy8gSXQncyBub3Qgc3VmZmljaWVudCB0byBkZWxlZ2F0ZSB0aGlzIGNhbGwgdG8gdGhlIHVuZGVybHlpbmdcbiAgICAgIC8vIGJhY2tpbmcgc3RvcmUuIFdlIG5lZWQgdG8gcGVyZm9ybSBldmljdGlvbiwgYXMgYSBzdWJzZXF1ZW50IGNhbGxcbiAgICAgIC8vIHRvIGdldCB3b3VsZCBkbyB0aGUgc2FtZS4gSWYgdGhlIGBleGlzdHNgIGNoZWNrIHNheXMgaXQgZXhpc3RzLFxuICAgICAgLy8gYmV0IGl0IGRvZXNuJ3Qgd2hlbiB3ZSBgZ2V0YCwgdGhlbiBgZXhpc3RzYCBpcyBhIHdvcnRobGVzcyBvcGVyYXRpb24uXG4gICAgICAvL1xuICAgICAgLy8gTm90ZSB0aGF0IGlmIHlvdSdyZSB1c2luZyBhIENhY2hpbmdEYXRhU3RvcmUgYmFja2VkIGJ5IGFuIEluTWVtb3J5RGF0YVN0b3JlXG4gICAgICAvLyBiYWNrZWQgYnkgYW4gTFJVSGFzaE1hcCwgdGhpcyB3aWxsIGNhdXNlIHRoZSBlbnRyeSB0byBiZSBcInRvdWNoZWRcIiwgd2hlcmVhc1xuICAgICAgLy8gYSBub3JtYWwgXCJleGlzdHNcIiBjaGVjayB3b3VsZCBub3QuXG4gICAgICByZXR1cm4gUHJvbWlzZVxuICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fYmFja2luZ1N0b3JlLmdldChrZXkpO1xuICAgICAgICB9KVxuICAgICAgICAudGhlbihmdW5jdGlvbihlbnRyeSkge1xuICAgICAgICAgICAgaWYgKCFlbnRyeSkge1xuICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBpZiAoIWVudHJ5LmlzRXhwaXJlZCh0aGlzLl9zZXF1ZW5jZXIudmFsdWUoKSwgdGhpcy5fdHRsKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9iYWNraW5nU3RvcmUucmVtb3ZlKGtleSlcbiAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBlbnRyeS5kaXNwb3NlKCk7XG4gICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgLnRoZW5SZXR1cm4oZmFsc2UpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pLFxuXG4gICAgY2xlYXI6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2JhY2tpbmdTdG9yZS5jbGVhcigpO1xuICAgIH0pXG4gIH0pO1xuXG4gIHJldHVybiBDYWNoaW5nRGF0YVN0b3JlO1xuXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJibHVlYmlyZFwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4vaW4tbWVtb3J5LWRhdGEtc3RvcmVcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL3NlcXVlbmNlci91bml0LXNlcXVlbmNlclwiKSxcbiAgcmVxdWlyZShcIi4vaW50ZXJuYWxzL2V4cGlyaW5nLWVudHJ5XCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFByb21pc2UsXG4gIE9wdGlvbnMsXG4gIE9iamVjdEhhc2hNYXBcbikge1xuXG4gIC8qKlxuICAgKiBJbk1lbW9yeURhdGFTdG9yZSBkZWxlZ2F0ZXMgdG8gYSBiYWNraW5nIEhhc2hNYXAuIEJ5IGRlZmF1bHQsIHRoaXNcbiAgICogd2lsbCBiZSBhIFwicG9vciBtYW4ncyBIYXNoTWFwXCIsIGEuay5hLiwgdGhlIE9iamVjdEhhc2hNYXAuXG4gICAqL1xuICB2YXIgSW5NZW1vcnlEYXRhU3RvcmUgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChJbk1lbW9yeURhdGFTdG9yZS5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdGhpcy5fbWFwID0gb3B0cy5nZXRPckVsc2VGbihcImJhY2tpbmdIYXNoTWFwXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gbmV3IE9iamVjdEhhc2hNYXAoKTtcbiAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBnZXQ6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKGtleSkge1xuICAgICAgcmV0dXJuIHRoaXMuX21hcC5nZXQoa2V5KTtcbiAgICB9KSxcblxuICAgIHB1dDogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oa2V5LCB2YWwpIHtcbiAgICAgIHJldHVybiB0aGlzLl9tYXAucHV0KGtleSwgdmFsKTtcbiAgICB9KSxcblxuICAgIHJlbW92ZTogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oa2V5KSB7XG4gICAgICByZXR1cm4gdGhpcy5fbWFwLnJlbW92ZShrZXkpO1xuICAgIH0pLFxuXG4gICAgZXhpc3RzOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbihrZXkpe1xuICAgICAgcmV0dXJuIHRoaXMuX21hcC5leGlzdHMoa2V5KTtcbiAgICB9KSxcblxuICAgIGNsZWFyOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9tYXAuY2xlYXIoKTtcbiAgICB9KVxuICB9KTtcblxuICByZXR1cm4gSW5NZW1vcnlEYXRhU3RvcmU7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJibHVlYmlyZFwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4uL2NvbGxlY3Rpb24vb2JqZWN0LWhhc2gtbWFwXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIE9wdGlvbnMsXG4gIE9iamVjdEhhc2hNYXAsXG4gIERvdWJseUxpbmtlZExpc3Rcbikge1xuXG4gIHZhciBMUlVIYXNoTWFwID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoTFJVSGFzaE1hcC5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdGhpcy5fY2FwYWNpdHkgPSBvcHRzLmdldE9yRXJyb3IoXCJjYXBhY2l0eVwiKTtcbiAgICAgIHRoaXMuX2tleUFjY2Vzc0xpc3QgPSBuZXcgRG91Ymx5TGlua2VkTGlzdCgpO1xuICAgICAgLy8gVE9ETzogUmVhbGx5IG5lZWQgYSBwcm9wZXIgSGFzaE1hcCBhdCBzb21lIHBvaW50Li4uXG4gICAgICB0aGlzLl9zdG9yZSA9IG5ldyBPYmplY3RIYXNoTWFwKCk7XG4gICAgfSxcbiAgICBnZXQ6IGZ1bmN0aW9uKGtleSkge1xuICAgICAgdmFyIGVudHJ5ID0gdGhpcy5fc3RvcmUuZ2V0KGtleSk7XG4gICAgICBpZiAoIWVudHJ5KSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gQXMgYSBwZXJmIG9wdGltaXphdGlvbiwgd2Uga2VlcCBhIHJlZlxuICAgICAgLy8gdG8gdGhlIG5vZGUgaW4gdGhlIGVudHJ5LlxuICAgICAgdmFyIG5vZGUgPSBlbnRyeS5ub2RlKCk7XG4gICAgICB0aGlzLl9rZXlBY2Nlc3NMaXN0Ll91bmxpbmsobm9kZSk7XG5cbiAgICAgIC8vIEdldCB0aGUgbmV3IG5vZGVcbiAgICAgIG5vZGUgPSB0aGlzLl9rZXlBY2Nlc3NMaXN0Ll9saW5rRnJvbnQoZW50cnkua2V5KCkpO1xuXG4gICAgICAvLyBTYXZlIGl0XG4gICAgICBlbnRyeS5zZXROb2RlKG5vZGUpO1xuICAgICAgLy8gUmV0dXJuIHRoZSB2YWx1ZVxuICAgICAgcmV0dXJuIGVudHJ5LnZhbHVlKCk7XG4gICAgfSxcblxuICAgIHB1dDogZnVuY3Rpb24oa2V5LCB2YWwpIHtcbiAgICAgIHZhciBlbnRyeSA9IHRoaXMuX3N0b3JlLmdldChrZXkpLFxuICAgICAgICAgIG5vZGU7XG4gICAgICBpZiAoIWVudHJ5KSB7XG4gICAgICAgIC8vIElmIG5vIGVudHJ5LCBtYWtlIGEgbmV3IGVudHJ5XG4gICAgICAgIGlmICh0aGlzLl9rZXlBY2Nlc3NMaXN0LnNpemUoKSA+PSB0aGlzLl9jYXBhY2l0eSkge1xuICAgICAgICAgIC8vIEhhdmUgdG8gbWFrZSByb29tIGZvciBpdFxuICAgICAgICAgIHZhciBldmljdGVkS2V5ID0gdGhpcy5fa2V5QWNjZXNzTGlzdC5yZW1vdmVCYWNrKCksXG4gICAgICAgICAgICAgIGV2aWN0ZWRFbnRyeSA9IHRoaXMuX3N0b3JlLmdldChldmljdGVkS2V5KTtcblxuICAgICAgICAgIGV2aWN0ZWRFbnRyeS5kaXNwb3NlKCk7XG4gICAgICAgICAgdGhpcy5fc3RvcmUucmVtb3ZlKGV2aWN0ZWRLZXkpO1xuICAgICAgICB9XG5cbiAgICAgICAgbm9kZSA9IHRoaXMuX2tleUFjY2Vzc0xpc3QuX2xpbmtGcm9udChrZXkpO1xuICAgICAgICBlbnRyeSA9IG5ldyBFbnRyeSh7XG4gICAgICAgICAga2V5OiBrZXksXG4gICAgICAgICAgdmFsdWU6IHZhbCxcbiAgICAgICAgICBub2RlOiBub2RlXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9zdG9yZS5wdXQoa2V5LCBlbnRyeSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBcIlRvdWNoXCIgdGhlIGVudHJ5LCBzZXQgbmV3IHZhbHVlXG4gICAgICAgIG5vZGUgPSBlbnRyeS5ub2RlKCk7XG4gICAgICAgIHRoaXMuX2tleUFjY2Vzc0xpc3QuX3VubGluayhub2RlKTtcbiAgICAgICAgbm9kZSA9IHRoaXMuX2tleUFjY2Vzc0xpc3QuX2xpbmtGcm9udChlbnRyeS5rZXkoKSk7XG4gICAgICAgIC8vIFVwZGF0ZSB3aXRoIHRoZSBuZXcgbm9kZSBhbmQgdmFsdWVcbiAgICAgICAgZW50cnkuc2V0Tm9kZShub2RlKTtcbiAgICAgICAgZW50cnkuc2V0VmFsdWUodmFsKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgcmVtb3ZlOiBmdW5jdGlvbihrZXkpIHtcbiAgICAgIHZhciBlbnRyeSA9IHRoaXMuX3N0b3JlLmdldChrZXkpLFxuICAgICAgICAgIHZhbHVlLFxuICAgICAgICAgIG5vZGU7XG4gICAgICBpZiAoZW50cnkpIHtcbiAgICAgICAgdmFsdWUgPSBlbnRyeS52YWx1ZSgpO1xuICAgICAgICBub2RlID0gZW50cnkubm9kZSgpO1xuICAgICAgICB0aGlzLl9rZXlBY2Nlc3NMaXN0Ll91bmxpbmsobm9kZSk7XG4gICAgICAgIGVudHJ5LmRpc3Bvc2UoKTtcbiAgICAgICAgdGhpcy5fc3RvcmUucmVtb3ZlKGtleSk7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgZXhpc3RzOiBmdW5jdGlvbihrZXkpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zdG9yZS5leGlzdHMoa2V5KTtcbiAgICB9LFxuXG4gICAgc2l6ZTogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc3RvcmUuc2l6ZSgpO1xuICAgIH0sXG5cbiAgICBjbGVhcjogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9zdG9yZS5jbGVhcigpO1xuICAgICAgdGhpcy5fa2V5QWNjZXNzTGlzdC5jbGVhcigpO1xuICAgIH1cbiAgfSk7XG5cbiAgdmFyIEVudHJ5ID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoRW50cnkucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIC8vIFRob3VnaCB0aGUgTm9kZSBzaG91bGQgaGF2ZSB0aGUga2V5LCBpZiB0aGUgbm9kZVxuICAgICAgLy8gaXMgdW5saW5rZWQgZnJvbSB0aGUgbGlzdCwgaXRzIGJveGVkIHZhbHVlIHdpbGwgZGlzYXBwZWFyXG4gICAgICB0aGlzLl9rZXkgICA9IG9wdHMuZ2V0T3JFcnJvcihcImtleVwiKTtcbiAgICAgIHRoaXMuX3ZhbHVlID0gb3B0cy5nZXRPckVycm9yKFwidmFsdWVcIik7XG4gICAgICB0aGlzLl9ub2RlICA9IG9wdHMuZ2V0T3JFcnJvcihcIm5vZGVcIik7XG4gICAgfSxcbiAgICBub2RlOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9ub2RlO1xuICAgIH0sXG4gICAgc2V0Tm9kZTogZnVuY3Rpb24obm9kZSkge1xuICAgICAgdGhpcy5fbm9kZSA9IG5vZGU7XG4gICAgfSxcbiAgICB2YWx1ZTogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fdmFsdWU7XG4gICAgfSxcbiAgICBzZXRWYWx1ZTogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHRoaXMuX3ZhbHVlID0gdmFsdWU7XG4gICAgfSxcbiAgICBrZXk6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2tleTtcbiAgICB9LFxuICAgIGRpc3Bvc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fa2V5ID0gbnVsbDtcbiAgICAgIHRoaXMuX3ZhbHVlID0gbnVsbDtcbiAgICAgIHRoaXMuX25vZGUgPSBudWxsO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIExSVUhhc2hNYXA7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL29wdGlvbnNcIiksXG4gIHJlcXVpcmUoXCIuL29iamVjdC1oYXNoLW1hcFwiKSxcbiAgcmVxdWlyZShcIi4vZG91Ymx5LWxpbmtlZC1saXN0XCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIE9wdGlvbnMsXG4gIEluTWVtb3J5RGF0YVN0b3JlLFxuICBMUlVIYXNoTWFwXG4pIHtcblxuICB2YXIgTFJVRGF0YVN0b3JlID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoTFJVRGF0YVN0b3JlLnByb3RvdHlwZSwgSW5NZW1vcnlEYXRhU3RvcmUucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIHZhciBtYXAgPSBuZXcgTFJVSGFzaE1hcCh7XG4gICAgICAgIGNhcGFjaXR5OiBvcHRzLmdldE9yRXJyb3IoXCJjYXBhY2l0eVwiKVxuICAgICAgfSk7XG4gICAgICBJbk1lbW9yeURhdGFTdG9yZS5wcm90b3R5cGUuaW5pdGlhbGl6ZS5jYWxsKHRoaXMsIHtcbiAgICAgICAgYmFja2luZ0hhc2hNYXA6IG1hcFxuICAgICAgfSk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gTFJVRGF0YVN0b3JlO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9vcHRpb25zXCIpLFxuICByZXF1aXJlKFwiLi9pbi1tZW1vcnktZGF0YS1zdG9yZVwiKSxcbiAgcmVxdWlyZShcIi4uL2NvbGxlY3Rpb24vbHJ1LWhhc2gtbWFwXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFByb21pc2UsXG4gIE0sXG4gIE9wdGlvbnMsXG4gIENoYW5uZWwsXG4gIENoYWluZWRDaGFubmVsLFxuICBVbml0U2VxdWVuY2VyLFxuICBEZWxlZ2F0aW5nRm9yd2FyZGluZ1NlcXVlbmNlcixcbiAgSW5NZW1vcnlEYXRhU3RvcmUsXG4gIEVudHJ5XG4pIHtcblxuICAvKipcbiAgICogU2VtYW50aWNhbGx5IHNpbWlsYXIgdG8gYSBDYWNoaW5nRGF0YVN0b3JlLCBleGNlcHQ6XG4gICAqICAgMSkgRXhwaXJ5IGlzIGNoZWNrIGJvdGggb24gYWNjZXNzLCBhbmQgd2hlbmV2ZXIgYGFkdmFuY2VgIGlzXG4gICAqICAgICAgY2FsbGVkIG9uIHRoZSBgc2VudHJ5U2VxdWVuY2VyYC5cbiAgICogICAyKSBSZWNvcmRzIGFyZSBub3QgYXV0b21hdGljYWxseSByZW1vdmVkOyBpbnN0ZWFkLCBhIHNpZ25hbCBpcyBzZW50XG4gICAqICAgICAgYWxvbmcgdGhlIGBzaWduYWxDaGFubmVsYC4gVGhlIHNpZ25hbCBkaXNwYXRjaCBpcyBkZWZlcnJlZCwgc29cbiAgICogICAgICBhbiBhY2Nlc3MtdHJpZ2dlcmVkIGV2b2NhdGlvbiBzaWduYWwgd29uJ3QgYmUgcmVjZWl2ZWQgdW50aWwgYVxuICAgKiAgICAgIHN1YnNlcXVlbnQgdGljay4gU2luY2UgcHJvbWlzZXMgYXJlIGFzeW5jaHJvbm91cywgdGhpcyBtZWFuc1xuICAgKiAgICAgIHRoZSBjYWxsZXIgbWF5IHJlY2VpdmUgYSB2YWx1ZSBmcm9tIHRoZSBzdG9yZSwgYW5kIG1heSBhbHNvXG4gICAqICAgICAgcmVjZWl2ZSBhbiBldmVudCBmcm9tIHRoZSBTdG9yZSBpbmRpY2F0aW5nIGV4cGlyeSAtIGluIG5vbi1kZXRlcm1pbmlzdGljXG4gICAqICAgICAgb3JkZXIuIEl0J3MgdXAgdG8gdGhlIGNhbGxlciB0byBjaG9vc2UgYSByZXNvbHV0aW9uLlxuICAgKiAgICAgIEFkZGl0aW9uYWxseSwgdGhlcmUgaXMgbm8gZ3VhcmFudGVlIHRoYXQgYSBzaW5nbGUgZXhwaXJ5IGV2ZW50XG4gICAqICAgICAgd2lsbCBiZSBzZW50IGZvciBhIGdpdmVuIGtleTsgaW5zdGVhZCwgdGhlIGV2ZW50IHdpbGwgY29udGludWVcbiAgICogICAgICB0byBiZSBkaXNwYXRjaGVkIGZvciBhcyBsb25nIGFzIHRoZSBrZXkgcmVtYWlucyBpbiB0aGUgc3RvcmUuXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKi9cbiAgdmFyIFNpZ25hbGluZ0RhdGFTdG9yZSA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIHZhciBERUZBVUxUX1RUTCA9IDE7XG5cbiAgXy5leHRlbmQoU2lnbmFsaW5nRGF0YVN0b3JlLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB0aGlzLl90dGwgPSBvcHRzLmdldE9yRWxzZShcInR0bFwiLCBERUZBVUxUX1RUTCk7XG5cbiAgICAgIHRoaXMuX3NlcXVlbmNlciA9IG9wdHMuZ2V0T3JFbHNlRm4oXCJzZXF1ZW5jZXJcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBuZXcgVW5pdFNlcXVlbmNlcigpO1xuICAgICAgfSk7XG5cbiAgICAgIF8uYmluZEFsbCh0aGlzLCBcIl9kb0NoZWNrXCIpO1xuXG4gICAgICB0aGlzLl9zZW50cnlTZXF1ZW5jZXIgPSBuZXcgRGVsZWdhdGluZ0ZvcndhcmRpbmdTZXF1ZW5jZXIoe1xuICAgICAgICBkZWxlZ2F0ZTogbmV3IFVuaXRTZXF1ZW5jZXIoKSxcbiAgICAgICAgdGFyZ2V0czogW3tcbiAgICAgICAgICBhZHZhbmNlOiB0aGlzLl9kb0NoZWNrXG4gICAgICAgIH1dXG4gICAgICB9KTtcblxuICAgICAgdGhpcy5fYmFja2luZ1N0b3JlID0gb3B0cy5nZXRPckVsc2VGbihcImJhY2tpbmdTdG9yZVwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBJbk1lbW9yeURhdGFTdG9yZSgpO1xuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuX3Nob3VsZFRvdWNoT25SZWFkID0gb3B0cy5nZXRPckVsc2UoXCJ0b3VjaE9uUmVhZFwiLCBmYWxzZSk7XG5cbiAgICAgIHRoaXMuX3NpZ25hbENoYW5uZWwgPSBuZXcgQ2hhbm5lbCh7IHNlbnRpbmVsOiB0aGlzIH0pO1xuXG4gICAgICB0aGlzLl9rZXlzID0gTS5zZXQoKTtcbiAgICB9LFxuXG4gICAgc2VxdWVuY2VyOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zZXF1ZW5jZXI7XG4gICAgfSxcblxuICAgIHNlbnRyeVNlcXVlbmNlcjogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc2VudHJ5U2VxdWVuY2VyO1xuICAgIH0sXG5cbiAgICBzaWduYWxDaGFubmVsOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBuZXcgQ2hhaW5lZENoYW5uZWwoe1xuICAgICAgICBzZW50aW5lbDogdGhpcyxcbiAgICAgICAgY2hhaW5UbzogdGhpcy5fc2lnbmFsQ2hhbm5lbFxuICAgICAgfSk7XG4gICAgfSxcblxuICAgIF9kb0NoZWNrOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciB3b3JrID0gTS5tYXAoXy5iaW5kKGZ1bmN0aW9uKGtleSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZVxuICAgICAgICAgIC5iaW5kKHRoaXMpXG4gICAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYmFja2luZ1N0b3JlLmdldChrZXkpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLnRoZW4oZnVuY3Rpb24oZW50cnkpIHtcbiAgICAgICAgICAgIGlmIChlbnRyeSAmJiBlbnRyeS5pc0V4cGlyZWQodGhpcy5fc2VxdWVuY2VyLnZhbHVlKCksIHRoaXMuX3R0bCkpIHtcbiAgICAgICAgICAgICAgdGhpcy5fc2lnbmFsRXhwaXJ5U29vbihrZXksIHRoaXMuX3NlcXVlbmNlci52YWx1ZSgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfSwgdGhpcyksIHRoaXMuX2tleXMpO1xuXG4gICAgICByZXR1cm4gUHJvbWlzZS5hbGwoTS5pbnRvX2FycmF5KHdvcmspKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgdmFsdWUgYXNzb2NpYXRlZCB3aXRoIHRoZSBwcm92aWRlZCBga2V5YC4gSWYgdGhlIG9iamVjdFxuICAgICAqIGhhcyBleHBpcmVkLCBpdCB3aWxsIHN0aWxsIGJlIHJldHVybmVkIGZyb20gdGhlIFN0b3JlLCBidXQgYW4gbVQ6ZXhwaXJlZFxuICAgICAqIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IGFsb25nIHRoZSBgc2lnbmFsQ2hhbm5lbGAuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ga2V5IHtzdHJpbmd9XG4gICAgICogQGFzeW5jXG4gICAgICogQHJldHVybnMge1Byb21pc2U8b2JqZWN0Pn0gcmVxdWVzdGVkIHZhbHVlXG4gICAgICovXG4gICAgZ2V0OiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbihrZXkpe1xuICAgICAgcmV0dXJuIFByb21pc2VcbiAgICAgICAgLmJpbmQodGhpcylcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX2JhY2tpbmdTdG9yZS5nZXQoa2V5KTtcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oZW50cnkpIHtcbiAgICAgICAgICBpZiAoIWVudHJ5KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIGlzRXhwaXJlZCA9IGVudHJ5LmlzRXhwaXJlZCh0aGlzLl9zZXF1ZW5jZXIudmFsdWUoKSwgdGhpcy5fdHRsKTtcblxuICAgICAgICAgIGlmIChpc0V4cGlyZWQpIHtcbiAgICAgICAgICAgIHRoaXMuX3NpZ25hbEV4cGlyeVNvb24oa2V5LCB0aGlzLl9zZXF1ZW5jZXIudmFsdWUoKSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKCFpc0V4cGlyZWQgJiYgdGhpcy5fc2hvdWxkVG91Y2hPblJlYWQpIHtcbiAgICAgICAgICAgIGVudHJ5LnRvdWNoKHRoaXMuX3NlcXVlbmNlci52YWx1ZSgpKTtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlXG4gICAgICAgICAgICAgIC5iaW5kKHRoaXMpXG4gICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9iYWNraW5nU3RvcmUucHV0KGtleSwgZW50cnkpO1xuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAudGhlblJldHVybihlbnRyeS52YWx1ZSgpKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGVudHJ5LnZhbHVlKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KSxcblxuICAgIC8qKlxuICAgICAqIFN0b3JlcyB0aGUgcHJvdmlkZWQgYHZhbGAsIGlkZW50aWZpZWQgYnkgYGtleWAsIHdpdGggYSBUVEwgb3B0aW9uYWxseVxuICAgICAqIHN1cHBsaWVkIGJ5IGBvcHRzLnR0bGAgKG92ZXJyaWRlcyBwcmUtY29uZmlndXJlZCBTdG9yZSBUVEwuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ga2V5IHtTdHJpbmd9XG4gICAgICogQHBhcmFtIHZhbCB7b2JqZWN0fSB2YWx1ZSB0byBiZSBzdG9yZWRcbiAgICAgKiBAYXN5bmNcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTw+fVxuICAgICAqL1xuICAgIHB1dDogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oa2V5LCB2YWwsIG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG5cbiAgICAgIHJldHVybiBQcm9taXNlXG4gICAgICAgIC5iaW5kKHRoaXMpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLl9iYWNraW5nU3RvcmUuZ2V0KGtleSk7XG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKGVudHJ5KSB7XG4gICAgICAgICAgaWYgKGVudHJ5KSB7XG4gICAgICAgICAgICBlbnRyeS51cGRhdGUodmFsLCB0aGlzLl9zZXF1ZW5jZXIudmFsdWUoKSwge1xuICAgICAgICAgICAgICB0dGw6IG9wdHMuZ2V0T3JFbHNlKFwidHRsXCIpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZW50cnkgPSBuZXcgRW50cnkoe1xuICAgICAgICAgICAgICB2YWx1ZTogdmFsLFxuICAgICAgICAgICAgICBpbml0aWFsU2VxdWVuY2U6IHRoaXMuX3NlcXVlbmNlci52YWx1ZSgpLFxuICAgICAgICAgICAgICB0dGw6IG9wdHMuZ2V0T3JFbHNlKFwidHRsXCIpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIFByb21pc2VcbiAgICAgICAgICAgIC5iaW5kKHRoaXMpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzLl9iYWNraW5nU3RvcmUucHV0KGtleSwgZW50cnkpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICB0aGlzLl9rZXlzID0gTS5jb25qKHRoaXMuX2tleXMsIGtleSk7XG4gICAgICAgICAgICAgIHJldHVybjsgLy8gQmVjYXVzZSB0aGVuUmV0dXJuIGRvZXNuJ3Qgd29yayB3aXRoIGFuIGVtcHR5IHZhbHVlLlxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH0pLFxuXG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIHRoZSB2YWx1ZSBhc3NvY2lhdGVkIHdpdGggdGhlIHByb3ZpZGVkIGBrZXlgXG4gICAgICovXG4gICAgcmVtb3ZlOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbihrZXkpe1xuICAgICAgdmFyIHZhbDtcbiAgICAgIHJldHVybiB0aGlzLl9iYWNraW5nU3RvcmVcbiAgICAgICAgLnJlbW92ZShrZXkpXG4gICAgICAgIC5iaW5kKHRoaXMpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKGVudHJ5KSB7XG4gICAgICAgICAgaWYgKGVudHJ5KSB7XG4gICAgICAgICAgICB0aGlzLl9rZXlzID0gTS5kaXNqKHRoaXMuX2tleXMsIGtleSk7XG5cbiAgICAgICAgICAgIHZhbCA9IGVudHJ5LnZhbHVlKCk7XG4gICAgICAgICAgICBlbnRyeS5kaXNwb3NlKCk7XG4gICAgICAgICAgICByZXR1cm4gdmFsO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSksXG5cblxuICAgIGV4aXN0czogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oa2V5KXtcbiAgICAgIC8vIFVubGlrZSBpbiB0aGUgQ2FjaGluZ0RhdGFTdG9yZSwgd2hlcmUgd2UgaGF2ZSB0byBwZXJmb3JtIGV2aWN0aW9uIHJ1bGVzIGJlZm9yZVxuICAgICAgLy8gcmV0dXJuaW5nIHRoZSBhbnN3ZXIsIGhlcmUgd2UgY2FuIGp1c3QgZGVsZWdhdGUgc3RyYWlnaHQgdG8gdGhlIGJhY2tpbmcgc3RvcmUuXG4gICAgICByZXR1cm4gdGhpcy5fYmFja2luZ1N0b3JlLmV4aXN0cyhrZXkpO1xuICAgIH0pLFxuXG5cbiAgICBjbGVhcjogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oKXtcbiAgICAgIHJldHVybiB0aGlzLl9iYWNraW5nU3RvcmUuY2xlYXIoKTtcbiAgICB9KSxcblxuXG4gICAgX3NpZ25hbEV4cGlyeVNvb246IGZ1bmN0aW9uKGtleSwgc2VxdWVuY2UpIHtcbiAgICAgIF8uZGVmZXIoXy5iaW5kKGZ1bmN0aW9uKCl7XG4gICAgICAgIHRoaXMuX3NpZ25hbENoYW5uZWwucHVibGlzaCh0aGlzLCB7XG4gICAgICAgICAgbVQ6IFwiZXhwaXJlZFwiLFxuICAgICAgICAgIGtleToga2V5LFxuICAgICAgICAgIHNlcXVlbmNlOiBzZXF1ZW5jZVxuICAgICAgICB9KTtcbiAgICAgIH0sIHRoaXMpKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBTaWduYWxpbmdEYXRhU3RvcmU7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJibHVlYmlyZFwiKSxcbiAgcmVxdWlyZShcIm1vcmlcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL29wdGlvbnNcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL2NoYW5uZWwvY2hhbm5lbFwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvY2hhbm5lbC9jaGFpbmVkLWNoYW5uZWxcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL3NlcXVlbmNlci91bml0LXNlcXVlbmNlclwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvc2VxdWVuY2VyL2RlbGVnYXRpbmctZm9yd2FyZGluZy1zZXF1ZW5jZXJcIiksXG4gIHJlcXVpcmUoXCIuL2luLW1lbW9yeS1kYXRhLXN0b3JlXCIpLFxuICByZXF1aXJlKFwiLi9pbnRlcm5hbHMvZXhwaXJpbmctZW50cnlcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgU2NvcGVkQ29uZmlndXJhdGlvblJlc29sdmVyXG4pIHtcblxuICB2YXIgQ29uZmlndXJhdGlvbk1hZ2ljID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoQ29uZmlndXJhdGlvbk1hZ2ljLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKCkge31cbiAgfSk7XG5cbiAgXy5leHRlbmQoQ29uZmlndXJhdGlvbk1hZ2ljLCB7XG4gICAgcmVzb2x2ZUNvbmZpZzogZnVuY3Rpb24oc2NvcGVzLCBjb25maWdPYmplY3RzKSB7XG4gICAgICB2YXIgciA9IG5ldyBTY29wZWRDb25maWd1cmF0aW9uUmVzb2x2ZXIoKTtcbiAgICAgIF8uZWFjaChjb25maWdPYmplY3RzLCBmdW5jdGlvbihjKSB7XG4gICAgICAgIHIuYWRkKGMpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gci5yZXNvbHZlKHNjb3Blcyk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gQ29uZmlndXJhdGlvbk1hZ2ljO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiLi9jb25maWcvc2NvcGVkLWNvbmZpZ3VyYXRpb24tcmVzb2x2ZXJcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgUHJvbWlzZSxcbiAgTG9nZ2VyLFxuICBPcHRpb25zLFxuICBTdGF0ZUd1YXJkLFxuICBSdW50aW1lLFxuICBQcm9jZXNzS2VlcEFsaXZlXG4pIHtcbiAgdmFyIExvZyA9IExvZ2dlci5jcmVhdGUoXCJBcHBcIik7XG5cbiAgdmFyIEFwcCA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKEFwcC5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdGhpcy5fZ3VhcmQgPSBuZXcgU3RhdGVHdWFyZChbXCJzdGFydGluZ1wiLCBcInN0YXJ0ZWRcIiwgXCJzdG9wcGluZ1wiLCBcInN0b3BwZWRcIl0pO1xuICAgICAgdGhpcy5fcmF3Q29uZmlnID0gb3B0cy5nZXRPckVycm9yKFwiY29uZmlndXJhdGlvblwiKTtcbiAgICAgIHRoaXMuX2NvbmZpZyA9IE9wdGlvbnMuZnJvbU9iamVjdCh0aGlzLl9yYXdDb25maWcpO1xuXG4gICAgICAvLyBUaGUgZGVmYXVsdCBSdW50aW1lIGhhcyBzZW5zaWJsZSBkZWZhdWx0cy5cbiAgICAgIHRoaXMuX3J1bnRpbWUgPSBvcHRzLmdldE9yRWxzZUZuKFwicnVudGltZVwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSdW50aW1lKCk7XG4gICAgICB9KTtcblxuICAgICAgdGhpcy5fa2VlcEFsaXZlID0gbmV3IFByb2Nlc3NLZWVwQWxpdmUoe1xuICAgICAgICBzY2hlZHVsZXI6IHRoaXMuX3J1bnRpbWUuc2NoZWR1bGVyKClcbiAgICAgIH0pO1xuXG4gICAgICB2YXIgdXAgICA9IG9wdHMuZ2V0T3JFbHNlKFwidXBcIiksXG4gICAgICAgICAgZG93biA9IG9wdHMuZ2V0T3JFbHNlKFwiZG93blwiKTtcblxuICAgICAgaWYgKHVwKSB7XG4gICAgICAgIHRoaXMudXAgPSBQcm9taXNlLm1ldGhvZChfLmJpbmQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHVwLmNhbGwodGhpcywgdGhpcy5fY29uZmlnKTtcbiAgICAgICAgfSwgdGhpcykpO1xuICAgICAgfVxuXG4gICAgICBpZiAoZG93bikge1xuICAgICAgICB0aGlzLmRvd24gPSBQcm9taXNlLm1ldGhvZChfLmJpbmQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIGRvd24uY2FsbCh0aGlzLCB0aGlzLl9jb25maWcpO1xuICAgICAgICB9LCB0aGlzKSk7XG4gICAgICB9XG5cbiAgICB9LFxuXG4gICAgc3RhcnQ6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKCkge1xuICAgICAgTG9nLmRlYnVnKFwiU3RhcnRpbmcgQXBwXCIpO1xuICAgICAgdGhpcy5fZ3VhcmRcbiAgICAgICAgLmRlbnkoXCJzdGFydGluZ1wiKVxuICAgICAgICAuYXBwbHkoXCJzdGFydGluZ1wiKTtcblxuICAgICAgdGhpcy5fa2VlcEFsaXZlLnN0YXJ0KCk7XG4gICAgICBMb2cuZGVidWcoXCJDYWxsaW5nIEFwcCN1cCgpXCIpO1xuXG4gICAgICByZXR1cm4gdGhpcy51cCgpXG4gICAgICAgIC50aGVuKHRoaXMuX2d1YXJkLmFwcGx5QXN5bmNGbihcInN0YXJ0ZWRcIikpO1xuICAgIH0pLFxuXG4gICAgc3RvcDogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oKSB7XG4gICAgICBMb2cuZGVidWcoXCJTdG9wcGluZyBBcHBcIik7XG4gICAgICB0aGlzLl9ndWFyZFxuICAgICAgICAuZGVueShcInN0b3BwaW5nXCIpXG4gICAgICAgIC5hcHBseShcInN0b3BwaW5nXCIpO1xuXG4gICAgICB0aGlzLl9rZWVwQWxpdmUuc3RvcCgpO1xuICAgICAgTG9nLmRlYnVnKFwiQ2FsbGluZyBBcHAjZG93bigpXCIpO1xuXG4gICAgICByZXR1cm4gdGhpcy5kb3duKClcbiAgICAgICAgLnRoZW4odGhpcy5fZ3VhcmQuYXBwbHlBc3luY0ZuKFwic3RvcHBlZFwiKSk7XG4gICAgfSksXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSByZXF1ZXN0ZWQgY29uZmlndXJhdGlvbiB2YWx1ZSwgb3IgdGhyb3dzIGFuIGVycm9yLlxuICAgICAqIEBwYXJhbSBrZXkgdGhlIGNvbmZpZ3VyYXRpb24ga2V5IHJlcXVlc3QgZnJvbSB0aGUgQ29uZmlndXJhdGlvbi5cbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fVxuICAgICAqL1xuICAgIGNvbmZpZzogZnVuY3Rpb24oa2V5KSB7XG4gICAgICByZXR1cm4gdGhpcy5fY29uZmlnLmdldE9yRXJyb3Ioa2V5KTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogVE9ETzogRG9jLiBTdWJjbGFzcyBzaG91bGQgb3ZlcnJpZGUuXG4gICAgICovXG4gICAgdXA6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKCkge30pLFxuXG4gICAgLyoqXG4gICAgICogVE9ETzogRG9jLiBTdWJjbGFzcyBzaG91bGQgb3ZlcnJpZGUuXG4gICAgICovXG4gICAgZG93bjogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oKSB7fSlcbiAgfSk7XG5cbiAgcmV0dXJuIEFwcDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcImJsdWViaXJkXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9sb2dnaW5nL2xvZ2dlclwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvc3RhdGUtZ3VhcmRcIiksXG4gIHJlcXVpcmUoXCIuLi9ydW50aW1lXCIpLFxuICByZXF1aXJlKFwiLi9pbnRlcm5hbC9wcm9jZXNzLWtlZXAtYWxpdmVcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgUHJvbWlzZSxcbiAgTSxcbiAgTG9nZ2VyLFxuICBPcHRpb25zLFxuICBVVUlELFxuICBEZWxlZ2F0aW5nRm9yd2FyZGluZ1NlcXVlbmNlcixcbiAgVW5pdFNlcXVlbmNlcixcbiAgSW5NZW1vcnlGaWJlcixcbiAgTWFpbGJveCxcbiAgRGlzcGF0Y2hlcixcbiAgU2lnbmFsaW5nRGF0YVN0b3JlLFxuICBQZXJpb2RpYyxcbiAgQ2xvY2tTZXF1ZW5jZXIsXG4gIFN5c3RlbUNsb2NrLFxuICBSdW50aW1lXG4gICkge1xuXG4gIHZhciBFeGNoYW5nZSA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIHZhciBNU0dfU0VORCAgICAgICAgICAgICA9IEV4Y2hhbmdlLk1TR19TRU5EICAgICAgICAgICAgID0gXCJzZW5kXCIsXG4gICAgICBNU0dfU0VORF9BTkRfUkVDRUlWRSA9IEV4Y2hhbmdlLk1TR19TRU5EX0FORF9SRUNFSVZFID0gXCJzZW5kQW5kUmVjZWl2ZVwiLFxuICAgICAgTVNHX1JFUExZICAgICAgICAgICAgPSBFeGNoYW5nZS5NU0dfUkVQTFkgICAgICAgICAgICA9IFwicmVwbHlcIjtcblxuICAvLyA3LjUgc2Vjb25kcyBpcyByZWFzb25hYmxlLCB5ZXM/XG4gIHZhciBERUZBVUxUX1JFUExZX1RJTUVPVVQgPSA3NTAwO1xuXG4gIHZhciBMb2cgPSBMb2dnZXIuY3JlYXRlKFwiRXhjaGFuZ2VcIik7XG5cblxuICBfLmV4dGVuZChFeGNoYW5nZS5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuXG4gICAgICB0aGlzLl9pZGVudGl0eSA9IG9wdHMuZ2V0T3JFbHNlKFwiaWRlbnRpdHlcIiwgVVVJRC52NCgpKTtcblxuICAgICAgdGhpcy5fcnVudGltZSA9IG9wdHMuZ2V0T3JFbHNlRm4oXCJydW50aW1lXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gbmV3IFJ1bnRpbWUoKTtcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLl9tYWlsYm94RmliZXJEZWxlZ2F0ZSA9IHtcbiAgICAgICAgcmVjZWl2ZUZpYmVyTWVzc2FnZTogdGhpcy5fcmVjZWl2ZU1haWxib3hGaWJlck1lc3NhZ2UuYmluZCh0aGlzKVxuICAgICAgfTtcblxuICAgICAgdGhpcy5fbWFpbGJveGVzID0gTS5oYXNoX21hcCgpO1xuXG4gICAgICB0aGlzLl9maWJlciAgICAgPSBvcHRzLmdldE9yRWxzZUZuKFwiZmliZXJcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBuZXcgSW5NZW1vcnlGaWJlcigpO1xuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuX2ZpYmVyLnJlZ2lzdGVyRW50aXR5KHtcbiAgICAgICAgaWRlbnRpdHk6IHRoaXMuX2lkZW50aXR5LFxuICAgICAgICBkZWxlZ2F0ZTogdGhpc1xuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuX21haWxib3hEaXNwYXRjaGVyID0gbmV3IERpc3BhdGNoZXIoe1xuICAgICAgICBkZWxlZ2F0ZTogdGhpcyxcbiAgICAgICAgcHJlZml4OiBcIl9vbk1ieFwiXG4gICAgICB9KTtcblxuICAgICAgdmFyIHVzZWREZWZhdWx0Q2xvY2sgPSBmYWxzZTtcblxuICAgICAgLy8gRm9yIHJlcXVlc3Rlci1wcm92aWRlZCByZXF1ZXN0SWQgdG8gbWVzc2FnZUlkIG1hcHBpbmcuXG4gICAgICAvLyBVc2VkIGZvciBjYW5jZWxsaW5nIG91dHN0YW5kaW5nIHNlbmRBbmRSZWNlaXZlIHJlcXVlc3RzLlxuICAgICAgdGhpcy5fcmVxVG9Nc2cgPSBNLmhhc2hfbWFwKCk7XG5cbiAgICAgIC8vIERhdGEgc3RvcmUgZm9yIHBlbmRpbmcgcmVxdWVzdHNcbiAgICAgIHRoaXMuX291dHN0YW5kaW5nUmVxdWVzdHMgPSBuZXcgU2lnbmFsaW5nRGF0YVN0b3JlKHtcbiAgICAgICAgdHRsOiBvcHRzLmdldE9yRWxzZShcInJlcGx5VGltZW91dFwiLCBERUZBVUxUX1JFUExZX1RJTUVPVVQpLFxuICAgICAgICBzZXF1ZW5jZXI6IG5ldyBDbG9ja1NlcXVlbmNlcih7XG4gICAgICAgICAgY2xvY2s6IG9wdHMuZ2V0T3JFbHNlRm4oXCJjbG9ja1wiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHVzZWREZWZhdWx0Q2xvY2sgPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBTeXN0ZW1DbG9jaygpO1xuICAgICAgICAgIH0pLFxuICAgICAgICAgIC8vIEhheCAtIFNpbmNlIHdlIHdhbnQgdGltZSB0byBiZSBhc3luYywgYnV0IHByb3ZpZGUgYSBkZWZhdWx0IHN5c3RlbSBjbG9ja1xuICAgICAgICAgIC8vIHdlIG5lZWQgdG8gZ2V0IHRoZSBpbml0aWFsIGNsb2NrIHNlcXVlbmNlIHN5bmMsIGJ5IGJ5cGFzc2luZyB0aGUgY2xvY2sgY2FsbC5cbiAgICAgICAgICAvLyBJZiB5b3UgcHJvdmlkZSBhbiBhc3luYyBjbG9jaywgeW91IHNob3VsZCBlaXRoZXIgcHJvdmlkZSBhbiBpbml0aWFsIHRpbWUsIG9yXG4gICAgICAgICAgLy8gZW5zdXJlIHRoYXQgdGhlIGZpcnN0IGdldFRpbWUgaGFzIHJlc29sdmVkIGJlZm9yZSBpbnN0YW50aWF0aW5nIHRoZSBleGNoYW5nZS5cbiAgICAgICAgICAvLyBPUiwgaW4gdGhlIGZ1dHVyZSwgd2UgaGF2ZSB0byBhZGQgYSBzdGFydCgpL3N0b3AoKSB0byBFeGNoYW5nZS5cbiAgICAgICAgICBpbml0aWFsU2VxdWVuY2U6IG9wdHMuZ2V0T3JFbHNlKFwiaW5pdGlhbFNlcXVlbmNlXCIsICh1c2VkRGVmYXVsdENsb2NrID8gK25ldyBEYXRlKCkgOiB1bmRlZmluZWQpKVxuICAgICAgICB9KVxuICAgICAgfSk7XG5cbiAgICAgIC8vIERpc3BhdGNoZXMgc3RvcmUgc2lnbmFscyAoZS5nLiwgZXhwaXJ5KVxuICAgICAgdGhpcy5fZXhwaXJ5RGlzcGF0Y2hlciA9IG5ldyBEaXNwYXRjaGVyKHtcbiAgICAgICAgZGVsZWdhdGU6IHRoaXMsXG4gICAgICAgIHByZWZpeDogXCJfb25TdG9yZVNpZ25hbFwiLFxuICAgICAgICBsaXN0ZW46IHRoaXMuX291dHN0YW5kaW5nUmVxdWVzdHMuc2lnbmFsQ2hhbm5lbCgpXG4gICAgICB9KTtcblxuICAgICAgdGhpcy5fY29tcG9zaXRlU2VxID0gbmV3IERlbGVnYXRpbmdGb3J3YXJkaW5nU2VxdWVuY2VyKHtcbiAgICAgICAgZGVsZWdhdGU6IG5ldyBVbml0U2VxdWVuY2VyKCksXG4gICAgICAgIHRhcmdldHM6IFt0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RzLnNlcXVlbmNlcigpLCB0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RzLnNlbnRyeVNlcXVlbmNlcigpXVxuICAgICAgfSlcblxuICAgICAgLy8gVGhpcyBndXkgdHJpZ2dlcnMgcGVyaW9kaWMgZXhwaXJ5IGNoZWNrcyBpbiB0aGUgc3RvcmVcbiAgICAgIHRoaXMuX2NoZWNrRXhwaXJ5ID0gbmV3IFBlcmlvZGljKHtcbiAgICAgICAgc2NoZWR1bGVyOiB0aGlzLl9ydW50aW1lLnNjaGVkdWxlcigpLFxuICAgICAgICB0YXNrOiBfLmJpbmQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbXBvc2l0ZVNlcS5hZHZhbmNlKCk7XG4gICAgICAgIH0sIHRoaXMpLFxuICAgICAgICBpbnRlcnZhbDogb3B0cy5nZXRPckVsc2UoXCJleHBpcnlJbnRlcnZhbFwiLCAxMDAwKVxuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuX2NoZWNrRXhwaXJ5LnN0YXJ0KCk7XG4gICAgfSxcblxuXG4gICAgZGlzcG9zZTogZnVuY3Rpb24oKSB7XG4gICAgICAvLyBUT0RPOiBDYW5jZWwgb3V0c3RhbmRpbmcgcmVxdWVzdHNcblxuICAgICAgdGhpcy5fZXhwaXJ5RGlzcGF0Y2hlci5kaXNwb3NlKCk7XG5cbiAgICAgIHRoaXMuX291dHN0YW5kaW5nUmVxdWVzdHMuY2xlYXIoKTtcblxuICAgICAgLy8gVE9ETzogRGlzcG9zZSBhbGwgdGhlIHRoaW5nc1xuICAgICAgdGhpcy5fY2hlY2tFeHBpcnkuZGlzcG9zZSgpO1xuICAgIH0sXG5cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkcyBhIE1haWxib3ggZm9yIHRoZSBwcm92aWRlZCBgcmVxdWVzdGVySWRlbnRpdHlgLiBUaGVcbiAgICAgKiBgUmVxdWVzdGVySWRlbnRpdHlgIG11c3QgbmV2ZXIgaGF2ZSBiZWVuIHVzZWQgZm9yIHJlcXVlc3RpbmdcbiAgICAgKiBhIG1haWxib3ggcHJldmlvdXNseS5cbiAgICAgKlxuICAgICAqIFdlIGF0dGVtcHQgdG8gdmFsaWRhdGUgdW5pcXVlIG1haWxib3ggbmFtZXMsIGJ1dCBiZWNhdXNlIG1haWxib3ggbmFtZXNcbiAgICAgKiBhcmUgZ2xvYmFsIGFuZCB0aGVyZSBpcyBubyBjaGVja2luZyBiZXR3ZWVuIGZpYmVycywgaXQncyBvbmx5IGEgYmVzdC1lZmZvcnQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcmVxdWVzdGVySWRlbnRpdHlcbiAgICAgKiBAcmV0dXJucyB7TWFpbGJveH1cbiAgICAgKi9cbiAgICBtYWlsYm94OiBmdW5jdGlvbihyZXF1ZXN0ZXJJZGVudGl0eSkge1xuICAgICAgdGhpcy5fYXNzZXJ0VW5pcXVlT3duZXIocmVxdWVzdGVySWRlbnRpdHkpO1xuXG4gICAgICB2YXIgbWFpbGJveCA9IG5ldyBNYWlsYm94KHtcbiAgICAgICAgZXhjaGFuZ2U6ICAgICAgdGhpcyxcbiAgICAgICAgb3duZXJJZGVudGl0eTogcmVxdWVzdGVySWRlbnRpdHlcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLl9tYWlsYm94ZXMgPSBNLmFzc29jKHRoaXMuX21haWxib3hlcywgcmVxdWVzdGVySWRlbnRpdHksIG1haWxib3gpO1xuXG4gICAgICB0aGlzLl9maWJlci5yZWdpc3RlckVudGl0eSh7XG4gICAgICAgIGlkZW50aXR5OiByZXF1ZXN0ZXJJZGVudGl0eSxcbiAgICAgICAgZGVsZWdhdGU6IHRoaXMuX21haWxib3hGaWJlckRlbGVnYXRlXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIG1haWxib3g7XG4gICAgfSxcblxuXG4gICAgc2VuZDogZnVuY3Rpb24oZW52KSB7XG4gICAgICBlbnYgPSBPcHRpb25zLmZyb21PYmplY3QoZW52KTtcblxuICAgICAgcmV0dXJuIHRoaXMuX2ZpYmVyLnNlbmQoe1xuICAgICAgICBmcm9tOiAgZW52LmdldE9yRXJyb3IoXCJmcm9tXCIpLFxuICAgICAgICB0bzogICAgZW52LmdldE9yRXJyb3IoXCJ0b1wiKSxcbiAgICAgICAgYm9keTogIGVudi5nZXRPckVycm9yKFwiYm9keVwiKSxcbiAgICAgICAgbVQ6ICAgIE1TR19TRU5ELFxuICAgICAgICBtc2dJZDogVVVJRC52NCgpXG4gICAgICB9KTtcbiAgICB9LFxuXG5cbiAgICByZXBseTogZnVuY3Rpb24oZW52KSB7XG4gICAgICBlbnYgPSBPcHRpb25zLmZyb21PYmplY3QoZW52KTtcbiAgICAgIHJldHVybiB0aGlzLl9maWJlci5zZW5kKHtcbiAgICAgICAgZnJvbTogICBlbnYuZ2V0T3JFcnJvcihcImZyb21cIiksXG4gICAgICAgIHRvOiAgICAgZW52LmdldE9yRXJyb3IoXCJ0b1wiKSxcbiAgICAgICAgYm9keTogICBlbnYuZ2V0T3JFcnJvcihcImJvZHlcIiksXG4gICAgICAgIG1UOiAgICAgTVNHX1JFUExZLFxuICAgICAgICBtc2dJZDogIFVVSUQudjQoKSxcbiAgICAgICAgck1zZ0lkOiBlbnYuZ2V0T3JFcnJvcihcInJNc2dJZFwiKVxuICAgICAgfSk7XG4gICAgfSxcblxuXG4gICAgc2VuZEFuZFJlY2VpdmU6IGZ1bmN0aW9uKGVudiwgb3B0cykge1xuICAgICAgZW52ICA9IE9wdGlvbnMuZnJvbU9iamVjdChlbnYpO1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcblxuICAgICAgdmFyIG1zZ0lkID0gVVVJRC52NCgpLFxuICAgICAgICAgIHJlcUlkICAgID0gb3B0cy5nZXRPckVycm9yKFwicmVxSWRcIiksXG4gICAgICAgICAgZGVmZXJyZWQgPSBkZWZlcigpLFxuICAgICAgICAgIGZpYkVudiAgID0ge1xuICAgICAgICAgICAgZnJvbTogIGVudi5nZXRPckVycm9yKFwiZnJvbVwiKSxcbiAgICAgICAgICAgIHRvOiAgICBlbnYuZ2V0T3JFcnJvcihcInRvXCIpLFxuICAgICAgICAgICAgYm9keTogIGVudi5nZXRPckVycm9yKFwiYm9keVwiKSxcbiAgICAgICAgICAgIG1UOiAgICBNU0dfU0VORF9BTkRfUkVDRUlWRSxcbiAgICAgICAgICAgIG1zZ0lkOiBtc2dJZFxuICAgICAgICAgIH0sXG4gICAgICAgICAgcmVxICAgICAgPSB7XG4gICAgICAgICAgICByZXFJZDogICAgcmVxSWQsXG4gICAgICAgICAgICBkZWZlcnJlZDogZGVmZXJyZWQsXG4gICAgICAgICAgICBmaWJFbnY6ICAgZmliRW52XG4gICAgICAgICAgfTtcblxuICAgICAgdGhpcy5fcmVxVG9Nc2cgPSBNLmFzc29jKHRoaXMuX3JlcVRvTXNnLCByZXFJZCwgbXNnSWQpO1xuXG4gICAgICByZXR1cm4gdGhpc1xuICAgICAgICAuX291dHN0YW5kaW5nUmVxdWVzdHNcbiAgICAgICAgLnB1dChtc2dJZCwgcmVxLCB7dHRsOiBvcHRzLmdldE9yRWxzZShcInJlcGx5VGltZW91dFwiKX0pXG4gICAgICAgIC5iaW5kKHRoaXMpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLl9maWJlci5zZW5kKGZpYkVudik7XG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiByZXEuZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIGNhbmNlbFNlbmRBbmRSZWNlaXZlOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbihyZXFJZCkge1xuICAgICAgdmFyIG1zZ0lkID0gTS5nZXQodGhpcy5fcmVxVG9Nc2csIHJlcUlkKTtcblxuICAgICAgaWYgKG1zZ0lkKSB7XG4gICAgICAgIExvZy5kZWJ1ZyhcIkNhbmNlbGluZyByZXF1ZXN0XCIsIHJlcUlkLCBcIndpdGggbXNnSWRcIiwgbXNnSWQpO1xuICAgICAgICB0aGlzLl9yZXFUb01zZyA9IE0uZGlzc29jKHRoaXMuX3JlcVRvTXNnLCByZXFJZCk7XG5cbiAgICAgICAgcmV0dXJuIFByb21pc2VcbiAgICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX291dHN0YW5kaW5nUmVxdWVzdHMucmVtb3ZlKG1zZ0lkKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlcSkge1xuICAgICAgICAgICAgaWYgKHJlcSkge1xuICAgICAgICAgICAgICByZXEuZGVmZXJyZWQucmVqZWN0KG5ldyBQcm9taXNlLkNhbmNlbGxhdGlvbkVycm9yKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBMb2cud2FybihcIlRyaWVkIHRvIGNhbmNlbCByZXF1ZXN0LCBidXQgbm8gb3VzdGFuZGluZyByZXF1ZXN0IHdpdGggdGhhdCBJRCBmb3VuZDtcIiwgcmVxSWQpO1xuICAgICAgfVxuICAgIH0pLFxuXG5cbiAgICBfYXNzZXJ0VW5pcXVlT3duZXI6IGZ1bmN0aW9uKGlkZW50aXR5KSB7XG4gICAgICBpZiAoTS5nZXQodGhpcy5fbWFpbGJveGVzLCBpZGVudGl0eSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTWFpbGJveCByZWdpc3RyYXRpb24gcmVxdWlyZXMgYSB1bmlxdWUgaWRlbnRpdHlcIik7XG4gICAgICB9XG4gICAgfSxcblxuXG4gICAgLyoqXG4gICAgICogRmliZXIgZGVsZWdhdGUgcHJvdG9jb2wgbWV0aG9kIGZvciBhIG1lc3NhZ2UgYm91bmQgZm9yIGEgTWFpbGJveCBvd25lZCBieVxuICAgICAqIHRoaXMgZXhjaGFuZ2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZW52XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfcmVjZWl2ZU1haWxib3hGaWJlck1lc3NhZ2U6IGZ1bmN0aW9uKGVudikge1xuICAgICAgdGhpcy5fbWFpbGJveERpc3BhdGNoZXIuZGlzcGF0Y2goZW52KTtcbiAgICB9LFxuXG5cbiAgICBfb25NYnhTZW5kOiBmdW5jdGlvbihlbnYpIHtcbiAgICAgIHZhciBvRW52ICAgICA9IE9wdGlvbnMuZnJvbU9iamVjdChlbnYpLFxuICAgICAgICAgIGlkZW50aXR5ID0gb0Vudi5nZXRPckVsc2UoXCJ0b1wiKSxcbiAgICAgICAgICBib2R5ICAgICA9IG9FbnYuZ2V0T3JFbHNlKFwiYm9keVwiKTtcblxuICAgICAgaWYgKCEoaWRlbnRpdHkgfHwgYm9keSkpIHtcbiAgICAgICAgTG9nLmluZm8oXCJFeGNoYW5nZSByZWNlaXZlZCBhIG1lc3NhZ2Ugd2l0aCBtaXNzaW5nIGVudmVsb3BlIGluZm9ybWF0aW9uXCIsIGVudik7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFyIG1ib3ggPSBNLmdldCh0aGlzLl9tYWlsYm94ZXMsIGlkZW50aXR5KTtcbiAgICAgIGlmIChtYm94KSB7XG4gICAgICAgIG1ib3guX3JlY2VpdmVPbmVTaG90KGVudik7XG4gICAgICB9XG4gICAgfSxcblxuICAgIC8vIFRPRE86IFNob3VsZCB0aGlzIGdvIGFsb25nIHRoZSBtYWlsYm94IGluZ3Jlc3MgY2hhbm5lbD9cbiAgICAvLyBPciBzaG91bGQgaXQgYmUgY2ItYmFzZWQ/XG4gICAgX29uTWJ4U2VuZEFuZFJlY2VpdmU6IGZ1bmN0aW9uKGVudikge1xuICAgICAgdmFyIG9FbnYgPSBPcHRpb25zLmZyb21PYmplY3QoZW52KSxcbiAgICAgICAgICBpZGVudGl0eSA9IG9FbnYuZ2V0T3JFbHNlKFwidG9cIiksXG4gICAgICAgICAgYm9keSA9IG9FbnYuZ2V0T3JFbHNlKFwiYm9keVwiKTtcblxuICAgICAgaWYgKCEoaWRlbnRpdHkgfHwgYm9keSkpIHtcbiAgICAgICAgTG9nLmluZm8oXCJFeGNoYW5nZSByZWNlaXZlZCBhIG1lc3NhZ2Ugd2l0aCBtaXNzaW5nIGVudmVsb3BlIGluZm9ybWF0aW9uXCIsIGVudik7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFyIG1ib3ggPSBNLmdldCh0aGlzLl9tYWlsYm94ZXMsIGlkZW50aXR5KTtcbiAgICAgIGlmIChtYm94KSB7XG4gICAgICAgIG1ib3guX3JlY2VpdmVSZXF1ZXN0UmVwbHkoZW52KTtcbiAgICAgIH1cbiAgICB9LFxuXG5cbiAgICBfb25NYnhSZXBseTogZnVuY3Rpb24oZW52KSB7XG4gICAgICB2YXIgb0VudiAgICAgPSBPcHRpb25zLmZyb21PYmplY3QoZW52KSxcbiAgICAgICAgICByTXNnSWQgICA9IG9FbnYuZ2V0T3JFbHNlKFwick1zZ0lkXCIpO1xuXG5cblxuICAgICAgLy8gRG9uJ3QgZGlzcGF0Y2ggdmV0dGVkIHJlcGxpZXMuIEp1c3QgZnVsZmlsbCB0aGUgcHJvbWlzZVxuICAgICAgUHJvbWlzZVxuICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAudGhlbihmdW5jdGlvbigpe1xuICAgICAgICAgIHJldHVybiB0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RzLnJlbW92ZShyTXNnSWQpO1xuICAgICAgICB9KVxuICAgICAgICAudGhlbihmdW5jdGlvbihyZXF1ZXN0KSB7XG4gICAgICAgICAgaWYgKHJlcXVlc3QpIHtcbiAgICAgICAgICAgIHRoaXMuX3JlcVRvTXNnID0gTS5kaXNzb2ModGhpcy5fcmVxVG9Nc2csIHJlcXVlc3QucmVxSWQpO1xuICAgICAgICAgICAgcmVxdWVzdC5kZWZlcnJlZC5yZXNvbHZlKGVudik7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9LFxuXG5cbiAgICAvKipcbiAgICAgKiBGaXJlZCB3aGVuIGEgcmVxdWVzdCBpbiB0aGUgb3V0c3RhbmRpbmcgcmVxdWVzdHMgc3RvcmUgaXMgcGFzdCBkdWUuXG4gICAgICovXG4gICAgX29uU3RvcmVTaWduYWxFeHBpcmVkOiBmdW5jdGlvbihzaWcpIHtcbiAgICAgIExvZy5kZWJ1ZyhcIkV4cGlyZWQgZW50cnkgaW4gc3RvcmVcIiwgc2lnKTtcbiAgICAgIFByb21pc2VcbiAgICAgICAgLmJpbmQodGhpcylcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX291dHN0YW5kaW5nUmVxdWVzdHMucmVtb3ZlKHNpZy5rZXkpO1xuICAgICAgICB9KVxuICAgICAgICAudGhlbihmdW5jdGlvbihyZXF1ZXN0KSB7XG4gICAgICAgICAgaWYgKHJlcXVlc3QpIHtcbiAgICAgICAgICAgIHRoaXMuX3JlcVRvTXNnID0gTS5kaXNzb2ModGhpcy5fcmVxVG9Nc2csIHJlcXVlc3QucmVxSWQpO1xuICAgICAgICAgICAgcmVxdWVzdC5kZWZlcnJlZC5yZWplY3QobmV3IFByb21pc2UuVGltZW91dEVycm9yKCkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSxcblxuXG4gICAgLyoqXG4gICAgICogRmliZXIgZGVsZWdhdGUgcHJvdG9jb2wgbWV0aG9kIGZvciBhIG1lc3NhZ2UgYm91bmQgZm9yIHRoaXMgRXhjaGFuZ2UgZGlyZWN0bHkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZW52XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICByZWNlaXZlRmliZXJNZXNzYWdlOiBmdW5jdGlvbihlbnYpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vdCBpbXBsZW1lbnRlZFwiKTtcbiAgICB9XG4gIH0pO1xuXG5cbiAgdmFyIGRlZmVyID0gZnVuY3Rpb24oKXtcbiAgICB2YXIgcmVzLCByZWo7XG4gICAgdmFyIHAgPSBuZXcgUHJvbWlzZShmdW5jdGlvbigpIHtcbiAgICAgIHJlcyA9IGFyZ3VtZW50c1swXTtcbiAgICAgIHJlaiA9IGFyZ3VtZW50c1sxXTtcbiAgICB9KTtcblxuICAgIHJldHVybiB7XG4gICAgICBwcm9taXNlOiBwLFxuICAgICAgcmVzb2x2ZTogcmVzLFxuICAgICAgcmVqZWN0OiByZWpcbiAgICB9O1xuICB9O1xuXG4gIHJldHVybiBFeGNoYW5nZTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcImJsdWViaXJkXCIpLFxuICByZXF1aXJlKFwibW9yaVwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvbG9nZ2luZy9sb2dnZXJcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL29wdGlvbnNcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL3V1aWRcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL3NlcXVlbmNlci9kZWxlZ2F0aW5nLWZvcndhcmRpbmctc2VxdWVuY2VyXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9zZXF1ZW5jZXIvdW5pdC1zZXF1ZW5jZXJcIiksXG4gIHJlcXVpcmUoXCIuL2ZpYmVyL2luLW1lbW9yeS1maWJlclwiKSxcbiAgcmVxdWlyZShcIi4vaW50ZXJuYWxzL21haWxib3hcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL2Rpc3BhdGNoZXJcIiksXG4gIHJlcXVpcmUoXCIuLi9zdG9yYWdlL3NpZ25hbGluZy1kYXRhLXN0b3JlXCIpLFxuICByZXF1aXJlKFwiLi4vdXRpbC9wZXJpb2RpY1wiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvc2VxdWVuY2VyL2Nsb2NrLXNlcXVlbmNlclwiKSxcbiAgcmVxdWlyZShcIi4uL3RpbWUvY2xvY2svc3lzdGVtLWNsb2NrXCIpLFxuICByZXF1aXJlKFwiLi4vcnVudGltZVwiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBQcm9taXNlLFxuICBNLFxuICBPcHRpb25zLFxuICBVVUlELFxuICBTdGF0ZUd1YXJkLFxuICBMb2dnZXIsXG4gIERpc3BhdGNoZXJcbikge1xuXG4gIHZhciBDb3VyaWVyID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgdmFyIE1TR19SRVBMWSA9IENvdXJpZXIuTVNHX1JFUExZID0gXCJjUmVwbHlcIjtcblxuICB2YXIgTG9nID0gTG9nZ2VyLmNyZWF0ZShcIkNvdXJpZXJcIik7XG5cbiAgXy5leHRlbmQoQ291cmllci5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuXG4gICAgICB0aGlzLl9pZCAgICAgICAgID0gVVVJRC52NCgpO1xuICAgICAgdGhpcy5fZGVsZWdhdGUgICA9IG9wdHMuZ2V0T3JFcnJvcihcImRlbGVnYXRlXCIpO1xuICAgICAgdGhpcy5fbWFpbGJveCAgICA9IG9wdHMuZ2V0T3JFcnJvcihcIm1haWxib3hcIik7XG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkID0gbmV3IFN0YXRlR3VhcmQoW1wiZGlzcG9zZWRcIl0pO1xuXG4gICAgICBfLmJpbmRBbGwodGhpcywgXCJfb25PbmVTaG90TWVzc2FnZVwiLCBcIl9vblJlcXVlc3RSZXBseU1lc3NhZ2VcIiwgXCJfZGVmYXVsdENvbnRleHREZWxlZ2F0ZVwiKTtcblxuICAgICAgdGhpcy5fY29udGV4dERlbGVnYXRlID0gb3B0cy5nZXRPckVsc2UoXCJjb250ZXh0RGVsZWdhdGVcIiwgdGhpcy5fZGVmYXVsdENvbnRleHREZWxlZ2F0ZSk7XG5cbiAgICAgIHRoaXMuX29uZVNob3REaXNwYXRjaGVyID0gbmV3IERpc3BhdGNoZXIoe1xuICAgICAgICBkZWxlZ2F0ZTogdGhpcy5fZGVsZWdhdGUsXG4gICAgICAgIHByZWZpeDogb3B0cy5nZXRPckVsc2UoXCJvbmVTaG90UHJlZml4XCIsIFwib25Nc2dcIiksXG4gICAgICAgIGNvbnRleHREZWxlZ2F0ZTogdGhpcy5fY29udGV4dERlbGVnYXRlXG4gICAgICB9KTtcblxuICAgICAgdGhpcy5fcmVxdWVzdFJlcGx5RGlzcGF0Y2hlciA9IG5ldyBEaXNwYXRjaGVyKHtcbiAgICAgICAgZGVsZWdhdGU6IHRoaXMuX2RlbGVnYXRlLFxuICAgICAgICBwcmVmaXg6IG9wdHMuZ2V0T3JFbHNlKFwicmVxdWVzdFJlcGx5UHJlZml4XCIsIFwib25SZXFcIiksXG4gICAgICAgIGNvbnRleHREZWxlZ2F0ZTogdGhpcy5fY29udGV4dERlbGVnYXRlXG4gICAgICB9KTtcblxuICAgICAgdGhpcy5fc3VicyA9IE0udmVjdG9yKFxuICAgICAgICB0aGlzLl9tYWlsYm94Lm9uZVNob3RDaGFubmVsKCkuc3Vic2NyaWJlKHRoaXMuX29uT25lU2hvdE1lc3NhZ2UpLFxuICAgICAgICB0aGlzLl9tYWlsYm94LnJlcXVlc3RSZXBseUNoYW5uZWwoKS5zdWJzY3JpYmUodGhpcy5fb25SZXF1ZXN0UmVwbHlNZXNzYWdlKVxuICAgICAgKTtcbiAgICB9LFxuXG5cbiAgICBpZDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5faWQ7XG4gICAgfSxcblxuICAgIHNlbmQ6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKHRvLCBtc2cpIHtcbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQuZGVueShcImRpc3Bvc2VkXCIpO1xuXG4gICAgICByZXR1cm4gdGhpcy5fbWFpbGJveC5zZW5kKHtcbiAgICAgICAgdG86IHRvLFxuICAgICAgICBib2R5OiBtc2dcbiAgICAgIH0pO1xuICAgIH0pLFxuXG4gICAgc2VuZEFuZFJlY2VpdmU6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKHRvLCBtc2csIG9wdHMpIHtcbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQuZGVueShcImRpc3Bvc2VkXCIpO1xuXG4gICAgICByZXR1cm4gdGhpcy5fbWFpbGJveFxuICAgICAgICAuc2VuZEFuZFJlY2VpdmUoe1xuICAgICAgICAgIHRvOiB0byxcbiAgICAgICAgICBib2R5OiBtc2dcbiAgICAgICAgfSwgb3B0cylcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG5cbiAgICAgICAgICBpZiAocmVzLmJvZHkgJiYgcmVzLmJvZHkubVQgPT09IE1TR19SRVBMWSAmJiByZXMuYm9keS5ib2R5KSB7XG4gICAgICAgICAgICAvLyBVbndyYXAgdGhlIHJlbW90ZSBtZXNzYWdlXG4gICAgICAgICAgICBpZiAocmVzLmJvZHkuYm9keS5lcnIpIHtcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKHJlcy5ib2R5LmJvZHkuZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXMuYm9keS5ib2R5LnJlcztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gU29tZW9uZSBpcyBtaXNiZWhhdmluZ1xuICAgICAgICAgICAgTG9nLndhcm4oXCJSZWNlaXZlZCBzZW5kQW5kUmVjZWl2ZSByZXBseSwgYnV0IGl0IGlzbid0IENvdXJpZXItY29tcGF0aWJsZVwiLCB0aGlzLl9tYWlsYm94Lm93bmVySWRlbnRpdHkoKSwgcmVzKTtcbiAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH0pLFxuXG4gICAgZGlzcG9zZTogZnVuY3Rpb24oKSB7XG4gICAgICBpZiAodGhpcy5fc3RhdGVHdWFyZC5hcHBsaWVkKFwiZGlzcG9zZWRcIikpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG5cbiAgICAgIE0uZWFjaCh0aGlzLl9zdWJzLCBmdW5jdGlvbihzdWIpIHtcbiAgICAgICAgc3ViLmRpc3Bvc2UoKTtcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLl9zdWJzICAgICA9IG51bGw7XG4gICAgICB0aGlzLl9tYWlsYm94ICA9IG51bGw7XG4gICAgICB0aGlzLl9kZWxlZ2F0ZSA9IG51bGw7XG5cbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQuYXBwbHkoXCJkaXNwb3NlZFwiKTtcbiAgICB9LFxuXG4gICAgX2RlZmF1bHRDb250ZXh0RGVsZWdhdGU6IGZ1bmN0aW9uKG1UeXBlZCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbWFpbGJveDogdGhpcy5fbWFpbGJveFxuICAgICAgfTtcbiAgICB9LFxuXG4gICAgX29uT25lU2hvdE1lc3NhZ2U6IGZ1bmN0aW9uKG1zZykge1xuICAgICAgdGhpcy5fb25lU2hvdERpc3BhdGNoZXIuZGlzcGF0Y2gobXNnLmJvZHksIG1zZyk7XG4gICAgfSxcblxuXG4gICAgX29uUmVxdWVzdFJlcGx5TWVzc2FnZTogZnVuY3Rpb24obXNnKSB7XG4gICAgICB0aGlzLl9yZXF1ZXN0UmVwbHlEaXNwYXRjaGVyXG4gICAgICAgIC5kaXNwYXRjaEFzeW5jKG1zZy5ib2R5LCBtc2cpXG4gICAgICAgIC5iaW5kKHtcbiAgICAgICAgICBtYm94OiB0aGlzLl9tYWlsYm94LFxuICAgICAgICAgIGVycjogbnVsbCxcbiAgICAgICAgICByZXN1bHQ6IG51bGxcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtcbiAgICAgICAgICB0aGlzLnJlc3VsdCA9IHJlc3VsdDtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdWdodChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICB0aGlzLmVyciA9IGVyci5tZXNzYWdlO1xuICAgICAgICB9KVxuICAgICAgICAubGFzdGx5KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHRoaXMubWJveC5yZXBseShtc2cubXNnSWQsIHtcbiAgICAgICAgICAgIHRvOiBtc2cuZnJvbSxcbiAgICAgICAgICAgIGJvZHk6IHtcbiAgICAgICAgICAgICAgbVQ6IE1TR19SRVBMWSxcbiAgICAgICAgICAgICAgYm9keToge1xuICAgICAgICAgICAgICAgIGVycjogdGhpcy5lcnIsXG4gICAgICAgICAgICAgICAgcmVzOiB0aGlzLnJlc3VsdFxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIENvdXJpZXI7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJibHVlYmlyZFwiKSxcbiAgcmVxdWlyZShcIm1vcmlcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL29wdGlvbnNcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL3V1aWRcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL3N0YXRlLWd1YXJkXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9sb2dnaW5nL2xvZ2dlclwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvZGlzcGF0Y2hlclwiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxuLyoqXG4gKiBFeHBvcnRzIGEgc2luZ2xldG9uXG4gKi9cblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfXG4pIHtcblxuICB2YXIgVVVJRCA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKFVVSUQucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7fSxcbiAgICAvLyBTZWU6IGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvVW5pdmVyc2FsbHlfdW5pcXVlX2lkZW50aWZpZXIjVmVyc2lvbl80Xy4yOHJhbmRvbS4yOVxuICAgIHY0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAneHh4eHh4eHgteHh4eC00eHh4LXl4eHgteHh4eHh4eHh4eHh4Jy5yZXBsYWNlKC9beHldL2csIGZ1bmN0aW9uKGMpIHtcbiAgICAgICAgdmFyIHIgPSBNYXRoLnJhbmRvbSgpICogMTYgfCAwO1xuICAgICAgICAvLyAweDMgICAgICAgPSAwYjAwMDExXG4gICAgICAgIC8vIDB4OCAgICAgICA9IDBiMDEwMDBcbiAgICAgICAgLy8gMHgzIHwgMHg4ID0gMGIwMTAxMVxuICAgICAgICAvLyByICYgMHgzICAgPSAoMGIwMDAwMCB8IDBiMDAwMDEgfCAwYjAwMDEwIHwgMGIwMDAxMSlcbiAgICAgICAgdmFyIHYgPSAoYyA9PSAneCcgPyByIDogKHIgJiAweDMgfCAweDgpKTtcbiAgICAgICAgcmV0dXJuIHYudG9TdHJpbmcoMTYpO1xuICAgICAgfSk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gbmV3IFVVSUQoKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBPcHRpb25zXG4pIHtcblxuICB2YXIgQ29tcG9uZW50UmVnaXN0cnkgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChDb21wb25lbnRSZWdpc3RyeS5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX21vZHVsZXMgPSB7fTtcbiAgICB9LFxuXG5cbiAgICByZWdpc3RlcjogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIHZhciBhbGlhc2VzICAgPSBvcHRzLmdldE9yRXJyb3IoXCJhc1wiKSxcbiAgICAgICAgICBtb2RPYmplY3QgPSBvcHRzLmdldE9yRXJyb3IoXCJtb2R1bGVcIik7XG5cbiAgICAgIGlmICghXy5pc0FycmF5KGFsaWFzZXMpKSB7XG4gICAgICAgIGFsaWFzZXMgPSBbIGFsaWFzZXMgXTtcbiAgICAgIH1cblxuICAgICAgXy5lYWNoKGFsaWFzZXMsIF8uYmluZChmdW5jdGlvbihhbGlhcykge1xuICAgICAgICB0aGlzLl9tb2R1bGVzW2FsaWFzXSA9IG1vZE9iamVjdDtcbiAgICAgIH0sIHRoaXMpKTtcblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcblxuICAgIHNlbGZSZWdpc3RlcjogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcblxuICAgICAgcmV0dXJuIHRoaXMucmVnaXN0ZXIoe1xuICAgICAgICBhczogb3B0cy5nZXRPckVycm9yKFwiYXNcIiksXG4gICAgICAgIG1vZHVsZTogQ29tcG9uZW50UmVnaXN0cnlcbiAgICAgIH0pO1xuICAgIH0sXG5cblxuICAgIHJlZ2lzdGVyTWFueTogZnVuY3Rpb24oYWxpYXNlc0FyeSkge1xuICAgICAgXy5lYWNoKGFsaWFzZXNBcnksIF8uYmluZChmdW5jdGlvbihhbGlhcykge1xuICAgICAgICB0aGlzLnJlZ2lzdGVyKGFsaWFzKTtcbiAgICAgIH0sIHRoaXMpKTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbiAgICBjb21wb25lbnQ6IGZ1bmN0aW9uKGFsaWFzKSB7XG4gICAgICB2YXIgbSA9IHRoaXMuX21vZHVsZXNbYWxpYXNdO1xuICAgICAgaWYgKCFtKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgYWxpYXMgcHJvdmlkZWQgKG5vIHN1Y2ggbW9kdWxlKTogYFwiK2FsaWFzK1wiJ1wiKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBtO1xuICAgIH1cblxuICB9KTtcblxuICBDb21wb25lbnRSZWdpc3RyeS5wcm90b3R5cGUuYyA9IENvbXBvbmVudFJlZ2lzdHJ5LnByb3RvdHlwZS5jb21wb25lbnQ7XG5cbiAgcmV0dXJuIENvbXBvbmVudFJlZ2lzdHJ5O1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9vcHRpb25zXCIpXG4pO1xuXG59KSgpIiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIi4vd2ViLXNjaGVkdWxlclwiKTtcbiIsIihmdW5jdGlvbigpey8vICAgICBVbmRlcnNjb3JlLmpzIDEuNi4wXG4vLyAgICAgaHR0cDovL3VuZGVyc2NvcmVqcy5vcmdcbi8vICAgICAoYykgMjAwOS0yMDE0IEplcmVteSBBc2hrZW5hcywgRG9jdW1lbnRDbG91ZCBhbmQgSW52ZXN0aWdhdGl2ZSBSZXBvcnRlcnMgJiBFZGl0b3JzXG4vLyAgICAgVW5kZXJzY29yZSBtYXkgYmUgZnJlZWx5IGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cblxuKGZ1bmN0aW9uKCkge1xuXG4gIC8vIEJhc2VsaW5lIHNldHVwXG4gIC8vIC0tLS0tLS0tLS0tLS0tXG5cbiAgLy8gRXN0YWJsaXNoIHRoZSByb290IG9iamVjdCwgYHdpbmRvd2AgaW4gdGhlIGJyb3dzZXIsIG9yIGBleHBvcnRzYCBvbiB0aGUgc2VydmVyLlxuICB2YXIgcm9vdCA9IHRoaXM7XG5cbiAgLy8gU2F2ZSB0aGUgcHJldmlvdXMgdmFsdWUgb2YgdGhlIGBfYCB2YXJpYWJsZS5cbiAgdmFyIHByZXZpb3VzVW5kZXJzY29yZSA9IHJvb3QuXztcblxuICAvLyBFc3RhYmxpc2ggdGhlIG9iamVjdCB0aGF0IGdldHMgcmV0dXJuZWQgdG8gYnJlYWsgb3V0IG9mIGEgbG9vcCBpdGVyYXRpb24uXG4gIHZhciBicmVha2VyID0ge307XG5cbiAgLy8gU2F2ZSBieXRlcyBpbiB0aGUgbWluaWZpZWQgKGJ1dCBub3QgZ3ppcHBlZCkgdmVyc2lvbjpcbiAgdmFyIEFycmF5UHJvdG8gPSBBcnJheS5wcm90b3R5cGUsIE9ialByb3RvID0gT2JqZWN0LnByb3RvdHlwZSwgRnVuY1Byb3RvID0gRnVuY3Rpb24ucHJvdG90eXBlO1xuXG4gIC8vIENyZWF0ZSBxdWljayByZWZlcmVuY2UgdmFyaWFibGVzIGZvciBzcGVlZCBhY2Nlc3MgdG8gY29yZSBwcm90b3R5cGVzLlxuICB2YXJcbiAgICBwdXNoICAgICAgICAgICAgID0gQXJyYXlQcm90by5wdXNoLFxuICAgIHNsaWNlICAgICAgICAgICAgPSBBcnJheVByb3RvLnNsaWNlLFxuICAgIGNvbmNhdCAgICAgICAgICAgPSBBcnJheVByb3RvLmNvbmNhdCxcbiAgICB0b1N0cmluZyAgICAgICAgID0gT2JqUHJvdG8udG9TdHJpbmcsXG4gICAgaGFzT3duUHJvcGVydHkgICA9IE9ialByb3RvLmhhc093blByb3BlcnR5O1xuXG4gIC8vIEFsbCAqKkVDTUFTY3JpcHQgNSoqIG5hdGl2ZSBmdW5jdGlvbiBpbXBsZW1lbnRhdGlvbnMgdGhhdCB3ZSBob3BlIHRvIHVzZVxuICAvLyBhcmUgZGVjbGFyZWQgaGVyZS5cbiAgdmFyXG4gICAgbmF0aXZlRm9yRWFjaCAgICAgID0gQXJyYXlQcm90by5mb3JFYWNoLFxuICAgIG5hdGl2ZU1hcCAgICAgICAgICA9IEFycmF5UHJvdG8ubWFwLFxuICAgIG5hdGl2ZVJlZHVjZSAgICAgICA9IEFycmF5UHJvdG8ucmVkdWNlLFxuICAgIG5hdGl2ZVJlZHVjZVJpZ2h0ICA9IEFycmF5UHJvdG8ucmVkdWNlUmlnaHQsXG4gICAgbmF0aXZlRmlsdGVyICAgICAgID0gQXJyYXlQcm90by5maWx0ZXIsXG4gICAgbmF0aXZlRXZlcnkgICAgICAgID0gQXJyYXlQcm90by5ldmVyeSxcbiAgICBuYXRpdmVTb21lICAgICAgICAgPSBBcnJheVByb3RvLnNvbWUsXG4gICAgbmF0aXZlSW5kZXhPZiAgICAgID0gQXJyYXlQcm90by5pbmRleE9mLFxuICAgIG5hdGl2ZUxhc3RJbmRleE9mICA9IEFycmF5UHJvdG8ubGFzdEluZGV4T2YsXG4gICAgbmF0aXZlSXNBcnJheSAgICAgID0gQXJyYXkuaXNBcnJheSxcbiAgICBuYXRpdmVLZXlzICAgICAgICAgPSBPYmplY3Qua2V5cyxcbiAgICBuYXRpdmVCaW5kICAgICAgICAgPSBGdW5jUHJvdG8uYmluZDtcblxuICAvLyBDcmVhdGUgYSBzYWZlIHJlZmVyZW5jZSB0byB0aGUgVW5kZXJzY29yZSBvYmplY3QgZm9yIHVzZSBiZWxvdy5cbiAgdmFyIF8gPSBmdW5jdGlvbihvYmopIHtcbiAgICBpZiAob2JqIGluc3RhbmNlb2YgXykgcmV0dXJuIG9iajtcbiAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgXykpIHJldHVybiBuZXcgXyhvYmopO1xuICAgIHRoaXMuX3dyYXBwZWQgPSBvYmo7XG4gIH07XG5cbiAgLy8gRXhwb3J0IHRoZSBVbmRlcnNjb3JlIG9iamVjdCBmb3IgKipOb2RlLmpzKiosIHdpdGhcbiAgLy8gYmFja3dhcmRzLWNvbXBhdGliaWxpdHkgZm9yIHRoZSBvbGQgYHJlcXVpcmUoKWAgQVBJLiBJZiB3ZSdyZSBpblxuICAvLyB0aGUgYnJvd3NlciwgYWRkIGBfYCBhcyBhIGdsb2JhbCBvYmplY3QgdmlhIGEgc3RyaW5nIGlkZW50aWZpZXIsXG4gIC8vIGZvciBDbG9zdXJlIENvbXBpbGVyIFwiYWR2YW5jZWRcIiBtb2RlLlxuICBpZiAodHlwZW9mIGV4cG9ydHMgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnICYmIG1vZHVsZS5leHBvcnRzKSB7XG4gICAgICBleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSBfO1xuICAgIH1cbiAgICBleHBvcnRzLl8gPSBfO1xuICB9IGVsc2Uge1xuICAgIHJvb3QuXyA9IF87XG4gIH1cblxuICAvLyBDdXJyZW50IHZlcnNpb24uXG4gIF8uVkVSU0lPTiA9ICcxLjYuMCc7XG5cbiAgLy8gQ29sbGVjdGlvbiBGdW5jdGlvbnNcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAvLyBUaGUgY29ybmVyc3RvbmUsIGFuIGBlYWNoYCBpbXBsZW1lbnRhdGlvbiwgYWthIGBmb3JFYWNoYC5cbiAgLy8gSGFuZGxlcyBvYmplY3RzIHdpdGggdGhlIGJ1aWx0LWluIGBmb3JFYWNoYCwgYXJyYXlzLCBhbmQgcmF3IG9iamVjdHMuXG4gIC8vIERlbGVnYXRlcyB0byAqKkVDTUFTY3JpcHQgNSoqJ3MgbmF0aXZlIGBmb3JFYWNoYCBpZiBhdmFpbGFibGUuXG4gIHZhciBlYWNoID0gXy5lYWNoID0gXy5mb3JFYWNoID0gZnVuY3Rpb24ob2JqLCBpdGVyYXRvciwgY29udGV4dCkge1xuICAgIGlmIChvYmogPT0gbnVsbCkgcmV0dXJuIG9iajtcbiAgICBpZiAobmF0aXZlRm9yRWFjaCAmJiBvYmouZm9yRWFjaCA9PT0gbmF0aXZlRm9yRWFjaCkge1xuICAgICAgb2JqLmZvckVhY2goaXRlcmF0b3IsIGNvbnRleHQpO1xuICAgIH0gZWxzZSBpZiAob2JqLmxlbmd0aCA9PT0gK29iai5sZW5ndGgpIHtcbiAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBvYmoubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGl0ZXJhdG9yLmNhbGwoY29udGV4dCwgb2JqW2ldLCBpLCBvYmopID09PSBicmVha2VyKSByZXR1cm47XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBrZXlzID0gXy5rZXlzKG9iaik7XG4gICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0ga2V5cy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoaXRlcmF0b3IuY2FsbChjb250ZXh0LCBvYmpba2V5c1tpXV0sIGtleXNbaV0sIG9iaikgPT09IGJyZWFrZXIpIHJldHVybjtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG9iajtcbiAgfTtcblxuICAvLyBSZXR1cm4gdGhlIHJlc3VsdHMgb2YgYXBwbHlpbmcgdGhlIGl0ZXJhdG9yIHRvIGVhY2ggZWxlbWVudC5cbiAgLy8gRGVsZWdhdGVzIHRvICoqRUNNQVNjcmlwdCA1KioncyBuYXRpdmUgYG1hcGAgaWYgYXZhaWxhYmxlLlxuICBfLm1hcCA9IF8uY29sbGVjdCA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0b3IsIGNvbnRleHQpIHtcbiAgICB2YXIgcmVzdWx0cyA9IFtdO1xuICAgIGlmIChvYmogPT0gbnVsbCkgcmV0dXJuIHJlc3VsdHM7XG4gICAgaWYgKG5hdGl2ZU1hcCAmJiBvYmoubWFwID09PSBuYXRpdmVNYXApIHJldHVybiBvYmoubWFwKGl0ZXJhdG9yLCBjb250ZXh0KTtcbiAgICBlYWNoKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7XG4gICAgICByZXN1bHRzLnB1c2goaXRlcmF0b3IuY2FsbChjb250ZXh0LCB2YWx1ZSwgaW5kZXgsIGxpc3QpKTtcbiAgICB9KTtcbiAgICByZXR1cm4gcmVzdWx0cztcbiAgfTtcblxuICB2YXIgcmVkdWNlRXJyb3IgPSAnUmVkdWNlIG9mIGVtcHR5IGFycmF5IHdpdGggbm8gaW5pdGlhbCB2YWx1ZSc7XG5cbiAgLy8gKipSZWR1Y2UqKiBidWlsZHMgdXAgYSBzaW5nbGUgcmVzdWx0IGZyb20gYSBsaXN0IG9mIHZhbHVlcywgYWthIGBpbmplY3RgLFxuICAvLyBvciBgZm9sZGxgLiBEZWxlZ2F0ZXMgdG8gKipFQ01BU2NyaXB0IDUqKidzIG5hdGl2ZSBgcmVkdWNlYCBpZiBhdmFpbGFibGUuXG4gIF8ucmVkdWNlID0gXy5mb2xkbCA9IF8uaW5qZWN0ID0gZnVuY3Rpb24ob2JqLCBpdGVyYXRvciwgbWVtbywgY29udGV4dCkge1xuICAgIHZhciBpbml0aWFsID0gYXJndW1lbnRzLmxlbmd0aCA+IDI7XG4gICAgaWYgKG9iaiA9PSBudWxsKSBvYmogPSBbXTtcbiAgICBpZiAobmF0aXZlUmVkdWNlICYmIG9iai5yZWR1Y2UgPT09IG5hdGl2ZVJlZHVjZSkge1xuICAgICAgaWYgKGNvbnRleHQpIGl0ZXJhdG9yID0gXy5iaW5kKGl0ZXJhdG9yLCBjb250ZXh0KTtcbiAgICAgIHJldHVybiBpbml0aWFsID8gb2JqLnJlZHVjZShpdGVyYXRvciwgbWVtbykgOiBvYmoucmVkdWNlKGl0ZXJhdG9yKTtcbiAgICB9XG4gICAgZWFjaChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgbGlzdCkge1xuICAgICAgaWYgKCFpbml0aWFsKSB7XG4gICAgICAgIG1lbW8gPSB2YWx1ZTtcbiAgICAgICAgaW5pdGlhbCA9IHRydWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBtZW1vID0gaXRlcmF0b3IuY2FsbChjb250ZXh0LCBtZW1vLCB2YWx1ZSwgaW5kZXgsIGxpc3QpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGlmICghaW5pdGlhbCkgdGhyb3cgbmV3IFR5cGVFcnJvcihyZWR1Y2VFcnJvcik7XG4gICAgcmV0dXJuIG1lbW87XG4gIH07XG5cbiAgLy8gVGhlIHJpZ2h0LWFzc29jaWF0aXZlIHZlcnNpb24gb2YgcmVkdWNlLCBhbHNvIGtub3duIGFzIGBmb2xkcmAuXG4gIC8vIERlbGVnYXRlcyB0byAqKkVDTUFTY3JpcHQgNSoqJ3MgbmF0aXZlIGByZWR1Y2VSaWdodGAgaWYgYXZhaWxhYmxlLlxuICBfLnJlZHVjZVJpZ2h0ID0gXy5mb2xkciA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0b3IsIG1lbW8sIGNvbnRleHQpIHtcbiAgICB2YXIgaW5pdGlhbCA9IGFyZ3VtZW50cy5sZW5ndGggPiAyO1xuICAgIGlmIChvYmogPT0gbnVsbCkgb2JqID0gW107XG4gICAgaWYgKG5hdGl2ZVJlZHVjZVJpZ2h0ICYmIG9iai5yZWR1Y2VSaWdodCA9PT0gbmF0aXZlUmVkdWNlUmlnaHQpIHtcbiAgICAgIGlmIChjb250ZXh0KSBpdGVyYXRvciA9IF8uYmluZChpdGVyYXRvciwgY29udGV4dCk7XG4gICAgICByZXR1cm4gaW5pdGlhbCA/IG9iai5yZWR1Y2VSaWdodChpdGVyYXRvciwgbWVtbykgOiBvYmoucmVkdWNlUmlnaHQoaXRlcmF0b3IpO1xuICAgIH1cbiAgICB2YXIgbGVuZ3RoID0gb2JqLmxlbmd0aDtcbiAgICBpZiAobGVuZ3RoICE9PSArbGVuZ3RoKSB7XG4gICAgICB2YXIga2V5cyA9IF8ua2V5cyhvYmopO1xuICAgICAgbGVuZ3RoID0ga2V5cy5sZW5ndGg7XG4gICAgfVxuICAgIGVhY2gob2JqLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGxpc3QpIHtcbiAgICAgIGluZGV4ID0ga2V5cyA/IGtleXNbLS1sZW5ndGhdIDogLS1sZW5ndGg7XG4gICAgICBpZiAoIWluaXRpYWwpIHtcbiAgICAgICAgbWVtbyA9IG9ialtpbmRleF07XG4gICAgICAgIGluaXRpYWwgPSB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbWVtbyA9IGl0ZXJhdG9yLmNhbGwoY29udGV4dCwgbWVtbywgb2JqW2luZGV4XSwgaW5kZXgsIGxpc3QpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGlmICghaW5pdGlhbCkgdGhyb3cgbmV3IFR5cGVFcnJvcihyZWR1Y2VFcnJvcik7XG4gICAgcmV0dXJuIG1lbW87XG4gIH07XG5cbiAgLy8gUmV0dXJuIHRoZSBmaXJzdCB2YWx1ZSB3aGljaCBwYXNzZXMgYSB0cnV0aCB0ZXN0LiBBbGlhc2VkIGFzIGBkZXRlY3RgLlxuICBfLmZpbmQgPSBfLmRldGVjdCA9IGZ1bmN0aW9uKG9iaiwgcHJlZGljYXRlLCBjb250ZXh0KSB7XG4gICAgdmFyIHJlc3VsdDtcbiAgICBhbnkob2JqLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGxpc3QpIHtcbiAgICAgIGlmIChwcmVkaWNhdGUuY2FsbChjb250ZXh0LCB2YWx1ZSwgaW5kZXgsIGxpc3QpKSB7XG4gICAgICAgIHJlc3VsdCA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIC8vIFJldHVybiBhbGwgdGhlIGVsZW1lbnRzIHRoYXQgcGFzcyBhIHRydXRoIHRlc3QuXG4gIC8vIERlbGVnYXRlcyB0byAqKkVDTUFTY3JpcHQgNSoqJ3MgbmF0aXZlIGBmaWx0ZXJgIGlmIGF2YWlsYWJsZS5cbiAgLy8gQWxpYXNlZCBhcyBgc2VsZWN0YC5cbiAgXy5maWx0ZXIgPSBfLnNlbGVjdCA9IGZ1bmN0aW9uKG9iaiwgcHJlZGljYXRlLCBjb250ZXh0KSB7XG4gICAgdmFyIHJlc3VsdHMgPSBbXTtcbiAgICBpZiAob2JqID09IG51bGwpIHJldHVybiByZXN1bHRzO1xuICAgIGlmIChuYXRpdmVGaWx0ZXIgJiYgb2JqLmZpbHRlciA9PT0gbmF0aXZlRmlsdGVyKSByZXR1cm4gb2JqLmZpbHRlcihwcmVkaWNhdGUsIGNvbnRleHQpO1xuICAgIGVhY2gob2JqLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGxpc3QpIHtcbiAgICAgIGlmIChwcmVkaWNhdGUuY2FsbChjb250ZXh0LCB2YWx1ZSwgaW5kZXgsIGxpc3QpKSByZXN1bHRzLnB1c2godmFsdWUpO1xuICAgIH0pO1xuICAgIHJldHVybiByZXN1bHRzO1xuICB9O1xuXG4gIC8vIFJldHVybiBhbGwgdGhlIGVsZW1lbnRzIGZvciB3aGljaCBhIHRydXRoIHRlc3QgZmFpbHMuXG4gIF8ucmVqZWN0ID0gZnVuY3Rpb24ob2JqLCBwcmVkaWNhdGUsIGNvbnRleHQpIHtcbiAgICByZXR1cm4gXy5maWx0ZXIob2JqLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGxpc3QpIHtcbiAgICAgIHJldHVybiAhcHJlZGljYXRlLmNhbGwoY29udGV4dCwgdmFsdWUsIGluZGV4LCBsaXN0KTtcbiAgICB9LCBjb250ZXh0KTtcbiAgfTtcblxuICAvLyBEZXRlcm1pbmUgd2hldGhlciBhbGwgb2YgdGhlIGVsZW1lbnRzIG1hdGNoIGEgdHJ1dGggdGVzdC5cbiAgLy8gRGVsZWdhdGVzIHRvICoqRUNNQVNjcmlwdCA1KioncyBuYXRpdmUgYGV2ZXJ5YCBpZiBhdmFpbGFibGUuXG4gIC8vIEFsaWFzZWQgYXMgYGFsbGAuXG4gIF8uZXZlcnkgPSBfLmFsbCA9IGZ1bmN0aW9uKG9iaiwgcHJlZGljYXRlLCBjb250ZXh0KSB7XG4gICAgcHJlZGljYXRlIHx8IChwcmVkaWNhdGUgPSBfLmlkZW50aXR5KTtcbiAgICB2YXIgcmVzdWx0ID0gdHJ1ZTtcbiAgICBpZiAob2JqID09IG51bGwpIHJldHVybiByZXN1bHQ7XG4gICAgaWYgKG5hdGl2ZUV2ZXJ5ICYmIG9iai5ldmVyeSA9PT0gbmF0aXZlRXZlcnkpIHJldHVybiBvYmouZXZlcnkocHJlZGljYXRlLCBjb250ZXh0KTtcbiAgICBlYWNoKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7XG4gICAgICBpZiAoIShyZXN1bHQgPSByZXN1bHQgJiYgcHJlZGljYXRlLmNhbGwoY29udGV4dCwgdmFsdWUsIGluZGV4LCBsaXN0KSkpIHJldHVybiBicmVha2VyO1xuICAgIH0pO1xuICAgIHJldHVybiAhIXJlc3VsdDtcbiAgfTtcblxuICAvLyBEZXRlcm1pbmUgaWYgYXQgbGVhc3Qgb25lIGVsZW1lbnQgaW4gdGhlIG9iamVjdCBtYXRjaGVzIGEgdHJ1dGggdGVzdC5cbiAgLy8gRGVsZWdhdGVzIHRvICoqRUNNQVNjcmlwdCA1KioncyBuYXRpdmUgYHNvbWVgIGlmIGF2YWlsYWJsZS5cbiAgLy8gQWxpYXNlZCBhcyBgYW55YC5cbiAgdmFyIGFueSA9IF8uc29tZSA9IF8uYW55ID0gZnVuY3Rpb24ob2JqLCBwcmVkaWNhdGUsIGNvbnRleHQpIHtcbiAgICBwcmVkaWNhdGUgfHwgKHByZWRpY2F0ZSA9IF8uaWRlbnRpdHkpO1xuICAgIHZhciByZXN1bHQgPSBmYWxzZTtcbiAgICBpZiAob2JqID09IG51bGwpIHJldHVybiByZXN1bHQ7XG4gICAgaWYgKG5hdGl2ZVNvbWUgJiYgb2JqLnNvbWUgPT09IG5hdGl2ZVNvbWUpIHJldHVybiBvYmouc29tZShwcmVkaWNhdGUsIGNvbnRleHQpO1xuICAgIGVhY2gob2JqLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGxpc3QpIHtcbiAgICAgIGlmIChyZXN1bHQgfHwgKHJlc3VsdCA9IHByZWRpY2F0ZS5jYWxsKGNvbnRleHQsIHZhbHVlLCBpbmRleCwgbGlzdCkpKSByZXR1cm4gYnJlYWtlcjtcbiAgICB9KTtcbiAgICByZXR1cm4gISFyZXN1bHQ7XG4gIH07XG5cbiAgLy8gRGV0ZXJtaW5lIGlmIHRoZSBhcnJheSBvciBvYmplY3QgY29udGFpbnMgYSBnaXZlbiB2YWx1ZSAodXNpbmcgYD09PWApLlxuICAvLyBBbGlhc2VkIGFzIGBpbmNsdWRlYC5cbiAgXy5jb250YWlucyA9IF8uaW5jbHVkZSA9IGZ1bmN0aW9uKG9iaiwgdGFyZ2V0KSB7XG4gICAgaWYgKG9iaiA9PSBudWxsKSByZXR1cm4gZmFsc2U7XG4gICAgaWYgKG5hdGl2ZUluZGV4T2YgJiYgb2JqLmluZGV4T2YgPT09IG5hdGl2ZUluZGV4T2YpIHJldHVybiBvYmouaW5kZXhPZih0YXJnZXQpICE9IC0xO1xuICAgIHJldHVybiBhbnkob2JqLCBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgcmV0dXJuIHZhbHVlID09PSB0YXJnZXQ7XG4gICAgfSk7XG4gIH07XG5cbiAgLy8gSW52b2tlIGEgbWV0aG9kICh3aXRoIGFyZ3VtZW50cykgb24gZXZlcnkgaXRlbSBpbiBhIGNvbGxlY3Rpb24uXG4gIF8uaW52b2tlID0gZnVuY3Rpb24ob2JqLCBtZXRob2QpIHtcbiAgICB2YXIgYXJncyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKTtcbiAgICB2YXIgaXNGdW5jID0gXy5pc0Z1bmN0aW9uKG1ldGhvZCk7XG4gICAgcmV0dXJuIF8ubWFwKG9iaiwgZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHJldHVybiAoaXNGdW5jID8gbWV0aG9kIDogdmFsdWVbbWV0aG9kXSkuYXBwbHkodmFsdWUsIGFyZ3MpO1xuICAgIH0pO1xuICB9O1xuXG4gIC8vIENvbnZlbmllbmNlIHZlcnNpb24gb2YgYSBjb21tb24gdXNlIGNhc2Ugb2YgYG1hcGA6IGZldGNoaW5nIGEgcHJvcGVydHkuXG4gIF8ucGx1Y2sgPSBmdW5jdGlvbihvYmosIGtleSkge1xuICAgIHJldHVybiBfLm1hcChvYmosIF8ucHJvcGVydHkoa2V5KSk7XG4gIH07XG5cbiAgLy8gQ29udmVuaWVuY2UgdmVyc2lvbiBvZiBhIGNvbW1vbiB1c2UgY2FzZSBvZiBgZmlsdGVyYDogc2VsZWN0aW5nIG9ubHkgb2JqZWN0c1xuICAvLyBjb250YWluaW5nIHNwZWNpZmljIGBrZXk6dmFsdWVgIHBhaXJzLlxuICBfLndoZXJlID0gZnVuY3Rpb24ob2JqLCBhdHRycykge1xuICAgIHJldHVybiBfLmZpbHRlcihvYmosIF8ubWF0Y2hlcyhhdHRycykpO1xuICB9O1xuXG4gIC8vIENvbnZlbmllbmNlIHZlcnNpb24gb2YgYSBjb21tb24gdXNlIGNhc2Ugb2YgYGZpbmRgOiBnZXR0aW5nIHRoZSBmaXJzdCBvYmplY3RcbiAgLy8gY29udGFpbmluZyBzcGVjaWZpYyBga2V5OnZhbHVlYCBwYWlycy5cbiAgXy5maW5kV2hlcmUgPSBmdW5jdGlvbihvYmosIGF0dHJzKSB7XG4gICAgcmV0dXJuIF8uZmluZChvYmosIF8ubWF0Y2hlcyhhdHRycykpO1xuICB9O1xuXG4gIC8vIFJldHVybiB0aGUgbWF4aW11bSBlbGVtZW50IG9yIChlbGVtZW50LWJhc2VkIGNvbXB1dGF0aW9uKS5cbiAgLy8gQ2FuJ3Qgb3B0aW1pemUgYXJyYXlzIG9mIGludGVnZXJzIGxvbmdlciB0aGFuIDY1LDUzNSBlbGVtZW50cy5cbiAgLy8gU2VlIFtXZWJLaXQgQnVnIDgwNzk3XShodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9ODA3OTcpXG4gIF8ubWF4ID0gZnVuY3Rpb24ob2JqLCBpdGVyYXRvciwgY29udGV4dCkge1xuICAgIGlmICghaXRlcmF0b3IgJiYgXy5pc0FycmF5KG9iaikgJiYgb2JqWzBdID09PSArb2JqWzBdICYmIG9iai5sZW5ndGggPCA2NTUzNSkge1xuICAgICAgcmV0dXJuIE1hdGgubWF4LmFwcGx5KE1hdGgsIG9iaik7XG4gICAgfVxuICAgIHZhciByZXN1bHQgPSAtSW5maW5pdHksIGxhc3RDb21wdXRlZCA9IC1JbmZpbml0eTtcbiAgICBlYWNoKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7XG4gICAgICB2YXIgY29tcHV0ZWQgPSBpdGVyYXRvciA/IGl0ZXJhdG9yLmNhbGwoY29udGV4dCwgdmFsdWUsIGluZGV4LCBsaXN0KSA6IHZhbHVlO1xuICAgICAgaWYgKGNvbXB1dGVkID4gbGFzdENvbXB1dGVkKSB7XG4gICAgICAgIHJlc3VsdCA9IHZhbHVlO1xuICAgICAgICBsYXN0Q29tcHV0ZWQgPSBjb21wdXRlZDtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIC8vIFJldHVybiB0aGUgbWluaW11bSBlbGVtZW50IChvciBlbGVtZW50LWJhc2VkIGNvbXB1dGF0aW9uKS5cbiAgXy5taW4gPSBmdW5jdGlvbihvYmosIGl0ZXJhdG9yLCBjb250ZXh0KSB7XG4gICAgaWYgKCFpdGVyYXRvciAmJiBfLmlzQXJyYXkob2JqKSAmJiBvYmpbMF0gPT09ICtvYmpbMF0gJiYgb2JqLmxlbmd0aCA8IDY1NTM1KSB7XG4gICAgICByZXR1cm4gTWF0aC5taW4uYXBwbHkoTWF0aCwgb2JqKTtcbiAgICB9XG4gICAgdmFyIHJlc3VsdCA9IEluZmluaXR5LCBsYXN0Q29tcHV0ZWQgPSBJbmZpbml0eTtcbiAgICBlYWNoKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7XG4gICAgICB2YXIgY29tcHV0ZWQgPSBpdGVyYXRvciA/IGl0ZXJhdG9yLmNhbGwoY29udGV4dCwgdmFsdWUsIGluZGV4LCBsaXN0KSA6IHZhbHVlO1xuICAgICAgaWYgKGNvbXB1dGVkIDwgbGFzdENvbXB1dGVkKSB7XG4gICAgICAgIHJlc3VsdCA9IHZhbHVlO1xuICAgICAgICBsYXN0Q29tcHV0ZWQgPSBjb21wdXRlZDtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIC8vIFNodWZmbGUgYW4gYXJyYXksIHVzaW5nIHRoZSBtb2Rlcm4gdmVyc2lvbiBvZiB0aGVcbiAgLy8gW0Zpc2hlci1ZYXRlcyBzaHVmZmxlXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0Zpc2hlcuKAk1lhdGVzX3NodWZmbGUpLlxuICBfLnNodWZmbGUgPSBmdW5jdGlvbihvYmopIHtcbiAgICB2YXIgcmFuZDtcbiAgICB2YXIgaW5kZXggPSAwO1xuICAgIHZhciBzaHVmZmxlZCA9IFtdO1xuICAgIGVhY2gob2JqLCBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgcmFuZCA9IF8ucmFuZG9tKGluZGV4KyspO1xuICAgICAgc2h1ZmZsZWRbaW5kZXggLSAxXSA9IHNodWZmbGVkW3JhbmRdO1xuICAgICAgc2h1ZmZsZWRbcmFuZF0gPSB2YWx1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gc2h1ZmZsZWQ7XG4gIH07XG5cbiAgLy8gU2FtcGxlICoqbioqIHJhbmRvbSB2YWx1ZXMgZnJvbSBhIGNvbGxlY3Rpb24uXG4gIC8vIElmICoqbioqIGlzIG5vdCBzcGVjaWZpZWQsIHJldHVybnMgYSBzaW5nbGUgcmFuZG9tIGVsZW1lbnQuXG4gIC8vIFRoZSBpbnRlcm5hbCBgZ3VhcmRgIGFyZ3VtZW50IGFsbG93cyBpdCB0byB3b3JrIHdpdGggYG1hcGAuXG4gIF8uc2FtcGxlID0gZnVuY3Rpb24ob2JqLCBuLCBndWFyZCkge1xuICAgIGlmIChuID09IG51bGwgfHwgZ3VhcmQpIHtcbiAgICAgIGlmIChvYmoubGVuZ3RoICE9PSArb2JqLmxlbmd0aCkgb2JqID0gXy52YWx1ZXMob2JqKTtcbiAgICAgIHJldHVybiBvYmpbXy5yYW5kb20ob2JqLmxlbmd0aCAtIDEpXTtcbiAgICB9XG4gICAgcmV0dXJuIF8uc2h1ZmZsZShvYmopLnNsaWNlKDAsIE1hdGgubWF4KDAsIG4pKTtcbiAgfTtcblxuICAvLyBBbiBpbnRlcm5hbCBmdW5jdGlvbiB0byBnZW5lcmF0ZSBsb29rdXAgaXRlcmF0b3JzLlxuICB2YXIgbG9va3VwSXRlcmF0b3IgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgIGlmICh2YWx1ZSA9PSBudWxsKSByZXR1cm4gXy5pZGVudGl0eTtcbiAgICBpZiAoXy5pc0Z1bmN0aW9uKHZhbHVlKSkgcmV0dXJuIHZhbHVlO1xuICAgIHJldHVybiBfLnByb3BlcnR5KHZhbHVlKTtcbiAgfTtcblxuICAvLyBTb3J0IHRoZSBvYmplY3QncyB2YWx1ZXMgYnkgYSBjcml0ZXJpb24gcHJvZHVjZWQgYnkgYW4gaXRlcmF0b3IuXG4gIF8uc29ydEJ5ID0gZnVuY3Rpb24ob2JqLCBpdGVyYXRvciwgY29udGV4dCkge1xuICAgIGl0ZXJhdG9yID0gbG9va3VwSXRlcmF0b3IoaXRlcmF0b3IpO1xuICAgIHJldHVybiBfLnBsdWNrKF8ubWFwKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWx1ZTogdmFsdWUsXG4gICAgICAgIGluZGV4OiBpbmRleCxcbiAgICAgICAgY3JpdGVyaWE6IGl0ZXJhdG9yLmNhbGwoY29udGV4dCwgdmFsdWUsIGluZGV4LCBsaXN0KVxuICAgICAgfTtcbiAgICB9KS5zb3J0KGZ1bmN0aW9uKGxlZnQsIHJpZ2h0KSB7XG4gICAgICB2YXIgYSA9IGxlZnQuY3JpdGVyaWE7XG4gICAgICB2YXIgYiA9IHJpZ2h0LmNyaXRlcmlhO1xuICAgICAgaWYgKGEgIT09IGIpIHtcbiAgICAgICAgaWYgKGEgPiBiIHx8IGEgPT09IHZvaWQgMCkgcmV0dXJuIDE7XG4gICAgICAgIGlmIChhIDwgYiB8fCBiID09PSB2b2lkIDApIHJldHVybiAtMTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBsZWZ0LmluZGV4IC0gcmlnaHQuaW5kZXg7XG4gICAgfSksICd2YWx1ZScpO1xuICB9O1xuXG4gIC8vIEFuIGludGVybmFsIGZ1bmN0aW9uIHVzZWQgZm9yIGFnZ3JlZ2F0ZSBcImdyb3VwIGJ5XCIgb3BlcmF0aW9ucy5cbiAgdmFyIGdyb3VwID0gZnVuY3Rpb24oYmVoYXZpb3IpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24ob2JqLCBpdGVyYXRvciwgY29udGV4dCkge1xuICAgICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgICAgaXRlcmF0b3IgPSBsb29rdXBJdGVyYXRvcihpdGVyYXRvcik7XG4gICAgICBlYWNoKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4KSB7XG4gICAgICAgIHZhciBrZXkgPSBpdGVyYXRvci5jYWxsKGNvbnRleHQsIHZhbHVlLCBpbmRleCwgb2JqKTtcbiAgICAgICAgYmVoYXZpb3IocmVzdWx0LCBrZXksIHZhbHVlKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICB9O1xuXG4gIC8vIEdyb3VwcyB0aGUgb2JqZWN0J3MgdmFsdWVzIGJ5IGEgY3JpdGVyaW9uLiBQYXNzIGVpdGhlciBhIHN0cmluZyBhdHRyaWJ1dGVcbiAgLy8gdG8gZ3JvdXAgYnksIG9yIGEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIHRoZSBjcml0ZXJpb24uXG4gIF8uZ3JvdXBCeSA9IGdyb3VwKGZ1bmN0aW9uKHJlc3VsdCwga2V5LCB2YWx1ZSkge1xuICAgIF8uaGFzKHJlc3VsdCwga2V5KSA/IHJlc3VsdFtrZXldLnB1c2godmFsdWUpIDogcmVzdWx0W2tleV0gPSBbdmFsdWVdO1xuICB9KTtcblxuICAvLyBJbmRleGVzIHRoZSBvYmplY3QncyB2YWx1ZXMgYnkgYSBjcml0ZXJpb24sIHNpbWlsYXIgdG8gYGdyb3VwQnlgLCBidXQgZm9yXG4gIC8vIHdoZW4geW91IGtub3cgdGhhdCB5b3VyIGluZGV4IHZhbHVlcyB3aWxsIGJlIHVuaXF1ZS5cbiAgXy5pbmRleEJ5ID0gZ3JvdXAoZnVuY3Rpb24ocmVzdWx0LCBrZXksIHZhbHVlKSB7XG4gICAgcmVzdWx0W2tleV0gPSB2YWx1ZTtcbiAgfSk7XG5cbiAgLy8gQ291bnRzIGluc3RhbmNlcyBvZiBhbiBvYmplY3QgdGhhdCBncm91cCBieSBhIGNlcnRhaW4gY3JpdGVyaW9uLiBQYXNzXG4gIC8vIGVpdGhlciBhIHN0cmluZyBhdHRyaWJ1dGUgdG8gY291bnQgYnksIG9yIGEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIHRoZVxuICAvLyBjcml0ZXJpb24uXG4gIF8uY291bnRCeSA9IGdyb3VwKGZ1bmN0aW9uKHJlc3VsdCwga2V5KSB7XG4gICAgXy5oYXMocmVzdWx0LCBrZXkpID8gcmVzdWx0W2tleV0rKyA6IHJlc3VsdFtrZXldID0gMTtcbiAgfSk7XG5cbiAgLy8gVXNlIGEgY29tcGFyYXRvciBmdW5jdGlvbiB0byBmaWd1cmUgb3V0IHRoZSBzbWFsbGVzdCBpbmRleCBhdCB3aGljaFxuICAvLyBhbiBvYmplY3Qgc2hvdWxkIGJlIGluc2VydGVkIHNvIGFzIHRvIG1haW50YWluIG9yZGVyLiBVc2VzIGJpbmFyeSBzZWFyY2guXG4gIF8uc29ydGVkSW5kZXggPSBmdW5jdGlvbihhcnJheSwgb2JqLCBpdGVyYXRvciwgY29udGV4dCkge1xuICAgIGl0ZXJhdG9yID0gbG9va3VwSXRlcmF0b3IoaXRlcmF0b3IpO1xuICAgIHZhciB2YWx1ZSA9IGl0ZXJhdG9yLmNhbGwoY29udGV4dCwgb2JqKTtcbiAgICB2YXIgbG93ID0gMCwgaGlnaCA9IGFycmF5Lmxlbmd0aDtcbiAgICB3aGlsZSAobG93IDwgaGlnaCkge1xuICAgICAgdmFyIG1pZCA9IChsb3cgKyBoaWdoKSA+Pj4gMTtcbiAgICAgIGl0ZXJhdG9yLmNhbGwoY29udGV4dCwgYXJyYXlbbWlkXSkgPCB2YWx1ZSA/IGxvdyA9IG1pZCArIDEgOiBoaWdoID0gbWlkO1xuICAgIH1cbiAgICByZXR1cm4gbG93O1xuICB9O1xuXG4gIC8vIFNhZmVseSBjcmVhdGUgYSByZWFsLCBsaXZlIGFycmF5IGZyb20gYW55dGhpbmcgaXRlcmFibGUuXG4gIF8udG9BcnJheSA9IGZ1bmN0aW9uKG9iaikge1xuICAgIGlmICghb2JqKSByZXR1cm4gW107XG4gICAgaWYgKF8uaXNBcnJheShvYmopKSByZXR1cm4gc2xpY2UuY2FsbChvYmopO1xuICAgIGlmIChvYmoubGVuZ3RoID09PSArb2JqLmxlbmd0aCkgcmV0dXJuIF8ubWFwKG9iaiwgXy5pZGVudGl0eSk7XG4gICAgcmV0dXJuIF8udmFsdWVzKG9iaik7XG4gIH07XG5cbiAgLy8gUmV0dXJuIHRoZSBudW1iZXIgb2YgZWxlbWVudHMgaW4gYW4gb2JqZWN0LlxuICBfLnNpemUgPSBmdW5jdGlvbihvYmopIHtcbiAgICBpZiAob2JqID09IG51bGwpIHJldHVybiAwO1xuICAgIHJldHVybiAob2JqLmxlbmd0aCA9PT0gK29iai5sZW5ndGgpID8gb2JqLmxlbmd0aCA6IF8ua2V5cyhvYmopLmxlbmd0aDtcbiAgfTtcblxuICAvLyBBcnJheSBGdW5jdGlvbnNcbiAgLy8gLS0tLS0tLS0tLS0tLS0tXG5cbiAgLy8gR2V0IHRoZSBmaXJzdCBlbGVtZW50IG9mIGFuIGFycmF5LiBQYXNzaW5nICoqbioqIHdpbGwgcmV0dXJuIHRoZSBmaXJzdCBOXG4gIC8vIHZhbHVlcyBpbiB0aGUgYXJyYXkuIEFsaWFzZWQgYXMgYGhlYWRgIGFuZCBgdGFrZWAuIFRoZSAqKmd1YXJkKiogY2hlY2tcbiAgLy8gYWxsb3dzIGl0IHRvIHdvcmsgd2l0aCBgXy5tYXBgLlxuICBfLmZpcnN0ID0gXy5oZWFkID0gXy50YWtlID0gZnVuY3Rpb24oYXJyYXksIG4sIGd1YXJkKSB7XG4gICAgaWYgKGFycmF5ID09IG51bGwpIHJldHVybiB2b2lkIDA7XG4gICAgaWYgKChuID09IG51bGwpIHx8IGd1YXJkKSByZXR1cm4gYXJyYXlbMF07XG4gICAgaWYgKG4gPCAwKSByZXR1cm4gW107XG4gICAgcmV0dXJuIHNsaWNlLmNhbGwoYXJyYXksIDAsIG4pO1xuICB9O1xuXG4gIC8vIFJldHVybnMgZXZlcnl0aGluZyBidXQgdGhlIGxhc3QgZW50cnkgb2YgdGhlIGFycmF5LiBFc3BlY2lhbGx5IHVzZWZ1bCBvblxuICAvLyB0aGUgYXJndW1lbnRzIG9iamVjdC4gUGFzc2luZyAqKm4qKiB3aWxsIHJldHVybiBhbGwgdGhlIHZhbHVlcyBpblxuICAvLyB0aGUgYXJyYXksIGV4Y2x1ZGluZyB0aGUgbGFzdCBOLiBUaGUgKipndWFyZCoqIGNoZWNrIGFsbG93cyBpdCB0byB3b3JrIHdpdGhcbiAgLy8gYF8ubWFwYC5cbiAgXy5pbml0aWFsID0gZnVuY3Rpb24oYXJyYXksIG4sIGd1YXJkKSB7XG4gICAgcmV0dXJuIHNsaWNlLmNhbGwoYXJyYXksIDAsIGFycmF5Lmxlbmd0aCAtICgobiA9PSBudWxsKSB8fCBndWFyZCA/IDEgOiBuKSk7XG4gIH07XG5cbiAgLy8gR2V0IHRoZSBsYXN0IGVsZW1lbnQgb2YgYW4gYXJyYXkuIFBhc3NpbmcgKipuKiogd2lsbCByZXR1cm4gdGhlIGxhc3QgTlxuICAvLyB2YWx1ZXMgaW4gdGhlIGFycmF5LiBUaGUgKipndWFyZCoqIGNoZWNrIGFsbG93cyBpdCB0byB3b3JrIHdpdGggYF8ubWFwYC5cbiAgXy5sYXN0ID0gZnVuY3Rpb24oYXJyYXksIG4sIGd1YXJkKSB7XG4gICAgaWYgKGFycmF5ID09IG51bGwpIHJldHVybiB2b2lkIDA7XG4gICAgaWYgKChuID09IG51bGwpIHx8IGd1YXJkKSByZXR1cm4gYXJyYXlbYXJyYXkubGVuZ3RoIC0gMV07XG4gICAgcmV0dXJuIHNsaWNlLmNhbGwoYXJyYXksIE1hdGgubWF4KGFycmF5Lmxlbmd0aCAtIG4sIDApKTtcbiAgfTtcblxuICAvLyBSZXR1cm5zIGV2ZXJ5dGhpbmcgYnV0IHRoZSBmaXJzdCBlbnRyeSBvZiB0aGUgYXJyYXkuIEFsaWFzZWQgYXMgYHRhaWxgIGFuZCBgZHJvcGAuXG4gIC8vIEVzcGVjaWFsbHkgdXNlZnVsIG9uIHRoZSBhcmd1bWVudHMgb2JqZWN0LiBQYXNzaW5nIGFuICoqbioqIHdpbGwgcmV0dXJuXG4gIC8vIHRoZSByZXN0IE4gdmFsdWVzIGluIHRoZSBhcnJheS4gVGhlICoqZ3VhcmQqKlxuICAvLyBjaGVjayBhbGxvd3MgaXQgdG8gd29yayB3aXRoIGBfLm1hcGAuXG4gIF8ucmVzdCA9IF8udGFpbCA9IF8uZHJvcCA9IGZ1bmN0aW9uKGFycmF5LCBuLCBndWFyZCkge1xuICAgIHJldHVybiBzbGljZS5jYWxsKGFycmF5LCAobiA9PSBudWxsKSB8fCBndWFyZCA/IDEgOiBuKTtcbiAgfTtcblxuICAvLyBUcmltIG91dCBhbGwgZmFsc3kgdmFsdWVzIGZyb20gYW4gYXJyYXkuXG4gIF8uY29tcGFjdCA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgcmV0dXJuIF8uZmlsdGVyKGFycmF5LCBfLmlkZW50aXR5KTtcbiAgfTtcblxuICAvLyBJbnRlcm5hbCBpbXBsZW1lbnRhdGlvbiBvZiBhIHJlY3Vyc2l2ZSBgZmxhdHRlbmAgZnVuY3Rpb24uXG4gIHZhciBmbGF0dGVuID0gZnVuY3Rpb24oaW5wdXQsIHNoYWxsb3csIG91dHB1dCkge1xuICAgIGlmIChzaGFsbG93ICYmIF8uZXZlcnkoaW5wdXQsIF8uaXNBcnJheSkpIHtcbiAgICAgIHJldHVybiBjb25jYXQuYXBwbHkob3V0cHV0LCBpbnB1dCk7XG4gICAgfVxuICAgIGVhY2goaW5wdXQsIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICBpZiAoXy5pc0FycmF5KHZhbHVlKSB8fCBfLmlzQXJndW1lbnRzKHZhbHVlKSkge1xuICAgICAgICBzaGFsbG93ID8gcHVzaC5hcHBseShvdXRwdXQsIHZhbHVlKSA6IGZsYXR0ZW4odmFsdWUsIHNoYWxsb3csIG91dHB1dCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBvdXRwdXQucHVzaCh2YWx1ZSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIG91dHB1dDtcbiAgfTtcblxuICAvLyBGbGF0dGVuIG91dCBhbiBhcnJheSwgZWl0aGVyIHJlY3Vyc2l2ZWx5IChieSBkZWZhdWx0KSwgb3IganVzdCBvbmUgbGV2ZWwuXG4gIF8uZmxhdHRlbiA9IGZ1bmN0aW9uKGFycmF5LCBzaGFsbG93KSB7XG4gICAgcmV0dXJuIGZsYXR0ZW4oYXJyYXksIHNoYWxsb3csIFtdKTtcbiAgfTtcblxuICAvLyBSZXR1cm4gYSB2ZXJzaW9uIG9mIHRoZSBhcnJheSB0aGF0IGRvZXMgbm90IGNvbnRhaW4gdGhlIHNwZWNpZmllZCB2YWx1ZShzKS5cbiAgXy53aXRob3V0ID0gZnVuY3Rpb24oYXJyYXkpIHtcbiAgICByZXR1cm4gXy5kaWZmZXJlbmNlKGFycmF5LCBzbGljZS5jYWxsKGFyZ3VtZW50cywgMSkpO1xuICB9O1xuXG4gIC8vIFNwbGl0IGFuIGFycmF5IGludG8gdHdvIGFycmF5czogb25lIHdob3NlIGVsZW1lbnRzIGFsbCBzYXRpc2Z5IHRoZSBnaXZlblxuICAvLyBwcmVkaWNhdGUsIGFuZCBvbmUgd2hvc2UgZWxlbWVudHMgYWxsIGRvIG5vdCBzYXRpc2Z5IHRoZSBwcmVkaWNhdGUuXG4gIF8ucGFydGl0aW9uID0gZnVuY3Rpb24oYXJyYXksIHByZWRpY2F0ZSkge1xuICAgIHZhciBwYXNzID0gW10sIGZhaWwgPSBbXTtcbiAgICBlYWNoKGFycmF5LCBmdW5jdGlvbihlbGVtKSB7XG4gICAgICAocHJlZGljYXRlKGVsZW0pID8gcGFzcyA6IGZhaWwpLnB1c2goZWxlbSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIFtwYXNzLCBmYWlsXTtcbiAgfTtcblxuICAvLyBQcm9kdWNlIGEgZHVwbGljYXRlLWZyZWUgdmVyc2lvbiBvZiB0aGUgYXJyYXkuIElmIHRoZSBhcnJheSBoYXMgYWxyZWFkeVxuICAvLyBiZWVuIHNvcnRlZCwgeW91IGhhdmUgdGhlIG9wdGlvbiBvZiB1c2luZyBhIGZhc3RlciBhbGdvcml0aG0uXG4gIC8vIEFsaWFzZWQgYXMgYHVuaXF1ZWAuXG4gIF8udW5pcSA9IF8udW5pcXVlID0gZnVuY3Rpb24oYXJyYXksIGlzU29ydGVkLCBpdGVyYXRvciwgY29udGV4dCkge1xuICAgIGlmIChfLmlzRnVuY3Rpb24oaXNTb3J0ZWQpKSB7XG4gICAgICBjb250ZXh0ID0gaXRlcmF0b3I7XG4gICAgICBpdGVyYXRvciA9IGlzU29ydGVkO1xuICAgICAgaXNTb3J0ZWQgPSBmYWxzZTtcbiAgICB9XG4gICAgdmFyIGluaXRpYWwgPSBpdGVyYXRvciA/IF8ubWFwKGFycmF5LCBpdGVyYXRvciwgY29udGV4dCkgOiBhcnJheTtcbiAgICB2YXIgcmVzdWx0cyA9IFtdO1xuICAgIHZhciBzZWVuID0gW107XG4gICAgZWFjaChpbml0aWFsLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgpIHtcbiAgICAgIGlmIChpc1NvcnRlZCA/ICghaW5kZXggfHwgc2VlbltzZWVuLmxlbmd0aCAtIDFdICE9PSB2YWx1ZSkgOiAhXy5jb250YWlucyhzZWVuLCB2YWx1ZSkpIHtcbiAgICAgICAgc2Vlbi5wdXNoKHZhbHVlKTtcbiAgICAgICAgcmVzdWx0cy5wdXNoKGFycmF5W2luZGV4XSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdHM7XG4gIH07XG5cbiAgLy8gUHJvZHVjZSBhbiBhcnJheSB0aGF0IGNvbnRhaW5zIHRoZSB1bmlvbjogZWFjaCBkaXN0aW5jdCBlbGVtZW50IGZyb20gYWxsIG9mXG4gIC8vIHRoZSBwYXNzZWQtaW4gYXJyYXlzLlxuICBfLnVuaW9uID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF8udW5pcShfLmZsYXR0ZW4oYXJndW1lbnRzLCB0cnVlKSk7XG4gIH07XG5cbiAgLy8gUHJvZHVjZSBhbiBhcnJheSB0aGF0IGNvbnRhaW5zIGV2ZXJ5IGl0ZW0gc2hhcmVkIGJldHdlZW4gYWxsIHRoZVxuICAvLyBwYXNzZWQtaW4gYXJyYXlzLlxuICBfLmludGVyc2VjdGlvbiA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgdmFyIHJlc3QgPSBzbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XG4gICAgcmV0dXJuIF8uZmlsdGVyKF8udW5pcShhcnJheSksIGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgIHJldHVybiBfLmV2ZXJ5KHJlc3QsIGZ1bmN0aW9uKG90aGVyKSB7XG4gICAgICAgIHJldHVybiBfLmNvbnRhaW5zKG90aGVyLCBpdGVtKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuXG4gIC8vIFRha2UgdGhlIGRpZmZlcmVuY2UgYmV0d2VlbiBvbmUgYXJyYXkgYW5kIGEgbnVtYmVyIG9mIG90aGVyIGFycmF5cy5cbiAgLy8gT25seSB0aGUgZWxlbWVudHMgcHJlc2VudCBpbiBqdXN0IHRoZSBmaXJzdCBhcnJheSB3aWxsIHJlbWFpbi5cbiAgXy5kaWZmZXJlbmNlID0gZnVuY3Rpb24oYXJyYXkpIHtcbiAgICB2YXIgcmVzdCA9IGNvbmNhdC5hcHBseShBcnJheVByb3RvLCBzbGljZS5jYWxsKGFyZ3VtZW50cywgMSkpO1xuICAgIHJldHVybiBfLmZpbHRlcihhcnJheSwgZnVuY3Rpb24odmFsdWUpeyByZXR1cm4gIV8uY29udGFpbnMocmVzdCwgdmFsdWUpOyB9KTtcbiAgfTtcblxuICAvLyBaaXAgdG9nZXRoZXIgbXVsdGlwbGUgbGlzdHMgaW50byBhIHNpbmdsZSBhcnJheSAtLSBlbGVtZW50cyB0aGF0IHNoYXJlXG4gIC8vIGFuIGluZGV4IGdvIHRvZ2V0aGVyLlxuICBfLnppcCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBsZW5ndGggPSBfLm1heChfLnBsdWNrKGFyZ3VtZW50cywgJ2xlbmd0aCcpLmNvbmNhdCgwKSk7XG4gICAgdmFyIHJlc3VsdHMgPSBuZXcgQXJyYXkobGVuZ3RoKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICByZXN1bHRzW2ldID0gXy5wbHVjayhhcmd1bWVudHMsICcnICsgaSk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHRzO1xuICB9O1xuXG4gIC8vIENvbnZlcnRzIGxpc3RzIGludG8gb2JqZWN0cy4gUGFzcyBlaXRoZXIgYSBzaW5nbGUgYXJyYXkgb2YgYFtrZXksIHZhbHVlXWBcbiAgLy8gcGFpcnMsIG9yIHR3byBwYXJhbGxlbCBhcnJheXMgb2YgdGhlIHNhbWUgbGVuZ3RoIC0tIG9uZSBvZiBrZXlzLCBhbmQgb25lIG9mXG4gIC8vIHRoZSBjb3JyZXNwb25kaW5nIHZhbHVlcy5cbiAgXy5vYmplY3QgPSBmdW5jdGlvbihsaXN0LCB2YWx1ZXMpIHtcbiAgICBpZiAobGlzdCA9PSBudWxsKSByZXR1cm4ge307XG4gICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBsaXN0Lmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAodmFsdWVzKSB7XG4gICAgICAgIHJlc3VsdFtsaXN0W2ldXSA9IHZhbHVlc1tpXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3VsdFtsaXN0W2ldWzBdXSA9IGxpc3RbaV1bMV07XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH07XG5cbiAgLy8gSWYgdGhlIGJyb3dzZXIgZG9lc24ndCBzdXBwbHkgdXMgd2l0aCBpbmRleE9mIChJJ20gbG9va2luZyBhdCB5b3UsICoqTVNJRSoqKSxcbiAgLy8gd2UgbmVlZCB0aGlzIGZ1bmN0aW9uLiBSZXR1cm4gdGhlIHBvc2l0aW9uIG9mIHRoZSBmaXJzdCBvY2N1cnJlbmNlIG9mIGFuXG4gIC8vIGl0ZW0gaW4gYW4gYXJyYXksIG9yIC0xIGlmIHRoZSBpdGVtIGlzIG5vdCBpbmNsdWRlZCBpbiB0aGUgYXJyYXkuXG4gIC8vIERlbGVnYXRlcyB0byAqKkVDTUFTY3JpcHQgNSoqJ3MgbmF0aXZlIGBpbmRleE9mYCBpZiBhdmFpbGFibGUuXG4gIC8vIElmIHRoZSBhcnJheSBpcyBsYXJnZSBhbmQgYWxyZWFkeSBpbiBzb3J0IG9yZGVyLCBwYXNzIGB0cnVlYFxuICAvLyBmb3IgKippc1NvcnRlZCoqIHRvIHVzZSBiaW5hcnkgc2VhcmNoLlxuICBfLmluZGV4T2YgPSBmdW5jdGlvbihhcnJheSwgaXRlbSwgaXNTb3J0ZWQpIHtcbiAgICBpZiAoYXJyYXkgPT0gbnVsbCkgcmV0dXJuIC0xO1xuICAgIHZhciBpID0gMCwgbGVuZ3RoID0gYXJyYXkubGVuZ3RoO1xuICAgIGlmIChpc1NvcnRlZCkge1xuICAgICAgaWYgKHR5cGVvZiBpc1NvcnRlZCA9PSAnbnVtYmVyJykge1xuICAgICAgICBpID0gKGlzU29ydGVkIDwgMCA/IE1hdGgubWF4KDAsIGxlbmd0aCArIGlzU29ydGVkKSA6IGlzU29ydGVkKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGkgPSBfLnNvcnRlZEluZGV4KGFycmF5LCBpdGVtKTtcbiAgICAgICAgcmV0dXJuIGFycmF5W2ldID09PSBpdGVtID8gaSA6IC0xO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAobmF0aXZlSW5kZXhPZiAmJiBhcnJheS5pbmRleE9mID09PSBuYXRpdmVJbmRleE9mKSByZXR1cm4gYXJyYXkuaW5kZXhPZihpdGVtLCBpc1NvcnRlZCk7XG4gICAgZm9yICg7IGkgPCBsZW5ndGg7IGkrKykgaWYgKGFycmF5W2ldID09PSBpdGVtKSByZXR1cm4gaTtcbiAgICByZXR1cm4gLTE7XG4gIH07XG5cbiAgLy8gRGVsZWdhdGVzIHRvICoqRUNNQVNjcmlwdCA1KioncyBuYXRpdmUgYGxhc3RJbmRleE9mYCBpZiBhdmFpbGFibGUuXG4gIF8ubGFzdEluZGV4T2YgPSBmdW5jdGlvbihhcnJheSwgaXRlbSwgZnJvbSkge1xuICAgIGlmIChhcnJheSA9PSBudWxsKSByZXR1cm4gLTE7XG4gICAgdmFyIGhhc0luZGV4ID0gZnJvbSAhPSBudWxsO1xuICAgIGlmIChuYXRpdmVMYXN0SW5kZXhPZiAmJiBhcnJheS5sYXN0SW5kZXhPZiA9PT0gbmF0aXZlTGFzdEluZGV4T2YpIHtcbiAgICAgIHJldHVybiBoYXNJbmRleCA/IGFycmF5Lmxhc3RJbmRleE9mKGl0ZW0sIGZyb20pIDogYXJyYXkubGFzdEluZGV4T2YoaXRlbSk7XG4gICAgfVxuICAgIHZhciBpID0gKGhhc0luZGV4ID8gZnJvbSA6IGFycmF5Lmxlbmd0aCk7XG4gICAgd2hpbGUgKGktLSkgaWYgKGFycmF5W2ldID09PSBpdGVtKSByZXR1cm4gaTtcbiAgICByZXR1cm4gLTE7XG4gIH07XG5cbiAgLy8gR2VuZXJhdGUgYW4gaW50ZWdlciBBcnJheSBjb250YWluaW5nIGFuIGFyaXRobWV0aWMgcHJvZ3Jlc3Npb24uIEEgcG9ydCBvZlxuICAvLyB0aGUgbmF0aXZlIFB5dGhvbiBgcmFuZ2UoKWAgZnVuY3Rpb24uIFNlZVxuICAvLyBbdGhlIFB5dGhvbiBkb2N1bWVudGF0aW9uXShodHRwOi8vZG9jcy5weXRob24ub3JnL2xpYnJhcnkvZnVuY3Rpb25zLmh0bWwjcmFuZ2UpLlxuICBfLnJhbmdlID0gZnVuY3Rpb24oc3RhcnQsIHN0b3AsIHN0ZXApIHtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA8PSAxKSB7XG4gICAgICBzdG9wID0gc3RhcnQgfHwgMDtcbiAgICAgIHN0YXJ0ID0gMDtcbiAgICB9XG4gICAgc3RlcCA9IGFyZ3VtZW50c1syXSB8fCAxO1xuXG4gICAgdmFyIGxlbmd0aCA9IE1hdGgubWF4KE1hdGguY2VpbCgoc3RvcCAtIHN0YXJ0KSAvIHN0ZXApLCAwKTtcbiAgICB2YXIgaWR4ID0gMDtcbiAgICB2YXIgcmFuZ2UgPSBuZXcgQXJyYXkobGVuZ3RoKTtcblxuICAgIHdoaWxlKGlkeCA8IGxlbmd0aCkge1xuICAgICAgcmFuZ2VbaWR4KytdID0gc3RhcnQ7XG4gICAgICBzdGFydCArPSBzdGVwO1xuICAgIH1cblxuICAgIHJldHVybiByYW5nZTtcbiAgfTtcblxuICAvLyBGdW5jdGlvbiAoYWhlbSkgRnVuY3Rpb25zXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIC8vIFJldXNhYmxlIGNvbnN0cnVjdG9yIGZ1bmN0aW9uIGZvciBwcm90b3R5cGUgc2V0dGluZy5cbiAgdmFyIGN0b3IgPSBmdW5jdGlvbigpe307XG5cbiAgLy8gQ3JlYXRlIGEgZnVuY3Rpb24gYm91bmQgdG8gYSBnaXZlbiBvYmplY3QgKGFzc2lnbmluZyBgdGhpc2AsIGFuZCBhcmd1bWVudHMsXG4gIC8vIG9wdGlvbmFsbHkpLiBEZWxlZ2F0ZXMgdG8gKipFQ01BU2NyaXB0IDUqKidzIG5hdGl2ZSBgRnVuY3Rpb24uYmluZGAgaWZcbiAgLy8gYXZhaWxhYmxlLlxuICBfLmJpbmQgPSBmdW5jdGlvbihmdW5jLCBjb250ZXh0KSB7XG4gICAgdmFyIGFyZ3MsIGJvdW5kO1xuICAgIGlmIChuYXRpdmVCaW5kICYmIGZ1bmMuYmluZCA9PT0gbmF0aXZlQmluZCkgcmV0dXJuIG5hdGl2ZUJpbmQuYXBwbHkoZnVuYywgc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKTtcbiAgICBpZiAoIV8uaXNGdW5jdGlvbihmdW5jKSkgdGhyb3cgbmV3IFR5cGVFcnJvcjtcbiAgICBhcmdzID0gc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpO1xuICAgIHJldHVybiBib3VuZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIGJvdW5kKSkgcmV0dXJuIGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncy5jb25jYXQoc2xpY2UuY2FsbChhcmd1bWVudHMpKSk7XG4gICAgICBjdG9yLnByb3RvdHlwZSA9IGZ1bmMucHJvdG90eXBlO1xuICAgICAgdmFyIHNlbGYgPSBuZXcgY3RvcjtcbiAgICAgIGN0b3IucHJvdG90eXBlID0gbnVsbDtcbiAgICAgIHZhciByZXN1bHQgPSBmdW5jLmFwcGx5KHNlbGYsIGFyZ3MuY29uY2F0KHNsaWNlLmNhbGwoYXJndW1lbnRzKSkpO1xuICAgICAgaWYgKE9iamVjdChyZXN1bHQpID09PSByZXN1bHQpIHJldHVybiByZXN1bHQ7XG4gICAgICByZXR1cm4gc2VsZjtcbiAgICB9O1xuICB9O1xuXG4gIC8vIFBhcnRpYWxseSBhcHBseSBhIGZ1bmN0aW9uIGJ5IGNyZWF0aW5nIGEgdmVyc2lvbiB0aGF0IGhhcyBoYWQgc29tZSBvZiBpdHNcbiAgLy8gYXJndW1lbnRzIHByZS1maWxsZWQsIHdpdGhvdXQgY2hhbmdpbmcgaXRzIGR5bmFtaWMgYHRoaXNgIGNvbnRleHQuIF8gYWN0c1xuICAvLyBhcyBhIHBsYWNlaG9sZGVyLCBhbGxvd2luZyBhbnkgY29tYmluYXRpb24gb2YgYXJndW1lbnRzIHRvIGJlIHByZS1maWxsZWQuXG4gIF8ucGFydGlhbCA9IGZ1bmN0aW9uKGZ1bmMpIHtcbiAgICB2YXIgYm91bmRBcmdzID0gc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpO1xuICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBwb3NpdGlvbiA9IDA7XG4gICAgICB2YXIgYXJncyA9IGJvdW5kQXJncy5zbGljZSgpO1xuICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IGFyZ3MubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGFyZ3NbaV0gPT09IF8pIGFyZ3NbaV0gPSBhcmd1bWVudHNbcG9zaXRpb24rK107XG4gICAgICB9XG4gICAgICB3aGlsZSAocG9zaXRpb24gPCBhcmd1bWVudHMubGVuZ3RoKSBhcmdzLnB1c2goYXJndW1lbnRzW3Bvc2l0aW9uKytdKTtcbiAgICAgIHJldHVybiBmdW5jLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgIH07XG4gIH07XG5cbiAgLy8gQmluZCBhIG51bWJlciBvZiBhbiBvYmplY3QncyBtZXRob2RzIHRvIHRoYXQgb2JqZWN0LiBSZW1haW5pbmcgYXJndW1lbnRzXG4gIC8vIGFyZSB0aGUgbWV0aG9kIG5hbWVzIHRvIGJlIGJvdW5kLiBVc2VmdWwgZm9yIGVuc3VyaW5nIHRoYXQgYWxsIGNhbGxiYWNrc1xuICAvLyBkZWZpbmVkIG9uIGFuIG9iamVjdCBiZWxvbmcgdG8gaXQuXG4gIF8uYmluZEFsbCA9IGZ1bmN0aW9uKG9iaikge1xuICAgIHZhciBmdW5jcyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTtcbiAgICBpZiAoZnVuY3MubGVuZ3RoID09PSAwKSB0aHJvdyBuZXcgRXJyb3IoJ2JpbmRBbGwgbXVzdCBiZSBwYXNzZWQgZnVuY3Rpb24gbmFtZXMnKTtcbiAgICBlYWNoKGZ1bmNzLCBmdW5jdGlvbihmKSB7IG9ialtmXSA9IF8uYmluZChvYmpbZl0sIG9iaik7IH0pO1xuICAgIHJldHVybiBvYmo7XG4gIH07XG5cbiAgLy8gTWVtb2l6ZSBhbiBleHBlbnNpdmUgZnVuY3Rpb24gYnkgc3RvcmluZyBpdHMgcmVzdWx0cy5cbiAgXy5tZW1vaXplID0gZnVuY3Rpb24oZnVuYywgaGFzaGVyKSB7XG4gICAgdmFyIG1lbW8gPSB7fTtcbiAgICBoYXNoZXIgfHwgKGhhc2hlciA9IF8uaWRlbnRpdHkpO1xuICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBrZXkgPSBoYXNoZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIHJldHVybiBfLmhhcyhtZW1vLCBrZXkpID8gbWVtb1trZXldIDogKG1lbW9ba2V5XSA9IGZ1bmMuYXBwbHkodGhpcywgYXJndW1lbnRzKSk7XG4gICAgfTtcbiAgfTtcblxuICAvLyBEZWxheXMgYSBmdW5jdGlvbiBmb3IgdGhlIGdpdmVuIG51bWJlciBvZiBtaWxsaXNlY29uZHMsIGFuZCB0aGVuIGNhbGxzXG4gIC8vIGl0IHdpdGggdGhlIGFyZ3VtZW50cyBzdXBwbGllZC5cbiAgXy5kZWxheSA9IGZ1bmN0aW9uKGZ1bmMsIHdhaXQpIHtcbiAgICB2YXIgYXJncyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKTtcbiAgICByZXR1cm4gc2V0VGltZW91dChmdW5jdGlvbigpeyByZXR1cm4gZnVuYy5hcHBseShudWxsLCBhcmdzKTsgfSwgd2FpdCk7XG4gIH07XG5cbiAgLy8gRGVmZXJzIGEgZnVuY3Rpb24sIHNjaGVkdWxpbmcgaXQgdG8gcnVuIGFmdGVyIHRoZSBjdXJyZW50IGNhbGwgc3RhY2sgaGFzXG4gIC8vIGNsZWFyZWQuXG4gIF8uZGVmZXIgPSBmdW5jdGlvbihmdW5jKSB7XG4gICAgcmV0dXJuIF8uZGVsYXkuYXBwbHkoXywgW2Z1bmMsIDFdLmNvbmNhdChzbGljZS5jYWxsKGFyZ3VtZW50cywgMSkpKTtcbiAgfTtcblxuICAvLyBSZXR1cm5zIGEgZnVuY3Rpb24sIHRoYXQsIHdoZW4gaW52b2tlZCwgd2lsbCBvbmx5IGJlIHRyaWdnZXJlZCBhdCBtb3N0IG9uY2VcbiAgLy8gZHVyaW5nIGEgZ2l2ZW4gd2luZG93IG9mIHRpbWUuIE5vcm1hbGx5LCB0aGUgdGhyb3R0bGVkIGZ1bmN0aW9uIHdpbGwgcnVuXG4gIC8vIGFzIG11Y2ggYXMgaXQgY2FuLCB3aXRob3V0IGV2ZXIgZ29pbmcgbW9yZSB0aGFuIG9uY2UgcGVyIGB3YWl0YCBkdXJhdGlvbjtcbiAgLy8gYnV0IGlmIHlvdSdkIGxpa2UgdG8gZGlzYWJsZSB0aGUgZXhlY3V0aW9uIG9uIHRoZSBsZWFkaW5nIGVkZ2UsIHBhc3NcbiAgLy8gYHtsZWFkaW5nOiBmYWxzZX1gLiBUbyBkaXNhYmxlIGV4ZWN1dGlvbiBvbiB0aGUgdHJhaWxpbmcgZWRnZSwgZGl0dG8uXG4gIF8udGhyb3R0bGUgPSBmdW5jdGlvbihmdW5jLCB3YWl0LCBvcHRpb25zKSB7XG4gICAgdmFyIGNvbnRleHQsIGFyZ3MsIHJlc3VsdDtcbiAgICB2YXIgdGltZW91dCA9IG51bGw7XG4gICAgdmFyIHByZXZpb3VzID0gMDtcbiAgICBvcHRpb25zIHx8IChvcHRpb25zID0ge30pO1xuICAgIHZhciBsYXRlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgcHJldmlvdXMgPSBvcHRpb25zLmxlYWRpbmcgPT09IGZhbHNlID8gMCA6IF8ubm93KCk7XG4gICAgICB0aW1lb3V0ID0gbnVsbDtcbiAgICAgIHJlc3VsdCA9IGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7XG4gICAgICBjb250ZXh0ID0gYXJncyA9IG51bGw7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgbm93ID0gXy5ub3coKTtcbiAgICAgIGlmICghcHJldmlvdXMgJiYgb3B0aW9ucy5sZWFkaW5nID09PSBmYWxzZSkgcHJldmlvdXMgPSBub3c7XG4gICAgICB2YXIgcmVtYWluaW5nID0gd2FpdCAtIChub3cgLSBwcmV2aW91cyk7XG4gICAgICBjb250ZXh0ID0gdGhpcztcbiAgICAgIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICBpZiAocmVtYWluaW5nIDw9IDApIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuICAgICAgICB0aW1lb3V0ID0gbnVsbDtcbiAgICAgICAgcHJldmlvdXMgPSBub3c7XG4gICAgICAgIHJlc3VsdCA9IGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7XG4gICAgICAgIGNvbnRleHQgPSBhcmdzID0gbnVsbDtcbiAgICAgIH0gZWxzZSBpZiAoIXRpbWVvdXQgJiYgb3B0aW9ucy50cmFpbGluZyAhPT0gZmFsc2UpIHtcbiAgICAgICAgdGltZW91dCA9IHNldFRpbWVvdXQobGF0ZXIsIHJlbWFpbmluZyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gIH07XG5cbiAgLy8gUmV0dXJucyBhIGZ1bmN0aW9uLCB0aGF0LCBhcyBsb25nIGFzIGl0IGNvbnRpbnVlcyB0byBiZSBpbnZva2VkLCB3aWxsIG5vdFxuICAvLyBiZSB0cmlnZ2VyZWQuIFRoZSBmdW5jdGlvbiB3aWxsIGJlIGNhbGxlZCBhZnRlciBpdCBzdG9wcyBiZWluZyBjYWxsZWQgZm9yXG4gIC8vIE4gbWlsbGlzZWNvbmRzLiBJZiBgaW1tZWRpYXRlYCBpcyBwYXNzZWQsIHRyaWdnZXIgdGhlIGZ1bmN0aW9uIG9uIHRoZVxuICAvLyBsZWFkaW5nIGVkZ2UsIGluc3RlYWQgb2YgdGhlIHRyYWlsaW5nLlxuICBfLmRlYm91bmNlID0gZnVuY3Rpb24oZnVuYywgd2FpdCwgaW1tZWRpYXRlKSB7XG4gICAgdmFyIHRpbWVvdXQsIGFyZ3MsIGNvbnRleHQsIHRpbWVzdGFtcCwgcmVzdWx0O1xuXG4gICAgdmFyIGxhdGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgbGFzdCA9IF8ubm93KCkgLSB0aW1lc3RhbXA7XG4gICAgICBpZiAobGFzdCA8IHdhaXQpIHtcbiAgICAgICAgdGltZW91dCA9IHNldFRpbWVvdXQobGF0ZXIsIHdhaXQgLSBsYXN0KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRpbWVvdXQgPSBudWxsO1xuICAgICAgICBpZiAoIWltbWVkaWF0ZSkge1xuICAgICAgICAgIHJlc3VsdCA9IGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7XG4gICAgICAgICAgY29udGV4dCA9IGFyZ3MgPSBudWxsO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgIGNvbnRleHQgPSB0aGlzO1xuICAgICAgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgIHRpbWVzdGFtcCA9IF8ubm93KCk7XG4gICAgICB2YXIgY2FsbE5vdyA9IGltbWVkaWF0ZSAmJiAhdGltZW91dDtcbiAgICAgIGlmICghdGltZW91dCkge1xuICAgICAgICB0aW1lb3V0ID0gc2V0VGltZW91dChsYXRlciwgd2FpdCk7XG4gICAgICB9XG4gICAgICBpZiAoY2FsbE5vdykge1xuICAgICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xuICAgICAgICBjb250ZXh0ID0gYXJncyA9IG51bGw7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgfTtcblxuICAvLyBSZXR1cm5zIGEgZnVuY3Rpb24gdGhhdCB3aWxsIGJlIGV4ZWN1dGVkIGF0IG1vc3Qgb25lIHRpbWUsIG5vIG1hdHRlciBob3dcbiAgLy8gb2Z0ZW4geW91IGNhbGwgaXQuIFVzZWZ1bCBmb3IgbGF6eSBpbml0aWFsaXphdGlvbi5cbiAgXy5vbmNlID0gZnVuY3Rpb24oZnVuYykge1xuICAgIHZhciByYW4gPSBmYWxzZSwgbWVtbztcbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAocmFuKSByZXR1cm4gbWVtbztcbiAgICAgIHJhbiA9IHRydWU7XG4gICAgICBtZW1vID0gZnVuYy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgZnVuYyA9IG51bGw7XG4gICAgICByZXR1cm4gbWVtbztcbiAgICB9O1xuICB9O1xuXG4gIC8vIFJldHVybnMgdGhlIGZpcnN0IGZ1bmN0aW9uIHBhc3NlZCBhcyBhbiBhcmd1bWVudCB0byB0aGUgc2Vjb25kLFxuICAvLyBhbGxvd2luZyB5b3UgdG8gYWRqdXN0IGFyZ3VtZW50cywgcnVuIGNvZGUgYmVmb3JlIGFuZCBhZnRlciwgYW5kXG4gIC8vIGNvbmRpdGlvbmFsbHkgZXhlY3V0ZSB0aGUgb3JpZ2luYWwgZnVuY3Rpb24uXG4gIF8ud3JhcCA9IGZ1bmN0aW9uKGZ1bmMsIHdyYXBwZXIpIHtcbiAgICByZXR1cm4gXy5wYXJ0aWFsKHdyYXBwZXIsIGZ1bmMpO1xuICB9O1xuXG4gIC8vIFJldHVybnMgYSBmdW5jdGlvbiB0aGF0IGlzIHRoZSBjb21wb3NpdGlvbiBvZiBhIGxpc3Qgb2YgZnVuY3Rpb25zLCBlYWNoXG4gIC8vIGNvbnN1bWluZyB0aGUgcmV0dXJuIHZhbHVlIG9mIHRoZSBmdW5jdGlvbiB0aGF0IGZvbGxvd3MuXG4gIF8uY29tcG9zZSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBmdW5jcyA9IGFyZ3VtZW50cztcbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgIGZvciAodmFyIGkgPSBmdW5jcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICBhcmdzID0gW2Z1bmNzW2ldLmFwcGx5KHRoaXMsIGFyZ3MpXTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBhcmdzWzBdO1xuICAgIH07XG4gIH07XG5cbiAgLy8gUmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQgd2lsbCBvbmx5IGJlIGV4ZWN1dGVkIGFmdGVyIGJlaW5nIGNhbGxlZCBOIHRpbWVzLlxuICBfLmFmdGVyID0gZnVuY3Rpb24odGltZXMsIGZ1bmMpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoLS10aW1lcyA8IDEpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIH1cbiAgICB9O1xuICB9O1xuXG4gIC8vIE9iamVjdCBGdW5jdGlvbnNcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLVxuXG4gIC8vIFJldHJpZXZlIHRoZSBuYW1lcyBvZiBhbiBvYmplY3QncyBwcm9wZXJ0aWVzLlxuICAvLyBEZWxlZ2F0ZXMgdG8gKipFQ01BU2NyaXB0IDUqKidzIG5hdGl2ZSBgT2JqZWN0LmtleXNgXG4gIF8ua2V5cyA9IGZ1bmN0aW9uKG9iaikge1xuICAgIGlmICghXy5pc09iamVjdChvYmopKSByZXR1cm4gW107XG4gICAgaWYgKG5hdGl2ZUtleXMpIHJldHVybiBuYXRpdmVLZXlzKG9iaik7XG4gICAgdmFyIGtleXMgPSBbXTtcbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSBpZiAoXy5oYXMob2JqLCBrZXkpKSBrZXlzLnB1c2goa2V5KTtcbiAgICByZXR1cm4ga2V5cztcbiAgfTtcblxuICAvLyBSZXRyaWV2ZSB0aGUgdmFsdWVzIG9mIGFuIG9iamVjdCdzIHByb3BlcnRpZXMuXG4gIF8udmFsdWVzID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgdmFyIGtleXMgPSBfLmtleXMob2JqKTtcbiAgICB2YXIgbGVuZ3RoID0ga2V5cy5sZW5ndGg7XG4gICAgdmFyIHZhbHVlcyA9IG5ldyBBcnJheShsZW5ndGgpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhbHVlc1tpXSA9IG9ialtrZXlzW2ldXTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlcztcbiAgfTtcblxuICAvLyBDb252ZXJ0IGFuIG9iamVjdCBpbnRvIGEgbGlzdCBvZiBgW2tleSwgdmFsdWVdYCBwYWlycy5cbiAgXy5wYWlycyA9IGZ1bmN0aW9uKG9iaikge1xuICAgIHZhciBrZXlzID0gXy5rZXlzKG9iaik7XG4gICAgdmFyIGxlbmd0aCA9IGtleXMubGVuZ3RoO1xuICAgIHZhciBwYWlycyA9IG5ldyBBcnJheShsZW5ndGgpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIHBhaXJzW2ldID0gW2tleXNbaV0sIG9ialtrZXlzW2ldXV07XG4gICAgfVxuICAgIHJldHVybiBwYWlycztcbiAgfTtcblxuICAvLyBJbnZlcnQgdGhlIGtleXMgYW5kIHZhbHVlcyBvZiBhbiBvYmplY3QuIFRoZSB2YWx1ZXMgbXVzdCBiZSBzZXJpYWxpemFibGUuXG4gIF8uaW52ZXJ0ID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgIHZhciBrZXlzID0gXy5rZXlzKG9iaik7XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IGtleXMubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIHJlc3VsdFtvYmpba2V5c1tpXV1dID0ga2V5c1tpXTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICAvLyBSZXR1cm4gYSBzb3J0ZWQgbGlzdCBvZiB0aGUgZnVuY3Rpb24gbmFtZXMgYXZhaWxhYmxlIG9uIHRoZSBvYmplY3QuXG4gIC8vIEFsaWFzZWQgYXMgYG1ldGhvZHNgXG4gIF8uZnVuY3Rpb25zID0gXy5tZXRob2RzID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgdmFyIG5hbWVzID0gW107XG4gICAgZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgICAgaWYgKF8uaXNGdW5jdGlvbihvYmpba2V5XSkpIG5hbWVzLnB1c2goa2V5KTtcbiAgICB9XG4gICAgcmV0dXJuIG5hbWVzLnNvcnQoKTtcbiAgfTtcblxuICAvLyBFeHRlbmQgYSBnaXZlbiBvYmplY3Qgd2l0aCBhbGwgdGhlIHByb3BlcnRpZXMgaW4gcGFzc2VkLWluIG9iamVjdChzKS5cbiAgXy5leHRlbmQgPSBmdW5jdGlvbihvYmopIHtcbiAgICBlYWNoKHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSwgZnVuY3Rpb24oc291cmNlKSB7XG4gICAgICBpZiAoc291cmNlKSB7XG4gICAgICAgIGZvciAodmFyIHByb3AgaW4gc291cmNlKSB7XG4gICAgICAgICAgb2JqW3Byb3BdID0gc291cmNlW3Byb3BdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIG9iajtcbiAgfTtcblxuICAvLyBSZXR1cm4gYSBjb3B5IG9mIHRoZSBvYmplY3Qgb25seSBjb250YWluaW5nIHRoZSB3aGl0ZWxpc3RlZCBwcm9wZXJ0aWVzLlxuICBfLnBpY2sgPSBmdW5jdGlvbihvYmopIHtcbiAgICB2YXIgY29weSA9IHt9O1xuICAgIHZhciBrZXlzID0gY29uY2F0LmFwcGx5KEFycmF5UHJvdG8sIHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7XG4gICAgZWFjaChrZXlzLCBmdW5jdGlvbihrZXkpIHtcbiAgICAgIGlmIChrZXkgaW4gb2JqKSBjb3B5W2tleV0gPSBvYmpba2V5XTtcbiAgICB9KTtcbiAgICByZXR1cm4gY29weTtcbiAgfTtcblxuICAgLy8gUmV0dXJuIGEgY29weSBvZiB0aGUgb2JqZWN0IHdpdGhvdXQgdGhlIGJsYWNrbGlzdGVkIHByb3BlcnRpZXMuXG4gIF8ub21pdCA9IGZ1bmN0aW9uKG9iaikge1xuICAgIHZhciBjb3B5ID0ge307XG4gICAgdmFyIGtleXMgPSBjb25jYXQuYXBwbHkoQXJyYXlQcm90bywgc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKTtcbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG4gICAgICBpZiAoIV8uY29udGFpbnMoa2V5cywga2V5KSkgY29weVtrZXldID0gb2JqW2tleV07XG4gICAgfVxuICAgIHJldHVybiBjb3B5O1xuICB9O1xuXG4gIC8vIEZpbGwgaW4gYSBnaXZlbiBvYmplY3Qgd2l0aCBkZWZhdWx0IHByb3BlcnRpZXMuXG4gIF8uZGVmYXVsdHMgPSBmdW5jdGlvbihvYmopIHtcbiAgICBlYWNoKHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSwgZnVuY3Rpb24oc291cmNlKSB7XG4gICAgICBpZiAoc291cmNlKSB7XG4gICAgICAgIGZvciAodmFyIHByb3AgaW4gc291cmNlKSB7XG4gICAgICAgICAgaWYgKG9ialtwcm9wXSA9PT0gdm9pZCAwKSBvYmpbcHJvcF0gPSBzb3VyY2VbcHJvcF07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gb2JqO1xuICB9O1xuXG4gIC8vIENyZWF0ZSBhIChzaGFsbG93LWNsb25lZCkgZHVwbGljYXRlIG9mIGFuIG9iamVjdC5cbiAgXy5jbG9uZSA9IGZ1bmN0aW9uKG9iaikge1xuICAgIGlmICghXy5pc09iamVjdChvYmopKSByZXR1cm4gb2JqO1xuICAgIHJldHVybiBfLmlzQXJyYXkob2JqKSA/IG9iai5zbGljZSgpIDogXy5leHRlbmQoe30sIG9iaik7XG4gIH07XG5cbiAgLy8gSW52b2tlcyBpbnRlcmNlcHRvciB3aXRoIHRoZSBvYmosIGFuZCB0aGVuIHJldHVybnMgb2JqLlxuICAvLyBUaGUgcHJpbWFyeSBwdXJwb3NlIG9mIHRoaXMgbWV0aG9kIGlzIHRvIFwidGFwIGludG9cIiBhIG1ldGhvZCBjaGFpbiwgaW5cbiAgLy8gb3JkZXIgdG8gcGVyZm9ybSBvcGVyYXRpb25zIG9uIGludGVybWVkaWF0ZSByZXN1bHRzIHdpdGhpbiB0aGUgY2hhaW4uXG4gIF8udGFwID0gZnVuY3Rpb24ob2JqLCBpbnRlcmNlcHRvcikge1xuICAgIGludGVyY2VwdG9yKG9iaik7XG4gICAgcmV0dXJuIG9iajtcbiAgfTtcblxuICAvLyBJbnRlcm5hbCByZWN1cnNpdmUgY29tcGFyaXNvbiBmdW5jdGlvbiBmb3IgYGlzRXF1YWxgLlxuICB2YXIgZXEgPSBmdW5jdGlvbihhLCBiLCBhU3RhY2ssIGJTdGFjaykge1xuICAgIC8vIElkZW50aWNhbCBvYmplY3RzIGFyZSBlcXVhbC4gYDAgPT09IC0wYCwgYnV0IHRoZXkgYXJlbid0IGlkZW50aWNhbC5cbiAgICAvLyBTZWUgdGhlIFtIYXJtb255IGBlZ2FsYCBwcm9wb3NhbF0oaHR0cDovL3dpa2kuZWNtYXNjcmlwdC5vcmcvZG9rdS5waHA/aWQ9aGFybW9ueTplZ2FsKS5cbiAgICBpZiAoYSA9PT0gYikgcmV0dXJuIGEgIT09IDAgfHwgMSAvIGEgPT0gMSAvIGI7XG4gICAgLy8gQSBzdHJpY3QgY29tcGFyaXNvbiBpcyBuZWNlc3NhcnkgYmVjYXVzZSBgbnVsbCA9PSB1bmRlZmluZWRgLlxuICAgIGlmIChhID09IG51bGwgfHwgYiA9PSBudWxsKSByZXR1cm4gYSA9PT0gYjtcbiAgICAvLyBVbndyYXAgYW55IHdyYXBwZWQgb2JqZWN0cy5cbiAgICBpZiAoYSBpbnN0YW5jZW9mIF8pIGEgPSBhLl93cmFwcGVkO1xuICAgIGlmIChiIGluc3RhbmNlb2YgXykgYiA9IGIuX3dyYXBwZWQ7XG4gICAgLy8gQ29tcGFyZSBgW1tDbGFzc11dYCBuYW1lcy5cbiAgICB2YXIgY2xhc3NOYW1lID0gdG9TdHJpbmcuY2FsbChhKTtcbiAgICBpZiAoY2xhc3NOYW1lICE9IHRvU3RyaW5nLmNhbGwoYikpIHJldHVybiBmYWxzZTtcbiAgICBzd2l0Y2ggKGNsYXNzTmFtZSkge1xuICAgICAgLy8gU3RyaW5ncywgbnVtYmVycywgZGF0ZXMsIGFuZCBib29sZWFucyBhcmUgY29tcGFyZWQgYnkgdmFsdWUuXG4gICAgICBjYXNlICdbb2JqZWN0IFN0cmluZ10nOlxuICAgICAgICAvLyBQcmltaXRpdmVzIGFuZCB0aGVpciBjb3JyZXNwb25kaW5nIG9iamVjdCB3cmFwcGVycyBhcmUgZXF1aXZhbGVudDsgdGh1cywgYFwiNVwiYCBpc1xuICAgICAgICAvLyBlcXVpdmFsZW50IHRvIGBuZXcgU3RyaW5nKFwiNVwiKWAuXG4gICAgICAgIHJldHVybiBhID09IFN0cmluZyhiKTtcbiAgICAgIGNhc2UgJ1tvYmplY3QgTnVtYmVyXSc6XG4gICAgICAgIC8vIGBOYU5gcyBhcmUgZXF1aXZhbGVudCwgYnV0IG5vbi1yZWZsZXhpdmUuIEFuIGBlZ2FsYCBjb21wYXJpc29uIGlzIHBlcmZvcm1lZCBmb3JcbiAgICAgICAgLy8gb3RoZXIgbnVtZXJpYyB2YWx1ZXMuXG4gICAgICAgIHJldHVybiBhICE9ICthID8gYiAhPSArYiA6IChhID09IDAgPyAxIC8gYSA9PSAxIC8gYiA6IGEgPT0gK2IpO1xuICAgICAgY2FzZSAnW29iamVjdCBEYXRlXSc6XG4gICAgICBjYXNlICdbb2JqZWN0IEJvb2xlYW5dJzpcbiAgICAgICAgLy8gQ29lcmNlIGRhdGVzIGFuZCBib29sZWFucyB0byBudW1lcmljIHByaW1pdGl2ZSB2YWx1ZXMuIERhdGVzIGFyZSBjb21wYXJlZCBieSB0aGVpclxuICAgICAgICAvLyBtaWxsaXNlY29uZCByZXByZXNlbnRhdGlvbnMuIE5vdGUgdGhhdCBpbnZhbGlkIGRhdGVzIHdpdGggbWlsbGlzZWNvbmQgcmVwcmVzZW50YXRpb25zXG4gICAgICAgIC8vIG9mIGBOYU5gIGFyZSBub3QgZXF1aXZhbGVudC5cbiAgICAgICAgcmV0dXJuICthID09ICtiO1xuICAgICAgLy8gUmVnRXhwcyBhcmUgY29tcGFyZWQgYnkgdGhlaXIgc291cmNlIHBhdHRlcm5zIGFuZCBmbGFncy5cbiAgICAgIGNhc2UgJ1tvYmplY3QgUmVnRXhwXSc6XG4gICAgICAgIHJldHVybiBhLnNvdXJjZSA9PSBiLnNvdXJjZSAmJlxuICAgICAgICAgICAgICAgYS5nbG9iYWwgPT0gYi5nbG9iYWwgJiZcbiAgICAgICAgICAgICAgIGEubXVsdGlsaW5lID09IGIubXVsdGlsaW5lICYmXG4gICAgICAgICAgICAgICBhLmlnbm9yZUNhc2UgPT0gYi5pZ25vcmVDYXNlO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGEgIT0gJ29iamVjdCcgfHwgdHlwZW9mIGIgIT0gJ29iamVjdCcpIHJldHVybiBmYWxzZTtcbiAgICAvLyBBc3N1bWUgZXF1YWxpdHkgZm9yIGN5Y2xpYyBzdHJ1Y3R1cmVzLiBUaGUgYWxnb3JpdGhtIGZvciBkZXRlY3RpbmcgY3ljbGljXG4gICAgLy8gc3RydWN0dXJlcyBpcyBhZGFwdGVkIGZyb20gRVMgNS4xIHNlY3Rpb24gMTUuMTIuMywgYWJzdHJhY3Qgb3BlcmF0aW9uIGBKT2AuXG4gICAgdmFyIGxlbmd0aCA9IGFTdGFjay5sZW5ndGg7XG4gICAgd2hpbGUgKGxlbmd0aC0tKSB7XG4gICAgICAvLyBMaW5lYXIgc2VhcmNoLiBQZXJmb3JtYW5jZSBpcyBpbnZlcnNlbHkgcHJvcG9ydGlvbmFsIHRvIHRoZSBudW1iZXIgb2ZcbiAgICAgIC8vIHVuaXF1ZSBuZXN0ZWQgc3RydWN0dXJlcy5cbiAgICAgIGlmIChhU3RhY2tbbGVuZ3RoXSA9PSBhKSByZXR1cm4gYlN0YWNrW2xlbmd0aF0gPT0gYjtcbiAgICB9XG4gICAgLy8gT2JqZWN0cyB3aXRoIGRpZmZlcmVudCBjb25zdHJ1Y3RvcnMgYXJlIG5vdCBlcXVpdmFsZW50LCBidXQgYE9iamVjdGBzXG4gICAgLy8gZnJvbSBkaWZmZXJlbnQgZnJhbWVzIGFyZS5cbiAgICB2YXIgYUN0b3IgPSBhLmNvbnN0cnVjdG9yLCBiQ3RvciA9IGIuY29uc3RydWN0b3I7XG4gICAgaWYgKGFDdG9yICE9PSBiQ3RvciAmJiAhKF8uaXNGdW5jdGlvbihhQ3RvcikgJiYgKGFDdG9yIGluc3RhbmNlb2YgYUN0b3IpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8uaXNGdW5jdGlvbihiQ3RvcikgJiYgKGJDdG9yIGluc3RhbmNlb2YgYkN0b3IpKVxuICAgICAgICAgICAgICAgICAgICAgICAgJiYgKCdjb25zdHJ1Y3RvcicgaW4gYSAmJiAnY29uc3RydWN0b3InIGluIGIpKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIC8vIEFkZCB0aGUgZmlyc3Qgb2JqZWN0IHRvIHRoZSBzdGFjayBvZiB0cmF2ZXJzZWQgb2JqZWN0cy5cbiAgICBhU3RhY2sucHVzaChhKTtcbiAgICBiU3RhY2sucHVzaChiKTtcbiAgICB2YXIgc2l6ZSA9IDAsIHJlc3VsdCA9IHRydWU7XG4gICAgLy8gUmVjdXJzaXZlbHkgY29tcGFyZSBvYmplY3RzIGFuZCBhcnJheXMuXG4gICAgaWYgKGNsYXNzTmFtZSA9PSAnW29iamVjdCBBcnJheV0nKSB7XG4gICAgICAvLyBDb21wYXJlIGFycmF5IGxlbmd0aHMgdG8gZGV0ZXJtaW5lIGlmIGEgZGVlcCBjb21wYXJpc29uIGlzIG5lY2Vzc2FyeS5cbiAgICAgIHNpemUgPSBhLmxlbmd0aDtcbiAgICAgIHJlc3VsdCA9IHNpemUgPT0gYi5sZW5ndGg7XG4gICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgIC8vIERlZXAgY29tcGFyZSB0aGUgY29udGVudHMsIGlnbm9yaW5nIG5vbi1udW1lcmljIHByb3BlcnRpZXMuXG4gICAgICAgIHdoaWxlIChzaXplLS0pIHtcbiAgICAgICAgICBpZiAoIShyZXN1bHQgPSBlcShhW3NpemVdLCBiW3NpemVdLCBhU3RhY2ssIGJTdGFjaykpKSBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBEZWVwIGNvbXBhcmUgb2JqZWN0cy5cbiAgICAgIGZvciAodmFyIGtleSBpbiBhKSB7XG4gICAgICAgIGlmIChfLmhhcyhhLCBrZXkpKSB7XG4gICAgICAgICAgLy8gQ291bnQgdGhlIGV4cGVjdGVkIG51bWJlciBvZiBwcm9wZXJ0aWVzLlxuICAgICAgICAgIHNpemUrKztcbiAgICAgICAgICAvLyBEZWVwIGNvbXBhcmUgZWFjaCBtZW1iZXIuXG4gICAgICAgICAgaWYgKCEocmVzdWx0ID0gXy5oYXMoYiwga2V5KSAmJiBlcShhW2tleV0sIGJba2V5XSwgYVN0YWNrLCBiU3RhY2spKSkgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIC8vIEVuc3VyZSB0aGF0IGJvdGggb2JqZWN0cyBjb250YWluIHRoZSBzYW1lIG51bWJlciBvZiBwcm9wZXJ0aWVzLlxuICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICBmb3IgKGtleSBpbiBiKSB7XG4gICAgICAgICAgaWYgKF8uaGFzKGIsIGtleSkgJiYgIShzaXplLS0pKSBicmVhaztcbiAgICAgICAgfVxuICAgICAgICByZXN1bHQgPSAhc2l6ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgLy8gUmVtb3ZlIHRoZSBmaXJzdCBvYmplY3QgZnJvbSB0aGUgc3RhY2sgb2YgdHJhdmVyc2VkIG9iamVjdHMuXG4gICAgYVN0YWNrLnBvcCgpO1xuICAgIGJTdGFjay5wb3AoKTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIC8vIFBlcmZvcm0gYSBkZWVwIGNvbXBhcmlzb24gdG8gY2hlY2sgaWYgdHdvIG9iamVjdHMgYXJlIGVxdWFsLlxuICBfLmlzRXF1YWwgPSBmdW5jdGlvbihhLCBiKSB7XG4gICAgcmV0dXJuIGVxKGEsIGIsIFtdLCBbXSk7XG4gIH07XG5cbiAgLy8gSXMgYSBnaXZlbiBhcnJheSwgc3RyaW5nLCBvciBvYmplY3QgZW1wdHk/XG4gIC8vIEFuIFwiZW1wdHlcIiBvYmplY3QgaGFzIG5vIGVudW1lcmFibGUgb3duLXByb3BlcnRpZXMuXG4gIF8uaXNFbXB0eSA9IGZ1bmN0aW9uKG9iaikge1xuICAgIGlmIChvYmogPT0gbnVsbCkgcmV0dXJuIHRydWU7XG4gICAgaWYgKF8uaXNBcnJheShvYmopIHx8IF8uaXNTdHJpbmcob2JqKSkgcmV0dXJuIG9iai5sZW5ndGggPT09IDA7XG4gICAgZm9yICh2YXIga2V5IGluIG9iaikgaWYgKF8uaGFzKG9iaiwga2V5KSkgcmV0dXJuIGZhbHNlO1xuICAgIHJldHVybiB0cnVlO1xuICB9O1xuXG4gIC8vIElzIGEgZ2l2ZW4gdmFsdWUgYSBET00gZWxlbWVudD9cbiAgXy5pc0VsZW1lbnQgPSBmdW5jdGlvbihvYmopIHtcbiAgICByZXR1cm4gISEob2JqICYmIG9iai5ub2RlVHlwZSA9PT0gMSk7XG4gIH07XG5cbiAgLy8gSXMgYSBnaXZlbiB2YWx1ZSBhbiBhcnJheT9cbiAgLy8gRGVsZWdhdGVzIHRvIEVDTUE1J3MgbmF0aXZlIEFycmF5LmlzQXJyYXlcbiAgXy5pc0FycmF5ID0gbmF0aXZlSXNBcnJheSB8fCBmdW5jdGlvbihvYmopIHtcbiAgICByZXR1cm4gdG9TdHJpbmcuY2FsbChvYmopID09ICdbb2JqZWN0IEFycmF5XSc7XG4gIH07XG5cbiAgLy8gSXMgYSBnaXZlbiB2YXJpYWJsZSBhbiBvYmplY3Q/XG4gIF8uaXNPYmplY3QgPSBmdW5jdGlvbihvYmopIHtcbiAgICByZXR1cm4gb2JqID09PSBPYmplY3Qob2JqKTtcbiAgfTtcblxuICAvLyBBZGQgc29tZSBpc1R5cGUgbWV0aG9kczogaXNBcmd1bWVudHMsIGlzRnVuY3Rpb24sIGlzU3RyaW5nLCBpc051bWJlciwgaXNEYXRlLCBpc1JlZ0V4cC5cbiAgZWFjaChbJ0FyZ3VtZW50cycsICdGdW5jdGlvbicsICdTdHJpbmcnLCAnTnVtYmVyJywgJ0RhdGUnLCAnUmVnRXhwJ10sIGZ1bmN0aW9uKG5hbWUpIHtcbiAgICBfWydpcycgKyBuYW1lXSA9IGZ1bmN0aW9uKG9iaikge1xuICAgICAgcmV0dXJuIHRvU3RyaW5nLmNhbGwob2JqKSA9PSAnW29iamVjdCAnICsgbmFtZSArICddJztcbiAgICB9O1xuICB9KTtcblxuICAvLyBEZWZpbmUgYSBmYWxsYmFjayB2ZXJzaW9uIG9mIHRoZSBtZXRob2QgaW4gYnJvd3NlcnMgKGFoZW0sIElFKSwgd2hlcmVcbiAgLy8gdGhlcmUgaXNuJ3QgYW55IGluc3BlY3RhYmxlIFwiQXJndW1lbnRzXCIgdHlwZS5cbiAgaWYgKCFfLmlzQXJndW1lbnRzKGFyZ3VtZW50cykpIHtcbiAgICBfLmlzQXJndW1lbnRzID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgICByZXR1cm4gISEob2JqICYmIF8uaGFzKG9iaiwgJ2NhbGxlZScpKTtcbiAgICB9O1xuICB9XG5cbiAgLy8gT3B0aW1pemUgYGlzRnVuY3Rpb25gIGlmIGFwcHJvcHJpYXRlLlxuICBpZiAodHlwZW9mICgvLi8pICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgXy5pc0Z1bmN0aW9uID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgICByZXR1cm4gdHlwZW9mIG9iaiA9PT0gJ2Z1bmN0aW9uJztcbiAgICB9O1xuICB9XG5cbiAgLy8gSXMgYSBnaXZlbiBvYmplY3QgYSBmaW5pdGUgbnVtYmVyP1xuICBfLmlzRmluaXRlID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgcmV0dXJuIGlzRmluaXRlKG9iaikgJiYgIWlzTmFOKHBhcnNlRmxvYXQob2JqKSk7XG4gIH07XG5cbiAgLy8gSXMgdGhlIGdpdmVuIHZhbHVlIGBOYU5gPyAoTmFOIGlzIHRoZSBvbmx5IG51bWJlciB3aGljaCBkb2VzIG5vdCBlcXVhbCBpdHNlbGYpLlxuICBfLmlzTmFOID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgcmV0dXJuIF8uaXNOdW1iZXIob2JqKSAmJiBvYmogIT0gK29iajtcbiAgfTtcblxuICAvLyBJcyBhIGdpdmVuIHZhbHVlIGEgYm9vbGVhbj9cbiAgXy5pc0Jvb2xlYW4gPSBmdW5jdGlvbihvYmopIHtcbiAgICByZXR1cm4gb2JqID09PSB0cnVlIHx8IG9iaiA9PT0gZmFsc2UgfHwgdG9TdHJpbmcuY2FsbChvYmopID09ICdbb2JqZWN0IEJvb2xlYW5dJztcbiAgfTtcblxuICAvLyBJcyBhIGdpdmVuIHZhbHVlIGVxdWFsIHRvIG51bGw/XG4gIF8uaXNOdWxsID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgcmV0dXJuIG9iaiA9PT0gbnVsbDtcbiAgfTtcblxuICAvLyBJcyBhIGdpdmVuIHZhcmlhYmxlIHVuZGVmaW5lZD9cbiAgXy5pc1VuZGVmaW5lZCA9IGZ1bmN0aW9uKG9iaikge1xuICAgIHJldHVybiBvYmogPT09IHZvaWQgMDtcbiAgfTtcblxuICAvLyBTaG9ydGN1dCBmdW5jdGlvbiBmb3IgY2hlY2tpbmcgaWYgYW4gb2JqZWN0IGhhcyBhIGdpdmVuIHByb3BlcnR5IGRpcmVjdGx5XG4gIC8vIG9uIGl0c2VsZiAoaW4gb3RoZXIgd29yZHMsIG5vdCBvbiBhIHByb3RvdHlwZSkuXG4gIF8uaGFzID0gZnVuY3Rpb24ob2JqLCBrZXkpIHtcbiAgICByZXR1cm4gaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSk7XG4gIH07XG5cbiAgLy8gVXRpbGl0eSBGdW5jdGlvbnNcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS1cblxuICAvLyBSdW4gVW5kZXJzY29yZS5qcyBpbiAqbm9Db25mbGljdCogbW9kZSwgcmV0dXJuaW5nIHRoZSBgX2AgdmFyaWFibGUgdG8gaXRzXG4gIC8vIHByZXZpb3VzIG93bmVyLiBSZXR1cm5zIGEgcmVmZXJlbmNlIHRvIHRoZSBVbmRlcnNjb3JlIG9iamVjdC5cbiAgXy5ub0NvbmZsaWN0ID0gZnVuY3Rpb24oKSB7XG4gICAgcm9vdC5fID0gcHJldmlvdXNVbmRlcnNjb3JlO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8vIEtlZXAgdGhlIGlkZW50aXR5IGZ1bmN0aW9uIGFyb3VuZCBmb3IgZGVmYXVsdCBpdGVyYXRvcnMuXG4gIF8uaWRlbnRpdHkgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZTtcbiAgfTtcblxuICBfLmNvbnN0YW50ID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH07XG4gIH07XG5cbiAgXy5wcm9wZXJ0eSA9IGZ1bmN0aW9uKGtleSkge1xuICAgIHJldHVybiBmdW5jdGlvbihvYmopIHtcbiAgICAgIHJldHVybiBvYmpba2V5XTtcbiAgICB9O1xuICB9O1xuXG4gIC8vIFJldHVybnMgYSBwcmVkaWNhdGUgZm9yIGNoZWNraW5nIHdoZXRoZXIgYW4gb2JqZWN0IGhhcyBhIGdpdmVuIHNldCBvZiBga2V5OnZhbHVlYCBwYWlycy5cbiAgXy5tYXRjaGVzID0gZnVuY3Rpb24oYXR0cnMpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24ob2JqKSB7XG4gICAgICBpZiAob2JqID09PSBhdHRycykgcmV0dXJuIHRydWU7IC8vYXZvaWQgY29tcGFyaW5nIGFuIG9iamVjdCB0byBpdHNlbGYuXG4gICAgICBmb3IgKHZhciBrZXkgaW4gYXR0cnMpIHtcbiAgICAgICAgaWYgKGF0dHJzW2tleV0gIT09IG9ialtrZXldKVxuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfTtcblxuICAvLyBSdW4gYSBmdW5jdGlvbiAqKm4qKiB0aW1lcy5cbiAgXy50aW1lcyA9IGZ1bmN0aW9uKG4sIGl0ZXJhdG9yLCBjb250ZXh0KSB7XG4gICAgdmFyIGFjY3VtID0gQXJyYXkoTWF0aC5tYXgoMCwgbikpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbjsgaSsrKSBhY2N1bVtpXSA9IGl0ZXJhdG9yLmNhbGwoY29udGV4dCwgaSk7XG4gICAgcmV0dXJuIGFjY3VtO1xuICB9O1xuXG4gIC8vIFJldHVybiBhIHJhbmRvbSBpbnRlZ2VyIGJldHdlZW4gbWluIGFuZCBtYXggKGluY2x1c2l2ZSkuXG4gIF8ucmFuZG9tID0gZnVuY3Rpb24obWluLCBtYXgpIHtcbiAgICBpZiAobWF4ID09IG51bGwpIHtcbiAgICAgIG1heCA9IG1pbjtcbiAgICAgIG1pbiA9IDA7XG4gICAgfVxuICAgIHJldHVybiBtaW4gKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluICsgMSkpO1xuICB9O1xuXG4gIC8vIEEgKHBvc3NpYmx5IGZhc3Rlcikgd2F5IHRvIGdldCB0aGUgY3VycmVudCB0aW1lc3RhbXAgYXMgYW4gaW50ZWdlci5cbiAgXy5ub3cgPSBEYXRlLm5vdyB8fCBmdW5jdGlvbigpIHsgcmV0dXJuIG5ldyBEYXRlKCkuZ2V0VGltZSgpOyB9O1xuXG4gIC8vIExpc3Qgb2YgSFRNTCBlbnRpdGllcyBmb3IgZXNjYXBpbmcuXG4gIHZhciBlbnRpdHlNYXAgPSB7XG4gICAgZXNjYXBlOiB7XG4gICAgICAnJic6ICcmYW1wOycsXG4gICAgICAnPCc6ICcmbHQ7JyxcbiAgICAgICc+JzogJyZndDsnLFxuICAgICAgJ1wiJzogJyZxdW90OycsXG4gICAgICBcIidcIjogJyYjeDI3OydcbiAgICB9XG4gIH07XG4gIGVudGl0eU1hcC51bmVzY2FwZSA9IF8uaW52ZXJ0KGVudGl0eU1hcC5lc2NhcGUpO1xuXG4gIC8vIFJlZ2V4ZXMgY29udGFpbmluZyB0aGUga2V5cyBhbmQgdmFsdWVzIGxpc3RlZCBpbW1lZGlhdGVseSBhYm92ZS5cbiAgdmFyIGVudGl0eVJlZ2V4ZXMgPSB7XG4gICAgZXNjYXBlOiAgIG5ldyBSZWdFeHAoJ1snICsgXy5rZXlzKGVudGl0eU1hcC5lc2NhcGUpLmpvaW4oJycpICsgJ10nLCAnZycpLFxuICAgIHVuZXNjYXBlOiBuZXcgUmVnRXhwKCcoJyArIF8ua2V5cyhlbnRpdHlNYXAudW5lc2NhcGUpLmpvaW4oJ3wnKSArICcpJywgJ2cnKVxuICB9O1xuXG4gIC8vIEZ1bmN0aW9ucyBmb3IgZXNjYXBpbmcgYW5kIHVuZXNjYXBpbmcgc3RyaW5ncyB0by9mcm9tIEhUTUwgaW50ZXJwb2xhdGlvbi5cbiAgXy5lYWNoKFsnZXNjYXBlJywgJ3VuZXNjYXBlJ10sIGZ1bmN0aW9uKG1ldGhvZCkge1xuICAgIF9bbWV0aG9kXSA9IGZ1bmN0aW9uKHN0cmluZykge1xuICAgICAgaWYgKHN0cmluZyA9PSBudWxsKSByZXR1cm4gJyc7XG4gICAgICByZXR1cm4gKCcnICsgc3RyaW5nKS5yZXBsYWNlKGVudGl0eVJlZ2V4ZXNbbWV0aG9kXSwgZnVuY3Rpb24obWF0Y2gpIHtcbiAgICAgICAgcmV0dXJuIGVudGl0eU1hcFttZXRob2RdW21hdGNoXTtcbiAgICAgIH0pO1xuICAgIH07XG4gIH0pO1xuXG4gIC8vIElmIHRoZSB2YWx1ZSBvZiB0aGUgbmFtZWQgYHByb3BlcnR5YCBpcyBhIGZ1bmN0aW9uIHRoZW4gaW52b2tlIGl0IHdpdGggdGhlXG4gIC8vIGBvYmplY3RgIGFzIGNvbnRleHQ7IG90aGVyd2lzZSwgcmV0dXJuIGl0LlxuICBfLnJlc3VsdCA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHtcbiAgICBpZiAob2JqZWN0ID09IG51bGwpIHJldHVybiB2b2lkIDA7XG4gICAgdmFyIHZhbHVlID0gb2JqZWN0W3Byb3BlcnR5XTtcbiAgICByZXR1cm4gXy5pc0Z1bmN0aW9uKHZhbHVlKSA/IHZhbHVlLmNhbGwob2JqZWN0KSA6IHZhbHVlO1xuICB9O1xuXG4gIC8vIEFkZCB5b3VyIG93biBjdXN0b20gZnVuY3Rpb25zIHRvIHRoZSBVbmRlcnNjb3JlIG9iamVjdC5cbiAgXy5taXhpbiA9IGZ1bmN0aW9uKG9iaikge1xuICAgIGVhY2goXy5mdW5jdGlvbnMob2JqKSwgZnVuY3Rpb24obmFtZSkge1xuICAgICAgdmFyIGZ1bmMgPSBfW25hbWVdID0gb2JqW25hbWVdO1xuICAgICAgXy5wcm90b3R5cGVbbmFtZV0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBbdGhpcy5fd3JhcHBlZF07XG4gICAgICAgIHB1c2guYXBwbHkoYXJncywgYXJndW1lbnRzKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdC5jYWxsKHRoaXMsIGZ1bmMuYXBwbHkoXywgYXJncykpO1xuICAgICAgfTtcbiAgICB9KTtcbiAgfTtcblxuICAvLyBHZW5lcmF0ZSBhIHVuaXF1ZSBpbnRlZ2VyIGlkICh1bmlxdWUgd2l0aGluIHRoZSBlbnRpcmUgY2xpZW50IHNlc3Npb24pLlxuICAvLyBVc2VmdWwgZm9yIHRlbXBvcmFyeSBET00gaWRzLlxuICB2YXIgaWRDb3VudGVyID0gMDtcbiAgXy51bmlxdWVJZCA9IGZ1bmN0aW9uKHByZWZpeCkge1xuICAgIHZhciBpZCA9ICsraWRDb3VudGVyICsgJyc7XG4gICAgcmV0dXJuIHByZWZpeCA/IHByZWZpeCArIGlkIDogaWQ7XG4gIH07XG5cbiAgLy8gQnkgZGVmYXVsdCwgVW5kZXJzY29yZSB1c2VzIEVSQi1zdHlsZSB0ZW1wbGF0ZSBkZWxpbWl0ZXJzLCBjaGFuZ2UgdGhlXG4gIC8vIGZvbGxvd2luZyB0ZW1wbGF0ZSBzZXR0aW5ncyB0byB1c2UgYWx0ZXJuYXRpdmUgZGVsaW1pdGVycy5cbiAgXy50ZW1wbGF0ZVNldHRpbmdzID0ge1xuICAgIGV2YWx1YXRlICAgIDogLzwlKFtcXHNcXFNdKz8pJT4vZyxcbiAgICBpbnRlcnBvbGF0ZSA6IC88JT0oW1xcc1xcU10rPyklPi9nLFxuICAgIGVzY2FwZSAgICAgIDogLzwlLShbXFxzXFxTXSs/KSU+L2dcbiAgfTtcblxuICAvLyBXaGVuIGN1c3RvbWl6aW5nIGB0ZW1wbGF0ZVNldHRpbmdzYCwgaWYgeW91IGRvbid0IHdhbnQgdG8gZGVmaW5lIGFuXG4gIC8vIGludGVycG9sYXRpb24sIGV2YWx1YXRpb24gb3IgZXNjYXBpbmcgcmVnZXgsIHdlIG5lZWQgb25lIHRoYXQgaXNcbiAgLy8gZ3VhcmFudGVlZCBub3QgdG8gbWF0Y2guXG4gIHZhciBub01hdGNoID0gLyguKV4vO1xuXG4gIC8vIENlcnRhaW4gY2hhcmFjdGVycyBuZWVkIHRvIGJlIGVzY2FwZWQgc28gdGhhdCB0aGV5IGNhbiBiZSBwdXQgaW50byBhXG4gIC8vIHN0cmluZyBsaXRlcmFsLlxuICB2YXIgZXNjYXBlcyA9IHtcbiAgICBcIidcIjogICAgICBcIidcIixcbiAgICAnXFxcXCc6ICAgICAnXFxcXCcsXG4gICAgJ1xccic6ICAgICAncicsXG4gICAgJ1xcbic6ICAgICAnbicsXG4gICAgJ1xcdCc6ICAgICAndCcsXG4gICAgJ1xcdTIwMjgnOiAndTIwMjgnLFxuICAgICdcXHUyMDI5JzogJ3UyMDI5J1xuICB9O1xuXG4gIHZhciBlc2NhcGVyID0gL1xcXFx8J3xcXHJ8XFxufFxcdHxcXHUyMDI4fFxcdTIwMjkvZztcblxuICAvLyBKYXZhU2NyaXB0IG1pY3JvLXRlbXBsYXRpbmcsIHNpbWlsYXIgdG8gSm9obiBSZXNpZydzIGltcGxlbWVudGF0aW9uLlxuICAvLyBVbmRlcnNjb3JlIHRlbXBsYXRpbmcgaGFuZGxlcyBhcmJpdHJhcnkgZGVsaW1pdGVycywgcHJlc2VydmVzIHdoaXRlc3BhY2UsXG4gIC8vIGFuZCBjb3JyZWN0bHkgZXNjYXBlcyBxdW90ZXMgd2l0aGluIGludGVycG9sYXRlZCBjb2RlLlxuICBfLnRlbXBsYXRlID0gZnVuY3Rpb24odGV4dCwgZGF0YSwgc2V0dGluZ3MpIHtcbiAgICB2YXIgcmVuZGVyO1xuICAgIHNldHRpbmdzID0gXy5kZWZhdWx0cyh7fSwgc2V0dGluZ3MsIF8udGVtcGxhdGVTZXR0aW5ncyk7XG5cbiAgICAvLyBDb21iaW5lIGRlbGltaXRlcnMgaW50byBvbmUgcmVndWxhciBleHByZXNzaW9uIHZpYSBhbHRlcm5hdGlvbi5cbiAgICB2YXIgbWF0Y2hlciA9IG5ldyBSZWdFeHAoW1xuICAgICAgKHNldHRpbmdzLmVzY2FwZSB8fCBub01hdGNoKS5zb3VyY2UsXG4gICAgICAoc2V0dGluZ3MuaW50ZXJwb2xhdGUgfHwgbm9NYXRjaCkuc291cmNlLFxuICAgICAgKHNldHRpbmdzLmV2YWx1YXRlIHx8IG5vTWF0Y2gpLnNvdXJjZVxuICAgIF0uam9pbignfCcpICsgJ3wkJywgJ2cnKTtcblxuICAgIC8vIENvbXBpbGUgdGhlIHRlbXBsYXRlIHNvdXJjZSwgZXNjYXBpbmcgc3RyaW5nIGxpdGVyYWxzIGFwcHJvcHJpYXRlbHkuXG4gICAgdmFyIGluZGV4ID0gMDtcbiAgICB2YXIgc291cmNlID0gXCJfX3ArPSdcIjtcbiAgICB0ZXh0LnJlcGxhY2UobWF0Y2hlciwgZnVuY3Rpb24obWF0Y2gsIGVzY2FwZSwgaW50ZXJwb2xhdGUsIGV2YWx1YXRlLCBvZmZzZXQpIHtcbiAgICAgIHNvdXJjZSArPSB0ZXh0LnNsaWNlKGluZGV4LCBvZmZzZXQpXG4gICAgICAgIC5yZXBsYWNlKGVzY2FwZXIsIGZ1bmN0aW9uKG1hdGNoKSB7IHJldHVybiAnXFxcXCcgKyBlc2NhcGVzW21hdGNoXTsgfSk7XG5cbiAgICAgIGlmIChlc2NhcGUpIHtcbiAgICAgICAgc291cmNlICs9IFwiJytcXG4oKF9fdD0oXCIgKyBlc2NhcGUgKyBcIikpPT1udWxsPycnOl8uZXNjYXBlKF9fdCkpK1xcbidcIjtcbiAgICAgIH1cbiAgICAgIGlmIChpbnRlcnBvbGF0ZSkge1xuICAgICAgICBzb3VyY2UgKz0gXCInK1xcbigoX190PShcIiArIGludGVycG9sYXRlICsgXCIpKT09bnVsbD8nJzpfX3QpK1xcbidcIjtcbiAgICAgIH1cbiAgICAgIGlmIChldmFsdWF0ZSkge1xuICAgICAgICBzb3VyY2UgKz0gXCInO1xcblwiICsgZXZhbHVhdGUgKyBcIlxcbl9fcCs9J1wiO1xuICAgICAgfVxuICAgICAgaW5kZXggPSBvZmZzZXQgKyBtYXRjaC5sZW5ndGg7XG4gICAgICByZXR1cm4gbWF0Y2g7XG4gICAgfSk7XG4gICAgc291cmNlICs9IFwiJztcXG5cIjtcblxuICAgIC8vIElmIGEgdmFyaWFibGUgaXMgbm90IHNwZWNpZmllZCwgcGxhY2UgZGF0YSB2YWx1ZXMgaW4gbG9jYWwgc2NvcGUuXG4gICAgaWYgKCFzZXR0aW5ncy52YXJpYWJsZSkgc291cmNlID0gJ3dpdGgob2JqfHx7fSl7XFxuJyArIHNvdXJjZSArICd9XFxuJztcblxuICAgIHNvdXJjZSA9IFwidmFyIF9fdCxfX3A9JycsX19qPUFycmF5LnByb3RvdHlwZS5qb2luLFwiICtcbiAgICAgIFwicHJpbnQ9ZnVuY3Rpb24oKXtfX3ArPV9fai5jYWxsKGFyZ3VtZW50cywnJyk7fTtcXG5cIiArXG4gICAgICBzb3VyY2UgKyBcInJldHVybiBfX3A7XFxuXCI7XG5cbiAgICB0cnkge1xuICAgICAgcmVuZGVyID0gbmV3IEZ1bmN0aW9uKHNldHRpbmdzLnZhcmlhYmxlIHx8ICdvYmonLCAnXycsIHNvdXJjZSk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgZS5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICB0aHJvdyBlO1xuICAgIH1cblxuICAgIGlmIChkYXRhKSByZXR1cm4gcmVuZGVyKGRhdGEsIF8pO1xuICAgIHZhciB0ZW1wbGF0ZSA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgIHJldHVybiByZW5kZXIuY2FsbCh0aGlzLCBkYXRhLCBfKTtcbiAgICB9O1xuXG4gICAgLy8gUHJvdmlkZSB0aGUgY29tcGlsZWQgZnVuY3Rpb24gc291cmNlIGFzIGEgY29udmVuaWVuY2UgZm9yIHByZWNvbXBpbGF0aW9uLlxuICAgIHRlbXBsYXRlLnNvdXJjZSA9ICdmdW5jdGlvbignICsgKHNldHRpbmdzLnZhcmlhYmxlIHx8ICdvYmonKSArICcpe1xcbicgKyBzb3VyY2UgKyAnfSc7XG5cbiAgICByZXR1cm4gdGVtcGxhdGU7XG4gIH07XG5cbiAgLy8gQWRkIGEgXCJjaGFpblwiIGZ1bmN0aW9uLCB3aGljaCB3aWxsIGRlbGVnYXRlIHRvIHRoZSB3cmFwcGVyLlxuICBfLmNoYWluID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgcmV0dXJuIF8ob2JqKS5jaGFpbigpO1xuICB9O1xuXG4gIC8vIE9PUFxuICAvLyAtLS0tLS0tLS0tLS0tLS1cbiAgLy8gSWYgVW5kZXJzY29yZSBpcyBjYWxsZWQgYXMgYSBmdW5jdGlvbiwgaXQgcmV0dXJucyBhIHdyYXBwZWQgb2JqZWN0IHRoYXRcbiAgLy8gY2FuIGJlIHVzZWQgT08tc3R5bGUuIFRoaXMgd3JhcHBlciBob2xkcyBhbHRlcmVkIHZlcnNpb25zIG9mIGFsbCB0aGVcbiAgLy8gdW5kZXJzY29yZSBmdW5jdGlvbnMuIFdyYXBwZWQgb2JqZWN0cyBtYXkgYmUgY2hhaW5lZC5cblxuICAvLyBIZWxwZXIgZnVuY3Rpb24gdG8gY29udGludWUgY2hhaW5pbmcgaW50ZXJtZWRpYXRlIHJlc3VsdHMuXG4gIHZhciByZXN1bHQgPSBmdW5jdGlvbihvYmopIHtcbiAgICByZXR1cm4gdGhpcy5fY2hhaW4gPyBfKG9iaikuY2hhaW4oKSA6IG9iajtcbiAgfTtcblxuICAvLyBBZGQgYWxsIG9mIHRoZSBVbmRlcnNjb3JlIGZ1bmN0aW9ucyB0byB0aGUgd3JhcHBlciBvYmplY3QuXG4gIF8ubWl4aW4oXyk7XG5cbiAgLy8gQWRkIGFsbCBtdXRhdG9yIEFycmF5IGZ1bmN0aW9ucyB0byB0aGUgd3JhcHBlci5cbiAgZWFjaChbJ3BvcCcsICdwdXNoJywgJ3JldmVyc2UnLCAnc2hpZnQnLCAnc29ydCcsICdzcGxpY2UnLCAndW5zaGlmdCddLCBmdW5jdGlvbihuYW1lKSB7XG4gICAgdmFyIG1ldGhvZCA9IEFycmF5UHJvdG9bbmFtZV07XG4gICAgXy5wcm90b3R5cGVbbmFtZV0gPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBvYmogPSB0aGlzLl93cmFwcGVkO1xuICAgICAgbWV0aG9kLmFwcGx5KG9iaiwgYXJndW1lbnRzKTtcbiAgICAgIGlmICgobmFtZSA9PSAnc2hpZnQnIHx8IG5hbWUgPT0gJ3NwbGljZScpICYmIG9iai5sZW5ndGggPT09IDApIGRlbGV0ZSBvYmpbMF07XG4gICAgICByZXR1cm4gcmVzdWx0LmNhbGwodGhpcywgb2JqKTtcbiAgICB9O1xuICB9KTtcblxuICAvLyBBZGQgYWxsIGFjY2Vzc29yIEFycmF5IGZ1bmN0aW9ucyB0byB0aGUgd3JhcHBlci5cbiAgZWFjaChbJ2NvbmNhdCcsICdqb2luJywgJ3NsaWNlJ10sIGZ1bmN0aW9uKG5hbWUpIHtcbiAgICB2YXIgbWV0aG9kID0gQXJyYXlQcm90b1tuYW1lXTtcbiAgICBfLnByb3RvdHlwZVtuYW1lXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHJlc3VsdC5jYWxsKHRoaXMsIG1ldGhvZC5hcHBseSh0aGlzLl93cmFwcGVkLCBhcmd1bWVudHMpKTtcbiAgICB9O1xuICB9KTtcblxuICBfLmV4dGVuZChfLnByb3RvdHlwZSwge1xuXG4gICAgLy8gU3RhcnQgY2hhaW5pbmcgYSB3cmFwcGVkIFVuZGVyc2NvcmUgb2JqZWN0LlxuICAgIGNoYWluOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX2NoYWluID0gdHJ1ZTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbiAgICAvLyBFeHRyYWN0cyB0aGUgcmVzdWx0IGZyb20gYSB3cmFwcGVkIGFuZCBjaGFpbmVkIG9iamVjdC5cbiAgICB2YWx1ZTogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fd3JhcHBlZDtcbiAgICB9XG5cbiAgfSk7XG5cbiAgLy8gQU1EIHJlZ2lzdHJhdGlvbiBoYXBwZW5zIGF0IHRoZSBlbmQgZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBBTUQgbG9hZGVyc1xuICAvLyB0aGF0IG1heSBub3QgZW5mb3JjZSBuZXh0LXR1cm4gc2VtYW50aWNzIG9uIG1vZHVsZXMuIEV2ZW4gdGhvdWdoIGdlbmVyYWxcbiAgLy8gcHJhY3RpY2UgZm9yIEFNRCByZWdpc3RyYXRpb24gaXMgdG8gYmUgYW5vbnltb3VzLCB1bmRlcnNjb3JlIHJlZ2lzdGVyc1xuICAvLyBhcyBhIG5hbWVkIG1vZHVsZSBiZWNhdXNlLCBsaWtlIGpRdWVyeSwgaXQgaXMgYSBiYXNlIGxpYnJhcnkgdGhhdCBpc1xuICAvLyBwb3B1bGFyIGVub3VnaCB0byBiZSBidW5kbGVkIGluIGEgdGhpcmQgcGFydHkgbGliLCBidXQgbm90IGJlIHBhcnQgb2ZcbiAgLy8gYW4gQU1EIGxvYWQgcmVxdWVzdC4gVGhvc2UgY2FzZXMgY291bGQgZ2VuZXJhdGUgYW4gZXJyb3Igd2hlbiBhblxuICAvLyBhbm9ueW1vdXMgZGVmaW5lKCkgaXMgY2FsbGVkIG91dHNpZGUgb2YgYSBsb2FkZXIgcmVxdWVzdC5cbiAgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgIGRlZmluZSgndW5kZXJzY29yZScsIFtdLCBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBfO1xuICAgIH0pO1xuICB9XG59KS5jYWxsKHRoaXMpO1xuXG59KSgpIiwiKGZ1bmN0aW9uKGRlZmluaXRpb24pe2lmKHR5cGVvZiBleHBvcnRzPT09XCJvYmplY3RcIil7bW9kdWxlLmV4cG9ydHM9ZGVmaW5pdGlvbigpO31lbHNlIGlmKHR5cGVvZiBkZWZpbmU9PT1cImZ1bmN0aW9uXCImJmRlZmluZS5hbWQpe2RlZmluZShkZWZpbml0aW9uKTt9ZWxzZXttb3JpPWRlZmluaXRpb24oKTt9fSkoZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oKXtcbnZhciBnLGFhPXRoaXM7XG5mdW5jdGlvbiBtKGEpe3ZhciBiPXR5cGVvZiBhO2lmKFwib2JqZWN0XCI9PWIpaWYoYSl7aWYoYSBpbnN0YW5jZW9mIEFycmF5KXJldHVyblwiYXJyYXlcIjtpZihhIGluc3RhbmNlb2YgT2JqZWN0KXJldHVybiBiO3ZhciBjPU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChhKTtpZihcIltvYmplY3QgV2luZG93XVwiPT1jKXJldHVyblwib2JqZWN0XCI7aWYoXCJbb2JqZWN0IEFycmF5XVwiPT1jfHxcIm51bWJlclwiPT10eXBlb2YgYS5sZW5ndGgmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiBhLnNwbGljZSYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGEucHJvcGVydHlJc0VudW1lcmFibGUmJiFhLnByb3BlcnR5SXNFbnVtZXJhYmxlKFwic3BsaWNlXCIpKXJldHVyblwiYXJyYXlcIjtpZihcIltvYmplY3QgRnVuY3Rpb25dXCI9PWN8fFwidW5kZWZpbmVkXCIhPXR5cGVvZiBhLmNhbGwmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiBhLnByb3BlcnR5SXNFbnVtZXJhYmxlJiYhYS5wcm9wZXJ0eUlzRW51bWVyYWJsZShcImNhbGxcIikpcmV0dXJuXCJmdW5jdGlvblwifWVsc2UgcmV0dXJuXCJudWxsXCI7ZWxzZSBpZihcImZ1bmN0aW9uXCI9PVxuYiYmXCJ1bmRlZmluZWRcIj09dHlwZW9mIGEuY2FsbClyZXR1cm5cIm9iamVjdFwiO3JldHVybiBifXZhciBiYT1cImNsb3N1cmVfdWlkX1wiKygxRTkqTWF0aC5yYW5kb20oKT4+PjApLGNhPTA7ZnVuY3Rpb24gcChhLGIpe3ZhciBjPWEuc3BsaXQoXCIuXCIpLGQ9YWE7Y1swXWluIGR8fCFkLmV4ZWNTY3JpcHR8fGQuZXhlY1NjcmlwdChcInZhciBcIitjWzBdKTtmb3IodmFyIGU7Yy5sZW5ndGgmJihlPWMuc2hpZnQoKSk7KWMubGVuZ3RofHx2b2lkIDA9PT1iP2Q9ZFtlXT9kW2VdOmRbZV09e306ZFtlXT1ifTtmdW5jdGlvbiBkYShhLGIpe2Zvcih2YXIgYyBpbiBhKWIuY2FsbCh2b2lkIDAsYVtjXSxjLGEpfTtmdW5jdGlvbiBlYShhLGIpe251bGwhPWEmJnRoaXMuYXBwZW5kLmFwcGx5KHRoaXMsYXJndW1lbnRzKX1lYS5wcm90b3R5cGUuVmE9XCJcIjtlYS5wcm90b3R5cGUuYXBwZW5kPWZ1bmN0aW9uKGEsYixjKXt0aGlzLlZhKz1hO2lmKG51bGwhPWIpZm9yKHZhciBkPTE7ZDxhcmd1bWVudHMubGVuZ3RoO2QrKyl0aGlzLlZhKz1hcmd1bWVudHNbZF07cmV0dXJuIHRoaXN9O2VhLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLlZhfTtmdW5jdGlvbiBmYShhLGIpe2Euc29ydChifHxnYSl9ZnVuY3Rpb24gaGEoYSxiKXtmb3IodmFyIGM9MDtjPGEubGVuZ3RoO2MrKylhW2NdPXtpbmRleDpjLHZhbHVlOmFbY119O3ZhciBkPWJ8fGdhO2ZhKGEsZnVuY3Rpb24oYSxiKXtyZXR1cm4gZChhLnZhbHVlLGIudmFsdWUpfHxhLmluZGV4LWIuaW5kZXh9KTtmb3IoYz0wO2M8YS5sZW5ndGg7YysrKWFbY109YVtjXS52YWx1ZX1mdW5jdGlvbiBnYShhLGIpe3JldHVybiBhPmI/MTphPGI/LTE6MH07dmFyIGlhPW51bGwsamE9bnVsbDtmdW5jdGlvbiBrYSgpe3JldHVybiBuZXcgbGEobnVsbCw1LFttYSwhMCxvYSwhMCxwYSwhMSxxYSwhMSxyYSxpYV0sbnVsbCl9ZnVuY3Rpb24gcihhKXtyZXR1cm4gbnVsbCE9YSYmITEhPT1hfWZ1bmN0aW9uIHNhKGEpe3JldHVybiByKGEpPyExOiEwfWZ1bmN0aW9uIHMoYSxiKXtyZXR1cm4gYVttKG51bGw9PWI/bnVsbDpiKV0/ITA6YS5fPyEwOnU/ITE6bnVsbH1mdW5jdGlvbiB0YShhKXtyZXR1cm4gbnVsbD09YT9udWxsOmEuY29uc3RydWN0b3J9ZnVuY3Rpb24geChhLGIpe3ZhciBjPXRhKGIpLGM9cihyKGMpP2MuRGI6Yyk/Yy5CYjptKGIpO3JldHVybiBFcnJvcihbXCJObyBwcm90b2NvbCBtZXRob2QgXCIsYSxcIiBkZWZpbmVkIGZvciB0eXBlIFwiLGMsXCI6IFwiLGJdLmpvaW4oXCJcIikpfWZ1bmN0aW9uIHVhKGEpe3ZhciBiPWEuQmI7cmV0dXJuIHIoYik/YjpcIlwiK0EuYihhKX1cbmZ1bmN0aW9uIHZhKGEpe2Zvcih2YXIgYj1hLmxlbmd0aCxjPUFycmF5KGIpLGQ9MDs7KWlmKGQ8YiljW2RdPWFbZF0sZCs9MTtlbHNlIGJyZWFrO3JldHVybiBjfWZ1bmN0aW9uIHdhKGEpe3JldHVybiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpfVxudmFyIHhhPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3JldHVybiBDLmM/Qy5jKGZ1bmN0aW9uKGEsYil7YS5wdXNoKGIpO3JldHVybiBhfSxbXSxiKTpDLmNhbGwobnVsbCxmdW5jdGlvbihhLGIpe2EucHVzaChiKTtyZXR1cm4gYX0sW10sYil9ZnVuY3Rpb24gYihhKXtyZXR1cm4gYy5hKG51bGwsYSl9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYi5jYWxsKHRoaXMsYyk7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcywwLGUpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmI9YjtjLmE9YTtyZXR1cm4gY30oKSx5YT17fSx6YT17fTtcbmZ1bmN0aW9uIEFhKGEpe2lmKGE/YS5MOmEpcmV0dXJuIGEuTChhKTt2YXIgYjtiPUFhW20obnVsbD09YT9udWxsOmEpXTtpZighYiYmKGI9QWEuXywhYikpdGhyb3cgeChcIklDb3VudGVkLi1jb3VudFwiLGEpO3JldHVybiBiLmNhbGwobnVsbCxhKX1mdW5jdGlvbiBCYShhKXtpZihhP2EuSTphKXJldHVybiBhLkkoYSk7dmFyIGI7Yj1CYVttKG51bGw9PWE/bnVsbDphKV07aWYoIWImJihiPUJhLl8sIWIpKXRocm93IHgoXCJJRW1wdHlhYmxlQ29sbGVjdGlvbi4tZW1wdHlcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9dmFyIENhPXt9O2Z1bmN0aW9uIERhKGEsYil7aWYoYT9hLkc6YSlyZXR1cm4gYS5HKGEsYik7dmFyIGM7Yz1EYVttKG51bGw9PWE/bnVsbDphKV07aWYoIWMmJihjPURhLl8sIWMpKXRocm93IHgoXCJJQ29sbGVjdGlvbi4tY29ualwiLGEpO3JldHVybiBjLmNhbGwobnVsbCxhLGIpfVxudmFyIEVhPXt9LEQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjKXtpZihhP2EuYWE6YSlyZXR1cm4gYS5hYShhLGIsYyk7dmFyIGg7aD1EW20obnVsbD09YT9udWxsOmEpXTtpZighaCYmKGg9RC5fLCFoKSl0aHJvdyB4KFwiSUluZGV4ZWQuLW50aFwiLGEpO3JldHVybiBoLmNhbGwobnVsbCxhLGIsYyl9ZnVuY3Rpb24gYihhLGIpe2lmKGE/YS5KOmEpcmV0dXJuIGEuSihhLGIpO3ZhciBjO2M9RFttKG51bGw9PWE/bnVsbDphKV07aWYoIWMmJihjPUQuXywhYykpdGhyb3cgeChcIklJbmRleGVkLi1udGhcIixhKTtyZXR1cm4gYy5jYWxsKG51bGwsYSxiKX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGIuY2FsbCh0aGlzLGMsZSk7Y2FzZSAzOnJldHVybiBhLmNhbGwodGhpcyxjLGUsZil9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYT1iO2MuYz1hO3JldHVybiBjfSgpLFxuRmE9e307ZnVuY3Rpb24gSGEoYSl7aWYoYT9hLlE6YSlyZXR1cm4gYS5RKGEpO3ZhciBiO2I9SGFbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj1IYS5fLCFiKSl0aHJvdyB4KFwiSVNlcS4tZmlyc3RcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9ZnVuY3Rpb24gSWEoYSl7aWYoYT9hLlM6YSlyZXR1cm4gYS5TKGEpO3ZhciBiO2I9SWFbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj1JYS5fLCFiKSl0aHJvdyB4KFwiSVNlcS4tcmVzdFwiLGEpO3JldHVybiBiLmNhbGwobnVsbCxhKX1cbnZhciBKYT17fSxLYT17fSxMYT1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMpe2lmKGE/YS5DOmEpcmV0dXJuIGEuQyhhLGIsYyk7dmFyIGg7aD1MYVttKG51bGw9PWE/bnVsbDphKV07aWYoIWgmJihoPUxhLl8sIWgpKXRocm93IHgoXCJJTG9va3VwLi1sb29rdXBcIixhKTtyZXR1cm4gaC5jYWxsKG51bGwsYSxiLGMpfWZ1bmN0aW9uIGIoYSxiKXtpZihhP2EudTphKXJldHVybiBhLnUoYSxiKTt2YXIgYztjPUxhW20obnVsbD09YT9udWxsOmEpXTtpZighYyYmKGM9TGEuXywhYykpdGhyb3cgeChcIklMb29rdXAuLWxvb2t1cFwiLGEpO3JldHVybiBjLmNhbGwobnVsbCxhLGIpfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gYi5jYWxsKHRoaXMsYyxlKTtjYXNlIDM6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSxmKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5hPWI7Yy5jPVxuYTtyZXR1cm4gY30oKSxNYT17fTtmdW5jdGlvbiBOYShhLGIpe2lmKGE/YS5rYjphKXJldHVybiBhLmtiKGEsYik7dmFyIGM7Yz1OYVttKG51bGw9PWE/bnVsbDphKV07aWYoIWMmJihjPU5hLl8sIWMpKXRocm93IHgoXCJJQXNzb2NpYXRpdmUuLWNvbnRhaW5zLWtleT9cIixhKTtyZXR1cm4gYy5jYWxsKG51bGwsYSxiKX1mdW5jdGlvbiBPYShhLGIsYyl7aWYoYT9hLnVhOmEpcmV0dXJuIGEudWEoYSxiLGMpO3ZhciBkO2Q9T2FbbShudWxsPT1hP251bGw6YSldO2lmKCFkJiYoZD1PYS5fLCFkKSl0aHJvdyB4KFwiSUFzc29jaWF0aXZlLi1hc3NvY1wiLGEpO3JldHVybiBkLmNhbGwobnVsbCxhLGIsYyl9dmFyIFBhPXt9O2Z1bmN0aW9uIFFhKGEsYil7aWYoYT9hLm5iOmEpcmV0dXJuIGEubmIoYSxiKTt2YXIgYztjPVFhW20obnVsbD09YT9udWxsOmEpXTtpZighYyYmKGM9UWEuXywhYykpdGhyb3cgeChcIklNYXAuLWRpc3NvY1wiLGEpO3JldHVybiBjLmNhbGwobnVsbCxhLGIpfXZhciBTYT17fTtcbmZ1bmN0aW9uIFRhKGEpe2lmKGE/YS4kYTphKXJldHVybiBhLiRhKGEpO3ZhciBiO2I9VGFbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj1UYS5fLCFiKSl0aHJvdyB4KFwiSU1hcEVudHJ5Li1rZXlcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9ZnVuY3Rpb24gVWEoYSl7aWYoYT9hLmFiOmEpcmV0dXJuIGEuYWIoYSk7dmFyIGI7Yj1VYVttKG51bGw9PWE/bnVsbDphKV07aWYoIWImJihiPVVhLl8sIWIpKXRocm93IHgoXCJJTWFwRW50cnkuLXZhbFwiLGEpO3JldHVybiBiLmNhbGwobnVsbCxhKX12YXIgVmE9e307ZnVuY3Rpb24gV2EoYSxiKXtpZihhP2EudmI6YSlyZXR1cm4gYS52YihhLGIpO3ZhciBjO2M9V2FbbShudWxsPT1hP251bGw6YSldO2lmKCFjJiYoYz1XYS5fLCFjKSl0aHJvdyB4KFwiSVNldC4tZGlzam9pblwiLGEpO3JldHVybiBjLmNhbGwobnVsbCxhLGIpfVxuZnVuY3Rpb24gWGEoYSl7aWYoYT9hLklhOmEpcmV0dXJuIGEuSWEoYSk7dmFyIGI7Yj1YYVttKG51bGw9PWE/bnVsbDphKV07aWYoIWImJihiPVhhLl8sIWIpKXRocm93IHgoXCJJU3RhY2suLXBlZWtcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9ZnVuY3Rpb24gWWEoYSl7aWYoYT9hLkphOmEpcmV0dXJuIGEuSmEoYSk7dmFyIGI7Yj1ZYVttKG51bGw9PWE/bnVsbDphKV07aWYoIWImJihiPVlhLl8sIWIpKXRocm93IHgoXCJJU3RhY2suLXBvcFwiLGEpO3JldHVybiBiLmNhbGwobnVsbCxhKX12YXIgWmE9e307ZnVuY3Rpb24gJGEoYSxiLGMpe2lmKGE/YS5QYTphKXJldHVybiBhLlBhKGEsYixjKTt2YXIgZDtkPSRhW20obnVsbD09YT9udWxsOmEpXTtpZighZCYmKGQ9JGEuXywhZCkpdGhyb3cgeChcIklWZWN0b3IuLWFzc29jLW5cIixhKTtyZXR1cm4gZC5jYWxsKG51bGwsYSxiLGMpfVxuZnVuY3Rpb24gYWIoYSl7aWYoYT9hLnViOmEpcmV0dXJuIGEudWIoYSk7dmFyIGI7Yj1hYlttKG51bGw9PWE/bnVsbDphKV07aWYoIWImJihiPWFiLl8sIWIpKXRocm93IHgoXCJJRGVyZWYuLWRlcmVmXCIsYSk7cmV0dXJuIGIuY2FsbChudWxsLGEpfXZhciBiYj17fTtmdW5jdGlvbiBjYihhKXtpZihhP2EuRDphKXJldHVybiBhLkQoYSk7dmFyIGI7Yj1jYlttKG51bGw9PWE/bnVsbDphKV07aWYoIWImJihiPWNiLl8sIWIpKXRocm93IHgoXCJJTWV0YS4tbWV0YVwiLGEpO3JldHVybiBiLmNhbGwobnVsbCxhKX12YXIgZGI9e307ZnVuY3Rpb24gZWIoYSxiKXtpZihhP2EuRjphKXJldHVybiBhLkYoYSxiKTt2YXIgYztjPWViW20obnVsbD09YT9udWxsOmEpXTtpZighYyYmKGM9ZWIuXywhYykpdGhyb3cgeChcIklXaXRoTWV0YS4td2l0aC1tZXRhXCIsYSk7cmV0dXJuIGMuY2FsbChudWxsLGEsYil9XG52YXIgZmI9e30sZ2I9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjKXtpZihhP2EuTTphKXJldHVybiBhLk0oYSxiLGMpO3ZhciBoO2g9Z2JbbShudWxsPT1hP251bGw6YSldO2lmKCFoJiYoaD1nYi5fLCFoKSl0aHJvdyB4KFwiSVJlZHVjZS4tcmVkdWNlXCIsYSk7cmV0dXJuIGguY2FsbChudWxsLGEsYixjKX1mdW5jdGlvbiBiKGEsYil7aWYoYT9hLk46YSlyZXR1cm4gYS5OKGEsYik7dmFyIGM7Yz1nYlttKG51bGw9PWE/bnVsbDphKV07aWYoIWMmJihjPWdiLl8sIWMpKXRocm93IHgoXCJJUmVkdWNlLi1yZWR1Y2VcIixhKTtyZXR1cm4gYy5jYWxsKG51bGwsYSxiKX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGIuY2FsbCh0aGlzLGMsZSk7Y2FzZSAzOnJldHVybiBhLmNhbGwodGhpcyxjLGUsZil9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYT1iO2MuYz1hO3JldHVybiBjfSgpO1xuZnVuY3Rpb24gaGIoYSxiLGMpe2lmKGE/YS5aYTphKXJldHVybiBhLlphKGEsYixjKTt2YXIgZDtkPWhiW20obnVsbD09YT9udWxsOmEpXTtpZighZCYmKGQ9aGIuXywhZCkpdGhyb3cgeChcIklLVlJlZHVjZS4ta3YtcmVkdWNlXCIsYSk7cmV0dXJuIGQuY2FsbChudWxsLGEsYixjKX1mdW5jdGlvbiBpYihhLGIpe2lmKGE/YS52OmEpcmV0dXJuIGEudihhLGIpO3ZhciBjO2M9aWJbbShudWxsPT1hP251bGw6YSldO2lmKCFjJiYoYz1pYi5fLCFjKSl0aHJvdyB4KFwiSUVxdWl2Li1lcXVpdlwiLGEpO3JldHVybiBjLmNhbGwobnVsbCxhLGIpfWZ1bmN0aW9uIGpiKGEpe2lmKGE/YS5COmEpcmV0dXJuIGEuQihhKTt2YXIgYjtiPWpiW20obnVsbD09YT9udWxsOmEpXTtpZighYiYmKGI9amIuXywhYikpdGhyb3cgeChcIklIYXNoLi1oYXNoXCIsYSk7cmV0dXJuIGIuY2FsbChudWxsLGEpfXZhciBrYj17fTtcbmZ1bmN0aW9uIGxiKGEpe2lmKGE/YS5IOmEpcmV0dXJuIGEuSChhKTt2YXIgYjtiPWxiW20obnVsbD09YT9udWxsOmEpXTtpZighYiYmKGI9bGIuXywhYikpdGhyb3cgeChcIklTZXFhYmxlLi1zZXFcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9dmFyIG1iPXt9LG5iPXt9LG9iPXt9O2Z1bmN0aW9uIHBiKGEpe2lmKGE/YS5YYTphKXJldHVybiBhLlhhKGEpO3ZhciBiO2I9cGJbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj1wYi5fLCFiKSl0aHJvdyB4KFwiSVJldmVyc2libGUuLXJzZXFcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9ZnVuY3Rpb24gcWIoYSxiKXtpZihhP2EueWI6YSlyZXR1cm4gYS55YihhLGIpO3ZhciBjO2M9cWJbbShudWxsPT1hP251bGw6YSldO2lmKCFjJiYoYz1xYi5fLCFjKSl0aHJvdyB4KFwiSVNvcnRlZC4tc29ydGVkLXNlcVwiLGEpO3JldHVybiBjLmNhbGwobnVsbCxhLGIpfVxuZnVuY3Rpb24gcmIoYSxiLGMpe2lmKGE/YS56YjphKXJldHVybiBhLnpiKGEsYixjKTt2YXIgZDtkPXJiW20obnVsbD09YT9udWxsOmEpXTtpZighZCYmKGQ9cmIuXywhZCkpdGhyb3cgeChcIklTb3J0ZWQuLXNvcnRlZC1zZXEtZnJvbVwiLGEpO3JldHVybiBkLmNhbGwobnVsbCxhLGIsYyl9ZnVuY3Rpb24gc2IoYSxiKXtpZihhP2EueGI6YSlyZXR1cm4gYS54YihhLGIpO3ZhciBjO2M9c2JbbShudWxsPT1hP251bGw6YSldO2lmKCFjJiYoYz1zYi5fLCFjKSl0aHJvdyB4KFwiSVNvcnRlZC4tZW50cnkta2V5XCIsYSk7cmV0dXJuIGMuY2FsbChudWxsLGEsYil9ZnVuY3Rpb24gdGIoYSl7aWYoYT9hLndiOmEpcmV0dXJuIGEud2IoYSk7dmFyIGI7Yj10YlttKG51bGw9PWE/bnVsbDphKV07aWYoIWImJihiPXRiLl8sIWIpKXRocm93IHgoXCJJU29ydGVkLi1jb21wYXJhdG9yXCIsYSk7cmV0dXJuIGIuY2FsbChudWxsLGEpfVxuZnVuY3Rpb24gdWIoYSxiKXtpZihhP2EuU2I6YSlyZXR1cm4gYS5TYigwLGIpO3ZhciBjO2M9dWJbbShudWxsPT1hP251bGw6YSldO2lmKCFjJiYoYz11Yi5fLCFjKSl0aHJvdyB4KFwiSVdyaXRlci4td3JpdGVcIixhKTtyZXR1cm4gYy5jYWxsKG51bGwsYSxiKX12YXIgdmI9e307ZnVuY3Rpb24gd2IoYSxiLGMpe2lmKGE/YS53OmEpcmV0dXJuIGEudyhhLGIsYyk7dmFyIGQ7ZD13YlttKG51bGw9PWE/bnVsbDphKV07aWYoIWQmJihkPXdiLl8sIWQpKXRocm93IHgoXCJJUHJpbnRXaXRoV3JpdGVyLi1wci13cml0ZXJcIixhKTtyZXR1cm4gZC5jYWxsKG51bGwsYSxiLGMpfWZ1bmN0aW9uIHhiKGEsYixjKXtpZihhP2EuUmI6YSlyZXR1cm4gYS5SYigwLGIsYyk7dmFyIGQ7ZD14YlttKG51bGw9PWE/bnVsbDphKV07aWYoIWQmJihkPXhiLl8sIWQpKXRocm93IHgoXCJJV2F0Y2hhYmxlLi1ub3RpZnktd2F0Y2hlc1wiLGEpO3JldHVybiBkLmNhbGwobnVsbCxhLGIsYyl9XG5mdW5jdGlvbiB5YihhKXtpZihhP2EuV2E6YSlyZXR1cm4gYS5XYShhKTt2YXIgYjtiPXliW20obnVsbD09YT9udWxsOmEpXTtpZighYiYmKGI9eWIuXywhYikpdGhyb3cgeChcIklFZGl0YWJsZUNvbGxlY3Rpb24uLWFzLXRyYW5zaWVudFwiLGEpO3JldHVybiBiLmNhbGwobnVsbCxhKX1mdW5jdGlvbiB6YihhLGIpe2lmKGE/YS5LYTphKXJldHVybiBhLkthKGEsYik7dmFyIGM7Yz16YlttKG51bGw9PWE/bnVsbDphKV07aWYoIWMmJihjPXpiLl8sIWMpKXRocm93IHgoXCJJVHJhbnNpZW50Q29sbGVjdGlvbi4tY29uaiFcIixhKTtyZXR1cm4gYy5jYWxsKG51bGwsYSxiKX1mdW5jdGlvbiBBYihhKXtpZihhP2EuT2E6YSlyZXR1cm4gYS5PYShhKTt2YXIgYjtiPUFiW20obnVsbD09YT9udWxsOmEpXTtpZighYiYmKGI9QWIuXywhYikpdGhyb3cgeChcIklUcmFuc2llbnRDb2xsZWN0aW9uLi1wZXJzaXN0ZW50IVwiLGEpO3JldHVybiBiLmNhbGwobnVsbCxhKX1cbmZ1bmN0aW9uIEJiKGEsYixjKXtpZihhP2EuY2I6YSlyZXR1cm4gYS5jYihhLGIsYyk7dmFyIGQ7ZD1CYlttKG51bGw9PWE/bnVsbDphKV07aWYoIWQmJihkPUJiLl8sIWQpKXRocm93IHgoXCJJVHJhbnNpZW50QXNzb2NpYXRpdmUuLWFzc29jIVwiLGEpO3JldHVybiBkLmNhbGwobnVsbCxhLGIsYyl9ZnVuY3Rpb24gQ2IoYSxiKXtpZihhP2EuQWI6YSlyZXR1cm4gYS5BYihhLGIpO3ZhciBjO2M9Q2JbbShudWxsPT1hP251bGw6YSldO2lmKCFjJiYoYz1DYi5fLCFjKSl0aHJvdyB4KFwiSVRyYW5zaWVudE1hcC4tZGlzc29jIVwiLGEpO3JldHVybiBjLmNhbGwobnVsbCxhLGIpfWZ1bmN0aW9uIERiKGEsYixjKXtpZihhP2EuUGI6YSlyZXR1cm4gYS5QYigwLGIsYyk7dmFyIGQ7ZD1EYlttKG51bGw9PWE/bnVsbDphKV07aWYoIWQmJihkPURiLl8sIWQpKXRocm93IHgoXCJJVHJhbnNpZW50VmVjdG9yLi1hc3NvYy1uIVwiLGEpO3JldHVybiBkLmNhbGwobnVsbCxhLGIsYyl9XG5mdW5jdGlvbiBFYihhKXtpZihhP2EuUWI6YSlyZXR1cm4gYS5RYigpO3ZhciBiO2I9RWJbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj1FYi5fLCFiKSl0aHJvdyB4KFwiSVRyYW5zaWVudFZlY3Rvci4tcG9wIVwiLGEpO3JldHVybiBiLmNhbGwobnVsbCxhKX1mdW5jdGlvbiBGYihhLGIpe2lmKGE/YS5PYjphKXJldHVybiBhLk9iKDAsYik7dmFyIGM7Yz1GYlttKG51bGw9PWE/bnVsbDphKV07aWYoIWMmJihjPUZiLl8sIWMpKXRocm93IHgoXCJJVHJhbnNpZW50U2V0Li1kaXNqb2luIVwiLGEpO3JldHVybiBjLmNhbGwobnVsbCxhLGIpfWZ1bmN0aW9uIEdiKGEpe2lmKGE/YS5LYjphKXJldHVybiBhLktiKCk7dmFyIGI7Yj1HYlttKG51bGw9PWE/bnVsbDphKV07aWYoIWImJihiPUdiLl8sIWIpKXRocm93IHgoXCJJQ2h1bmsuLWRyb3AtZmlyc3RcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9XG5mdW5jdGlvbiBIYihhKXtpZihhP2Euc2I6YSlyZXR1cm4gYS5zYihhKTt2YXIgYjtiPUhiW20obnVsbD09YT9udWxsOmEpXTtpZighYiYmKGI9SGIuXywhYikpdGhyb3cgeChcIklDaHVua2VkU2VxLi1jaHVua2VkLWZpcnN0XCIsYSk7cmV0dXJuIGIuY2FsbChudWxsLGEpfWZ1bmN0aW9uIEliKGEpe2lmKGE/YS50YjphKXJldHVybiBhLnRiKGEpO3ZhciBiO2I9SWJbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj1JYi5fLCFiKSl0aHJvdyB4KFwiSUNodW5rZWRTZXEuLWNodW5rZWQtcmVzdFwiLGEpO3JldHVybiBiLmNhbGwobnVsbCxhKX1mdW5jdGlvbiBKYihhKXtpZihhP2EucmI6YSlyZXR1cm4gYS5yYihhKTt2YXIgYjtiPUpiW20obnVsbD09YT9udWxsOmEpXTtpZighYiYmKGI9SmIuXywhYikpdGhyb3cgeChcIklDaHVua2VkTmV4dC4tY2h1bmtlZC1uZXh0XCIsYSk7cmV0dXJuIGIuY2FsbChudWxsLGEpfVxuZnVuY3Rpb24gS2IoYSl7dGhpcy52Yz1hO3RoaXMucT0wO3RoaXMuaT0xMDczNzQxODI0fUtiLnByb3RvdHlwZS5TYj1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLnZjLmFwcGVuZChiKX07ZnVuY3Rpb24gTGIoYSl7dmFyIGI9bmV3IGVhO2EudyhudWxsLG5ldyBLYihiKSxrYSgpKTtyZXR1cm5cIlwiK0EuYihiKX12YXIgTWI9XCJ1bmRlZmluZWRcIiE9PXR5cGVvZiBNYXRoLmltdWwmJjAhPT0oTWF0aC5pbXVsLmE/TWF0aC5pbXVsLmEoNDI5NDk2NzI5NSw1KTpNYXRoLmltdWwuY2FsbChudWxsLDQyOTQ5NjcyOTUsNSkpP2Z1bmN0aW9uKGEsYil7cmV0dXJuIE1hdGguaW11bChhLGIpfTpmdW5jdGlvbihhLGIpe3ZhciBjPWEmNjU1MzUsZD1iJjY1NTM1O3JldHVybiBjKmQrKChhPj4+MTYmNjU1MzUpKmQrYyooYj4+PjE2JjY1NTM1KTw8MTY+Pj4wKXwwfTtmdW5jdGlvbiBOYihhKXthPU1iKGEsMzQzMjkxODM1Myk7cmV0dXJuIE1iKGE8PDE1fGE+Pj4tMTUsNDYxODQ1OTA3KX1cbmZ1bmN0aW9uIE9iKGEsYil7dmFyIGM9YV5iO3JldHVybiBNYihjPDwxM3xjPj4+LTEzLDUpKzM4NjQyOTIxOTZ9ZnVuY3Rpb24gUGIoYSxiKXt2YXIgYz1hXmIsYz1NYihjXmM+Pj4xNiwyMjQ2ODIyNTA3KSxjPU1iKGNeYz4+PjEzLDMyNjY0ODk5MDkpO3JldHVybiBjXmM+Pj4xNn12YXIgUWI9e30sUmI9MDtmdW5jdGlvbiBTYihhKXsyNTU8UmImJihRYj17fSxSYj0wKTt2YXIgYj1RYlthXTtpZihcIm51bWJlclwiIT09dHlwZW9mIGIpe2E6aWYobnVsbCE9YSlpZihiPWEubGVuZ3RoLDA8Yil7Zm9yKHZhciBjPTAsZD0wOzspaWYoYzxiKXZhciBlPWMrMSxkPU1iKDMxLGQpK2EuY2hhckNvZGVBdChjKSxjPWU7ZWxzZXtiPWQ7YnJlYWsgYX1iPXZvaWQgMH1lbHNlIGI9MDtlbHNlIGI9MDtRYlthXT1iO1JiKz0xfXJldHVybiBhPWJ9XG5mdW5jdGlvbiBUYihhKXthJiYoYS5pJjQxOTQzMDR8fGEuRGMpP2E9YS5CKG51bGwpOlwibnVtYmVyXCI9PT10eXBlb2YgYT9hPU1hdGguZmxvb3IoYSklMjE0NzQ4MzY0NzohMD09PWE/YT0xOiExPT09YT9hPTA6XCJzdHJpbmdcIj09PXR5cGVvZiBhPyhhPVNiKGEpLDAhPT1hJiYoYT1OYihhKSxhPU9iKDAsYSksYT1QYihhLDQpKSk6YT1udWxsPT1hPzA6dT9qYihhKTpudWxsO3JldHVybiBhfVxuZnVuY3Rpb24gVWIoYSl7dmFyIGI7Yj1hLm5hbWU7dmFyIGM7YTp7Yz0xO2Zvcih2YXIgZD0wOzspaWYoYzxiLmxlbmd0aCl7dmFyIGU9YysyLGQ9T2IoZCxOYihiLmNoYXJDb2RlQXQoYy0xKXxiLmNoYXJDb2RlQXQoYyk8PDE2KSk7Yz1lfWVsc2V7Yz1kO2JyZWFrIGF9Yz12b2lkIDB9Yz0xPT09KGIubGVuZ3RoJjEpP2NeTmIoYi5jaGFyQ29kZUF0KGIubGVuZ3RoLTEpKTpjO2I9UGIoYyxNYigyLGIubGVuZ3RoKSk7YT1TYihhLmZhKTtyZXR1cm4gYl5hKzI2NTQ0MzU3NjkrKGI8PDYpKyhiPj4yKX1cbmZ1bmN0aW9uIFZiKGEsYil7aWYocihXYi5hP1diLmEoYSxiKTpXYi5jYWxsKG51bGwsYSxiKSkpcmV0dXJuIDA7dmFyIGM9c2EoYS5mYSk7aWYocihjP2IuZmE6YykpcmV0dXJuLTE7aWYocihhLmZhKSl7aWYoc2EoYi5mYSkpcmV0dXJuIDE7Yz1YYi5hP1hiLmEoYS5mYSxiLmZhKTpYYi5jYWxsKG51bGwsYS5mYSxiLmZhKTtyZXR1cm4gMD09PWM/WGIuYT9YYi5hKGEubmFtZSxiLm5hbWUpOlhiLmNhbGwobnVsbCxhLm5hbWUsYi5uYW1lKTpjfXJldHVybiBZYj9YYi5hP1hiLmEoYS5uYW1lLGIubmFtZSk6WGIuY2FsbChudWxsLGEubmFtZSxiLm5hbWUpOm51bGx9ZnVuY3Rpb24gWmIoYSxiLGMsZCxlKXt0aGlzLmZhPWE7dGhpcy5uYW1lPWI7dGhpcy5OYT1jO3RoaXMuVWE9ZDt0aGlzLlc9ZTt0aGlzLmk9MjE1NDE2ODMyMTt0aGlzLnE9NDA5Nn1nPVpiLnByb3RvdHlwZTtnLnc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdWIoYix0aGlzLk5hKX07XG5nLkI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLlVhO3JldHVybiBudWxsIT1hP2E6dGhpcy5VYT1hPVViKHRoaXMpfTtnLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IFpiKHRoaXMuZmEsdGhpcy5uYW1lLHRoaXMuTmEsdGhpcy5VYSxiKX07Zy5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuV307Zy5jYWxsPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbDtyZXR1cm4gYT1mdW5jdGlvbihhLGMsZCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gTGEuYyhjLHRoaXMsbnVsbCk7Y2FzZSAzOnJldHVybiBMYS5jKGMsdGhpcyxkKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO319KCk7Zy5hcHBseT1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmNhbGwuYXBwbHkodGhpcyxbdGhpc10uY29uY2F0KHZhKGIpKSl9O2cuYj1mdW5jdGlvbihhKXtyZXR1cm4gTGEuYyhhLHRoaXMsbnVsbCl9O1xuZy5hPWZ1bmN0aW9uKGEsYil7cmV0dXJuIExhLmMoYSx0aGlzLGIpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYiBpbnN0YW5jZW9mIFpiP3RoaXMuTmE9PT1iLk5hOiExfTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuTmF9O3ZhciAkYj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXt2YXIgYz1udWxsIT1hP1wiXCIrQS5iKGEpK1wiL1wiK0EuYihiKTpiO3JldHVybiBuZXcgWmIoYSxiLGMsbnVsbCxudWxsKX1mdW5jdGlvbiBiKGEpe3JldHVybiBhIGluc3RhbmNlb2YgWmI/YTpjLmEobnVsbCxhKX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBiLmNhbGwodGhpcyxjKTtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYj1iO2MuYT1hO3JldHVybiBjfSgpO1xuZnVuY3Rpb24gRShhKXtpZihudWxsPT1hKXJldHVybiBudWxsO2lmKGEmJihhLmkmODM4ODYwOHx8YS5oYykpcmV0dXJuIGEuSChudWxsKTtpZihhIGluc3RhbmNlb2YgQXJyYXl8fFwic3RyaW5nXCI9PT10eXBlb2YgYSlyZXR1cm4gMD09PWEubGVuZ3RoP251bGw6bmV3IGFjKGEsMCk7aWYocyhrYixhKSlyZXR1cm4gbGIoYSk7aWYodSl0aHJvdyBFcnJvcihcIlwiK0EuYihhKStcIiBpcyBub3QgSVNlcWFibGVcIik7cmV0dXJuIG51bGx9ZnVuY3Rpb24gRihhKXtpZihudWxsPT1hKXJldHVybiBudWxsO2lmKGEmJihhLmkmNjR8fGEuYmIpKXJldHVybiBhLlEobnVsbCk7YT1FKGEpO3JldHVybiBudWxsPT1hP251bGw6SGEoYSl9ZnVuY3Rpb24gRyhhKXtyZXR1cm4gbnVsbCE9YT9hJiYoYS5pJjY0fHxhLmJiKT9hLlMobnVsbCk6KGE9RShhKSk/SWEoYSk6SDpIfWZ1bmN0aW9uIEkoYSl7cmV0dXJuIG51bGw9PWE/bnVsbDphJiYoYS5pJjEyOHx8YS5vYik/YS5VKG51bGwpOkUoRyhhKSl9XG52YXIgV2I9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7cmV0dXJuIG51bGw9PWE/bnVsbD09YjphPT09Ynx8aWIoYSxiKX12YXIgYj1udWxsLGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGIsZCxrKXt2YXIgbD1udWxsOzI8YXJndW1lbnRzLmxlbmd0aCYmKGw9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMiksMCkpO3JldHVybiBjLmNhbGwodGhpcyxiLGQsbCl9ZnVuY3Rpb24gYyhhLGQsZSl7Zm9yKDs7KWlmKGIuYShhLGQpKWlmKEkoZSkpYT1kLGQ9RihlKSxlPUkoZSk7ZWxzZSByZXR1cm4gYi5hKGQsRihlKSk7ZWxzZSByZXR1cm4hMX1hLms9MjthLmY9ZnVuY3Rpb24oYSl7dmFyIGI9RihhKTthPUkoYSk7dmFyIGQ9RihhKTthPUcoYSk7cmV0dXJuIGMoYixkLGEpfTthLmQ9YztyZXR1cm4gYX0oKSxiPWZ1bmN0aW9uKGIsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiEwO2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsYixcbmUpO2RlZmF1bHQ6cmV0dXJuIGMuZChiLGUsSihhcmd1bWVudHMsMikpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtiLms9MjtiLmY9Yy5mO2IuYj1mdW5jdGlvbigpe3JldHVybiEwfTtiLmE9YTtiLmQ9Yy5kO3JldHVybiBifSgpO2Z1bmN0aW9uIGJjKGEsYil7dmFyIGM9TmIoYSksYz1PYigwLGMpO3JldHVybiBQYihjLGIpfWZ1bmN0aW9uIGNjKGEpe3ZhciBiPTAsYz0xO2ZvcihhPUUoYSk7OylpZihudWxsIT1hKWIrPTEsYz1NYigzMSxjKStUYihGKGEpKXwwLGE9SShhKTtlbHNlIHJldHVybiBiYyhjLGIpfWZ1bmN0aW9uIGRjKGEpe3ZhciBiPTAsYz0wO2ZvcihhPUUoYSk7OylpZihudWxsIT1hKWIrPTEsYz1jK1RiKEYoYSkpfDAsYT1JKGEpO2Vsc2UgcmV0dXJuIGJjKGMsYil9emFbXCJudWxsXCJdPSEwO0FhW1wibnVsbFwiXT1mdW5jdGlvbigpe3JldHVybiAwfTtcbkRhdGUucHJvdG90eXBlLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYiBpbnN0YW5jZW9mIERhdGUmJnRoaXMudG9TdHJpbmcoKT09PWIudG9TdHJpbmcoKX07aWIubnVtYmVyPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGE9PT1ifTtiYltcImZ1bmN0aW9uXCJdPSEwO2NiW1wiZnVuY3Rpb25cIl09ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbH07eWFbXCJmdW5jdGlvblwiXT0hMDtqYi5fPWZ1bmN0aW9uKGEpe3JldHVybiBhW2JhXXx8KGFbYmFdPSsrY2EpfTtmdW5jdGlvbiBlYyhhKXt0aGlzLmw9YTt0aGlzLnE9MDt0aGlzLmk9MzI3Njh9ZWMucHJvdG90eXBlLnViPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubH07ZnVuY3Rpb24gZmMoYSl7cmV0dXJuIGEgaW5zdGFuY2VvZiBlY31cbnZhciBnYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMsZCl7Zm9yKHZhciBsPUFhKGEpOzspaWYoZDxsKXtjPWIuYT9iLmEoYyxELmEoYSxkKSk6Yi5jYWxsKG51bGwsYyxELmEoYSxkKSk7aWYoZmMoYykpcmV0dXJuIEsuYj9LLmIoYyk6Sy5jYWxsKG51bGwsYyk7ZCs9MX1lbHNlIHJldHVybiBjfWZ1bmN0aW9uIGIoYSxiLGMpe2Zvcih2YXIgZD1BYShhKSxsPTA7OylpZihsPGQpe2M9Yi5hP2IuYShjLEQuYShhLGwpKTpiLmNhbGwobnVsbCxjLEQuYShhLGwpKTtpZihmYyhjKSlyZXR1cm4gSy5iP0suYihjKTpLLmNhbGwobnVsbCxjKTtsKz0xfWVsc2UgcmV0dXJuIGN9ZnVuY3Rpb24gYyhhLGIpe3ZhciBjPUFhKGEpO2lmKDA9PT1jKXJldHVybiBiLm8/Yi5vKCk6Yi5jYWxsKG51bGwpO2Zvcih2YXIgZD1ELmEoYSwwKSxsPTE7OylpZihsPGMpe2Q9Yi5hP2IuYShkLEQuYShhLGwpKTpiLmNhbGwobnVsbCxkLEQuYShhLGwpKTtpZihmYyhkKSlyZXR1cm4gSy5iP0suYihkKTpLLmNhbGwobnVsbCxcbmQpO2wrPTF9ZWxzZSByZXR1cm4gZH12YXIgZD1udWxsLGQ9ZnVuY3Rpb24oZCxmLGgsayl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gYy5jYWxsKHRoaXMsZCxmKTtjYXNlIDM6cmV0dXJuIGIuY2FsbCh0aGlzLGQsZixoKTtjYXNlIDQ6cmV0dXJuIGEuY2FsbCh0aGlzLGQsZixoLGspfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtkLmE9YztkLmM9YjtkLm49YTtyZXR1cm4gZH0oKSxoYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMsZCl7Zm9yKHZhciBsPWEubGVuZ3RoOzspaWYoZDxsKXtjPWIuYT9iLmEoYyxhW2RdKTpiLmNhbGwobnVsbCxjLGFbZF0pO2lmKGZjKGMpKXJldHVybiBLLmI/Sy5iKGMpOksuY2FsbChudWxsLGMpO2QrPTF9ZWxzZSByZXR1cm4gY31mdW5jdGlvbiBiKGEsYixjKXtmb3IodmFyIGQ9YS5sZW5ndGgsbD0wOzspaWYobDxkKXtjPWIuYT9iLmEoYyxhW2xdKTpiLmNhbGwobnVsbCxjLFxuYVtsXSk7aWYoZmMoYykpcmV0dXJuIEsuYj9LLmIoYyk6Sy5jYWxsKG51bGwsYyk7bCs9MX1lbHNlIHJldHVybiBjfWZ1bmN0aW9uIGMoYSxiKXt2YXIgYz1hLmxlbmd0aDtpZigwPT09YS5sZW5ndGgpcmV0dXJuIGIubz9iLm8oKTpiLmNhbGwobnVsbCk7Zm9yKHZhciBkPWFbMF0sbD0xOzspaWYobDxjKXtkPWIuYT9iLmEoZCxhW2xdKTpiLmNhbGwobnVsbCxkLGFbbF0pO2lmKGZjKGQpKXJldHVybiBLLmI/Sy5iKGQpOksuY2FsbChudWxsLGQpO2wrPTF9ZWxzZSByZXR1cm4gZH12YXIgZD1udWxsLGQ9ZnVuY3Rpb24oZCxmLGgsayl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gYy5jYWxsKHRoaXMsZCxmKTtjYXNlIDM6cmV0dXJuIGIuY2FsbCh0aGlzLGQsZixoKTtjYXNlIDQ6cmV0dXJuIGEuY2FsbCh0aGlzLGQsZixoLGspfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtkLmE9YztkLmM9YjtkLm49YTtyZXR1cm4gZH0oKTtcbmZ1bmN0aW9uIGljKGEpe3JldHVybiBhP2EuaSYyfHxhLlliPyEwOmEuaT8hMTpzKHphLGEpOnMoemEsYSl9ZnVuY3Rpb24gamMoYSl7cmV0dXJuIGE/YS5pJjE2fHxhLkxiPyEwOmEuaT8hMTpzKEVhLGEpOnMoRWEsYSl9ZnVuY3Rpb24gYWMoYSxiKXt0aGlzLmU9YTt0aGlzLnA9Yjt0aGlzLmk9MTY2MTk5NTUwO3RoaXMucT04MTkyfWc9YWMucHJvdG90eXBlO2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O2cuSj1mdW5jdGlvbihhLGIpe3ZhciBjPWIrdGhpcy5wO3JldHVybiBjPHRoaXMuZS5sZW5ndGg/dGhpcy5lW2NdOm51bGx9O2cuYWE9ZnVuY3Rpb24oYSxiLGMpe2E9Yit0aGlzLnA7cmV0dXJuIGE8dGhpcy5lLmxlbmd0aD90aGlzLmVbYV06Y307Zy5VPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucCsxPHRoaXMuZS5sZW5ndGg/bmV3IGFjKHRoaXMuZSx0aGlzLnArMSk6bnVsbH07Zy5MPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZS5sZW5ndGgtdGhpcy5wfTtcbmcuWGE9ZnVuY3Rpb24oKXt2YXIgYT1BYSh0aGlzKTtyZXR1cm4gMDxhP25ldyBrYyh0aGlzLGEtMSxudWxsKTpudWxsfTtnLkI9ZnVuY3Rpb24oKXtyZXR1cm4gY2ModGhpcyl9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBsYy5hP2xjLmEodGhpcyxiKTpsYy5jYWxsKG51bGwsdGhpcyxiKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIEh9O2cuTj1mdW5jdGlvbihhLGIpe3JldHVybiBoYy5uKHRoaXMuZSxiLHRoaXMuZVt0aGlzLnBdLHRoaXMucCsxKX07Zy5NPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gaGMubih0aGlzLmUsYixjLHRoaXMucCl9O2cuUT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVbdGhpcy5wXX07Zy5TPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucCsxPHRoaXMuZS5sZW5ndGg/bmV3IGFjKHRoaXMuZSx0aGlzLnArMSk6SH07Zy5IPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9O1xuZy5HPWZ1bmN0aW9uKGEsYil7cmV0dXJuIE0uYT9NLmEoYix0aGlzKTpNLmNhbGwobnVsbCxiLHRoaXMpfTtcbnZhciBtYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4gYjxhLmxlbmd0aD9uZXcgYWMoYSxiKTpudWxsfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIGMuYShhLDApfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGIuY2FsbCh0aGlzLGMpO2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5iPWI7Yy5hPWE7cmV0dXJuIGN9KCksSj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4gbWMuYShhLGIpfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIG1jLmEoYSwwKX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBiLmNhbGwodGhpcyxjKTtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIitcbmFyZ3VtZW50cy5sZW5ndGgpO307Yy5iPWI7Yy5hPWE7cmV0dXJuIGN9KCk7ZnVuY3Rpb24ga2MoYSxiLGMpe3RoaXMuamI9YTt0aGlzLnA9Yjt0aGlzLmo9Yzt0aGlzLmk9MzIzNzQ5OTA7dGhpcy5xPTgxOTJ9Zz1rYy5wcm90b3R5cGU7Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07Zy5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuan07Zy5VPWZ1bmN0aW9uKCl7cmV0dXJuIDA8dGhpcy5wP25ldyBrYyh0aGlzLmpiLHRoaXMucC0xLG51bGwpOm51bGx9O2cuTD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnArMX07Zy5CPWZ1bmN0aW9uKCl7cmV0dXJuIGNjKHRoaXMpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbGMuYT9sYy5hKHRoaXMsYik6bGMuY2FsbChudWxsLHRoaXMsYil9O2cuST1mdW5jdGlvbigpe3JldHVybiBOLmE/Ti5hKEgsdGhpcy5qKTpOLmNhbGwobnVsbCxILHRoaXMuail9O1xuZy5OPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5jLmE/bmMuYShiLHRoaXMpOm5jLmNhbGwobnVsbCxiLHRoaXMpfTtnLk09ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBuYy5jP25jLmMoYixjLHRoaXMpOm5jLmNhbGwobnVsbCxiLGMsdGhpcyl9O2cuUT1mdW5jdGlvbigpe3JldHVybiBELmEodGhpcy5qYix0aGlzLnApfTtnLlM9ZnVuY3Rpb24oKXtyZXR1cm4gMDx0aGlzLnA/bmV3IGtjKHRoaXMuamIsdGhpcy5wLTEsbnVsbCk6SH07Zy5IPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9O2cuRj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcga2ModGhpcy5qYix0aGlzLnAsYil9O2cuRz1mdW5jdGlvbihhLGIpe3JldHVybiBNLmE/TS5hKGIsdGhpcyk6TS5jYWxsKG51bGwsYix0aGlzKX07ZnVuY3Rpb24gb2MoYSl7Zm9yKDs7KXt2YXIgYj1JKGEpO2lmKG51bGwhPWIpYT1iO2Vsc2UgcmV0dXJuIEYoYSl9fWliLl89ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYT09PWJ9O1xudmFyIHBjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3JldHVybiBudWxsIT1hP0RhKGEsYik6RGEoSCxiKX12YXIgYj1udWxsLGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGIsZCxrKXt2YXIgbD1udWxsOzI8YXJndW1lbnRzLmxlbmd0aCYmKGw9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMiksMCkpO3JldHVybiBjLmNhbGwodGhpcyxiLGQsbCl9ZnVuY3Rpb24gYyhhLGQsZSl7Zm9yKDs7KWlmKHIoZSkpYT1iLmEoYSxkKSxkPUYoZSksZT1JKGUpO2Vsc2UgcmV0dXJuIGIuYShhLGQpfWEuaz0yO2EuZj1mdW5jdGlvbihhKXt2YXIgYj1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9RyhhKTtyZXR1cm4gYyhiLGQsYSl9O2EuZD1jO3JldHVybiBhfSgpLGI9ZnVuY3Rpb24oYixlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGIsZSk7ZGVmYXVsdDpyZXR1cm4gYy5kKGIsZSxKKGFyZ3VtZW50cywyKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIitcbmFyZ3VtZW50cy5sZW5ndGgpO307Yi5rPTI7Yi5mPWMuZjtiLmE9YTtiLmQ9Yy5kO3JldHVybiBifSgpO2Z1bmN0aW9uIHFjKGEpe3JldHVybiBudWxsPT1hP251bGw6QmEoYSl9ZnVuY3Rpb24gTyhhKXtpZihudWxsIT1hKWlmKGEmJihhLmkmMnx8YS5ZYikpYT1hLkwobnVsbCk7ZWxzZSBpZihhIGluc3RhbmNlb2YgQXJyYXkpYT1hLmxlbmd0aDtlbHNlIGlmKFwic3RyaW5nXCI9PT10eXBlb2YgYSlhPWEubGVuZ3RoO2Vsc2UgaWYocyh6YSxhKSlhPUFhKGEpO2Vsc2UgaWYodSlhOnthPUUoYSk7Zm9yKHZhciBiPTA7Oyl7aWYoaWMoYSkpe2E9YitBYShhKTticmVhayBhfWE9SShhKTtiKz0xfWE9dm9pZCAwfWVsc2UgYT1udWxsO2Vsc2UgYT0wO3JldHVybiBhfVxudmFyIHJjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyl7Zm9yKDs7KXtpZihudWxsPT1hKXJldHVybiBjO2lmKDA9PT1iKXJldHVybiBFKGEpP0YoYSk6YztpZihqYyhhKSlyZXR1cm4gRC5jKGEsYixjKTtpZihFKGEpKWE9SShhKSxiLT0xO2Vsc2UgcmV0dXJuIHU/YzpudWxsfX1mdW5jdGlvbiBiKGEsYil7Zm9yKDs7KXtpZihudWxsPT1hKXRocm93IEVycm9yKFwiSW5kZXggb3V0IG9mIGJvdW5kc1wiKTtpZigwPT09Yil7aWYoRShhKSlyZXR1cm4gRihhKTt0aHJvdyBFcnJvcihcIkluZGV4IG91dCBvZiBib3VuZHNcIik7fWlmKGpjKGEpKXJldHVybiBELmEoYSxiKTtpZihFKGEpKXt2YXIgYz1JKGEpLGg9Yi0xO2E9YztiPWh9ZWxzZXtpZih1KXRocm93IEVycm9yKFwiSW5kZXggb3V0IG9mIGJvdW5kc1wiKTtyZXR1cm4gbnVsbH19fXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gYi5jYWxsKHRoaXMsYyxlKTtjYXNlIDM6cmV0dXJuIGEuY2FsbCh0aGlzLFxuYyxlLGYpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmE9YjtjLmM9YTtyZXR1cm4gY30oKSxQPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyl7aWYoXCJudW1iZXJcIiE9PXR5cGVvZiBiKXRocm93IEVycm9yKFwiaW5kZXggYXJndW1lbnQgdG8gbnRoIG11c3QgYmUgYSBudW1iZXIuXCIpO2lmKG51bGw9PWEpcmV0dXJuIGM7aWYoYSYmKGEuaSYxNnx8YS5MYikpcmV0dXJuIGEuYWEobnVsbCxiLGMpO2lmKGEgaW5zdGFuY2VvZiBBcnJheXx8XCJzdHJpbmdcIj09PXR5cGVvZiBhKXJldHVybiBiPGEubGVuZ3RoP2FbYl06YztpZihzKEVhLGEpKXJldHVybiBELmEoYSxiKTtpZihhP2EuaSY2NHx8YS5iYnx8KGEuaT8wOnMoRmEsYSkpOnMoRmEsYSkpcmV0dXJuIHJjLmMoYSxiLGMpO2lmKHUpdGhyb3cgRXJyb3IoXCJudGggbm90IHN1cHBvcnRlZCBvbiB0aGlzIHR5cGUgXCIrQS5iKHVhKHRhKGEpKSkpO3JldHVybiBudWxsfWZ1bmN0aW9uIGIoYSxcbmIpe2lmKFwibnVtYmVyXCIhPT10eXBlb2YgYil0aHJvdyBFcnJvcihcImluZGV4IGFyZ3VtZW50IHRvIG50aCBtdXN0IGJlIGEgbnVtYmVyXCIpO2lmKG51bGw9PWEpcmV0dXJuIGE7aWYoYSYmKGEuaSYxNnx8YS5MYikpcmV0dXJuIGEuSihudWxsLGIpO2lmKGEgaW5zdGFuY2VvZiBBcnJheXx8XCJzdHJpbmdcIj09PXR5cGVvZiBhKXJldHVybiBiPGEubGVuZ3RoP2FbYl06bnVsbDtpZihzKEVhLGEpKXJldHVybiBELmEoYSxiKTtpZihhP2EuaSY2NHx8YS5iYnx8KGEuaT8wOnMoRmEsYSkpOnMoRmEsYSkpcmV0dXJuIHJjLmEoYSxiKTtpZih1KXRocm93IEVycm9yKFwibnRoIG5vdCBzdXBwb3J0ZWQgb24gdGhpcyB0eXBlIFwiK0EuYih1YSh0YShhKSkpKTtyZXR1cm4gbnVsbH12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGIuY2FsbCh0aGlzLGMsZSk7Y2FzZSAzOnJldHVybiBhLmNhbGwodGhpcyxjLGUsZil9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIitcbmFyZ3VtZW50cy5sZW5ndGgpO307Yy5hPWI7Yy5jPWE7cmV0dXJuIGN9KCksUT1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMpe3JldHVybiBudWxsIT1hP2EmJihhLmkmMjU2fHxhLk1iKT9hLkMobnVsbCxiLGMpOmEgaW5zdGFuY2VvZiBBcnJheT9iPGEubGVuZ3RoP2FbYl06YzpcInN0cmluZ1wiPT09dHlwZW9mIGE/YjxhLmxlbmd0aD9hW2JdOmM6cyhLYSxhKT9MYS5jKGEsYixjKTp1P2M6bnVsbDpjfWZ1bmN0aW9uIGIoYSxiKXtyZXR1cm4gbnVsbD09YT9udWxsOmEmJihhLmkmMjU2fHxhLk1iKT9hLnUobnVsbCxiKTphIGluc3RhbmNlb2YgQXJyYXk/YjxhLmxlbmd0aD9hW2JdOm51bGw6XCJzdHJpbmdcIj09PXR5cGVvZiBhP2I8YS5sZW5ndGg/YVtiXTpudWxsOnMoS2EsYSk/TGEuYShhLGIpOm51bGx9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBiLmNhbGwodGhpcyxjLGUpO2Nhc2UgMzpyZXR1cm4gYS5jYWxsKHRoaXMsXG5jLGUsZil9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYT1iO2MuYz1hO3JldHVybiBjfSgpLFI9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjKXtyZXR1cm4gbnVsbCE9YT9PYShhLGIsYyk6c2MuYT9zYy5hKFtiXSxbY10pOnNjLmNhbGwobnVsbCxbYl0sW2NdKX12YXIgYj1udWxsLGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGIsZCxrLGwpe3ZhciBuPW51bGw7Mzxhcmd1bWVudHMubGVuZ3RoJiYobj1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywzKSwwKSk7cmV0dXJuIGMuY2FsbCh0aGlzLGIsZCxrLG4pfWZ1bmN0aW9uIGMoYSxkLGUsbCl7Zm9yKDs7KWlmKGE9Yi5jKGEsZCxlKSxyKGwpKWQ9RihsKSxlPUYoSShsKSksbD1JKEkobCkpO2Vsc2UgcmV0dXJuIGF9YS5rPTM7YS5mPWZ1bmN0aW9uKGEpe3ZhciBiPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1JKGEpO3ZhciBsPUYoYSk7YT1HKGEpO3JldHVybiBjKGIsXG5kLGwsYSl9O2EuZD1jO3JldHVybiBhfSgpLGI9ZnVuY3Rpb24oYixlLGYsaCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMzpyZXR1cm4gYS5jYWxsKHRoaXMsYixlLGYpO2RlZmF1bHQ6cmV0dXJuIGMuZChiLGUsZixKKGFyZ3VtZW50cywzKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Iuaz0zO2IuZj1jLmY7Yi5jPWE7Yi5kPWMuZDtyZXR1cm4gYn0oKSx0Yz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4gbnVsbD09YT9udWxsOlFhKGEsYil9dmFyIGI9bnVsbCxjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShiLGQsayl7dmFyIGw9bnVsbDsyPGFyZ3VtZW50cy5sZW5ndGgmJihsPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpLDApKTtyZXR1cm4gYy5jYWxsKHRoaXMsYixkLGwpfWZ1bmN0aW9uIGMoYSxkLGUpe2Zvcig7Oyl7aWYobnVsbD09YSlyZXR1cm4gbnVsbDthPWIuYShhLGQpO1xuaWYocihlKSlkPUYoZSksZT1JKGUpO2Vsc2UgcmV0dXJuIGF9fWEuaz0yO2EuZj1mdW5jdGlvbihhKXt2YXIgYj1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9RyhhKTtyZXR1cm4gYyhiLGQsYSl9O2EuZD1jO3JldHVybiBhfSgpLGI9ZnVuY3Rpb24oYixlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGI7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxiLGUpO2RlZmF1bHQ6cmV0dXJuIGMuZChiLGUsSihhcmd1bWVudHMsMikpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtiLms9MjtiLmY9Yy5mO2IuYj1mdW5jdGlvbihhKXtyZXR1cm4gYX07Yi5hPWE7Yi5kPWMuZDtyZXR1cm4gYn0oKTtmdW5jdGlvbiB1YyhhKXt2YXIgYj1cImZ1bmN0aW9uXCI9PW0oYSk7cmV0dXJuIGI/YjphP3IocihudWxsKT9udWxsOmEuWGIpPyEwOmEuQ2I/ITE6cyh5YSxhKTpzKHlhLGEpfVxuZnVuY3Rpb24gdmMoYSxiKXt0aGlzLmg9YTt0aGlzLmo9Yjt0aGlzLnE9MDt0aGlzLmk9MzkzMjE3fWc9dmMucHJvdG90eXBlO1xuZy5jYWxsPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbDtyZXR1cm4gYT1mdW5jdGlvbihhLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWixuYSxHYSxSYSx3Yyl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTp2YXIgej1hLHo9dGhpcztyZXR1cm4gei5oLm8/ei5oLm8oKTp6LmguY2FsbChudWxsKTtjYXNlIDI6cmV0dXJuIHo9YSx6PXRoaXMsei5oLmI/ei5oLmIoYyk6ei5oLmNhbGwobnVsbCxjKTtjYXNlIDM6cmV0dXJuIHo9YSx6PXRoaXMsei5oLmE/ei5oLmEoYyxkKTp6LmguY2FsbChudWxsLGMsZCk7Y2FzZSA0OnJldHVybiB6PWEsej10aGlzLHouaC5jP3ouaC5jKGMsZCxlKTp6LmguY2FsbChudWxsLGMsZCxlKTtjYXNlIDU6cmV0dXJuIHo9YSx6PXRoaXMsei5oLm4/ei5oLm4oYyxkLGUsZik6ei5oLmNhbGwobnVsbCxjLGQsZSxmKTtjYXNlIDY6cmV0dXJuIHo9YSx6PXRoaXMsei5oLnM/ei5oLnMoYyxkLGUsZixoKTp6LmguY2FsbChudWxsLGMsZCxlLGYsXG5oKTtjYXNlIDc6cmV0dXJuIHo9YSx6PXRoaXMsei5oLlg/ei5oLlgoYyxkLGUsZixoLGspOnouaC5jYWxsKG51bGwsYyxkLGUsZixoLGspO2Nhc2UgODpyZXR1cm4gej1hLHo9dGhpcyx6LmguZ2E/ei5oLmdhKGMsZCxlLGYsaCxrLGwpOnouaC5jYWxsKG51bGwsYyxkLGUsZixoLGssbCk7Y2FzZSA5OnJldHVybiB6PWEsej10aGlzLHouaC5HYT96LmguR2EoYyxkLGUsZixoLGssbCxuKTp6LmguY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbik7Y2FzZSAxMDpyZXR1cm4gej1hLHo9dGhpcyx6LmguSGE/ei5oLkhhKGMsZCxlLGYsaCxrLGwsbixxKTp6LmguY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxKTtjYXNlIDExOnJldHVybiB6PWEsej10aGlzLHouaC52YT96LmgudmEoYyxkLGUsZixoLGssbCxuLHEsdCk6ei5oLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4scSx0KTtjYXNlIDEyOnJldHVybiB6PWEsej10aGlzLHouaC53YT96Lmgud2EoYyxkLGUsZixoLGssbCxuLHEsdCx2KTpcbnouaC5jYWxsKG51bGwsYyxkLGUsZixoLGssbCxuLHEsdCx2KTtjYXNlIDEzOnJldHVybiB6PWEsej10aGlzLHouaC54YT96LmgueGEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcpOnouaC5jYWxsKG51bGwsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcpO2Nhc2UgMTQ6cmV0dXJuIHo9YSx6PXRoaXMsei5oLnlhP3ouaC55YShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5KTp6LmguY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHkpO2Nhc2UgMTU6cmV0dXJuIHo9YSx6PXRoaXMsei5oLnphP3ouaC56YShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIpOnouaC5jYWxsKG51bGwsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCKTtjYXNlIDE2OnJldHVybiB6PWEsej10aGlzLHouaC5BYT96LmguQWEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwpOnouaC5jYWxsKG51bGwsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwpO2Nhc2UgMTc6cmV0dXJuIHo9YSx6PXRoaXMsXG56LmguQmE/ei5oLkJhKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUpOnouaC5jYWxsKG51bGwsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSk7Y2FzZSAxODpyZXR1cm4gej1hLHo9dGhpcyx6LmguQ2E/ei5oLkNhKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWik6ei5oLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFopO2Nhc2UgMTk6cmV0dXJuIHo9YSx6PXRoaXMsei5oLkRhP3ouaC5EYShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFosbmEpOnouaC5jYWxsKG51bGwsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaLG5hKTtjYXNlIDIwOnJldHVybiB6PWEsej10aGlzLHouaC5FYT96LmguRWEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaLG5hLEdhKTp6LmguY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWixuYSxHYSk7Y2FzZSAyMTpyZXR1cm4gej1cbmEsej10aGlzLHouaC5GYT96LmguRmEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaLG5hLEdhLFJhKTp6LmguY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWixuYSxHYSxSYSk7Y2FzZSAyMjpyZXR1cm4gej1hLHo9dGhpcyxTLmJjP1MuYmMoei5oLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWixuYSxHYSxSYSx3Yyk6Uy5jYWxsKG51bGwsei5oLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWixuYSxHYSxSYSx3Yyl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9fSgpO2cuYXBwbHk9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5jYWxsLmFwcGx5KHRoaXMsW3RoaXNdLmNvbmNhdCh2YShiKSkpfTtnLm89ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5oLm8/dGhpcy5oLm8oKTp0aGlzLmguY2FsbChudWxsKX07XG5nLmI9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuaC5iP3RoaXMuaC5iKGEpOnRoaXMuaC5jYWxsKG51bGwsYSl9O2cuYT1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmguYT90aGlzLmguYShhLGIpOnRoaXMuaC5jYWxsKG51bGwsYSxiKX07Zy5jPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdGhpcy5oLmM/dGhpcy5oLmMoYSxiLGMpOnRoaXMuaC5jYWxsKG51bGwsYSxiLGMpfTtnLm49ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIHRoaXMuaC5uP3RoaXMuaC5uKGEsYixjLGQpOnRoaXMuaC5jYWxsKG51bGwsYSxiLGMsZCl9O2cucz1mdW5jdGlvbihhLGIsYyxkLGUpe3JldHVybiB0aGlzLmgucz90aGlzLmgucyhhLGIsYyxkLGUpOnRoaXMuaC5jYWxsKG51bGwsYSxiLGMsZCxlKX07Zy5YPWZ1bmN0aW9uKGEsYixjLGQsZSxmKXtyZXR1cm4gdGhpcy5oLlg/dGhpcy5oLlgoYSxiLGMsZCxlLGYpOnRoaXMuaC5jYWxsKG51bGwsYSxiLGMsZCxlLGYpfTtcbmcuZ2E9ZnVuY3Rpb24oYSxiLGMsZCxlLGYsaCl7cmV0dXJuIHRoaXMuaC5nYT90aGlzLmguZ2EoYSxiLGMsZCxlLGYsaCk6dGhpcy5oLmNhbGwobnVsbCxhLGIsYyxkLGUsZixoKX07Zy5HYT1mdW5jdGlvbihhLGIsYyxkLGUsZixoLGspe3JldHVybiB0aGlzLmguR2E/dGhpcy5oLkdhKGEsYixjLGQsZSxmLGgsayk6dGhpcy5oLmNhbGwobnVsbCxhLGIsYyxkLGUsZixoLGspfTtnLkhhPWZ1bmN0aW9uKGEsYixjLGQsZSxmLGgsayxsKXtyZXR1cm4gdGhpcy5oLkhhP3RoaXMuaC5IYShhLGIsYyxkLGUsZixoLGssbCk6dGhpcy5oLmNhbGwobnVsbCxhLGIsYyxkLGUsZixoLGssbCl9O2cudmE9ZnVuY3Rpb24oYSxiLGMsZCxlLGYsaCxrLGwsbil7cmV0dXJuIHRoaXMuaC52YT90aGlzLmgudmEoYSxiLGMsZCxlLGYsaCxrLGwsbik6dGhpcy5oLmNhbGwobnVsbCxhLGIsYyxkLGUsZixoLGssbCxuKX07XG5nLndhPWZ1bmN0aW9uKGEsYixjLGQsZSxmLGgsayxsLG4scSl7cmV0dXJuIHRoaXMuaC53YT90aGlzLmgud2EoYSxiLGMsZCxlLGYsaCxrLGwsbixxKTp0aGlzLmguY2FsbChudWxsLGEsYixjLGQsZSxmLGgsayxsLG4scSl9O2cueGE9ZnVuY3Rpb24oYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQpe3JldHVybiB0aGlzLmgueGE/dGhpcy5oLnhhKGEsYixjLGQsZSxmLGgsayxsLG4scSx0KTp0aGlzLmguY2FsbChudWxsLGEsYixjLGQsZSxmLGgsayxsLG4scSx0KX07Zy55YT1mdW5jdGlvbihhLGIsYyxkLGUsZixoLGssbCxuLHEsdCx2KXtyZXR1cm4gdGhpcy5oLnlhP3RoaXMuaC55YShhLGIsYyxkLGUsZixoLGssbCxuLHEsdCx2KTp0aGlzLmguY2FsbChudWxsLGEsYixjLGQsZSxmLGgsayxsLG4scSx0LHYpfTtcbmcuemE9ZnVuY3Rpb24oYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3KXtyZXR1cm4gdGhpcy5oLnphP3RoaXMuaC56YShhLGIsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcpOnRoaXMuaC5jYWxsKG51bGwsYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3KX07Zy5BYT1mdW5jdGlvbihhLGIsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSl7cmV0dXJuIHRoaXMuaC5BYT90aGlzLmguQWEoYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHkpOnRoaXMuaC5jYWxsKG51bGwsYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHkpfTtnLkJhPWZ1bmN0aW9uKGEsYixjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIpe3JldHVybiB0aGlzLmguQmE/dGhpcy5oLkJhKGEsYixjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIpOnRoaXMuaC5jYWxsKG51bGwsYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQil9O1xuZy5DYT1mdW5jdGlvbihhLGIsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwpe3JldHVybiB0aGlzLmguQ2E/dGhpcy5oLkNhKGEsYixjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCk6dGhpcy5oLmNhbGwobnVsbCxhLGIsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwpfTtnLkRhPWZ1bmN0aW9uKGEsYixjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVKXtyZXR1cm4gdGhpcy5oLkRhP3RoaXMuaC5EYShhLGIsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSk6dGhpcy5oLmNhbGwobnVsbCxhLGIsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSl9O1xuZy5FYT1mdW5jdGlvbihhLGIsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaKXtyZXR1cm4gdGhpcy5oLkVhP3RoaXMuaC5FYShhLGIsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaKTp0aGlzLmguY2FsbChudWxsLGEsYixjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFopfTtnLkZhPWZ1bmN0aW9uKGEsYixjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFosbmEpe3JldHVybiB0aGlzLmguRmE/dGhpcy5oLkZhKGEsYixjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFosbmEpOnRoaXMuaC5jYWxsKG51bGwsYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWixuYSl9O2cuWGI9ITA7Zy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyB2Yyh0aGlzLmgsYil9O2cuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmp9O1xuZnVuY3Rpb24gTihhLGIpe3JldHVybiB1YyhhKSYmIShhP2EuaSYyNjIxNDR8fGEub2N8fChhLmk/MDpzKGRiLGEpKTpzKGRiLGEpKT9uZXcgdmMoYSxiKTpudWxsPT1hP251bGw6ZWIoYSxiKX1mdW5jdGlvbiB4YyhhKXt2YXIgYj1udWxsIT1hO3JldHVybihiP2E/YS5pJjEzMTA3Mnx8YS5lY3x8KGEuaT8wOnMoYmIsYSkpOnMoYmIsYSk6Yik/Y2IoYSk6bnVsbH1mdW5jdGlvbiB5YyhhKXtyZXR1cm4gbnVsbD09YT9udWxsOlhhKGEpfWZ1bmN0aW9uIHpjKGEpe3JldHVybiBudWxsPT1hP251bGw6WWEoYSl9XG52YXIgQWM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7cmV0dXJuIG51bGw9PWE/bnVsbDpXYShhLGIpfXZhciBiPW51bGwsYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYixkLGspe3ZhciBsPW51bGw7Mjxhcmd1bWVudHMubGVuZ3RoJiYobD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKSwwKSk7cmV0dXJuIGMuY2FsbCh0aGlzLGIsZCxsKX1mdW5jdGlvbiBjKGEsZCxlKXtmb3IoOzspe2lmKG51bGw9PWEpcmV0dXJuIG51bGw7YT1iLmEoYSxkKTtpZihyKGUpKWQ9RihlKSxlPUkoZSk7ZWxzZSByZXR1cm4gYX19YS5rPTI7YS5mPWZ1bmN0aW9uKGEpe3ZhciBiPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1HKGEpO3JldHVybiBjKGIsZCxhKX07YS5kPWM7cmV0dXJuIGF9KCksYj1mdW5jdGlvbihiLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYjtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGIsZSk7ZGVmYXVsdDpyZXR1cm4gYy5kKGIsXG5lLEooYXJndW1lbnRzLDIpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yi5rPTI7Yi5mPWMuZjtiLmI9ZnVuY3Rpb24oYSl7cmV0dXJuIGF9O2IuYT1hO2IuZD1jLmQ7cmV0dXJuIGJ9KCk7ZnVuY3Rpb24gQmMoYSl7cmV0dXJuIG51bGw9PWF8fHNhKEUoYSkpfWZ1bmN0aW9uIENjKGEpe3JldHVybiBudWxsPT1hPyExOmE/YS5pJjh8fGEuQWM/ITA6YS5pPyExOnMoQ2EsYSk6cyhDYSxhKX1mdW5jdGlvbiBEYyhhKXtyZXR1cm4gbnVsbD09YT8hMTphP2EuaSY0MDk2fHxhLmpjPyEwOmEuaT8hMTpzKFZhLGEpOnMoVmEsYSl9ZnVuY3Rpb24gRWMoYSl7cmV0dXJuIGE/YS5pJjUxMnx8YS55Yz8hMDphLmk/ITE6cyhNYSxhKTpzKE1hLGEpfWZ1bmN0aW9uIEZjKGEpe3JldHVybiBhP2EuaSYxNjc3NzIxNnx8YS5pYz8hMDphLmk/ITE6cyhtYixhKTpzKG1iLGEpfVxuZnVuY3Rpb24gR2MoYSl7cmV0dXJuIG51bGw9PWE/ITE6YT9hLmkmMTAyNHx8YS5jYz8hMDphLmk/ITE6cyhQYSxhKTpzKFBhLGEpfWZ1bmN0aW9uIEhjKGEpe3JldHVybiBhP2EuaSYxNjM4NHx8YS5HYz8hMDphLmk/ITE6cyhaYSxhKTpzKFphLGEpfWZ1bmN0aW9uIEljKGEpe3JldHVybiBhP2EucSY1MTJ8fGEuemM/ITA6ITE6ITF9ZnVuY3Rpb24gSmMoYSl7dmFyIGI9W107ZGEoYSxmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oYixlKXtyZXR1cm4gYS5wdXNoKGUpfX0oYikpO3JldHVybiBifWZ1bmN0aW9uIEtjKGEsYixjLGQsZSl7Zm9yKDswIT09ZTspY1tkXT1hW2JdLGQrPTEsZS09MSxiKz0xfXZhciBMYz17fTtmdW5jdGlvbiBNYyhhKXtyZXR1cm4gbnVsbD09YT8hMTphP2EuaSY2NHx8YS5iYj8hMDphLmk/ITE6cyhGYSxhKTpzKEZhLGEpfWZ1bmN0aW9uIE5jKGEpe3JldHVybiByKGEpPyEwOiExfVxuZnVuY3Rpb24gT2MoYSxiKXtyZXR1cm4gUS5jKGEsYixMYyk9PT1MYz8hMTohMH1mdW5jdGlvbiBYYihhLGIpe2lmKGE9PT1iKXJldHVybiAwO2lmKG51bGw9PWEpcmV0dXJuLTE7aWYobnVsbD09YilyZXR1cm4gMTtpZih0YShhKT09PXRhKGIpKXJldHVybiBhJiYoYS5xJjIwNDh8fGEubGIpP2EubWIobnVsbCxiKTpnYShhLGIpO2lmKHUpdGhyb3cgRXJyb3IoXCJjb21wYXJlIG9uIG5vbi1uaWwgb2JqZWN0cyBvZiBkaWZmZXJlbnQgdHlwZXNcIik7cmV0dXJuIG51bGx9XG52YXIgUGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjLGgpe2Zvcig7Oyl7dmFyIGs9WGIoUC5hKGEsaCksUC5hKGIsaCkpO2lmKDA9PT1rJiZoKzE8YyloKz0xO2Vsc2UgcmV0dXJuIGt9fWZ1bmN0aW9uIGIoYSxiKXt2YXIgZj1PKGEpLGg9TyhiKTtyZXR1cm4gZjxoPy0xOmY+aD8xOnU/Yy5uKGEsYixmLDApOm51bGx9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSxmLGgpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGIuY2FsbCh0aGlzLGMsZSk7Y2FzZSA0OnJldHVybiBhLmNhbGwodGhpcyxjLGUsZixoKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5hPWI7Yy5uPWE7cmV0dXJuIGN9KCk7XG5mdW5jdGlvbiBRYyhhKXtyZXR1cm4gV2IuYShhLFhiKT9YYjpmdW5jdGlvbihiLGMpe3ZhciBkPWEuYT9hLmEoYixjKTphLmNhbGwobnVsbCxiLGMpO3JldHVyblwibnVtYmVyXCI9PT10eXBlb2YgZD9kOnIoZCk/LTE6cihhLmE/YS5hKGMsYik6YS5jYWxsKG51bGwsYyxiKSk/MTowfX1cbnZhciBTYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtpZihFKGIpKXt2YXIgYz1SYy5iP1JjLmIoYik6UmMuY2FsbChudWxsLGIpO2hhKGMsUWMoYSkpO3JldHVybiBFKGMpfXJldHVybiBIfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIGMuYShYYixhKX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBiLmNhbGwodGhpcyxjKTtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYj1iO2MuYT1hO3JldHVybiBjfSgpLFRjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyl7cmV0dXJuIFNjLmEoZnVuY3Rpb24oYyxmKXtyZXR1cm4gUWMoYikuY2FsbChudWxsLGEuYj9hLmIoYyk6YS5jYWxsKG51bGwsYyksYS5iP2EuYihmKTphLmNhbGwobnVsbCxmKSl9LGMpfWZ1bmN0aW9uIGIoYSxiKXtyZXR1cm4gYy5jKGEsWGIsYil9XG52YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGIuY2FsbCh0aGlzLGMsZSk7Y2FzZSAzOnJldHVybiBhLmNhbGwodGhpcyxjLGUsZil9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYT1iO2MuYz1hO3JldHVybiBjfSgpLG5jPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyl7Zm9yKGM9RShjKTs7KWlmKGMpe2I9YS5hP2EuYShiLEYoYykpOmEuY2FsbChudWxsLGIsRihjKSk7aWYoZmMoYikpcmV0dXJuIEsuYj9LLmIoYik6Sy5jYWxsKG51bGwsYik7Yz1JKGMpfWVsc2UgcmV0dXJuIGJ9ZnVuY3Rpb24gYihhLGIpe3ZhciBjPUUoYik7cmV0dXJuIGM/Qy5jP0MuYyhhLEYoYyksSShjKSk6Qy5jYWxsKG51bGwsYSxGKGMpLEkoYykpOmEubz9hLm8oKTphLmNhbGwobnVsbCl9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBiLmNhbGwodGhpcyxcbmMsZSk7Y2FzZSAzOnJldHVybiBhLmNhbGwodGhpcyxjLGUsZil9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYT1iO2MuYz1hO3JldHVybiBjfSgpLEM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjKXtyZXR1cm4gYyYmKGMuaSY1MjQyODh8fGMuTmIpP2MuTShudWxsLGEsYik6YyBpbnN0YW5jZW9mIEFycmF5P2hjLmMoYyxhLGIpOlwic3RyaW5nXCI9PT10eXBlb2YgYz9oYy5jKGMsYSxiKTpzKGZiLGMpP2diLmMoYyxhLGIpOnU/bmMuYyhhLGIsYyk6bnVsbH1mdW5jdGlvbiBiKGEsYil7cmV0dXJuIGImJihiLmkmNTI0Mjg4fHxiLk5iKT9iLk4obnVsbCxhKTpiIGluc3RhbmNlb2YgQXJyYXk/aGMuYShiLGEpOlwic3RyaW5nXCI9PT10eXBlb2YgYj9oYy5hKGIsYSk6cyhmYixiKT9nYi5hKGIsYSk6dT9uYy5hKGEsYik6bnVsbH12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGIuY2FsbCh0aGlzLFxuYyxlKTtjYXNlIDM6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSxmKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5hPWI7Yy5jPWE7cmV0dXJuIGN9KCksVWM9ZnVuY3Rpb24oKXt2YXIgYT1udWxsLGI9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGMsZixoKXt2YXIgaz1udWxsOzI8YXJndW1lbnRzLmxlbmd0aCYmKGs9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMiksMCkpO3JldHVybiBiLmNhbGwodGhpcyxjLGYsayl9ZnVuY3Rpb24gYihhLGMsZCl7Zm9yKDs7KWlmKGE+YylpZihJKGQpKWE9YyxjPUYoZCksZD1JKGQpO2Vsc2UgcmV0dXJuIGM+RihkKTtlbHNlIHJldHVybiExfWEuaz0yO2EuZj1mdW5jdGlvbihhKXt2YXIgYz1GKGEpO2E9SShhKTt2YXIgaD1GKGEpO2E9RyhhKTtyZXR1cm4gYihjLGgsYSl9O2EuZD1iO3JldHVybiBhfSgpLGE9ZnVuY3Rpb24oYSxkLGUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuITA7XG5jYXNlIDI6cmV0dXJuIGE+ZDtkZWZhdWx0OnJldHVybiBiLmQoYSxkLEooYXJndW1lbnRzLDIpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307YS5rPTI7YS5mPWIuZjthLmI9ZnVuY3Rpb24oKXtyZXR1cm4hMH07YS5hPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGE+Yn07YS5kPWIuZDtyZXR1cm4gYX0oKSxWYz1mdW5jdGlvbigpe3ZhciBhPW51bGwsYj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYyxmLGgpe3ZhciBrPW51bGw7Mjxhcmd1bWVudHMubGVuZ3RoJiYoaz1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGMsZixrKX1mdW5jdGlvbiBiKGEsYyxkKXtmb3IoOzspaWYoYT49YylpZihJKGQpKWE9YyxjPUYoZCksZD1JKGQpO2Vsc2UgcmV0dXJuIGM+PUYoZCk7ZWxzZSByZXR1cm4hMX1hLms9MjthLmY9ZnVuY3Rpb24oYSl7dmFyIGM9RihhKTthPUkoYSk7dmFyIGg9RihhKTtcbmE9RyhhKTtyZXR1cm4gYihjLGgsYSl9O2EuZD1iO3JldHVybiBhfSgpLGE9ZnVuY3Rpb24oYSxkLGUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuITA7Y2FzZSAyOnJldHVybiBhPj1kO2RlZmF1bHQ6cmV0dXJuIGIuZChhLGQsSihhcmd1bWVudHMsMikpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTthLms9MjthLmY9Yi5mO2EuYj1mdW5jdGlvbigpe3JldHVybiEwfTthLmE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYT49Yn07YS5kPWIuZDtyZXR1cm4gYX0oKTtmdW5jdGlvbiBXYyhhKXtyZXR1cm4gYS0xfVxudmFyIFhjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3JldHVybiBhPmI/YTpifXZhciBiPW51bGwsYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYixkLGspe3ZhciBsPW51bGw7Mjxhcmd1bWVudHMubGVuZ3RoJiYobD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKSwwKSk7cmV0dXJuIGMuY2FsbCh0aGlzLGIsZCxsKX1mdW5jdGlvbiBjKGEsZCxlKXtyZXR1cm4gQy5jKGIsYT5kP2E6ZCxlKX1hLms9MjthLmY9ZnVuY3Rpb24oYSl7dmFyIGI9RihhKTthPUkoYSk7dmFyIGQ9RihhKTthPUcoYSk7cmV0dXJuIGMoYixkLGEpfTthLmQ9YztyZXR1cm4gYX0oKSxiPWZ1bmN0aW9uKGIsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBiO2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsYixlKTtkZWZhdWx0OnJldHVybiBjLmQoYixlLEooYXJndW1lbnRzLDIpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO1xufTtiLms9MjtiLmY9Yy5mO2IuYj1mdW5jdGlvbihhKXtyZXR1cm4gYX07Yi5hPWE7Yi5kPWMuZDtyZXR1cm4gYn0oKTtmdW5jdGlvbiBZYyhhKXthPShhLWElMikvMjtyZXR1cm4gMDw9YT9NYXRoLmZsb29yLmI/TWF0aC5mbG9vci5iKGEpOk1hdGguZmxvb3IuY2FsbChudWxsLGEpOk1hdGguY2VpbC5iP01hdGguY2VpbC5iKGEpOk1hdGguY2VpbC5jYWxsKG51bGwsYSl9ZnVuY3Rpb24gWmMoYSl7YS09YT4+MSYxNDMxNjU1NzY1O2E9KGEmODU4OTkzNDU5KSsoYT4+MiY4NTg5OTM0NTkpO3JldHVybiAxNjg0MzAwOSooYSsoYT4+NCkmMjUyNjQ1MTM1KT4+MjR9ZnVuY3Rpb24gJGMoYSl7dmFyIGI9MTtmb3IoYT1FKGEpOzspaWYoYSYmMDxiKWItPTEsYT1JKGEpO2Vsc2UgcmV0dXJuIGF9XG52YXIgQT1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSl7cmV0dXJuIG51bGw9PWE/XCJcIjphLnRvU3RyaW5nKCl9dmFyIGI9bnVsbCxjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShiLGQpe3ZhciBrPW51bGw7MTxhcmd1bWVudHMubGVuZ3RoJiYoaz1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSwwKSk7cmV0dXJuIGMuY2FsbCh0aGlzLGIsayl9ZnVuY3Rpb24gYyhhLGQpe2Zvcih2YXIgZT1uZXcgZWEoYi5iKGEpKSxsPWQ7OylpZihyKGwpKWU9ZS5hcHBlbmQoYi5iKEYobCkpKSxsPUkobCk7ZWxzZSByZXR1cm4gZS50b1N0cmluZygpfWEuaz0xO2EuZj1mdW5jdGlvbihhKXt2YXIgYj1GKGEpO2E9RyhhKTtyZXR1cm4gYyhiLGEpfTthLmQ9YztyZXR1cm4gYX0oKSxiPWZ1bmN0aW9uKGIsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMDpyZXR1cm5cIlwiO2Nhc2UgMTpyZXR1cm4gYS5jYWxsKHRoaXMsYik7ZGVmYXVsdDpyZXR1cm4gYy5kKGIsSihhcmd1bWVudHMsXG4xKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Iuaz0xO2IuZj1jLmY7Yi5vPWZ1bmN0aW9uKCl7cmV0dXJuXCJcIn07Yi5iPWE7Yi5kPWMuZDtyZXR1cm4gYn0oKSxhZD1mdW5jdGlvbigpe3ZhciBhPW51bGwsYT1mdW5jdGlvbihhLGMsZCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gYS5zdWJzdHJpbmcoYyk7Y2FzZSAzOnJldHVybiBhLnN1YnN0cmluZyhjLGQpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTthLmE9ZnVuY3Rpb24oYSxjKXtyZXR1cm4gYS5zdWJzdHJpbmcoYyl9O2EuYz1mdW5jdGlvbihhLGMsZCl7cmV0dXJuIGEuc3Vic3RyaW5nKGMsZCl9O3JldHVybiBhfSgpO1xuZnVuY3Rpb24gbGMoYSxiKXtyZXR1cm4gTmMoRmMoYik/ZnVuY3Rpb24oKXtmb3IodmFyIGM9RShhKSxkPUUoYik7Oyl7aWYobnVsbD09YylyZXR1cm4gbnVsbD09ZDtpZihudWxsPT1kKXJldHVybiExO2lmKFdiLmEoRihjKSxGKGQpKSljPUkoYyksZD1JKGQpO2Vsc2UgcmV0dXJuIHU/ITE6bnVsbH19KCk6bnVsbCl9ZnVuY3Rpb24gYmQoYSxiLGMsZCxlKXt0aGlzLmo9YTt0aGlzLmZpcnN0PWI7dGhpcy50YT1jO3RoaXMuY291bnQ9ZDt0aGlzLm09ZTt0aGlzLmk9NjU5Mzc2NDY7dGhpcy5xPTgxOTJ9Zz1iZC5wcm90b3R5cGU7Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07Zy5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuan07Zy5VPWZ1bmN0aW9uKCl7cmV0dXJuIDE9PT10aGlzLmNvdW50P251bGw6dGhpcy50YX07Zy5MPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY291bnR9O2cuSWE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5maXJzdH07Zy5KYT1mdW5jdGlvbigpe3JldHVybiBJYSh0aGlzKX07XG5nLkI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm07cmV0dXJuIG51bGwhPWE/YTp0aGlzLm09YT1jYyh0aGlzKX07Zy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGxjKHRoaXMsYil9O2cuST1mdW5jdGlvbigpe3JldHVybiBIfTtnLk49ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmMuYShiLHRoaXMpfTtnLk09ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBuYy5jKGIsYyx0aGlzKX07Zy5RPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZmlyc3R9O2cuUz1mdW5jdGlvbigpe3JldHVybiAxPT09dGhpcy5jb3VudD9IOnRoaXMudGF9O2cuSD1mdW5jdGlvbigpe3JldHVybiB0aGlzfTtnLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IGJkKGIsdGhpcy5maXJzdCx0aGlzLnRhLHRoaXMuY291bnQsdGhpcy5tKX07Zy5HPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBiZCh0aGlzLmosYix0aGlzLHRoaXMuY291bnQrMSxudWxsKX07XG5mdW5jdGlvbiBjZChhKXt0aGlzLmo9YTt0aGlzLmk9NjU5Mzc2MTQ7dGhpcy5xPTgxOTJ9Zz1jZC5wcm90b3R5cGU7Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07Zy5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuan07Zy5VPWZ1bmN0aW9uKCl7cmV0dXJuIG51bGx9O2cuTD1mdW5jdGlvbigpe3JldHVybiAwfTtnLklhPWZ1bmN0aW9uKCl7cmV0dXJuIG51bGx9O2cuSmE9ZnVuY3Rpb24oKXt0aHJvdyBFcnJvcihcIkNhbid0IHBvcCBlbXB0eSBsaXN0XCIpO307Zy5CPWZ1bmN0aW9uKCl7cmV0dXJuIDB9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBsYyh0aGlzLGIpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc307Zy5OPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5jLmEoYix0aGlzKX07Zy5NPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gbmMuYyhiLGMsdGhpcyl9O2cuUT1mdW5jdGlvbigpe3JldHVybiBudWxsfTtnLlM9ZnVuY3Rpb24oKXtyZXR1cm4gSH07XG5nLkg9ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbH07Zy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBjZChiKX07Zy5HPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBiZCh0aGlzLmosYixudWxsLDEsbnVsbCl9O3ZhciBIPW5ldyBjZChudWxsKTtmdW5jdGlvbiBkZChhKXtyZXR1cm4gYT9hLmkmMTM0MjE3NzI4fHxhLkZjPyEwOmEuaT8hMTpzKG9iLGEpOnMob2IsYSl9ZnVuY3Rpb24gZWQoYSl7cmV0dXJuIGRkKGEpP3BiKGEpOkMuYyhwYyxILGEpfVxudmFyIGZkPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhKXt2YXIgZD1udWxsOzA8YXJndW1lbnRzLmxlbmd0aCYmKGQ9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCksMCkpO3JldHVybiBiLmNhbGwodGhpcyxkKX1mdW5jdGlvbiBiKGEpe3ZhciBiO2lmKGEgaW5zdGFuY2VvZiBhYyYmMD09PWEucCliPWEuZTtlbHNlIGE6e2ZvcihiPVtdOzspaWYobnVsbCE9YSliLnB1c2goYS5RKG51bGwpKSxhPWEuVShudWxsKTtlbHNlIGJyZWFrIGE7Yj12b2lkIDB9YT1iLmxlbmd0aDtmb3IodmFyIGU9SDs7KWlmKDA8YSl7dmFyIGY9YS0xLGU9ZS5HKG51bGwsYlthLTFdKTthPWZ9ZWxzZSByZXR1cm4gZX1hLms9MDthLmY9ZnVuY3Rpb24oYSl7YT1FKGEpO3JldHVybiBiKGEpfTthLmQ9YjtyZXR1cm4gYX0oKTtmdW5jdGlvbiBnZChhLGIsYyxkKXt0aGlzLmo9YTt0aGlzLmZpcnN0PWI7dGhpcy50YT1jO3RoaXMubT1kO3RoaXMuaT02NTkyOTQ1Mjt0aGlzLnE9ODE5Mn1cbmc9Z2QucHJvdG90eXBlO2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O2cuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmp9O2cuVT1mdW5jdGlvbigpe3JldHVybiBudWxsPT10aGlzLnRhP251bGw6RSh0aGlzLnRhKX07Zy5CPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tO3JldHVybiBudWxsIT1hP2E6dGhpcy5tPWE9Y2ModGhpcyl9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBsYyh0aGlzLGIpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gTihILHRoaXMuail9O2cuTj1mdW5jdGlvbihhLGIpe3JldHVybiBuYy5hKGIsdGhpcyl9O2cuTT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIG5jLmMoYixjLHRoaXMpfTtnLlE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5maXJzdH07Zy5TPWZ1bmN0aW9uKCl7cmV0dXJuIG51bGw9PXRoaXMudGE/SDp0aGlzLnRhfTtnLkg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc307XG5nLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IGdkKGIsdGhpcy5maXJzdCx0aGlzLnRhLHRoaXMubSl9O2cuRz1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgZ2QobnVsbCxiLHRoaXMsdGhpcy5tKX07ZnVuY3Rpb24gTShhLGIpe3ZhciBjPW51bGw9PWI7cmV0dXJuKGM/YzpiJiYoYi5pJjY0fHxiLmJiKSk/bmV3IGdkKG51bGwsYSxiLG51bGwpOm5ldyBnZChudWxsLGEsRShiKSxudWxsKX1mdW5jdGlvbiBUKGEsYixjLGQpe3RoaXMuZmE9YTt0aGlzLm5hbWU9Yjt0aGlzLnNhPWM7dGhpcy5VYT1kO3RoaXMuaT0yMTUzNzc1MTA1O3RoaXMucT00MDk2fWc9VC5wcm90b3R5cGU7Zy53PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHViKGIsXCI6XCIrQS5iKHRoaXMuc2EpKX07Zy5CPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5VYTtyZXR1cm4gbnVsbCE9YT9hOnRoaXMuVWE9YT1VYih0aGlzKSsyNjU0NDM1NzY5fTtcbmcuY2FsbD1mdW5jdGlvbigpe3ZhciBhPW51bGw7cmV0dXJuIGE9ZnVuY3Rpb24oYSxjLGQpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIFEuYShjLHRoaXMpO2Nhc2UgMzpyZXR1cm4gUS5jKGMsdGhpcyxkKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO319KCk7Zy5hcHBseT1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmNhbGwuYXBwbHkodGhpcyxbdGhpc10uY29uY2F0KHZhKGIpKSl9O2cuYj1mdW5jdGlvbihhKXtyZXR1cm4gUS5hKGEsdGhpcyl9O2cuYT1mdW5jdGlvbihhLGIpe3JldHVybiBRLmMoYSx0aGlzLGIpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYiBpbnN0YW5jZW9mIFQ/dGhpcy5zYT09PWIuc2E6ITF9O2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm5cIjpcIitBLmIodGhpcy5zYSl9O1xuZnVuY3Rpb24gaGQoYSxiKXtyZXR1cm4gYT09PWI/ITA6YSBpbnN0YW5jZW9mIFQmJmIgaW5zdGFuY2VvZiBUP2Euc2E9PT1iLnNhOiExfVxudmFyIGpkPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3JldHVybiBuZXcgVChhLGIsXCJcIitBLmIocihhKT9cIlwiK0EuYihhKStcIi9cIjpudWxsKStBLmIoYiksbnVsbCl9ZnVuY3Rpb24gYihhKXtpZihhIGluc3RhbmNlb2YgVClyZXR1cm4gYTtpZihhIGluc3RhbmNlb2YgWmIpe3ZhciBiO2lmKGEmJihhLnEmNDA5Nnx8YS5mYykpYj1hLmZhO2Vsc2UgdGhyb3cgRXJyb3IoXCJEb2Vzbid0IHN1cHBvcnQgbmFtZXNwYWNlOiBcIitBLmIoYSkpO3JldHVybiBuZXcgVChiLGlkLmI/aWQuYihhKTppZC5jYWxsKG51bGwsYSksYS5OYSxudWxsKX1yZXR1cm5cInN0cmluZ1wiPT09dHlwZW9mIGE/KGI9YS5zcGxpdChcIi9cIiksMj09PWIubGVuZ3RoP25ldyBUKGJbMF0sYlsxXSxhLG51bGwpOm5ldyBUKG51bGwsYlswXSxhLG51bGwpKTpudWxsfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGIuY2FsbCh0aGlzLGMpO2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsXG5jLGUpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmI9YjtjLmE9YTtyZXR1cm4gY30oKTtmdW5jdGlvbiBWKGEsYixjLGQpe3RoaXMuaj1hO3RoaXMuWWE9Yjt0aGlzLnI9Yzt0aGlzLm09ZDt0aGlzLnE9MDt0aGlzLmk9MzIzNzQ5ODh9Zz1WLnByb3RvdHlwZTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIExiKHRoaXMpfTtmdW5jdGlvbiBrZChhKXtudWxsIT1hLllhJiYoYS5yPWEuWWEubz9hLllhLm8oKTphLllhLmNhbGwobnVsbCksYS5ZYT1udWxsKTtyZXR1cm4gYS5yfWcuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmp9O2cuVT1mdW5jdGlvbigpe2xiKHRoaXMpO3JldHVybiBudWxsPT10aGlzLnI/bnVsbDpJKHRoaXMucil9O2cuQj1mdW5jdGlvbigpe3ZhciBhPXRoaXMubTtyZXR1cm4gbnVsbCE9YT9hOnRoaXMubT1hPWNjKHRoaXMpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbGModGhpcyxiKX07XG5nLkk9ZnVuY3Rpb24oKXtyZXR1cm4gTihILHRoaXMuail9O2cuTj1mdW5jdGlvbihhLGIpe3JldHVybiBuYy5hKGIsdGhpcyl9O2cuTT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIG5jLmMoYixjLHRoaXMpfTtnLlE9ZnVuY3Rpb24oKXtsYih0aGlzKTtyZXR1cm4gbnVsbD09dGhpcy5yP251bGw6Rih0aGlzLnIpfTtnLlM9ZnVuY3Rpb24oKXtsYih0aGlzKTtyZXR1cm4gbnVsbCE9dGhpcy5yP0codGhpcy5yKTpIfTtnLkg9ZnVuY3Rpb24oKXtrZCh0aGlzKTtpZihudWxsPT10aGlzLnIpcmV0dXJuIG51bGw7Zm9yKHZhciBhPXRoaXMucjs7KWlmKGEgaW5zdGFuY2VvZiBWKWE9a2QoYSk7ZWxzZSByZXR1cm4gdGhpcy5yPWEsRSh0aGlzLnIpfTtnLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IFYoYix0aGlzLllhLHRoaXMucix0aGlzLm0pfTtnLkc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTShiLHRoaXMpfTtcbmZ1bmN0aW9uIGxkKGEsYil7dGhpcy5xYj1hO3RoaXMuZW5kPWI7dGhpcy5xPTA7dGhpcy5pPTJ9bGQucHJvdG90eXBlLkw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lbmR9O2xkLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oYSl7dGhpcy5xYlt0aGlzLmVuZF09YTtyZXR1cm4gdGhpcy5lbmQrPTF9O2xkLnByb3RvdHlwZS5kYT1mdW5jdGlvbigpe3ZhciBhPW5ldyBtZCh0aGlzLnFiLDAsdGhpcy5lbmQpO3RoaXMucWI9bnVsbDtyZXR1cm4gYX07ZnVuY3Rpb24gbWQoYSxiLGMpe3RoaXMuZT1hO3RoaXMuTz1iO3RoaXMuZW5kPWM7dGhpcy5xPTA7dGhpcy5pPTUyNDMwNn1nPW1kLnByb3RvdHlwZTtnLk49ZnVuY3Rpb24oYSxiKXtyZXR1cm4gaGMubih0aGlzLmUsYix0aGlzLmVbdGhpcy5PXSx0aGlzLk8rMSl9O2cuTT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIGhjLm4odGhpcy5lLGIsYyx0aGlzLk8pfTtcbmcuS2I9ZnVuY3Rpb24oKXtpZih0aGlzLk89PT10aGlzLmVuZCl0aHJvdyBFcnJvcihcIi1kcm9wLWZpcnN0IG9mIGVtcHR5IGNodW5rXCIpO3JldHVybiBuZXcgbWQodGhpcy5lLHRoaXMuTysxLHRoaXMuZW5kKX07Zy5KPWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuZVt0aGlzLk8rYl19O2cuYWE9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiAwPD1iJiZiPHRoaXMuZW5kLXRoaXMuTz90aGlzLmVbdGhpcy5PK2JdOmN9O2cuTD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVuZC10aGlzLk99O1xudmFyIG5kPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyl7cmV0dXJuIG5ldyBtZChhLGIsYyl9ZnVuY3Rpb24gYihhLGIpe3JldHVybiBuZXcgbWQoYSxiLGEubGVuZ3RoKX1mdW5jdGlvbiBjKGEpe3JldHVybiBuZXcgbWQoYSwwLGEubGVuZ3RoKX12YXIgZD1udWxsLGQ9ZnVuY3Rpb24oZCxmLGgpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGMuY2FsbCh0aGlzLGQpO2Nhc2UgMjpyZXR1cm4gYi5jYWxsKHRoaXMsZCxmKTtjYXNlIDM6cmV0dXJuIGEuY2FsbCh0aGlzLGQsZixoKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307ZC5iPWM7ZC5hPWI7ZC5jPWE7cmV0dXJuIGR9KCk7ZnVuY3Rpb24gb2QoYSxiLGMsZCl7dGhpcy5kYT1hO3RoaXMub2E9Yjt0aGlzLmo9Yzt0aGlzLm09ZDt0aGlzLmk9MzE4NTA3MzI7dGhpcy5xPTE1MzZ9Zz1vZC5wcm90b3R5cGU7Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07XG5nLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5qfTtnLlU9ZnVuY3Rpb24oKXtpZigxPEFhKHRoaXMuZGEpKXJldHVybiBuZXcgb2QoR2IodGhpcy5kYSksdGhpcy5vYSx0aGlzLmosbnVsbCk7dmFyIGE9bGIodGhpcy5vYSk7cmV0dXJuIG51bGw9PWE/bnVsbDphfTtnLkI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm07cmV0dXJuIG51bGwhPWE/YTp0aGlzLm09YT1jYyh0aGlzKX07Zy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGxjKHRoaXMsYil9O2cuST1mdW5jdGlvbigpe3JldHVybiBOKEgsdGhpcy5qKX07Zy5RPWZ1bmN0aW9uKCl7cmV0dXJuIEQuYSh0aGlzLmRhLDApfTtnLlM9ZnVuY3Rpb24oKXtyZXR1cm4gMTxBYSh0aGlzLmRhKT9uZXcgb2QoR2IodGhpcy5kYSksdGhpcy5vYSx0aGlzLmosbnVsbCk6bnVsbD09dGhpcy5vYT9IOnRoaXMub2F9O2cuSD1mdW5jdGlvbigpe3JldHVybiB0aGlzfTtnLnNiPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGF9O1xuZy50Yj1mdW5jdGlvbigpe3JldHVybiBudWxsPT10aGlzLm9hP0g6dGhpcy5vYX07Zy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBvZCh0aGlzLmRhLHRoaXMub2EsYix0aGlzLm0pfTtnLkc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTShiLHRoaXMpfTtnLnJiPWZ1bmN0aW9uKCl7cmV0dXJuIG51bGw9PXRoaXMub2E/bnVsbDp0aGlzLm9hfTtmdW5jdGlvbiBwZChhLGIpe3JldHVybiAwPT09QWEoYSk/YjpuZXcgb2QoYSxiLG51bGwsbnVsbCl9ZnVuY3Rpb24gUmMoYSl7Zm9yKHZhciBiPVtdOzspaWYoRShhKSliLnB1c2goRihhKSksYT1JKGEpO2Vsc2UgcmV0dXJuIGJ9ZnVuY3Rpb24gcWQoYSxiKXtpZihpYyhhKSlyZXR1cm4gTyhhKTtmb3IodmFyIGM9YSxkPWIsZT0wOzspaWYoMDxkJiZFKGMpKWM9SShjKSxkLT0xLGUrPTE7ZWxzZSByZXR1cm4gZX1cbnZhciBzZD1mdW5jdGlvbiByZChiKXtyZXR1cm4gbnVsbD09Yj9udWxsOm51bGw9PUkoYik/RShGKGIpKTp1P00oRihiKSxyZChJKGIpKSk6bnVsbH0sdGQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7cmV0dXJuIG5ldyBWKG51bGwsZnVuY3Rpb24oKXt2YXIgYz1FKGEpO3JldHVybiBjP0ljKGMpP3BkKEhiKGMpLGQuYShJYihjKSxiKSk6TShGKGMpLGQuYShHKGMpLGIpKTpifSxudWxsLG51bGwpfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIG5ldyBWKG51bGwsZnVuY3Rpb24oKXtyZXR1cm4gYX0sbnVsbCxudWxsKX1mdW5jdGlvbiBjKCl7cmV0dXJuIG5ldyBWKG51bGwsZnVuY3Rpb24oKXtyZXR1cm4gbnVsbH0sbnVsbCxudWxsKX12YXIgZD1udWxsLGU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGMsZCxlKXt2YXIgZj1udWxsOzI8YXJndW1lbnRzLmxlbmd0aCYmKGY9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMiksMCkpO3JldHVybiBiLmNhbGwodGhpcyxjLFxuZCxmKX1mdW5jdGlvbiBiKGEsYyxlKXtyZXR1cm4gZnVuY3Rpb24gdChhLGIpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7dmFyIGM9RShhKTtyZXR1cm4gYz9JYyhjKT9wZChIYihjKSx0KEliKGMpLGIpKTpNKEYoYyksdChHKGMpLGIpKTpyKGIpP3QoRihiKSxJKGIpKTpudWxsfSxudWxsLG51bGwpfShkLmEoYSxjKSxlKX1hLms9MjthLmY9ZnVuY3Rpb24oYSl7dmFyIGM9RihhKTthPUkoYSk7dmFyIGQ9RihhKTthPUcoYSk7cmV0dXJuIGIoYyxkLGEpfTthLmQ9YjtyZXR1cm4gYX0oKSxkPWZ1bmN0aW9uKGQsaCxrKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAwOnJldHVybiBjLmNhbGwodGhpcyk7Y2FzZSAxOnJldHVybiBiLmNhbGwodGhpcyxkKTtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGQsaCk7ZGVmYXVsdDpyZXR1cm4gZS5kKGQsaCxKKGFyZ3VtZW50cywyKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Quaz1cbjI7ZC5mPWUuZjtkLm89YztkLmI9YjtkLmE9YTtkLmQ9ZS5kO3JldHVybiBkfSgpLHVkPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyxkKXtyZXR1cm4gTShhLE0oYixNKGMsZCkpKX1mdW5jdGlvbiBiKGEsYixjKXtyZXR1cm4gTShhLE0oYixjKSl9dmFyIGM9bnVsbCxkPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShjLGQsZSxuLHEpe3ZhciB0PW51bGw7NDxhcmd1bWVudHMubGVuZ3RoJiYodD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyw0KSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGMsZCxlLG4sdCl9ZnVuY3Rpb24gYihhLGMsZCxlLGYpe3JldHVybiBNKGEsTShjLE0oZCxNKGUsc2QoZikpKSkpfWEuaz00O2EuZj1mdW5jdGlvbihhKXt2YXIgYz1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9SShhKTt2YXIgZT1GKGEpO2E9SShhKTt2YXIgcT1GKGEpO2E9RyhhKTtyZXR1cm4gYihjLGQsZSxxLGEpfTthLmQ9YjtyZXR1cm4gYX0oKSxjPWZ1bmN0aW9uKGMsZixcbmgsayxsKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBFKGMpO2Nhc2UgMjpyZXR1cm4gTShjLGYpO2Nhc2UgMzpyZXR1cm4gYi5jYWxsKHRoaXMsYyxmLGgpO2Nhc2UgNDpyZXR1cm4gYS5jYWxsKHRoaXMsYyxmLGgsayk7ZGVmYXVsdDpyZXR1cm4gZC5kKGMsZixoLGssSihhcmd1bWVudHMsNCkpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLms9NDtjLmY9ZC5mO2MuYj1mdW5jdGlvbihhKXtyZXR1cm4gRShhKX07Yy5hPWZ1bmN0aW9uKGEsYil7cmV0dXJuIE0oYSxiKX07Yy5jPWI7Yy5uPWE7Yy5kPWQuZDtyZXR1cm4gY30oKTtmdW5jdGlvbiB2ZChhKXtyZXR1cm4gQWIoYSl9XG52YXIgd2Q9ZnVuY3Rpb24oKXt2YXIgYT1udWxsLGI9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGMsZixoKXt2YXIgaz1udWxsOzI8YXJndW1lbnRzLmxlbmd0aCYmKGs9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMiksMCkpO3JldHVybiBiLmNhbGwodGhpcyxjLGYsayl9ZnVuY3Rpb24gYihhLGMsZCl7Zm9yKDs7KWlmKGE9emIoYSxjKSxyKGQpKWM9RihkKSxkPUkoZCk7ZWxzZSByZXR1cm4gYX1hLms9MjthLmY9ZnVuY3Rpb24oYSl7dmFyIGM9RihhKTthPUkoYSk7dmFyIGg9RihhKTthPUcoYSk7cmV0dXJuIGIoYyxoLGEpfTthLmQ9YjtyZXR1cm4gYX0oKSxhPWZ1bmN0aW9uKGEsZCxlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiB6YihhLGQpO2RlZmF1bHQ6cmV0dXJuIGIuZChhLGQsSihhcmd1bWVudHMsMikpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTthLms9MjthLmY9Yi5mO2EuYT1cbmZ1bmN0aW9uKGEsYil7cmV0dXJuIHpiKGEsYil9O2EuZD1iLmQ7cmV0dXJuIGF9KCkseGQ9ZnVuY3Rpb24oKXt2YXIgYT1udWxsLGI9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGMsZixoLGspe3ZhciBsPW51bGw7Mzxhcmd1bWVudHMubGVuZ3RoJiYobD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywzKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGMsZixoLGwpfWZ1bmN0aW9uIGIoYSxjLGQsayl7Zm9yKDs7KWlmKGE9QmIoYSxjLGQpLHIoaykpYz1GKGspLGQ9RihJKGspKSxrPUkoSShrKSk7ZWxzZSByZXR1cm4gYX1hLms9MzthLmY9ZnVuY3Rpb24oYSl7dmFyIGM9RihhKTthPUkoYSk7dmFyIGg9RihhKTthPUkoYSk7dmFyIGs9RihhKTthPUcoYSk7cmV0dXJuIGIoYyxoLGssYSl9O2EuZD1iO3JldHVybiBhfSgpLGE9ZnVuY3Rpb24oYSxkLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMzpyZXR1cm4gQmIoYSxkLGUpO2RlZmF1bHQ6cmV0dXJuIGIuZChhLFxuZCxlLEooYXJndW1lbnRzLDMpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307YS5rPTM7YS5mPWIuZjthLmM9ZnVuY3Rpb24oYSxiLGUpe3JldHVybiBCYihhLGIsZSl9O2EuZD1iLmQ7cmV0dXJuIGF9KCkseWQ9ZnVuY3Rpb24oKXt2YXIgYT1udWxsLGI9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGMsZixoKXt2YXIgaz1udWxsOzI8YXJndW1lbnRzLmxlbmd0aCYmKGs9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMiksMCkpO3JldHVybiBiLmNhbGwodGhpcyxjLGYsayl9ZnVuY3Rpb24gYihhLGMsZCl7Zm9yKDs7KWlmKGE9Q2IoYSxjKSxyKGQpKWM9RihkKSxkPUkoZCk7ZWxzZSByZXR1cm4gYX1hLms9MjthLmY9ZnVuY3Rpb24oYSl7dmFyIGM9RihhKTthPUkoYSk7dmFyIGg9RihhKTthPUcoYSk7cmV0dXJuIGIoYyxoLGEpfTthLmQ9YjtyZXR1cm4gYX0oKSxhPWZ1bmN0aW9uKGEsZCxlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBDYihhLFxuZCk7ZGVmYXVsdDpyZXR1cm4gYi5kKGEsZCxKKGFyZ3VtZW50cywyKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Euaz0yO2EuZj1iLmY7YS5hPWZ1bmN0aW9uKGEsYil7cmV0dXJuIENiKGEsYil9O2EuZD1iLmQ7cmV0dXJuIGF9KCksemQ9ZnVuY3Rpb24oKXt2YXIgYT1udWxsLGI9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGMsZixoKXt2YXIgaz1udWxsOzI8YXJndW1lbnRzLmxlbmd0aCYmKGs9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMiksMCkpO3JldHVybiBiLmNhbGwodGhpcyxjLGYsayl9ZnVuY3Rpb24gYihhLGMsZCl7Zm9yKDs7KWlmKGE9RmIoYSxjKSxyKGQpKWM9RihkKSxkPUkoZCk7ZWxzZSByZXR1cm4gYX1hLms9MjthLmY9ZnVuY3Rpb24oYSl7dmFyIGM9RihhKTthPUkoYSk7dmFyIGg9RihhKTthPUcoYSk7cmV0dXJuIGIoYyxoLGEpfTthLmQ9YjtyZXR1cm4gYX0oKSxhPWZ1bmN0aW9uKGEsZCxcbmUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIEZiKGEsZCk7ZGVmYXVsdDpyZXR1cm4gYi5kKGEsZCxKKGFyZ3VtZW50cywyKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Euaz0yO2EuZj1iLmY7YS5hPWZ1bmN0aW9uKGEsYil7cmV0dXJuIEZiKGEsYil9O2EuZD1iLmQ7cmV0dXJuIGF9KCk7XG5mdW5jdGlvbiBBZChhLGIsYyl7dmFyIGQ9RShjKTtpZigwPT09YilyZXR1cm4gYS5vP2EubygpOmEuY2FsbChudWxsKTtjPUhhKGQpO3ZhciBlPUlhKGQpO2lmKDE9PT1iKXJldHVybiBhLmI/YS5iKGMpOmEuYj9hLmIoYyk6YS5jYWxsKG51bGwsYyk7dmFyIGQ9SGEoZSksZj1JYShlKTtpZigyPT09YilyZXR1cm4gYS5hP2EuYShjLGQpOmEuYT9hLmEoYyxkKTphLmNhbGwobnVsbCxjLGQpO3ZhciBlPUhhKGYpLGg9SWEoZik7aWYoMz09PWIpcmV0dXJuIGEuYz9hLmMoYyxkLGUpOmEuYz9hLmMoYyxkLGUpOmEuY2FsbChudWxsLGMsZCxlKTt2YXIgZj1IYShoKSxrPUlhKGgpO2lmKDQ9PT1iKXJldHVybiBhLm4/YS5uKGMsZCxlLGYpOmEubj9hLm4oYyxkLGUsZik6YS5jYWxsKG51bGwsYyxkLGUsZik7dmFyIGg9SGEoayksbD1JYShrKTtpZig1PT09YilyZXR1cm4gYS5zP2EucyhjLGQsZSxmLGgpOmEucz9hLnMoYyxkLGUsZixoKTphLmNhbGwobnVsbCxjLGQsZSxmLGgpO3ZhciBrPUhhKGwpLFxubj1JYShsKTtpZig2PT09YilyZXR1cm4gYS5YP2EuWChjLGQsZSxmLGgsayk6YS5YP2EuWChjLGQsZSxmLGgsayk6YS5jYWxsKG51bGwsYyxkLGUsZixoLGspO3ZhciBsPUhhKG4pLHE9SWEobik7aWYoNz09PWIpcmV0dXJuIGEuZ2E/YS5nYShjLGQsZSxmLGgsayxsKTphLmdhP2EuZ2EoYyxkLGUsZixoLGssbCk6YS5jYWxsKG51bGwsYyxkLGUsZixoLGssbCk7dmFyIG49SGEocSksdD1JYShxKTtpZig4PT09YilyZXR1cm4gYS5HYT9hLkdhKGMsZCxlLGYsaCxrLGwsbik6YS5HYT9hLkdhKGMsZCxlLGYsaCxrLGwsbik6YS5jYWxsKG51bGwsYyxkLGUsZixoLGssbCxuKTt2YXIgcT1IYSh0KSx2PUlhKHQpO2lmKDk9PT1iKXJldHVybiBhLkhhP2EuSGEoYyxkLGUsZixoLGssbCxuLHEpOmEuSGE/YS5IYShjLGQsZSxmLGgsayxsLG4scSk6YS5jYWxsKG51bGwsYyxkLGUsZixoLGssbCxuLHEpO3ZhciB0PUhhKHYpLHc9SWEodik7aWYoMTA9PT1iKXJldHVybiBhLnZhP2EudmEoYyxkLGUsXG5mLGgsayxsLG4scSx0KTphLnZhP2EudmEoYyxkLGUsZixoLGssbCxuLHEsdCk6YS5jYWxsKG51bGwsYyxkLGUsZixoLGssbCxuLHEsdCk7dmFyIHY9SGEodykseT1JYSh3KTtpZigxMT09PWIpcmV0dXJuIGEud2E/YS53YShjLGQsZSxmLGgsayxsLG4scSx0LHYpOmEud2E/YS53YShjLGQsZSxmLGgsayxsLG4scSx0LHYpOmEuY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxLHQsdik7dmFyIHc9SGEoeSksQj1JYSh5KTtpZigxMj09PWIpcmV0dXJuIGEueGE/YS54YShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyk6YS54YT9hLnhhKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3KTphLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4scSx0LHYsdyk7dmFyIHk9SGEoQiksTD1JYShCKTtpZigxMz09PWIpcmV0dXJuIGEueWE/YS55YShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5KTphLnlhP2EueWEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSk6YS5jYWxsKG51bGwsYyxkLGUsZixoLGssbCxuLHEsXG50LHYsdyx5KTt2YXIgQj1IYShMKSxVPUlhKEwpO2lmKDE0PT09YilyZXR1cm4gYS56YT9hLnphKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQik6YS56YT9hLnphKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQik6YS5jYWxsKG51bGwsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCKTt2YXIgTD1IYShVKSxaPUlhKFUpO2lmKDE1PT09YilyZXR1cm4gYS5BYT9hLkFhKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMKTphLkFhP2EuQWEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwpOmEuY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMKTt2YXIgVT1IYShaKSxuYT1JYShaKTtpZigxNj09PWIpcmV0dXJuIGEuQmE/YS5CYShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVKTphLkJhP2EuQmEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSk6YS5jYWxsKG51bGwsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSk7dmFyIFo9XG5IYShuYSksR2E9SWEobmEpO2lmKDE3PT09YilyZXR1cm4gYS5DYT9hLkNhKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWik6YS5DYT9hLkNhKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWik6YS5jYWxsKG51bGwsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaKTt2YXIgbmE9SGEoR2EpLFJhPUlhKEdhKTtpZigxOD09PWIpcmV0dXJuIGEuRGE/YS5EYShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFosbmEpOmEuRGE/YS5EYShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFosbmEpOmEuY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWixuYSk7R2E9SGEoUmEpO1JhPUlhKFJhKTtpZigxOT09PWIpcmV0dXJuIGEuRWE/YS5FYShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFosbmEsR2EpOmEuRWE/YS5FYShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFosbmEsR2EpOmEuY2FsbChudWxsLFxuYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaLG5hLEdhKTt2YXIgd2M9SGEoUmEpO0lhKFJhKTtpZigyMD09PWIpcmV0dXJuIGEuRmE/YS5GYShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFosbmEsR2Esd2MpOmEuRmE/YS5GYShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFosbmEsR2Esd2MpOmEuY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWixuYSxHYSx3Yyk7dGhyb3cgRXJyb3IoXCJPbmx5IHVwIHRvIDIwIGFyZ3VtZW50cyBzdXBwb3J0ZWQgb24gZnVuY3Rpb25zXCIpO31cbnZhciBTPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyxkLGUpe2I9dWQubihiLGMsZCxlKTtjPWEuaztyZXR1cm4gYS5mPyhkPXFkKGIsYysxKSxkPD1jP0FkKGEsZCxiKTphLmYoYikpOmEuYXBwbHkoYSxSYyhiKSl9ZnVuY3Rpb24gYihhLGIsYyxkKXtiPXVkLmMoYixjLGQpO2M9YS5rO3JldHVybiBhLmY/KGQ9cWQoYixjKzEpLGQ8PWM/QWQoYSxkLGIpOmEuZihiKSk6YS5hcHBseShhLFJjKGIpKX1mdW5jdGlvbiBjKGEsYixjKXtiPXVkLmEoYixjKTtjPWEuaztpZihhLmYpe3ZhciBkPXFkKGIsYysxKTtyZXR1cm4gZDw9Yz9BZChhLGQsYik6YS5mKGIpfXJldHVybiBhLmFwcGx5KGEsUmMoYikpfWZ1bmN0aW9uIGQoYSxiKXt2YXIgYz1hLms7aWYoYS5mKXt2YXIgZD1xZChiLGMrMSk7cmV0dXJuIGQ8PWM/QWQoYSxkLGIpOmEuZihiKX1yZXR1cm4gYS5hcHBseShhLFJjKGIpKX12YXIgZT1udWxsLGY9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGMsZCxlLGYsaCx3KXt2YXIgeT1udWxsO1xuNTxhcmd1bWVudHMubGVuZ3RoJiYoeT1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyw1KSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGMsZCxlLGYsaCx5KX1mdW5jdGlvbiBiKGEsYyxkLGUsZixoKXtjPU0oYyxNKGQsTShlLE0oZixzZChoKSkpKSk7ZD1hLms7cmV0dXJuIGEuZj8oZT1xZChjLGQrMSksZTw9ZD9BZChhLGUsYyk6YS5mKGMpKTphLmFwcGx5KGEsUmMoYykpfWEuaz01O2EuZj1mdW5jdGlvbihhKXt2YXIgYz1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9SShhKTt2YXIgZT1GKGEpO2E9SShhKTt2YXIgZj1GKGEpO2E9SShhKTt2YXIgaD1GKGEpO2E9RyhhKTtyZXR1cm4gYihjLGQsZSxmLGgsYSl9O2EuZD1iO3JldHVybiBhfSgpLGU9ZnVuY3Rpb24oZSxrLGwsbixxLHQpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGQuY2FsbCh0aGlzLGUsayk7Y2FzZSAzOnJldHVybiBjLmNhbGwodGhpcyxlLGssbCk7Y2FzZSA0OnJldHVybiBiLmNhbGwodGhpcyxcbmUsayxsLG4pO2Nhc2UgNTpyZXR1cm4gYS5jYWxsKHRoaXMsZSxrLGwsbixxKTtkZWZhdWx0OnJldHVybiBmLmQoZSxrLGwsbixxLEooYXJndW1lbnRzLDUpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307ZS5rPTU7ZS5mPWYuZjtlLmE9ZDtlLmM9YztlLm49YjtlLnM9YTtlLmQ9Zi5kO3JldHVybiBlfSgpLEJkPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3JldHVybiFXYi5hKGEsYil9dmFyIGI9bnVsbCxjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShjLGQsayl7dmFyIGw9bnVsbDsyPGFyZ3VtZW50cy5sZW5ndGgmJihsPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYyxkLGwpfWZ1bmN0aW9uIGIoYSxjLGQpe3JldHVybiBzYShTLm4oV2IsYSxjLGQpKX1hLms9MjthLmY9ZnVuY3Rpb24oYSl7dmFyIGM9RihhKTthPUkoYSk7dmFyIGQ9RihhKTthPUcoYSk7cmV0dXJuIGIoYyxcbmQsYSl9O2EuZD1iO3JldHVybiBhfSgpLGI9ZnVuY3Rpb24oYixlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuITE7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxiLGUpO2RlZmF1bHQ6cmV0dXJuIGMuZChiLGUsSihhcmd1bWVudHMsMikpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtiLms9MjtiLmY9Yy5mO2IuYj1mdW5jdGlvbigpe3JldHVybiExfTtiLmE9YTtiLmQ9Yy5kO3JldHVybiBifSgpO2Z1bmN0aW9uIENkKGEpe3JldHVybiBFKGEpP2E6bnVsbH1mdW5jdGlvbiBEZChhLGIpe2Zvcig7Oyl7aWYobnVsbD09RShiKSlyZXR1cm4hMDtpZihyKGEuYj9hLmIoRihiKSk6YS5jYWxsKG51bGwsRihiKSkpKXt2YXIgYz1hLGQ9SShiKTthPWM7Yj1kfWVsc2UgcmV0dXJuIHU/ITE6bnVsbH19XG5mdW5jdGlvbiBFZChhLGIpe2Zvcig7OylpZihFKGIpKXt2YXIgYz1hLmI/YS5iKEYoYikpOmEuY2FsbChudWxsLEYoYikpO2lmKHIoYykpcmV0dXJuIGM7dmFyIGM9YSxkPUkoYik7YT1jO2I9ZH1lbHNlIHJldHVybiBudWxsfWZ1bmN0aW9uIEZkKGEpe3JldHVybiBhfVxuZnVuY3Rpb24gR2QoYSl7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGI9bnVsbCxjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYihhLGQsayl7dmFyIGw9bnVsbDsyPGFyZ3VtZW50cy5sZW5ndGgmJihsPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpLDApKTtyZXR1cm4gYy5jYWxsKHRoaXMsYSxkLGwpfWZ1bmN0aW9uIGMoYixkLGUpe3JldHVybiBzYShTLm4oYSxiLGQsZSkpfWIuaz0yO2IuZj1mdW5jdGlvbihhKXt2YXIgYj1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9RyhhKTtyZXR1cm4gYyhiLGQsYSl9O2IuZD1jO3JldHVybiBifSgpLGI9ZnVuY3Rpb24oYixlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDA6cmV0dXJuIHNhKGEubz9hLm8oKTphLmNhbGwobnVsbCkpO2Nhc2UgMTp2YXIgaD1iO3JldHVybiBzYShhLmI/YS5iKGgpOmEuY2FsbChudWxsLGgpKTtjYXNlIDI6dmFyIGg9YixrPWU7cmV0dXJuIHNhKGEuYT9hLmEoaCxrKTphLmNhbGwobnVsbCxcbmgsaykpO2RlZmF1bHQ6cmV0dXJuIGMuZChiLGUsSihhcmd1bWVudHMsMikpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtiLms9MjtiLmY9Yy5mO3JldHVybiBifSgpfVxudmFyIEhkPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyl7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGQ9bnVsbCxsPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZChhLGIsYyxlKXt2YXIgZj1udWxsOzM8YXJndW1lbnRzLmxlbmd0aCYmKGY9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMyksMCkpO3JldHVybiBrLmNhbGwodGhpcyxhLGIsYyxmKX1mdW5jdGlvbiBrKGQsbCxuLHEpe3JldHVybiBhLmI/YS5iKGIuYj9iLmIoUy5zKGMsZCxsLG4scSkpOmIuY2FsbChudWxsLFMucyhjLGQsbCxuLHEpKSk6YS5jYWxsKG51bGwsYi5iP2IuYihTLnMoYyxkLGwsbixxKSk6Yi5jYWxsKG51bGwsUy5zKGMsZCxsLG4scSkpKX1kLms9MztkLmY9ZnVuY3Rpb24oYSl7dmFyIGI9RihhKTthPUkoYSk7dmFyIGM9RihhKTthPUkoYSk7dmFyIGQ9RihhKTthPUcoYSk7cmV0dXJuIGsoYixjLGQsYSl9O2QuZD1rO3JldHVybiBkfSgpLGQ9ZnVuY3Rpb24oZCxrLHQsdil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMDpyZXR1cm4gYS5iP1xuYS5iKGIuYj9iLmIoYy5vP2MubygpOmMuY2FsbChudWxsKSk6Yi5jYWxsKG51bGwsYy5vP2MubygpOmMuY2FsbChudWxsKSkpOmEuY2FsbChudWxsLGIuYj9iLmIoYy5vP2MubygpOmMuY2FsbChudWxsKSk6Yi5jYWxsKG51bGwsYy5vP2MubygpOmMuY2FsbChudWxsKSkpO2Nhc2UgMTp2YXIgdz1kO3JldHVybiBhLmI/YS5iKGIuYj9iLmIoYy5iP2MuYih3KTpjLmNhbGwobnVsbCx3KSk6Yi5jYWxsKG51bGwsYy5iP2MuYih3KTpjLmNhbGwobnVsbCx3KSkpOmEuY2FsbChudWxsLGIuYj9iLmIoYy5iP2MuYih3KTpjLmNhbGwobnVsbCx3KSk6Yi5jYWxsKG51bGwsYy5iP2MuYih3KTpjLmNhbGwobnVsbCx3KSkpO2Nhc2UgMjp2YXIgdz1kLHk9aztyZXR1cm4gYS5iP2EuYihiLmI/Yi5iKGMuYT9jLmEodyx5KTpjLmNhbGwobnVsbCx3LHkpKTpiLmNhbGwobnVsbCxjLmE/Yy5hKHcseSk6Yy5jYWxsKG51bGwsdyx5KSkpOmEuY2FsbChudWxsLGIuYj9iLmIoYy5hP2MuYSh3LHkpOmMuY2FsbChudWxsLFxudyx5KSk6Yi5jYWxsKG51bGwsYy5hP2MuYSh3LHkpOmMuY2FsbChudWxsLHcseSkpKTtjYXNlIDM6dmFyIHc9ZCx5PWssQj10O3JldHVybiBhLmI/YS5iKGIuYj9iLmIoYy5jP2MuYyh3LHksQik6Yy5jYWxsKG51bGwsdyx5LEIpKTpiLmNhbGwobnVsbCxjLmM/Yy5jKHcseSxCKTpjLmNhbGwobnVsbCx3LHksQikpKTphLmNhbGwobnVsbCxiLmI/Yi5iKGMuYz9jLmModyx5LEIpOmMuY2FsbChudWxsLHcseSxCKSk6Yi5jYWxsKG51bGwsYy5jP2MuYyh3LHksQik6Yy5jYWxsKG51bGwsdyx5LEIpKSk7ZGVmYXVsdDpyZXR1cm4gbC5kKGQsayx0LEooYXJndW1lbnRzLDMpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307ZC5rPTM7ZC5mPWwuZjtyZXR1cm4gZH0oKX1mdW5jdGlvbiBiKGEsYil7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGM9bnVsbCxkPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYyhhLGIsZSxmKXt2YXIgaD1udWxsOzM8YXJndW1lbnRzLmxlbmd0aCYmXG4oaD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywzKSwwKSk7cmV0dXJuIGQuY2FsbCh0aGlzLGEsYixlLGgpfWZ1bmN0aW9uIGQoYyxoLGssbCl7cmV0dXJuIGEuYj9hLmIoUy5zKGIsYyxoLGssbCkpOmEuY2FsbChudWxsLFMucyhiLGMsaCxrLGwpKX1jLms9MztjLmY9ZnVuY3Rpb24oYSl7dmFyIGI9RihhKTthPUkoYSk7dmFyIGM9RihhKTthPUkoYSk7dmFyIGU9RihhKTthPUcoYSk7cmV0dXJuIGQoYixjLGUsYSl9O2MuZD1kO3JldHVybiBjfSgpLGM9ZnVuY3Rpb24oYyxoLHEsdCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMDpyZXR1cm4gYS5iP2EuYihiLm8/Yi5vKCk6Yi5jYWxsKG51bGwpKTphLmNhbGwobnVsbCxiLm8/Yi5vKCk6Yi5jYWxsKG51bGwpKTtjYXNlIDE6dmFyIHY9YztyZXR1cm4gYS5iP2EuYihiLmI/Yi5iKHYpOmIuY2FsbChudWxsLHYpKTphLmNhbGwobnVsbCxiLmI/Yi5iKHYpOmIuY2FsbChudWxsLHYpKTtjYXNlIDI6dmFyIHY9XG5jLHc9aDtyZXR1cm4gYS5iP2EuYihiLmE/Yi5hKHYsdyk6Yi5jYWxsKG51bGwsdix3KSk6YS5jYWxsKG51bGwsYi5hP2IuYSh2LHcpOmIuY2FsbChudWxsLHYsdykpO2Nhc2UgMzp2YXIgdj1jLHc9aCx5PXE7cmV0dXJuIGEuYj9hLmIoYi5jP2IuYyh2LHcseSk6Yi5jYWxsKG51bGwsdix3LHkpKTphLmNhbGwobnVsbCxiLmM/Yi5jKHYsdyx5KTpiLmNhbGwobnVsbCx2LHcseSkpO2RlZmF1bHQ6cmV0dXJuIGQuZChjLGgscSxKKGFyZ3VtZW50cywzKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Muaz0zO2MuZj1kLmY7cmV0dXJuIGN9KCl9dmFyIGM9bnVsbCxkPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShjLGQsZSxuKXt2YXIgcT1udWxsOzM8YXJndW1lbnRzLmxlbmd0aCYmKHE9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMyksMCkpO3JldHVybiBiLmNhbGwodGhpcyxjLGQsZSxxKX1mdW5jdGlvbiBiKGEsYyxkLFxuZSl7cmV0dXJuIGZ1bmN0aW9uKGEpe3JldHVybiBmdW5jdGlvbigpe2Z1bmN0aW9uIGIoYSl7dmFyIGQ9bnVsbDswPGFyZ3VtZW50cy5sZW5ndGgmJihkPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApLDApKTtyZXR1cm4gYy5jYWxsKHRoaXMsZCl9ZnVuY3Rpb24gYyhiKXtiPVMuYShGKGEpLGIpO2Zvcih2YXIgZD1JKGEpOzspaWYoZCliPUYoZCkuY2FsbChudWxsLGIpLGQ9SShkKTtlbHNlIHJldHVybiBifWIuaz0wO2IuZj1mdW5jdGlvbihhKXthPUUoYSk7cmV0dXJuIGMoYSl9O2IuZD1jO3JldHVybiBifSgpfShlZCh1ZC5uKGEsYyxkLGUpKSl9YS5rPTM7YS5mPWZ1bmN0aW9uKGEpe3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1JKGEpO3ZhciBlPUYoYSk7YT1HKGEpO3JldHVybiBiKGMsZCxlLGEpfTthLmQ9YjtyZXR1cm4gYX0oKSxjPWZ1bmN0aW9uKGMsZixoLGspe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDA6cmV0dXJuIEZkO1xuY2FzZSAxOnJldHVybiBjO2Nhc2UgMjpyZXR1cm4gYi5jYWxsKHRoaXMsYyxmKTtjYXNlIDM6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZixoKTtkZWZhdWx0OnJldHVybiBkLmQoYyxmLGgsSihhcmd1bWVudHMsMykpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLms9MztjLmY9ZC5mO2Mubz1mdW5jdGlvbigpe3JldHVybiBGZH07Yy5iPWZ1bmN0aW9uKGEpe3JldHVybiBhfTtjLmE9YjtjLmM9YTtjLmQ9ZC5kO3JldHVybiBjfSgpLElkPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyxkKXtyZXR1cm4gZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGEpe3ZhciBiPW51bGw7MDxhcmd1bWVudHMubGVuZ3RoJiYoYj1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywwKSwwKSk7cmV0dXJuIHEuY2FsbCh0aGlzLGIpfWZ1bmN0aW9uIHEoZSl7cmV0dXJuIFMucyhhLGIsYyxkLGUpfWUuaz0wO2UuZj1mdW5jdGlvbihhKXthPUUoYSk7XG5yZXR1cm4gcShhKX07ZS5kPXE7cmV0dXJuIGV9KCl9ZnVuY3Rpb24gYihhLGIsYyl7cmV0dXJuIGZ1bmN0aW9uKCl7ZnVuY3Rpb24gZChhKXt2YXIgYj1udWxsOzA8YXJndW1lbnRzLmxlbmd0aCYmKGI9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCksMCkpO3JldHVybiBlLmNhbGwodGhpcyxiKX1mdW5jdGlvbiBlKGQpe3JldHVybiBTLm4oYSxiLGMsZCl9ZC5rPTA7ZC5mPWZ1bmN0aW9uKGEpe2E9RShhKTtyZXR1cm4gZShhKX07ZC5kPWU7cmV0dXJuIGR9KCl9ZnVuY3Rpb24gYyhhLGIpe3JldHVybiBmdW5jdGlvbigpe2Z1bmN0aW9uIGMoYSl7dmFyIGI9bnVsbDswPGFyZ3VtZW50cy5sZW5ndGgmJihiPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApLDApKTtyZXR1cm4gZC5jYWxsKHRoaXMsYil9ZnVuY3Rpb24gZChjKXtyZXR1cm4gUy5jKGEsYixjKX1jLms9MDtjLmY9ZnVuY3Rpb24oYSl7YT1FKGEpO3JldHVybiBkKGEpfTtcbmMuZD1kO3JldHVybiBjfSgpfXZhciBkPW51bGwsZT1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYyxkLGUsZix0KXt2YXIgdj1udWxsOzQ8YXJndW1lbnRzLmxlbmd0aCYmKHY9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsNCksMCkpO3JldHVybiBiLmNhbGwodGhpcyxjLGQsZSxmLHYpfWZ1bmN0aW9uIGIoYSxjLGQsZSxmKXtyZXR1cm4gZnVuY3Rpb24oKXtmdW5jdGlvbiBiKGEpe3ZhciBjPW51bGw7MDxhcmd1bWVudHMubGVuZ3RoJiYoYz1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywwKSwwKSk7cmV0dXJuIGguY2FsbCh0aGlzLGMpfWZ1bmN0aW9uIGgoYil7cmV0dXJuIFMucyhhLGMsZCxlLHRkLmEoZixiKSl9Yi5rPTA7Yi5mPWZ1bmN0aW9uKGEpe2E9RShhKTtyZXR1cm4gaChhKX07Yi5kPWg7cmV0dXJuIGJ9KCl9YS5rPTQ7YS5mPWZ1bmN0aW9uKGEpe3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1JKGEpO3ZhciBlPUYoYSk7XG5hPUkoYSk7dmFyIGY9RihhKTthPUcoYSk7cmV0dXJuIGIoYyxkLGUsZixhKX07YS5kPWI7cmV0dXJuIGF9KCksZD1mdW5jdGlvbihkLGgsayxsLG4pe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGQ7Y2FzZSAyOnJldHVybiBjLmNhbGwodGhpcyxkLGgpO2Nhc2UgMzpyZXR1cm4gYi5jYWxsKHRoaXMsZCxoLGspO2Nhc2UgNDpyZXR1cm4gYS5jYWxsKHRoaXMsZCxoLGssbCk7ZGVmYXVsdDpyZXR1cm4gZS5kKGQsaCxrLGwsSihhcmd1bWVudHMsNCkpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtkLms9NDtkLmY9ZS5mO2QuYj1mdW5jdGlvbihhKXtyZXR1cm4gYX07ZC5hPWM7ZC5jPWI7ZC5uPWE7ZC5kPWUuZDtyZXR1cm4gZH0oKSxKZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMsZCl7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGw9bnVsbCxuPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gbChhLGIsYyxkKXt2YXIgZT1udWxsO1xuMzxhcmd1bWVudHMubGVuZ3RoJiYoZT1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywzKSwwKSk7cmV0dXJuIG4uY2FsbCh0aGlzLGEsYixjLGUpfWZ1bmN0aW9uIG4obCxxLHQsQil7cmV0dXJuIFMucyhhLG51bGw9PWw/YjpsLG51bGw9PXE/YzpxLG51bGw9PXQ/ZDp0LEIpfWwuaz0zO2wuZj1mdW5jdGlvbihhKXt2YXIgYj1GKGEpO2E9SShhKTt2YXIgYz1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9RyhhKTtyZXR1cm4gbihiLGMsZCxhKX07bC5kPW47cmV0dXJuIGx9KCksbD1mdW5jdGlvbihsLHQsdix3KXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnZhciB5PWwsQj10O3JldHVybiBhLmE/YS5hKG51bGw9PXk/Yjp5LG51bGw9PUI/YzpCKTphLmNhbGwobnVsbCxudWxsPT15P2I6eSxudWxsPT1CP2M6Qik7Y2FzZSAzOnZhciB5PWwsQj10LEw9djtyZXR1cm4gYS5jP2EuYyhudWxsPT15P2I6eSxudWxsPT1CP2M6QixudWxsPT1MP2Q6TCk6YS5jYWxsKG51bGwsXG5udWxsPT15P2I6eSxudWxsPT1CP2M6QixudWxsPT1MP2Q6TCk7ZGVmYXVsdDpyZXR1cm4gbi5kKGwsdCx2LEooYXJndW1lbnRzLDMpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307bC5rPTM7bC5mPW4uZjtyZXR1cm4gbH0oKX1mdW5jdGlvbiBiKGEsYixjKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgZD1udWxsLGw9ZnVuY3Rpb24oKXtmdW5jdGlvbiBkKGEsYixjLGUpe3ZhciBmPW51bGw7Mzxhcmd1bWVudHMubGVuZ3RoJiYoZj1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywzKSwwKSk7cmV0dXJuIGsuY2FsbCh0aGlzLGEsYixjLGYpfWZ1bmN0aW9uIGsoZCxsLG4scSl7cmV0dXJuIFMucyhhLG51bGw9PWQ/YjpkLG51bGw9PWw/YzpsLG4scSl9ZC5rPTM7ZC5mPWZ1bmN0aW9uKGEpe3ZhciBiPUYoYSk7YT1JKGEpO3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1HKGEpO3JldHVybiBrKGIsYyxkLGEpfTtkLmQ9XG5rO3JldHVybiBkfSgpLGQ9ZnVuY3Rpb24oZCxrLHQsdil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjp2YXIgdz1kLHk9aztyZXR1cm4gYS5hP2EuYShudWxsPT13P2I6dyxudWxsPT15P2M6eSk6YS5jYWxsKG51bGwsbnVsbD09dz9iOncsbnVsbD09eT9jOnkpO2Nhc2UgMzp2YXIgdz1kLHk9ayxCPXQ7cmV0dXJuIGEuYz9hLmMobnVsbD09dz9iOncsbnVsbD09eT9jOnksQik6YS5jYWxsKG51bGwsbnVsbD09dz9iOncsbnVsbD09eT9jOnksQik7ZGVmYXVsdDpyZXR1cm4gbC5kKGQsayx0LEooYXJndW1lbnRzLDMpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307ZC5rPTM7ZC5mPWwuZjtyZXR1cm4gZH0oKX1mdW5jdGlvbiBjKGEsYil7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGM9bnVsbCxkPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYyhhLGIsZSxmKXt2YXIgaD1udWxsOzM8YXJndW1lbnRzLmxlbmd0aCYmKGg9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsXG4zKSwwKSk7cmV0dXJuIGQuY2FsbCh0aGlzLGEsYixlLGgpfWZ1bmN0aW9uIGQoYyxoLGssbCl7cmV0dXJuIFMucyhhLG51bGw9PWM/YjpjLGgsayxsKX1jLms9MztjLmY9ZnVuY3Rpb24oYSl7dmFyIGI9RihhKTthPUkoYSk7dmFyIGM9RihhKTthPUkoYSk7dmFyIGU9RihhKTthPUcoYSk7cmV0dXJuIGQoYixjLGUsYSl9O2MuZD1kO3JldHVybiBjfSgpLGM9ZnVuY3Rpb24oYyxoLHEsdCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTp2YXIgdj1jO3JldHVybiBhLmI/YS5iKG51bGw9PXY/Yjp2KTphLmNhbGwobnVsbCxudWxsPT12P2I6dik7Y2FzZSAyOnZhciB2PWMsdz1oO3JldHVybiBhLmE/YS5hKG51bGw9PXY/Yjp2LHcpOmEuY2FsbChudWxsLG51bGw9PXY/Yjp2LHcpO2Nhc2UgMzp2YXIgdj1jLHc9aCx5PXE7cmV0dXJuIGEuYz9hLmMobnVsbD09dj9iOnYsdyx5KTphLmNhbGwobnVsbCxudWxsPT12P2I6dix3LHkpO2RlZmF1bHQ6cmV0dXJuIGQuZChjLGgscSxKKGFyZ3VtZW50cyxcbjMpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5rPTM7Yy5mPWQuZjtyZXR1cm4gY30oKX12YXIgZD1udWxsLGQ9ZnVuY3Rpb24oZCxmLGgsayl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gYy5jYWxsKHRoaXMsZCxmKTtjYXNlIDM6cmV0dXJuIGIuY2FsbCh0aGlzLGQsZixoKTtjYXNlIDQ6cmV0dXJuIGEuY2FsbCh0aGlzLGQsZixoLGspfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtkLmE9YztkLmM9YjtkLm49YTtyZXR1cm4gZH0oKSxLZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMsZSl7cmV0dXJuIG5ldyBWKG51bGwsZnVuY3Rpb24oKXt2YXIgbj1FKGIpLHE9RShjKSx0PUUoZSk7cmV0dXJuIG4mJnEmJnQ/TShhLmM/YS5jKEYobiksRihxKSxGKHQpKTphLmNhbGwobnVsbCxGKG4pLEYocSksRih0KSksZC5uKGEsRyhuKSxHKHEpLEcodCkpKTpudWxsfSxcbm51bGwsbnVsbCl9ZnVuY3Rpb24gYihhLGIsYyl7cmV0dXJuIG5ldyBWKG51bGwsZnVuY3Rpb24oKXt2YXIgZT1FKGIpLG49RShjKTtyZXR1cm4gZSYmbj9NKGEuYT9hLmEoRihlKSxGKG4pKTphLmNhbGwobnVsbCxGKGUpLEYobikpLGQuYyhhLEcoZSksRyhuKSkpOm51bGx9LG51bGwsbnVsbCl9ZnVuY3Rpb24gYyhhLGIpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7dmFyIGM9RShiKTtpZihjKXtpZihJYyhjKSl7Zm9yKHZhciBlPUhiKGMpLG49TyhlKSxxPW5ldyBsZChBcnJheShuKSwwKSx0PTA7OylpZih0PG4pe3ZhciB2PWEuYj9hLmIoRC5hKGUsdCkpOmEuY2FsbChudWxsLEQuYShlLHQpKTtxLmFkZCh2KTt0Kz0xfWVsc2UgYnJlYWs7cmV0dXJuIHBkKHEuZGEoKSxkLmEoYSxJYihjKSkpfXJldHVybiBNKGEuYj9hLmIoRihjKSk6YS5jYWxsKG51bGwsRihjKSksZC5hKGEsRyhjKSkpfXJldHVybiBudWxsfSxudWxsLG51bGwpfXZhciBkPW51bGwsZT1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYyxcbmQsZSxmLHQpe3ZhciB2PW51bGw7NDxhcmd1bWVudHMubGVuZ3RoJiYodj1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyw0KSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGMsZCxlLGYsdil9ZnVuY3Rpb24gYihhLGMsZSxmLGgpe3ZhciB2PWZ1bmN0aW9uIHkoYSl7cmV0dXJuIG5ldyBWKG51bGwsZnVuY3Rpb24oKXt2YXIgYj1kLmEoRSxhKTtyZXR1cm4gRGQoRmQsYik/TShkLmEoRixiKSx5KGQuYShHLGIpKSk6bnVsbH0sbnVsbCxudWxsKX07cmV0dXJuIGQuYShmdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbihiKXtyZXR1cm4gUy5hKGEsYil9fSh2KSx2KHBjLmQoaCxmLEooW2UsY10sMCkpKSl9YS5rPTQ7YS5mPWZ1bmN0aW9uKGEpe3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1JKGEpO3ZhciBlPUYoYSk7YT1JKGEpO3ZhciBmPUYoYSk7YT1HKGEpO3JldHVybiBiKGMsZCxlLGYsYSl9O2EuZD1iO3JldHVybiBhfSgpLGQ9ZnVuY3Rpb24oZCxoLGssbCxcbm4pe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGMuY2FsbCh0aGlzLGQsaCk7Y2FzZSAzOnJldHVybiBiLmNhbGwodGhpcyxkLGgsayk7Y2FzZSA0OnJldHVybiBhLmNhbGwodGhpcyxkLGgsayxsKTtkZWZhdWx0OnJldHVybiBlLmQoZCxoLGssbCxKKGFyZ3VtZW50cyw0KSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Quaz00O2QuZj1lLmY7ZC5hPWM7ZC5jPWI7ZC5uPWE7ZC5kPWUuZDtyZXR1cm4gZH0oKSxNZD1mdW5jdGlvbiBMZChiLGMpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7aWYoMDxiKXt2YXIgZD1FKGMpO3JldHVybiBkP00oRihkKSxMZChiLTEsRyhkKSkpOm51bGx9cmV0dXJuIG51bGx9LG51bGwsbnVsbCl9O1xuZnVuY3Rpb24gTmQoYSxiKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbihjKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gYyhhLGIpfX0oZnVuY3Rpb24oYSxiKXtmb3IoOzspe3ZhciBlPUUoYik7aWYoMDxhJiZlKXt2YXIgZj1hLTEsZT1HKGUpO2E9ZjtiPWV9ZWxzZSByZXR1cm4gZX19KSxudWxsLG51bGwpfVxudmFyIE9kPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3JldHVybiBNZChhLGMuYihiKSl9ZnVuY3Rpb24gYihhKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbigpe3JldHVybiBNKGEsYy5iKGEpKX0sbnVsbCxudWxsKX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBiLmNhbGwodGhpcyxjKTtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYj1iO2MuYT1hO3JldHVybiBjfSgpLFBkPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3JldHVybiBNZChhLGMuYihiKSl9ZnVuY3Rpb24gYihhKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbigpe3JldHVybiBNKGEubz9hLm8oKTphLmNhbGwobnVsbCksYy5iKGEpKX0sbnVsbCxudWxsKX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBiLmNhbGwodGhpcyxcbmMpO2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5iPWI7Yy5hPWE7cmV0dXJuIGN9KCksUWQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYyl7cmV0dXJuIG5ldyBWKG51bGwsZnVuY3Rpb24oKXt2YXIgZj1FKGEpLGg9RShjKTtyZXR1cm4gZiYmaD9NKEYoZiksTShGKGgpLGIuYShHKGYpLEcoaCkpKSk6bnVsbH0sbnVsbCxudWxsKX12YXIgYj1udWxsLGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGIsZCxrKXt2YXIgbD1udWxsOzI8YXJndW1lbnRzLmxlbmd0aCYmKGw9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMiksMCkpO3JldHVybiBjLmNhbGwodGhpcyxiLGQsbCl9ZnVuY3Rpb24gYyhhLGQsZSl7cmV0dXJuIG5ldyBWKG51bGwsZnVuY3Rpb24oKXt2YXIgYz1LZC5hKEUscGMuZChlLGQsSihbYV0sMCkpKTtyZXR1cm4gRGQoRmQsYyk/dGQuYShLZC5hKEYsXG5jKSxTLmEoYixLZC5hKEcsYykpKTpudWxsfSxudWxsLG51bGwpfWEuaz0yO2EuZj1mdW5jdGlvbihhKXt2YXIgYj1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9RyhhKTtyZXR1cm4gYyhiLGQsYSl9O2EuZD1jO3JldHVybiBhfSgpLGI9ZnVuY3Rpb24oYixlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGIsZSk7ZGVmYXVsdDpyZXR1cm4gYy5kKGIsZSxKKGFyZ3VtZW50cywyKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Iuaz0yO2IuZj1jLmY7Yi5hPWE7Yi5kPWMuZDtyZXR1cm4gYn0oKTtmdW5jdGlvbiBSZChhKXtyZXR1cm4gZnVuY3Rpb24gYyhhLGUpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7dmFyIGY9RShhKTtyZXR1cm4gZj9NKEYoZiksYyhHKGYpLGUpKTpFKGUpP2MoRihlKSxHKGUpKTpudWxsfSxudWxsLG51bGwpfShudWxsLGEpfVxudmFyIFNkPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3JldHVybiBSZChLZC5hKGEsYikpfXZhciBiPW51bGwsYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYyxkLGspe3ZhciBsPW51bGw7Mjxhcmd1bWVudHMubGVuZ3RoJiYobD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGMsZCxsKX1mdW5jdGlvbiBiKGEsYyxkKXtyZXR1cm4gUmQoUy5uKEtkLGEsYyxkKSl9YS5rPTI7YS5mPWZ1bmN0aW9uKGEpe3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1HKGEpO3JldHVybiBiKGMsZCxhKX07YS5kPWI7cmV0dXJuIGF9KCksYj1mdW5jdGlvbihiLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsYixlKTtkZWZhdWx0OnJldHVybiBjLmQoYixlLEooYXJndW1lbnRzLDIpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307XG5iLms9MjtiLmY9Yy5mO2IuYT1hO2IuZD1jLmQ7cmV0dXJuIGJ9KCksVWQ9ZnVuY3Rpb24gVGQoYixjKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbigpe3ZhciBkPUUoYyk7aWYoZCl7aWYoSWMoZCkpe2Zvcih2YXIgZT1IYihkKSxmPU8oZSksaD1uZXcgbGQoQXJyYXkoZiksMCksaz0wOzspaWYoazxmKXtpZihyKGIuYj9iLmIoRC5hKGUsaykpOmIuY2FsbChudWxsLEQuYShlLGspKSkpe3ZhciBsPUQuYShlLGspO2guYWRkKGwpfWsrPTF9ZWxzZSBicmVhaztyZXR1cm4gcGQoaC5kYSgpLFRkKGIsSWIoZCkpKX1lPUYoZCk7ZD1HKGQpO3JldHVybiByKGIuYj9iLmIoZSk6Yi5jYWxsKG51bGwsZSkpP00oZSxUZChiLGQpKTpUZChiLGQpfXJldHVybiBudWxsfSxudWxsLG51bGwpfTtmdW5jdGlvbiBWZChhLGIpe3JldHVybiBVZChHZChhKSxiKX1cbmZ1bmN0aW9uIFdkKGEpe3ZhciBiPVhkO3JldHVybiBmdW5jdGlvbiBkKGEpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7cmV0dXJuIE0oYSxyKGIuYj9iLmIoYSk6Yi5jYWxsKG51bGwsYSkpP1NkLmEoZCxFLmI/RS5iKGEpOkUuY2FsbChudWxsLGEpKTpudWxsKX0sbnVsbCxudWxsKX0oYSl9ZnVuY3Rpb24gWWQoYSxiKXtyZXR1cm4gbnVsbCE9YT9hJiYoYS5xJjR8fGEuQmMpP3ZkKEMuYyh6Yix5YihhKSxiKSk6Qy5jKERhLGEsYik6Qy5jKHBjLEgsYil9XG52YXIgWmQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjLGspe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7dmFyIGw9RShrKTtpZihsKXt2YXIgbj1NZChhLGwpO3JldHVybiBhPT09TyhuKT9NKG4sZC5uKGEsYixjLE5kKGIsbCkpKTpEYShILE1kKGEsdGQuYShuLGMpKSl9cmV0dXJuIG51bGx9LG51bGwsbnVsbCl9ZnVuY3Rpb24gYihhLGIsYyl7cmV0dXJuIG5ldyBWKG51bGwsZnVuY3Rpb24oKXt2YXIgaz1FKGMpO2lmKGspe3ZhciBsPU1kKGEsayk7cmV0dXJuIGE9PT1PKGwpP00obCxkLmMoYSxiLE5kKGIsaykpKTpudWxsfXJldHVybiBudWxsfSxudWxsLG51bGwpfWZ1bmN0aW9uIGMoYSxiKXtyZXR1cm4gZC5jKGEsYSxiKX12YXIgZD1udWxsLGQ9ZnVuY3Rpb24oZCxmLGgsayl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gYy5jYWxsKHRoaXMsZCxmKTtjYXNlIDM6cmV0dXJuIGIuY2FsbCh0aGlzLGQsZixoKTtjYXNlIDQ6cmV0dXJuIGEuY2FsbCh0aGlzLFxuZCxmLGgsayl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2QuYT1jO2QuYz1iO2Qubj1hO3JldHVybiBkfSgpLCRkPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyl7dmFyIGg9TGM7Zm9yKGI9RShiKTs7KWlmKGIpe3ZhciBrPWE7aWYoaz9rLmkmMjU2fHxrLk1ifHwoay5pPzA6cyhLYSxrKSk6cyhLYSxrKSl7YT1RLmMoYSxGKGIpLGgpO2lmKGg9PT1hKXJldHVybiBjO2I9SShiKX1lbHNlIHJldHVybiBjfWVsc2UgcmV0dXJuIGF9ZnVuY3Rpb24gYihhLGIpe3JldHVybiBjLmMoYSxiLG51bGwpfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gYi5jYWxsKHRoaXMsYyxlKTtjYXNlIDM6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSxmKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5hPWI7Yy5jPWE7cmV0dXJuIGN9KCksYWU9XG5mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMsZCxmLHQpe3ZhciB2PVAuYyhiLDAsbnVsbCk7cmV0dXJuKGI9JGMoYikpP1IuYyhhLHYsZS5YKFEuYShhLHYpLGIsYyxkLGYsdCkpOlIuYyhhLHYsYy5uP2MubihRLmEoYSx2KSxkLGYsdCk6Yy5jYWxsKG51bGwsUS5hKGEsdiksZCxmLHQpKX1mdW5jdGlvbiBiKGEsYixjLGQsZil7dmFyIHQ9UC5jKGIsMCxudWxsKTtyZXR1cm4oYj0kYyhiKSk/Ui5jKGEsdCxlLnMoUS5hKGEsdCksYixjLGQsZikpOlIuYyhhLHQsYy5jP2MuYyhRLmEoYSx0KSxkLGYpOmMuY2FsbChudWxsLFEuYShhLHQpLGQsZikpfWZ1bmN0aW9uIGMoYSxiLGMsZCl7dmFyIGY9UC5jKGIsMCxudWxsKTtyZXR1cm4oYj0kYyhiKSk/Ui5jKGEsZixlLm4oUS5hKGEsZiksYixjLGQpKTpSLmMoYSxmLGMuYT9jLmEoUS5hKGEsZiksZCk6Yy5jYWxsKG51bGwsUS5hKGEsZiksZCkpfWZ1bmN0aW9uIGQoYSxiLGMpe3ZhciBkPVAuYyhiLDAsbnVsbCk7cmV0dXJuKGI9JGMoYikpP1xuUi5jKGEsZCxlLmMoUS5hKGEsZCksYixjKSk6Ui5jKGEsZCxjLmI/Yy5iKFEuYShhLGQpKTpjLmNhbGwobnVsbCxRLmEoYSxkKSkpfXZhciBlPW51bGwsZj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYyxkLGUsZixoLHcseSl7dmFyIEI9bnVsbDs2PGFyZ3VtZW50cy5sZW5ndGgmJihCPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDYpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYyxkLGUsZixoLHcsQil9ZnVuY3Rpb24gYihhLGMsZCxmLGgsayx5KXt2YXIgQj1QLmMoYywwLG51bGwpO3JldHVybihjPSRjKGMpKT9SLmMoYSxCLFMuZChlLFEuYShhLEIpLGMsZCxmLEooW2gsayx5XSwwKSkpOlIuYyhhLEIsUy5kKGQsUS5hKGEsQiksZixoLGssSihbeV0sMCkpKX1hLms9NjthLmY9ZnVuY3Rpb24oYSl7dmFyIGM9RihhKTthPUkoYSk7dmFyIGQ9RihhKTthPUkoYSk7dmFyIGU9RihhKTthPUkoYSk7dmFyIGY9RihhKTthPUkoYSk7dmFyIGg9RihhKTthPUkoYSk7dmFyIHk9XG5GKGEpO2E9RyhhKTtyZXR1cm4gYihjLGQsZSxmLGgseSxhKX07YS5kPWI7cmV0dXJuIGF9KCksZT1mdW5jdGlvbihlLGssbCxuLHEsdCx2KXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAzOnJldHVybiBkLmNhbGwodGhpcyxlLGssbCk7Y2FzZSA0OnJldHVybiBjLmNhbGwodGhpcyxlLGssbCxuKTtjYXNlIDU6cmV0dXJuIGIuY2FsbCh0aGlzLGUsayxsLG4scSk7Y2FzZSA2OnJldHVybiBhLmNhbGwodGhpcyxlLGssbCxuLHEsdCk7ZGVmYXVsdDpyZXR1cm4gZi5kKGUsayxsLG4scSx0LEooYXJndW1lbnRzLDYpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307ZS5rPTY7ZS5mPWYuZjtlLmM9ZDtlLm49YztlLnM9YjtlLlg9YTtlLmQ9Zi5kO3JldHVybiBlfSgpO2Z1bmN0aW9uIGJlKGEsYil7dGhpcy50PWE7dGhpcy5lPWJ9XG5mdW5jdGlvbiBjZShhKXtyZXR1cm4gbmV3IGJlKGEsW251bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbF0pfWZ1bmN0aW9uIGRlKGEpe3JldHVybiBuZXcgYmUoYS50LHZhKGEuZSkpfWZ1bmN0aW9uIGVlKGEpe2E9YS5nO3JldHVybiAzMj5hPzA6YS0xPj4+NTw8NX1mdW5jdGlvbiBmZShhLGIsYyl7Zm9yKDs7KXtpZigwPT09YilyZXR1cm4gYzt2YXIgZD1jZShhKTtkLmVbMF09YztjPWQ7Yi09NX19dmFyIGhlPWZ1bmN0aW9uIGdlKGIsYyxkLGUpe3ZhciBmPWRlKGQpLGg9Yi5nLTE+Pj5jJjMxOzU9PT1jP2YuZVtoXT1lOihkPWQuZVtoXSxiPW51bGwhPWQ/Z2UoYixjLTUsZCxlKTpmZShudWxsLGMtNSxlKSxmLmVbaF09Yik7cmV0dXJuIGZ9O1xuZnVuY3Rpb24gaWUoYSxiKXt0aHJvdyBFcnJvcihcIk5vIGl0ZW0gXCIrQS5iKGEpK1wiIGluIHZlY3RvciBvZiBsZW5ndGggXCIrQS5iKGIpKTt9ZnVuY3Rpb24gamUoYSl7dmFyIGI9YS5yb290O2ZvcihhPWEuc2hpZnQ7OylpZigwPGEpYS09NSxiPWIuZVswXTtlbHNlIHJldHVybiBiLmV9ZnVuY3Rpb24ga2UoYSxiKXtpZihiPj1lZShhKSlyZXR1cm4gYS5SO2Zvcih2YXIgYz1hLnJvb3QsZD1hLnNoaWZ0OzspaWYoMDxkKXZhciBlPWQtNSxjPWMuZVtiPj4+ZCYzMV0sZD1lO2Vsc2UgcmV0dXJuIGMuZX1mdW5jdGlvbiBsZShhLGIpe3JldHVybiAwPD1iJiZiPGEuZz9rZShhLGIpOmllKGIsYS5nKX1cbnZhciBuZT1mdW5jdGlvbiBtZShiLGMsZCxlLGYpe3ZhciBoPWRlKGQpO2lmKDA9PT1jKWguZVtlJjMxXT1mO2Vsc2V7dmFyIGs9ZT4+PmMmMzE7Yj1tZShiLGMtNSxkLmVba10sZSxmKTtoLmVba109Yn1yZXR1cm4gaH0scGU9ZnVuY3Rpb24gb2UoYixjLGQpe3ZhciBlPWIuZy0yPj4+YyYzMTtpZig1PGMpe2I9b2UoYixjLTUsZC5lW2VdKTtpZihudWxsPT1iJiYwPT09ZSlyZXR1cm4gbnVsbDtkPWRlKGQpO2QuZVtlXT1iO3JldHVybiBkfXJldHVybiAwPT09ZT9udWxsOnU/KGQ9ZGUoZCksZC5lW2VdPW51bGwsZCk6bnVsbH07ZnVuY3Rpb24gVyhhLGIsYyxkLGUsZil7dGhpcy5qPWE7dGhpcy5nPWI7dGhpcy5zaGlmdD1jO3RoaXMucm9vdD1kO3RoaXMuUj1lO3RoaXMubT1mO3RoaXMuaT0xNjc2Njg1MTE7dGhpcy5xPTgxOTZ9Zz1XLnByb3RvdHlwZTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIExiKHRoaXMpfTtcbmcudT1mdW5jdGlvbihhLGIpe3JldHVybiBMYS5jKHRoaXMsYixudWxsKX07Zy5DPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm5cIm51bWJlclwiPT09dHlwZW9mIGI/RC5jKHRoaXMsYixjKTpjfTtnLlphPWZ1bmN0aW9uKGEsYixjKXthPVswLGNdO2ZvcihjPTA7OylpZihjPHRoaXMuZyl7dmFyIGQ9a2UodGhpcyxjKSxlPWQubGVuZ3RoO2E6e2Zvcih2YXIgZj0wLGg9YVsxXTs7KWlmKGY8ZSl7aD1iLmM/Yi5jKGgsZitjLGRbZl0pOmIuY2FsbChudWxsLGgsZitjLGRbZl0pO2lmKGZjKGgpKXtkPWg7YnJlYWsgYX1mKz0xfWVsc2V7YVswXT1lO2Q9YVsxXT1oO2JyZWFrIGF9ZD12b2lkIDB9aWYoZmMoZCkpcmV0dXJuIEsuYj9LLmIoZCk6Sy5jYWxsKG51bGwsZCk7Yys9YVswXX1lbHNlIHJldHVybiBhWzFdfTtnLko9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbGUodGhpcyxiKVtiJjMxXX07XG5nLmFhPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gMDw9YiYmYjx0aGlzLmc/a2UodGhpcyxiKVtiJjMxXTpjfTtnLlBhPWZ1bmN0aW9uKGEsYixjKXtpZigwPD1iJiZiPHRoaXMuZylyZXR1cm4gZWUodGhpcyk8PWI/KGE9dmEodGhpcy5SKSxhW2ImMzFdPWMsbmV3IFcodGhpcy5qLHRoaXMuZyx0aGlzLnNoaWZ0LHRoaXMucm9vdCxhLG51bGwpKTpuZXcgVyh0aGlzLmosdGhpcy5nLHRoaXMuc2hpZnQsbmUodGhpcyx0aGlzLnNoaWZ0LHRoaXMucm9vdCxiLGMpLHRoaXMuUixudWxsKTtpZihiPT09dGhpcy5nKXJldHVybiBEYSh0aGlzLGMpO2lmKHUpdGhyb3cgRXJyb3IoXCJJbmRleCBcIitBLmIoYikrXCIgb3V0IG9mIGJvdW5kcyAgWzAsXCIrQS5iKHRoaXMuZykrXCJdXCIpO3JldHVybiBudWxsfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5qfTtnLkw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nfTtnLiRhPWZ1bmN0aW9uKCl7cmV0dXJuIEQuYSh0aGlzLDApfTtcbmcuYWI9ZnVuY3Rpb24oKXtyZXR1cm4gRC5hKHRoaXMsMSl9O2cuSWE9ZnVuY3Rpb24oKXtyZXR1cm4gMDx0aGlzLmc/RC5hKHRoaXMsdGhpcy5nLTEpOm51bGx9O2cuSmE9ZnVuY3Rpb24oKXtpZigwPT09dGhpcy5nKXRocm93IEVycm9yKFwiQ2FuJ3QgcG9wIGVtcHR5IHZlY3RvclwiKTtpZigxPT09dGhpcy5nKXJldHVybiBlYihxZSx0aGlzLmopO2lmKDE8dGhpcy5nLWVlKHRoaXMpKXJldHVybiBuZXcgVyh0aGlzLmosdGhpcy5nLTEsdGhpcy5zaGlmdCx0aGlzLnJvb3QsdGhpcy5SLnNsaWNlKDAsLTEpLG51bGwpO2lmKHUpe3ZhciBhPWtlKHRoaXMsdGhpcy5nLTIpLGI9cGUodGhpcyx0aGlzLnNoaWZ0LHRoaXMucm9vdCksYj1udWxsPT1iP1g6YixjPXRoaXMuZy0xO3JldHVybiA1PHRoaXMuc2hpZnQmJm51bGw9PWIuZVsxXT9uZXcgVyh0aGlzLmosYyx0aGlzLnNoaWZ0LTUsYi5lWzBdLGEsbnVsbCk6bmV3IFcodGhpcy5qLGMsdGhpcy5zaGlmdCxiLGEsbnVsbCl9cmV0dXJuIG51bGx9O1xuZy5YYT1mdW5jdGlvbigpe3JldHVybiAwPHRoaXMuZz9uZXcga2ModGhpcyx0aGlzLmctMSxudWxsKTpudWxsfTtnLkI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm07cmV0dXJuIG51bGwhPWE/YTp0aGlzLm09YT1jYyh0aGlzKX07Zy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGxjKHRoaXMsYil9O2cuV2E9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHJlKHRoaXMuZyx0aGlzLnNoaWZ0LHNlLmI/c2UuYih0aGlzLnJvb3QpOnNlLmNhbGwobnVsbCx0aGlzLnJvb3QpLHRlLmI/dGUuYih0aGlzLlIpOnRlLmNhbGwobnVsbCx0aGlzLlIpKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIE4ocWUsdGhpcy5qKX07Zy5OPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGdjLmEodGhpcyxiKX07Zy5NPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gZ2MuYyh0aGlzLGIsYyl9O1xuZy51YT1mdW5jdGlvbihhLGIsYyl7aWYoXCJudW1iZXJcIj09PXR5cGVvZiBiKXJldHVybiAkYSh0aGlzLGIsYyk7dGhyb3cgRXJyb3IoXCJWZWN0b3IncyBrZXkgZm9yIGFzc29jIG11c3QgYmUgYSBudW1iZXIuXCIpO307Zy5IPWZ1bmN0aW9uKCl7cmV0dXJuIDA9PT10aGlzLmc/bnVsbDozMj49dGhpcy5nP25ldyBhYyh0aGlzLlIsMCk6dT91ZS5uP3VlLm4odGhpcyxqZSh0aGlzKSwwLDApOnVlLmNhbGwobnVsbCx0aGlzLGplKHRoaXMpLDAsMCk6bnVsbH07Zy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBXKGIsdGhpcy5nLHRoaXMuc2hpZnQsdGhpcy5yb290LHRoaXMuUix0aGlzLm0pfTtcbmcuRz1mdW5jdGlvbihhLGIpe2lmKDMyPnRoaXMuZy1lZSh0aGlzKSl7Zm9yKHZhciBjPXRoaXMuUi5sZW5ndGgsZD1BcnJheShjKzEpLGU9MDs7KWlmKGU8YylkW2VdPXRoaXMuUltlXSxlKz0xO2Vsc2UgYnJlYWs7ZFtjXT1iO3JldHVybiBuZXcgVyh0aGlzLmosdGhpcy5nKzEsdGhpcy5zaGlmdCx0aGlzLnJvb3QsZCxudWxsKX1jPShkPXRoaXMuZz4+PjU+MTw8dGhpcy5zaGlmdCk/dGhpcy5zaGlmdCs1OnRoaXMuc2hpZnQ7ZD8oZD1jZShudWxsKSxkLmVbMF09dGhpcy5yb290LGU9ZmUobnVsbCx0aGlzLnNoaWZ0LG5ldyBiZShudWxsLHRoaXMuUikpLGQuZVsxXT1lKTpkPWhlKHRoaXMsdGhpcy5zaGlmdCx0aGlzLnJvb3QsbmV3IGJlKG51bGwsdGhpcy5SKSk7cmV0dXJuIG5ldyBXKHRoaXMuaix0aGlzLmcrMSxjLGQsW2JdLG51bGwpfTtcbmcuY2FsbD1mdW5jdGlvbigpe3ZhciBhPW51bGw7cmV0dXJuIGE9ZnVuY3Rpb24oYSxjLGQpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIHRoaXMuSihudWxsLGMpO2Nhc2UgMzpyZXR1cm4gdGhpcy5hYShudWxsLGMsZCl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9fSgpO2cuYXBwbHk9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5jYWxsLmFwcGx5KHRoaXMsW3RoaXNdLmNvbmNhdCh2YShiKSkpfTtnLmI9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuSihudWxsLGEpfTtnLmE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5hYShudWxsLGEsYil9O1xudmFyIFg9bmV3IGJlKG51bGwsW251bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbF0pLHFlPW5ldyBXKG51bGwsMCw1LFgsW10sMCk7ZnVuY3Rpb24gdmUoYSxiKXt2YXIgYz1hLmxlbmd0aCxkPWI/YTp2YShhKTtpZigzMj5jKXJldHVybiBuZXcgVyhudWxsLGMsNSxYLGQsbnVsbCk7Zm9yKHZhciBlPTMyLGY9KG5ldyBXKG51bGwsMzIsNSxYLGQuc2xpY2UoMCwzMiksbnVsbCkpLldhKG51bGwpOzspaWYoZTxjKXZhciBoPWUrMSxmPXdkLmEoZixkW2VdKSxlPWg7ZWxzZSByZXR1cm4gQWIoZil9ZnVuY3Rpb24gd2UoYSl7cmV0dXJuIEFiKEMuYyh6Yix5YihxZSksYSkpfVxudmFyIHhlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhKXt2YXIgZD1udWxsOzA8YXJndW1lbnRzLmxlbmd0aCYmKGQ9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCksMCkpO3JldHVybiBiLmNhbGwodGhpcyxkKX1mdW5jdGlvbiBiKGEpe3JldHVybiBhIGluc3RhbmNlb2YgYWMmJjA9PT1hLnA/dmUuYT92ZS5hKGEuZSwhMCk6dmUuY2FsbChudWxsLGEuZSwhMCk6d2UoYSl9YS5rPTA7YS5mPWZ1bmN0aW9uKGEpe2E9RShhKTtyZXR1cm4gYihhKX07YS5kPWI7cmV0dXJuIGF9KCk7ZnVuY3Rpb24geWUoYSxiLGMsZCxlLGYpe3RoaXMuUD1hO3RoaXMuZWE9Yjt0aGlzLnA9Yzt0aGlzLk89ZDt0aGlzLmo9ZTt0aGlzLm09Zjt0aGlzLmk9MzIyNDM5NDg7dGhpcy5xPTE1MzZ9Zz15ZS5wcm90b3R5cGU7Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07XG5nLlU9ZnVuY3Rpb24oKXtpZih0aGlzLk8rMTx0aGlzLmVhLmxlbmd0aCl7dmFyIGE9dWUubj91ZS5uKHRoaXMuUCx0aGlzLmVhLHRoaXMucCx0aGlzLk8rMSk6dWUuY2FsbChudWxsLHRoaXMuUCx0aGlzLmVhLHRoaXMucCx0aGlzLk8rMSk7cmV0dXJuIG51bGw9PWE/bnVsbDphfXJldHVybiBKYih0aGlzKX07Zy5CPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tO3JldHVybiBudWxsIT1hP2E6dGhpcy5tPWE9Y2ModGhpcyl9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBsYyh0aGlzLGIpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gTihxZSx0aGlzLmopfTtnLk49ZnVuY3Rpb24oYSxiKXtyZXR1cm4gZ2MuYSh6ZS5jP3plLmModGhpcy5QLHRoaXMucCt0aGlzLk8sTyh0aGlzLlApKTp6ZS5jYWxsKG51bGwsdGhpcy5QLHRoaXMucCt0aGlzLk8sTyh0aGlzLlApKSxiKX07XG5nLk09ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBnYy5jKHplLmM/emUuYyh0aGlzLlAsdGhpcy5wK3RoaXMuTyxPKHRoaXMuUCkpOnplLmNhbGwobnVsbCx0aGlzLlAsdGhpcy5wK3RoaXMuTyxPKHRoaXMuUCkpLGIsYyl9O2cuUT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVhW3RoaXMuT119O2cuUz1mdW5jdGlvbigpe2lmKHRoaXMuTysxPHRoaXMuZWEubGVuZ3RoKXt2YXIgYT11ZS5uP3VlLm4odGhpcy5QLHRoaXMuZWEsdGhpcy5wLHRoaXMuTysxKTp1ZS5jYWxsKG51bGwsdGhpcy5QLHRoaXMuZWEsdGhpcy5wLHRoaXMuTysxKTtyZXR1cm4gbnVsbD09YT9IOmF9cmV0dXJuIEliKHRoaXMpfTtnLkg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc307Zy5zYj1mdW5jdGlvbigpe3JldHVybiBuZC5hKHRoaXMuZWEsdGhpcy5PKX07XG5nLnRiPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5wK3RoaXMuZWEubGVuZ3RoO3JldHVybiBhPEFhKHRoaXMuUCk/dWUubj91ZS5uKHRoaXMuUCxrZSh0aGlzLlAsYSksYSwwKTp1ZS5jYWxsKG51bGwsdGhpcy5QLGtlKHRoaXMuUCxhKSxhLDApOkh9O2cuRj1mdW5jdGlvbihhLGIpe3JldHVybiB1ZS5zP3VlLnModGhpcy5QLHRoaXMuZWEsdGhpcy5wLHRoaXMuTyxiKTp1ZS5jYWxsKG51bGwsdGhpcy5QLHRoaXMuZWEsdGhpcy5wLHRoaXMuTyxiKX07Zy5HPWZ1bmN0aW9uKGEsYil7cmV0dXJuIE0oYix0aGlzKX07Zy5yYj1mdW5jdGlvbigpe3ZhciBhPXRoaXMucCt0aGlzLmVhLmxlbmd0aDtyZXR1cm4gYTxBYSh0aGlzLlApP3VlLm4/dWUubih0aGlzLlAsa2UodGhpcy5QLGEpLGEsMCk6dWUuY2FsbChudWxsLHRoaXMuUCxrZSh0aGlzLlAsYSksYSwwKTpudWxsfTtcbnZhciB1ZT1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMsZCxsKXtyZXR1cm4gbmV3IHllKGEsYixjLGQsbCxudWxsKX1mdW5jdGlvbiBiKGEsYixjLGQpe3JldHVybiBuZXcgeWUoYSxiLGMsZCxudWxsLG51bGwpfWZ1bmN0aW9uIGMoYSxiLGMpe3JldHVybiBuZXcgeWUoYSxsZShhLGIpLGIsYyxudWxsLG51bGwpfXZhciBkPW51bGwsZD1mdW5jdGlvbihkLGYsaCxrLGwpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDM6cmV0dXJuIGMuY2FsbCh0aGlzLGQsZixoKTtjYXNlIDQ6cmV0dXJuIGIuY2FsbCh0aGlzLGQsZixoLGspO2Nhc2UgNTpyZXR1cm4gYS5jYWxsKHRoaXMsZCxmLGgsayxsKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307ZC5jPWM7ZC5uPWI7ZC5zPWE7cmV0dXJuIGR9KCk7XG5mdW5jdGlvbiBBZShhLGIsYyxkLGUpe3RoaXMuaj1hO3RoaXMuY2E9Yjt0aGlzLnN0YXJ0PWM7dGhpcy5lbmQ9ZDt0aGlzLm09ZTt0aGlzLmk9MTY2NjE3ODg3O3RoaXMucT04MTkyfWc9QWUucHJvdG90eXBlO2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O2cudT1mdW5jdGlvbihhLGIpe3JldHVybiBMYS5jKHRoaXMsYixudWxsKX07Zy5DPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm5cIm51bWJlclwiPT09dHlwZW9mIGI/RC5jKHRoaXMsYixjKTpjfTtnLko9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gMD5ifHx0aGlzLmVuZDw9dGhpcy5zdGFydCtiP2llKGIsdGhpcy5lbmQtdGhpcy5zdGFydCk6RC5hKHRoaXMuY2EsdGhpcy5zdGFydCtiKX07Zy5hYT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIDA+Ynx8dGhpcy5lbmQ8PXRoaXMuc3RhcnQrYj9jOkQuYyh0aGlzLmNhLHRoaXMuc3RhcnQrYixjKX07XG5nLlBhPWZ1bmN0aW9uKGEsYixjKXt2YXIgZD10aGlzLGU9ZC5zdGFydCtiO3JldHVybiBCZS5zP0JlLnMoZC5qLFIuYyhkLmNhLGUsYyksZC5zdGFydCxmdW5jdGlvbigpe3ZhciBhPWQuZW5kLGI9ZSsxO3JldHVybiBhPmI/YTpifSgpLG51bGwpOkJlLmNhbGwobnVsbCxkLmosUi5jKGQuY2EsZSxjKSxkLnN0YXJ0LGZ1bmN0aW9uKCl7dmFyIGE9ZC5lbmQsYj1lKzE7cmV0dXJuIGE+Yj9hOmJ9KCksbnVsbCl9O2cuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmp9O2cuTD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVuZC10aGlzLnN0YXJ0fTtnLklhPWZ1bmN0aW9uKCl7cmV0dXJuIEQuYSh0aGlzLmNhLHRoaXMuZW5kLTEpfTtcbmcuSmE9ZnVuY3Rpb24oKXtpZih0aGlzLnN0YXJ0PT09dGhpcy5lbmQpdGhyb3cgRXJyb3IoXCJDYW4ndCBwb3AgZW1wdHkgdmVjdG9yXCIpO3JldHVybiBCZS5zP0JlLnModGhpcy5qLHRoaXMuY2EsdGhpcy5zdGFydCx0aGlzLmVuZC0xLG51bGwpOkJlLmNhbGwobnVsbCx0aGlzLmosdGhpcy5jYSx0aGlzLnN0YXJ0LHRoaXMuZW5kLTEsbnVsbCl9O2cuWGE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zdGFydCE9PXRoaXMuZW5kP25ldyBrYyh0aGlzLHRoaXMuZW5kLXRoaXMuc3RhcnQtMSxudWxsKTpudWxsfTtnLkI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm07cmV0dXJuIG51bGwhPWE/YTp0aGlzLm09YT1jYyh0aGlzKX07Zy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGxjKHRoaXMsYil9O2cuST1mdW5jdGlvbigpe3JldHVybiBOKHFlLHRoaXMuail9O2cuTj1mdW5jdGlvbihhLGIpe3JldHVybiBnYy5hKHRoaXMsYil9O1xuZy5NPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gZ2MuYyh0aGlzLGIsYyl9O2cudWE9ZnVuY3Rpb24oYSxiLGMpe2lmKFwibnVtYmVyXCI9PT10eXBlb2YgYilyZXR1cm4gJGEodGhpcyxiLGMpO3Rocm93IEVycm9yKFwiU3VidmVjJ3Mga2V5IGZvciBhc3NvYyBtdXN0IGJlIGEgbnVtYmVyLlwiKTt9O2cuSD1mdW5jdGlvbigpe3ZhciBhPXRoaXM7cmV0dXJuIGZ1bmN0aW9uKGIpe3JldHVybiBmdW5jdGlvbiBkKGUpe3JldHVybiBlPT09YS5lbmQ/bnVsbDpNKEQuYShhLmNhLGUpLG5ldyBWKG51bGwsZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gZChlKzEpfX0oYiksbnVsbCxudWxsKSl9fSh0aGlzKShhLnN0YXJ0KX07Zy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIEJlLnM/QmUucyhiLHRoaXMuY2EsdGhpcy5zdGFydCx0aGlzLmVuZCx0aGlzLm0pOkJlLmNhbGwobnVsbCxiLHRoaXMuY2EsdGhpcy5zdGFydCx0aGlzLmVuZCx0aGlzLm0pfTtcbmcuRz1mdW5jdGlvbihhLGIpe3JldHVybiBCZS5zP0JlLnModGhpcy5qLCRhKHRoaXMuY2EsdGhpcy5lbmQsYiksdGhpcy5zdGFydCx0aGlzLmVuZCsxLG51bGwpOkJlLmNhbGwobnVsbCx0aGlzLmosJGEodGhpcy5jYSx0aGlzLmVuZCxiKSx0aGlzLnN0YXJ0LHRoaXMuZW5kKzEsbnVsbCl9O2cuY2FsbD1mdW5jdGlvbigpe3ZhciBhPW51bGw7cmV0dXJuIGE9ZnVuY3Rpb24oYSxjLGQpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIHRoaXMuSihudWxsLGMpO2Nhc2UgMzpyZXR1cm4gdGhpcy5hYShudWxsLGMsZCl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9fSgpO2cuYXBwbHk9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5jYWxsLmFwcGx5KHRoaXMsW3RoaXNdLmNvbmNhdCh2YShiKSkpfTtnLmI9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuSihudWxsLGEpfTtcbmcuYT1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmFhKG51bGwsYSxiKX07ZnVuY3Rpb24gQmUoYSxiLGMsZCxlKXtmb3IoOzspaWYoYiBpbnN0YW5jZW9mIEFlKWM9Yi5zdGFydCtjLGQ9Yi5zdGFydCtkLGI9Yi5jYTtlbHNle3ZhciBmPU8oYik7aWYoMD5jfHwwPmR8fGM+Znx8ZD5mKXRocm93IEVycm9yKFwiSW5kZXggb3V0IG9mIGJvdW5kc1wiKTtyZXR1cm4gbmV3IEFlKGEsYixjLGQsZSl9fVxudmFyIHplPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyl7cmV0dXJuIEJlKG51bGwsYSxiLGMsbnVsbCl9ZnVuY3Rpb24gYihhLGIpe3JldHVybiBjLmMoYSxiLE8oYSkpfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gYi5jYWxsKHRoaXMsYyxlKTtjYXNlIDM6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSxmKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5hPWI7Yy5jPWE7cmV0dXJuIGN9KCk7ZnVuY3Rpb24gQ2UoYSxiKXtyZXR1cm4gYT09PWIudD9iOm5ldyBiZShhLHZhKGIuZSkpfWZ1bmN0aW9uIHNlKGEpe3JldHVybiBuZXcgYmUoe30sdmEoYS5lKSl9XG5mdW5jdGlvbiB0ZShhKXt2YXIgYj1bbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsXTtLYyhhLDAsYiwwLGEubGVuZ3RoKTtyZXR1cm4gYn1cbnZhciBFZT1mdW5jdGlvbiBEZShiLGMsZCxlKXtkPUNlKGIucm9vdC50LGQpO3ZhciBmPWIuZy0xPj4+YyYzMTtpZig1PT09YyliPWU7ZWxzZXt2YXIgaD1kLmVbZl07Yj1udWxsIT1oP0RlKGIsYy01LGgsZSk6ZmUoYi5yb290LnQsYy01LGUpfWQuZVtmXT1iO3JldHVybiBkfSxHZT1mdW5jdGlvbiBGZShiLGMsZCl7ZD1DZShiLnJvb3QudCxkKTt2YXIgZT1iLmctMj4+PmMmMzE7aWYoNTxjKXtiPUZlKGIsYy01LGQuZVtlXSk7aWYobnVsbD09YiYmMD09PWUpcmV0dXJuIG51bGw7ZC5lW2VdPWI7cmV0dXJuIGR9cmV0dXJuIDA9PT1lP251bGw6dT8oZC5lW2VdPW51bGwsZCk6bnVsbH07ZnVuY3Rpb24gcmUoYSxiLGMsZCl7dGhpcy5nPWE7dGhpcy5zaGlmdD1iO3RoaXMucm9vdD1jO3RoaXMuUj1kO3RoaXMuaT0yNzU7dGhpcy5xPTg4fWc9cmUucHJvdG90eXBlO1xuZy5jYWxsPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbDtyZXR1cm4gYT1mdW5jdGlvbihhLGMsZCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gdGhpcy51KG51bGwsYyk7Y2FzZSAzOnJldHVybiB0aGlzLkMobnVsbCxjLGQpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fX0oKTtnLmFwcGx5PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuY2FsbC5hcHBseSh0aGlzLFt0aGlzXS5jb25jYXQodmEoYikpKX07Zy5iPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnUobnVsbCxhKX07Zy5hPWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuQyhudWxsLGEsYil9O2cudT1mdW5jdGlvbihhLGIpe3JldHVybiBMYS5jKHRoaXMsYixudWxsKX07Zy5DPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm5cIm51bWJlclwiPT09dHlwZW9mIGI/RC5jKHRoaXMsYixjKTpjfTtcbmcuSj1mdW5jdGlvbihhLGIpe2lmKHRoaXMucm9vdC50KXJldHVybiBsZSh0aGlzLGIpW2ImMzFdO3Rocm93IEVycm9yKFwibnRoIGFmdGVyIHBlcnNpc3RlbnQhXCIpO307Zy5hYT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIDA8PWImJmI8dGhpcy5nP0QuYSh0aGlzLGIpOmN9O2cuTD1mdW5jdGlvbigpe2lmKHRoaXMucm9vdC50KXJldHVybiB0aGlzLmc7dGhyb3cgRXJyb3IoXCJjb3VudCBhZnRlciBwZXJzaXN0ZW50IVwiKTt9O1xuZy5QYj1mdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcztpZihkLnJvb3QudCl7aWYoMDw9YiYmYjxkLmcpcmV0dXJuIGVlKHRoaXMpPD1iP2QuUltiJjMxXT1jOihhPWZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uIGYoYSxrKXt2YXIgbD1DZShkLnJvb3QudCxrKTtpZigwPT09YSlsLmVbYiYzMV09YztlbHNle3ZhciBuPWI+Pj5hJjMxLHE9ZihhLTUsbC5lW25dKTtsLmVbbl09cX1yZXR1cm4gbH19KHRoaXMpLmNhbGwobnVsbCxkLnNoaWZ0LGQucm9vdCksZC5yb290PWEpLHRoaXM7aWYoYj09PWQuZylyZXR1cm4gemIodGhpcyxjKTtpZih1KXRocm93IEVycm9yKFwiSW5kZXggXCIrQS5iKGIpK1wiIG91dCBvZiBib3VuZHMgZm9yIFRyYW5zaWVudFZlY3RvciBvZiBsZW5ndGhcIitBLmIoZC5nKSk7cmV0dXJuIG51bGx9dGhyb3cgRXJyb3IoXCJhc3NvYyEgYWZ0ZXIgcGVyc2lzdGVudCFcIik7fTtcbmcuUWI9ZnVuY3Rpb24oKXtpZih0aGlzLnJvb3QudCl7aWYoMD09PXRoaXMuZyl0aHJvdyBFcnJvcihcIkNhbid0IHBvcCBlbXB0eSB2ZWN0b3JcIik7aWYoMT09PXRoaXMuZylyZXR1cm4gdGhpcy5nPTAsdGhpcztpZigwPCh0aGlzLmctMSYzMSkpcmV0dXJuIHRoaXMuZy09MSx0aGlzO2lmKHUpe3ZhciBhO2E6aWYoYT10aGlzLmctMixhPj1lZSh0aGlzKSlhPXRoaXMuUjtlbHNle2Zvcih2YXIgYj10aGlzLnJvb3QsYz1iLGQ9dGhpcy5zaGlmdDs7KWlmKDA8ZCljPUNlKGIudCxjLmVbYT4+PmQmMzFdKSxkLT01O2Vsc2V7YT1jLmU7YnJlYWsgYX1hPXZvaWQgMH1iPUdlKHRoaXMsdGhpcy5zaGlmdCx0aGlzLnJvb3QpO2I9bnVsbCE9Yj9iOm5ldyBiZSh0aGlzLnJvb3QudCxbbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsXG5udWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGxdKTs1PHRoaXMuc2hpZnQmJm51bGw9PWIuZVsxXT8odGhpcy5yb290PUNlKHRoaXMucm9vdC50LGIuZVswXSksdGhpcy5zaGlmdC09NSk6dGhpcy5yb290PWI7dGhpcy5nLT0xO3RoaXMuUj1hO3JldHVybiB0aGlzfXJldHVybiBudWxsfXRocm93IEVycm9yKFwicG9wISBhZnRlciBwZXJzaXN0ZW50IVwiKTt9O2cuY2I9ZnVuY3Rpb24oYSxiLGMpe2lmKFwibnVtYmVyXCI9PT10eXBlb2YgYilyZXR1cm4gRGIodGhpcyxiLGMpO3Rocm93IEVycm9yKFwiVHJhbnNpZW50VmVjdG9yJ3Mga2V5IGZvciBhc3NvYyEgbXVzdCBiZSBhIG51bWJlci5cIik7fTtcbmcuS2E9ZnVuY3Rpb24oYSxiKXtpZih0aGlzLnJvb3QudCl7aWYoMzI+dGhpcy5nLWVlKHRoaXMpKXRoaXMuUlt0aGlzLmcmMzFdPWI7ZWxzZXt2YXIgYz1uZXcgYmUodGhpcy5yb290LnQsdGhpcy5SKSxkPVtudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGxdO2RbMF09Yjt0aGlzLlI9ZDtpZih0aGlzLmc+Pj41PjE8PHRoaXMuc2hpZnQpe3ZhciBkPVtudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGxdLGU9dGhpcy5zaGlmdCtcbjU7ZFswXT10aGlzLnJvb3Q7ZFsxXT1mZSh0aGlzLnJvb3QudCx0aGlzLnNoaWZ0LGMpO3RoaXMucm9vdD1uZXcgYmUodGhpcy5yb290LnQsZCk7dGhpcy5zaGlmdD1lfWVsc2UgdGhpcy5yb290PUVlKHRoaXMsdGhpcy5zaGlmdCx0aGlzLnJvb3QsYyl9dGhpcy5nKz0xO3JldHVybiB0aGlzfXRocm93IEVycm9yKFwiY29uaiEgYWZ0ZXIgcGVyc2lzdGVudCFcIik7fTtnLk9hPWZ1bmN0aW9uKCl7aWYodGhpcy5yb290LnQpe3RoaXMucm9vdC50PW51bGw7dmFyIGE9dGhpcy5nLWVlKHRoaXMpLGI9QXJyYXkoYSk7S2ModGhpcy5SLDAsYiwwLGEpO3JldHVybiBuZXcgVyhudWxsLHRoaXMuZyx0aGlzLnNoaWZ0LHRoaXMucm9vdCxiLG51bGwpfXRocm93IEVycm9yKFwicGVyc2lzdGVudCEgY2FsbGVkIHR3aWNlXCIpO307ZnVuY3Rpb24gSGUoYSxiLGMsZCl7dGhpcy5qPWE7dGhpcy5iYT1iO3RoaXMucGE9Yzt0aGlzLm09ZDt0aGlzLnE9MDt0aGlzLmk9MzE4NTA1NzJ9Zz1IZS5wcm90b3R5cGU7XG5nLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIExiKHRoaXMpfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5qfTtnLkI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm07cmV0dXJuIG51bGwhPWE/YTp0aGlzLm09YT1jYyh0aGlzKX07Zy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGxjKHRoaXMsYil9O2cuST1mdW5jdGlvbigpe3JldHVybiBOKEgsdGhpcy5qKX07Zy5RPWZ1bmN0aW9uKCl7cmV0dXJuIEYodGhpcy5iYSl9O2cuUz1mdW5jdGlvbigpe3ZhciBhPUkodGhpcy5iYSk7cmV0dXJuIGE/bmV3IEhlKHRoaXMuaixhLHRoaXMucGEsbnVsbCk6bnVsbD09dGhpcy5wYT9CYSh0aGlzKTpuZXcgSGUodGhpcy5qLHRoaXMucGEsbnVsbCxudWxsKX07Zy5IPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9O2cuRj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgSGUoYix0aGlzLmJhLHRoaXMucGEsdGhpcy5tKX07Zy5HPWZ1bmN0aW9uKGEsYil7cmV0dXJuIE0oYix0aGlzKX07XG5mdW5jdGlvbiBJZShhLGIsYyxkLGUpe3RoaXMuaj1hO3RoaXMuY291bnQ9Yjt0aGlzLmJhPWM7dGhpcy5wYT1kO3RoaXMubT1lO3RoaXMuaT0zMTg1ODc2Njt0aGlzLnE9ODE5Mn1nPUllLnByb3RvdHlwZTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIExiKHRoaXMpfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5qfTtnLkw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb3VudH07Zy5JYT1mdW5jdGlvbigpe3JldHVybiBGKHRoaXMuYmEpfTtnLkphPWZ1bmN0aW9uKCl7aWYocih0aGlzLmJhKSl7dmFyIGE9SSh0aGlzLmJhKTtyZXR1cm4gYT9uZXcgSWUodGhpcy5qLHRoaXMuY291bnQtMSxhLHRoaXMucGEsbnVsbCk6bmV3IEllKHRoaXMuaix0aGlzLmNvdW50LTEsRSh0aGlzLnBhKSxxZSxudWxsKX1yZXR1cm4gdGhpc307Zy5CPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tO3JldHVybiBudWxsIT1hP2E6dGhpcy5tPWE9Y2ModGhpcyl9O1xuZy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGxjKHRoaXMsYil9O2cuST1mdW5jdGlvbigpe3JldHVybiBKZX07Zy5RPWZ1bmN0aW9uKCl7cmV0dXJuIEYodGhpcy5iYSl9O2cuUz1mdW5jdGlvbigpe3JldHVybiBHKEUodGhpcykpfTtnLkg9ZnVuY3Rpb24oKXt2YXIgYT1FKHRoaXMucGEpLGI9dGhpcy5iYTtyZXR1cm4gcihyKGIpP2I6YSk/bmV3IEhlKG51bGwsdGhpcy5iYSxFKGEpLG51bGwpOm51bGx9O2cuRj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgSWUoYix0aGlzLmNvdW50LHRoaXMuYmEsdGhpcy5wYSx0aGlzLm0pfTtnLkc9ZnVuY3Rpb24oYSxiKXt2YXIgYztyKHRoaXMuYmEpPyhjPXRoaXMucGEsYz1uZXcgSWUodGhpcy5qLHRoaXMuY291bnQrMSx0aGlzLmJhLHBjLmEocihjKT9jOnFlLGIpLG51bGwpKTpjPW5ldyBJZSh0aGlzLmosdGhpcy5jb3VudCsxLHBjLmEodGhpcy5iYSxiKSxxZSxudWxsKTtyZXR1cm4gY307dmFyIEplPW5ldyBJZShudWxsLDAsbnVsbCxxZSwwKTtcbmZ1bmN0aW9uIEtlKCl7dGhpcy5xPTA7dGhpcy5pPTIwOTcxNTJ9S2UucHJvdG90eXBlLnY9ZnVuY3Rpb24oKXtyZXR1cm4hMX07dmFyIExlPW5ldyBLZTtmdW5jdGlvbiBNZShhLGIpe3JldHVybiBOYyhHYyhiKT9PKGEpPT09TyhiKT9EZChGZCxLZC5hKGZ1bmN0aW9uKGEpe3JldHVybiBXYi5hKFEuYyhiLEYoYSksTGUpLEYoSShhKSkpfSxhKSk6bnVsbDpudWxsKX1mdW5jdGlvbiBOZShhKXt0aGlzLnI9YX1OZS5wcm90b3R5cGUubmV4dD1mdW5jdGlvbigpe2lmKG51bGwhPXRoaXMucil7dmFyIGE9Rih0aGlzLnIpO3RoaXMucj1JKHRoaXMucik7cmV0dXJue2RvbmU6ITEsdmFsdWU6YX19cmV0dXJue2RvbmU6ITAsdmFsdWU6bnVsbH19O2Z1bmN0aW9uIE9lKGEpe3JldHVybiBuZXcgTmUoRShhKSl9ZnVuY3Rpb24gUGUoYSl7dGhpcy5yPWF9XG5QZS5wcm90b3R5cGUubmV4dD1mdW5jdGlvbigpe2lmKG51bGwhPXRoaXMucil7dmFyIGE9Rih0aGlzLnIpLGI9UC5jKGEsMCxudWxsKSxhPVAuYyhhLDEsbnVsbCk7dGhpcy5yPUkodGhpcy5yKTtyZXR1cm57ZG9uZTohMSx2YWx1ZTpbYixhXX19cmV0dXJue2RvbmU6ITAsdmFsdWU6bnVsbH19O2Z1bmN0aW9uIFFlKGEpe3JldHVybiBuZXcgUGUoRShhKSl9ZnVuY3Rpb24gUmUoYSl7dGhpcy5yPWF9UmUucHJvdG90eXBlLm5leHQ9ZnVuY3Rpb24oKXtpZihudWxsIT10aGlzLnIpe3ZhciBhPUYodGhpcy5yKTt0aGlzLnI9SSh0aGlzLnIpO3JldHVybntkb25lOiExLHZhbHVlOlthLGFdfX1yZXR1cm57ZG9uZTohMCx2YWx1ZTpudWxsfX07ZnVuY3Rpb24gU2UoYSl7cmV0dXJuIG5ldyBSZShFKGEpKX1cbmZ1bmN0aW9uIFRlKGEsYil7dmFyIGM9YS5lO2lmKGIgaW5zdGFuY2VvZiBUKWE6e2Zvcih2YXIgZD1jLmxlbmd0aCxlPWIuc2EsZj0wOzspe2lmKGQ8PWYpe2M9LTE7YnJlYWsgYX12YXIgaD1jW2ZdO2lmKGggaW5zdGFuY2VvZiBUJiZlPT09aC5zYSl7Yz1mO2JyZWFrIGF9aWYodSlmKz0yO2Vsc2V7Yz1udWxsO2JyZWFrIGF9fWM9dm9pZCAwfWVsc2UgaWYoXCJzdHJpbmdcIj09dHlwZW9mIGJ8fFwibnVtYmVyXCI9PT10eXBlb2YgYilhOntkPWMubGVuZ3RoO2ZvcihlPTA7Oyl7aWYoZDw9ZSl7Yz0tMTticmVhayBhfWlmKGI9PT1jW2VdKXtjPWU7YnJlYWsgYX1pZih1KWUrPTI7ZWxzZXtjPW51bGw7YnJlYWsgYX19Yz12b2lkIDB9ZWxzZSBpZihiIGluc3RhbmNlb2YgWmIpYTp7ZD1jLmxlbmd0aDtlPWIuTmE7Zm9yKGY9MDs7KXtpZihkPD1mKXtjPS0xO2JyZWFrIGF9aD1jW2ZdO2lmKGggaW5zdGFuY2VvZiBaYiYmZT09PWguTmEpe2M9ZjticmVhayBhfWlmKHUpZis9MjtlbHNle2M9bnVsbDtcbmJyZWFrIGF9fWM9dm9pZCAwfWVsc2UgaWYobnVsbD09YilhOntkPWMubGVuZ3RoO2ZvcihlPTA7Oyl7aWYoZDw9ZSl7Yz0tMTticmVhayBhfWlmKG51bGw9PWNbZV0pe2M9ZTticmVhayBhfWlmKHUpZSs9MjtlbHNle2M9bnVsbDticmVhayBhfX1jPXZvaWQgMH1lbHNlIGlmKHUpYTp7ZD1jLmxlbmd0aDtmb3IoZT0wOzspe2lmKGQ8PWUpe2M9LTE7YnJlYWsgYX1pZihXYi5hKGIsY1tlXSkpe2M9ZTticmVhayBhfWlmKHUpZSs9MjtlbHNle2M9bnVsbDticmVhayBhfX1jPXZvaWQgMH1lbHNlIGM9bnVsbDtyZXR1cm4gY31mdW5jdGlvbiBVZShhLGIsYyl7dGhpcy5lPWE7dGhpcy5wPWI7dGhpcy5XPWM7dGhpcy5xPTA7dGhpcy5pPTMyMzc0OTkwfWc9VWUucHJvdG90eXBlO2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O2cuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLld9O1xuZy5VPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucDx0aGlzLmUubGVuZ3RoLTI/bmV3IFVlKHRoaXMuZSx0aGlzLnArMix0aGlzLlcpOm51bGx9O2cuTD1mdW5jdGlvbigpe3JldHVybih0aGlzLmUubGVuZ3RoLXRoaXMucCkvMn07Zy5CPWZ1bmN0aW9uKCl7cmV0dXJuIGNjKHRoaXMpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbGModGhpcyxiKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIE4oSCx0aGlzLlcpfTtnLk49ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmMuYShiLHRoaXMpfTtnLk09ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBuYy5jKGIsYyx0aGlzKX07Zy5RPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBXKG51bGwsMiw1LFgsW3RoaXMuZVt0aGlzLnBdLHRoaXMuZVt0aGlzLnArMV1dLG51bGwpfTtnLlM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wPHRoaXMuZS5sZW5ndGgtMj9uZXcgVWUodGhpcy5lLHRoaXMucCsyLHRoaXMuVyk6SH07Zy5IPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9O1xuZy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBVZSh0aGlzLmUsdGhpcy5wLGIpfTtnLkc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTShiLHRoaXMpfTtmdW5jdGlvbiBsYShhLGIsYyxkKXt0aGlzLmo9YTt0aGlzLmc9Yjt0aGlzLmU9Yzt0aGlzLm09ZDt0aGlzLmk9MTY2NDc5NTE7dGhpcy5xPTgxOTZ9Zz1sYS5wcm90b3R5cGU7Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07Zy5rZXlzPWZ1bmN0aW9uKCl7cmV0dXJuIE9lKFZlLmI/VmUuYih0aGlzKTpWZS5jYWxsKG51bGwsdGhpcykpfTtnLmVudHJpZXM9ZnVuY3Rpb24oKXtyZXR1cm4gUWUoRSh0aGlzKSl9O2cudmFsdWVzPWZ1bmN0aW9uKCl7cmV0dXJuIE9lKFdlLmI/V2UuYih0aGlzKTpXZS5jYWxsKG51bGwsdGhpcykpfTtnLmhhcz1mdW5jdGlvbihhKXtyZXR1cm4gT2ModGhpcyxhKX07Zy5nZXQ9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMudShudWxsLGEpfTtcbmcuZm9yRWFjaD1mdW5jdGlvbihhKXtmb3IodmFyIGI9RSh0aGlzKSxjPW51bGwsZD0wLGU9MDs7KWlmKGU8ZCl7dmFyIGY9Yy5KKG51bGwsZSksaD1QLmMoZiwwLG51bGwpLGY9UC5jKGYsMSxudWxsKTthLmE/YS5hKGYsaCk6YS5jYWxsKG51bGwsZixoKTtlKz0xfWVsc2UgaWYoYj1FKGIpKUljKGIpPyhjPUhiKGIpLGI9SWIoYiksaD1jLGQ9TyhjKSxjPWgpOihjPUYoYiksaD1QLmMoYywwLG51bGwpLGY9UC5jKGMsMSxudWxsKSxhLmE/YS5hKGYsaCk6YS5jYWxsKG51bGwsZixoKSxiPUkoYiksYz1udWxsLGQ9MCksZT0wO2Vsc2UgcmV0dXJuIG51bGx9O2cudT1mdW5jdGlvbihhLGIpe3JldHVybiBMYS5jKHRoaXMsYixudWxsKX07Zy5DPWZ1bmN0aW9uKGEsYixjKXthPVRlKHRoaXMsYik7cmV0dXJuLTE9PT1hP2M6dGhpcy5lW2ErMV19O1xuZy5aYT1mdW5jdGlvbihhLGIsYyl7YT10aGlzLmUubGVuZ3RoO2Zvcih2YXIgZD0wOzspaWYoZDxhKXtjPWIuYz9iLmMoYyx0aGlzLmVbZF0sdGhpcy5lW2QrMV0pOmIuY2FsbChudWxsLGMsdGhpcy5lW2RdLHRoaXMuZVtkKzFdKTtpZihmYyhjKSlyZXR1cm4gSy5iP0suYihjKTpLLmNhbGwobnVsbCxjKTtkKz0yfWVsc2UgcmV0dXJuIGN9O2cuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmp9O2cuTD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmd9O2cuQj1mdW5jdGlvbigpe3ZhciBhPXRoaXMubTtyZXR1cm4gbnVsbCE9YT9hOnRoaXMubT1hPWRjKHRoaXMpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTWUodGhpcyxiKX07Zy5XYT1mdW5jdGlvbigpe3JldHVybiBuZXcgWGUoe30sdGhpcy5lLmxlbmd0aCx2YSh0aGlzLmUpKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIGViKFllLHRoaXMuail9O2cuTj1mdW5jdGlvbihhLGIpe3JldHVybiBuYy5hKGIsdGhpcyl9O1xuZy5NPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gbmMuYyhiLGMsdGhpcyl9O2cubmI9ZnVuY3Rpb24oYSxiKXtpZigwPD1UZSh0aGlzLGIpKXt2YXIgYz10aGlzLmUubGVuZ3RoLGQ9Yy0yO2lmKDA9PT1kKXJldHVybiBCYSh0aGlzKTtmb3IodmFyIGQ9QXJyYXkoZCksZT0wLGY9MDs7KXtpZihlPj1jKXJldHVybiBuZXcgbGEodGhpcy5qLHRoaXMuZy0xLGQsbnVsbCk7aWYoV2IuYShiLHRoaXMuZVtlXSkpZSs9MjtlbHNlIGlmKHUpZFtmXT10aGlzLmVbZV0sZFtmKzFdPXRoaXMuZVtlKzFdLGYrPTIsZSs9MjtlbHNlIHJldHVybiBudWxsfX1lbHNlIHJldHVybiB0aGlzfTtcbmcudWE9ZnVuY3Rpb24oYSxiLGMpe2E9VGUodGhpcyxiKTtpZigtMT09PWEpe2lmKHRoaXMuZzxaZSl7YT10aGlzLmU7Zm9yKHZhciBkPWEubGVuZ3RoLGU9QXJyYXkoZCsyKSxmPTA7OylpZihmPGQpZVtmXT1hW2ZdLGYrPTE7ZWxzZSBicmVhaztlW2RdPWI7ZVtkKzFdPWM7cmV0dXJuIG5ldyBsYSh0aGlzLmosdGhpcy5nKzEsZSxudWxsKX1yZXR1cm4gZWIoT2EoWWQoJGUsdGhpcyksYixjKSx0aGlzLmopfXJldHVybiBjPT09dGhpcy5lW2ErMV0/dGhpczp1PyhiPXZhKHRoaXMuZSksYlthKzFdPWMsbmV3IGxhKHRoaXMuaix0aGlzLmcsYixudWxsKSk6bnVsbH07Zy5rYj1mdW5jdGlvbihhLGIpe3JldHVybi0xIT09VGUodGhpcyxiKX07Zy5IPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5lO3JldHVybiAwPD1hLmxlbmd0aC0yP25ldyBVZShhLDAsbnVsbCk6bnVsbH07Zy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBsYShiLHRoaXMuZyx0aGlzLmUsdGhpcy5tKX07XG5nLkc9ZnVuY3Rpb24oYSxiKXtpZihIYyhiKSlyZXR1cm4gT2EodGhpcyxELmEoYiwwKSxELmEoYiwxKSk7Zm9yKHZhciBjPXRoaXMsZD1FKGIpOzspe2lmKG51bGw9PWQpcmV0dXJuIGM7dmFyIGU9RihkKTtpZihIYyhlKSljPU9hKGMsRC5hKGUsMCksRC5hKGUsMSkpLGQ9SShkKTtlbHNlIHRocm93IEVycm9yKFwiY29uaiBvbiBhIG1hcCB0YWtlcyBtYXAgZW50cmllcyBvciBzZXFhYmxlcyBvZiBtYXAgZW50cmllc1wiKTt9fTtnLmNhbGw9ZnVuY3Rpb24oKXt2YXIgYT1udWxsO3JldHVybiBhPWZ1bmN0aW9uKGEsYyxkKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiB0aGlzLnUobnVsbCxjKTtjYXNlIDM6cmV0dXJuIHRoaXMuQyhudWxsLGMsZCl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9fSgpO2cuYXBwbHk9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5jYWxsLmFwcGx5KHRoaXMsW3RoaXNdLmNvbmNhdCh2YShiKSkpfTtcbmcuYj1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy51KG51bGwsYSl9O2cuYT1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLkMobnVsbCxhLGIpfTt2YXIgWWU9bmV3IGxhKG51bGwsMCxbXSxudWxsKSxaZT04O2Z1bmN0aW9uIGFmKGEpe2Zvcih2YXIgYj1hLmxlbmd0aCxjPTAsZD15YihZZSk7OylpZihjPGIpdmFyIGU9YysyLGQ9QmIoZCxhW2NdLGFbYysxXSksYz1lO2Vsc2UgcmV0dXJuIEFiKGQpfWZ1bmN0aW9uIFhlKGEsYixjKXt0aGlzLlJhPWE7dGhpcy5qYT1iO3RoaXMuZT1jO3RoaXMucT01Njt0aGlzLmk9MjU4fWc9WGUucHJvdG90eXBlO1xuZy5BYj1mdW5jdGlvbihhLGIpe2lmKHIodGhpcy5SYSkpe3ZhciBjPVRlKHRoaXMsYik7MDw9YyYmKHRoaXMuZVtjXT10aGlzLmVbdGhpcy5qYS0yXSx0aGlzLmVbYysxXT10aGlzLmVbdGhpcy5qYS0xXSxjPXRoaXMuZSxjLnBvcCgpLGMucG9wKCksdGhpcy5qYS09Mik7cmV0dXJuIHRoaXN9dGhyb3cgRXJyb3IoXCJkaXNzb2MhIGFmdGVyIHBlcnNpc3RlbnQhXCIpO307Zy5jYj1mdW5jdGlvbihhLGIsYyl7aWYocih0aGlzLlJhKSl7YT1UZSh0aGlzLGIpO2lmKC0xPT09YSlyZXR1cm4gdGhpcy5qYSsyPD0yKlplPyh0aGlzLmphKz0yLHRoaXMuZS5wdXNoKGIpLHRoaXMuZS5wdXNoKGMpLHRoaXMpOnhkLmMoYmYuYT9iZi5hKHRoaXMuamEsdGhpcy5lKTpiZi5jYWxsKG51bGwsdGhpcy5qYSx0aGlzLmUpLGIsYyk7YyE9PXRoaXMuZVthKzFdJiYodGhpcy5lW2ErMV09Yyk7cmV0dXJuIHRoaXN9dGhyb3cgRXJyb3IoXCJhc3NvYyEgYWZ0ZXIgcGVyc2lzdGVudCFcIik7fTtcbmcuS2E9ZnVuY3Rpb24oYSxiKXtpZihyKHRoaXMuUmEpKXtpZihiP2IuaSYyMDQ4fHxiLmRjfHwoYi5pPzA6cyhTYSxiKSk6cyhTYSxiKSlyZXR1cm4gQmIodGhpcyxjZi5iP2NmLmIoYik6Y2YuY2FsbChudWxsLGIpLGRmLmI/ZGYuYihiKTpkZi5jYWxsKG51bGwsYikpO2Zvcih2YXIgYz1FKGIpLGQ9dGhpczs7KXt2YXIgZT1GKGMpO2lmKHIoZSkpYz1JKGMpLGQ9QmIoZCxjZi5iP2NmLmIoZSk6Y2YuY2FsbChudWxsLGUpLGRmLmI/ZGYuYihlKTpkZi5jYWxsKG51bGwsZSkpO2Vsc2UgcmV0dXJuIGR9fWVsc2UgdGhyb3cgRXJyb3IoXCJjb25qISBhZnRlciBwZXJzaXN0ZW50IVwiKTt9O2cuT2E9ZnVuY3Rpb24oKXtpZihyKHRoaXMuUmEpKXJldHVybiB0aGlzLlJhPSExLG5ldyBsYShudWxsLFljKHRoaXMuamEpLHRoaXMuZSxudWxsKTt0aHJvdyBFcnJvcihcInBlcnNpc3RlbnQhIGNhbGxlZCB0d2ljZVwiKTt9O2cudT1mdW5jdGlvbihhLGIpe3JldHVybiBMYS5jKHRoaXMsYixudWxsKX07XG5nLkM9ZnVuY3Rpb24oYSxiLGMpe2lmKHIodGhpcy5SYSkpcmV0dXJuIGE9VGUodGhpcyxiKSwtMT09PWE/Yzp0aGlzLmVbYSsxXTt0aHJvdyBFcnJvcihcImxvb2t1cCBhZnRlciBwZXJzaXN0ZW50IVwiKTt9O2cuTD1mdW5jdGlvbigpe2lmKHIodGhpcy5SYSkpcmV0dXJuIFljKHRoaXMuamEpO3Rocm93IEVycm9yKFwiY291bnQgYWZ0ZXIgcGVyc2lzdGVudCFcIik7fTtmdW5jdGlvbiBiZihhLGIpe2Zvcih2YXIgYz15YigkZSksZD0wOzspaWYoZDxhKWM9eGQuYyhjLGJbZF0sYltkKzFdKSxkKz0yO2Vsc2UgcmV0dXJuIGN9ZnVuY3Rpb24gZWYoKXt0aGlzLmw9ITF9ZnVuY3Rpb24gZmYoYSxiKXtyZXR1cm4gYT09PWI/ITA6aGQoYSxiKT8hMDp1P1diLmEoYSxiKTpudWxsfVxudmFyIGdmPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyxoLGspe2E9dmEoYSk7YVtiXT1jO2FbaF09aztyZXR1cm4gYX1mdW5jdGlvbiBiKGEsYixjKXthPXZhKGEpO2FbYl09YztyZXR1cm4gYX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlLGYsaCxrKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAzOnJldHVybiBiLmNhbGwodGhpcyxjLGUsZik7Y2FzZSA1OnJldHVybiBhLmNhbGwodGhpcyxjLGUsZixoLGspfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmM9YjtjLnM9YTtyZXR1cm4gY30oKTtmdW5jdGlvbiBoZihhLGIpe3ZhciBjPUFycmF5KGEubGVuZ3RoLTIpO0tjKGEsMCxjLDAsMipiKTtLYyhhLDIqKGIrMSksYywyKmIsYy5sZW5ndGgtMipiKTtyZXR1cm4gY31cbnZhciBqZj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMsaCxrLGwpe2E9YS5MYShiKTthLmVbY109aDthLmVba109bDtyZXR1cm4gYX1mdW5jdGlvbiBiKGEsYixjLGgpe2E9YS5MYShiKTthLmVbY109aDtyZXR1cm4gYX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlLGYsaCxrLGwpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDQ6cmV0dXJuIGIuY2FsbCh0aGlzLGMsZSxmLGgpO2Nhc2UgNjpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlLGYsaCxrLGwpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLm49YjtjLlg9YTtyZXR1cm4gY30oKTtcbmZ1bmN0aW9uIGtmKGEsYixjKXtmb3IodmFyIGQ9YS5sZW5ndGgsZT0wOzspaWYoZTxkKXt2YXIgZj1hW2VdO251bGwhPWY/Yz1iLmM/Yi5jKGMsZixhW2UrMV0pOmIuY2FsbChudWxsLGMsZixhW2UrMV0pOihmPWFbZSsxXSxjPW51bGwhPWY/Zi5UYShiLGMpOmMpO2lmKGZjKGMpKXJldHVybiBLLmI/Sy5iKGMpOksuY2FsbChudWxsLGMpO2UrPTJ9ZWxzZSByZXR1cm4gY31mdW5jdGlvbiBsZihhLGIsYyl7dGhpcy50PWE7dGhpcy5BPWI7dGhpcy5lPWN9Zz1sZi5wcm90b3R5cGU7Zy5MYT1mdW5jdGlvbihhKXtpZihhPT09dGhpcy50KXJldHVybiB0aGlzO3ZhciBiPVpjKHRoaXMuQSksYz1BcnJheSgwPmI/NDoyKihiKzEpKTtLYyh0aGlzLmUsMCxjLDAsMipiKTtyZXR1cm4gbmV3IGxmKGEsdGhpcy5BLGMpfTtcbmcuZ2I9ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZj0xPDwoYz4+PmImMzEpO2lmKDA9PT0odGhpcy5BJmYpKXJldHVybiB0aGlzO3ZhciBoPVpjKHRoaXMuQSZmLTEpLGs9dGhpcy5lWzIqaF0sbD10aGlzLmVbMipoKzFdO3JldHVybiBudWxsPT1rPyhiPWwuZ2IoYSxiKzUsYyxkLGUpLGI9PT1sP3RoaXM6bnVsbCE9Yj9qZi5uKHRoaXMsYSwyKmgrMSxiKTp0aGlzLkE9PT1mP251bGw6dT9tZih0aGlzLGEsZixoKTpudWxsKTpmZihkLGspPyhlWzBdPSEwLG1mKHRoaXMsYSxmLGgpKTp1P3RoaXM6bnVsbH07ZnVuY3Rpb24gbWYoYSxiLGMsZCl7aWYoYS5BPT09YylyZXR1cm4gbnVsbDthPWEuTGEoYik7Yj1hLmU7dmFyIGU9Yi5sZW5ndGg7YS5BXj1jO0tjKGIsMiooZCsxKSxiLDIqZCxlLTIqKGQrMSkpO2JbZS0yXT1udWxsO2JbZS0xXT1udWxsO3JldHVybiBhfWcuZWI9ZnVuY3Rpb24oKXtyZXR1cm4gbmYuYj9uZi5iKHRoaXMuZSk6bmYuY2FsbChudWxsLHRoaXMuZSl9O1xuZy5UYT1mdW5jdGlvbihhLGIpe3JldHVybiBrZih0aGlzLmUsYSxiKX07Zy5NYT1mdW5jdGlvbihhLGIsYyxkKXt2YXIgZT0xPDwoYj4+PmEmMzEpO2lmKDA9PT0odGhpcy5BJmUpKXJldHVybiBkO3ZhciBmPVpjKHRoaXMuQSZlLTEpLGU9dGhpcy5lWzIqZl0sZj10aGlzLmVbMipmKzFdO3JldHVybiBudWxsPT1lP2YuTWEoYSs1LGIsYyxkKTpmZihjLGUpP2Y6dT9kOm51bGx9O1xuZy5pYT1mdW5jdGlvbihhLGIsYyxkLGUsZil7dmFyIGg9MTw8KGM+Pj5iJjMxKSxrPVpjKHRoaXMuQSZoLTEpO2lmKDA9PT0odGhpcy5BJmgpKXt2YXIgbD1aYyh0aGlzLkEpO2lmKDIqbDx0aGlzLmUubGVuZ3RoKXthPXRoaXMuTGEoYSk7Yj1hLmU7Zi5sPSEwO2E6Zm9yKGM9MioobC1rKSxmPTIqaysoYy0xKSxsPTIqKGsrMSkrKGMtMSk7Oyl7aWYoMD09PWMpYnJlYWsgYTtiW2xdPWJbZl07bC09MTtjLT0xO2YtPTF9YlsyKmtdPWQ7YlsyKmsrMV09ZTthLkF8PWg7cmV0dXJuIGF9aWYoMTY8PWwpe2s9W251bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbF07a1tjPj4+YiYzMV09b2YuaWEoYSxiKzUsYyxkLGUsZik7Zm9yKGU9ZD0wOzspaWYoMzI+ZCkwIT09XG4odGhpcy5BPj4+ZCYxKSYmKGtbZF09bnVsbCE9dGhpcy5lW2VdP29mLmlhKGEsYis1LFRiKHRoaXMuZVtlXSksdGhpcy5lW2VdLHRoaXMuZVtlKzFdLGYpOnRoaXMuZVtlKzFdLGUrPTIpLGQrPTE7ZWxzZSBicmVhaztyZXR1cm4gbmV3IHBmKGEsbCsxLGspfXJldHVybiB1PyhiPUFycmF5KDIqKGwrNCkpLEtjKHRoaXMuZSwwLGIsMCwyKmspLGJbMiprXT1kLGJbMiprKzFdPWUsS2ModGhpcy5lLDIqayxiLDIqKGsrMSksMioobC1rKSksZi5sPSEwLGE9dGhpcy5MYShhKSxhLmU9YixhLkF8PWgsYSk6bnVsbH1sPXRoaXMuZVsyKmtdO2g9dGhpcy5lWzIqaysxXTtyZXR1cm4gbnVsbD09bD8obD1oLmlhKGEsYis1LGMsZCxlLGYpLGw9PT1oP3RoaXM6amYubih0aGlzLGEsMiprKzEsbCkpOmZmKGQsbCk/ZT09PWg/dGhpczpqZi5uKHRoaXMsYSwyKmsrMSxlKTp1PyhmLmw9ITAsamYuWCh0aGlzLGEsMiprLG51bGwsMiprKzEscWYuZ2E/cWYuZ2EoYSxiKzUsbCxoLGMsZCxlKTpxZi5jYWxsKG51bGwsXG5hLGIrNSxsLGgsYyxkLGUpKSk6bnVsbH07XG5nLmhhPWZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGY9MTw8KGI+Pj5hJjMxKSxoPVpjKHRoaXMuQSZmLTEpO2lmKDA9PT0odGhpcy5BJmYpKXt2YXIgaz1aYyh0aGlzLkEpO2lmKDE2PD1rKXtoPVtudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGxdO2hbYj4+PmEmMzFdPW9mLmhhKGErNSxiLGMsZCxlKTtmb3IoZD1jPTA7OylpZigzMj5jKTAhPT0odGhpcy5BPj4+YyYxKSYmKGhbY109bnVsbCE9dGhpcy5lW2RdP29mLmhhKGErNSxUYih0aGlzLmVbZF0pLHRoaXMuZVtkXSx0aGlzLmVbZCsxXSxlKTp0aGlzLmVbZCsxXSxkKz0yKSxjKz0xO2Vsc2UgYnJlYWs7cmV0dXJuIG5ldyBwZihudWxsLGsrMSxoKX1hPUFycmF5KDIqKGsrMSkpO0tjKHRoaXMuZSxcbjAsYSwwLDIqaCk7YVsyKmhdPWM7YVsyKmgrMV09ZDtLYyh0aGlzLmUsMipoLGEsMiooaCsxKSwyKihrLWgpKTtlLmw9ITA7cmV0dXJuIG5ldyBsZihudWxsLHRoaXMuQXxmLGEpfWs9dGhpcy5lWzIqaF07Zj10aGlzLmVbMipoKzFdO3JldHVybiBudWxsPT1rPyhrPWYuaGEoYSs1LGIsYyxkLGUpLGs9PT1mP3RoaXM6bmV3IGxmKG51bGwsdGhpcy5BLGdmLmModGhpcy5lLDIqaCsxLGspKSk6ZmYoYyxrKT9kPT09Zj90aGlzOm5ldyBsZihudWxsLHRoaXMuQSxnZi5jKHRoaXMuZSwyKmgrMSxkKSk6dT8oZS5sPSEwLG5ldyBsZihudWxsLHRoaXMuQSxnZi5zKHRoaXMuZSwyKmgsbnVsbCwyKmgrMSxxZi5YP3FmLlgoYSs1LGssZixiLGMsZCk6cWYuY2FsbChudWxsLGErNSxrLGYsYixjLGQpKSkpOm51bGx9O1xuZy5mYj1mdW5jdGlvbihhLGIsYyl7dmFyIGQ9MTw8KGI+Pj5hJjMxKTtpZigwPT09KHRoaXMuQSZkKSlyZXR1cm4gdGhpczt2YXIgZT1aYyh0aGlzLkEmZC0xKSxmPXRoaXMuZVsyKmVdLGg9dGhpcy5lWzIqZSsxXTtyZXR1cm4gbnVsbD09Zj8oYT1oLmZiKGErNSxiLGMpLGE9PT1oP3RoaXM6bnVsbCE9YT9uZXcgbGYobnVsbCx0aGlzLkEsZ2YuYyh0aGlzLmUsMiplKzEsYSkpOnRoaXMuQT09PWQ/bnVsbDp1P25ldyBsZihudWxsLHRoaXMuQV5kLGhmKHRoaXMuZSxlKSk6bnVsbCk6ZmYoYyxmKT9uZXcgbGYobnVsbCx0aGlzLkFeZCxoZih0aGlzLmUsZSkpOnU/dGhpczpudWxsfTt2YXIgb2Y9bmV3IGxmKG51bGwsMCxbXSk7XG5mdW5jdGlvbiByZihhLGIsYyl7dmFyIGQ9YS5lO2E9MiooYS5nLTEpO2Zvcih2YXIgZT1BcnJheShhKSxmPTAsaD0xLGs9MDs7KWlmKGY8YSlmIT09YyYmbnVsbCE9ZFtmXSYmKGVbaF09ZFtmXSxoKz0yLGt8PTE8PGYpLGYrPTE7ZWxzZSByZXR1cm4gbmV3IGxmKGIsayxlKX1mdW5jdGlvbiBwZihhLGIsYyl7dGhpcy50PWE7dGhpcy5nPWI7dGhpcy5lPWN9Zz1wZi5wcm90b3R5cGU7Zy5MYT1mdW5jdGlvbihhKXtyZXR1cm4gYT09PXRoaXMudD90aGlzOm5ldyBwZihhLHRoaXMuZyx2YSh0aGlzLmUpKX07XG5nLmdiPWZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGY9Yz4+PmImMzEsaD10aGlzLmVbZl07aWYobnVsbD09aClyZXR1cm4gdGhpcztiPWguZ2IoYSxiKzUsYyxkLGUpO2lmKGI9PT1oKXJldHVybiB0aGlzO2lmKG51bGw9PWIpe2lmKDg+PXRoaXMuZylyZXR1cm4gcmYodGhpcyxhLGYpO2E9amYubih0aGlzLGEsZixiKTthLmctPTE7cmV0dXJuIGF9cmV0dXJuIHU/amYubih0aGlzLGEsZixiKTpudWxsfTtnLmViPWZ1bmN0aW9uKCl7cmV0dXJuIHNmLmI/c2YuYih0aGlzLmUpOnNmLmNhbGwobnVsbCx0aGlzLmUpfTtnLlRhPWZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPXRoaXMuZS5sZW5ndGgsZD0wLGU9Yjs7KWlmKGQ8Yyl7dmFyIGY9dGhpcy5lW2RdO2lmKG51bGwhPWYmJihlPWYuVGEoYSxlKSxmYyhlKSkpcmV0dXJuIEsuYj9LLmIoZSk6Sy5jYWxsKG51bGwsZSk7ZCs9MX1lbHNlIHJldHVybiBlfTtcbmcuTWE9ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9dGhpcy5lW2I+Pj5hJjMxXTtyZXR1cm4gbnVsbCE9ZT9lLk1hKGErNSxiLGMsZCk6ZH07Zy5pYT1mdW5jdGlvbihhLGIsYyxkLGUsZil7dmFyIGg9Yz4+PmImMzEsaz10aGlzLmVbaF07aWYobnVsbD09aylyZXR1cm4gYT1qZi5uKHRoaXMsYSxoLG9mLmlhKGEsYis1LGMsZCxlLGYpKSxhLmcrPTEsYTtiPWsuaWEoYSxiKzUsYyxkLGUsZik7cmV0dXJuIGI9PT1rP3RoaXM6amYubih0aGlzLGEsaCxiKX07Zy5oYT1mdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmPWI+Pj5hJjMxLGg9dGhpcy5lW2ZdO2lmKG51bGw9PWgpcmV0dXJuIG5ldyBwZihudWxsLHRoaXMuZysxLGdmLmModGhpcy5lLGYsb2YuaGEoYSs1LGIsYyxkLGUpKSk7YT1oLmhhKGErNSxiLGMsZCxlKTtyZXR1cm4gYT09PWg/dGhpczpuZXcgcGYobnVsbCx0aGlzLmcsZ2YuYyh0aGlzLmUsZixhKSl9O1xuZy5mYj1mdW5jdGlvbihhLGIsYyl7dmFyIGQ9Yj4+PmEmMzEsZT10aGlzLmVbZF07cmV0dXJuIG51bGwhPWU/KGE9ZS5mYihhKzUsYixjKSxhPT09ZT90aGlzOm51bGw9PWE/OD49dGhpcy5nP3JmKHRoaXMsbnVsbCxkKTpuZXcgcGYobnVsbCx0aGlzLmctMSxnZi5jKHRoaXMuZSxkLGEpKTp1P25ldyBwZihudWxsLHRoaXMuZyxnZi5jKHRoaXMuZSxkLGEpKTpudWxsKTp0aGlzfTtmdW5jdGlvbiB0ZihhLGIsYyl7Yio9Mjtmb3IodmFyIGQ9MDs7KWlmKGQ8Yil7aWYoZmYoYyxhW2RdKSlyZXR1cm4gZDtkKz0yfWVsc2UgcmV0dXJuLTF9ZnVuY3Rpb24gdWYoYSxiLGMsZCl7dGhpcy50PWE7dGhpcy5yYT1iO3RoaXMuZz1jO3RoaXMuZT1kfWc9dWYucHJvdG90eXBlO1xuZy5MYT1mdW5jdGlvbihhKXtpZihhPT09dGhpcy50KXJldHVybiB0aGlzO3ZhciBiPUFycmF5KDIqKHRoaXMuZysxKSk7S2ModGhpcy5lLDAsYiwwLDIqdGhpcy5nKTtyZXR1cm4gbmV3IHVmKGEsdGhpcy5yYSx0aGlzLmcsYil9O2cuZ2I9ZnVuY3Rpb24oYSxiLGMsZCxlKXtiPXRmKHRoaXMuZSx0aGlzLmcsZCk7aWYoLTE9PT1iKXJldHVybiB0aGlzO2VbMF09ITA7aWYoMT09PXRoaXMuZylyZXR1cm4gbnVsbDthPXRoaXMuTGEoYSk7ZT1hLmU7ZVtiXT1lWzIqdGhpcy5nLTJdO2VbYisxXT1lWzIqdGhpcy5nLTFdO2VbMip0aGlzLmctMV09bnVsbDtlWzIqdGhpcy5nLTJdPW51bGw7YS5nLT0xO3JldHVybiBhfTtnLmViPWZ1bmN0aW9uKCl7cmV0dXJuIG5mLmI/bmYuYih0aGlzLmUpOm5mLmNhbGwobnVsbCx0aGlzLmUpfTtnLlRhPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGtmKHRoaXMuZSxhLGIpfTtcbmcuTWE9ZnVuY3Rpb24oYSxiLGMsZCl7YT10Zih0aGlzLmUsdGhpcy5nLGMpO3JldHVybiAwPmE/ZDpmZihjLHRoaXMuZVthXSk/dGhpcy5lW2ErMV06dT9kOm51bGx9O1xuZy5pYT1mdW5jdGlvbihhLGIsYyxkLGUsZil7aWYoYz09PXRoaXMucmEpe2I9dGYodGhpcy5lLHRoaXMuZyxkKTtpZigtMT09PWIpe2lmKHRoaXMuZS5sZW5ndGg+Mip0aGlzLmcpcmV0dXJuIGE9amYuWCh0aGlzLGEsMip0aGlzLmcsZCwyKnRoaXMuZysxLGUpLGYubD0hMCxhLmcrPTEsYTtjPXRoaXMuZS5sZW5ndGg7Yj1BcnJheShjKzIpO0tjKHRoaXMuZSwwLGIsMCxjKTtiW2NdPWQ7YltjKzFdPWU7Zi5sPSEwO2Y9dGhpcy5nKzE7YT09PXRoaXMudD8odGhpcy5lPWIsdGhpcy5nPWYsYT10aGlzKTphPW5ldyB1Zih0aGlzLnQsdGhpcy5yYSxmLGIpO3JldHVybiBhfXJldHVybiB0aGlzLmVbYisxXT09PWU/dGhpczpqZi5uKHRoaXMsYSxiKzEsZSl9cmV0dXJuKG5ldyBsZihhLDE8PCh0aGlzLnJhPj4+YiYzMSksW251bGwsdGhpcyxudWxsLG51bGxdKSkuaWEoYSxiLGMsZCxlLGYpfTtcbmcuaGE9ZnVuY3Rpb24oYSxiLGMsZCxlKXtyZXR1cm4gYj09PXRoaXMucmE/KGE9dGYodGhpcy5lLHRoaXMuZyxjKSwtMT09PWE/KGE9Mip0aGlzLmcsYj1BcnJheShhKzIpLEtjKHRoaXMuZSwwLGIsMCxhKSxiW2FdPWMsYlthKzFdPWQsZS5sPSEwLG5ldyB1ZihudWxsLHRoaXMucmEsdGhpcy5nKzEsYikpOldiLmEodGhpcy5lW2FdLGQpP3RoaXM6bmV3IHVmKG51bGwsdGhpcy5yYSx0aGlzLmcsZ2YuYyh0aGlzLmUsYSsxLGQpKSk6KG5ldyBsZihudWxsLDE8PCh0aGlzLnJhPj4+YSYzMSksW251bGwsdGhpc10pKS5oYShhLGIsYyxkLGUpfTtnLmZiPWZ1bmN0aW9uKGEsYixjKXthPXRmKHRoaXMuZSx0aGlzLmcsYyk7cmV0dXJuLTE9PT1hP3RoaXM6MT09PXRoaXMuZz9udWxsOnU/bmV3IHVmKG51bGwsdGhpcy5yYSx0aGlzLmctMSxoZih0aGlzLmUsWWMoYSkpKTpudWxsfTtcbnZhciBxZj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMsaCxrLGwsbil7dmFyIHE9VGIoYyk7aWYocT09PWspcmV0dXJuIG5ldyB1ZihudWxsLHEsMixbYyxoLGwsbl0pO3ZhciB0PW5ldyBlZjtyZXR1cm4gb2YuaWEoYSxiLHEsYyxoLHQpLmlhKGEsYixrLGwsbix0KX1mdW5jdGlvbiBiKGEsYixjLGgsayxsKXt2YXIgbj1UYihiKTtpZihuPT09aClyZXR1cm4gbmV3IHVmKG51bGwsbiwyLFtiLGMsayxsXSk7dmFyIHE9bmV3IGVmO3JldHVybiBvZi5oYShhLG4sYixjLHEpLmhhKGEsaCxrLGwscSl9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSxmLGgsayxsLG4pe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDY6cmV0dXJuIGIuY2FsbCh0aGlzLGMsZSxmLGgsayxsKTtjYXNlIDc6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSxmLGgsayxsLG4pfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLlg9YjtjLmdhPWE7cmV0dXJuIGN9KCk7XG5mdW5jdGlvbiB2ZihhLGIsYyxkLGUpe3RoaXMuaj1hO3RoaXMua2E9Yjt0aGlzLnA9Yzt0aGlzLnI9ZDt0aGlzLm09ZTt0aGlzLnE9MDt0aGlzLmk9MzIzNzQ4NjB9Zz12Zi5wcm90b3R5cGU7Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07Zy5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuan07Zy5CPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tO3JldHVybiBudWxsIT1hP2E6dGhpcy5tPWE9Y2ModGhpcyl9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBsYyh0aGlzLGIpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gTihILHRoaXMuail9O2cuTj1mdW5jdGlvbihhLGIpe3JldHVybiBuYy5hKGIsdGhpcyl9O2cuTT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIG5jLmMoYixjLHRoaXMpfTtnLlE9ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbD09dGhpcy5yP25ldyBXKG51bGwsMiw1LFgsW3RoaXMua2FbdGhpcy5wXSx0aGlzLmthW3RoaXMucCsxXV0sbnVsbCk6Rih0aGlzLnIpfTtcbmcuUz1mdW5jdGlvbigpe3JldHVybiBudWxsPT10aGlzLnI/bmYuYz9uZi5jKHRoaXMua2EsdGhpcy5wKzIsbnVsbCk6bmYuY2FsbChudWxsLHRoaXMua2EsdGhpcy5wKzIsbnVsbCk6bmYuYz9uZi5jKHRoaXMua2EsdGhpcy5wLEkodGhpcy5yKSk6bmYuY2FsbChudWxsLHRoaXMua2EsdGhpcy5wLEkodGhpcy5yKSl9O2cuSD1mdW5jdGlvbigpe3JldHVybiB0aGlzfTtnLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IHZmKGIsdGhpcy5rYSx0aGlzLnAsdGhpcy5yLHRoaXMubSl9O2cuRz1mdW5jdGlvbihhLGIpe3JldHVybiBNKGIsdGhpcyl9O1xudmFyIG5mPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyl7aWYobnVsbD09Yylmb3IoYz1hLmxlbmd0aDs7KWlmKGI8Yyl7aWYobnVsbCE9YVtiXSlyZXR1cm4gbmV3IHZmKG51bGwsYSxiLG51bGwsbnVsbCk7dmFyIGg9YVtiKzFdO2lmKHIoaCkmJihoPWguZWIoKSxyKGgpKSlyZXR1cm4gbmV3IHZmKG51bGwsYSxiKzIsaCxudWxsKTtiKz0yfWVsc2UgcmV0dXJuIG51bGw7ZWxzZSByZXR1cm4gbmV3IHZmKG51bGwsYSxiLGMsbnVsbCl9ZnVuY3Rpb24gYihhKXtyZXR1cm4gYy5jKGEsMCxudWxsKX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGIuY2FsbCh0aGlzLGMpO2Nhc2UgMzpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlLGYpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmI9YjtjLmM9YTtyZXR1cm4gY30oKTtcbmZ1bmN0aW9uIHdmKGEsYixjLGQsZSl7dGhpcy5qPWE7dGhpcy5rYT1iO3RoaXMucD1jO3RoaXMucj1kO3RoaXMubT1lO3RoaXMucT0wO3RoaXMuaT0zMjM3NDg2MH1nPXdmLnByb3RvdHlwZTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIExiKHRoaXMpfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5qfTtnLkI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm07cmV0dXJuIG51bGwhPWE/YTp0aGlzLm09YT1jYyh0aGlzKX07Zy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGxjKHRoaXMsYil9O2cuST1mdW5jdGlvbigpe3JldHVybiBOKEgsdGhpcy5qKX07Zy5OPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5jLmEoYix0aGlzKX07Zy5NPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gbmMuYyhiLGMsdGhpcyl9O2cuUT1mdW5jdGlvbigpe3JldHVybiBGKHRoaXMucil9O1xuZy5TPWZ1bmN0aW9uKCl7cmV0dXJuIHNmLm4/c2YubihudWxsLHRoaXMua2EsdGhpcy5wLEkodGhpcy5yKSk6c2YuY2FsbChudWxsLG51bGwsdGhpcy5rYSx0aGlzLnAsSSh0aGlzLnIpKX07Zy5IPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9O2cuRj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgd2YoYix0aGlzLmthLHRoaXMucCx0aGlzLnIsdGhpcy5tKX07Zy5HPWZ1bmN0aW9uKGEsYil7cmV0dXJuIE0oYix0aGlzKX07XG52YXIgc2Y9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjLGgpe2lmKG51bGw9PWgpZm9yKGg9Yi5sZW5ndGg7OylpZihjPGgpe3ZhciBrPWJbY107aWYocihrKSYmKGs9ay5lYigpLHIoaykpKXJldHVybiBuZXcgd2YoYSxiLGMrMSxrLG51bGwpO2MrPTF9ZWxzZSByZXR1cm4gbnVsbDtlbHNlIHJldHVybiBuZXcgd2YoYSxiLGMsaCxudWxsKX1mdW5jdGlvbiBiKGEpe3JldHVybiBjLm4obnVsbCxhLDAsbnVsbCl9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSxmLGgpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGIuY2FsbCh0aGlzLGMpO2Nhc2UgNDpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlLGYsaCl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYj1iO2Mubj1hO3JldHVybiBjfSgpO1xuZnVuY3Rpb24geGYoYSxiLGMsZCxlLGYpe3RoaXMuaj1hO3RoaXMuZz1iO3RoaXMucm9vdD1jO3RoaXMuVD1kO3RoaXMuWT1lO3RoaXMubT1mO3RoaXMuaT0xNjEyMzY2Mzt0aGlzLnE9ODE5Nn1nPXhmLnByb3RvdHlwZTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIExiKHRoaXMpfTtnLmtleXM9ZnVuY3Rpb24oKXtyZXR1cm4gT2UoVmUuYj9WZS5iKHRoaXMpOlZlLmNhbGwobnVsbCx0aGlzKSl9O2cuZW50cmllcz1mdW5jdGlvbigpe3JldHVybiBRZShFKHRoaXMpKX07Zy52YWx1ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gT2UoV2UuYj9XZS5iKHRoaXMpOldlLmNhbGwobnVsbCx0aGlzKSl9O2cuaGFzPWZ1bmN0aW9uKGEpe3JldHVybiBPYyh0aGlzLGEpfTtnLmdldD1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy51KG51bGwsYSl9O1xuZy5mb3JFYWNoPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1FKHRoaXMpLGM9bnVsbCxkPTAsZT0wOzspaWYoZTxkKXt2YXIgZj1jLkoobnVsbCxlKSxoPVAuYyhmLDAsbnVsbCksZj1QLmMoZiwxLG51bGwpO2EuYT9hLmEoZixoKTphLmNhbGwobnVsbCxmLGgpO2UrPTF9ZWxzZSBpZihiPUUoYikpSWMoYik/KGM9SGIoYiksYj1JYihiKSxoPWMsZD1PKGMpLGM9aCk6KGM9RihiKSxoPVAuYyhjLDAsbnVsbCksZj1QLmMoYywxLG51bGwpLGEuYT9hLmEoZixoKTphLmNhbGwobnVsbCxmLGgpLGI9SShiKSxjPW51bGwsZD0wKSxlPTA7ZWxzZSByZXR1cm4gbnVsbH07Zy51PWZ1bmN0aW9uKGEsYil7cmV0dXJuIExhLmModGhpcyxiLG51bGwpfTtnLkM9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBudWxsPT1iP3RoaXMuVD90aGlzLlk6YzpudWxsPT10aGlzLnJvb3Q/Yzp1P3RoaXMucm9vdC5NYSgwLFRiKGIpLGIsYyk6bnVsbH07XG5nLlphPWZ1bmN0aW9uKGEsYixjKXthPXRoaXMuVD9iLmM/Yi5jKGMsbnVsbCx0aGlzLlkpOmIuY2FsbChudWxsLGMsbnVsbCx0aGlzLlkpOmM7cmV0dXJuIGZjKGEpP0suYj9LLmIoYSk6Sy5jYWxsKG51bGwsYSk6bnVsbCE9dGhpcy5yb290P3RoaXMucm9vdC5UYShiLGEpOnU/YTpudWxsfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5qfTtnLkw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nfTtnLkI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm07cmV0dXJuIG51bGwhPWE/YTp0aGlzLm09YT1kYyh0aGlzKX07Zy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIE1lKHRoaXMsYil9O2cuV2E9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHlmKHt9LHRoaXMucm9vdCx0aGlzLmcsdGhpcy5ULHRoaXMuWSl9O2cuST1mdW5jdGlvbigpe3JldHVybiBlYigkZSx0aGlzLmopfTtcbmcubmI9ZnVuY3Rpb24oYSxiKXtpZihudWxsPT1iKXJldHVybiB0aGlzLlQ/bmV3IHhmKHRoaXMuaix0aGlzLmctMSx0aGlzLnJvb3QsITEsbnVsbCxudWxsKTp0aGlzO2lmKG51bGw9PXRoaXMucm9vdClyZXR1cm4gdGhpcztpZih1KXt2YXIgYz10aGlzLnJvb3QuZmIoMCxUYihiKSxiKTtyZXR1cm4gYz09PXRoaXMucm9vdD90aGlzOm5ldyB4Zih0aGlzLmosdGhpcy5nLTEsYyx0aGlzLlQsdGhpcy5ZLG51bGwpfXJldHVybiBudWxsfTtcbmcudWE9ZnVuY3Rpb24oYSxiLGMpe2lmKG51bGw9PWIpcmV0dXJuIHRoaXMuVCYmYz09PXRoaXMuWT90aGlzOm5ldyB4Zih0aGlzLmosdGhpcy5UP3RoaXMuZzp0aGlzLmcrMSx0aGlzLnJvb3QsITAsYyxudWxsKTthPW5ldyBlZjtiPShudWxsPT10aGlzLnJvb3Q/b2Y6dGhpcy5yb290KS5oYSgwLFRiKGIpLGIsYyxhKTtyZXR1cm4gYj09PXRoaXMucm9vdD90aGlzOm5ldyB4Zih0aGlzLmosYS5sP3RoaXMuZysxOnRoaXMuZyxiLHRoaXMuVCx0aGlzLlksbnVsbCl9O2cua2I9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbnVsbD09Yj90aGlzLlQ6bnVsbD09dGhpcy5yb290PyExOnU/dGhpcy5yb290Lk1hKDAsVGIoYiksYixMYykhPT1MYzpudWxsfTtnLkg9ZnVuY3Rpb24oKXtpZigwPHRoaXMuZyl7dmFyIGE9bnVsbCE9dGhpcy5yb290P3RoaXMucm9vdC5lYigpOm51bGw7cmV0dXJuIHRoaXMuVD9NKG5ldyBXKG51bGwsMiw1LFgsW251bGwsdGhpcy5ZXSxudWxsKSxhKTphfXJldHVybiBudWxsfTtcbmcuRj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgeGYoYix0aGlzLmcsdGhpcy5yb290LHRoaXMuVCx0aGlzLlksdGhpcy5tKX07Zy5HPWZ1bmN0aW9uKGEsYil7aWYoSGMoYikpcmV0dXJuIE9hKHRoaXMsRC5hKGIsMCksRC5hKGIsMSkpO2Zvcih2YXIgYz10aGlzLGQ9RShiKTs7KXtpZihudWxsPT1kKXJldHVybiBjO3ZhciBlPUYoZCk7aWYoSGMoZSkpYz1PYShjLEQuYShlLDApLEQuYShlLDEpKSxkPUkoZCk7ZWxzZSB0aHJvdyBFcnJvcihcImNvbmogb24gYSBtYXAgdGFrZXMgbWFwIGVudHJpZXMgb3Igc2VxYWJsZXMgb2YgbWFwIGVudHJpZXNcIik7fX07XG5nLmNhbGw9ZnVuY3Rpb24oKXt2YXIgYT1udWxsO3JldHVybiBhPWZ1bmN0aW9uKGEsYyxkKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiB0aGlzLnUobnVsbCxjKTtjYXNlIDM6cmV0dXJuIHRoaXMuQyhudWxsLGMsZCl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9fSgpO2cuYXBwbHk9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5jYWxsLmFwcGx5KHRoaXMsW3RoaXNdLmNvbmNhdCh2YShiKSkpfTtnLmI9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMudShudWxsLGEpfTtnLmE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5DKG51bGwsYSxiKX07dmFyICRlPW5ldyB4ZihudWxsLDAsbnVsbCwhMSxudWxsLDApO2Z1bmN0aW9uIHNjKGEsYil7Zm9yKHZhciBjPWEubGVuZ3RoLGQ9MCxlPXliKCRlKTs7KWlmKGQ8Yyl2YXIgZj1kKzEsZT1lLmNiKG51bGwsYVtkXSxiW2RdKSxkPWY7ZWxzZSByZXR1cm4gQWIoZSl9XG5mdW5jdGlvbiB5ZihhLGIsYyxkLGUpe3RoaXMudD1hO3RoaXMucm9vdD1iO3RoaXMuY291bnQ9Yzt0aGlzLlQ9ZDt0aGlzLlk9ZTt0aGlzLnE9NTY7dGhpcy5pPTI1OH1nPXlmLnByb3RvdHlwZTtnLkFiPWZ1bmN0aW9uKGEsYil7aWYodGhpcy50KWlmKG51bGw9PWIpdGhpcy5UJiYodGhpcy5UPSExLHRoaXMuWT1udWxsLHRoaXMuY291bnQtPTEpO2Vsc2V7aWYobnVsbCE9dGhpcy5yb290KXt2YXIgYz1uZXcgZWYsZD10aGlzLnJvb3QuZ2IodGhpcy50LDAsVGIoYiksYixjKTtkIT09dGhpcy5yb290JiYodGhpcy5yb290PWQpO3IoY1swXSkmJih0aGlzLmNvdW50LT0xKX19ZWxzZSB0aHJvdyBFcnJvcihcImRpc3NvYyEgYWZ0ZXIgcGVyc2lzdGVudCFcIik7cmV0dXJuIHRoaXN9O2cuY2I9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB6Zih0aGlzLGIsYyl9O1xuZy5LYT1mdW5jdGlvbihhLGIpe3ZhciBjO2E6e2lmKHRoaXMudCl7aWYoYj9iLmkmMjA0OHx8Yi5kY3x8KGIuaT8wOnMoU2EsYikpOnMoU2EsYikpe2M9emYodGhpcyxjZi5iP2NmLmIoYik6Y2YuY2FsbChudWxsLGIpLGRmLmI/ZGYuYihiKTpkZi5jYWxsKG51bGwsYikpO2JyZWFrIGF9Yz1FKGIpO2Zvcih2YXIgZD10aGlzOzspe3ZhciBlPUYoYyk7aWYocihlKSljPUkoYyksZD16ZihkLGNmLmI/Y2YuYihlKTpjZi5jYWxsKG51bGwsZSksZGYuYj9kZi5iKGUpOmRmLmNhbGwobnVsbCxlKSk7ZWxzZXtjPWQ7YnJlYWsgYX19fWVsc2UgdGhyb3cgRXJyb3IoXCJjb25qISBhZnRlciBwZXJzaXN0ZW50XCIpO2M9dm9pZCAwfXJldHVybiBjfTtcbmcuT2E9ZnVuY3Rpb24oKXt2YXIgYTtpZih0aGlzLnQpdGhpcy50PW51bGwsYT1uZXcgeGYobnVsbCx0aGlzLmNvdW50LHRoaXMucm9vdCx0aGlzLlQsdGhpcy5ZLG51bGwpO2Vsc2UgdGhyb3cgRXJyb3IoXCJwZXJzaXN0ZW50ISBjYWxsZWQgdHdpY2VcIik7cmV0dXJuIGF9O2cudT1mdW5jdGlvbihhLGIpe3JldHVybiBudWxsPT1iP3RoaXMuVD90aGlzLlk6bnVsbDpudWxsPT10aGlzLnJvb3Q/bnVsbDp0aGlzLnJvb3QuTWEoMCxUYihiKSxiKX07Zy5DPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gbnVsbD09Yj90aGlzLlQ/dGhpcy5ZOmM6bnVsbD09dGhpcy5yb290P2M6dGhpcy5yb290Lk1hKDAsVGIoYiksYixjKX07Zy5MPWZ1bmN0aW9uKCl7aWYodGhpcy50KXJldHVybiB0aGlzLmNvdW50O3Rocm93IEVycm9yKFwiY291bnQgYWZ0ZXIgcGVyc2lzdGVudCFcIik7fTtcbmZ1bmN0aW9uIHpmKGEsYixjKXtpZihhLnQpe2lmKG51bGw9PWIpYS5ZIT09YyYmKGEuWT1jKSxhLlR8fChhLmNvdW50Kz0xLGEuVD0hMCk7ZWxzZXt2YXIgZD1uZXcgZWY7Yj0obnVsbD09YS5yb290P29mOmEucm9vdCkuaWEoYS50LDAsVGIoYiksYixjLGQpO2IhPT1hLnJvb3QmJihhLnJvb3Q9Yik7ZC5sJiYoYS5jb3VudCs9MSl9cmV0dXJuIGF9dGhyb3cgRXJyb3IoXCJhc3NvYyEgYWZ0ZXIgcGVyc2lzdGVudCFcIik7fWZ1bmN0aW9uIEFmKGEsYixjKXtmb3IodmFyIGQ9Yjs7KWlmKG51bGwhPWEpYj1jP2EubGVmdDphLnJpZ2h0LGQ9cGMuYShkLGEpLGE9YjtlbHNlIHJldHVybiBkfWZ1bmN0aW9uIEJmKGEsYixjLGQsZSl7dGhpcy5qPWE7dGhpcy5zdGFjaz1iO3RoaXMuaWI9Yzt0aGlzLmc9ZDt0aGlzLm09ZTt0aGlzLnE9MDt0aGlzLmk9MzIzNzQ4NjJ9Zz1CZi5wcm90b3R5cGU7Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07Zy5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuan07XG5nLkw9ZnVuY3Rpb24oKXtyZXR1cm4gMD50aGlzLmc/TyhJKHRoaXMpKSsxOnRoaXMuZ307Zy5CPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tO3JldHVybiBudWxsIT1hP2E6dGhpcy5tPWE9Y2ModGhpcyl9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBsYyh0aGlzLGIpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gTihILHRoaXMuail9O2cuTj1mdW5jdGlvbihhLGIpe3JldHVybiBuYy5hKGIsdGhpcyl9O2cuTT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIG5jLmMoYixjLHRoaXMpfTtnLlE9ZnVuY3Rpb24oKXtyZXR1cm4geWModGhpcy5zdGFjayl9O2cuUz1mdW5jdGlvbigpe3ZhciBhPUYodGhpcy5zdGFjayksYT1BZih0aGlzLmliP2EucmlnaHQ6YS5sZWZ0LEkodGhpcy5zdGFjayksdGhpcy5pYik7cmV0dXJuIG51bGwhPWE/bmV3IEJmKG51bGwsYSx0aGlzLmliLHRoaXMuZy0xLG51bGwpOkh9O2cuSD1mdW5jdGlvbigpe3JldHVybiB0aGlzfTtcbmcuRj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgQmYoYix0aGlzLnN0YWNrLHRoaXMuaWIsdGhpcy5nLHRoaXMubSl9O2cuRz1mdW5jdGlvbihhLGIpe3JldHVybiBNKGIsdGhpcyl9O2Z1bmN0aW9uIENmKGEsYixjKXtyZXR1cm4gbmV3IEJmKG51bGwsQWYoYSxudWxsLGIpLGIsYyxudWxsKX1mdW5jdGlvbiBEZihhLGIsYyxkKXtyZXR1cm4gYyBpbnN0YW5jZW9mIFk/Yy5sZWZ0IGluc3RhbmNlb2YgWT9uZXcgWShjLmtleSxjLmwsYy5sZWZ0LnFhKCksbmV3ICQoYSxiLGMucmlnaHQsZCxudWxsKSxudWxsKTpjLnJpZ2h0IGluc3RhbmNlb2YgWT9uZXcgWShjLnJpZ2h0LmtleSxjLnJpZ2h0LmwsbmV3ICQoYy5rZXksYy5sLGMubGVmdCxjLnJpZ2h0LmxlZnQsbnVsbCksbmV3ICQoYSxiLGMucmlnaHQucmlnaHQsZCxudWxsKSxudWxsKTp1P25ldyAkKGEsYixjLGQsbnVsbCk6bnVsbDpuZXcgJChhLGIsYyxkLG51bGwpfVxuZnVuY3Rpb24gRWYoYSxiLGMsZCl7cmV0dXJuIGQgaW5zdGFuY2VvZiBZP2QucmlnaHQgaW5zdGFuY2VvZiBZP25ldyBZKGQua2V5LGQubCxuZXcgJChhLGIsYyxkLmxlZnQsbnVsbCksZC5yaWdodC5xYSgpLG51bGwpOmQubGVmdCBpbnN0YW5jZW9mIFk/bmV3IFkoZC5sZWZ0LmtleSxkLmxlZnQubCxuZXcgJChhLGIsYyxkLmxlZnQubGVmdCxudWxsKSxuZXcgJChkLmtleSxkLmwsZC5sZWZ0LnJpZ2h0LGQucmlnaHQsbnVsbCksbnVsbCk6dT9uZXcgJChhLGIsYyxkLG51bGwpOm51bGw6bmV3ICQoYSxiLGMsZCxudWxsKX1cbmZ1bmN0aW9uIEZmKGEsYixjLGQpe2lmKGMgaW5zdGFuY2VvZiBZKXJldHVybiBuZXcgWShhLGIsYy5xYSgpLGQsbnVsbCk7aWYoZCBpbnN0YW5jZW9mICQpcmV0dXJuIEVmKGEsYixjLGQuaGIoKSk7aWYoZCBpbnN0YW5jZW9mIFkmJmQubGVmdCBpbnN0YW5jZW9mICQpcmV0dXJuIG5ldyBZKGQubGVmdC5rZXksZC5sZWZ0LmwsbmV3ICQoYSxiLGMsZC5sZWZ0LmxlZnQsbnVsbCksRWYoZC5rZXksZC5sLGQubGVmdC5yaWdodCxkLnJpZ2h0LmhiKCkpLG51bGwpO2lmKHUpdGhyb3cgRXJyb3IoXCJyZWQtYmxhY2sgdHJlZSBpbnZhcmlhbnQgdmlvbGF0aW9uXCIpO3JldHVybiBudWxsfVxudmFyIEhmPWZ1bmN0aW9uIEdmKGIsYyxkKXtkPW51bGwhPWIubGVmdD9HZihiLmxlZnQsYyxkKTpkO2lmKGZjKGQpKXJldHVybiBLLmI/Sy5iKGQpOksuY2FsbChudWxsLGQpO2Q9Yy5jP2MuYyhkLGIua2V5LGIubCk6Yy5jYWxsKG51bGwsZCxiLmtleSxiLmwpO2lmKGZjKGQpKXJldHVybiBLLmI/Sy5iKGQpOksuY2FsbChudWxsLGQpO2I9bnVsbCE9Yi5yaWdodD9HZihiLnJpZ2h0LGMsZCk6ZDtyZXR1cm4gZmMoYik/Sy5iP0suYihiKTpLLmNhbGwobnVsbCxiKTpifTtmdW5jdGlvbiAkKGEsYixjLGQsZSl7dGhpcy5rZXk9YTt0aGlzLmw9Yjt0aGlzLmxlZnQ9Yzt0aGlzLnJpZ2h0PWQ7dGhpcy5tPWU7dGhpcy5xPTA7dGhpcy5pPTMyNDAyMjA3fWc9JC5wcm90b3R5cGU7Zy5IYj1mdW5jdGlvbihhKXtyZXR1cm4gYS5KYih0aGlzKX07Zy5oYj1mdW5jdGlvbigpe3JldHVybiBuZXcgWSh0aGlzLmtleSx0aGlzLmwsdGhpcy5sZWZ0LHRoaXMucmlnaHQsbnVsbCl9O2cucWE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc307XG5nLkdiPWZ1bmN0aW9uKGEpe3JldHVybiBhLkliKHRoaXMpfTtnLnJlcGxhY2U9ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIG5ldyAkKGEsYixjLGQsbnVsbCl9O2cuSWI9ZnVuY3Rpb24oYSl7cmV0dXJuIG5ldyAkKGEua2V5LGEubCx0aGlzLGEucmlnaHQsbnVsbCl9O2cuSmI9ZnVuY3Rpb24oYSl7cmV0dXJuIG5ldyAkKGEua2V5LGEubCxhLmxlZnQsdGhpcyxudWxsKX07Zy5UYT1mdW5jdGlvbihhLGIpe3JldHVybiBIZih0aGlzLGEsYil9O2cudT1mdW5jdGlvbihhLGIpe3JldHVybiBELmModGhpcyxiLG51bGwpfTtnLkM9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBELmModGhpcyxiLGMpfTtnLko9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gMD09PWI/dGhpcy5rZXk6MT09PWI/dGhpcy5sOm51bGx9O2cuYWE9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiAwPT09Yj90aGlzLmtleToxPT09Yj90aGlzLmw6dT9jOm51bGx9O1xuZy5QYT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuKG5ldyBXKG51bGwsMiw1LFgsW3RoaXMua2V5LHRoaXMubF0sbnVsbCkpLlBhKG51bGwsYixjKX07Zy5EPWZ1bmN0aW9uKCl7cmV0dXJuIG51bGx9O2cuTD1mdW5jdGlvbigpe3JldHVybiAyfTtnLiRhPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMua2V5fTtnLmFiPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubH07Zy5JYT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmx9O2cuSmE9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IFcobnVsbCwxLDUsWCxbdGhpcy5rZXldLG51bGwpfTtnLkI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm07cmV0dXJuIG51bGwhPWE/YTp0aGlzLm09YT1jYyh0aGlzKX07Zy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGxjKHRoaXMsYil9O2cuST1mdW5jdGlvbigpe3JldHVybiBxZX07Zy5OPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGdjLmEodGhpcyxiKX07Zy5NPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gZ2MuYyh0aGlzLGIsYyl9O1xuZy51YT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIFIuYyhuZXcgVyhudWxsLDIsNSxYLFt0aGlzLmtleSx0aGlzLmxdLG51bGwpLGIsYyl9O2cuSD1mdW5jdGlvbigpe3JldHVybiBEYShEYShILHRoaXMubCksdGhpcy5rZXkpfTtnLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTihuZXcgVyhudWxsLDIsNSxYLFt0aGlzLmtleSx0aGlzLmxdLG51bGwpLGIpfTtnLkc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IFcobnVsbCwzLDUsWCxbdGhpcy5rZXksdGhpcy5sLGJdLG51bGwpfTtnLmNhbGw9ZnVuY3Rpb24oKXt2YXIgYT1udWxsO3JldHVybiBhPWZ1bmN0aW9uKGEsYyxkKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiB0aGlzLnUobnVsbCxjKTtjYXNlIDM6cmV0dXJuIHRoaXMuQyhudWxsLGMsZCl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9fSgpO1xuZy5hcHBseT1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmNhbGwuYXBwbHkodGhpcyxbdGhpc10uY29uY2F0KHZhKGIpKSl9O2cuYj1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy51KG51bGwsYSl9O2cuYT1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLkMobnVsbCxhLGIpfTtmdW5jdGlvbiBZKGEsYixjLGQsZSl7dGhpcy5rZXk9YTt0aGlzLmw9Yjt0aGlzLmxlZnQ9Yzt0aGlzLnJpZ2h0PWQ7dGhpcy5tPWU7dGhpcy5xPTA7dGhpcy5pPTMyNDAyMjA3fWc9WS5wcm90b3R5cGU7Zy5IYj1mdW5jdGlvbihhKXtyZXR1cm4gbmV3IFkodGhpcy5rZXksdGhpcy5sLHRoaXMubGVmdCxhLG51bGwpfTtnLmhiPWZ1bmN0aW9uKCl7dGhyb3cgRXJyb3IoXCJyZWQtYmxhY2sgdHJlZSBpbnZhcmlhbnQgdmlvbGF0aW9uXCIpO307Zy5xYT1mdW5jdGlvbigpe3JldHVybiBuZXcgJCh0aGlzLmtleSx0aGlzLmwsdGhpcy5sZWZ0LHRoaXMucmlnaHQsbnVsbCl9O1xuZy5HYj1mdW5jdGlvbihhKXtyZXR1cm4gbmV3IFkodGhpcy5rZXksdGhpcy5sLGEsdGhpcy5yaWdodCxudWxsKX07Zy5yZXBsYWNlPWZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiBuZXcgWShhLGIsYyxkLG51bGwpfTtnLkliPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmxlZnQgaW5zdGFuY2VvZiBZP25ldyBZKHRoaXMua2V5LHRoaXMubCx0aGlzLmxlZnQucWEoKSxuZXcgJChhLmtleSxhLmwsdGhpcy5yaWdodCxhLnJpZ2h0LG51bGwpLG51bGwpOnRoaXMucmlnaHQgaW5zdGFuY2VvZiBZP25ldyBZKHRoaXMucmlnaHQua2V5LHRoaXMucmlnaHQubCxuZXcgJCh0aGlzLmtleSx0aGlzLmwsdGhpcy5sZWZ0LHRoaXMucmlnaHQubGVmdCxudWxsKSxuZXcgJChhLmtleSxhLmwsdGhpcy5yaWdodC5yaWdodCxhLnJpZ2h0LG51bGwpLG51bGwpOnU/bmV3ICQoYS5rZXksYS5sLHRoaXMsYS5yaWdodCxudWxsKTpudWxsfTtcbmcuSmI9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMucmlnaHQgaW5zdGFuY2VvZiBZP25ldyBZKHRoaXMua2V5LHRoaXMubCxuZXcgJChhLmtleSxhLmwsYS5sZWZ0LHRoaXMubGVmdCxudWxsKSx0aGlzLnJpZ2h0LnFhKCksbnVsbCk6dGhpcy5sZWZ0IGluc3RhbmNlb2YgWT9uZXcgWSh0aGlzLmxlZnQua2V5LHRoaXMubGVmdC5sLG5ldyAkKGEua2V5LGEubCxhLmxlZnQsdGhpcy5sZWZ0LmxlZnQsbnVsbCksbmV3ICQodGhpcy5rZXksdGhpcy5sLHRoaXMubGVmdC5yaWdodCx0aGlzLnJpZ2h0LG51bGwpLG51bGwpOnU/bmV3ICQoYS5rZXksYS5sLGEubGVmdCx0aGlzLG51bGwpOm51bGx9O2cuVGE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gSGYodGhpcyxhLGIpfTtnLnU9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gRC5jKHRoaXMsYixudWxsKX07Zy5DPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gRC5jKHRoaXMsYixjKX07XG5nLko9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gMD09PWI/dGhpcy5rZXk6MT09PWI/dGhpcy5sOm51bGx9O2cuYWE9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiAwPT09Yj90aGlzLmtleToxPT09Yj90aGlzLmw6dT9jOm51bGx9O2cuUGE9ZnVuY3Rpb24oYSxiLGMpe3JldHVybihuZXcgVyhudWxsLDIsNSxYLFt0aGlzLmtleSx0aGlzLmxdLG51bGwpKS5QYShudWxsLGIsYyl9O2cuRD1mdW5jdGlvbigpe3JldHVybiBudWxsfTtnLkw9ZnVuY3Rpb24oKXtyZXR1cm4gMn07Zy4kYT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmtleX07Zy5hYj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmx9O2cuSWE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sfTtnLkphPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBXKG51bGwsMSw1LFgsW3RoaXMua2V5XSxudWxsKX07Zy5CPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tO3JldHVybiBudWxsIT1hP2E6dGhpcy5tPWE9Y2ModGhpcyl9O1xuZy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGxjKHRoaXMsYil9O2cuST1mdW5jdGlvbigpe3JldHVybiBxZX07Zy5OPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGdjLmEodGhpcyxiKX07Zy5NPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gZ2MuYyh0aGlzLGIsYyl9O2cudWE9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBSLmMobmV3IFcobnVsbCwyLDUsWCxbdGhpcy5rZXksdGhpcy5sXSxudWxsKSxiLGMpfTtnLkg9ZnVuY3Rpb24oKXtyZXR1cm4gRGEoRGEoSCx0aGlzLmwpLHRoaXMua2V5KX07Zy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIE4obmV3IFcobnVsbCwyLDUsWCxbdGhpcy5rZXksdGhpcy5sXSxudWxsKSxiKX07Zy5HPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBXKG51bGwsMyw1LFgsW3RoaXMua2V5LHRoaXMubCxiXSxudWxsKX07XG5nLmNhbGw9ZnVuY3Rpb24oKXt2YXIgYT1udWxsO3JldHVybiBhPWZ1bmN0aW9uKGEsYyxkKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiB0aGlzLnUobnVsbCxjKTtjYXNlIDM6cmV0dXJuIHRoaXMuQyhudWxsLGMsZCl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9fSgpO2cuYXBwbHk9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5jYWxsLmFwcGx5KHRoaXMsW3RoaXNdLmNvbmNhdCh2YShiKSkpfTtnLmI9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMudShudWxsLGEpfTtnLmE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5DKG51bGwsYSxiKX07XG52YXIgSmY9ZnVuY3Rpb24gSWYoYixjLGQsZSxmKXtpZihudWxsPT1jKXJldHVybiBuZXcgWShkLGUsbnVsbCxudWxsLG51bGwpO3ZhciBoPWIuYT9iLmEoZCxjLmtleSk6Yi5jYWxsKG51bGwsZCxjLmtleSk7cmV0dXJuIDA9PT1oPyhmWzBdPWMsbnVsbCk6MD5oPyhiPUlmKGIsYy5sZWZ0LGQsZSxmKSxudWxsIT1iP2MuR2IoYik6bnVsbCk6dT8oYj1JZihiLGMucmlnaHQsZCxlLGYpLG51bGwhPWI/Yy5IYihiKTpudWxsKTpudWxsfSxMZj1mdW5jdGlvbiBLZihiLGMpe2lmKG51bGw9PWIpcmV0dXJuIGM7aWYobnVsbD09YylyZXR1cm4gYjtpZihiIGluc3RhbmNlb2YgWSl7aWYoYyBpbnN0YW5jZW9mIFkpe3ZhciBkPUtmKGIucmlnaHQsYy5sZWZ0KTtyZXR1cm4gZCBpbnN0YW5jZW9mIFk/bmV3IFkoZC5rZXksZC5sLG5ldyBZKGIua2V5LGIubCxiLmxlZnQsZC5sZWZ0LG51bGwpLG5ldyBZKGMua2V5LGMubCxkLnJpZ2h0LGMucmlnaHQsbnVsbCksbnVsbCk6bmV3IFkoYi5rZXksYi5sLFxuYi5sZWZ0LG5ldyBZKGMua2V5LGMubCxkLGMucmlnaHQsbnVsbCksbnVsbCl9cmV0dXJuIG5ldyBZKGIua2V5LGIubCxiLmxlZnQsS2YoYi5yaWdodCxjKSxudWxsKX1yZXR1cm4gYyBpbnN0YW5jZW9mIFk/bmV3IFkoYy5rZXksYy5sLEtmKGIsYy5sZWZ0KSxjLnJpZ2h0LG51bGwpOnU/KGQ9S2YoYi5yaWdodCxjLmxlZnQpLGQgaW5zdGFuY2VvZiBZP25ldyBZKGQua2V5LGQubCxuZXcgJChiLmtleSxiLmwsYi5sZWZ0LGQubGVmdCxudWxsKSxuZXcgJChjLmtleSxjLmwsZC5yaWdodCxjLnJpZ2h0LG51bGwpLG51bGwpOkZmKGIua2V5LGIubCxiLmxlZnQsbmV3ICQoYy5rZXksYy5sLGQsYy5yaWdodCxudWxsKSkpOm51bGx9LE5mPWZ1bmN0aW9uIE1mKGIsYyxkLGUpe2lmKG51bGwhPWMpe3ZhciBmPWIuYT9iLmEoZCxjLmtleSk6Yi5jYWxsKG51bGwsZCxjLmtleSk7aWYoMD09PWYpcmV0dXJuIGVbMF09YyxMZihjLmxlZnQsYy5yaWdodCk7aWYoMD5mKXJldHVybiBiPU1mKGIsYy5sZWZ0LFxuZCxlKSxudWxsIT1ifHxudWxsIT1lWzBdP2MubGVmdCBpbnN0YW5jZW9mICQ/RmYoYy5rZXksYy5sLGIsYy5yaWdodCk6bmV3IFkoYy5rZXksYy5sLGIsYy5yaWdodCxudWxsKTpudWxsO2lmKHUpe2I9TWYoYixjLnJpZ2h0LGQsZSk7aWYobnVsbCE9Ynx8bnVsbCE9ZVswXSlpZihjLnJpZ2h0IGluc3RhbmNlb2YgJClpZihlPWMua2V5LGQ9Yy5sLGM9Yy5sZWZ0LGIgaW5zdGFuY2VvZiBZKWM9bmV3IFkoZSxkLGMsYi5xYSgpLG51bGwpO2Vsc2UgaWYoYyBpbnN0YW5jZW9mICQpYz1EZihlLGQsYy5oYigpLGIpO2Vsc2UgaWYoYyBpbnN0YW5jZW9mIFkmJmMucmlnaHQgaW5zdGFuY2VvZiAkKWM9bmV3IFkoYy5yaWdodC5rZXksYy5yaWdodC5sLERmKGMua2V5LGMubCxjLmxlZnQuaGIoKSxjLnJpZ2h0LmxlZnQpLG5ldyAkKGUsZCxjLnJpZ2h0LnJpZ2h0LGIsbnVsbCksbnVsbCk7ZWxzZXtpZih1KXRocm93IEVycm9yKFwicmVkLWJsYWNrIHRyZWUgaW52YXJpYW50IHZpb2xhdGlvblwiKTtcbmM9bnVsbH1lbHNlIGM9bmV3IFkoYy5rZXksYy5sLGMubGVmdCxiLG51bGwpO2Vsc2UgYz1udWxsO3JldHVybiBjfX1yZXR1cm4gbnVsbH0sUGY9ZnVuY3Rpb24gT2YoYixjLGQsZSl7dmFyIGY9Yy5rZXksaD1iLmE/Yi5hKGQsZik6Yi5jYWxsKG51bGwsZCxmKTtyZXR1cm4gMD09PWg/Yy5yZXBsYWNlKGYsZSxjLmxlZnQsYy5yaWdodCk6MD5oP2MucmVwbGFjZShmLGMubCxPZihiLGMubGVmdCxkLGUpLGMucmlnaHQpOnU/Yy5yZXBsYWNlKGYsYy5sLGMubGVmdCxPZihiLGMucmlnaHQsZCxlKSk6bnVsbH07ZnVuY3Rpb24gUWYoYSxiLGMsZCxlKXt0aGlzLlo9YTt0aGlzLm1hPWI7dGhpcy5nPWM7dGhpcy5qPWQ7dGhpcy5tPWU7dGhpcy5pPTQxODc3Njg0Nzt0aGlzLnE9ODE5Mn1nPVFmLnByb3RvdHlwZTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIExiKHRoaXMpfTtnLmtleXM9ZnVuY3Rpb24oKXtyZXR1cm4gT2UoVmUuYj9WZS5iKHRoaXMpOlZlLmNhbGwobnVsbCx0aGlzKSl9O1xuZy5lbnRyaWVzPWZ1bmN0aW9uKCl7cmV0dXJuIFFlKEUodGhpcykpfTtnLnZhbHVlcz1mdW5jdGlvbigpe3JldHVybiBPZShXZS5iP1dlLmIodGhpcyk6V2UuY2FsbChudWxsLHRoaXMpKX07Zy5oYXM9ZnVuY3Rpb24oYSl7cmV0dXJuIE9jKHRoaXMsYSl9O2cuZ2V0PWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnUobnVsbCxhKX07Zy5mb3JFYWNoPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1FKHRoaXMpLGM9bnVsbCxkPTAsZT0wOzspaWYoZTxkKXt2YXIgZj1jLkoobnVsbCxlKSxoPVAuYyhmLDAsbnVsbCksZj1QLmMoZiwxLG51bGwpO2EuYT9hLmEoZixoKTphLmNhbGwobnVsbCxmLGgpO2UrPTF9ZWxzZSBpZihiPUUoYikpSWMoYik/KGM9SGIoYiksYj1JYihiKSxoPWMsZD1PKGMpLGM9aCk6KGM9RihiKSxoPVAuYyhjLDAsbnVsbCksZj1QLmMoYywxLG51bGwpLGEuYT9hLmEoZixoKTphLmNhbGwobnVsbCxmLGgpLGI9SShiKSxjPW51bGwsZD0wKSxlPTA7ZWxzZSByZXR1cm4gbnVsbH07XG5mdW5jdGlvbiBSZihhLGIpe2Zvcih2YXIgYz1hLm1hOzspaWYobnVsbCE9Yyl7dmFyIGQ9YS5aLmE/YS5aLmEoYixjLmtleSk6YS5aLmNhbGwobnVsbCxiLGMua2V5KTtpZigwPT09ZClyZXR1cm4gYztpZigwPmQpYz1jLmxlZnQ7ZWxzZSBpZih1KWM9Yy5yaWdodDtlbHNlIHJldHVybiBudWxsfWVsc2UgcmV0dXJuIG51bGx9Zy51PWZ1bmN0aW9uKGEsYil7cmV0dXJuIExhLmModGhpcyxiLG51bGwpfTtnLkM9ZnVuY3Rpb24oYSxiLGMpe2E9UmYodGhpcyxiKTtyZXR1cm4gbnVsbCE9YT9hLmw6Y307Zy5aYT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIG51bGwhPXRoaXMubWE/SGYodGhpcy5tYSxiLGMpOmN9O2cuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmp9O2cuTD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmd9O2cuWGE9ZnVuY3Rpb24oKXtyZXR1cm4gMDx0aGlzLmc/Q2YodGhpcy5tYSwhMSx0aGlzLmcpOm51bGx9O1xuZy5CPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tO3JldHVybiBudWxsIT1hP2E6dGhpcy5tPWE9ZGModGhpcyl9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBNZSh0aGlzLGIpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gTihTZix0aGlzLmopfTtnLm5iPWZ1bmN0aW9uKGEsYil7dmFyIGM9W251bGxdLGQ9TmYodGhpcy5aLHRoaXMubWEsYixjKTtyZXR1cm4gbnVsbD09ZD9udWxsPT1QLmEoYywwKT90aGlzOm5ldyBRZih0aGlzLlosbnVsbCwwLHRoaXMuaixudWxsKTpuZXcgUWYodGhpcy5aLGQucWEoKSx0aGlzLmctMSx0aGlzLmosbnVsbCl9O1xuZy51YT1mdW5jdGlvbihhLGIsYyl7YT1bbnVsbF07dmFyIGQ9SmYodGhpcy5aLHRoaXMubWEsYixjLGEpO3JldHVybiBudWxsPT1kPyhhPVAuYShhLDApLFdiLmEoYyxhLmwpP3RoaXM6bmV3IFFmKHRoaXMuWixQZih0aGlzLlosdGhpcy5tYSxiLGMpLHRoaXMuZyx0aGlzLmosbnVsbCkpOm5ldyBRZih0aGlzLlosZC5xYSgpLHRoaXMuZysxLHRoaXMuaixudWxsKX07Zy5rYj1mdW5jdGlvbihhLGIpe3JldHVybiBudWxsIT1SZih0aGlzLGIpfTtnLkg9ZnVuY3Rpb24oKXtyZXR1cm4gMDx0aGlzLmc/Q2YodGhpcy5tYSwhMCx0aGlzLmcpOm51bGx9O2cuRj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgUWYodGhpcy5aLHRoaXMubWEsdGhpcy5nLGIsdGhpcy5tKX07XG5nLkc9ZnVuY3Rpb24oYSxiKXtpZihIYyhiKSlyZXR1cm4gT2EodGhpcyxELmEoYiwwKSxELmEoYiwxKSk7Zm9yKHZhciBjPXRoaXMsZD1FKGIpOzspe2lmKG51bGw9PWQpcmV0dXJuIGM7dmFyIGU9RihkKTtpZihIYyhlKSljPU9hKGMsRC5hKGUsMCksRC5hKGUsMSkpLGQ9SShkKTtlbHNlIHRocm93IEVycm9yKFwiY29uaiBvbiBhIG1hcCB0YWtlcyBtYXAgZW50cmllcyBvciBzZXFhYmxlcyBvZiBtYXAgZW50cmllc1wiKTt9fTtnLmNhbGw9ZnVuY3Rpb24oKXt2YXIgYT1udWxsO3JldHVybiBhPWZ1bmN0aW9uKGEsYyxkKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiB0aGlzLnUobnVsbCxjKTtjYXNlIDM6cmV0dXJuIHRoaXMuQyhudWxsLGMsZCl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9fSgpO2cuYXBwbHk9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5jYWxsLmFwcGx5KHRoaXMsW3RoaXNdLmNvbmNhdCh2YShiKSkpfTtcbmcuYj1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy51KG51bGwsYSl9O2cuYT1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLkMobnVsbCxhLGIpfTtnLnliPWZ1bmN0aW9uKGEsYil7cmV0dXJuIDA8dGhpcy5nP0NmKHRoaXMubWEsYix0aGlzLmcpOm51bGx9O2cuemI9ZnVuY3Rpb24oYSxiLGMpe2lmKDA8dGhpcy5nKXthPW51bGw7Zm9yKHZhciBkPXRoaXMubWE7OylpZihudWxsIT1kKXt2YXIgZT10aGlzLlouYT90aGlzLlouYShiLGQua2V5KTp0aGlzLlouY2FsbChudWxsLGIsZC5rZXkpO2lmKDA9PT1lKXJldHVybiBuZXcgQmYobnVsbCxwYy5hKGEsZCksYywtMSxudWxsKTtpZihyKGMpKTA+ZT8oYT1wYy5hKGEsZCksZD1kLmxlZnQpOmQ9ZC5yaWdodDtlbHNlIGlmKHUpMDxlPyhhPXBjLmEoYSxkKSxkPWQucmlnaHQpOmQ9ZC5sZWZ0O2Vsc2UgcmV0dXJuIG51bGx9ZWxzZSByZXR1cm4gbnVsbD09YT9udWxsOm5ldyBCZihudWxsLGEsYywtMSxudWxsKX1lbHNlIHJldHVybiBudWxsfTtcbmcueGI9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gY2YuYj9jZi5iKGIpOmNmLmNhbGwobnVsbCxiKX07Zy53Yj1mdW5jdGlvbigpe3JldHVybiB0aGlzLlp9O1xudmFyIFNmPW5ldyBRZihYYixudWxsLDAsbnVsbCwwKSxUZj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSl7dmFyIGQ9bnVsbDswPGFyZ3VtZW50cy5sZW5ndGgmJihkPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsZCl9ZnVuY3Rpb24gYihhKXthPUUoYSk7Zm9yKHZhciBiPXliKCRlKTs7KWlmKGEpe3ZhciBlPUkoSShhKSksYj14ZC5jKGIsRihhKSxGKEkoYSkpKTthPWV9ZWxzZSByZXR1cm4gQWIoYil9YS5rPTA7YS5mPWZ1bmN0aW9uKGEpe2E9RShhKTtyZXR1cm4gYihhKX07YS5kPWI7cmV0dXJuIGF9KCksVWY9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEpe3ZhciBkPW51bGw7MDxhcmd1bWVudHMubGVuZ3RoJiYoZD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywwKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGQpfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIG5ldyBsYShudWxsLFljKE8oYSkpLFMuYSh3YSxcbmEpLG51bGwpfWEuaz0wO2EuZj1mdW5jdGlvbihhKXthPUUoYSk7cmV0dXJuIGIoYSl9O2EuZD1iO3JldHVybiBhfSgpLFZmPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhKXt2YXIgZD1udWxsOzA8YXJndW1lbnRzLmxlbmd0aCYmKGQ9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCksMCkpO3JldHVybiBiLmNhbGwodGhpcyxkKX1mdW5jdGlvbiBiKGEpe2E9RShhKTtmb3IodmFyIGI9U2Y7OylpZihhKXt2YXIgZT1JKEkoYSkpLGI9Ui5jKGIsRihhKSxGKEkoYSkpKTthPWV9ZWxzZSByZXR1cm4gYn1hLms9MDthLmY9ZnVuY3Rpb24oYSl7YT1FKGEpO3JldHVybiBiKGEpfTthLmQ9YjtyZXR1cm4gYX0oKSxXZj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxkKXt2YXIgZT1udWxsOzE8YXJndW1lbnRzLmxlbmd0aCYmKGU9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSksMCkpO3JldHVybiBiLmNhbGwodGhpcyxhLGUpfWZ1bmN0aW9uIGIoYSxcbmIpe2Zvcih2YXIgZT1FKGIpLGY9bmV3IFFmKFFjKGEpLG51bGwsMCxudWxsLDApOzspaWYoZSl2YXIgaD1JKEkoZSkpLGY9Ui5jKGYsRihlKSxGKEkoZSkpKSxlPWg7ZWxzZSByZXR1cm4gZn1hLms9MTthLmY9ZnVuY3Rpb24oYSl7dmFyIGQ9RihhKTthPUcoYSk7cmV0dXJuIGIoZCxhKX07YS5kPWI7cmV0dXJuIGF9KCk7ZnVuY3Rpb24gWGYoYSxiKXt0aGlzLlY9YTt0aGlzLlc9Yjt0aGlzLnE9MDt0aGlzLmk9MzIzNzQ5ODh9Zz1YZi5wcm90b3R5cGU7Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07Zy5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuV307Zy5VPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5WLGE9KGE/YS5pJjEyOHx8YS5vYnx8KGEuaT8wOnMoSmEsYSkpOnMoSmEsYSkpP3RoaXMuVi5VKG51bGwpOkkodGhpcy5WKTtyZXR1cm4gbnVsbD09YT9udWxsOm5ldyBYZihhLHRoaXMuVyl9O2cuQj1mdW5jdGlvbigpe3JldHVybiBjYyh0aGlzKX07XG5nLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbGModGhpcyxiKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIE4oSCx0aGlzLlcpfTtnLk49ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmMuYShiLHRoaXMpfTtnLk09ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBuYy5jKGIsYyx0aGlzKX07Zy5RPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuVi5RKG51bGwpLiRhKG51bGwpfTtnLlM9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLlYsYT0oYT9hLmkmMTI4fHxhLm9ifHwoYS5pPzA6cyhKYSxhKSk6cyhKYSxhKSk/dGhpcy5WLlUobnVsbCk6SSh0aGlzLlYpO3JldHVybiBudWxsIT1hP25ldyBYZihhLHRoaXMuVyk6SH07Zy5IPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9O2cuRj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgWGYodGhpcy5WLGIpfTtnLkc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTShiLHRoaXMpfTtmdW5jdGlvbiBWZShhKXtyZXR1cm4oYT1FKGEpKT9uZXcgWGYoYSxudWxsKTpudWxsfVxuZnVuY3Rpb24gY2YoYSl7cmV0dXJuIFRhKGEpfWZ1bmN0aW9uIFlmKGEsYil7dGhpcy5WPWE7dGhpcy5XPWI7dGhpcy5xPTA7dGhpcy5pPTMyMzc0OTg4fWc9WWYucHJvdG90eXBlO2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O2cuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLld9O2cuVT1mdW5jdGlvbigpe3ZhciBhPXRoaXMuVixhPShhP2EuaSYxMjh8fGEub2J8fChhLmk/MDpzKEphLGEpKTpzKEphLGEpKT90aGlzLlYuVShudWxsKTpJKHRoaXMuVik7cmV0dXJuIG51bGw9PWE/bnVsbDpuZXcgWWYoYSx0aGlzLlcpfTtnLkI9ZnVuY3Rpb24oKXtyZXR1cm4gY2ModGhpcyl9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBsYyh0aGlzLGIpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gTihILHRoaXMuVyl9O2cuTj1mdW5jdGlvbihhLGIpe3JldHVybiBuYy5hKGIsdGhpcyl9O2cuTT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIG5jLmMoYixjLHRoaXMpfTtnLlE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5WLlEobnVsbCkuYWIobnVsbCl9O1xuZy5TPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5WLGE9KGE/YS5pJjEyOHx8YS5vYnx8KGEuaT8wOnMoSmEsYSkpOnMoSmEsYSkpP3RoaXMuVi5VKG51bGwpOkkodGhpcy5WKTtyZXR1cm4gbnVsbCE9YT9uZXcgWWYoYSx0aGlzLlcpOkh9O2cuSD1mdW5jdGlvbigpe3JldHVybiB0aGlzfTtnLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IFlmKHRoaXMuVixiKX07Zy5HPWZ1bmN0aW9uKGEsYil7cmV0dXJuIE0oYix0aGlzKX07ZnVuY3Rpb24gV2UoYSl7cmV0dXJuKGE9RShhKSk/bmV3IFlmKGEsbnVsbCk6bnVsbH1mdW5jdGlvbiBkZihhKXtyZXR1cm4gVWEoYSl9XG52YXIgWmY9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEpe3ZhciBkPW51bGw7MDxhcmd1bWVudHMubGVuZ3RoJiYoZD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywwKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGQpfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIHIoRWQoRmQsYSkpP0MuYShmdW5jdGlvbihhLGIpe3JldHVybiBwYy5hKHIoYSk/YTpZZSxiKX0sYSk6bnVsbH1hLms9MDthLmY9ZnVuY3Rpb24oYSl7YT1FKGEpO3JldHVybiBiKGEpfTthLmQ9YjtyZXR1cm4gYX0oKTtmdW5jdGlvbiAkZihhLGIsYyl7dGhpcy5qPWE7dGhpcy5TYT1iO3RoaXMubT1jO3RoaXMuaT0xNTA3NzY0Nzt0aGlzLnE9ODE5Nn1nPSRmLnByb3RvdHlwZTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIExiKHRoaXMpfTtnLmtleXM9ZnVuY3Rpb24oKXtyZXR1cm4gT2UoRSh0aGlzKSl9O2cuZW50cmllcz1mdW5jdGlvbigpe3JldHVybiBTZShFKHRoaXMpKX07Zy52YWx1ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gT2UoRSh0aGlzKSl9O1xuZy5oYXM9ZnVuY3Rpb24oYSl7cmV0dXJuIE9jKHRoaXMsYSl9O2cuZm9yRWFjaD1mdW5jdGlvbihhKXtmb3IodmFyIGI9RSh0aGlzKSxjPW51bGwsZD0wLGU9MDs7KWlmKGU8ZCl7dmFyIGY9Yy5KKG51bGwsZSksaD1QLmMoZiwwLG51bGwpLGY9UC5jKGYsMSxudWxsKTthLmE/YS5hKGYsaCk6YS5jYWxsKG51bGwsZixoKTtlKz0xfWVsc2UgaWYoYj1FKGIpKUljKGIpPyhjPUhiKGIpLGI9SWIoYiksaD1jLGQ9TyhjKSxjPWgpOihjPUYoYiksaD1QLmMoYywwLG51bGwpLGY9UC5jKGMsMSxudWxsKSxhLmE/YS5hKGYsaCk6YS5jYWxsKG51bGwsZixoKSxiPUkoYiksYz1udWxsLGQ9MCksZT0wO2Vsc2UgcmV0dXJuIG51bGx9O2cudT1mdW5jdGlvbihhLGIpe3JldHVybiBMYS5jKHRoaXMsYixudWxsKX07Zy5DPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gTmEodGhpcy5TYSxiKT9iOmN9O2cuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmp9O2cuTD1mdW5jdGlvbigpe3JldHVybiBBYSh0aGlzLlNhKX07XG5nLkI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm07cmV0dXJuIG51bGwhPWE/YTp0aGlzLm09YT1kYyh0aGlzKX07Zy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIERjKGIpJiZPKHRoaXMpPT09TyhiKSYmRGQoZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKGIpe3JldHVybiBPYyhhLGIpfX0odGhpcyksYil9O2cuV2E9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGFnKHliKHRoaXMuU2EpKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIE4oYmcsdGhpcy5qKX07Zy52Yj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgJGYodGhpcy5qLFFhKHRoaXMuU2EsYiksbnVsbCl9O2cuSD1mdW5jdGlvbigpe3JldHVybiBWZSh0aGlzLlNhKX07Zy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyAkZihiLHRoaXMuU2EsdGhpcy5tKX07Zy5HPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyAkZih0aGlzLmosUi5jKHRoaXMuU2EsYixudWxsKSxudWxsKX07XG5nLmNhbGw9ZnVuY3Rpb24oKXt2YXIgYT1udWxsO3JldHVybiBhPWZ1bmN0aW9uKGEsYyxkKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiB0aGlzLnUobnVsbCxjKTtjYXNlIDM6cmV0dXJuIHRoaXMuQyhudWxsLGMsZCl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9fSgpO2cuYXBwbHk9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5jYWxsLmFwcGx5KHRoaXMsW3RoaXNdLmNvbmNhdCh2YShiKSkpfTtnLmI9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMudShudWxsLGEpfTtnLmE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5DKG51bGwsYSxiKX07dmFyIGJnPW5ldyAkZihudWxsLFllLDApO2Z1bmN0aW9uIGFnKGEpe3RoaXMubGE9YTt0aGlzLmk9MjU5O3RoaXMucT0xMzZ9Zz1hZy5wcm90b3R5cGU7XG5nLmNhbGw9ZnVuY3Rpb24oKXt2YXIgYT1udWxsO3JldHVybiBhPWZ1bmN0aW9uKGEsYyxkKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBMYS5jKHRoaXMubGEsYyxMYyk9PT1MYz9udWxsOmM7Y2FzZSAzOnJldHVybiBMYS5jKHRoaXMubGEsYyxMYyk9PT1MYz9kOmN9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9fSgpO2cuYXBwbHk9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5jYWxsLmFwcGx5KHRoaXMsW3RoaXNdLmNvbmNhdCh2YShiKSkpfTtnLmI9ZnVuY3Rpb24oYSl7cmV0dXJuIExhLmModGhpcy5sYSxhLExjKT09PUxjP251bGw6YX07Zy5hPWZ1bmN0aW9uKGEsYil7cmV0dXJuIExhLmModGhpcy5sYSxhLExjKT09PUxjP2I6YX07Zy51PWZ1bmN0aW9uKGEsYil7cmV0dXJuIExhLmModGhpcyxiLG51bGwpfTtnLkM9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBMYS5jKHRoaXMubGEsYixMYyk9PT1MYz9jOmJ9O1xuZy5MPWZ1bmN0aW9uKCl7cmV0dXJuIE8odGhpcy5sYSl9O2cuT2I9ZnVuY3Rpb24oYSxiKXt0aGlzLmxhPXlkLmEodGhpcy5sYSxiKTtyZXR1cm4gdGhpc307Zy5LYT1mdW5jdGlvbihhLGIpe3RoaXMubGE9eGQuYyh0aGlzLmxhLGIsbnVsbCk7cmV0dXJuIHRoaXN9O2cuT2E9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3ICRmKG51bGwsQWIodGhpcy5sYSksbnVsbCl9O2Z1bmN0aW9uIGNnKGEsYixjKXt0aGlzLmo9YTt0aGlzLm5hPWI7dGhpcy5tPWM7dGhpcy5pPTQxNzczMDgzMTt0aGlzLnE9ODE5Mn1nPWNnLnByb3RvdHlwZTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIExiKHRoaXMpfTtnLmtleXM9ZnVuY3Rpb24oKXtyZXR1cm4gT2UoRSh0aGlzKSl9O2cuZW50cmllcz1mdW5jdGlvbigpe3JldHVybiBTZShFKHRoaXMpKX07Zy52YWx1ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gT2UoRSh0aGlzKSl9O2cuaGFzPWZ1bmN0aW9uKGEpe3JldHVybiBPYyh0aGlzLGEpfTtcbmcuZm9yRWFjaD1mdW5jdGlvbihhKXtmb3IodmFyIGI9RSh0aGlzKSxjPW51bGwsZD0wLGU9MDs7KWlmKGU8ZCl7dmFyIGY9Yy5KKG51bGwsZSksaD1QLmMoZiwwLG51bGwpLGY9UC5jKGYsMSxudWxsKTthLmE/YS5hKGYsaCk6YS5jYWxsKG51bGwsZixoKTtlKz0xfWVsc2UgaWYoYj1FKGIpKUljKGIpPyhjPUhiKGIpLGI9SWIoYiksaD1jLGQ9TyhjKSxjPWgpOihjPUYoYiksaD1QLmMoYywwLG51bGwpLGY9UC5jKGMsMSxudWxsKSxhLmE/YS5hKGYsaCk6YS5jYWxsKG51bGwsZixoKSxiPUkoYiksYz1udWxsLGQ9MCksZT0wO2Vsc2UgcmV0dXJuIG51bGx9O2cudT1mdW5jdGlvbihhLGIpe3JldHVybiBMYS5jKHRoaXMsYixudWxsKX07Zy5DPWZ1bmN0aW9uKGEsYixjKXthPVJmKHRoaXMubmEsYik7cmV0dXJuIG51bGwhPWE/YS5rZXk6Y307Zy5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuan07Zy5MPWZ1bmN0aW9uKCl7cmV0dXJuIE8odGhpcy5uYSl9O1xuZy5YYT1mdW5jdGlvbigpe3JldHVybiAwPE8odGhpcy5uYSk/S2QuYShjZixwYih0aGlzLm5hKSk6bnVsbH07Zy5CPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tO3JldHVybiBudWxsIT1hP2E6dGhpcy5tPWE9ZGModGhpcyl9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBEYyhiKSYmTyh0aGlzKT09PU8oYikmJkRkKGZ1bmN0aW9uKGEpe3JldHVybiBmdW5jdGlvbihiKXtyZXR1cm4gT2MoYSxiKX19KHRoaXMpLGIpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gTihkZyx0aGlzLmopfTtnLnZiPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBjZyh0aGlzLmosdGMuYSh0aGlzLm5hLGIpLG51bGwpfTtnLkg9ZnVuY3Rpb24oKXtyZXR1cm4gVmUodGhpcy5uYSl9O2cuRj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgY2coYix0aGlzLm5hLHRoaXMubSl9O2cuRz1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgY2codGhpcy5qLFIuYyh0aGlzLm5hLGIsbnVsbCksbnVsbCl9O1xuZy5jYWxsPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbDtyZXR1cm4gYT1mdW5jdGlvbihhLGMsZCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gdGhpcy51KG51bGwsYyk7Y2FzZSAzOnJldHVybiB0aGlzLkMobnVsbCxjLGQpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fX0oKTtnLmFwcGx5PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuY2FsbC5hcHBseSh0aGlzLFt0aGlzXS5jb25jYXQodmEoYikpKX07Zy5iPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnUobnVsbCxhKX07Zy5hPWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuQyhudWxsLGEsYil9O2cueWI9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gS2QuYShjZixxYih0aGlzLm5hLGIpKX07Zy56Yj1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIEtkLmEoY2YscmIodGhpcy5uYSxiLGMpKX07Zy54Yj1mdW5jdGlvbihhLGIpe3JldHVybiBifTtnLndiPWZ1bmN0aW9uKCl7cmV0dXJuIHRiKHRoaXMubmEpfTtcbnZhciBkZz1uZXcgY2cobnVsbCxTZiwwKTtmdW5jdGlvbiBlZyhhKXthPUUoYSk7aWYobnVsbD09YSlyZXR1cm4gYmc7aWYoYSBpbnN0YW5jZW9mIGFjJiYwPT09YS5wKXthPWEuZTthOntmb3IodmFyIGI9MCxjPXliKGJnKTs7KWlmKGI8YS5sZW5ndGgpdmFyIGQ9YisxLGM9Yy5LYShudWxsLGFbYl0pLGI9ZDtlbHNle2E9YzticmVhayBhfWE9dm9pZCAwfXJldHVybiBhLk9hKG51bGwpfWlmKHUpZm9yKGQ9eWIoYmcpOzspaWYobnVsbCE9YSliPWEuVShudWxsKSxkPWQuS2EobnVsbCxhLlEobnVsbCkpLGE9YjtlbHNlIHJldHVybiBkLk9hKG51bGwpO2Vsc2UgcmV0dXJuIG51bGx9XG52YXIgZmc9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEpe3ZhciBkPW51bGw7MDxhcmd1bWVudHMubGVuZ3RoJiYoZD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywwKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGQpfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIEMuYyhEYSxkZyxhKX1hLms9MDthLmY9ZnVuY3Rpb24oYSl7YT1FKGEpO3JldHVybiBiKGEpfTthLmQ9YjtyZXR1cm4gYX0oKSxnZz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxkKXt2YXIgZT1udWxsOzE8YXJndW1lbnRzLmxlbmd0aCYmKGU9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSksMCkpO3JldHVybiBiLmNhbGwodGhpcyxhLGUpfWZ1bmN0aW9uIGIoYSxiKXtyZXR1cm4gQy5jKERhLG5ldyBjZyhudWxsLFdmKGEpLDApLGIpfWEuaz0xO2EuZj1mdW5jdGlvbihhKXt2YXIgZD1GKGEpO2E9RyhhKTtyZXR1cm4gYihkLGEpfTthLmQ9YjtyZXR1cm4gYX0oKTtcbmZ1bmN0aW9uIGhnKGEpe2Zvcih2YXIgYj1xZTs7KWlmKEkoYSkpYj1wYy5hKGIsRihhKSksYT1JKGEpO2Vsc2UgcmV0dXJuIEUoYil9ZnVuY3Rpb24gaWQoYSl7aWYoYSYmKGEucSY0MDk2fHxhLmZjKSlyZXR1cm4gYS5uYW1lO2lmKFwic3RyaW5nXCI9PT10eXBlb2YgYSlyZXR1cm4gYTt0aHJvdyBFcnJvcihcIkRvZXNuJ3Qgc3VwcG9ydCBuYW1lOiBcIitBLmIoYSkpO31cbnZhciBpZz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMpe3JldHVybihhLmI/YS5iKGIpOmEuY2FsbChudWxsLGIpKT4oYS5iP2EuYihjKTphLmNhbGwobnVsbCxjKSk/YjpjfXZhciBiPW51bGwsYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYixkLGssbCl7dmFyIG49bnVsbDszPGFyZ3VtZW50cy5sZW5ndGgmJihuPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDMpLDApKTtyZXR1cm4gYy5jYWxsKHRoaXMsYixkLGssbil9ZnVuY3Rpb24gYyhhLGQsZSxsKXtyZXR1cm4gQy5jKGZ1bmN0aW9uKGMsZCl7cmV0dXJuIGIuYyhhLGMsZCl9LGIuYyhhLGQsZSksbCl9YS5rPTM7YS5mPWZ1bmN0aW9uKGEpe3ZhciBiPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1JKGEpO3ZhciBsPUYoYSk7YT1HKGEpO3JldHVybiBjKGIsZCxsLGEpfTthLmQ9YztyZXR1cm4gYX0oKSxiPWZ1bmN0aW9uKGIsZSxmLGgpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGU7XG5jYXNlIDM6cmV0dXJuIGEuY2FsbCh0aGlzLGIsZSxmKTtkZWZhdWx0OnJldHVybiBjLmQoYixlLGYsSihhcmd1bWVudHMsMykpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtiLms9MztiLmY9Yy5mO2IuYT1mdW5jdGlvbihhLGIpe3JldHVybiBifTtiLmM9YTtiLmQ9Yy5kO3JldHVybiBifSgpLGpnPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsZil7cmV0dXJuIG5ldyBWKG51bGwsZnVuY3Rpb24oKXt2YXIgaD1FKGYpO3JldHVybiBoP00oTWQoYSxoKSxjLmMoYSxiLE5kKGIsaCkpKTpudWxsfSxudWxsLG51bGwpfWZ1bmN0aW9uIGIoYSxiKXtyZXR1cm4gYy5jKGEsYSxiKX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGIuY2FsbCh0aGlzLGMsZSk7Y2FzZSAzOnJldHVybiBhLmNhbGwodGhpcyxjLGUsZil9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTtcbn07Yy5hPWI7Yy5jPWE7cmV0dXJuIGN9KCksbGc9ZnVuY3Rpb24ga2coYixjKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbigpe3ZhciBkPUUoYyk7cmV0dXJuIGQ/cihiLmI/Yi5iKEYoZCkpOmIuY2FsbChudWxsLEYoZCkpKT9NKEYoZCksa2coYixHKGQpKSk6bnVsbDpudWxsfSxudWxsLG51bGwpfTtmdW5jdGlvbiBtZyhhLGIsYyl7cmV0dXJuIGZ1bmN0aW9uKGQpe3ZhciBlPXRiKGEpO3JldHVybiBiLmE/Yi5hKGUuYT9lLmEoc2IoYSxkKSxjKTplLmNhbGwobnVsbCxzYihhLGQpLGMpLDApOmIuY2FsbChudWxsLGUuYT9lLmEoc2IoYSxkKSxjKTplLmNhbGwobnVsbCxzYihhLGQpLGMpLDApfX1cbnZhciBuZz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMsaCxrKXt2YXIgbD1yYihhLGMsITApO2lmKHIobCkpe3ZhciBuPVAuYyhsLDAsbnVsbCk7cmV0dXJuIGxnKG1nKGEsaCxrKSxyKG1nKGEsYixjKS5jYWxsKG51bGwsbikpP2w6SShsKSl9cmV0dXJuIG51bGx9ZnVuY3Rpb24gYihhLGIsYyl7dmFyIGg9bWcoYSxiLGMpLGs7YTp7az1bVWMsVmNdO3ZhciBsPWsubGVuZ3RoO2lmKGw8PVplKWZvcih2YXIgbj0wLHE9eWIoWWUpOzspaWYobjxsKXZhciB0PW4rMSxxPUJiKHEsa1tuXSxudWxsKSxuPXQ7ZWxzZXtrPW5ldyAkZihudWxsLEFiKHEpLG51bGwpO2JyZWFrIGF9ZWxzZSBmb3Iobj0wLHE9eWIoYmcpOzspaWYobjxsKXQ9bisxLHE9emIocSxrW25dKSxuPXQ7ZWxzZXtrPUFiKHEpO2JyZWFrIGF9az12b2lkIDB9cmV0dXJuIHIoay5jYWxsKG51bGwsYikpPyhhPXJiKGEsYywhMCkscihhKT8oYj1QLmMoYSwwLG51bGwpLHIoaC5iP2guYihiKTpoLmNhbGwobnVsbCxiKSk/YTpcbkkoYSkpOm51bGwpOmxnKGgscWIoYSwhMCkpfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUsZixoLGspe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDM6cmV0dXJuIGIuY2FsbCh0aGlzLGMsZSxmKTtjYXNlIDU6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSxmLGgsayl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYz1iO2Mucz1hO3JldHVybiBjfSgpO2Z1bmN0aW9uIG9nKGEsYixjLGQsZSl7dGhpcy5qPWE7dGhpcy5zdGFydD1iO3RoaXMuZW5kPWM7dGhpcy5zdGVwPWQ7dGhpcy5tPWU7dGhpcy5pPTMyMzc1MDA2O3RoaXMucT04MTkyfWc9b2cucHJvdG90eXBlO2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O1xuZy5KPWZ1bmN0aW9uKGEsYil7aWYoYjxBYSh0aGlzKSlyZXR1cm4gdGhpcy5zdGFydCtiKnRoaXMuc3RlcDtpZih0aGlzLnN0YXJ0PnRoaXMuZW5kJiYwPT09dGhpcy5zdGVwKXJldHVybiB0aGlzLnN0YXJ0O3Rocm93IEVycm9yKFwiSW5kZXggb3V0IG9mIGJvdW5kc1wiKTt9O2cuYWE9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBiPEFhKHRoaXMpP3RoaXMuc3RhcnQrYip0aGlzLnN0ZXA6dGhpcy5zdGFydD50aGlzLmVuZCYmMD09PXRoaXMuc3RlcD90aGlzLnN0YXJ0OmN9O2cuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmp9O1xuZy5VPWZ1bmN0aW9uKCl7cmV0dXJuIDA8dGhpcy5zdGVwP3RoaXMuc3RhcnQrdGhpcy5zdGVwPHRoaXMuZW5kP25ldyBvZyh0aGlzLmosdGhpcy5zdGFydCt0aGlzLnN0ZXAsdGhpcy5lbmQsdGhpcy5zdGVwLG51bGwpOm51bGw6dGhpcy5zdGFydCt0aGlzLnN0ZXA+dGhpcy5lbmQ/bmV3IG9nKHRoaXMuaix0aGlzLnN0YXJ0K3RoaXMuc3RlcCx0aGlzLmVuZCx0aGlzLnN0ZXAsbnVsbCk6bnVsbH07Zy5MPWZ1bmN0aW9uKCl7cmV0dXJuIHNhKGxiKHRoaXMpKT8wOk1hdGguY2VpbCgodGhpcy5lbmQtdGhpcy5zdGFydCkvdGhpcy5zdGVwKX07Zy5CPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tO3JldHVybiBudWxsIT1hP2E6dGhpcy5tPWE9Y2ModGhpcyl9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBsYyh0aGlzLGIpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gTihILHRoaXMuail9O2cuTj1mdW5jdGlvbihhLGIpe3JldHVybiBnYy5hKHRoaXMsYil9O1xuZy5NPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gZ2MuYyh0aGlzLGIsYyl9O2cuUT1mdW5jdGlvbigpe3JldHVybiBudWxsPT1sYih0aGlzKT9udWxsOnRoaXMuc3RhcnR9O2cuUz1mdW5jdGlvbigpe3JldHVybiBudWxsIT1sYih0aGlzKT9uZXcgb2codGhpcy5qLHRoaXMuc3RhcnQrdGhpcy5zdGVwLHRoaXMuZW5kLHRoaXMuc3RlcCxudWxsKTpIfTtnLkg9ZnVuY3Rpb24oKXtyZXR1cm4gMDx0aGlzLnN0ZXA/dGhpcy5zdGFydDx0aGlzLmVuZD90aGlzOm51bGw6dGhpcy5zdGFydD50aGlzLmVuZD90aGlzOm51bGx9O2cuRj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgb2coYix0aGlzLnN0YXJ0LHRoaXMuZW5kLHRoaXMuc3RlcCx0aGlzLm0pfTtnLkc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTShiLHRoaXMpfTtcbnZhciBwZz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMpe3JldHVybiBuZXcgb2cobnVsbCxhLGIsYyxudWxsKX1mdW5jdGlvbiBiKGEsYil7cmV0dXJuIGUuYyhhLGIsMSl9ZnVuY3Rpb24gYyhhKXtyZXR1cm4gZS5jKDAsYSwxKX1mdW5jdGlvbiBkKCl7cmV0dXJuIGUuYygwLE51bWJlci5NQVhfVkFMVUUsMSl9dmFyIGU9bnVsbCxlPWZ1bmN0aW9uKGUsaCxrKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAwOnJldHVybiBkLmNhbGwodGhpcyk7Y2FzZSAxOnJldHVybiBjLmNhbGwodGhpcyxlKTtjYXNlIDI6cmV0dXJuIGIuY2FsbCh0aGlzLGUsaCk7Y2FzZSAzOnJldHVybiBhLmNhbGwodGhpcyxlLGgsayl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Uubz1kO2UuYj1jO2UuYT1iO2UuYz1hO3JldHVybiBlfSgpLHFnPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe2Zvcig7OylpZihFKGIpJiYwPGEpe3ZhciBjPWEtMSxoPVxuSShiKTthPWM7Yj1ofWVsc2UgcmV0dXJuIG51bGx9ZnVuY3Rpb24gYihhKXtmb3IoOzspaWYoRShhKSlhPUkoYSk7ZWxzZSByZXR1cm4gbnVsbH12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBiLmNhbGwodGhpcyxjKTtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYj1iO2MuYT1hO3JldHVybiBjfSgpLHJnPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3FnLmEoYSxiKTtyZXR1cm4gYn1mdW5jdGlvbiBiKGEpe3FnLmIoYSk7cmV0dXJuIGF9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYi5jYWxsKHRoaXMsYyk7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxjLGUpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7XG59O2MuYj1iO2MuYT1hO3JldHVybiBjfSgpO2Z1bmN0aW9uIHNnKGEsYil7aWYoXCJzdHJpbmdcIj09PXR5cGVvZiBiKXt2YXIgYz1hLmV4ZWMoYik7cmV0dXJuIFdiLmEoRihjKSxiKT8xPT09TyhjKT9GKGMpOndlKGMpOm51bGx9dGhyb3cgbmV3IFR5cGVFcnJvcihcInJlLW1hdGNoZXMgbXVzdCBtYXRjaCBhZ2FpbnN0IGEgc3RyaW5nLlwiKTt9ZnVuY3Rpb24gdGcoYSl7dmFyIGI7Yj0vXig/OlxcKFxcPyhbaWRtc3V4XSopXFwpKT8oLiopLztpZihcInN0cmluZ1wiPT09dHlwZW9mIGEpYT1iLmV4ZWMoYSksYj1udWxsPT1hP251bGw6MT09PU8oYSk/RihhKTp3ZShhKTtlbHNlIHRocm93IG5ldyBUeXBlRXJyb3IoXCJyZS1maW5kIG11c3QgbWF0Y2ggYWdhaW5zdCBhIHN0cmluZy5cIik7UC5jKGIsMCxudWxsKTthPVAuYyhiLDEsbnVsbCk7Yj1QLmMoYiwyLG51bGwpO3JldHVybiBuZXcgUmVnRXhwKGIsYSl9XG5mdW5jdGlvbiB1ZyhhLGIsYyxkLGUsZixoKXt2YXIgaz1qYTt0cnl7amE9bnVsbD09amE/bnVsbDpqYS0xO2lmKG51bGwhPWphJiYwPmphKXJldHVybiB1YihhLFwiI1wiKTt1YihhLGMpO0UoaCkmJihiLmM/Yi5jKEYoaCksYSxmKTpiLmNhbGwobnVsbCxGKGgpLGEsZikpO2Zvcih2YXIgbD1JKGgpLG49cmEuYihmKS0xOzspaWYoIWx8fG51bGwhPW4mJjA9PT1uKXtFKGwpJiYwPT09biYmKHViKGEsZCksdWIoYSxcIi4uLlwiKSk7YnJlYWt9ZWxzZXt1YihhLGQpO2IuYz9iLmMoRihsKSxhLGYpOmIuY2FsbChudWxsLEYobCksYSxmKTt2YXIgcT1JKGwpO2M9bi0xO2w9cTtuPWN9cmV0dXJuIHViKGEsZSl9ZmluYWxseXtqYT1rfX1cbnZhciB2Zz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxkKXt2YXIgZT1udWxsOzE8YXJndW1lbnRzLmxlbmd0aCYmKGU9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSksMCkpO3JldHVybiBiLmNhbGwodGhpcyxhLGUpfWZ1bmN0aW9uIGIoYSxiKXtmb3IodmFyIGU9RShiKSxmPW51bGwsaD0wLGs9MDs7KWlmKGs8aCl7dmFyIGw9Zi5KKG51bGwsayk7dWIoYSxsKTtrKz0xfWVsc2UgaWYoZT1FKGUpKWY9ZSxJYyhmKT8oZT1IYihmKSxoPUliKGYpLGY9ZSxsPU8oZSksZT1oLGg9bCk6KGw9RihmKSx1YihhLGwpLGU9SShmKSxmPW51bGwsaD0wKSxrPTA7ZWxzZSByZXR1cm4gbnVsbH1hLms9MTthLmY9ZnVuY3Rpb24oYSl7dmFyIGQ9RihhKTthPUcoYSk7cmV0dXJuIGIoZCxhKX07YS5kPWI7cmV0dXJuIGF9KCksd2c9eydcIic6J1xcXFxcIicsXCJcXFxcXCI6XCJcXFxcXFxcXFwiLFwiXFxiXCI6XCJcXFxcYlwiLFwiXFxmXCI6XCJcXFxcZlwiLFwiXFxuXCI6XCJcXFxcblwiLFwiXFxyXCI6XCJcXFxcclwiLFwiXFx0XCI6XCJcXFxcdFwifTtcbmZ1bmN0aW9uIHhnKGEpe3JldHVybidcIicrQS5iKGEucmVwbGFjZShSZWdFeHAoJ1tcXFxcXFxcXFwiXFxiXFxmXFxuXFxyXFx0XScsXCJnXCIpLGZ1bmN0aW9uKGEpe3JldHVybiB3Z1thXX0pKSsnXCInfVxudmFyIEFnPWZ1bmN0aW9uIHlnKGIsYyxkKXtpZihudWxsPT1iKXJldHVybiB1YihjLFwibmlsXCIpO2lmKHZvaWQgMD09PWIpcmV0dXJuIHViKGMsXCIjXFx4M2N1bmRlZmluZWRcXHgzZVwiKTtpZih1KXtyKGZ1bmN0aW9uKCl7dmFyIGM9US5hKGQscGEpO3JldHVybiByKGMpPyhjPWI/Yi5pJjEzMTA3Mnx8Yi5lYz8hMDpiLmk/ITE6cyhiYixiKTpzKGJiLGIpKT94YyhiKTpjOmN9KCkpJiYodWIoYyxcIl5cIikseWcoeGMoYiksYyxkKSx1YihjLFwiIFwiKSk7aWYobnVsbD09YilyZXR1cm4gdWIoYyxcIm5pbFwiKTtpZihiLkRiKXJldHVybiBiLlRiKGIsYyxkKTtpZihiJiYoYi5pJjIxNDc0ODM2NDh8fGIuSykpcmV0dXJuIGIudyhudWxsLGMsZCk7aWYodGEoYik9PT1Cb29sZWFufHxcIm51bWJlclwiPT09dHlwZW9mIGIpcmV0dXJuIHViKGMsXCJcIitBLmIoYikpO2lmKG51bGwhPWImJmIuY29uc3RydWN0b3I9PT1PYmplY3QpcmV0dXJuIHViKGMsXCIjanMgXCIpLHpnLm4/emcubihLZC5hKGZ1bmN0aW9uKGMpe3JldHVybiBuZXcgVyhudWxsLFxuMiw1LFgsW2pkLmIoYyksYltjXV0sbnVsbCl9LEpjKGIpKSx5ZyxjLGQpOnpnLmNhbGwobnVsbCxLZC5hKGZ1bmN0aW9uKGMpe3JldHVybiBuZXcgVyhudWxsLDIsNSxYLFtqZC5iKGMpLGJbY11dLG51bGwpfSxKYyhiKSkseWcsYyxkKTtpZihiIGluc3RhbmNlb2YgQXJyYXkpcmV0dXJuIHVnKGMseWcsXCIjanMgW1wiLFwiIFwiLFwiXVwiLGQsYik7aWYoXCJzdHJpbmdcIj09dHlwZW9mIGIpcmV0dXJuIHIob2EuYihkKSk/dWIoYyx4ZyhiKSk6dWIoYyxiKTtpZih1YyhiKSlyZXR1cm4gdmcuZChjLEooW1wiI1xceDNjXCIsXCJcIitBLmIoYiksXCJcXHgzZVwiXSwwKSk7aWYoYiBpbnN0YW5jZW9mIERhdGUpe3ZhciBlPWZ1bmN0aW9uKGIsYyl7Zm9yKHZhciBkPVwiXCIrQS5iKGIpOzspaWYoTyhkKTxjKWQ9XCIwXCIrQS5iKGQpO2Vsc2UgcmV0dXJuIGR9O3JldHVybiB2Zy5kKGMsSihbJyNpbnN0IFwiJyxcIlwiK0EuYihiLmdldFVUQ0Z1bGxZZWFyKCkpLFwiLVwiLGUoYi5nZXRVVENNb250aCgpKzEsMiksXCItXCIsZShiLmdldFVUQ0RhdGUoKSxcbjIpLFwiVFwiLGUoYi5nZXRVVENIb3VycygpLDIpLFwiOlwiLGUoYi5nZXRVVENNaW51dGVzKCksMiksXCI6XCIsZShiLmdldFVUQ1NlY29uZHMoKSwyKSxcIi5cIixlKGIuZ2V0VVRDTWlsbGlzZWNvbmRzKCksMyksXCItXCIsJzAwOjAwXCInXSwwKSl9cmV0dXJuIGIgaW5zdGFuY2VvZiBSZWdFeHA/dmcuZChjLEooWycjXCInLGIuc291cmNlLCdcIiddLDApKTooYj9iLmkmMjE0NzQ4MzY0OHx8Yi5LfHwoYi5pPzA6cyh2YixiKSk6cyh2YixiKSk/d2IoYixjLGQpOnU/dmcuZChjLEooW1wiI1xceDNjXCIsXCJcIitBLmIoYiksXCJcXHgzZVwiXSwwKSk6bnVsbH1yZXR1cm4gbnVsbH07XG5mdW5jdGlvbiBCZyhhLGIpe3ZhciBjPW5ldyBlYTthOnt2YXIgZD1uZXcgS2IoYyk7QWcoRihhKSxkLGIpO2Zvcih2YXIgZT1FKEkoYSkpLGY9bnVsbCxoPTAsaz0wOzspaWYoazxoKXt2YXIgbD1mLkoobnVsbCxrKTt1YihkLFwiIFwiKTtBZyhsLGQsYik7ays9MX1lbHNlIGlmKGU9RShlKSlmPWUsSWMoZik/KGU9SGIoZiksaD1JYihmKSxmPWUsbD1PKGUpLGU9aCxoPWwpOihsPUYoZiksdWIoZCxcIiBcIiksQWcobCxkLGIpLGU9SShmKSxmPW51bGwsaD0wKSxrPTA7ZWxzZSBicmVhayBhfXJldHVybiBjfVxudmFyIENnPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhKXt2YXIgZD1udWxsOzA8YXJndW1lbnRzLmxlbmd0aCYmKGQ9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCksMCkpO3JldHVybiBiLmNhbGwodGhpcyxkKX1mdW5jdGlvbiBiKGEpe3ZhciBiPWthKCk7cmV0dXJuIEJjKGEpP1wiXCI6XCJcIitBLmIoQmcoYSxiKSl9YS5rPTA7YS5mPWZ1bmN0aW9uKGEpe2E9RShhKTtyZXR1cm4gYihhKX07YS5kPWI7cmV0dXJuIGF9KCk7ZnVuY3Rpb24gemcoYSxiLGMsZCl7cmV0dXJuIHVnKGMsZnVuY3Rpb24oYSxjLGQpe2IuYz9iLmMoVGEoYSksYyxkKTpiLmNhbGwobnVsbCxUYShhKSxjLGQpO3ViKGMsXCIgXCIpO3JldHVybiBiLmM/Yi5jKFVhKGEpLGMsZCk6Yi5jYWxsKG51bGwsVWEoYSksYyxkKX0sXCJ7XCIsXCIsIFwiLFwifVwiLGQsRShhKSl9YWMucHJvdG90eXBlLks9ITA7XG5hYy5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHVnKGIsQWcsXCIoXCIsXCIgXCIsXCIpXCIsYyx0aGlzKX07Vi5wcm90b3R5cGUuSz0hMDtWLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdWcoYixBZyxcIihcIixcIiBcIixcIilcIixjLHRoaXMpfTtCZi5wcm90b3R5cGUuSz0hMDtCZi5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHVnKGIsQWcsXCIoXCIsXCIgXCIsXCIpXCIsYyx0aGlzKX07dmYucHJvdG90eXBlLks9ITA7dmYucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB1ZyhiLEFnLFwiKFwiLFwiIFwiLFwiKVwiLGMsdGhpcyl9OyQucHJvdG90eXBlLks9ITA7JC5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHVnKGIsQWcsXCJbXCIsXCIgXCIsXCJdXCIsYyx0aGlzKX07VWUucHJvdG90eXBlLks9ITA7VWUucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB1ZyhiLEFnLFwiKFwiLFwiIFwiLFwiKVwiLGMsdGhpcyl9O1xuY2cucHJvdG90eXBlLks9ITA7Y2cucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB1ZyhiLEFnLFwiI3tcIixcIiBcIixcIn1cIixjLHRoaXMpfTt5ZS5wcm90b3R5cGUuSz0hMDt5ZS5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHVnKGIsQWcsXCIoXCIsXCIgXCIsXCIpXCIsYyx0aGlzKX07Z2QucHJvdG90eXBlLks9ITA7Z2QucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB1ZyhiLEFnLFwiKFwiLFwiIFwiLFwiKVwiLGMsdGhpcyl9O2tjLnByb3RvdHlwZS5LPSEwO2tjLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdWcoYixBZyxcIihcIixcIiBcIixcIilcIixjLHRoaXMpfTt4Zi5wcm90b3R5cGUuSz0hMDt4Zi5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHpnKHRoaXMsQWcsYixjKX07d2YucHJvdG90eXBlLks9ITA7d2YucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB1ZyhiLEFnLFwiKFwiLFwiIFwiLFwiKVwiLGMsdGhpcyl9O1xuQWUucHJvdG90eXBlLks9ITA7QWUucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB1ZyhiLEFnLFwiW1wiLFwiIFwiLFwiXVwiLGMsdGhpcyl9O1FmLnByb3RvdHlwZS5LPSEwO1FmLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gemcodGhpcyxBZyxiLGMpfTskZi5wcm90b3R5cGUuSz0hMDskZi5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHVnKGIsQWcsXCIje1wiLFwiIFwiLFwifVwiLGMsdGhpcyl9O29kLnByb3RvdHlwZS5LPSEwO29kLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdWcoYixBZyxcIihcIixcIiBcIixcIilcIixjLHRoaXMpfTtZZi5wcm90b3R5cGUuSz0hMDtZZi5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHVnKGIsQWcsXCIoXCIsXCIgXCIsXCIpXCIsYyx0aGlzKX07WS5wcm90b3R5cGUuSz0hMDtZLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdWcoYixBZyxcIltcIixcIiBcIixcIl1cIixjLHRoaXMpfTtcblcucHJvdG90eXBlLks9ITA7Vy5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHVnKGIsQWcsXCJbXCIsXCIgXCIsXCJdXCIsYyx0aGlzKX07SGUucHJvdG90eXBlLks9ITA7SGUucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB1ZyhiLEFnLFwiKFwiLFwiIFwiLFwiKVwiLGMsdGhpcyl9O2NkLnByb3RvdHlwZS5LPSEwO2NkLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHViKGIsXCIoKVwiKX07SWUucHJvdG90eXBlLks9ITA7SWUucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB1ZyhiLEFnLFwiI3F1ZXVlIFtcIixcIiBcIixcIl1cIixjLEUodGhpcykpfTtsYS5wcm90b3R5cGUuSz0hMDtsYS5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHpnKHRoaXMsQWcsYixjKX07b2cucHJvdG90eXBlLks9ITA7b2cucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB1ZyhiLEFnLFwiKFwiLFwiIFwiLFwiKVwiLGMsdGhpcyl9O1xuWGYucHJvdG90eXBlLks9ITA7WGYucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB1ZyhiLEFnLFwiKFwiLFwiIFwiLFwiKVwiLGMsdGhpcyl9O2JkLnByb3RvdHlwZS5LPSEwO2JkLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdWcoYixBZyxcIihcIixcIiBcIixcIilcIixjLHRoaXMpfTtXLnByb3RvdHlwZS5sYj0hMDtXLnByb3RvdHlwZS5tYj1mdW5jdGlvbihhLGIpe3JldHVybiBQYy5hKHRoaXMsYil9O0FlLnByb3RvdHlwZS5sYj0hMDtBZS5wcm90b3R5cGUubWI9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gUGMuYSh0aGlzLGIpfTtULnByb3RvdHlwZS5sYj0hMDtULnByb3RvdHlwZS5tYj1mdW5jdGlvbihhLGIpe3JldHVybiBWYih0aGlzLGIpfTtaYi5wcm90b3R5cGUubGI9ITA7WmIucHJvdG90eXBlLm1iPWZ1bmN0aW9uKGEsYil7cmV0dXJuIFZiKHRoaXMsYil9O1xuZnVuY3Rpb24gRGcoYSxiKXtpZihhP2EuZ2M6YSlyZXR1cm4gYS5nYyhhLGIpO3ZhciBjO2M9RGdbbShudWxsPT1hP251bGw6YSldO2lmKCFjJiYoYz1EZy5fLCFjKSl0aHJvdyB4KFwiSVJlc2V0Li1yZXNldCFcIixhKTtyZXR1cm4gYy5jYWxsKG51bGwsYSxiKX1cbnZhciBFZz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMsZCxlKXtpZihhP2EubmM6YSlyZXR1cm4gYS5uYyhhLGIsYyxkLGUpO3ZhciBxO3E9RWdbbShudWxsPT1hP251bGw6YSldO2lmKCFxJiYocT1FZy5fLCFxKSl0aHJvdyB4KFwiSVN3YXAuLXN3YXAhXCIsYSk7cmV0dXJuIHEuY2FsbChudWxsLGEsYixjLGQsZSl9ZnVuY3Rpb24gYihhLGIsYyxkKXtpZihhP2EubWM6YSlyZXR1cm4gYS5tYyhhLGIsYyxkKTt2YXIgZTtlPUVnW20obnVsbD09YT9udWxsOmEpXTtpZighZSYmKGU9RWcuXywhZSkpdGhyb3cgeChcIklTd2FwLi1zd2FwIVwiLGEpO3JldHVybiBlLmNhbGwobnVsbCxhLGIsYyxkKX1mdW5jdGlvbiBjKGEsYixjKXtpZihhP2EubGM6YSlyZXR1cm4gYS5sYyhhLGIsYyk7dmFyIGQ7ZD1FZ1ttKG51bGw9PWE/bnVsbDphKV07aWYoIWQmJihkPUVnLl8sIWQpKXRocm93IHgoXCJJU3dhcC4tc3dhcCFcIixhKTtyZXR1cm4gZC5jYWxsKG51bGwsYSxiLGMpfWZ1bmN0aW9uIGQoYSxiKXtpZihhP1xuYS5rYzphKXJldHVybiBhLmtjKGEsYik7dmFyIGM7Yz1FZ1ttKG51bGw9PWE/bnVsbDphKV07aWYoIWMmJihjPUVnLl8sIWMpKXRocm93IHgoXCJJU3dhcC4tc3dhcCFcIixhKTtyZXR1cm4gYy5jYWxsKG51bGwsYSxiKX12YXIgZT1udWxsLGU9ZnVuY3Rpb24oZSxoLGssbCxuKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBkLmNhbGwodGhpcyxlLGgpO2Nhc2UgMzpyZXR1cm4gYy5jYWxsKHRoaXMsZSxoLGspO2Nhc2UgNDpyZXR1cm4gYi5jYWxsKHRoaXMsZSxoLGssbCk7Y2FzZSA1OnJldHVybiBhLmNhbGwodGhpcyxlLGgsayxsLG4pfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtlLmE9ZDtlLmM9YztlLm49YjtlLnM9YTtyZXR1cm4gZX0oKTtmdW5jdGlvbiBGZyhhLGIsYyxkKXt0aGlzLnN0YXRlPWE7dGhpcy5qPWI7dGhpcy53Yz1jO3RoaXMuV2I9ZDt0aGlzLmk9MjE1MzkzODk0NDt0aGlzLnE9MTYzODZ9Zz1GZy5wcm90b3R5cGU7XG5nLkI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc1tiYV18fCh0aGlzW2JhXT0rK2NhKX07Zy5SYj1mdW5jdGlvbihhLGIsYyl7YT1FKHRoaXMuV2IpO2Zvcih2YXIgZD1udWxsLGU9MCxmPTA7OylpZihmPGUpe3ZhciBoPWQuSihudWxsLGYpLGs9UC5jKGgsMCxudWxsKSxoPVAuYyhoLDEsbnVsbCk7aC5uP2gubihrLHRoaXMsYixjKTpoLmNhbGwobnVsbCxrLHRoaXMsYixjKTtmKz0xfWVsc2UgaWYoYT1FKGEpKUljKGEpPyhkPUhiKGEpLGE9SWIoYSksaz1kLGU9TyhkKSxkPWspOihkPUYoYSksaz1QLmMoZCwwLG51bGwpLGg9UC5jKGQsMSxudWxsKSxoLm4/aC5uKGssdGhpcyxiLGMpOmguY2FsbChudWxsLGssdGhpcyxiLGMpLGE9SShhKSxkPW51bGwsZT0wKSxmPTA7ZWxzZSByZXR1cm4gbnVsbH07Zy53PWZ1bmN0aW9uKGEsYixjKXt1YihiLFwiI1xceDNjQXRvbTogXCIpO0FnKHRoaXMuc3RhdGUsYixjKTtyZXR1cm4gdWIoYixcIlxceDNlXCIpfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5qfTtcbmcudWI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zdGF0ZX07Zy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXM9PT1ifTtcbnZhciBIZz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSl7cmV0dXJuIG5ldyBGZyhhLG51bGwsbnVsbCxudWxsKX12YXIgYj1udWxsLGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGMsZCl7dmFyIGs9bnVsbDsxPGFyZ3VtZW50cy5sZW5ndGgmJihrPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYyxrKX1mdW5jdGlvbiBiKGEsYyl7dmFyIGQ9TWMoYyk/Uy5hKFRmLGMpOmMsZT1RLmEoZCxHZyksZD1RLmEoZCxwYSk7cmV0dXJuIG5ldyBGZyhhLGQsZSxudWxsKX1hLms9MTthLmY9ZnVuY3Rpb24oYSl7dmFyIGM9RihhKTthPUcoYSk7cmV0dXJuIGIoYyxhKX07YS5kPWI7cmV0dXJuIGF9KCksYj1mdW5jdGlvbihiLGUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGEuY2FsbCh0aGlzLGIpO2RlZmF1bHQ6cmV0dXJuIGMuZChiLEooYXJndW1lbnRzLDEpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK1xuYXJndW1lbnRzLmxlbmd0aCk7fTtiLms9MTtiLmY9Yy5mO2IuYj1hO2IuZD1jLmQ7cmV0dXJuIGJ9KCk7ZnVuY3Rpb24gSWcoYSxiKXtpZihhIGluc3RhbmNlb2YgRmcpe3ZhciBjPWEud2M7aWYobnVsbCE9YyYmIXIoYy5iP2MuYihiKTpjLmNhbGwobnVsbCxiKSkpdGhyb3cgRXJyb3IoXCJBc3NlcnQgZmFpbGVkOiBWYWxpZGF0b3IgcmVqZWN0ZWQgcmVmZXJlbmNlIHN0YXRlXFxuXCIrQS5iKENnLmQoSihbZmQobmV3IFpiKG51bGwsXCJ2YWxpZGF0ZVwiLFwidmFsaWRhdGVcIiwxNDM5MjMwNzAwLG51bGwpLG5ldyBaYihudWxsLFwibmV3LXZhbHVlXCIsXCJuZXctdmFsdWVcIiwtMTU2NzM5NzQwMSxudWxsKSldLDApKSkpO2M9YS5zdGF0ZTthLnN0YXRlPWI7bnVsbCE9YS5XYiYmeGIoYSxjLGIpO3JldHVybiBifXJldHVybiBEZyhhLGIpfWZ1bmN0aW9uIEsoYSl7cmV0dXJuIGFiKGEpfVxudmFyIEpnPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyxkKXtyZXR1cm4gYSBpbnN0YW5jZW9mIEZnP0lnKGEsYi5jP2IuYyhhLnN0YXRlLGMsZCk6Yi5jYWxsKG51bGwsYS5zdGF0ZSxjLGQpKTpFZy5uKGEsYixjLGQpfWZ1bmN0aW9uIGIoYSxiLGMpe3JldHVybiBhIGluc3RhbmNlb2YgRmc/SWcoYSxiLmE/Yi5hKGEuc3RhdGUsYyk6Yi5jYWxsKG51bGwsYS5zdGF0ZSxjKSk6RWcuYyhhLGIsYyl9ZnVuY3Rpb24gYyhhLGIpe3JldHVybiBhIGluc3RhbmNlb2YgRmc/SWcoYSxiLmI/Yi5iKGEuc3RhdGUpOmIuY2FsbChudWxsLGEuc3RhdGUpKTpFZy5hKGEsYil9dmFyIGQ9bnVsbCxlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShjLGQsZSxmLHQpe3ZhciB2PW51bGw7NDxhcmd1bWVudHMubGVuZ3RoJiYodj1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyw0KSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGMsZCxlLGYsdil9ZnVuY3Rpb24gYihhLGMsZCxlLGYpe3JldHVybiBhIGluc3RhbmNlb2ZcbkZnP0lnKGEsUy5zKGMsYS5zdGF0ZSxkLGUsZikpOkVnLnMoYSxjLGQsZSxmKX1hLms9NDthLmY9ZnVuY3Rpb24oYSl7dmFyIGM9RihhKTthPUkoYSk7dmFyIGQ9RihhKTthPUkoYSk7dmFyIGU9RihhKTthPUkoYSk7dmFyIGY9RihhKTthPUcoYSk7cmV0dXJuIGIoYyxkLGUsZixhKX07YS5kPWI7cmV0dXJuIGF9KCksZD1mdW5jdGlvbihkLGgsayxsLG4pe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGMuY2FsbCh0aGlzLGQsaCk7Y2FzZSAzOnJldHVybiBiLmNhbGwodGhpcyxkLGgsayk7Y2FzZSA0OnJldHVybiBhLmNhbGwodGhpcyxkLGgsayxsKTtkZWZhdWx0OnJldHVybiBlLmQoZCxoLGssbCxKKGFyZ3VtZW50cyw0KSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Quaz00O2QuZj1lLmY7ZC5hPWM7ZC5jPWI7ZC5uPWE7ZC5kPWUuZDtyZXR1cm4gZH0oKSxLZz17fTtcbmZ1bmN0aW9uIExnKGEpe2lmKGE/YS5hYzphKXJldHVybiBhLmFjKGEpO3ZhciBiO2I9TGdbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj1MZy5fLCFiKSl0aHJvdyB4KFwiSUVuY29kZUpTLi1jbGotXFx4M2Vqc1wiLGEpO3JldHVybiBiLmNhbGwobnVsbCxhKX1mdW5jdGlvbiBNZyhhKXtyZXR1cm4oYT9yKHIobnVsbCk/bnVsbDphLiRiKXx8KGEuQ2I/MDpzKEtnLGEpKTpzKEtnLGEpKT9MZyhhKTpcInN0cmluZ1wiPT09dHlwZW9mIGF8fFwibnVtYmVyXCI9PT10eXBlb2YgYXx8YSBpbnN0YW5jZW9mIFR8fGEgaW5zdGFuY2VvZiBaYj9OZy5iP05nLmIoYSk6TmcuY2FsbChudWxsLGEpOkNnLmQoSihbYV0sMCkpfVxudmFyIE5nPWZ1bmN0aW9uIE9nKGIpe2lmKG51bGw9PWIpcmV0dXJuIG51bGw7aWYoYj9yKHIobnVsbCk/bnVsbDpiLiRiKXx8KGIuQ2I/MDpzKEtnLGIpKTpzKEtnLGIpKXJldHVybiBMZyhiKTtpZihiIGluc3RhbmNlb2YgVClyZXR1cm4gaWQoYik7aWYoYiBpbnN0YW5jZW9mIFpiKXJldHVyblwiXCIrQS5iKGIpO2lmKEdjKGIpKXt2YXIgYz17fTtiPUUoYik7Zm9yKHZhciBkPW51bGwsZT0wLGY9MDs7KWlmKGY8ZSl7dmFyIGg9ZC5KKG51bGwsZiksaz1QLmMoaCwwLG51bGwpLGg9UC5jKGgsMSxudWxsKTtjW01nKGspXT1PZyhoKTtmKz0xfWVsc2UgaWYoYj1FKGIpKUljKGIpPyhlPUhiKGIpLGI9SWIoYiksZD1lLGU9TyhlKSk6KGU9RihiKSxkPVAuYyhlLDAsbnVsbCksZT1QLmMoZSwxLG51bGwpLGNbTWcoZCldPU9nKGUpLGI9SShiKSxkPW51bGwsZT0wKSxmPTA7ZWxzZSBicmVhaztyZXR1cm4gY31pZihDYyhiKSl7Yz1bXTtiPUUoS2QuYShPZyxiKSk7ZD1udWxsO2ZvcihmPWU9MDs7KWlmKGY8XG5lKWs9ZC5KKG51bGwsZiksYy5wdXNoKGspLGYrPTE7ZWxzZSBpZihiPUUoYikpZD1iLEljKGQpPyhiPUhiKGQpLGY9SWIoZCksZD1iLGU9TyhiKSxiPWYpOihiPUYoZCksYy5wdXNoKGIpLGI9SShkKSxkPW51bGwsZT0wKSxmPTA7ZWxzZSBicmVhaztyZXR1cm4gY31yZXR1cm4gdT9iOm51bGx9LFBnPXt9O2Z1bmN0aW9uIFFnKGEsYil7aWYoYT9hLlpiOmEpcmV0dXJuIGEuWmIoYSxiKTt2YXIgYztjPVFnW20obnVsbD09YT9udWxsOmEpXTtpZighYyYmKGM9UWcuXywhYykpdGhyb3cgeChcIklFbmNvZGVDbG9qdXJlLi1qcy1cXHgzZWNsalwiLGEpO3JldHVybiBjLmNhbGwobnVsbCxhLGIpfVxudmFyIFNnPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhKXtyZXR1cm4gYi5kKGEsSihbbmV3IGxhKG51bGwsMSxbUmcsITFdLG51bGwpXSwwKSl9dmFyIGI9bnVsbCxjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShjLGQpe3ZhciBrPW51bGw7MTxhcmd1bWVudHMubGVuZ3RoJiYoaz1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGMsayl9ZnVuY3Rpb24gYihhLGMpe2lmKGE/cihyKG51bGwpP251bGw6YS5DYyl8fChhLkNiPzA6cyhQZyxhKSk6cyhQZyxhKSlyZXR1cm4gUWcoYSxTLmEoVWYsYykpO2lmKEUoYykpe3ZhciBkPU1jKGMpP1MuYShUZixjKTpjLGU9US5hKGQsUmcpO3JldHVybiBmdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4gZnVuY3Rpb24geShlKXtyZXR1cm4gTWMoZSk/cmcuYihLZC5hKHksZSkpOkNjKGUpP1lkKHFjKGUpLEtkLmEoeSxlKSk6ZSBpbnN0YW5jZW9mIEFycmF5P3dlKEtkLmEoeSxlKSk6dGEoZSk9PT1cbk9iamVjdD9ZZChZZSxmdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4gZnVuY3Rpb24gUmEoZil7cmV0dXJuIG5ldyBWKG51bGwsZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIGZ1bmN0aW9uKCl7Zm9yKDs7KXt2YXIgYT1FKGYpO2lmKGEpe2lmKEljKGEpKXt2YXIgYj1IYihhKSxjPU8oYiksaD1uZXcgbGQoQXJyYXkoYyksMCk7YTp7Zm9yKHZhciBrPTA7OylpZihrPGMpe3ZhciBsPUQuYShiLGspLGw9bmV3IFcobnVsbCwyLDUsWCxbZC5iP2QuYihsKTpkLmNhbGwobnVsbCxsKSx5KGVbbF0pXSxudWxsKTtoLmFkZChsKTtrKz0xfWVsc2V7Yj0hMDticmVhayBhfWI9dm9pZCAwfXJldHVybiBiP3BkKGguZGEoKSxSYShJYihhKSkpOnBkKGguZGEoKSxudWxsKX1oPUYoYSk7cmV0dXJuIE0obmV3IFcobnVsbCwyLDUsWCxbZC5iP2QuYihoKTpkLmNhbGwobnVsbCxoKSx5KGVbaF0pXSxudWxsKSxSYShHKGEpKSl9cmV0dXJuIG51bGx9fX0oYSxiLGMsZCksbnVsbCxcbm51bGwpfX0oYSxiLGMsZCkoSmMoZSkpfSgpKTp1P2U6bnVsbH19KGMsZCxlLHIoZSk/amQ6QSkoYSl9cmV0dXJuIG51bGx9YS5rPTE7YS5mPWZ1bmN0aW9uKGEpe3ZhciBjPUYoYSk7YT1HKGEpO3JldHVybiBiKGMsYSl9O2EuZD1iO3JldHVybiBhfSgpLGI9ZnVuY3Rpb24oYixlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBhLmNhbGwodGhpcyxiKTtkZWZhdWx0OnJldHVybiBjLmQoYixKKGFyZ3VtZW50cywxKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Iuaz0xO2IuZj1jLmY7Yi5iPWE7Yi5kPWMuZDtyZXR1cm4gYn0oKTtmdW5jdGlvbiBUZyhhKXt0aGlzLnBiPWE7dGhpcy5xPTA7dGhpcy5pPTIxNTM3NzUxMDR9XG5UZy5wcm90b3R5cGUuQj1mdW5jdGlvbigpe2Zvcih2YXIgYT1DZy5kKEooW3RoaXNdLDApKSxiPTAsYz0wO2M8YS5sZW5ndGg7KytjKWI9MzEqYithLmNoYXJDb2RlQXQoYyksYiU9NDI5NDk2NzI5NjtyZXR1cm4gYn07VGcucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdWIoYiwnI3V1aWQgXCInK0EuYih0aGlzLnBiKSsnXCInKX07VGcucHJvdG90eXBlLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYiBpbnN0YW5jZW9mIFRnJiZ0aGlzLnBiPT09Yi5wYn07VGcucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucGJ9O3ZhciBVZz1uZXcgVChudWxsLFwicHBhdGhcIixcInBwYXRoXCIpLFZnPW5ldyBUKFwiemlwXCIsXCJicmFuY2g/XCIsXCJ6aXAvYnJhbmNoP1wiKSxXZz1uZXcgVChudWxsLFwiclwiLFwiclwiKSxYZz1uZXcgVChcInppcFwiLFwiY2hpbGRyZW5cIixcInppcC9jaGlsZHJlblwiKSxwYT1uZXcgVChudWxsLFwibWV0YVwiLFwibWV0YVwiKSxxYT1uZXcgVChudWxsLFwiZHVwXCIsXCJkdXBcIiksdT1uZXcgVChudWxsLFwiZWxzZVwiLFwiZWxzZVwiKSxHZz1uZXcgVChudWxsLFwidmFsaWRhdG9yXCIsXCJ2YWxpZGF0b3JcIiksWWI9bmV3IFQobnVsbCxcImRlZmF1bHRcIixcImRlZmF1bHRcIiksWWc9bmV3IFQobnVsbCxcInNlcXVlbnRpYWxcIixcInNlcXVlbnRpYWxcIiksbWE9bmV3IFQobnVsbCxcImZsdXNoLW9uLW5ld2xpbmVcIixcImZsdXNoLW9uLW5ld2xpbmVcIiksWmc9bmV3IFQobnVsbCxcImxcIixcImxcIiksJGc9bmV3IFQoXCJ6aXBcIixcIm1ha2Utbm9kZVwiLFwiemlwL21ha2Utbm9kZVwiKSxvYT1uZXcgVChudWxsLFwicmVhZGFibHlcIixcInJlYWRhYmx5XCIpLHJhPW5ldyBUKG51bGwsXG5cInByaW50LWxlbmd0aFwiLFwicHJpbnQtbGVuZ3RoXCIpLGFoPW5ldyBUKG51bGwsXCJwbm9kZXNcIixcInBub2Rlc1wiKSxiaD1uZXcgVChudWxsLFwiY2hhbmdlZD9cIixcImNoYW5nZWQ/XCIpLGNoPW5ldyBUKG51bGwsXCJ0YWdcIixcInRhZ1wiKSxkaD1uZXcgVChudWxsLFwic2V0XCIsXCJzZXRcIiksZWg9bmV3IFQobnVsbCxcImVuZFwiLFwiZW5kXCIpLGZoPW5ldyBUKG51bGwsXCJhdG9tXCIsXCJhdG9tXCIpLFJnPW5ldyBUKG51bGwsXCJrZXl3b3JkaXplLWtleXNcIixcImtleXdvcmRpemUta2V5c1wiKSxnaD1uZXcgVChudWxsLFwibWFwXCIsXCJtYXBcIiksaGg9bmV3IFQoXCJtb3JpXCIsXCJub3QtZm91bmRcIixcIm1vcmkvbm90LWZvdW5kXCIpLGloPW5ldyBUKFwiY2xqcy5jb3JlXCIsXCJub3QtZm91bmRcIixcImNsanMuY29yZS9ub3QtZm91bmRcIik7dmFyIGpoLGtoO2Z1bmN0aW9uIGxoKGEpe3JldHVybiBhLm8/YS5vKCk6YS5jYWxsKG51bGwpfWZ1bmN0aW9uIG1oKGEpe3JldHVybiBhLm8/YS5vKCk6YS5jYWxsKG51bGwpfXZhciBuaD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMpe3JldHVybiBHYyhjKT9oYihjLGEsYik6bnVsbD09Yz9iOmMgaW5zdGFuY2VvZiBBcnJheT9oYy5jKGMsYSxiKTp1P2diLmMoYyxhLGIpOm51bGx9ZnVuY3Rpb24gYihhLGIpe3JldHVybiBjLmMoYSxhLm8/YS5vKCk6YS5jYWxsKG51bGwpLGIpfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gYi5jYWxsKHRoaXMsYyxlKTtjYXNlIDM6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSxmKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5hPWI7Yy5jPWE7cmV0dXJuIGN9KCk7XG5mdW5jdGlvbiBvaChhLGIsYyxkKXtpZihhP2EuRWI6YSlyZXR1cm4gYS5FYihhLGIsYyxkKTt2YXIgZTtlPW9oW20obnVsbD09YT9udWxsOmEpXTtpZighZSYmKGU9b2guXywhZSkpdGhyb3cgeChcIkNvbGxGb2xkLmNvbGwtZm9sZFwiLGEpO3JldHVybiBlLmNhbGwobnVsbCxhLGIsYyxkKX1cbnZhciBxaD1mdW5jdGlvbiBwaChiLGMpe1widW5kZWZpbmVkXCI9PT10eXBlb2YgamgmJihqaD1mdW5jdGlvbihiLGMsZixoKXt0aGlzLiQ9Yjt0aGlzLlFhPWM7dGhpcy51Yz1mO3RoaXMuc2M9aDt0aGlzLnE9MDt0aGlzLmk9OTE3NTA0fSxqaC5EYj0hMCxqaC5CYj1cImNsb2p1cmUuY29yZS5yZWR1Y2Vycy90NjMyMlwiLGpoLlRiPWZ1bmN0aW9uKGIsYyl7cmV0dXJuIHViKGMsXCJjbG9qdXJlLmNvcmUucmVkdWNlcnMvdDYzMjJcIil9LGpoLnByb3RvdHlwZS5OPWZ1bmN0aW9uKGIsYyl7cmV0dXJuIGdiLmModGhpcyxjLGMubz9jLm8oKTpjLmNhbGwobnVsbCkpfSxqaC5wcm90b3R5cGUuTT1mdW5jdGlvbihiLGMsZil7cmV0dXJuIGdiLmModGhpcy5RYSx0aGlzLiQuYj90aGlzLiQuYihjKTp0aGlzLiQuY2FsbChudWxsLGMpLGYpfSxqaC5wcm90b3R5cGUuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnNjfSxqaC5wcm90b3R5cGUuRj1mdW5jdGlvbihiLGMpe3JldHVybiBuZXcgamgodGhpcy4kLFxudGhpcy5RYSx0aGlzLnVjLGMpfSk7cmV0dXJuIG5ldyBqaChjLGIscGgsbnVsbCl9LHNoPWZ1bmN0aW9uIHJoKGIsYyl7XCJ1bmRlZmluZWRcIj09PXR5cGVvZiBraCYmKGtoPWZ1bmN0aW9uKGIsYyxmLGgpe3RoaXMuJD1iO3RoaXMuUWE9Yzt0aGlzLnJjPWY7dGhpcy50Yz1oO3RoaXMucT0wO3RoaXMuaT05MTc1MDR9LGtoLkRiPSEwLGtoLkJiPVwiY2xvanVyZS5jb3JlLnJlZHVjZXJzL3Q2MzI4XCIsa2guVGI9ZnVuY3Rpb24oYixjKXtyZXR1cm4gdWIoYyxcImNsb2p1cmUuY29yZS5yZWR1Y2Vycy90NjMyOFwiKX0sa2gucHJvdG90eXBlLkViPWZ1bmN0aW9uKGIsYyxmLGgpe3JldHVybiBvaCh0aGlzLlFhLGMsZix0aGlzLiQuYj90aGlzLiQuYihoKTp0aGlzLiQuY2FsbChudWxsLGgpKX0sa2gucHJvdG90eXBlLk49ZnVuY3Rpb24oYixjKXtyZXR1cm4gZ2IuYyh0aGlzLlFhLHRoaXMuJC5iP3RoaXMuJC5iKGMpOnRoaXMuJC5jYWxsKG51bGwsYyksYy5vP2MubygpOmMuY2FsbChudWxsKSl9LFxua2gucHJvdG90eXBlLk09ZnVuY3Rpb24oYixjLGYpe3JldHVybiBnYi5jKHRoaXMuUWEsdGhpcy4kLmI/dGhpcy4kLmIoYyk6dGhpcy4kLmNhbGwobnVsbCxjKSxmKX0sa2gucHJvdG90eXBlLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50Y30sa2gucHJvdG90eXBlLkY9ZnVuY3Rpb24oYixjKXtyZXR1cm4gbmV3IGtoKHRoaXMuJCx0aGlzLlFhLHRoaXMucmMsYyl9KTtyZXR1cm4gbmV3IGtoKGMsYixyaCxudWxsKX0sdGg9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7cmV0dXJuIHNoKGIsZnVuY3Rpb24oYil7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGM9bnVsbDtyZXR1cm4gYz1mdW5jdGlvbihjLGUsaCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMDpyZXR1cm4gYi5vP2IubygpOmIuY2FsbChudWxsKTtjYXNlIDI6cmV0dXJuIGIuYT9iLmEoYyxhLmI/YS5iKGUpOmEuY2FsbChudWxsLGUpKTpiLmNhbGwobnVsbCxjLGEuYj9hLmIoZSk6YS5jYWxsKG51bGwsZSkpO2Nhc2UgMzpyZXR1cm4gYi5hP1xuYi5hKGMsYS5hP2EuYShlLGgpOmEuY2FsbChudWxsLGUsaCkpOmIuY2FsbChudWxsLGMsYS5hP2EuYShlLGgpOmEuY2FsbChudWxsLGUsaCkpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fX0oKX0pfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIGZ1bmN0aW9uKGIpe3JldHVybiBjLmEoYSxiKX19dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYi5jYWxsKHRoaXMsYyk7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxjLGUpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmI9YjtjLmE9YTtyZXR1cm4gY30oKSx1aD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4gc2goYixmdW5jdGlvbihiKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgYz1udWxsO3JldHVybiBjPWZ1bmN0aW9uKGMsZSxoKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAwOnJldHVybiBiLm8/XG5iLm8oKTpiLmNhbGwobnVsbCk7Y2FzZSAyOnJldHVybiByKGEuYj9hLmIoZSk6YS5jYWxsKG51bGwsZSkpP2IuYT9iLmEoYyxlKTpiLmNhbGwobnVsbCxjLGUpOmM7Y2FzZSAzOnJldHVybiByKGEuYT9hLmEoZSxoKTphLmNhbGwobnVsbCxlLGgpKT9iLmM/Yi5jKGMsZSxoKTpiLmNhbGwobnVsbCxjLGUsaCk6Y310aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO319KCl9KX1mdW5jdGlvbiBiKGEpe3JldHVybiBmdW5jdGlvbihiKXtyZXR1cm4gYy5hKGEsYil9fXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGIuY2FsbCh0aGlzLGMpO2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5iPWI7Yy5hPWE7cmV0dXJuIGN9KCksdmg9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEpe3JldHVybiBzaChhLFxuZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGI9bnVsbDtyZXR1cm4gYj1mdW5jdGlvbihiLGQpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDA6cmV0dXJuIGEubz9hLm8oKTphLmNhbGwobnVsbCk7Y2FzZSAyOnJldHVybiBGYyhkKT9jLmIoZCkuTShudWxsLGEsYik6YS5hP2EuYShiLGQpOmEuY2FsbChudWxsLGIsZCl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9fSgpfSl9ZnVuY3Rpb24gYigpe3JldHVybiBmdW5jdGlvbihhKXtyZXR1cm4gYy5iKGEpfX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMDpyZXR1cm4gYi5jYWxsKHRoaXMpO2Nhc2UgMTpyZXR1cm4gYS5jYWxsKHRoaXMsYyl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Mubz1iO2MuYj1hO3JldHVybiBjfSgpLHdoPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLFxuYil7cmV0dXJuIHVoLmEoR2QoYSksYil9ZnVuY3Rpb24gYihhKXtyZXR1cm4gZnVuY3Rpb24oYil7cmV0dXJuIGMuYShhLGIpfX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBiLmNhbGwodGhpcyxjKTtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYj1iO2MuYT1hO3JldHVybiBjfSgpLHhoPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3JldHVybiBxaChiLGZ1bmN0aW9uKGIpe3JldHVybiBmdW5jdGlvbigpe3ZhciBjPW51bGw7cmV0dXJuIGM9ZnVuY3Rpb24oYyxlLGgpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDA6cmV0dXJuIGIubz9iLm8oKTpiLmNhbGwobnVsbCk7Y2FzZSAyOnJldHVybiByKGEuYj9hLmIoZSk6YS5jYWxsKG51bGwsZSkpP2IuYT9iLmEoYyxlKTpiLmNhbGwobnVsbCxjLGUpOlxubmV3IGVjKGMpO2Nhc2UgMzpyZXR1cm4gcihhLmE/YS5hKGUsaCk6YS5jYWxsKG51bGwsZSxoKSk/Yi5jP2IuYyhjLGUsaCk6Yi5jYWxsKG51bGwsYyxlLGgpOm5ldyBlYyhjKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO319KCl9KX1mdW5jdGlvbiBiKGEpe3JldHVybiBmdW5jdGlvbihiKXtyZXR1cm4gYy5hKGEsYil9fXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGIuY2FsbCh0aGlzLGMpO2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5iPWI7Yy5hPWE7cmV0dXJuIGN9KCkseWg9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7cmV0dXJuIHFoKGIsZnVuY3Rpb24oYil7cmV0dXJuIGZ1bmN0aW9uKGEpe3JldHVybiBmdW5jdGlvbigpe3ZhciBjPW51bGw7cmV0dXJuIGM9XG5mdW5jdGlvbihjLGQsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMDpyZXR1cm4gYi5vP2IubygpOmIuY2FsbChudWxsKTtjYXNlIDI6cmV0dXJuIEpnLmEoYSxXYyksMD5hYihhKT9uZXcgZWMoYyk6Yi5hP2IuYShjLGQpOmIuY2FsbChudWxsLGMsZCk7Y2FzZSAzOnJldHVybiBKZy5hKGEsV2MpLDA+YWIoYSk/bmV3IGVjKGMpOmIuYz9iLmMoYyxkLGUpOmIuY2FsbChudWxsLGMsZCxlKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO319KCl9KEhnLmIoYSkpfSl9ZnVuY3Rpb24gYihhKXtyZXR1cm4gZnVuY3Rpb24oYil7cmV0dXJuIGMuYShhLGIpfX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBiLmNhbGwodGhpcyxjKTtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTtcbn07Yy5iPWI7Yy5hPWE7cmV0dXJuIGN9KCksemg9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7cmV0dXJuIHFoKGIsZnVuY3Rpb24oYil7cmV0dXJuIGZ1bmN0aW9uKGEpe3JldHVybiBmdW5jdGlvbigpe3ZhciBjPW51bGw7cmV0dXJuIGM9ZnVuY3Rpb24oYyxkLGUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDA6cmV0dXJuIGIubz9iLm8oKTpiLmNhbGwobnVsbCk7Y2FzZSAyOnJldHVybiBKZy5hKGEsV2MpLDA+YWIoYSk/Yi5hP2IuYShjLGQpOmIuY2FsbChudWxsLGMsZCk6YztjYXNlIDM6cmV0dXJuIEpnLmEoYSxXYyksMD5hYihhKT9iLmM/Yi5jKGMsZCxlKTpiLmNhbGwobnVsbCxjLGQsZSk6Y310aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO319KCl9KEhnLmIoYSkpfSl9ZnVuY3Rpb24gYihhKXtyZXR1cm4gZnVuY3Rpb24oYil7cmV0dXJuIGMuYShhLGIpfX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBiLmNhbGwodGhpcyxcbmMpO2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5iPWI7Yy5hPWE7cmV0dXJuIGN9KCksQmg9ZnVuY3Rpb24gQWgoYixjLGQsZSl7aWYoQmMoYikpcmV0dXJuIGQubz9kLm8oKTpkLmNhbGwobnVsbCk7aWYoTyhiKTw9YylyZXR1cm4gbmguYyhlLGQubz9kLm8oKTpkLmNhbGwobnVsbCksYik7aWYodSl7dmFyIGY9WWMoTyhiKSksaD16ZS5jKGIsMCxmKTtiPXplLmMoYixmLE8oYikpO3JldHVybiBsaChmdW5jdGlvbihiLGMsZSxmKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgYj1mKGMpLGg7aD1mKGUpO3JldHVybiBkLmE/ZC5hKGIubz9iLm8oKTpiLmNhbGwobnVsbCksbWgoaCkpOmQuY2FsbChudWxsLGIubz9iLm8oKTpiLmNhbGwobnVsbCksbWgoaCkpfX0oZixoLGIsZnVuY3Rpb24oYixmLGgpe3JldHVybiBmdW5jdGlvbihxKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gQWgocSxcbmMsZCxlKX19KGIsZixoKX19KGYsaCxiKSkpfXJldHVybiBudWxsfTtXLnByb3RvdHlwZS5FYj1mdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4gQmgodGhpcyxiLGMsZCl9O29oLm9iamVjdD1mdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4gbmguYyhkLGMubz9jLm8oKTpjLmNhbGwobnVsbCksYSl9O29oW1wibnVsbFwiXT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIGMubz9jLm8oKTpjLmNhbGwobnVsbCl9O2Z1bmN0aW9uIENoKGEsYil7dmFyIGM9Uy5jKGlnLGEsYik7cmV0dXJuIE0oYyxWZChmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oYil7cmV0dXJuIGE9PT1ifX0oYyksYikpfVxudmFyIERoPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3JldHVybiBPKGEpPE8oYik/Qy5jKHBjLGIsYSk6Qy5jKHBjLGEsYil9dmFyIGI9bnVsbCxjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShjLGQsayl7dmFyIGw9bnVsbDsyPGFyZ3VtZW50cy5sZW5ndGgmJihsPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYyxkLGwpfWZ1bmN0aW9uIGIoYSxjLGQpe2E9Q2goTyxwYy5kKGQsYyxKKFthXSwwKSkpO3JldHVybiBDLmMoWWQsRihhKSxHKGEpKX1hLms9MjthLmY9ZnVuY3Rpb24oYSl7dmFyIGM9RihhKTthPUkoYSk7dmFyIGQ9RihhKTthPUcoYSk7cmV0dXJuIGIoYyxkLGEpfTthLmQ9YjtyZXR1cm4gYX0oKSxiPWZ1bmN0aW9uKGIsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAwOnJldHVybiBiZztjYXNlIDE6cmV0dXJuIGI7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxiLGUpO2RlZmF1bHQ6cmV0dXJuIGMuZChiLFxuZSxKKGFyZ3VtZW50cywyKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Iuaz0yO2IuZj1jLmY7Yi5vPWZ1bmN0aW9uKCl7cmV0dXJuIGJnfTtiLmI9ZnVuY3Rpb24oYSl7cmV0dXJuIGF9O2IuYT1hO2IuZD1jLmQ7cmV0dXJuIGJ9KCksRWg9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7Zm9yKDs7KWlmKE8oYik8TyhhKSl7dmFyIGM9YTthPWI7Yj1jfWVsc2UgcmV0dXJuIEMuYyhmdW5jdGlvbihhLGIpe3JldHVybiBmdW5jdGlvbihhLGMpe3JldHVybiBPYyhiLGMpP2E6QWMuYShhLGMpfX0oYSxiKSxhLGEpfXZhciBiPW51bGwsYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYixkLGspe3ZhciBsPW51bGw7Mjxhcmd1bWVudHMubGVuZ3RoJiYobD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKSwwKSk7cmV0dXJuIGMuY2FsbCh0aGlzLGIsZCxsKX1mdW5jdGlvbiBjKGEsZCxlKXthPUNoKGZ1bmN0aW9uKGEpe3JldHVybi1PKGEpfSxcbnBjLmQoZSxkLEooW2FdLDApKSk7cmV0dXJuIEMuYyhiLEYoYSksRyhhKSl9YS5rPTI7YS5mPWZ1bmN0aW9uKGEpe3ZhciBiPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1HKGEpO3JldHVybiBjKGIsZCxhKX07YS5kPWM7cmV0dXJuIGF9KCksYj1mdW5jdGlvbihiLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYjtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGIsZSk7ZGVmYXVsdDpyZXR1cm4gYy5kKGIsZSxKKGFyZ3VtZW50cywyKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Iuaz0yO2IuZj1jLmY7Yi5iPWZ1bmN0aW9uKGEpe3JldHVybiBhfTtiLmE9YTtiLmQ9Yy5kO3JldHVybiBifSgpLEZoPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3JldHVybiBPKGEpPE8oYik/Qy5jKGZ1bmN0aW9uKGEsYyl7cmV0dXJuIE9jKGIsYyk/QWMuYShhLGMpOmF9LGEsYSk6Qy5jKEFjLGEsYil9dmFyIGI9bnVsbCxcbmM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGIsZCxrKXt2YXIgbD1udWxsOzI8YXJndW1lbnRzLmxlbmd0aCYmKGw9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMiksMCkpO3JldHVybiBjLmNhbGwodGhpcyxiLGQsbCl9ZnVuY3Rpb24gYyhhLGQsZSl7cmV0dXJuIEMuYyhiLGEscGMuYShlLGQpKX1hLms9MjthLmY9ZnVuY3Rpb24oYSl7dmFyIGI9RihhKTthPUkoYSk7dmFyIGQ9RihhKTthPUcoYSk7cmV0dXJuIGMoYixkLGEpfTthLmQ9YztyZXR1cm4gYX0oKSxiPWZ1bmN0aW9uKGIsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBiO2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsYixlKTtkZWZhdWx0OnJldHVybiBjLmQoYixlLEooYXJndW1lbnRzLDIpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yi5rPTI7Yi5mPWMuZjtiLmI9ZnVuY3Rpb24oYSl7cmV0dXJuIGF9O2IuYT1hO2IuZD1cbmMuZDtyZXR1cm4gYn0oKTtmdW5jdGlvbiBHaChhLGIpe3JldHVybiBXYi5hKGEsYik/bmV3IFcobnVsbCwzLDUsWCxbbnVsbCxudWxsLGFdLG51bGwpOm5ldyBXKG51bGwsMyw1LFgsW2EsYixudWxsXSxudWxsKX1mdW5jdGlvbiBIaChhKXtyZXR1cm4gRShhKT9DLmMoZnVuY3Rpb24oYSxjKXt2YXIgZD1QLmMoYywwLG51bGwpLGU9UC5jKGMsMSxudWxsKTtyZXR1cm4gUi5jKGEsZCxlKX0sd2UoT2QuYShTLmEoWGMsVmUoYSkpLG51bGwpKSxhKTpudWxsfVxuZnVuY3Rpb24gSWgoYSxiLGMpe3ZhciBkPVEuYShhLGMpLGU9US5hKGIsYyksZj1KaC5hP0poLmEoZCxlKTpKaC5jYWxsKG51bGwsZCxlKSxoPVAuYyhmLDAsbnVsbCksaz1QLmMoZiwxLG51bGwpLGY9UC5jKGYsMixudWxsKTthPU9jKGEsYyk7Yj1PYyhiLGMpO2Q9YSYmYiYmKG51bGwhPWZ8fG51bGw9PWQmJm51bGw9PWUpO3JldHVybiBuZXcgVyhudWxsLDMsNSxYLFshYXx8bnVsbD09aCYmZD9udWxsOm5ldyBhZihbYyxoXSksIWJ8fG51bGw9PWsmJmQ/bnVsbDpuZXcgYWYoW2Msa10pLGQ/bmV3IGFmKFtjLGZdKTpudWxsXSxudWxsKX1cbnZhciBLaD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMpe3JldHVybiBDLmMoZnVuY3Rpb24oYSxiKXtyZXR1cm4gcmcuYihLZC5jKFpmLGEsYikpfSxuZXcgVyhudWxsLDMsNSxYLFtudWxsLG51bGwsbnVsbF0sbnVsbCksS2QuYShJZC5jKEloLGEsYiksYykpfWZ1bmN0aW9uIGIoYSxiKXtyZXR1cm4gYy5jKGEsYixEaC5hKFZlKGEpLFZlKGIpKSl9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBiLmNhbGwodGhpcyxjLGUpO2Nhc2UgMzpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlLGYpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmE9YjtjLmM9YTtyZXR1cm4gY30oKTtcbmZ1bmN0aW9uIExoKGEsYil7cmV0dXJuIHdlKEtkLmEoSGgsS2guYyhIYyhhKT9hOndlKGEpLEhjKGIpP2I6d2UoYikscGcuYihmdW5jdGlvbigpe3ZhciBjPU8oYSksZD1PKGIpO3JldHVybiBjPmQ/YzpkfSgpKSkpKX1mdW5jdGlvbiBNaChhLGIpe3JldHVybiBuZXcgVyhudWxsLDMsNSxYLFtDZChGaC5hKGEsYikpLENkKEZoLmEoYixhKSksQ2QoRWguYShhLGIpKV0sbnVsbCl9ZnVuY3Rpb24gTmgoYSl7aWYoYT9hLnFjOmEpcmV0dXJuIGEucWMoYSk7dmFyIGI7Yj1OaFttKG51bGw9PWE/bnVsbDphKV07aWYoIWImJihiPU5oLl8sIWIpKXRocm93IHgoXCJFcXVhbGl0eVBhcnRpdGlvbi5lcXVhbGl0eS1wYXJ0aXRpb25cIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9XG5mdW5jdGlvbiBPaChhLGIpe2lmKGE/YS5wYzphKXJldHVybiBhLnBjKGEsYik7dmFyIGM7Yz1PaFttKG51bGw9PWE/bnVsbDphKV07aWYoIWMmJihjPU9oLl8sIWMpKXRocm93IHgoXCJEaWZmLmRpZmYtc2ltaWxhclwiLGEpO3JldHVybiBjLmNhbGwobnVsbCxhLGIpfU5oLl89ZnVuY3Rpb24oYSl7cmV0dXJuKGE/YS5pJjEwMjR8fGEuY2N8fChhLmk/MDpzKFBhLGEpKTpzKFBhLGEpKT9naDooYT9hLmkmNDA5Nnx8YS5qY3x8KGEuaT8wOnMoVmEsYSkpOnMoVmEsYSkpP2RoOihhP2EuaSYxNjc3NzIxNnx8YS5pY3x8KGEuaT8wOnMobWIsYSkpOnMobWIsYSkpP1lnOlliP2ZoOm51bGx9O05oW1wiYm9vbGVhblwiXT1mdW5jdGlvbigpe3JldHVybiBmaH07TmhbXCJmdW5jdGlvblwiXT1mdW5jdGlvbigpe3JldHVybiBmaH07TmguYXJyYXk9ZnVuY3Rpb24oKXtyZXR1cm4gWWd9O05oLm51bWJlcj1mdW5jdGlvbigpe3JldHVybiBmaH07Tmguc3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIGZofTtcbk5oW1wibnVsbFwiXT1mdW5jdGlvbigpe3JldHVybiBmaH07T2guXz1mdW5jdGlvbihhLGIpe3JldHVybiBmdW5jdGlvbigpe3N3aXRjaChOaChhKWluc3RhbmNlb2YgVD9OaChhKS5zYTpudWxsKXtjYXNlIFwibWFwXCI6cmV0dXJuIEtoO2Nhc2UgXCJzZXF1ZW50aWFsXCI6cmV0dXJuIExoO2Nhc2UgXCJzZXRcIjpyZXR1cm4gTWg7Y2FzZSBcImF0b21cIjpyZXR1cm4gR2g7ZGVmYXVsdDp0aHJvdyBFcnJvcihcIk5vIG1hdGNoaW5nIGNsYXVzZTogXCIrQS5iKE5oKGEpKSk7fX0oKS5jYWxsKG51bGwsYSxiKX07T2hbXCJib29sZWFuXCJdPWZ1bmN0aW9uKGEsYil7cmV0dXJuIEdoKGEsYil9O09oW1wiZnVuY3Rpb25cIl09ZnVuY3Rpb24oYSxiKXtyZXR1cm4gR2goYSxiKX07T2guYXJyYXk9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTGgoYSxiKX07T2gubnVtYmVyPWZ1bmN0aW9uKGEsYil7cmV0dXJuIEdoKGEsYil9O09oLnN0cmluZz1mdW5jdGlvbihhLGIpe3JldHVybiBHaChhLGIpfTtcbk9oW1wibnVsbFwiXT1mdW5jdGlvbihhLGIpe3JldHVybiBHaChhLGIpfTtmdW5jdGlvbiBKaChhLGIpe3JldHVybiBXYi5hKGEsYik/bmV3IFcobnVsbCwzLDUsWCxbbnVsbCxudWxsLGFdLG51bGwpOldiLmEoTmgoYSksTmgoYikpP09oKGEsYik6R2goYSxiKX07ZnVuY3Rpb24gUGgoYSl7aWYoYT9hLlViOmEpcmV0dXJuIGEuVWIoKTt2YXIgYjtiPVBoW20obnVsbD09YT9udWxsOmEpXTtpZighYiYmKGI9UGguXywhYikpdGhyb3cgeChcIlB1c2hiYWNrUmVhZGVyLnJlYWQtY2hhclwiLGEpO3JldHVybiBiLmNhbGwobnVsbCxhKX1mdW5jdGlvbiBRaChhLGIpe2lmKGE/YS5WYjphKXJldHVybiBhLlZiKDAsYik7dmFyIGM7Yz1RaFttKG51bGw9PWE/bnVsbDphKV07aWYoIWMmJihjPVFoLl8sIWMpKXRocm93IHgoXCJQdXNoYmFja1JlYWRlci51bnJlYWRcIixhKTtyZXR1cm4gYy5jYWxsKG51bGwsYSxiKX1mdW5jdGlvbiBSaChhLGIsYyl7dGhpcy5yPWE7dGhpcy5idWZmZXI9Yjt0aGlzLkZiPWN9UmgucHJvdG90eXBlLlViPWZ1bmN0aW9uKCl7cmV0dXJuIDA9PT10aGlzLmJ1ZmZlci5sZW5ndGg/KHRoaXMuRmIrPTEsdGhpcy5yW3RoaXMuRmJdKTp0aGlzLmJ1ZmZlci5wb3AoKX07UmgucHJvdG90eXBlLlZiPWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuYnVmZmVyLnB1c2goYil9O1xuZnVuY3Rpb24gU2goYSl7dmFyIGI9IS9bXlxcdFxcblxcciBdLy50ZXN0KGEpO3JldHVybiByKGIpP2I6XCIsXCI9PT1hfXZhciBUaD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxkKXt2YXIgZT1udWxsOzE8YXJndW1lbnRzLmxlbmd0aCYmKGU9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSksMCkpO3JldHVybiBiLmNhbGwodGhpcywwLGUpfWZ1bmN0aW9uIGIoYSxiKXt0aHJvdyBFcnJvcihTLmEoQSxiKSk7fWEuaz0xO2EuZj1mdW5jdGlvbihhKXtGKGEpO2E9RyhhKTtyZXR1cm4gYigwLGEpfTthLmQ9YjtyZXR1cm4gYX0oKTtcbmZ1bmN0aW9uIFVoKGEsYil7Zm9yKHZhciBjPW5ldyBlYShiKSxkPVBoKGEpOzspe3ZhciBlO2lmKCEoZT1udWxsPT1kfHxTaChkKSkpe2U9ZDt2YXIgZj1cIiNcIiE9PWU7ZT1mPyhmPVwiJ1wiIT09ZSk/KGY9XCI6XCIhPT1lKT9WaC5iP1ZoLmIoZSk6VmguY2FsbChudWxsLGUpOmY6ZjpmfWlmKGUpcmV0dXJuIFFoKGEsZCksYy50b1N0cmluZygpO2MuYXBwZW5kKGQpO2Q9UGgoYSl9fWZ1bmN0aW9uIFdoKGEpe2Zvcig7Oyl7dmFyIGI9UGgoYSk7aWYoXCJcXG5cIj09PWJ8fFwiXFxyXCI9PT1ifHxudWxsPT1iKXJldHVybiBhfX12YXIgWGg9dGcoXCJeKFstK10/KSg/OigwKXwoWzEtOV1bMC05XSopfDBbeFhdKFswLTlBLUZhLWZdKyl8MChbMC03XSspfChbMS05XVswLTldPylbclJdKFswLTlBLVphLXpdKykpKE4pPyRcIiksWWg9dGcoXCJeKFstK10/WzAtOV0rKS8oWzAtOV0rKSRcIiksWmg9dGcoXCJeKFstK10/WzAtOV0rKFxcXFwuWzAtOV0qKT8oW2VFXVstK10/WzAtOV0rKT8pKE0pPyRcIiksJGg9dGcoXCJeWzpdPyhbXjAtOS9dLiovKT8oW14wLTkvXVteL10qKSRcIik7XG5mdW5jdGlvbiBhaShhLGIpe3ZhciBjPWEuZXhlYyhiKTtyZXR1cm4gbnVsbCE9YyYmY1swXT09PWI/MT09PWMubGVuZ3RoP2NbMF06YzpudWxsfXZhciBiaT10ZyhcIl5bMC05QS1GYS1mXXsyfSRcIiksY2k9dGcoXCJeWzAtOUEtRmEtZl17NH0kXCIpO2Z1bmN0aW9uIGRpKGEsYixjLGQpe3JldHVybiByKHNnKGEsZCkpP2Q6VGguZChiLEooW1wiVW5leHBlY3RlZCB1bmljb2RlIGVzY2FwZSBcXFxcXCIsYyxkXSwwKSl9ZnVuY3Rpb24gZWkoYSl7cmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUocGFyc2VJbnQoYSwxNikpfVxuZnVuY3Rpb24gZmkoYSl7dmFyIGI9UGgoYSksYz1cInRcIj09PWI/XCJcXHRcIjpcInJcIj09PWI/XCJcXHJcIjpcIm5cIj09PWI/XCJcXG5cIjpcIlxcXFxcIj09PWI/XCJcXFxcXCI6J1wiJz09PWI/J1wiJzpcImJcIj09PWI/XCJcXGJcIjpcImZcIj09PWI/XCJcXGZcIjpudWxsO3IoYyk/YT1jOlwieFwiPT09Yj8oYz0obmV3IGVhKFBoKGEpLFBoKGEpKSkudG9TdHJpbmcoKSxhPWVpKGRpKGJpLGEsYixjKSkpOlwidVwiPT09Yj8oYz0obmV3IGVhKFBoKGEpLFBoKGEpLFBoKGEpLFBoKGEpKSkudG9TdHJpbmcoKSxhPWVpKGRpKGNpLGEsYixjKSkpOmE9L1teMC05XS8udGVzdChiKT91P1RoLmQoYSxKKFtcIlVuZXhwZWN0ZWQgdW5pY29kZSBlc2NhcGUgXFxcXFwiLGJdLDApKTpudWxsOlN0cmluZy5mcm9tQ2hhckNvZGUoYik7cmV0dXJuIGF9XG5mdW5jdGlvbiBnaShhLGIpe2Zvcih2YXIgYz15YihxZSk7Oyl7dmFyIGQ7YTp7ZD1TaDtmb3IodmFyIGU9YixmPVBoKGUpOzspaWYocihkLmI/ZC5iKGYpOmQuY2FsbChudWxsLGYpKSlmPVBoKGUpO2Vsc2V7ZD1mO2JyZWFrIGF9ZD12b2lkIDB9cihkKXx8VGguZChiLEooW1wiRU9GIHdoaWxlIHJlYWRpbmdcIl0sMCkpO2lmKGE9PT1kKXJldHVybiBBYihjKTtlPVZoLmI/VmguYihkKTpWaC5jYWxsKG51bGwsZCk7cihlKT9kPWUuYT9lLmEoYixkKTplLmNhbGwobnVsbCxiLGQpOihRaChiLGQpLGQ9aGkubj9oaS5uKGIsITAsbnVsbCwhMCk6aGkuY2FsbChudWxsLGIsITAsbnVsbCkpO2M9ZD09PWI/Yzp3ZC5hKGMsZCl9fWZ1bmN0aW9uIGlpKGEsYil7cmV0dXJuIFRoLmQoYSxKKFtcIlJlYWRlciBmb3IgXCIsYixcIiBub3QgaW1wbGVtZW50ZWQgeWV0XCJdLDApKX1cbmZ1bmN0aW9uIGppKGEsYil7dmFyIGM9UGgoYSksZD1raS5iP2tpLmIoYyk6a2kuY2FsbChudWxsLGMpO2lmKHIoZCkpcmV0dXJuIGQuYT9kLmEoYSxiKTpkLmNhbGwobnVsbCxhLGIpO2Q9bGkuYT9saS5hKGEsYyk6bGkuY2FsbChudWxsLGEsYyk7cmV0dXJuIHIoZCk/ZDpUaC5kKGEsSihbXCJObyBkaXNwYXRjaCBtYWNybyBmb3IgXCIsY10sMCkpfWZ1bmN0aW9uIG1pKGEsYil7cmV0dXJuIFRoLmQoYSxKKFtcIlVubWFjaGVkIGRlbGltaXRlciBcIixiXSwwKSl9ZnVuY3Rpb24gbmkoYSl7cmV0dXJuIFMuYShmZCxnaShcIilcIixhKSl9ZnVuY3Rpb24gb2koYSl7cmV0dXJuIGdpKFwiXVwiLGEpfVxuZnVuY3Rpb24gcGkoYSl7dmFyIGI9Z2koXCJ9XCIsYSksYz1PKGIpO2lmKFwibnVtYmVyXCIhPT10eXBlb2YgY3x8aXNOYU4oYyl8fEluZmluaXR5PT09Y3x8cGFyc2VGbG9hdChjKSE9PXBhcnNlSW50KGMsMTApKXRocm93IEVycm9yKFwiQXJndW1lbnQgbXVzdCBiZSBhbiBpbnRlZ2VyOiBcIitBLmIoYykpOzAhPT0oYyYxKSYmVGguZChhLEooW1wiTWFwIGxpdGVyYWwgbXVzdCBjb250YWluIGFuIGV2ZW4gbnVtYmVyIG9mIGZvcm1zXCJdLDApKTtyZXR1cm4gUy5hKFRmLGIpfWZ1bmN0aW9uIHFpKGEpe2Zvcih2YXIgYj1uZXcgZWEsYz1QaChhKTs7KXtpZihudWxsPT1jKXJldHVybiBUaC5kKGEsSihbXCJFT0Ygd2hpbGUgcmVhZGluZ1wiXSwwKSk7aWYoXCJcXFxcXCI9PT1jKWIuYXBwZW5kKGZpKGEpKSxjPVBoKGEpO2Vsc2V7aWYoJ1wiJz09PWMpcmV0dXJuIGIudG9TdHJpbmcoKTtpZihZYiliLmFwcGVuZChjKSxjPVBoKGEpO2Vsc2UgcmV0dXJuIG51bGx9fX1cbmZ1bmN0aW9uIHJpKGEpe2Zvcih2YXIgYj1uZXcgZWEsYz1QaChhKTs7KXtpZihudWxsPT1jKXJldHVybiBUaC5kKGEsSihbXCJFT0Ygd2hpbGUgcmVhZGluZ1wiXSwwKSk7aWYoXCJcXFxcXCI9PT1jKXtiLmFwcGVuZChjKTt2YXIgZD1QaChhKTtpZihudWxsPT1kKXJldHVybiBUaC5kKGEsSihbXCJFT0Ygd2hpbGUgcmVhZGluZ1wiXSwwKSk7dmFyIGU9ZnVuY3Rpb24oKXt2YXIgYT1iO2EuYXBwZW5kKGQpO3JldHVybiBhfSgpLGY9UGgoYSksYj1lLGM9Zn1lbHNle2lmKCdcIic9PT1jKXJldHVybiBiLnRvU3RyaW5nKCk7aWYodSllPWZ1bmN0aW9uKCl7dmFyIGE9YjthLmFwcGVuZChjKTtyZXR1cm4gYX0oKSxmPVBoKGEpLGI9ZSxjPWY7ZWxzZSByZXR1cm4gbnVsbH19fVxuZnVuY3Rpb24gc2koYSxiKXt2YXIgYz1VaChhLGIpO2lmKHIoLTEhPWMuaW5kZXhPZihcIi9cIikpKWM9JGIuYShhZC5jKGMsMCxjLmluZGV4T2YoXCIvXCIpKSxhZC5jKGMsYy5pbmRleE9mKFwiL1wiKSsxLGMubGVuZ3RoKSk7ZWxzZSB2YXIgZD0kYi5iKGMpLGM9XCJuaWxcIj09PWM/bnVsbDpcInRydWVcIj09PWM/ITA6XCJmYWxzZVwiPT09Yz8hMTp1P2Q6bnVsbDtyZXR1cm4gY31mdW5jdGlvbiB0aShhKXt2YXIgYj1VaChhLFBoKGEpKSxjPWFpKCRoLGIpLGI9Y1swXSxkPWNbMV0sYz1jWzJdO3JldHVybiB2b2lkIDAhPT1kJiZcIjovXCI9PT1kLnN1YnN0cmluZyhkLmxlbmd0aC0yLGQubGVuZ3RoKXx8XCI6XCI9PT1jW2MubGVuZ3RoLTFdfHwtMSE9PWIuaW5kZXhPZihcIjo6XCIsMSk/VGguZChhLEooW1wiSW52YWxpZCB0b2tlbjogXCIsYl0sMCkpOm51bGwhPWQmJjA8ZC5sZW5ndGg/amQuYShkLnN1YnN0cmluZygwLGQuaW5kZXhPZihcIi9cIikpLGMpOmpkLmIoYil9XG5mdW5jdGlvbiB1aShhKXtyZXR1cm4gZnVuY3Rpb24oYil7cmV0dXJuIERhKERhKEgsaGkubj9oaS5uKGIsITAsbnVsbCwhMCk6aGkuY2FsbChudWxsLGIsITAsbnVsbCkpLGEpfX1mdW5jdGlvbiB2aSgpe3JldHVybiBmdW5jdGlvbihhKXtyZXR1cm4gVGguZChhLEooW1wiVW5yZWFkYWJsZSBmb3JtXCJdLDApKX19XG5mdW5jdGlvbiB3aShhKXt2YXIgYjtiPWhpLm4/aGkubihhLCEwLG51bGwsITApOmhpLmNhbGwobnVsbCxhLCEwLG51bGwpO2I9YiBpbnN0YW5jZW9mIFpiP25ldyBsYShudWxsLDEsW2NoLGJdLG51bGwpOlwic3RyaW5nXCI9PT10eXBlb2YgYj9uZXcgbGEobnVsbCwxLFtjaCxiXSxudWxsKTpiIGluc3RhbmNlb2YgVD9uZXcgYWYoW2IsITBdKTp1P2I6bnVsbDtHYyhiKXx8VGguZChhLEooW1wiTWV0YWRhdGEgbXVzdCBiZSBTeW1ib2wsS2V5d29yZCxTdHJpbmcgb3IgTWFwXCJdLDApKTt2YXIgYz1oaS5uP2hpLm4oYSwhMCxudWxsLCEwKTpoaS5jYWxsKG51bGwsYSwhMCxudWxsKTtyZXR1cm4oYz9jLmkmMjYyMTQ0fHxjLm9jfHwoYy5pPzA6cyhkYixjKSk6cyhkYixjKSk/TihjLFpmLmQoSihbeGMoYyksYl0sMCkpKTpUaC5kKGEsSihbXCJNZXRhZGF0YSBjYW4gb25seSBiZSBhcHBsaWVkIHRvIElXaXRoTWV0YXNcIl0sMCkpfWZ1bmN0aW9uIHhpKGEpe3JldHVybiBlZyhnaShcIn1cIixhKSl9XG5mdW5jdGlvbiB5aShhKXtyZXR1cm4gdGcocmkoYSkpfWZ1bmN0aW9uIHppKGEpe2hpLm4/aGkubihhLCEwLG51bGwsITApOmhpLmNhbGwobnVsbCxhLCEwLG51bGwpO3JldHVybiBhfWZ1bmN0aW9uIFZoKGEpe3JldHVybidcIic9PT1hP3FpOlwiOlwiPT09YT90aTpcIjtcIj09PWE/V2g6XCInXCI9PT1hP3VpKG5ldyBaYihudWxsLFwicXVvdGVcIixcInF1b3RlXCIsMTM3NzkxNjI4MixudWxsKSk6XCJAXCI9PT1hP3VpKG5ldyBaYihudWxsLFwiZGVyZWZcIixcImRlcmVmXCIsMTQ5NDk0NDczMixudWxsKSk6XCJeXCI9PT1hP3dpOlwiYFwiPT09YT9paTpcIn5cIj09PWE/aWk6XCIoXCI9PT1hP25pOlwiKVwiPT09YT9taTpcIltcIj09PWE/b2k6XCJdXCI9PT1hP21pOlwie1wiPT09YT9waTpcIn1cIj09PWE/bWk6XCJcXFxcXCI9PT1hP1BoOlwiI1wiPT09YT9qaTpudWxsfWZ1bmN0aW9uIGtpKGEpe3JldHVyblwie1wiPT09YT94aTpcIlxceDNjXCI9PT1hP3ZpKCk6J1wiJz09PWE/eWk6XCIhXCI9PT1hP1doOlwiX1wiPT09YT96aTpudWxsfVxuZnVuY3Rpb24gaGkoYSxiLGMpe2Zvcig7Oyl7dmFyIGQ9UGgoYSk7aWYobnVsbD09ZClyZXR1cm4gcihiKT9UaC5kKGEsSihbXCJFT0Ygd2hpbGUgcmVhZGluZ1wiXSwwKSk6YztpZighU2goZCkpaWYoXCI7XCI9PT1kKWE9V2guYT9XaC5hKGEsZCk6V2guY2FsbChudWxsLGEpO2Vsc2UgaWYodSl7dmFyIGU9VmgoZCk7aWYocihlKSllPWUuYT9lLmEoYSxkKTplLmNhbGwobnVsbCxhLGQpO2Vsc2V7dmFyIGU9YSxmPXZvaWQgMDshKGY9IS9bXjAtOV0vLnRlc3QoZCkpJiYoZj12b2lkIDAsZj1cIitcIj09PWR8fFwiLVwiPT09ZCkmJihmPVBoKGUpLFFoKGUsZiksZj0hL1teMC05XS8udGVzdChmKSk7aWYoZilhOntlPWE7ZD1uZXcgZWEoZCk7Zm9yKGY9UGgoZSk7Oyl7dmFyIGg7aD1udWxsPT1mO2h8fChoPShoPVNoKGYpKT9oOlZoLmI/VmguYihmKTpWaC5jYWxsKG51bGwsZikpO2lmKHIoaCkpe1FoKGUsZik7Zj1kPWQudG9TdHJpbmcoKTtoPXZvaWQgMDtpZihyKGFpKFhoLGYpKSlpZihmPWFpKFhoLFxuZiksbnVsbCE9ZlsyXSloPTA7ZWxzZXtoPXIoZlszXSk/W2ZbM10sMTBdOnIoZls0XSk/W2ZbNF0sMTZdOnIoZls1XSk/W2ZbNV0sOF06cihmWzZdKT9bZls3XSxwYXJzZUludChmWzZdLDEwKV06dT9bbnVsbCxudWxsXTpudWxsO3ZhciBrPWhbMF07bnVsbD09az9oPW51bGw6KGg9cGFyc2VJbnQoayxoWzFdKSxoPVwiLVwiPT09ZlsxXT8taDpoKX1lbHNlIGg9dm9pZCAwLHIoYWkoWWgsZikpPyhmPWFpKFloLGYpLGg9cGFyc2VJbnQoZlsxXSwxMCkvcGFyc2VJbnQoZlsyXSwxMCkpOmg9cihhaShaaCxmKSk/cGFyc2VGbG9hdChmKTpudWxsO2Y9aDtlPXIoZik/ZjpUaC5kKGUsSihbXCJJbnZhbGlkIG51bWJlciBmb3JtYXQgW1wiLGQsXCJdXCJdLDApKTticmVhayBhfWQuYXBwZW5kKGYpO2Y9UGgoZSl9ZT12b2lkIDB9ZWxzZSBlPXU/c2koYSxkKTpudWxsfWlmKGUhPT1hKXJldHVybiBlfWVsc2UgcmV0dXJuIG51bGx9fVxuZnVuY3Rpb24gQWkoYSl7aWYoV2IuYSgzLE8oYSkpKXJldHVybiBhO2lmKDM8TyhhKSlyZXR1cm4gYWQuYyhhLDAsMyk7aWYodSlmb3IoYT1uZXcgZWEoYSk7OylpZigzPmEuVmEubGVuZ3RoKWE9YS5hcHBlbmQoXCIwXCIpO2Vsc2UgcmV0dXJuIGEudG9TdHJpbmcoKTtlbHNlIHJldHVybiBudWxsfXZhciBCaT1mdW5jdGlvbihhLGIpe3JldHVybiBmdW5jdGlvbihjLGQpe3JldHVybiBRLmEocihkKT9iOmEsYyl9fShuZXcgVyhudWxsLDEzLDUsWCxbbnVsbCwzMSwyOCwzMSwzMCwzMSwzMCwzMSwzMSwzMCwzMSwzMCwzMV0sbnVsbCksbmV3IFcobnVsbCwxMyw1LFgsW251bGwsMzEsMjksMzEsMzAsMzEsMzAsMzEsMzEsMzAsMzEsMzAsMzFdLG51bGwpKSxDaT0vKFxcZFxcZFxcZFxcZCkoPzotKFxcZFxcZCkoPzotKFxcZFxcZCkoPzpbVF0oXFxkXFxkKSg/OjooXFxkXFxkKSg/OjooXFxkXFxkKSg/OlsuXShcXGQrKSk/KT8pPyk/KT8pPyg/OltaXXwoWy0rXSkoXFxkXFxkKTooXFxkXFxkKSk/LztcbmZ1bmN0aW9uIERpKGEpe2E9cGFyc2VJbnQoYSwxMCk7cmV0dXJuIHNhKGlzTmFOKGEpKT9hOm51bGx9ZnVuY3Rpb24gRWkoYSxiLGMsZCl7YTw9YiYmYjw9Y3x8VGguZChudWxsLEooW1wiXCIrQS5iKGQpK1wiIEZhaWxlZDogIFwiK0EuYihhKStcIlxceDNjXFx4M2RcIitBLmIoYikrXCJcXHgzY1xceDNkXCIrQS5iKGMpXSwwKSk7cmV0dXJuIGJ9XG5mdW5jdGlvbiBGaShhKXt2YXIgYj1zZyhDaSxhKTtQLmMoYiwwLG51bGwpO3ZhciBjPVAuYyhiLDEsbnVsbCksZD1QLmMoYiwyLG51bGwpLGU9UC5jKGIsMyxudWxsKSxmPVAuYyhiLDQsbnVsbCksaD1QLmMoYiw1LG51bGwpLGs9UC5jKGIsNixudWxsKSxsPVAuYyhiLDcsbnVsbCksbj1QLmMoYiw4LG51bGwpLHE9UC5jKGIsOSxudWxsKSx0PVAuYyhiLDEwLG51bGwpO2lmKHNhKGIpKXJldHVybiBUaC5kKG51bGwsSihbXCJVbnJlY29nbml6ZWQgZGF0ZS90aW1lIHN5bnRheDogXCIrQS5iKGEpXSwwKSk7YT1EaShjKTt2YXIgYj1mdW5jdGlvbigpe3ZhciBhPURpKGQpO3JldHVybiByKGEpP2E6MX0oKSxjPWZ1bmN0aW9uKCl7dmFyIGE9RGkoZSk7cmV0dXJuIHIoYSk/YToxfSgpLHY9ZnVuY3Rpb24oKXt2YXIgYT1EaShmKTtyZXR1cm4gcihhKT9hOjB9KCksdz1mdW5jdGlvbigpe3ZhciBhPURpKGgpO3JldHVybiByKGEpP2E6MH0oKSx5PWZ1bmN0aW9uKCl7dmFyIGE9RGkoayk7cmV0dXJuIHIoYSk/XG5hOjB9KCksQj1mdW5jdGlvbigpe3ZhciBhPURpKEFpKGwpKTtyZXR1cm4gcihhKT9hOjB9KCksbj0oV2IuYShuLFwiLVwiKT8tMToxKSooNjAqZnVuY3Rpb24oKXt2YXIgYT1EaShxKTtyZXR1cm4gcihhKT9hOjB9KCkrZnVuY3Rpb24oKXt2YXIgYT1EaSh0KTtyZXR1cm4gcihhKT9hOjB9KCkpO3JldHVybiBuZXcgVyhudWxsLDgsNSxYLFthLEVpKDEsYiwxMixcInRpbWVzdGFtcCBtb250aCBmaWVsZCBtdXN0IGJlIGluIHJhbmdlIDEuLjEyXCIpLEVpKDEsYyxCaS5hP0JpLmEoYiwwPT09KGElNCs0KSU0JiYoMCE9PShhJTEwMCsxMDApJTEwMHx8MD09PShhJTQwMCs0MDApJTQwMCkpOkJpLmNhbGwobnVsbCxiLDA9PT0oYSU0KzQpJTQmJigwIT09KGElMTAwKzEwMCklMTAwfHwwPT09KGElNDAwKzQwMCklNDAwKSksXCJ0aW1lc3RhbXAgZGF5IGZpZWxkIG11c3QgYmUgaW4gcmFuZ2UgMS4ubGFzdCBkYXkgaW4gbW9udGhcIiksRWkoMCx2LDIzLFwidGltZXN0YW1wIGhvdXIgZmllbGQgbXVzdCBiZSBpbiByYW5nZSAwLi4yM1wiKSxcbkVpKDAsdyw1OSxcInRpbWVzdGFtcCBtaW51dGUgZmllbGQgbXVzdCBiZSBpbiByYW5nZSAwLi41OVwiKSxFaSgwLHksV2IuYSh3LDU5KT82MDo1OSxcInRpbWVzdGFtcCBzZWNvbmQgZmllbGQgbXVzdCBiZSBpbiByYW5nZSAwLi42MFwiKSxFaSgwLEIsOTk5LFwidGltZXN0YW1wIG1pbGxpc2Vjb25kIGZpZWxkIG11c3QgYmUgaW4gcmFuZ2UgMC4uOTk5XCIpLG5dLG51bGwpfVxudmFyIEdpPUhnLmIobmV3IGxhKG51bGwsNCxbXCJpbnN0XCIsZnVuY3Rpb24oYSl7dmFyIGI7aWYoXCJzdHJpbmdcIj09PXR5cGVvZiBhKWlmKGI9RmkoYSkscihiKSl7YT1QLmMoYiwwLG51bGwpO3ZhciBjPVAuYyhiLDEsbnVsbCksZD1QLmMoYiwyLG51bGwpLGU9UC5jKGIsMyxudWxsKSxmPVAuYyhiLDQsbnVsbCksaD1QLmMoYiw1LG51bGwpLGs9UC5jKGIsNixudWxsKTtiPVAuYyhiLDcsbnVsbCk7Yj1uZXcgRGF0ZShEYXRlLlVUQyhhLGMtMSxkLGUsZixoLGspLTZFNCpiKX1lbHNlIGI9VGguZChudWxsLEooW1wiVW5yZWNvZ25pemVkIGRhdGUvdGltZSBzeW50YXg6IFwiK0EuYihhKV0sMCkpO2Vsc2UgYj1UaC5kKG51bGwsSihbXCJJbnN0YW5jZSBsaXRlcmFsIGV4cGVjdHMgYSBzdHJpbmcgZm9yIGl0cyB0aW1lc3RhbXAuXCJdLDApKTtyZXR1cm4gYn0sXCJ1dWlkXCIsZnVuY3Rpb24oYSl7cmV0dXJuXCJzdHJpbmdcIj09PXR5cGVvZiBhP25ldyBUZyhhKTpUaC5kKG51bGwsSihbXCJVVUlEIGxpdGVyYWwgZXhwZWN0cyBhIHN0cmluZyBhcyBpdHMgcmVwcmVzZW50YXRpb24uXCJdLFxuMCkpfSxcInF1ZXVlXCIsZnVuY3Rpb24oYSl7cmV0dXJuIEhjKGEpP1lkKEplLGEpOlRoLmQobnVsbCxKKFtcIlF1ZXVlIGxpdGVyYWwgZXhwZWN0cyBhIHZlY3RvciBmb3IgaXRzIGVsZW1lbnRzLlwiXSwwKSl9LFwianNcIixmdW5jdGlvbihhKXtpZihIYyhhKSl7dmFyIGI9W107YT1FKGEpO2Zvcih2YXIgYz1udWxsLGQ9MCxlPTA7OylpZihlPGQpe3ZhciBmPWMuSihudWxsLGUpO2IucHVzaChmKTtlKz0xfWVsc2UgaWYoYT1FKGEpKWM9YSxJYyhjKT8oYT1IYihjKSxlPUliKGMpLGM9YSxkPU8oYSksYT1lKTooYT1GKGMpLGIucHVzaChhKSxhPUkoYyksYz1udWxsLGQ9MCksZT0wO2Vsc2UgYnJlYWs7cmV0dXJuIGJ9aWYoR2MoYSkpe2I9e307YT1FKGEpO2M9bnVsbDtmb3IoZT1kPTA7OylpZihlPGQpe3ZhciBoPWMuSihudWxsLGUpLGY9UC5jKGgsMCxudWxsKSxoPVAuYyhoLDEsbnVsbCk7YltpZChmKV09aDtlKz0xfWVsc2UgaWYoYT1FKGEpKUljKGEpPyhkPUhiKGEpLGE9SWIoYSksYz1kLFxuZD1PKGQpKTooZD1GKGEpLGM9UC5jKGQsMCxudWxsKSxkPVAuYyhkLDEsbnVsbCksYltpZChjKV09ZCxhPUkoYSksYz1udWxsLGQ9MCksZT0wO2Vsc2UgYnJlYWs7cmV0dXJuIGJ9cmV0dXJuIHU/VGguZChudWxsLEooW1wiSlMgbGl0ZXJhbCBleHBlY3RzIGEgdmVjdG9yIG9yIG1hcCBjb250YWluaW5nIG9ubHkgc3RyaW5nIG9yIHVucXVhbGlmaWVkIGtleXdvcmQga2V5c1wiXSwwKSk6bnVsbH1dLG51bGwpKSxIaT1IZy5iKG51bGwpO1xuZnVuY3Rpb24gbGkoYSxiKXt2YXIgYz1zaShhLGIpLGQ9US5hKGFiKEdpKSxcIlwiK0EuYihjKSksZT1hYihIaSk7cmV0dXJuIHIoZCk/ZC5iP2QuYihoaShhLCEwLG51bGwpKTpkLmNhbGwobnVsbCxoaShhLCEwLG51bGwpKTpyKGUpP2UuYT9lLmEoYyxoaShhLCEwLG51bGwpKTplLmNhbGwobnVsbCxjLGhpKGEsITAsbnVsbCkpOnU/VGguZChhLEooW1wiQ291bGQgbm90IGZpbmQgdGFnIHBhcnNlciBmb3IgXCIsXCJcIitBLmIoYyksXCIgaW4gXCIsQ2cuZChKKFtWZShhYihHaSkpXSwwKSldLDApKTpudWxsfTtwKFwibW9yaS5hcHBseVwiLFMpO3AoXCJtb3JpLmNvdW50XCIsTyk7cChcIm1vcmkuZGlzdGluY3RcIixmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24gYyhhLGUpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKGEsZCl7Zm9yKDs7KXt2YXIgZT1hLGw9UC5jKGUsMCxudWxsKTtpZihlPUUoZSkpaWYoT2MoZCxsKSlsPUcoZSksZT1kLGE9bCxkPWU7ZWxzZSByZXR1cm4gTShsLGMoRyhlKSxwYy5hKGQsbCkpKTtlbHNlIHJldHVybiBudWxsfX0uY2FsbChudWxsLGEsZSl9LG51bGwsbnVsbCl9KGEsYmcpfSk7cChcIm1vcmkuZW1wdHlcIixxYyk7cChcIm1vcmkuZmlyc3RcIixGKTtwKFwibW9yaS5yZXN0XCIsRyk7cChcIm1vcmkuc2VxXCIsRSk7cChcIm1vcmkuY29ualwiLHBjKTtwKFwibW9yaS5jb25zXCIsTSk7XG5wKFwibW9yaS5maW5kXCIsZnVuY3Rpb24oYSxiKXtyZXR1cm4gbnVsbCE9YSYmRWMoYSkmJk9jKGEsYik/bmV3IFcobnVsbCwyLDUsWCxbYixRLmEoYSxiKV0sbnVsbCk6bnVsbH0pO3AoXCJtb3JpLm50aFwiLFApO3AoXCJtb3JpLmxhc3RcIixvYyk7cChcIm1vcmkuYXNzb2NcIixSKTtwKFwibW9yaS5kaXNzb2NcIix0Yyk7cChcIm1vcmkuZ2V0X2luXCIsJGQpO3AoXCJtb3JpLnVwZGF0ZV9pblwiLGFlKTtwKFwibW9yaS5hc3NvY19pblwiLGZ1bmN0aW9uIElpKGIsYyxkKXt2YXIgZT1QLmMoYywwLG51bGwpO3JldHVybihjPSRjKGMpKT9SLmMoYixlLElpKFEuYShiLGUpLGMsZCkpOlIuYyhiLGUsZCl9KTtwKFwibW9yaS5mbmlsXCIsSmQpO3AoXCJtb3JpLmRpc2pcIixBYyk7cChcIm1vcmkucG9wXCIsemMpO3AoXCJtb3JpLnBlZWtcIix5Yyk7cChcIm1vcmkuaGFzaFwiLFRiKTtwKFwibW9yaS5nZXRcIixRKTtwKFwibW9yaS5oYXNfa2V5XCIsT2MpO3AoXCJtb3JpLmlzX2VtcHR5XCIsQmMpO3AoXCJtb3JpLnJldmVyc2VcIixlZCk7XG5wKFwibW9yaS50YWtlXCIsTWQpO3AoXCJtb3JpLmRyb3BcIixOZCk7cChcIm1vcmkudGFrZV9udGhcIixmdW5jdGlvbiBKaShiLGMpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7dmFyIGQ9RShjKTtyZXR1cm4gZD9NKEYoZCksSmkoYixOZChiLGQpKSk6bnVsbH0sbnVsbCxudWxsKX0pO3AoXCJtb3JpLnBhcnRpdGlvblwiLFpkKTtwKFwibW9yaS5wYXJ0aXRpb25fYWxsXCIsamcpO3AoXCJtb3JpLnBhcnRpdGlvbl9ieVwiLGZ1bmN0aW9uIEtpKGIsYyl7cmV0dXJuIG5ldyBWKG51bGwsZnVuY3Rpb24oKXt2YXIgZD1FKGMpO2lmKGQpe3ZhciBlPUYoZCksZj1iLmI/Yi5iKGUpOmIuY2FsbChudWxsLGUpLGU9TShlLGxnKGZ1bmN0aW9uKGMsZCl7cmV0dXJuIGZ1bmN0aW9uKGMpe3JldHVybiBXYi5hKGQsYi5iP2IuYihjKTpiLmNhbGwobnVsbCxjKSl9fShlLGYsZCxkKSxJKGQpKSk7cmV0dXJuIE0oZSxLaShiLEUoTmQoTyhlKSxkKSkpKX1yZXR1cm4gbnVsbH0sbnVsbCxudWxsKX0pO1xucChcIm1vcmkuaXRlcmF0ZVwiLGZ1bmN0aW9uIExpKGIsYyl7cmV0dXJuIE0oYyxuZXcgVihudWxsLGZ1bmN0aW9uKCl7cmV0dXJuIExpKGIsYi5iP2IuYihjKTpiLmNhbGwobnVsbCxjKSl9LG51bGwsbnVsbCkpfSk7cChcIm1vcmkuaW50b1wiLFlkKTtwKFwibW9yaS5tZXJnZVwiLFpmKTtwKFwibW9yaS5zdWJ2ZWNcIix6ZSk7cChcIm1vcmkudGFrZV93aGlsZVwiLGxnKTtwKFwibW9yaS5kcm9wX3doaWxlXCIsZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbihjKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gYyhhLGIpfX0oZnVuY3Rpb24oYSxiKXtmb3IoOzspe3ZhciBlPUUoYiksZjtmPShmPWUpP2EuYj9hLmIoRihlKSk6YS5jYWxsKG51bGwsRihlKSk6ZjtpZihyKGYpKWY9YSxlPUcoZSksYT1mLGI9ZTtlbHNlIHJldHVybiBlfX0pLG51bGwsbnVsbCl9KTtcbnAoXCJtb3JpLmdyb3VwX2J5XCIsZnVuY3Rpb24oYSxiKXtyZXR1cm4gQy5jKGZ1bmN0aW9uKGIsZCl7dmFyIGU9YS5iP2EuYihkKTphLmNhbGwobnVsbCxkKTtyZXR1cm4gUi5jKGIsZSxwYy5hKFEuYyhiLGUscWUpLGQpKX0sWWUsYil9KTtwKFwibW9yaS5pbnRlcnBvc2VcIixmdW5jdGlvbihhLGIpe3JldHVybiBOZCgxLFFkLmEoT2QuYihhKSxiKSl9KTtwKFwibW9yaS5pbnRlcmxlYXZlXCIsUWQpO3AoXCJtb3JpLmNvbmNhdFwiLHRkKTtwKFwibW9yaS5jb25qMVwiLGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEuRyhudWxsLGIpfSk7ZnVuY3Rpb24gWGQoYSl7cmV0dXJuIGEgaW5zdGFuY2VvZiBBcnJheXx8RmMoYSl9cChcIm1vcmkuZmxhdHRlblwiLGZ1bmN0aW9uKGEpe3JldHVybiBVZChmdW5jdGlvbihhKXtyZXR1cm4hWGQoYSl9LEcoV2QoYSkpKX0pO3AoXCJtb3JpLmxhenlfc2VxXCIsZnVuY3Rpb24oYSl7cmV0dXJuIG5ldyBWKG51bGwsYSxudWxsLG51bGwpfSk7cChcIm1vcmkua2V5c1wiLFZlKTtcbnAoXCJtb3JpLnNlbGVjdF9rZXlzXCIsZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9WWUsZD1FKGIpOzspaWYoZCl2YXIgZT1GKGQpLGY9US5jKGEsZSxpaCksYz1CZC5hKGYsaWgpP1IuYyhjLGUsZik6YyxkPUkoZCk7ZWxzZSByZXR1cm4gY30pO3AoXCJtb3JpLnZhbHNcIixXZSk7cChcIm1vcmkucHJpbV9zZXFcIixtYyk7cChcIm1vcmkubWFwXCIsS2QpO3AoXCJtb3JpLm1hcGNhdFwiLFNkKTtwKFwibW9yaS5yZWR1Y2VcIixDKTtwKFwibW9yaS5yZWR1Y2Vfa3ZcIixmdW5jdGlvbihhLGIsYyl7cmV0dXJuIG51bGwhPWM/aGIoYyxhLGIpOmJ9KTtwKFwibW9yaS5maWx0ZXJcIixVZCk7cChcIm1vcmkucmVtb3ZlXCIsVmQpO3AoXCJtb3JpLnNvbWVcIixFZCk7cChcIm1vcmkuZXZlcnlcIixEZCk7cChcIm1vcmkuZXF1YWxzXCIsV2IpO3AoXCJtb3JpLnJhbmdlXCIscGcpO3AoXCJtb3JpLnJlcGVhdFwiLE9kKTtwKFwibW9yaS5yZXBlYXRlZGx5XCIsUGQpO3AoXCJtb3JpLnNvcnRcIixTYyk7cChcIm1vcmkuc29ydF9ieVwiLFRjKTtcbnAoXCJtb3JpLmludG9fYXJyYXlcIix4YSk7cChcIm1vcmkuc3Vic2VxXCIsbmcpO3AoXCJtb3JpLnJtYXBcIix0aCk7cChcIm1vcmkucmZpbHRlclwiLHVoKTtwKFwibW9yaS5ycmVtb3ZlXCIsd2gpO3AoXCJtb3JpLnJ0YWtlXCIseWgpO3AoXCJtb3JpLnJ0YWtlX3doaWxlXCIseGgpO3AoXCJtb3JpLnJkcm9wXCIsemgpO3AoXCJtb3JpLnJmbGF0dGVuXCIsdmgpO3AoXCJtb3JpLmxpc3RcIixmZCk7cChcIm1vcmkudmVjdG9yXCIseGUpO3AoXCJtb3JpLmFycmF5X21hcFwiLFVmKTtwKFwibW9yaS5oYXNoX21hcFwiLFRmKTtwKFwibW9yaS5zZXRcIixlZyk7cChcIm1vcmkuc29ydGVkX3NldFwiLGZnKTtwKFwibW9yaS5zb3J0ZWRfc2V0X2J5XCIsZ2cpO3AoXCJtb3JpLnNvcnRlZF9tYXBcIixWZik7cChcIm1vcmkuc29ydGVkX21hcF9ieVwiLFdmKTtcbnAoXCJtb3JpLnF1ZXVlXCIsZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEpe3ZhciBkPW51bGw7MDxhcmd1bWVudHMubGVuZ3RoJiYoZD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywwKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGQpfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIFlkLmE/WWQuYShKZSxhKTpZZC5jYWxsKG51bGwsSmUsYSl9YS5rPTA7YS5mPWZ1bmN0aW9uKGEpe2E9RShhKTtyZXR1cm4gYihhKX07YS5kPWI7cmV0dXJuIGF9KCkpO3AoXCJtb3JpLmtleXdvcmRcIixqZCk7cChcIm1vcmkuc3ltYm9sXCIsJGIpO3AoXCJtb3JpLnppcG1hcFwiLGZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPXliKFllKSxkPUUoYSksZT1FKGIpOzspaWYoZCYmZSljPXhkLmMoYyxGKGQpLEYoZSkpLGQ9SShkKSxlPUkoZSk7ZWxzZSByZXR1cm4gQWIoYyl9KTtcbnAoXCJtb3JpLmlzX2xpc3RcIixmdW5jdGlvbihhKXtyZXR1cm4gYT9hLmkmMzM1NTQ0MzJ8fGEuRWM/ITA6YS5pPyExOnMobmIsYSk6cyhuYixhKX0pO3AoXCJtb3JpLmlzX3NlcVwiLE1jKTtwKFwibW9yaS5pc192ZWN0b3JcIixIYyk7cChcIm1vcmkuaXNfbWFwXCIsR2MpO3AoXCJtb3JpLmlzX3NldFwiLERjKTtwKFwibW9yaS5pc19rZXl3b3JkXCIsZnVuY3Rpb24oYSl7cmV0dXJuIGEgaW5zdGFuY2VvZiBUfSk7cChcIm1vcmkuaXNfc3ltYm9sXCIsZnVuY3Rpb24oYSl7cmV0dXJuIGEgaW5zdGFuY2VvZiBaYn0pO3AoXCJtb3JpLmlzX2NvbGxlY3Rpb25cIixDYyk7cChcIm1vcmkuaXNfc2VxdWVudGlhbFwiLEZjKTtwKFwibW9yaS5pc19hc3NvY2lhdGl2ZVwiLEVjKTtwKFwibW9yaS5pc19jb3VudGVkXCIsaWMpO3AoXCJtb3JpLmlzX2luZGV4ZWRcIixqYyk7cChcIm1vcmkuaXNfcmVkdWNlYWJsZVwiLGZ1bmN0aW9uKGEpe3JldHVybiBhP2EuaSY1MjQyODh8fGEuTmI/ITA6YS5pPyExOnMoZmIsYSk6cyhmYixhKX0pO1xucChcIm1vcmkuaXNfc2VxYWJsZVwiLGZ1bmN0aW9uKGEpe3JldHVybiBhP2EuaSY4Mzg4NjA4fHxhLmhjPyEwOmEuaT8hMTpzKGtiLGEpOnMoa2IsYSl9KTtwKFwibW9yaS5pc19yZXZlcnNpYmxlXCIsZGQpO3AoXCJtb3JpLnVuaW9uXCIsRGgpO3AoXCJtb3JpLmludGVyc2VjdGlvblwiLEVoKTtwKFwibW9yaS5kaWZmZXJlbmNlXCIsRmgpO3AoXCJtb3JpLmlzX3N1YnNldFwiLGZ1bmN0aW9uKGEsYil7cmV0dXJuIE8oYSk8PU8oYikmJkRkKGZ1bmN0aW9uKGEpe3JldHVybiBPYyhiLGEpfSxhKX0pO3AoXCJtb3JpLmlzX3N1cGVyc2V0XCIsZnVuY3Rpb24oYSxiKXtyZXR1cm4gTyhhKT49TyhiKSYmRGQoZnVuY3Rpb24oYil7cmV0dXJuIE9jKGEsYil9LGIpfSk7cChcIm1vcmkucGFydGlhbFwiLElkKTtwKFwibW9yaS5jb21wXCIsSGQpO1xucChcIm1vcmkucGlwZWxpbmVcIixmdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSl7dmFyIGQ9bnVsbDswPGFyZ3VtZW50cy5sZW5ndGgmJihkPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsZCl9ZnVuY3Rpb24gYihhKXtyZXR1cm4gQy5hP0MuYShmdW5jdGlvbihhLGIpe3JldHVybiBiLmI/Yi5iKGEpOmIuY2FsbChudWxsLGEpfSxhKTpDLmNhbGwobnVsbCxmdW5jdGlvbihhLGIpe3JldHVybiBiLmI/Yi5iKGEpOmIuY2FsbChudWxsLGEpfSxhKX1hLms9MDthLmY9ZnVuY3Rpb24oYSl7YT1FKGEpO3JldHVybiBiKGEpfTthLmQ9YjtyZXR1cm4gYX0oKSk7XG5wKFwibW9yaS5jdXJyeVwiLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGQpe3ZhciBlPW51bGw7MTxhcmd1bWVudHMubGVuZ3RoJiYoZT1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGEsZSl9ZnVuY3Rpb24gYihhLGIpe3JldHVybiBmdW5jdGlvbihlKXtyZXR1cm4gUy5hKGEsTS5hP00uYShlLGIpOk0uY2FsbChudWxsLGUsYikpfX1hLms9MTthLmY9ZnVuY3Rpb24oYSl7dmFyIGQ9RihhKTthPUcoYSk7cmV0dXJuIGIoZCxhKX07YS5kPWI7cmV0dXJuIGF9KCkpO1xucChcIm1vcmkuanV4dFwiLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhKXt2YXIgZD1udWxsOzA8YXJndW1lbnRzLmxlbmd0aCYmKGQ9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCksMCkpO3JldHVybiBiLmNhbGwodGhpcyxkKX1mdW5jdGlvbiBiKGEpe3JldHVybiBmdW5jdGlvbigpe2Z1bmN0aW9uIGIoYSl7dmFyIGM9bnVsbDswPGFyZ3VtZW50cy5sZW5ndGgmJihjPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApLDApKTtyZXR1cm4gZS5jYWxsKHRoaXMsYyl9ZnVuY3Rpb24gZShiKXtyZXR1cm4geGEuYj94YS5iKEtkLmE/S2QuYShmdW5jdGlvbihhKXtyZXR1cm4gUy5hKGEsYil9LGEpOktkLmNhbGwobnVsbCxmdW5jdGlvbihhKXtyZXR1cm4gUy5hKGEsYil9LGEpKTp4YS5jYWxsKG51bGwsS2QuYT9LZC5hKGZ1bmN0aW9uKGEpe3JldHVybiBTLmEoYSxiKX0sYSk6S2QuY2FsbChudWxsLGZ1bmN0aW9uKGEpe3JldHVybiBTLmEoYSxcbmIpfSxhKSl9Yi5rPTA7Yi5mPWZ1bmN0aW9uKGEpe2E9RShhKTtyZXR1cm4gZShhKX07Yi5kPWU7cmV0dXJuIGJ9KCl9YS5rPTA7YS5mPWZ1bmN0aW9uKGEpe2E9RShhKTtyZXR1cm4gYihhKX07YS5kPWI7cmV0dXJuIGF9KCkpO1xucChcIm1vcmkua25pdFwiLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhKXt2YXIgZD1udWxsOzA8YXJndW1lbnRzLmxlbmd0aCYmKGQ9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCksMCkpO3JldHVybiBiLmNhbGwodGhpcyxkKX1mdW5jdGlvbiBiKGEpe3JldHVybiBmdW5jdGlvbihiKXtyZXR1cm4geGEuYj94YS5iKEtkLmM/S2QuYyhmdW5jdGlvbihhLGIpe3JldHVybiBhLmI/YS5iKGIpOmEuY2FsbChudWxsLGIpfSxhLGIpOktkLmNhbGwobnVsbCxmdW5jdGlvbihhLGIpe3JldHVybiBhLmI/YS5iKGIpOmEuY2FsbChudWxsLGIpfSxhLGIpKTp4YS5jYWxsKG51bGwsS2QuYz9LZC5jKGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEuYj9hLmIoYik6YS5jYWxsKG51bGwsYil9LGEsYik6S2QuY2FsbChudWxsLGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEuYj9hLmIoYik6YS5jYWxsKG51bGwsYil9LGEsYikpfX1hLms9MDthLmY9ZnVuY3Rpb24oYSl7YT1FKGEpO3JldHVybiBiKGEpfTtcbmEuZD1iO3JldHVybiBhfSgpKTtwKFwibW9yaS5kaWZmXCIsSmgpO3AoXCJtb3JpLnN1bVwiLGZ1bmN0aW9uKGEsYil7cmV0dXJuIGErYn0pO3AoXCJtb3JpLmluY1wiLGZ1bmN0aW9uKGEpe3JldHVybiBhKzF9KTtwKFwibW9yaS5kZWNcIixmdW5jdGlvbihhKXtyZXR1cm4gYS0xfSk7cChcIm1vcmkuaXNfZXZlblwiLGZ1bmN0aW9uKGEpe3JldHVybiAwPT09KGElMisyKSUyfSk7cChcIm1vcmkuaXNfb2RkXCIsZnVuY3Rpb24oYSl7cmV0dXJuIDE9PT0oYSUyKzIpJTJ9KTtwKFwibW9yaS5lYWNoXCIsZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9RShhKSxkPW51bGwsZT0wLGY9MDs7KWlmKGY8ZSl7dmFyIGg9ZC5KKG51bGwsZik7Yi5iP2IuYihoKTpiLmNhbGwobnVsbCxoKTtmKz0xfWVsc2UgaWYoYz1FKGMpKWQ9YyxJYyhkKT8oYz1IYihkKSxlPUliKGQpLGQ9YyxoPU8oYyksYz1lLGU9aCk6KGg9RihkKSxiLmI/Yi5iKGgpOmIuY2FsbChudWxsLGgpLGM9SShkKSxkPW51bGwsZT0wKSxmPTA7ZWxzZSByZXR1cm4gbnVsbH0pO1xucChcIm1vcmkuaWRlbnRpdHlcIixGZCk7cChcIm1vcmkuY29uc3RhbnRseVwiLGZ1bmN0aW9uKGEpe3JldHVybiBmdW5jdGlvbigpe2Z1bmN0aW9uIGIoYil7MDxhcmd1bWVudHMubGVuZ3RoJiZKKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywwKSwwKTtyZXR1cm4gYX1iLms9MDtiLmY9ZnVuY3Rpb24oYil7RShiKTtyZXR1cm4gYX07Yi5kPWZ1bmN0aW9uKCl7cmV0dXJuIGF9O3JldHVybiBifSgpfSk7cChcIm1vcmkuY2xqX3RvX2pzXCIsTmcpO1xucChcIm1vcmkuanNfdG9fY2xqXCIsZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7cmV0dXJuIFNnLmQoYSxKKFtSZyxiXSwwKSl9ZnVuY3Rpb24gYihhKXtyZXR1cm4gU2cuYihhKX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBiLmNhbGwodGhpcyxjKTtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYj1iO2MuYT1hO3JldHVybiBjfSgpKTtwKFwibW9yaS5wYXJzZVwiLGZ1bmN0aW9uKGEpe3JldHVybiBoaShuZXcgUmgoYSxbXSwtMSksITEsbnVsbCl9KTtcbnAoXCJtb3JpLmNvbmZpZ3VyZVwiLGZ1bmN0aW9uKGEsYil7c3dpdGNoKGEpe2Nhc2UgXCJwcmludC1sZW5ndGhcIjpyZXR1cm4gaWE9YjtjYXNlIFwicHJpbnQtbGV2ZWxcIjpyZXR1cm4gamE9YjtkZWZhdWx0OnRocm93IEVycm9yKFwiTm8gbWF0Y2hpbmcgY2xhdXNlOiBcIitBLmIoYSkpO319KTtcbnAoXCJtb3JpLnByb3h5XCIsZnVuY3Rpb24oYSl7aWYoXCJ1bmRlZmluZWRcIiE9PXR5cGVvZiBQcm94eSlyZXR1cm4gUHJveHkuY3JlYXRlKGZ1bmN0aW9uKCl7cmV0dXJue2hhczpmdW5jdGlvbihiKXtyZXR1cm4gT2MoYSxiKX0saGFzT3duOmZ1bmN0aW9uKGIpe3JldHVybiBPYyhhLGIpfSxnZXQ6ZnVuY3Rpb24oYixjKXt2YXIgZD1RLmM/US5jKGEsYyxoaCk6US5jYWxsKG51bGwsYSxjLGhoKTtyZXR1cm4gaGQoZCxoaCk/aWMoYSkmJlwibGVuZ3RoXCI9PT1jP08uYj9PLmIoYSk6Ty5jYWxsKG51bGwsYSk6bnVsbDp1P2Q6bnVsbH0sc2V0OmZ1bmN0aW9uKCl7cmV0dXJuIG51bGx9LGVudW1lcmF0ZTpmdW5jdGlvbigpe3JldHVybiB4YS5iP3hhLmIoVmUuYj9WZS5iKGEpOlZlLmNhbGwobnVsbCxhKSk6eGEuY2FsbChudWxsLFZlLmI/VmUuYihhKTpWZS5jYWxsKG51bGwsYSkpfSxrZXlzOmZ1bmN0aW9uKCl7cmV0dXJuIEdjKGEpP3hhLmI/eGEuYihWZS5iP1ZlLmIoYSk6VmUuY2FsbChudWxsLFxuYSkpOnhhLmNhbGwobnVsbCxWZS5iP1ZlLmIoYSk6VmUuY2FsbChudWxsLGEpKTpIYyhhKT94YS5iP3hhLmIocGcuYj9wZy5iKE8uYj9PLmIoYSk6Ty5jYWxsKG51bGwsYSkpOnBnLmNhbGwobnVsbCxPLmI/Ty5iKGEpOk8uY2FsbChudWxsLGEpKSk6eGEuY2FsbChudWxsLHBnLmI/cGcuYihPLmI/Ty5iKGEpOk8uY2FsbChudWxsLGEpKTpwZy5jYWxsKG51bGwsTy5iP08uYihhKTpPLmNhbGwobnVsbCxhKSkpOm51bGx9fX0oKSk7dGhyb3cgRXJyb3IoXCJFUzYgUHJveHkgbm90IHN1cHBvcnRlZCFcIik7fSk7Vi5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvU3RyaW5nKCl9O2FjLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07a2MucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTtCZi5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvU3RyaW5nKCl9O1xudmYucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTt3Zi5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvU3RyaW5nKCl9O2JkLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07Z2QucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTtjZC5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvU3RyaW5nKCl9O1cucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTtvZC5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvU3RyaW5nKCl9O3llLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07QWUucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTtcbiQucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTtZLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07bGEucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTt4Zi5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvU3RyaW5nKCl9O1FmLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07JGYucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTtjZy5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvU3RyaW5nKCl9O29nLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07VC5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvU3RyaW5nKCl9O1xuWmIucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTtJZS5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvU3RyaW5nKCl9O0hlLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07cChcIm1vcmkuX2VxdWl2XCIsZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS5IYyhiKX0pO3AoXCJtb3JpLl9rZXlzXCIsZnVuY3Rpb24oYSl7cmV0dXJuIGEua2V5cygpfSk7cChcIm1vcmkuX3ZhbHVlc1wiLGZ1bmN0aW9uKGEpe3JldHVybiBhLnZhbHVlcygpfSk7cChcIm1vcmkuX2VudHJpZXNcIixmdW5jdGlvbihhKXtyZXR1cm4gYS5lbnRyaWVzKCl9KTtwKFwibW9yaS5faGFzXCIsZnVuY3Rpb24oYSl7cmV0dXJuIGEuaGFzKCl9KTtwKFwibW9yaS5fZ2V0XCIsZnVuY3Rpb24oYSl7cmV0dXJuIGEuZ2V0KCl9KTtwKFwibW9yaS5fZm9yRWFjaFwiLGZ1bmN0aW9uKGEpe3JldHVybiBhLmZvckVhY2goKX0pO1xucChcIm1vcmkuX25leHRcIixmdW5jdGlvbihhKXtyZXR1cm4gYS5uZXh0KCl9KTtwKFwibW9yaS5tdXRhYmxlLnRoYXdcIixmdW5jdGlvbihhKXtyZXR1cm4geWIoYSl9KTtwKFwibW9yaS5tdXRhYmxlLmZyZWV6ZVwiLHZkKTtwKFwibW9yaS5tdXRhYmxlLmNvbmoxXCIsZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS5LYShudWxsLGIpfSk7cChcIm1vcmkubXV0YWJsZS5jb25qXCIsd2QpO3AoXCJtb3JpLm11dGFibGUuYXNzb2NcIix4ZCk7cChcIm1vcmkubXV0YWJsZS5kaXNzb2NcIix5ZCk7cChcIm1vcmkubXV0YWJsZS5wb3BcIixmdW5jdGlvbihhKXtyZXR1cm4gRWIoYSl9KTtwKFwibW9yaS5tdXRhYmxlLmRpc2pcIix6ZCk7ZnVuY3Rpb24gTWkoYSxiLGMsZCl7cmV0dXJuIE4obmV3IFcobnVsbCwyLDUsWCxbZCxudWxsXSxudWxsKSxuZXcgbGEobnVsbCwzLFskZyxjLFhnLGIsVmcsYV0sbnVsbCkpfWZ1bmN0aW9uIE5pKGEpe3JldHVybiBhLmI/YS5iKDApOmEuY2FsbChudWxsLDApfWZ1bmN0aW9uIE9pKGEpe3JldHVybiBWZy5iKHhjKGEpKS5jYWxsKG51bGwsTmkoYSkpfWZ1bmN0aW9uIFBpKGEpe2lmKHIoT2koYSkpKXJldHVybiBYZy5iKHhjKGEpKS5jYWxsKG51bGwsTmkoYSkpO3Rocm93XCJjYWxsZWQgY2hpbGRyZW4gb24gYSBsZWFmIG5vZGVcIjt9ZnVuY3Rpb24gUWkoYSxiLGMpe3JldHVybiAkZy5iKHhjKGEpKS5jYWxsKG51bGwsYixjKX1cbmZ1bmN0aW9uIFJpKGEpe2lmKHIoT2koYSkpKXt2YXIgYj1QLmMoYSwwLG51bGwpLGM9UC5jKGEsMSxudWxsKSxkPVBpKGEpLGU9UC5jKGQsMCxudWxsKSxmPSRjKGQpO3JldHVybiByKGQpP04obmV3IFcobnVsbCwyLDUsWCxbZSxuZXcgbGEobnVsbCw0LFtaZyxxZSxhaCxyKGMpP3BjLmEoYWguYihjKSxiKTpuZXcgVyhudWxsLDEsNSxYLFtiXSxudWxsKSxVZyxjLFdnLGZdLG51bGwpXSxudWxsKSx4YyhhKSk6bnVsbH1yZXR1cm4gbnVsbH1cbmZ1bmN0aW9uIFNpKGEpe3ZhciBiPVAuYyhhLDAsbnVsbCksYz1QLmMoYSwxLG51bGwpLGQ9TWMoYyk/Uy5hKFRmLGMpOmMsYz1RLmEoZCxaZyksZT1RLmEoZCxVZyksZj1RLmEoZCxhaCksaD1RLmEoZCxXZyksZD1RLmEoZCxiaCk7cmV0dXJuIHIoZik/KGY9eWMoZiksTihyKGQpP25ldyBXKG51bGwsMiw1LFgsW1FpKGEsZix0ZC5hKGMsTShiLGgpKSkscihlKT9SLmMoZSxiaCwhMCk6ZV0sbnVsbCk6bmV3IFcobnVsbCwyLDUsWCxbZixlXSxudWxsKSx4YyhhKSkpOm51bGx9ZnVuY3Rpb24gVGkoYSl7dmFyIGI9UC5jKGEsMCxudWxsKSxjPVAuYyhhLDEsbnVsbCksYz1NYyhjKT9TLmEoVGYsYyk6YyxkPVEuYShjLFpnKSxlPVEuYShjLFdnKSxmPVAuYyhlLDAsbnVsbCksaD0kYyhlKTtyZXR1cm4gcihyKGMpP2U6Yyk/TihuZXcgVyhudWxsLDIsNSxYLFtmLFIuZChjLFpnLHBjLmEoZCxiKSxKKFtXZyxoXSwwKSldLG51bGwpLHhjKGEpKTpudWxsfVxuZnVuY3Rpb24gVWkoYSl7dmFyIGI9UC5jKGEsMCxudWxsKSxjPVAuYyhhLDEsbnVsbCksYz1NYyhjKT9TLmEoVGYsYyk6YyxkPVEuYShjLFpnKSxlPVEuYShjLFdnKTtyZXR1cm4gcihyKGMpP2U6Yyk/TihuZXcgVyhudWxsLDIsNSxYLFtvYyhlKSxSLmQoYyxaZyxTLm4ocGMsZCxiLGhnKGUpKSxKKFtXZyxudWxsXSwwKSldLG51bGwpLHhjKGEpKTphfWZ1bmN0aW9uIFZpKGEpe3ZhciBiPVAuYyhhLDAsbnVsbCksYz1QLmMoYSwxLG51bGwpLGM9TWMoYyk/Uy5hKFRmLGMpOmMsZD1RLmEoYyxaZyksZT1RLmEoYyxXZyk7cmV0dXJuIHIocihjKT9FKGQpOmMpP04obmV3IFcobnVsbCwyLDUsWCxbeWMoZCksUi5kKGMsWmcsemMoZCksSihbV2csTShiLGUpXSwwKSldLG51bGwpLHhjKGEpKTpudWxsfVxuZnVuY3Rpb24gV2koYSxiKXtQLmMoYSwwLG51bGwpO3ZhciBjPVAuYyhhLDEsbnVsbCk7cmV0dXJuIE4obmV3IFcobnVsbCwyLDUsWCxbYixSLmMoYyxiaCwhMCldLG51bGwpLHhjKGEpKX12YXIgWGk9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsZCxlKXt2YXIgZj1udWxsOzI8YXJndW1lbnRzLmxlbmd0aCYmKGY9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMiksMCkpO3JldHVybiBiLmNhbGwodGhpcyxhLGQsZil9ZnVuY3Rpb24gYihhLGIsZSl7cmV0dXJuIFdpKGEsUy5jKGIsTmkoYSksZSkpfWEuaz0yO2EuZj1mdW5jdGlvbihhKXt2YXIgZD1GKGEpO2E9SShhKTt2YXIgZT1GKGEpO2E9RyhhKTtyZXR1cm4gYihkLGUsYSl9O2EuZD1iO3JldHVybiBhfSgpO3AoXCJtb3JpLnppcC56aXBwZXJcIixNaSk7cChcIm1vcmkuemlwLnNlcV96aXBcIixmdW5jdGlvbihhKXtyZXR1cm4gTWkoTWMsRmQsZnVuY3Rpb24oYSxjKXtyZXR1cm4gTihjLHhjKGEpKX0sYSl9KTtwKFwibW9yaS56aXAudmVjdG9yX3ppcFwiLGZ1bmN0aW9uKGEpe3JldHVybiBNaShIYyxFLGZ1bmN0aW9uKGEsYyl7cmV0dXJuIE4od2UoYykseGMoYSkpfSxhKX0pO3AoXCJtb3JpLnppcC5ub2RlXCIsTmkpO3AoXCJtb3JpLnppcC5pc19icmFuY2hcIix7fS54Yyk7cChcIm1vcmkuemlwLmNoaWxkcmVuXCIsUGkpO3AoXCJtb3JpLnppcC5tYWtlX25vZGVcIixRaSk7cChcIm1vcmkuemlwLnBhdGhcIixmdW5jdGlvbihhKXtyZXR1cm4gYWguYihhLmI/YS5iKDEpOmEuY2FsbChudWxsLDEpKX0pO3AoXCJtb3JpLnppcC5sZWZ0c1wiLGZ1bmN0aW9uKGEpe3JldHVybiBFKFpnLmIoYS5iP2EuYigxKTphLmNhbGwobnVsbCwxKSkpfSk7XG5wKFwibW9yaS56aXAucmlnaHRzXCIsZnVuY3Rpb24oYSl7cmV0dXJuIFdnLmIoYS5iP2EuYigxKTphLmNhbGwobnVsbCwxKSl9KTtwKFwibW9yaS56aXAuZG93blwiLFJpKTtwKFwibW9yaS56aXAudXBcIixTaSk7cChcIm1vcmkuemlwLnJvb3RcIixmdW5jdGlvbihhKXtmb3IoOzspe2lmKFdiLmEoZWgsYS5iP2EuYigxKTphLmNhbGwobnVsbCwxKSkpcmV0dXJuIE5pKGEpO3ZhciBiPVNpKGEpO2lmKHIoYikpYT1iO2Vsc2UgcmV0dXJuIE5pKGEpfX0pO3AoXCJtb3JpLnppcC5yaWdodFwiLFRpKTtwKFwibW9yaS56aXAucmlnaHRtb3N0XCIsVWkpO3AoXCJtb3JpLnppcC5sZWZ0XCIsVmkpO1xucChcIm1vcmkuemlwLmxlZnRtb3N0XCIsZnVuY3Rpb24oYSl7dmFyIGI9UC5jKGEsMCxudWxsKSxjPVAuYyhhLDEsbnVsbCksYz1NYyhjKT9TLmEoVGYsYyk6YyxkPVEuYShjLFpnKSxlPVEuYShjLFdnKTtyZXR1cm4gcihyKGMpP0UoZCk6Yyk/TihuZXcgVyhudWxsLDIsNSxYLFtGKGQpLFIuZChjLFpnLHFlLEooW1dnLHRkLmQoRyhkKSxuZXcgVyhudWxsLDEsNSxYLFtiXSxudWxsKSxKKFtlXSwwKSldLDApKV0sbnVsbCkseGMoYSkpOmF9KTtwKFwibW9yaS56aXAuaW5zZXJ0X2xlZnRcIixmdW5jdGlvbihhLGIpe3ZhciBjPVAuYyhhLDAsbnVsbCksZD1QLmMoYSwxLG51bGwpLGQ9TWMoZCk/Uy5hKFRmLGQpOmQsZT1RLmEoZCxaZyk7aWYobnVsbD09ZCl0aHJvd1wiSW5zZXJ0IGF0IHRvcFwiO3JldHVybiBOKG5ldyBXKG51bGwsMiw1LFgsW2MsUi5kKGQsWmcscGMuYShlLGIpLEooW2JoLCEwXSwwKSldLG51bGwpLHhjKGEpKX0pO1xucChcIm1vcmkuemlwLmluc2VydF9yaWdodFwiLGZ1bmN0aW9uKGEsYil7dmFyIGM9UC5jKGEsMCxudWxsKSxkPVAuYyhhLDEsbnVsbCksZD1NYyhkKT9TLmEoVGYsZCk6ZCxlPVEuYShkLFdnKTtpZihudWxsPT1kKXRocm93XCJJbnNlcnQgYXQgdG9wXCI7cmV0dXJuIE4obmV3IFcobnVsbCwyLDUsWCxbYyxSLmQoZCxXZyxNKGIsZSksSihbYmgsITBdLDApKV0sbnVsbCkseGMoYSkpfSk7cChcIm1vcmkuemlwLnJlcGxhY2VcIixXaSk7cChcIm1vcmkuemlwLmVkaXRcIixYaSk7cChcIm1vcmkuemlwLmluc2VydF9jaGlsZFwiLGZ1bmN0aW9uKGEsYil7cmV0dXJuIFdpKGEsUWkoYSxOaShhKSxNKGIsUGkoYSkpKSl9KTtwKFwibW9yaS56aXAuYXBwZW5kX2NoaWxkXCIsZnVuY3Rpb24oYSxiKXtyZXR1cm4gV2koYSxRaShhLE5pKGEpLHRkLmEoUGkoYSksbmV3IFcobnVsbCwxLDUsWCxbYl0sbnVsbCkpKSl9KTtcbnAoXCJtb3JpLnppcC5uZXh0XCIsZnVuY3Rpb24oYSl7aWYoV2IuYShlaCxhLmI/YS5iKDEpOmEuY2FsbChudWxsLDEpKSlyZXR1cm4gYTt2YXIgYjtiPU9pKGEpO2I9cihiKT9SaShhKTpiO2lmKHIoYikpcmV0dXJuIGI7Yj1UaShhKTtpZihyKGIpKXJldHVybiBiO2Zvcig7OylpZihyKFNpKGEpKSl7Yj1UaShTaShhKSk7aWYocihiKSlyZXR1cm4gYjthPVNpKGEpfWVsc2UgcmV0dXJuIG5ldyBXKG51bGwsMiw1LFgsW05pKGEpLGVoXSxudWxsKX0pO3AoXCJtb3JpLnppcC5wcmV2XCIsZnVuY3Rpb24oYSl7dmFyIGI9VmkoYSk7aWYocihiKSlmb3IoYT1iOzspaWYoYj1PaShhKSxiPXIoYik/UmkoYSk6YixyKGIpKWE9VWkoYik7ZWxzZSByZXR1cm4gYTtlbHNlIHJldHVybiBTaShhKX0pO3AoXCJtb3JpLnppcC5pc19lbmRcIixmdW5jdGlvbihhKXtyZXR1cm4gV2IuYShlaCxhLmI/YS5iKDEpOmEuY2FsbChudWxsLDEpKX0pO1xucChcIm1vcmkuemlwLnJlbW92ZVwiLGZ1bmN0aW9uKGEpe1AuYyhhLDAsbnVsbCk7dmFyIGI9UC5jKGEsMSxudWxsKSxiPU1jKGIpP1MuYShUZixiKTpiLGM9US5hKGIsWmcpLGQ9US5hKGIsVWcpLGU9US5hKGIsYWgpLGY9US5hKGIsV2cpO2lmKG51bGw9PWIpdGhyb3dcIlJlbW92ZSBhdCB0b3BcIjtpZigwPE8oYykpZm9yKGE9TihuZXcgVyhudWxsLDIsNSxYLFt5YyhjKSxSLmQoYixaZyx6YyhjKSxKKFtiaCwhMF0sMCkpXSxudWxsKSx4YyhhKSk7OylpZihiPU9pKGEpLGI9cihiKT9SaShhKTpiLHIoYikpYT1VaShiKTtlbHNlIHJldHVybiBhO2Vsc2UgcmV0dXJuIE4obmV3IFcobnVsbCwyLDUsWCxbUWkoYSx5YyhlKSxmKSxyKGQpP1IuYyhkLGJoLCEwKTpkXSxudWxsKSx4YyhhKSl9KTs7cmV0dXJuIHRoaXMubW9yaTt9LmNhbGwoe30pO30pO1xuIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFByb21pc2UsXG4gIE9wdGlvbnNcbikge1xuXG4gIC8qKlxuICAgKiBBIFNlcXVlbmNlciB3aGljaCBhZHZhbmNlcyBieSByZWFkaW5nIGZyb20gYSBDbG9jay5cbiAgICogTm90ZSB0aGF0IHRoaXMgQ2xvY2tTZXF1ZW5jZXIgcmVsaWVzIG9uIHRoZSBDbG9jayBwcm90b2NvbCwgd2hpY2hcbiAgICogb25seSBwcm92aWRlcyBgQ2xvY2sjZ2V0VGltZSgpYC4gSXQgZG9lcyBub3QgbW9kaWZ5IHRoZSBjbG9jayBpdHNlbGYuXG4gICAqIFRoaXMgbWVhbnMgaWYgeW91J3JlIHVzaW5nIGEgTG9naWNhbENsb2NrLCBpdCdzIHN0aWxsIHVwIHRvIHRoZSBjbG9jaydzXG4gICAqIG93bmVyIHRvIGFkdmFuY2UgdGhlIGNsb2NrIGZvciB0aGUgc2VxdWVuY2VyIHRvIGFkdmFuY2UuXG4gICAqL1xuICB2YXIgQ2xvY2tTZXF1ZW5jZXIgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfVxuXG4gIF8uZXh0ZW5kKENsb2NrU2VxdWVuY2VyLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG5cbiAgICAgIHRoaXMuX2Nsb2NrICAgID0gb3B0cy5nZXRPckVycm9yKFwiY2xvY2tcIik7XG4gICAgICB0aGlzLl9zZXF1ZW5jZSA9IG9wdHMuZ2V0T3JFbHNlKFwiaW5pdGlhbFNlcXVlbmNlXCIsIDApO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBBZHZhbmNlcyBieSBzZXR0aW5nIGl0cyBzZXF1ZW5jZSB0byB0aGUgYmFja2luZyBjbG9jaydzIHRpbWUuXG4gICAgICogTm90ZSB0aGF0IGlmIHRoaXMgbWV0aG9kIGlzIGNhbGxlZCB0d2ljZSB3aXRoaW4gdGhlIHNhbWUgdGltZSB1bml0LFxuICAgICAqIHRoZSBzZXF1ZW5jZSB3aWxsIG5vdCBhY3R1YWxseSBhZHZhbmNlLCBzaW5jZSB1bmlxdWUgdGltZSBpcyBub3RcbiAgICAgKiBndWFyYW50ZWVkIGJ5IG91ciBjbG9ja3MuXG4gICAgICpcbiAgICAgKiBAYXN5bmNcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTw+fVxuICAgICAqL1xuICAgIGFkdmFuY2U6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIFByb21pc2VcbiAgICAgICAgLmJpbmQodGhpcylcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX2Nsb2NrLmdldFRpbWUoKTtcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24odCkge1xuICAgICAgICAgIHRoaXMuX3NlcXVlbmNlID0gdDtcbiAgICAgICAgfSk7XG4gICAgfSksXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBjdXJyZW50IHNlcXVlbmNlLiBUaGlzIHZhbHVlIHNob3VsZCBhbHdheXMgYmUgdGhlIHNhbWVcbiAgICAgKiBvciBncmVhdGVyIHRoYW4gYSB2YWx1ZSByZXR1cm5lZCBwcmV2aW91c2x5IChpbiB0aW1lKS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IHRoZSBjdXJyZW50IHNlcXVlbmNlXG4gICAgICovXG4gICAgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3NlcXVlbmNlO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIENsb2NrU2VxdWVuY2VyO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiYmx1ZWJpcmRcIiksXG4gIHJlcXVpcmUoXCIuLi9vcHRpb25zXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFByb21pc2UsXG4gIE9wdGlvbnNcbikge1xuXG4gIC8qKlxuICAgKiBBIFVuaXRTZXF1ZW5jZXIgd2hpY2ggcmVwb3J0cyBpdHMgc2VxdWVuY2Ugc3VtbWVkIHdpdGggdGhlIHNlcXVlbmNlc1xuICAgKiBvZiBpdHMgaW50ZXJuYWwgY29sbGVjdGlvbiBvZiBzZXF1ZW5jZXJzLlxuICAgKlxuICAgKiBUaGlzIGRldmljZSBpcyB1c2VmdWwgZm9yIHRyYWNraW5nIHRoZSBzdGF0ZSBvZiBkYXRhIGNvbXByaXNlZCBmcm9tIG11bHRpcGxlXG4gICAqIHNvdXJjZXMuIEZvciBpbnN0YW5jZSwgeW91IG1pZ2h0IGhhdmUgQ2FjaGluZ0RhdGFTdG9yZShBKSBzdG9yaW5nIGRhdGFcbiAgICogZnJvbSBTb3VyY2UoQSksIHRyYWNrZWQgYnkgU2VxdWVuY2VyKEEpLCBhbmQgQ2FjaGluZ0RhdGFTdG9yZShCKSBzdG9yaW5nXG4gICAqIGRhdGEgZnJvbSBTb3VyY2UoQiksIHRyYWNrZWQgYnkgU2VxdWVuY2VyKEIpLiBNZWFud2hpbGUsIHlvdSBtYXkgaGF2ZVxuICAgKiBDYWNoaW5nRGF0YVN0b3JlKEMpLCBzdG9yaW5nIGRhdGEgZnJvbSBTb3VyY2UoQSArIEIpLCBhbmQgdHJhY2tlZCBieVxuICAgKiBTZXF1ZW5jZXIoQykgPSBTZXF1ZW5jZXIoQSArIEIpIC0gYSBEZWxlZ2F0aW5nQ29tcG9zaXRlU2VxdWVuY2VyLlxuICAgKlxuICAgKiBUaHVzLCBpZiBTZXF1ZW5jZXIoQSkgaXMgYWR2YW5jZWQsIGl0IG1heSBpbnZhbGlkYXRlIENhY2hpbmdEYXRhU3RvcmUoQSkgb3JcbiAgICogQ2FjaGluZ0RhdGFTdG9yZShDKSBvciBib3RoLlxuICAgKlxuICAgKiBOb3RlIHRoaXMgcGFydGljdWxhciB1c2FnZSBpcyBnZW5lcmFsbHkgb25seSB1c2VmdWwgZm9yIFVuaXQgc2VxdWVuY2Vycy5cbiAgICpcbiAgICogSWYgeW91J2QgbGlrZSB0aGUgYWJvdmUgZnVuY3Rpb25hbGl0eSwgYnV0IHdpdGggU2VxdWVuY2VyKEEpIGFuZFxuICAgKiBTZXF1ZW5jZXIoQikgYXMgQ2xvY2tTZXF1ZW5jZXJzLCBhbmQgU2VxdWVuY2VyKEMpIG1lcmVseSB0cmFja2luZ1xuICAgKiBtb2RpZmljYXRpb24sIHlvdSdkIG5lZWQgdG8gdXNlIGEgRGVsZWdhdGluZ0ZvcndhcmRpbmdTZXF1ZW5jZXIgZm9yIEEgYW5kIEIsXG4gICAqIGZvcndhcmRpbmcgdGhlbSB0byBVbml0U2VxdWVuY2VyKEMpLlxuICAgKlxuICAgKiBEZWxlZ2F0aW5nQ29tcG9zaXRlU2VxdWVuY2VyIGFuZCBEZWxlZ2F0aW5nRm9yd2FyZGluZ1NlcXVlbmNlciBhcmUgZWZmZWN0aXZseVxuICAgKiBvcHBvc2l0ZXMgb2YgZWFjaCBvdGhlci4gRGVsZWdhdGluZ0NvbXBvc2l0ZVNlcXVlbmNlciBjb21wb3NlcyB0aGUgYHZhbHVlYFxuICAgKiBvZiBtdWx0aXBsZSB1bmRlcmx5aW5nIHNlcXVlbmNlcnMgKHB1bGwpLCBhbmQgRGVsZWdhdGluZ0ZvcndhcmRpbmdTZXF1ZW5jZXJcbiAgICogZm9yd2FyZHMgdGhlIGBhZHZhbmNlYCBjYWxsIHRvIG11bHRpcGxlIHRhcmdldHMgKHB1c2gpLlxuICAgKi9cbiAgdmFyIERlbGVnYXRpbmdDb21wb3NpdGVTZXF1ZW5jZXIgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChEZWxlZ2F0aW5nQ29tcG9zaXRlU2VxdWVuY2VyLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB0aGlzLl9kZWxlZ2F0ZVNlcXVlbmNlciA9IG9wdHMuZ2V0T3JFcnJvcihcImRlbGVnYXRlXCIpO1xuICAgICAgdGhpcy5fc2VxdWVuY2VycyA9IF8uY2xvbmUob3B0cy5nZXRPckVsc2UoXCJzZXF1ZW5jZXJzXCIsIFtdKSk7XG4gICAgfSxcbiAgICBhZGRTZXF1ZW5jZXI6IGZ1bmN0aW9uKHNlcSkge1xuICAgICAgdGhpcy5fc2VxdWVuY2Vycy5wdXNoKHNlcSk7XG4gICAgfSxcbiAgICBhZHZhbmNlOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBzID0gdGhpcy5fZGVsZWdhdGVTZXF1ZW5jZXI7XG4gICAgICByZXR1cm4gcy5hZHZhbmNlLmFwcGx5KHMsIGFyZ3VtZW50cyk7XG4gICAgfSxcbiAgICB2YWx1ZTogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gX1xuICAgICAgICAuY2hhaW4odGhpcy5fc2VxdWVuY2VycylcbiAgICAgICAgLmludm9rZShcInZhbHVlXCIpXG4gICAgICAgIC5yZWR1Y2UoZnVuY3Rpb24oc3VtLCBuKSB7XG4gICAgICAgICAgcmV0dXJuIHN1bSArIG47XG4gICAgICAgIH0sIDApXG4gICAgICAgIC52YWx1ZSgpICsgdGhpcy5fZGVsZWdhdGVTZXF1ZW5jZXIudmFsdWUoKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBEZWxlZ2F0aW5nQ29tcG9zaXRlU2VxdWVuY2VyO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiYmx1ZWJpcmRcIiksXG4gIHJlcXVpcmUoXCIuLi9vcHRpb25zXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFByb21pc2UsXG4gIE9wdGlvbnNcbikge1xuXG4gIHZhciBVbml0U2VxdWVuY2VyID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoVW5pdFNlcXVlbmNlci5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzICAgICAgICAgICA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIHRoaXMuX3NlcXVlbmNlID0gb3B0cy5nZXRPckVsc2UoXCJpbml0aWFsU2VxdWVuY2VcIiwgMCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEFkdmFuY2VzIGl0cyBzZXF1ZW5jZSBieSBgYnlgLCBvciBieSBgMWAgaWYgYGJ5YCBpcyBub3QgcHJvdmlkZWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gYnkge251bWJlcn0gdGhlIGFtb3VudCB0byBhZHZhbmNlIGJ5LiBEZWZhdWx0cyB0byBgMWAuXG4gICAgICogQGFzeW5jXG4gICAgICogQHJldHVybnMge1Byb21pc2U8dW5kZWZpbmVkPn1cbiAgICAgKi9cbiAgICBhZHZhbmNlOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbihieSkge1xuICAgICAgLy8gV2FoaCB3YWhoIC0gZG9uJ3QgdXNlIGBieSB8fCAxYCwgb3IgeW91IGNhbid0IGFkdmFuY2UgYnkgMCwgd2hpY2ggaXMgc2lsbHlcbiAgICAgIC8vIGJ1dCBwb3RlbnRpYWxseSBuZWNlc3NhcnkuXG4gICAgICBieSAgICAgICAgICAgICA9IF8uaXNVbmRlZmluZWQoYnkpID8gMSA6IGJ5O1xuXG4gICAgICBpZiAoYnkgPCAwKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlVuaXRTZXF1ZW5jZXIjYWR2YW5jZSgpIHJlcXVpcmVzIHBvc2l0aXZlIGBieWAgb2Zmc2V0XCIpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9zZXF1ZW5jZSA9IHRoaXMuX3NlcXVlbmNlICsgYnk7XG4gICAgfSksXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBjdXJyZW50IHNlcXVlbmNlLiBUaGlzIHZhbHVlIHNob3VsZCBhbHdheXMgYmUgdGhlIHNhbWVcbiAgICAgKiBvciBncmVhdGVyIHRoYW4gYSB2YWx1ZSByZXR1cm5lZCBwcmV2aW91c2x5IChpbiB0aW1lKS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IHRoZSBjdXJyZW50IHNlcXVlbmNlXG4gICAgICovXG4gICAgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3NlcXVlbmNlO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIFVuaXRTZXF1ZW5jZXI7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJibHVlYmlyZFwiKSxcbiAgcmVxdWlyZShcIi4uL29wdGlvbnNcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgUHJvbWlzZSxcbiAgT3B0aW9uc1xuKSB7XG5cbiAgdmFyIERlbGVnYXRpbmdGb3J3YXJkaW5nU2VxdWVuY2VyID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoRGVsZWdhdGluZ0ZvcndhcmRpbmdTZXF1ZW5jZXIucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIHRoaXMuX2RlbGVnYXRlU2VxdWVuY2VyID0gb3B0cy5nZXRPckVycm9yKFwiZGVsZWdhdGVcIik7XG4gICAgICB0aGlzLl9mb3J3YXJkVGFyZ2V0cyA9IF8uY2xvbmUob3B0cy5nZXRPckVsc2UoXCJ0YXJnZXRzXCIsIFtdKSk7XG4gICAgfSxcbiAgICBhZGRUYXJnZXQ6IGZ1bmN0aW9uKHNlcSkge1xuICAgICAgdGhpcy5fZm9yd2FyZFRhcmdldHMucHVzaChzZXEpO1xuICAgIH0sXG4gICAgYWR2YW5jZTogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcyA9IHRoaXMuX2RlbGVnYXRlU2VxdWVuY2VyO1xuICAgICAgcmV0dXJuIHMuYWR2YW5jZS5hcHBseShzLCBhcmd1bWVudHMpXG4gICAgICAuYmluZCh0aGlzKVxuICAgICAgLnRoZW4oZnVuY3Rpb24odmFsKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlXG4gICAgICAgICAgLmFsbChfLmludm9rZSh0aGlzLl9mb3J3YXJkVGFyZ2V0cywgXCJhZHZhbmNlXCIpKVxuICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgLy8gUmV0dXJuIHRoZSB2YWx1ZSByZXR1cm5lZCBieSB0aGUgZGVsZWdhdGUgc2VxdWVuY2VyJ3NcbiAgICAgICAgICAgIC8vIGFkdmFuY2UgY2FsbCAoaWYgYW55KS4gVGhlIGFkdmFuY2VtZW50IG9mIHRoZSBmb3J3YXJkXG4gICAgICAgICAgICAvLyB0YXJnZXRzIHNob3VsZCBiZSB0cmFuc3BhcmVudC5cbiAgICAgICAgICAgIHJldHVybiB2YWw7XG4gICAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KSxcbiAgICB2YWx1ZTogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcyA9IHRoaXMuX2RlbGVnYXRlU2VxdWVuY2VyO1xuICAgICAgcmV0dXJuIHMudmFsdWUuYXBwbHkocywgYXJndW1lbnRzKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBEZWxlZ2F0aW5nRm9yd2FyZGluZ1NlcXVlbmNlcjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcImJsdWViaXJkXCIpLFxuICByZXF1aXJlKFwiLi4vb3B0aW9uc1wiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBQcm9taXNlLFxuICBPcHRpb25zXG4pIHtcbiAgLyoqXG4gICAqIEEgQ2xvY2sgd2hpY2ggYWxsb3dzIG1hbnVhbGx5IG1hbmlwdWxhdGluZyB0aGUgdW5kZXJseWluZyB0aW1lIHZhbHVlLFxuICAgKiBpcnJlc3BlY3RpdmUgb2YgcmVhbCB0aW1lLiBVc2VmdWwgZm9yIHRlc3RpbmcuXG4gICAqL1xuICB2YXIgTG9naWNhbENsb2NrID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoTG9naWNhbENsb2NrLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB0aGlzLl9jdXJyZW50VGltZSA9IG9wdHMuZ2V0T3JFbHNlKFwiaW5pdGlhbFRpbWVcIiwgMCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEBhc3luY1xuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPG51bWJlcj59IFRpbWUgaW4gbWlsbGlzZWNvbmRzIHNpbmNlIGVwb2NoXG4gICAgICogQHNlZSBDbG9jayNnZXRUaW1lKClcbiAgICAgKi9cbiAgICBnZXRUaW1lOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9jdXJyZW50VGltZTtcbiAgICB9KSxcblxuICAgIC8qKlxuICAgICAqIEFkdmFuY2VzIGludGVybmFsIHRpbWUsIGVpdGhlciBgb3B0cy5ieWAgYSBjZXJ0YWluIG9mZnNldCwgb3JcbiAgICAgKiBgb3B0cy50b2AgYSBwYXJ0aWN1bGFyIGFic29sdXRlIHRpbWUuIElmIHN1Y2Nlc3NmdWwsIHJldHVybnMgdGhlIHJlc3VsdFxuICAgICAqIG9mIGNhbGxpbmcgYExvZ2ljYWxDbG9jayNnZXRUaW1lKClgIGFzIGEgY29udmVuaWVuY2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gb3B0cy50byB7bnVtYmVyfSBhYnNvbHV0ZSB0aW1lIHRvIHNldCBjbG9jayB0by4gTXVzdCBiZSBsYXJnZXJcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICB0aGFuIHRoZSBjdXJyZW50IHRpbWVcbiAgICAgKiBAcGFyYW0gb3B0cy5ieSB7bnVtYmVyfSBvZmZzZXQgdG8gYWRkIHRvIGN1cnJlbnQgdGltZS4gTXVzdCBiZSBwb3NpdGl2ZS5cbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICBEZWZhdWx0cyB0byBgMWAgaWYgbmVpdGhlciBgb3B0cy50b2Agb3IgYG9wdHMuYnlgXG4gICAgICogICAgICAgICAgICAgICAgICAgICAgICAgYXJlIHNwZWNpZmllZC5cbiAgICAgKiBAYXN5bmNcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxudW1iZXI+fSByZXN1bHQgb2YgYExvZ2ljYWxDbG9jayNnZXRUaW1lKClgXG4gICAgICovXG4gICAgYWR2YW5jZVRpbWU6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKG9wdHMpe1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIHZhciBieSA9IG9wdHMuZ2V0T3JFbHNlKFwiYnlcIiwgMSksXG4gICAgICAgICAgdG8gPSBvcHRzLmdldE9yRWxzZShcInRvXCIsIHVuZGVmaW5lZCk7XG4gICAgICBpZiAoIV8uaXNVbmRlZmluZWQodG8pKSB7XG4gICAgICAgIGlmICh0byA8IHRoaXMuX2N1cnJlbnRUaW1lKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTG9naWNhbENsb2NrI2FkdmFuY2VUaW1lKCkgcmVxdWlyZXMgZm9yd2FyZCBtb3ZlbWVudCBvZiB0aW1lXCIpXG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fY3VycmVudFRpbWUgPSB0bztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChieSA8IDApIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJMb2dpY2FsQ2xvY2sjYWR2YW5jZVRpbWUoKSByZXF1aXJlcyBmb3J3YXJkIG1vdmVtZW50IG9mIHRpbWVcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fY3VycmVudFRpbWUgPSB0aGlzLl9jdXJyZW50VGltZSArIGJ5O1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMuZ2V0VGltZSgpO1xuICAgIH0pXG4gIH0pO1xuXG4gIHJldHVybiBMb2dpY2FsQ2xvY2s7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJibHVlYmlyZFwiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvb3B0aW9uc1wiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBQcm9taXNlXG4pIHtcblxuICAvKipcbiAgICogQSBDbG9jayB3aGljaCBkZWxlZ2F0ZXMgdG8gdGhlIHN5c3RlbSBjbG9jay5cbiAgICovXG4gIHZhciBTeXN0ZW1DbG9jayA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKFN5c3RlbUNsb2NrLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKCkge30sXG4gICAgLyoqXG4gICAgICogQGFzeW5jXG4gICAgICogQHJldHVybnMge1Byb21pc2U8bnVtYmVyPn0gVGltZSBpbiBtaWxsaXNlY29uZHMgc2luY2UgZXBvY2hcbiAgICAgKiBAc2VlIENsb2NrI2dldFRpbWUoKVxuICAgICAqL1xuICAgIGdldFRpbWU6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIERhdGUubm93KCk7XG4gICAgfSlcbiAgfSk7XG5cbiAgcmV0dXJuIFN5c3RlbUNsb2NrO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiYmx1ZWJpcmRcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgU2NvcGVkQ29uZmlndXJhdGlvblxuKSB7XG5cbiAgLyoqXG4gICAqIEEgZGV2aWNlIGZvciByZXNvbHZpbmcgYSBzZXQgb2YgcmF3IGNvbmZpZ3VyYXRpb25zIGdpdmVuIGEgc2V0IG9mXG4gICAqIHNjb3Blcy5cbiAgICpcbiAgICogVGhpcyBpcyB1c2VmdWwgZm9yIGhhdmluZyB0aGluZ3MgbGlrZSByZWdpb24tIG9yIHN0YWdlLXNwZWNpZmljIChhbmQvb3IgYm90aClcbiAgICogY29uZmlndXJhdGlvbnMuXG4gICAqXG4gICAqIEdpdmVuIHNldHMgb2YgcmF3IGNvbmZpZ3VyYXRpb25zIG9mIHRoZSBmb3JtOlxuICAgKlxuICAgKiAgIHtcbiAgICogICAgIFwic2NvcGUtMVwiIDoge1xuICAgKiAgICAgICBcImtleTFcIiA6IFwidmFsMVwiXG4gICAqICAgICB9LFxuICAgKiAgICAgXCJzY29wZS0xK2VudjFcIjoge1xuICAgKiAgICAgICBcImtleTJcIiA6IFwidmFsLWVudi0xXCJcbiAgICogICAgIH0sXG4gICAqICAgICBcInNjb3BlLTErZW52MlwiOiB7XG4gICAqICAgICAgIFwia2V5MlwiIDogXCJ2YWwtZW52LTJcIlxuICAgKiAgICAgfVxuICAgKiAgIH1cbiAgICpcbiAgICogYHJlc29sdmUoW1wic2NvcGUtMVwiXSlgIHdpbGwgcmV0dXJuOlxuICAgKlxuICAgKiAgIHtcbiAgICogICAgIFwia2V5MVwiIDogXCJ2YWwyXCJcbiAgICogICB9XG4gICAqXG4gICAqIGByZXNvbHZlKFtcInNjb3BlLTFcIiwgXCJlbnYtMVwiXSlgIHdpbGwgcmV0dXJuOlxuICAgKlxuICAgKiAgIHtcbiAgICogICAgIFwia2V5MVwiIDogXCJ2YWwxXCIsXG4gICAqICAgICBcImtleTJcIiA6IFwidmFsLWVudi0xXCJcbiAgICogICB9XG4gICAqXG4gICAqIGByZXNvbHZlKFtcInNjb3BlLTFcIiwgXCJlbnYtMlwiXSlgIHdpbGwgcmV0dXJuOlxuICAgKlxuICAgKiAgIHtcbiAgICogICAgIFwia2V5MVwiIDogXCJ2YWwxXCIsXG4gICAqICAgICBcImtleTJcIiA6IFwidmFsLWVudi0yXCJcbiAgICogICB9XG4gICAqXG4gICAqIFNjb3BlcyB1bmlvbnMgYXJlIHJlc29sdmVkIGluIHRoZSBmb2xsb3dpbmcgbWFubmVyOlxuICAgKiAgIDEuIGEgZ2l2ZW4gc2NvcGUgdW5pb24ncyBwYXJ0cyBhcmUgc29ydGVkXG4gICAqICAgMi4gc2NvcGUgdW5pb25zIGFzIGEgd2hvbGUgYXJlIGFwcGxpZWQgaW4gc29ydGVkIG9yZGVyXG4gICAqICAgMy4gcmVwZWF0IHRoZSBwcm9jZXNzIGZvciBhIGdpdmVuIGNvbmZpZ3VyYXRpb25cbiAgICpcbiAgICogU28sIGdpdmVuIHRocmVlIGNvbmZpZ3M6XG4gICAqXG4gICAqICB7XG4gICAqICAgIFwiYWFhXCI6IC4uLiAvLyAxXG4gICAqICAgIFwiY2NjXCI6IC4uLiAvLyAyXG4gICAqICB9XG4gICAqXG4gICAqICB7XG4gICAqICAgIFwiYWFhK2NjY1wiOiAuLi4gLy8gM1xuICAgKiAgICBcImNjY1wiICAgIDogLi4uIC8vIDRcbiAgICogIH1cbiAgICpcbiAgICogIHtcbiAgICogICAgXCJhYWErYmJiXCI6IC4uLiAvLyA1XG4gICAqICAgIFwiYmJiXCIgICAgOiAuLi4gLy8gNlxuICAgKiAgfVxuICAgKlxuICAgKiBUaGUgcmVzdWx0aW5nIG9yZGVyIHdpbGwgYmU6XG4gICAqICAgMSwgMiwgNCwgMywgNiwgNVxuICAgKlxuICAgKiBOb3RpY2UgMyBjb21lcyBiZWZvcmUgNSBldmVuIHRob3VnaCBpdCdzIGxvZ2ljYWxseSBcImFmdGVyXCIgaW4gc29ydGVkIG9yZGVyLFxuICAgKiBiZWNhdXNlIGNvbmZpZ3VyYXRpb24gb3JkZXIgb3ZlcnJpZGVzIHNjb3BlIG9yZGVyLiBUaGF0IGlzLCBzY29wZSB1bmlvbnNcbiAgICogYXJlIG9yZGVyZWQgd2l0aGluIGEgY29uZmlnLCBhbmQgdGhlbiBpbiBjb25maWcgb3JkZXIuXG4gICAqXG4gICAqL1xuICB2YXIgU2NvcGVkQ29uZmlndXJhdGlvblJlc29sdmVyID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH1cblxuICBfLmV4dGVuZChTY29wZWRDb25maWd1cmF0aW9uUmVzb2x2ZXIucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9jb25maWdzID0gW107XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEEgcmF3Q29uZmlnIGlzIGEgc2V0IG9mIGNvbmZpZ3VyYXRpb24gc2NvcGVzIGFuZCB0aGVpciBjb25maWd1cmF0aW9uXG4gICAgICogdmFsdWVzLCBlLmcuOlxuICAgICAqXG4gICAgICogICB7XG4gICAgICogICAgIFwic2NvcGUtMVwiIDoge1xuICAgICAqICAgICAgIFwia2V5MVwiIDogXCJ2YWwxXCJcbiAgICAgKiAgICAgfSxcbiAgICAgKiAgICAgXCJzY29wZS0xK2VudjFcIjoge1xuICAgICAqICAgICAgIFwia2V5MlwiIDogXCJ2YWwtZW52LTFcIlxuICAgICAqICAgICB9LFxuICAgICAqICAgICBcInNjb3BlLTErZW52MlwiOiB7XG4gICAgICogICAgICAgXCJrZXkyXCIgOiBcInZhbC1lbnYtMlwiXG4gICAgICogICAgIH1cbiAgICAgKiAgIH1cbiAgICAgKlxuICAgICAqIE5vdGUgdGhhdCB0aGUgcGx1cyAoKykgc2lnbiBpcyByZXNlcnZlZCBmb3Igc3BlY2lmeWluZyBzY29wZSB1bmlvbnMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcmF3Q29uZmlnIHtvYmplY3R9IChyZXF1aXJlZClcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHRoaXNcbiAgICAgKi9cbiAgICBhZGQ6IGZ1bmN0aW9uKHJhd0NvbmZpZykge1xuICAgICAgdGhpcy5fY29uZmlncy5wdXNoKG5ldyBTY29wZWRDb25maWd1cmF0aW9uKHJhd0NvbmZpZykpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFJlc29sdmVzIGEgY29tcHV0ZWQgZmluYWwgY29uZmlndXJhdGlvbiBnaXZlbiBhIHNldCBvZiBzY29wZXMgdG8gYXBwbHksXG4gICAgICogYW5kIGEgc2V0IG9mIGNvbmZpZ3MgbG9hZGVkIHZpYSBgU2NvcGVkQ29uZmlndXJhdGlvblJlc29sdmVyI2FkZCgpYC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBzY29wZXMge0FycmF5PHN0cmluZz59XG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7b2JqZWN0fSB0aGUgY29tcHV0ZWQgY29uZmlndXJhdGlvblxuICAgICAqL1xuICAgIHJlc29sdmU6IGZ1bmN0aW9uKHNjb3Blcykge1xuICAgICAgc2NvcGVzID0gcG93ZXJzZXQoXy5jbG9uZShzY29wZXMpLnNvcnQoKSk7XG4gICAgICBzY29wZXMuc2hpZnQoKTsgLy8gR2V0IHJpZCBvZiB0aGUgZW1wdHkgc2V0LlxuXG4gICAgICBzY29wZXMgPSBfLmNvbGxlY3Qoc2NvcGVzLCBmdW5jdGlvbihzKSB7XG4gICAgICAgIHJldHVybiBzLmpvaW4oXCIrXCIpO1xuICAgICAgfSk7XG5cbiAgICAgIHZhciByZWxldmFudENvbmZpZ3MgPSBfXG4gICAgICAgIC5jaGFpbih0aGlzLl9jb25maWdzKVxuICAgICAgICAuY29sbGVjdChmdW5jdGlvbihjKSB7XG4gICAgICAgICAgcmV0dXJuIF8uY29sbGVjdChzY29wZXMsIGZ1bmN0aW9uKHNjb3BlKSB7XG4gICAgICAgICAgICByZXR1cm4gYy5ibG9iRm9yU2NvcGUoc2NvcGUpO1xuICAgICAgICAgIH0pXG4gICAgICAgIH0pLmZsYXR0ZW4oKS52YWx1ZSgpO1xuXG4gICAgICByZWxldmFudENvbmZpZ3MudW5zaGlmdCh7fSk7XG4gICAgICByZXR1cm4gXy5leHRlbmQuYXBwbHkoXywgcmVsZXZhbnRDb25maWdzKTtcbiAgICB9XG4gIH0pO1xuXG4gIHZhciBwb3dlcnNldCA9IGZ1bmN0aW9uIChhcnkpIHtcbiAgICAgIHZhciBwcyA9IFtbXV07XG4gICAgICBmb3IgKHZhciBpPTA7IGkgPCBhcnkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBmb3IgKHZhciBqID0gMCwgbGVuID0gcHMubGVuZ3RoOyBqIDwgbGVuOyBqKyspIHtcbiAgICAgICAgICAgICAgcHMucHVzaChwc1tqXS5jb25jYXQoYXJ5W2ldKSk7XG4gICAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHBzO1xuICB9XG5cbiAgcmV0dXJuIFNjb3BlZENvbmZpZ3VyYXRpb25SZXNvbHZlcjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcIi4vc2NvcGVkLWNvbmZpZ3VyYXRpb25cIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgX1xuKSB7XG5cbiAgLyoqXG4gICAqIEdpdmVuIGEgcmF3IGNvbmZpZywgZW5zdXJlcyBibG9icyBjYW4gYmUgZmV0Y2hlZCByZWdhcmRsZXNzIG9mXG4gICAqIHNjb3BlIHVuaW9uIHNjb3BlIChpLmUuLCBkb2VzIHVuaW9uIGNhbm9uaWNhbGl6YXRpb24pLlxuICAgKlxuICAgKiBGb3IgZXhhbXBsZSwgYSBjb25maWcgd2l0aCBzY29wZSB1bmlvbiBgXCJiYmIrYWFhXCJgIGNhbiBsYXRlciBiZVxuICAgKiBmZXRjaGVkIHVzaW5nIGVpdGhlciBgXCJhYWErYmJiXCJgIG9yIGBcImJiYithYWFcImAuIEl0IGRvZXMgdGhpc1xuICAgKiBieSB1bmlmb3JtbHkgb3JkZXJpbmcgdGhlIHVuaW9uJ3MgY29tcG9zaXRlIHNjb3Blcy5cbiAgICpcbiAgICogVGhpcyBwcm9iYWJseSBpc24ndCBhIHVzZWZ1bCBjbGFzcyBvbiBpdHMgb3duLiBJbnN0ZWFkLCBkZWZlciB0b1xuICAgKiBgU2NvcGVkQ29uZmlndXJhdGlvblJlc29sdmVyYCBvciBgQ29uZmlndXJhdGlvbk1hZ2ljYC5cbiAgICovXG4gIHZhciBTY29wZWRDb25maWd1cmF0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH1cblxuICBfLmV4dGVuZChTY29wZWRDb25maWd1cmF0aW9uLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKHJhd0NvbmZpZykge1xuICAgICAgcmF3Q29uZmlnID0gcmF3Q29uZmlnIHx8IHt9O1xuICAgICAgdGhpcy5fc2NvcGVzID0ge307XG4gICAgICAvLyBTb3J0IHRoZSBzY29wZSBzdHJpbmdzXG4gICAgICBfLmVhY2gocmF3Q29uZmlnLCBmdW5jdGlvbihjb25maWcsIHNjb3BlU3RyaW5nKSB7XG4gICAgICAgIHZhciBzY29wZSA9IHNjb3BlU3RyaW5nLnNwbGl0KFwiK1wiKS5zb3J0KCkuam9pbihcIitcIik7XG4gICAgICAgIHRoaXMuX3Njb3Blc1tzY29wZV0gPSBjb25maWc7XG4gICAgICB9LCB0aGlzKTtcbiAgICB9LFxuXG4gICAgYmxvYkZvclNjb3BlOiBmdW5jdGlvbihzY29wZSkge1xuICAgICAgcmV0dXJuIF8uY2xvbmUodGhpcy5fc2NvcGVzW3Njb3BlLnNwbGl0KFwiK1wiKS5zb3J0KCkuam9pbihcIitcIildIHx8IHt9KTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBTY29wZWRDb25maWd1cmF0aW9uO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFJlZixcbiAgT3B0aW9uc1xuKSB7XG5cbiAgdmFyIExvZ2dlciA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKExvZ2dlci5wcm90b3R5cGUsIHtcblxuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB0aGlzLl9uYW1lICAgICAgICAgPSBvcHRzLmdldE9yRWxzZShcIm5hbWVcIiwgXCJEZWZhdWx0XCIpO1xuICAgICAgdGhpcy5fbG9nTGV2ZWwgICAgID0gb3B0cy5nZXRPckVsc2UoXCJsb2dMZXZlbFwiLCBMb2dVdGlsLkxldmVsLkluZm8pO1xuICAgICAgdGhpcy5fcGFyZW50ICAgICAgID0gb3B0cy5nZXRPckVsc2VGbihcInJlZlBhcmVudFwiLCBmdW5jdGlvbigpIHsgcmV0dXJuIFJlZihudWxsKSB9KTtcblxuICAgICAgdGhpcy5fYXBwZW5kZXJzID0gW107XG4gICAgfSxcblxuICAgIHRyYWNlOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX2xvZyhMb2dVdGlsLkxldmVsLlRyYWNlLCBfLnRvQXJyYXkoYXJndW1lbnRzKSk7XG4gICAgfSxcblxuICAgIGRlYnVnOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX2xvZyhMb2dVdGlsLkxldmVsLkRlYnVnLCBfLnRvQXJyYXkoYXJndW1lbnRzKSk7XG4gICAgfSxcblxuICAgIGluZm86IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fbG9nKExvZ1V0aWwuTGV2ZWwuSW5mbywgXy50b0FycmF5KGFyZ3VtZW50cykpO1xuICAgIH0sXG5cbiAgICB3YXJuOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX2xvZyhMb2dVdGlsLkxldmVsLldhcm4sIF8udG9BcnJheShhcmd1bWVudHMpKTtcbiAgICB9LFxuXG4gICAgZXJyb3I6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fbG9nKExvZ1V0aWwuTGV2ZWwuRXJyb3IsIF8udG9BcnJheShhcmd1bWVudHMpKTtcbiAgICB9LFxuXG4gICAgZmF0YWw6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fbG9nKExvZ1V0aWwuTGV2ZWwuRmF0YWwsIF8udG9BcnJheShhcmd1bWVudHMpKTtcbiAgICB9LFxuXG4gICAgaXNUcmFjZUVuYWJsZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuaXNMb2dMZXZlbEVuYWJsZWQoTG9nVXRpbC5MZXZlbC5UcmFjZSk7XG4gICAgfSxcblxuICAgIGlzRGVidWdFbmFibGVkOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLmlzTG9nTGV2ZWxFbmFibGVkKExvZ1V0aWwuTGV2ZWwuRGVidWcpO1xuICAgIH0sXG5cbiAgICBpc0luZm9FbmFibGVkOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLmlzTG9nTGV2ZWxFbmFibGVkKExvZ1V0aWwuTGV2ZWwuSW5mbyk7XG4gICAgfSxcblxuICAgIGlzV2FybkVuYWJsZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuaXNMb2dMZXZlbEVuYWJsZWQoTG9nVXRpbC5MZXZlbC5XYXJuKTtcbiAgICB9LFxuXG4gICAgaXNFcnJvckVuYWJsZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuaXNMb2dMZXZlbEVuYWJsZWQoTG9nVXRpbC5MZXZlbC5FcnJvcik7XG4gICAgfSxcblxuICAgIGlzRmF0YWxFbmFibGVkOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLmlzTG9nTGV2ZWxFbmFibGVkKExvZ1V0aWwuTGV2ZWwuRmF0YWwpO1xuICAgIH0sXG5cbiAgICBpc0xvZ0xldmVsRW5hYmxlZDogZnVuY3Rpb24obG9nTGV2ZWwpIHtcbiAgICAgIHZhciBjb2VyY2VkTG9nTGV2ZWwgPSBiKGxvZ0xldmVsKTtcbiAgICAgIHJldHVybiAodGhpcy5fbG9nTGV2ZWwgJiBjb2VyY2VkTG9nTGV2ZWwpID09PSBjb2VyY2VkTG9nTGV2ZWw7XG4gICAgfSxcblxuICAgIGFkZEFwcGVuZGVyOiBmdW5jdGlvbihhcHBlbmRlcikge1xuICAgICAgdGhpcy5fYXBwZW5kZXJzLnB1c2goYXBwZW5kZXIpO1xuICAgIH0sXG5cbiAgICBzZXRMb2dMZXZlbDogZnVuY3Rpb24obG9nTGV2ZWwpIHtcbiAgICAgIC8vIFNhdmUgYSBjb3B5IGZvciB0aGUgcG90ZW50aWFsIGVycm9yIG1lc3NhZ2VcbiAgICAgIHZhciBvcmlnaW5hbExvZ0xldmVsID0gbG9nTGV2ZWw7XG5cbiAgICAgIC8vIElmIG5hbWUgaXMgc3BlY2lmaWVkLCBlLmcuLCBcIkluZm9cIiwgY29udmVydCB0b1xuICAgICAgLy8gaW50XG4gICAgICBpZiAoXy5pc1N0cmluZyhsb2dMZXZlbCkpIHtcbiAgICAgICAgbG9nTGV2ZWwgPSBMb2dVdGlsLkxldmVsW2xvZ0xldmVsXVxuICAgICAgfVxuXG4gICAgICB2YXIgZXhpc3RzID0gXy5kZXRlY3QoTG9nVXRpbC5MZXZlbCwgZnVuY3Rpb24obGV2ZWwsIG5hbWUpIHtcbiAgICAgICAgcmV0dXJuIGxldmVsID09PSBsb2dMZXZlbDtcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoIWV4aXN0cykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGxvZ0xldmVsOiBcIiArIG9yaWdpbmFsTG9nTGV2ZWwpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9sb2dMZXZlbCA9IGxvZ0xldmVsO1xuICAgIH0sXG5cblxuICAgIF9sb2c6IGZ1bmN0aW9uKGxvZ0xldmVsLCBsb2dBcmdzKSB7XG4gICAgICB0aGlzLl9sb2dXaXRoTWV0YWRhdGEoW10sIGxvZ0xldmVsLCBsb2dBcmdzKTtcbiAgICB9LFxuXG4gICAgX2xvZ1dpdGhNZXRhZGF0YTogZnVuY3Rpb24oZGVzY2VuZGFudHMsIGxvZ0xldmVsLCBhcmdzKSB7XG4gICAgICBpZiAodGhpcy5pc0xvZ0xldmVsRW5hYmxlZChsb2dMZXZlbCkpIHtcbiAgICAgICAgXy5lYWNoKHRoaXMuX2FwcGVuZGVycywgZnVuY3Rpb24oYXBwZW5kZXIpIHtcbiAgICAgICAgICBhcHBlbmRlci5sb2codGhpcy5fbmFtZSwgZGVzY2VuZGFudHMsIGxvZ0xldmVsLCBMb2dVdGlsLl9MYWJlbFtsb2dMZXZlbF0sIGFyZ3MpO1xuICAgICAgICB9LCB0aGlzKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuX3BhcmVudC5nZXQoKSkge1xuICAgICAgICB0aGlzLl9wYXJlbnQuZ2V0KCkuX2xvZ1dpdGhNZXRhZGF0YShbdGhpcy5fbmFtZV0uY29uY2F0KGRlc2NlbmRhbnRzKSwgbG9nTGV2ZWwsIGFyZ3MpO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgdmFyIExvZ1V0aWwgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICAvLyBDb2VyY2UgKGp1c3QgdXNlIHJpZ2h0bW9zdCA4IGJpdHMpITsgYmVjYXVzZSBKUyBpcyBkdW1iLCBhbmQgZXZlcnl0aGluZyBpc1xuICAvLyBhY3R1YWxseSBhIGZsb2F0IHdpdGggNTMtYml0IHByZWNpc2lvblxuICB2YXIgYiA9IGZ1bmN0aW9uKHYpIHtcbiAgICByZXR1cm4gMHhGRiAmIHY7XG4gIH07XG5cbiAgXy5leHRlbmQoTG9nVXRpbCwge1xuICAgIExldmVsOiB7XG4gICAgICBUcmFjZTogYihwYXJzZUludChcIjExMTExMVwiLCAyKSksXG4gICAgICBEZWJ1ZzogYihwYXJzZUludChcIjAxMTExMVwiLCAyKSksXG4gICAgICBJbmZvOiAgYihwYXJzZUludChcIjAwMTExMVwiLCAyKSksXG4gICAgICBXYXJuOiAgYihwYXJzZUludChcIjAwMDExMVwiLCAyKSksXG4gICAgICBFcnJvcjogYihwYXJzZUludChcIjAwMDAxMVwiLCAyKSksXG4gICAgICBGYXRhbDogYihwYXJzZUludChcIjAwMDAwMVwiLCAyKSlcbiAgICB9XG4gIH0pO1xuXG4gIF8uZXh0ZW5kKExvZ1V0aWwucHJvdG90eXBlLCB7XG4gICAgTGV2ZWw6IExvZ1V0aWwuTGV2ZWwsXG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9yb290TG9nZ2VyID0gUmVmKG5ldyBMb2dnZXIoe1xuICAgICAgICBuYW1lOiBcIlJvb3RcIlxuICAgICAgfSkpO1xuICAgIH0sXG5cbiAgICBjcmVhdGU6IGZ1bmN0aW9uKG5hbWUsIG9wdHMpIHtcbiAgICAgIG9wdHMgPSBfLmNsb25lKG9wdHMgfHwge30pO1xuXG4gICAgICB2YXIgcGFyZW50O1xuICAgICAgaWYgKG9wdHMucGFyZW50KSB7XG4gICAgICAgIHBhcmVudCA9IFJlZihvcHRzLnBhcmVudCk7XG4gICAgICAgIGRlbGV0ZShvcHRzLnBhcmVudCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwYXJlbnQgPSBSZWYuZGVsZWdhdGluZyh0aGlzLl9yb290TG9nZ2VyKTtcbiAgICAgIH1cblxuICAgICAgb3B0cy5yZWZQYXJlbnQgPSBwYXJlbnQ7XG5cbiAgICAgIG9wdHMubmFtZSA9IG5hbWU7XG5cbiAgICAgIHJldHVybiBuZXcgTG9nZ2VyKG9wdHMpO1xuICAgIH0sXG5cbiAgICByb290OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9yb290TG9nZ2VyLmdldCgpO1xuICAgIH0sXG5cbiAgICByZXNldFJvb3RMb2dnZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fcm9vdExvZ2dlci5zZXQobmV3IExvZ2dlcih7XG4gICAgICAgIG5hbWU6IFwiUm9vdFwiXG4gICAgICB9KSk7XG4gICAgfVxuICB9KTtcblxuXG4gIExvZ1V0aWwuX0xhYmVsID0gXy5yZWR1Y2UoTG9nVXRpbC5MZXZlbCwgZnVuY3Rpb24obWVtbywgdmFsLCBrZXkpIHtcbiAgICBtZW1vW3ZhbF0gPSBrZXk7XG4gICAgcmV0dXJuIG1lbW87XG4gIH0sIHt9KTtcblxuICByZXR1cm4gbmV3IExvZ1V0aWwoKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcIi4uL3JlZlwiKSxcbiAgcmVxdWlyZShcIi4uL29wdGlvbnNcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgTSxcbiAgVVVJRCxcbiAgT3B0aW9ucyxcbiAgU3RhdGVHdWFyZFxuKSB7XG5cbiAgdmFyIENoYW5uZWwgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChDaGFubmVsLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG5cbiAgICAgIHRoaXMuX3NlbnRpbmVsICAgICAgPSBvcHRzLmdldE9yRXJyb3IoXCJzZW50aW5lbFwiKTtcbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQgICAgPSBuZXcgU3RhdGVHdWFyZChbXCJkaXNwb3NlZFwiXSk7XG4gICAgICB0aGlzLl9zdWJzY3JpcHRpb25zID0gTS5oYXNoX21hcCgpO1xuICAgIH0sXG5cbiAgICByZXNldDogZnVuY3Rpb24oKSB7XG4gICAgICBNLmVhY2godGhpcy5fc3Vic2NyaXB0aW9ucywgZnVuY3Rpb24ocGFpcikge1xuICAgICAgICBNLm50aChwYWlyLCAxKS5kaXNwb3NlKCk7XG4gICAgICB9KTtcbiAgICAgIHRoaXMuX3N1YnNjcmlwdGlvbnMgPSBNLmhhc2hfbWFwKCk7XG4gICAgfSxcblxuICAgIHB1Ymxpc2g6IGZ1bmN0aW9uKHNlbnRpbmVsLCBtc2cpIHtcbiAgICAgIHJldHVybiB0aGlzLl9wdWJsaXNoLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfSxcblxuXG4gICAgc3Vic2NyaWJlOiBmdW5jdGlvbihoYW5kbGVyKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc3Vic2NyaWJlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfSxcblxuXG4gICAgZGlzcG9zZTogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fZGlzcG9zZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH0sXG5cblxuICAgIGlzRGlzcG9zZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3N0YXRlR3VhcmQuYXBwbGllZChcImRpc3Bvc2VkXCIpO1xuICAgIH0sXG5cblxuICAgIF9wdWJsaXNoOiBmdW5jdGlvbihzZW50aW5lbCwgbXNnKSB7XG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkLmRlbnkoXCJkaXNwb3NlZFwiKTtcblxuICAgICAgaWYgKHRoaXMuX3NlbnRpbmVsICE9PSBzZW50aW5lbCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHNlbnRpbmVsIHByb3ZpZGVkOyBwdWJsaXNoZXIgbXVzdCBoYXZlIHNhbWUgc2VudGluZWwgcHJvdmlkZWQgZHVyaW5nIGluc3RhbnRpYXRpb24uXCIpO1xuICAgICAgfVxuICAgICAgdGhpcy5fZGlzcGF0Y2gobXNnKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0sXG5cblxuICAgIF9zdWJzY3JpYmU6IGZ1bmN0aW9uKGhhbmRsZXIpIHtcbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQuZGVueShcImRpc3Bvc2VkXCIpO1xuXG4gICAgICB2YXIgc3ViID0gbmV3IFN1YnNjcmlwdGlvbih0aGlzLCBoYW5kbGVyKSxcbiAgICAgICAgICBpZCAgPSBzdWIuaWQoKTtcblxuICAgICAgdGhpcy5fc3Vic2NyaXB0aW9ucyA9IE0uYXNzb2ModGhpcy5fc3Vic2NyaXB0aW9ucywgaWQsIHN1Yik7XG5cbiAgICAgIHJldHVybiBzdWI7XG4gICAgfSxcblxuXG4gICAgX2Rpc3Bvc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHRoaXMuX3N0YXRlR3VhcmQuYXBwbGllZChcImRpc3Bvc2VkXCIpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gR25hcmx5LCBhcyB0aGlzIGhvcHMgYmFjayBhbmQgZm9ydGggYmV0d2VlbiB0aGUgY2hhbm5lbCBhbmQgdGhlIHN1YiwgYnV0XG4gICAgICAvLyBlYXNpZXIgdGhhbiBzcGxpdHRpbmcgdGhlIGRpc3Bvc2UgbG9naWMgaW50byB0d28gbWV0aG9kcyBpbiB0aGUgc3ViLlxuICAgICAgTS5lYWNoKHRoaXMuX3N1YnNjcmlwdGlvbnMsIGZ1bmN0aW9uKHBhaXIpIHtcbiAgICAgICAgTS5udGgocGFpciwgMSkuZGlzcG9zZSgpO1xuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuX3N1YnNjcmlwdGlvbnMgPSBNLmhhc2hfbWFwKCk7XG5cbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQuYXBwbHkoXCJkaXNwb3NlZFwiKTtcbiAgICB9LFxuXG5cbiAgICBfZGlzcGF0Y2g6IGZ1bmN0aW9uKG1zZykge1xuICAgICAgTS5lYWNoKHRoaXMuX3N1YnNjcmlwdGlvbnMsIGZ1bmN0aW9uKHBhaXIpIHtcbiAgICAgICAgTS5udGgocGFpciwgMSkuZGlzcGF0Y2gobXNnKTtcbiAgICAgIH0pO1xuICAgIH0sXG5cblxuICAgIF9kaXNwb3NlSGFuZGxlOiBmdW5jdGlvbihpZCkge1xuICAgICAgdGhpcy5fc3Vic2NyaXB0aW9ucyA9IE0uZGlzc29jKHRoaXMuX3N1YnNjcmlwdGlvbnMsIGlkKTtcbiAgICB9XG4gIH0pO1xuXG4gIHZhciBTdWJzY3JpcHRpb24gPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChTdWJzY3JpcHRpb24ucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oY2hhbm5lbCwgaGFuZGxlcikge1xuICAgICAgdGhpcy5faWQgICAgICAgICA9IFVVSUQudjQoKTtcbiAgICAgIHRoaXMuX2NoYW5uZWwgICAgPSBjaGFubmVsO1xuICAgICAgdGhpcy5faGFuZGxlciAgICA9IGhhbmRsZXI7XG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkID0gbmV3IFN0YXRlR3VhcmQoW1wiZGlzcG9zZWRcIl0pO1xuXG4gICAgICBfLmJpbmRBbGwodGhpcywgXCJkaXNwb3NlXCIpO1xuICAgIH0sXG5cblxuICAgIGRpc3Bvc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHRoaXMuX3N0YXRlR3VhcmQuYXBwbGllZChcImRpc3Bvc2VkXCIpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdGhpcy5fY2hhbm5lbC5fZGlzcG9zZUhhbmRsZSh0aGlzLl9pZCk7XG5cbiAgICAgIHRoaXMuX2hhbmRsZXIgPSBudWxsO1xuICAgICAgdGhpcy5fY2hhbm5lbCA9IG51bGw7XG5cbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQuYXBwbHkoXCJkaXNwb3NlZFwiKTtcbiAgICB9LFxuXG5cbiAgICBpZDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5faWQ7XG4gICAgfSxcblxuXG4gICAgZGlzcGF0Y2g6IGZ1bmN0aW9uKG1zZykge1xuICAgICAgaWYgKHRoaXMuX3N0YXRlR3VhcmQuYXBwbGllZChcImRpc3Bvc2VkXCIpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdGhpcy5faGFuZGxlcihtc2cpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIENoYW5uZWw7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJtb3JpXCIpLFxuICByZXF1aXJlKFwiLi4vdXVpZFwiKSxcbiAgcmVxdWlyZShcIi4uL29wdGlvbnNcIiksXG4gIHJlcXVpcmUoXCIuLi9zdGF0ZS1ndWFyZFwiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBNLFxuICBPcHRpb25zLFxuICBDaGFubmVsXG4pIHtcblxuICB2YXIgQ2hhaW5lZENoYW5uZWwgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChDaGFpbmVkQ2hhbm5lbC5wcm90b3R5cGUsIENoYW5uZWwucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgQ2hhbm5lbC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcblxuICAgICAgXy5iaW5kQWxsKHRoaXMsIFwiX2ZvcndhcmRcIik7XG4gICAgICB0aGlzLl9jaGFpbmVkU3VicyA9IE0udmVjdG9yKCk7XG5cbiAgICAgIHZhciBpbml0aWFsbHlDaGFpbmVkVG8gPSBvcHRzLmdldE9yRWxzZShcImNoYWluVG9cIik7XG4gICAgICBpZiAoaW5pdGlhbGx5Q2hhaW5lZFRvKSB7XG4gICAgICAgIHRoaXMuY2hhaW5Ubyhpbml0aWFsbHlDaGFpbmVkVG8pO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBjaGFpblRvOiBmdW5jdGlvbihvdGhlckNoYW5uZWwpIHtcbiAgICAgIHRoaXMuX2NoYWluZWRTdWJzID0gTS5jb25qKHRoaXMuX2NoYWluZWRTdWJzLCBvdGhlckNoYW5uZWwuc3Vic2NyaWJlKHRoaXMuX2ZvcndhcmQpKTtcbiAgICB9LFxuXG4gICAgZGlzcG9zZTogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgc3VicyA9IHRoaXMuX2NoYWluZWRTdWJzO1xuXG4gICAgICB0aGlzLl9jaGFpbmVkU3VicyA9IE0udmVjdG9yKCk7XG5cbiAgICAgIE0uZWFjaChzdWJzLCBmdW5jdGlvbihzdWIpIHtcbiAgICAgICAgc3ViLmRpc3Bvc2UoKTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gdGhpcy5fZGlzcG9zZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH0sXG5cbiAgICBfZm9yd2FyZDogZnVuY3Rpb24obXNnKSB7XG4gICAgICB0aGlzLl9wdWJsaXNoKHRoaXMuX3NlbnRpbmVsLCBtc2cpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIENoYWluZWRDaGFubmVsO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwibW9yaVwiKSxcbiAgcmVxdWlyZShcIi4uL29wdGlvbnNcIiksXG4gIHJlcXVpcmUoXCIuL2NoYW5uZWxcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgTSxcbiAgT3B0aW9ucyxcbiAgQ2hhbm5lbFxuKSB7XG5cbiAgdmFyIENvbXBvc2l0ZUNoYW5uZWwgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChDb21wb3NpdGVDaGFubmVsLnByb3RvdHlwZSwgQ2hhbm5lbC5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBDaGFubmVsLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuXG4gICAgICB0aGlzLl9mb3J3YXJkaW5nID0gTS5oYXNoX21hcCgpO1xuXG4gICAgICB2YXIgbGlzdGVuID0gb3B0cy5nZXRPckVsc2UoXCJsaXN0ZW5cIiwgW10pO1xuICAgICAgaWYgKCFfLmlzQXJyYXkobGlzdGVuKSkge1xuICAgICAgICBsaXN0ZW4gPSBbbGlzdGVuXTtcbiAgICAgIH1cblxuICAgICAgXy5lYWNoKGxpc3RlbiwgXy5iaW5kKGZ1bmN0aW9uKGMpIHtcbiAgICAgICAgdGhpcy5saXN0ZW4oYyk7XG4gICAgICB9LCB0aGlzKSk7XG4gICAgfSxcblxuXG4gICAgZGlzcG9zZTogZnVuY3Rpb24oKSB7XG4gICAgICBDaGFubmVsLnByb3RvdHlwZS5kaXNwb3NlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB2YXIgZm9yd2FyZGluZyA9IHRoaXMuX2ZvcndhcmRpbmc7XG4gICAgICB0aGlzLl9mb3J3YXJkaW5nID0gTS5oYXNoX21hcCgpO1xuXG4gICAgICBNLmVhY2goZm9yd2FyZGluZywgXy5iaW5kKGZ1bmN0aW9uKHBhaXIpIHtcbiAgICAgICAgTS5udGgocGFpciwgMSkuZGlzcG9zZSgpO1xuICAgICAgfSwgdGhpcykpO1xuICAgIH0sXG5cblxuICAgIGxpc3RlbjogZnVuY3Rpb24oY2hhbm5lbCkge1xuICAgICAgdmFyIHN1YiA9IGNoYW5uZWwuc3Vic2NyaWJlKF8uYmluZChmdW5jdGlvbihtc2cpIHtcbiAgICAgICAgdGhpcy5fZm9yd2FyZChtc2cpXG4gICAgICB9LCB0aGlzKSk7XG4gICAgICB0aGlzLl9mb3J3YXJkaW5nID0gTS5hc3NvYyh0aGlzLl9mb3J3YXJkaW5nLCBjaGFubmVsLCBzdWIpO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBkaXNwb3NlOiBfLmJpbmQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdGhpcy5fZm9yd2FyZGluZyA9IE0uZGlzc29jKHRoaXMuX2ZvcndhcmRpbmcsIGNoYW5uZWwpO1xuICAgICAgICAgIHN1Yi5kaXNwb3NlKCk7XG4gICAgICAgIH0sIHRoaXMpXG4gICAgICB9O1xuICAgIH0sXG5cblxuICAgIF9mb3J3YXJkOiBmdW5jdGlvbihtc2cpIHtcbiAgICAgIHRoaXMucHVibGlzaCh0aGlzLl9zZW50aW5lbCwgbXNnKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBDb21wb3NpdGVDaGFubmVsO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwibW9yaVwiKSxcbiAgcmVxdWlyZShcIi4uL29wdGlvbnNcIiksXG4gIHJlcXVpcmUoXCIuL2NoYW5uZWxcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgUHJvbWlzZSxcbiAgTSxcbiAgT3B0aW9ucyxcbiAgVVVJRCxcbiAgU3RhdGVHdWFyZCxcbiAgTG9nZ2VyXG4pIHtcblxuICB2YXIgSW5NZW1vcnlGaWJlciA9IChmdW5jdGlvbigpIHtcbiAgICB2YXIgS2xhc3MgPSBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH07XG5cbiAgICB2YXIgTG9nID0gTG9nZ2VyLmNyZWF0ZShcIkluTWVtb3J5TG9nZ2VyXCIpO1xuXG4gICAgXy5leHRlbmQoS2xhc3MucHJvdG90eXBlLCB7XG4gICAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG5cbiAgICAgICAgdGhpcy5fZW50aXRpZXMgPSBNLmhhc2hfbWFwKCk7XG4gICAgICAgIHRoaXMuX2lkZW50aXR5ID0gb3B0cy5nZXRPckVsc2UoXCJpZGVudGl0eVwiLCBVVUlELnY0KCkpO1xuXG4gICAgICAgIHRoaXMuX3N0YXRlR3VhcmQgPSBuZXcgU3RhdGVHdWFyZChbXCJkaXNwb3NlZFwiXSk7XG5cbiAgICAgICAgXy5iaW5kQWxsKHRoaXMsIFwiX3JlY2VpdmVcIik7XG4gICAgICB9LFxuXG5cbiAgICAgIGlkOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lkZW50aXR5O1xuICAgICAgfSxcblxuXG4gICAgICBkaXNwb3NlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMuX3N0YXRlR3VhcmQuYXBwbGllZChcImRpc3Bvc2VkXCIpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2Rpc3Bvc2UoKTtcbiAgICAgICAgdGhpcy5fc3RhdGVHdWFyZC5hcHBseShcImRpc3Bvc2VkXCIpO1xuICAgICAgfSxcblxuICAgICAgX2Rpc3Bvc2U6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgIHZhciBlbnRpdGllcyA9IHRoaXMuX2VudGl0aWVzO1xuICAgICAgICBNLmVhY2goZW50aXRpZXMsIGZ1bmN0aW9uKHBhaXIpIHtcbiAgICAgICAgICBNLm50aChwYWlyLCAxKS5kaXNwb3NlKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuX2VudGl0aWVzID0gbnVsbDtcbiAgICAgIH0sXG5cbiAgICAgIHJlZ2lzdGVyRW50aXR5OiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG5cbiAgICAgICAgdmFyIGlkZW50aXR5ID0gb3B0cy5nZXRPckVycm9yKFwiaWRlbnRpdHlcIiksXG4gICAgICAgICAgICBlbnRpdHkgICA9IG5ldyBMb2NhbEVudGl0eSh7XG4gICAgICAgICAgICAgIGlkZW50aXR5OiBpZGVudGl0eSxcbiAgICAgICAgICAgICAgZGVsZWdhdGU6IG9wdHMuZ2V0T3JFcnJvcihcImRlbGVnYXRlXCIpXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLl9lbnRpdGllcyA9IE0uYXNzb2ModGhpcy5fZW50aXRpZXMsIGlkZW50aXR5LCBlbnRpdHkpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0sXG5cbiAgICAgIC8qKlxuICAgICAgICogUmV0dXJucyBhIHByb21pc2Ugd2hpY2ggaXMgZnVsZmlsbGVkIHdoZW4gdGhlIG1lc3NhZ2UgaXNcbiAgICAgICAqIHNlbnQsIG5vdCByZWNlaXZlZCBieSB0aGUgcmVtb3RlIGVuZC4gVGhpcyB0byBsZXQgdGhlXG4gICAgICAgKiBjYWxsZXIga25vdyB3aGV0aGVyIG9yIG5vdCB0aGUgbWVzc2FnZSBpcyBzdHVja1xuICAgICAgICogaW4gYSBidWZmZXIgc29tZXdoZXJlIHdoZW4gY2FsY3VsYXRpbmcgaXRzIHRpbWVvdXRzLlxuICAgICAgICovXG4gICAgICBzZW5kOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbihvcHRzKSB7XG4gICAgICAgIHRoaXMuX3N0YXRlR3VhcmQuZGVueShcImRpc3Bvc2VkXCIpO1xuXG4gICAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICAgIHZhciBmcm9tICAgPSBvcHRzLmdldE9yRXJyb3IoXCJmcm9tXCIpLFxuICAgICAgICAgICAgdG8gICAgID0gb3B0cy5nZXRPckVycm9yKFwidG9cIiksXG4gICAgICAgICAgICBib2R5ICAgPSBvcHRzLmdldE9yRXJyb3IoXCJib2R5XCIpLFxuICAgICAgICAgICAgbXNnSWQgID0gb3B0cy5nZXRPckVycm9yKFwibXNnSWRcIiksXG5cbiAgICAgICAgICAgIG1UICAgICA9IG9wdHMuZ2V0T3JFbHNlKFwibVRcIiksXG4gICAgICAgICAgICByTXNnSWQgPSBvcHRzLmdldE9yRWxzZShcInJNc2dJZFwiKTtcblxuXG4gICAgICAgIC8vWFhYOiBUaGlzIGlzIGluLW1lbW9yeSwgc28gaXQncyBhcyBzaW1wbGVcbiAgICAgICAgLy8gYXMgaW52b2tpbmcgX3JlY2VpdmUgaW4gYSBmdXR1cmUgY2FsbCBzdGFja1xuICAgICAgICByZXR1cm4gUHJvbWlzZVxuICAgICAgICAgIC5iaW5kKHRoaXMpXG4gICAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBfLmRlZmVyKHRoaXMuX3JlY2VpdmUsIHtcbiAgICAgICAgICAgICAgZnJvbTogICBmcm9tLFxuICAgICAgICAgICAgICB0bzogICAgIHRvLFxuICAgICAgICAgICAgICBib2R5OiAgIGJvZHksXG4gICAgICAgICAgICAgIG1zZ0lkOiAgbXNnSWQsXG4gICAgICAgICAgICAgIG1UOiAgICAgbVQsXG4gICAgICAgICAgICAgIHJNc2dJZDogck1zZ0lkLFxuICAgICAgICAgICAgICBvRmliOiAgIHRoaXMuX2lkZW50aXR5XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIG1zZ0lkO1xuICAgICAgICAgIH0pO1xuICAgICAgfSksXG5cbiAgICAgIF9yZWNlaXZlOiBmdW5jdGlvbihlbnYpIHtcbiAgICAgICAgaWYgKHRoaXMuX3N0YXRlR3VhcmQuYXBwbGllZChcImRpc3Bvc2VkXCIpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgZW52ID0gT3B0aW9ucy5mcm9tT2JqZWN0KGVudik7XG4gICAgICAgIHZhciB0bywgZnJvbSwgYm9keSwgbXNnSWQsIG9yaWdpbkZpYmVyLCBtVCwgck1zZ0lkO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgdG8gICAgICAgICAgPSBlbnYuZ2V0T3JFcnJvcihcInRvXCIpO1xuICAgICAgICAgIGZyb20gICAgICAgID0gZW52LmdldE9yRXJyb3IoXCJmcm9tXCIpO1xuICAgICAgICAgIGJvZHkgICAgICAgID0gZW52LmdldE9yRXJyb3IoXCJib2R5XCIpO1xuICAgICAgICAgIG1zZ0lkICAgICAgID0gZW52LmdldE9yRXJyb3IoXCJtc2dJZFwiKTtcblxuICAgICAgICAgIC8vIEZ1dHVyZS1wcm9vZmluZyBmb3IgbXVsdGktZmliZXIgZmFicmljLlxuICAgICAgICAgIG9yaWdpbkZpYmVyID0gZW52LmdldE9yRXJyb3IoXCJvRmliXCIpO1xuXG4gICAgICAgICAgbVQgICAgID0gZW52LmdldE9yRWxzZShcIm1UXCIpO1xuICAgICAgICAgIHJNc2dJZCA9IGVudi5nZXRPckVsc2UoXCJyTXNnSWRcIik7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBMb2cuZXJyb3IoXCJSZWNlaXZlZCBtYWxmb3JtZWQgbWVzc2FnZVwiLCBlbnYpO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGVudGl0eSA9IE0uZ2V0KHRoaXMuX2VudGl0aWVzLCB0byk7XG5cbiAgICAgICAgaWYgKGVudGl0eSkge1xuICAgICAgICAgIGVudGl0eS5kaXNwYXRjaCh7XG4gICAgICAgICAgICB0bzogICAgIHRvLFxuICAgICAgICAgICAgZnJvbTogICBmcm9tLFxuICAgICAgICAgICAgYm9keTogICBib2R5LFxuICAgICAgICAgICAgbXNnSWQ6ICBtc2dJZCxcbiAgICAgICAgICAgIHJNc2dJZDogck1zZ0lkLFxuICAgICAgICAgICAgb0ZpYjogICBvcmlnaW5GaWJlcixcbiAgICAgICAgICAgIGhGaWI6ICAgdGhpcy5faWRlbnRpdHksXG4gICAgICAgICAgICBtVDogbVRcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIEtsYXNzO1xuICB9KSgpO1xuXG5cblxuICB2YXIgTG9jYWxFbnRpdHkgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChMb2NhbEVudGl0eS5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuXG4gICAgICB0aGlzLl9pZGVudGl0eSA9IG9wdHMuZ2V0T3JFcnJvcihcImlkZW50aXR5XCIpO1xuICAgICAgdGhpcy5fZGVsZWdhdGUgPSBvcHRzLmdldE9yRXJyb3IoXCJkZWxlZ2F0ZVwiKTtcbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQgPSBuZXcgU3RhdGVHdWFyZChbXCJkaXNwb3NlZFwiXSk7XG4gICAgfSxcbiAgICBkaXNwb3NlOiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICh0aGlzLl9zdGF0ZUd1YXJkLmFwcGxpZWQoXCJkaXNwb3NlZFwiKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuX2RlbGVnYXRlID0gbnVsbDtcblxuICAgICAgdGhpcy5fc3RhdGVHdWFyZC5hcHBseShcImRpc3Bvc2VkXCIpO1xuICAgIH0sXG4gICAgZGlzcGF0Y2g6IGZ1bmN0aW9uKGVudikge1xuICAgICAgdGhpcy5fc3RhdGVHdWFyZC5kZW55KFwiZGlzcG9zZWRcIik7XG5cbiAgICAgIHRoaXMuX2RlbGVnYXRlLnJlY2VpdmVGaWJlck1lc3NhZ2UoZW52KTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBJbk1lbW9yeUZpYmVyO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiYmx1ZWJpcmRcIiksXG4gIHJlcXVpcmUoXCJtb3JpXCIpLFxuICByZXF1aXJlKFwiLi4vLi4vY29yZS9vcHRpb25zXCIpLFxuICByZXF1aXJlKFwiLi4vLi4vY29yZS91dWlkXCIpLFxuICByZXF1aXJlKFwiLi4vLi4vY29yZS9zdGF0ZS1ndWFyZFwiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvbG9nZ2luZy9sb2dnZXJcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgUHJvbWlzZSxcbiAgTSxcbiAgT3B0aW9ucyxcbiAgSW5NZW1vcnlGaWJlcixcbiAgQ2hhbm5lbCxcbiAgQ29tcG9zaXRlQ2hhbm5lbFxuKSB7XG5cbiAgLyoqXG4gICAqIExpbmthYmxlRmliZXIgaXMgYSByZWZlcmVuY2UgaW1wbGVtZW50YXRpb24gZm9yIGltcGxlbWVudGluZyBhIG11bHRpLWZpYmVyIFwiZmFicmljXCIuXG4gICAqL1xuICB2YXIgTGlua2FibGVGaWJlciA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKExpbmthYmxlRmliZXIucHJvdG90eXBlLCBJbk1lbW9yeUZpYmVyLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIEluTWVtb3J5RmliZXIucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG5cblxuICAgICAgdGhpcy5fbG9jYWxEaXNwYXRjaCAgPSBuZXcgQ2hhbm5lbCh7IHNlbnRpbmVsOiB0aGlzIH0pO1xuICAgICAgdGhpcy5faW5ncmVzc0NoYW5uZWwgPSBuZXcgQ29tcG9zaXRlQ2hhbm5lbCh7XG4gICAgICAgIHNlbnRpbmVsOiB0aGlzLFxuICAgICAgICBsaXN0ZW46ICAgdGhpcy5fbG9jYWxEaXNwYXRjaFxuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuX2VncmVzc0NoYW5uZWwgID0gbmV3IENoYW5uZWwoeyBzZW50aW5lbDogdGhpcyB9KTtcblxuICAgICAgLy8gX3JlY2VpdmUgaXMgZGVmaW5lZCBhbmQgYm91bmQgaW4gSW5NZW1vcnlGaWJlciAoXCJwcm90ZWN0ZWRcIiBtZXRob2QpXG4gICAgICB0aGlzLl9pbmdyZXNzQ2hhbm5lbC5zdWJzY3JpYmUodGhpcy5fcmVjZWl2ZSk7XG4gICAgfSxcblxuXG4gICAgbGlzdGVuOiBmdW5jdGlvbihjaGFubmVsKSB7XG4gICAgICB0aGlzLl9pbmdyZXNzQ2hhbm5lbC5saXN0ZW4oY2hhbm5lbCk7XG4gICAgfSxcblxuXG4gICAgZWdyZXNzQ2hhbm5lbDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fZWdyZXNzQ2hhbm5lbDtcbiAgICB9LFxuXG5cbiAgICBfZGlzcG9zZTogZnVuY3Rpb24oKSB7XG4gICAgICBJbk1lbW9yeUZpYmVyLnByb3RvdHlwZS5fZGlzcG9zZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH0sXG5cbiAgICBzZW5kOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbihvcHRzKSB7XG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkLmRlbnkoXCJkaXNwb3NlZFwiKTtcblxuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcblxuICAgICAgdmFyIGZyb20gICA9IG9wdHMuZ2V0T3JFcnJvcihcImZyb21cIiksXG4gICAgICAgICAgdG8gICAgID0gb3B0cy5nZXRPckVycm9yKFwidG9cIiksXG4gICAgICAgICAgYm9keSAgID0gb3B0cy5nZXRPckVycm9yKFwiYm9keVwiKSxcbiAgICAgICAgICBtc2dJZCAgPSBvcHRzLmdldE9yRXJyb3IoXCJtc2dJZFwiKSxcbiAgICAgICAgICBtVCAgICAgPSBvcHRzLmdldE9yRWxzZShcIm1UXCIpLFxuICAgICAgICAgIHJNc2dJZCA9IG9wdHMuZ2V0T3JFbHNlKFwick1zZ0lkXCIpLFxuICAgICAgICAgIGNoYW4gICA9IG51bGw7XG5cbiAgICAgIHZhciBtc2cgPSB7XG4gICAgICAgIGZyb206ICAgZnJvbSxcbiAgICAgICAgdG86ICAgICB0byxcbiAgICAgICAgYm9keTogICBib2R5LFxuICAgICAgICBtc2dJZDogIG1zZ0lkLFxuICAgICAgICBtVDogICAgIG1ULFxuICAgICAgICByTXNnSWQ6IHJNc2dJZCxcbiAgICAgICAgb0ZpYjogICB0aGlzLl9pZGVudGl0eVxuICAgICAgfTtcblxuICAgICAgLy8gTG9jYWwgZGlzcGF0Y2gsIHNraXAgdGhlIHJvdW5kLXRyaXBcbiAgICAgIGlmIChNLmdldCh0aGlzLl9lbnRpdGllcywgdG8pKSB7XG4gICAgICAgIGNoYW4gPSB0aGlzLl9sb2NhbERpc3BhdGNoO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2hhbiA9IHRoaXMuX2VncmVzc0NoYW5uZWw7XG4gICAgICB9XG5cbiAgICAgIF8uZGVmZXIoXy5iaW5kKGZ1bmN0aW9uKCkge1xuICAgICAgICBjaGFuLnB1Ymxpc2godGhpcywgbXNnKTtcbiAgICAgIH0sIHRoaXMpKTtcblxuICAgICAgcmV0dXJuIG1zZ0lkO1xuICAgIH0pXG5cblxuICB9KTtcblxuICByZXR1cm4gTGlua2FibGVGaWJlcjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcImJsdWViaXJkXCIpLFxuICByZXF1aXJlKFwibW9yaVwiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4vaW4tbWVtb3J5LWZpYmVyXCIpLFxuICByZXF1aXJlKFwiLi4vLi4vY29yZS9jaGFubmVsL2NoYW5uZWxcIiksXG4gIHJlcXVpcmUoXCIuLi8uLi9jb3JlL2NoYW5uZWwvY29tcG9zaXRlLWNoYW5uZWxcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgX1xuKSB7XG5cbiAgdmFyIEpTT05TZXJkZSA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKEpTT05TZXJkZS5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbigpIHt9LFxuXG5cbiAgICBzZXJpYWxpemU6IGZ1bmN0aW9uKHBheWxvYWQsIG9wdHMpIHtcbiAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShwYXlsb2FkKTtcbiAgICB9LFxuXG5cbiAgICBkZXNlcmlhbGl6ZTogZnVuY3Rpb24ocGF5bG9hZCwgb3B0cykge1xuICAgICAgcmV0dXJuIEpTT04ucGFyc2UocGF5bG9hZCk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gSlNPTlNlcmRlO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFJlZixcbiAgRGVsZWdhdGluZ1JlZlxuKSB7XG5cbiAgdmFyIGhlbHBlciA9IGZ1bmN0aW9uKHZhbCkge1xuICAgIHJldHVybiBuZXcgUmVmKHZhbCk7XG4gIH07XG5cbiAgaGVscGVyLmRlbGVnYXRpbmcgPSBmdW5jdGlvbihyZWYpIHtcbiAgICByZXR1cm4gbmV3IERlbGVnYXRpbmdSZWYocmVmKTtcbiAgfTtcblxuICByZXR1cm4gaGVscGVyO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiLi9yZWZcIiksXG4gIHJlcXVpcmUoXCIuL2RlbGVnYXRpbmctcmVmXCIpXG4pO1xuXG59KSgpIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbnZhciBQcm9taXNlID0gcmVxdWlyZShcIi4vcHJvbWlzZS5qc1wiKSgpO1xubW9kdWxlLmV4cG9ydHMgPSBQcm9taXNlOyIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBPcHRpb25zXG4pIHtcblxuICB2YXIgQ29uc29sZUxvZ0FwcGVuZGVyID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgdmFyIHAgPSBmdW5jdGlvbihudW0pIHtcbiAgICBpZiAoKFwiXCIgKyBudW0pLmxlbmd0aCA9PT0gMSkge1xuICAgICAgcmV0dXJuIFwiMFwiICsgbnVtO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gbnVtO1xuICAgIH1cbiAgfTtcblxuICBfLmV4dGVuZChDb25zb2xlTG9nQXBwZW5kZXIucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIHRoaXMuX2NvbnNvbGUgPSBvcHRzLmdldE9yRWxzZShcImNvbnNvbGVcIiwgY29uc29sZSk7XG4gICAgICB0aGlzLl90aW1lRGVsZWdhdGUgPSBvcHRzLmdldE9yRWxzZShcInRpbWVEZWxlZ2F0ZVwiLCBmdW5jdGlvbigpe1xuICAgICAgICB2YXIgZCA9IG5ldyBEYXRlKCk7XG4gICAgICAgIHJldHVybiBbZC5nZXRVVENGdWxsWWVhcigpLCBwKGQuZ2V0VVRDTW9udGgoKSksIHAoZC5nZXRVVENEYXkoKSldLmpvaW4oXCIvXCIpICtcbiAgICAgICAgICBcIiBcIiArIFtwKGQuZ2V0VVRDSG91cnMoKSksIHAoZC5nZXRVVENNaW51dGVzKCkpLCBwKGQuZ2V0VVRDU2Vjb25kcygpKV0uam9pbihcIjpcIikgK1xuICAgICAgICAgIFwiLlwiICsgZC5nZXRVVENNaWxsaXNlY29uZHMoKTtcbiAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBsb2c6IGZ1bmN0aW9uKGxvZ2dlck5hbWUsIGRlc2NlbmRhbnRzLCBsb2dMZXZlbCwgbG9nTGV2ZWxOYW1lLCBhcmdzKSB7XG4gICAgICAvLyBVc2UgdGhlIGZ1cnRoZXN0IGFuY2VzdG9yIGFzIHRoZSBsb2dnZWQgbmFtZSAoc2luY2UgaXQgb3JpZ2luYXRlZCB0aGVyZSlcbiAgICAgIHZhciBmdXJ0aGVzdEFuY2VzdG9yID0gZGVzY2VuZGFudHNbZGVzY2VuZGFudHMubGVuZ3RoIC0gMV07XG4gICAgICBpZiAoZnVydGhlc3RBbmNlc3Rvcikge1xuICAgICAgICBsb2dnZXJOYW1lID0gZnVydGhlc3RBbmNlc3RvcjtcbiAgICAgIH1cbiAgICAgIHRoaXMuX2xvZyhbXCJbXCIrbG9nTGV2ZWxOYW1lK1wiXVtcIit0aGlzLl9nZXRUaW1lKCkrXCJdW1wiK2xvZ2dlck5hbWUrXCJdXCJdLmNvbmNhdChhcmdzKSk7XG4gICAgfSxcblxuICAgIF9nZXRUaW1lOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl90aW1lRGVsZWdhdGUoKTtcbiAgICB9LFxuXG4gICAgX2xvZzogZnVuY3Rpb24obG9nSXRlbXMpIHtcbiAgICAgIC8vIFdoeSBkb2VzIGhlIGRvIHRoaXM/IElzIGhlIGluc2FuZT8gV2VsbCwgeWVzLlxuICAgICAgLy9cbiAgICAgIC8vIEJ1dCBtb3N0bHksIEkgZG8gdGhpcyBiZWNhdXNlIGNvbnNvbGUubG9nIGlzbid0LCBpbiBhbGwgY2FzZXMsXG4gICAgICAvLyBzb21ldGhpbmcgeW91IGNhbiBjYWxsIC5hcHBseSBvbi4gTGFzdCBJIGNoZWNrZWQsIGluIElFIGNhbGxpbmdcbiAgICAgIC8vIGNvbnNvbGUubG9nLmFwcGx5KGNvbnNvbGUsIFtdKSB3aWxsIHRocm93IGFuIGVycm9yLiBTbyB0aGF0J3Mgd2h5IHRoZVxuICAgICAgLy8gYmlnIHVnbHkgc3dpdGNoLlxuICAgICAgLy9cbiAgICAgIC8vIElmIHlvdSBuZWVkIG1vcmUgdGhhbiA3IGl0ZW1zLCB3ZWxsLCBJIGNhbid0IGhlbHAgeW91IChidXQgeW91IGNhbiAtIGFkZCBhbm90aGVyXG4gICAgICAvLyBzd2l0Y2ggY2FzZSkuXG4gICAgICBzd2l0Y2gobG9nSXRlbXMubGVuZ3RoKSB7XG4gICAgICAgIGNhc2UgMDpcbiAgICAgICAgICB0aGlzLl9jb25zb2xlLmxvZygpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgdGhpcy5fY29uc29sZS5sb2cobG9nSXRlbXNbMF0pO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgdGhpcy5fY29uc29sZS5sb2cobG9nSXRlbXNbMF0sIGxvZ0l0ZW1zWzFdKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAzOlxuICAgICAgICAgIHRoaXMuX2NvbnNvbGUubG9nKGxvZ0l0ZW1zWzBdLCBsb2dJdGVtc1sxXSwgbG9nSXRlbXNbMl0pO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgdGhpcy5fY29uc29sZS5sb2cobG9nSXRlbXNbMF0sIGxvZ0l0ZW1zWzFdLCBsb2dJdGVtc1syXSwgbG9nSXRlbXNbM10pO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgdGhpcy5fY29uc29sZS5sb2cobG9nSXRlbXNbMF0sIGxvZ0l0ZW1zWzFdLCBsb2dJdGVtc1syXSwgbG9nSXRlbXNbM10sIGxvZ0l0ZW1zWzRdKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSA2OlxuICAgICAgICAgIHRoaXMuX2NvbnNvbGUubG9nKGxvZ0l0ZW1zWzBdLCBsb2dJdGVtc1sxXSwgbG9nSXRlbXNbMl0sIGxvZ0l0ZW1zWzNdLCBsb2dJdGVtc1s0XSwgbG9nSXRlbXNbNV0pO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgdGhpcy5fY29uc29sZS5sb2cobG9nSXRlbXNbMF0sIGxvZ0l0ZW1zWzFdLCBsb2dJdGVtc1syXSwgbG9nSXRlbXNbM10sIGxvZ0l0ZW1zWzRdLCBsb2dJdGVtc1s1XSwgbG9nSXRlbXNbNl0pO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHZhciBsYWJlbCA9IGxvZ0l0ZW1zLnNoaWZ0KCk7XG4gICAgICAgICAgdGhpcy5fY29uc29sZS5sb2cobGFiZWwsIGxvZ0l0ZW1zKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBDb25zb2xlTG9nQXBwZW5kZXI7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCIuLi8uLi9vcHRpb25zXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UsIHByb2Nlc3M6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBQcm9taXNlLFxuICBPcHRpb25zLFxuICBMb2dnZXJcbikge1xuXG4gIHZhciBMb2cgPSBMb2dnZXIuY3JlYXRlKFwiQXBwQ29udGFpbmVyXCIpO1xuXG4gIHZhciBXZWJBcHBDb250YWluZXIgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChXZWJBcHBDb250YWluZXIucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKVxuICAgICAgdGhpcy5fYXBwID0gb3B0cy5nZXRPckVycm9yKFwiYXBwXCIpO1xuICAgIH0sXG5cbiAgICBzdGFydDogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZVxuICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fYXBwLnN0YXJ0KCk7XG4gICAgICAgIH0pO1xuICAgIH0pLFxuXG4gICAgc3RvcDogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24ocmVhc29uKSB7XG4gICAgICByZXR1cm4gdGhpcy5fYXBwLnN0b3AoKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAocmVhc29uKSB7XG4gICAgICAgICAgTG9nLmVycm9yKFwiU3RvcHBpbmcgZHVlIHRvIHJlYXNvbjpcIiwgcmVhc29uKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSlcbiAgfSk7XG5cbiAgcmV0dXJuIFdlYkFwcENvbnRhaW5lcjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcImJsdWViaXJkXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9vcHRpb25zXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9sb2dnaW5nL2xvZ2dlclwiKVxuKTtcblxufSkoKSIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFByb21pc2UsXG4gIE9wdGlvbnMsXG4gIExvZ2dlcixcbiAgQ29uZmlndXJhdGlvbk1hZ2ljLFxuICBBcHBDb250YWluZXJcbikge1xuICB2YXIgTG9nID0gTG9nZ2VyLmNyZWF0ZShcIkJvb3RzdHJhcHBlclwiKTtcblxuICB2YXIgQm9vdHN0cmFwcGVyID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoQm9vdHN0cmFwcGVyLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB0aGlzLl9jb25maWdzID0gb3B0cy5nZXRPckVycm9yKFwiY29uZmlndXJhdGlvbnNcIik7XG4gICAgICB0aGlzLl9zY29wZXMgPSBvcHRzLmdldE9yRXJyb3IoXCJzY29wZXNcIik7XG4gICAgICB0aGlzLl9hcHBLbGFzcyA9IG9wdHMuZ2V0T3JFcnJvcihcImFwcGxpY2F0aW9uQ29uc3RydWN0b3JcIik7XG4gICAgfSxcbiAgICBib290c3RyYXA6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIFByb21pc2VcbiAgICAgICAgLmJpbmQodGhpcylcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyIGNvbmZpZyAgICAgICA9IENvbmZpZ3VyYXRpb25NYWdpYy5yZXNvbHZlQ29uZmlnKHRoaXMuX3Njb3BlcywgdGhpcy5fY29uZmlncyksXG4gICAgICAgICAgICAgIEFwcEtsYXNzICAgICA9IHRoaXMuX2FwcEtsYXNzO1xuXG4gICAgICAgICAgTG9nLmluZm8oXCJVc2luZyByZXNvbHZlZCBjb25maWd1cmF0aW9uOiBcIiwgSlNPTi5zdHJpbmdpZnkoY29uZmlnKSk7XG5cbiAgICAgICAgICB2YXIgYXBwICAgICAgICAgID0gbmV3IEFwcEtsYXNzKHtjb25maWd1cmF0aW9uOiBjb25maWd9KSxcbiAgICAgICAgICAgICAgYXBwQ29udGFpbmVyID0gbmV3IEFwcENvbnRhaW5lcih7YXBwOiBhcHB9KTtcblxuICAgICAgICAgIHJldHVybiBhcHBDb250YWluZXI7XG4gICAgICAgIH0pO1xuICAgIH0pXG4gIH0pO1xuXG4gIHJldHVybiBCb290c3RyYXBwZXI7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJibHVlYmlyZFwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvbG9nZ2luZy9sb2dnZXJcIiksXG4gIHJlcXVpcmUoXCIuL2NvbmZpZ3VyYXRpb24tbWFnaWNcIiksXG4gIHJlcXVpcmUoXCIuL3dlYi1hcHAtY29udGFpbmVyXCIpXG4pO1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgX1xuKSB7XG5cbiAgdmFyIFdlYlNjaGVkdWxlciA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKFdlYlNjaGVkdWxlci5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbigpIHt9LFxuXG4gICAgcnVuU29vbjogZnVuY3Rpb24oZm4pIHtcbiAgICAgIHRoaXMuc2NoZWR1bGUoZm4pO1xuICAgIH0sXG5cbiAgICBzY2hlZHVsZTogZnVuY3Rpb24oZm4sIGRlbGF5KSB7XG4gICAgICBkZWxheSA9IGRlbGF5IHx8IDE7XG4gICAgICByZXR1cm4gc2V0VGltZW91dChmbiwgZGVsYXkpO1xuICAgIH0sXG5cbiAgICB1bnNjaGVkdWxlOiBmdW5jdGlvbihpZCkge1xuICAgICAgcmV0dXJuIGNsZWFyVGltZW91dChpZCk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gV2ViU2NoZWR1bGVyO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpXG4pO1xuIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIE9wdGlvbnMsXG4gIFJlZixcbiAgU2V0VGltZW91dFNjaGVkdWxlclxuKSB7XG5cbiAgdmFyIERlZmF1bHRSdW50aW1lID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoRGVmYXVsdFJ1bnRpbWUucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcblxuICAgICAgdGhpcy5fc2NoZWR1bGVyUmVmID0gUmVmKG9wdHMuZ2V0T3JFbHNlRm4oXCJzY2hlZHVsZXJcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBuZXcgU2V0VGltZW91dFNjaGVkdWxlcigpO1xuICAgICAgfSkpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7UmVmPFNjaGVkdWxlcj59XG4gICAgICovXG4gICAgc2NoZWR1bGVyOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBSZWYuZGVsZWdhdGluZyh0aGlzLl9zY2hlZHVsZXJSZWYpO1xuICAgIH0sXG5cbiAgICBzZXRTY2hlZHVsZXI6IGZ1bmN0aW9uKHNjaGVkdWxlcikge1xuICAgICAgdGhpcy5fc2NoZWR1bGVyUmVmLnNldChzY2hlZHVsZXIpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIERlZmF1bHRSdW50aW1lO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9vcHRpb25zXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9yZWZcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL3NjaGVkdWxlci9zZXQtdGltZW91dC1zY2hlZHVsZXJcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgT3B0aW9uc1xuKSB7XG5cbiAgdmFyIFN0b3JlRW50cnkgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChTdG9yZUVudHJ5LnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICAvLyBQZXJmZWN0bHkgYWNjZXB0YWJsZSB0byBwYXNzIGluIHVuZGVmaW5lZC4uLlxuICAgICAgdGhpcy5fdmFsdWUgPSBvcHRzLmdldE9yRWxzZShcInZhbHVlXCIsIHVuZGVmaW5lZCk7XG4gICAgICB0aGlzLl9sYXN0U2VxdWVuY2UgPSBvcHRzLmdldE9yRXJyb3IoXCJpbml0aWFsU2VxdWVuY2VcIik7XG5cbiAgICAgIHRoaXMuX3R0bCA9IG9wdHMuZ2V0T3JFbHNlKFwidHRsXCIpO1xuICAgIH0sXG5cbiAgICBpc0V4cGlyZWQ6IGZ1bmN0aW9uKHNlcXVlbmNlLCBmYWxsYmFja1R0bCkge1xuICAgICAgdmFyIHR0bCA9IHRoaXMuX3R0bCB8fCBmYWxsYmFja1R0bDtcbiAgICAgIGlmICghdHRsKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vIFRUTCBzcGVjaWZpZWQhXCIpO1xuICAgICAgfVxuICAgICAgLy8gRS5nLiwgbGFzdFNlcXVlbmNlID0gNCwgdHRsID0gMSwgc2VxdWVuY2UgPSA1OiBleHBpcmVkXG4gICAgICAvLyAgICAgICBsYXN0U2VxdWVuY2UgPSA0LCB0dGwgPSAxLCBzZXF1ZW5jZSA9IDQ6IG5vdCBleHBpcmVkXG4gICAgICAvLyAgICAgICBsYXN0U2VxdWVuY2UgPSA0LCB0dGwgPSAyLCBzZXF1ZW5jZSA9IDU6IG5vdCBleHBpcmVkXG4gICAgICByZXR1cm4gISh0aGlzLl9sYXN0U2VxdWVuY2UgKyB0dGwgPiBzZXF1ZW5jZSk7XG4gICAgfSxcblxuICAgIHRvdWNoOiBmdW5jdGlvbihzZXF1ZW5jZSkge1xuICAgICAgdGhpcy5fbGFzdFNlcXVlbmNlID0gc2VxdWVuY2U7XG4gICAgfSxcblxuICAgIHVwZGF0ZTogZnVuY3Rpb24odmFsLCBzZXF1ZW5jZSwgb3B0cykge1xuICAgICAgdGhpcy5fdmFsdWUgICAgICAgID0gdmFsO1xuICAgICAgdGhpcy5fbGFzdFNlcXVlbmNlID0gc2VxdWVuY2U7XG5cbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB0aGlzLl90dGwgPSBvcHRzLmdldE9yRWxzZShcInR0bFwiKTtcbiAgICB9LFxuXG4gICAgZGlzcG9zZTogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl92YWx1ZSAgICAgICAgPSBudWxsO1xuICAgICAgdGhpcy5fbGFzdFNlcXVlbmNlID0gbnVsbDtcbiAgICB9LFxuXG4gICAgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIFN0b3JlRW50cnk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCIuLi8uLi9jb3JlL29wdGlvbnNcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgTG9nZ2VyLFxuICBPcHRpb25zXG4pIHtcblxuICB2YXIgVEVOX01JTlVURVNfSU5fTUlMTElTRUNPTkRTID0gNjAgKiAxMDAwICogMTA7XG5cbiAgdmFyIExvZyA9IExvZ2dlci5jcmVhdGUoXCJQcm9jZXNzS2VlcEFsaXZlXCIpO1xuXG4gIHZhciBQcm9jZXNzS2VlcEFsaXZlID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoUHJvY2Vzc0tlZXBBbGl2ZS5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdGhpcy5fc2NoZWR1bGVyID0gb3B0cy5nZXRPckVycm9yKFwic2NoZWR1bGVyXCIpO1xuICAgICAgdGhpcy5fdGltZW91dElkID0gbnVsbDtcblxuICAgICAgXy5iaW5kQWxsKHRoaXMsIFwiX2N5Y2xlXCIpO1xuICAgIH0sXG4gICAgc3RhcnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgTG9nLmRlYnVnKFwiU3RhcnRpbmcgUHJvY2Vzc0tlZXBBbGl2ZVwiKTtcbiAgICAgIHRoaXMuX2N5Y2xlKCk7XG4gICAgfSxcbiAgICBzdG9wOiBmdW5jdGlvbigpIHtcbiAgICAgIExvZy5kZWJ1ZyhcIlN0b3BwaW5nIFByb2Nlc3NLZWVwQWxpdmVcIik7XG4gICAgICBpZiAodGhpcy5fdGltZW91dElkKSB7XG4gICAgICAgIHRoaXMuX3NjaGVkdWxlci5nZXQoKS51bnNjaGVkdWxlKHRoaXMuX3RpbWVvdXRJZCk7XG4gICAgICAgIHRoaXMuX3RpbWVvdXRJZCA9IG51bGw7XG4gICAgICB9XG4gICAgfSxcbiAgICBfY3ljbGU6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fdGltZW91dElkID0gdGhpcy5fc2NoZWR1bGVyLmdldCgpLnNjaGVkdWxlKFxuICAgICAgICB0aGlzLl9jeWNsZSxcbiAgICAgICAgVEVOX01JTlVURVNfSU5fTUlMTElTRUNPTkRTXG4gICAgICApO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIFByb2Nlc3NLZWVwQWxpdmU7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCIuLi8uLi9jb3JlL2xvZ2dpbmcvbG9nZ2VyXCIpLFxuICByZXF1aXJlKFwiLi4vLi4vY29yZS9vcHRpb25zXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFByb21pc2UsXG4gIE0sXG4gIE9wdGlvbnMsXG4gIFVVSUQsXG4gIENoYWluZWRDaGFubmVsLFxuICBDaGFubmVsLFxuICBDb21wb3NpdGVDaGFubmVsLFxuICBTdGF0ZUd1YXJkXG4pIHtcblxuXG4gIHZhciBNYWlsYm94ID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoTWFpbGJveC5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdGhpcy5faWQgICAgICAgICAgICAgICAgICAgID0gVVVJRC52NCgpO1xuICAgICAgdGhpcy5fb3duZXJJZGVudGl0eSAgICAgICAgID0gb3B0cy5nZXRPckVycm9yKFwib3duZXJJZGVudGl0eVwiKTtcbiAgICAgIHRoaXMuX2V4Y2hhbmdlICAgICAgICAgICAgICA9IG9wdHMuZ2V0T3JFcnJvcihcImV4Y2hhbmdlXCIpO1xuICAgICAgdGhpcy5fb25lU2hvdENoYW5uZWwgICAgICAgID0gbmV3IENoYW5uZWwoeyBzZW50aW5lbDogdGhpcyB9KTtcbiAgICAgIHRoaXMuX3JlcXVlc3RSZXBseUNoYW5uZWwgICA9IG5ldyBDaGFubmVsKHsgc2VudGluZWw6IHRoaXMgfSk7XG4gICAgICB0aGlzLl9pbmdyZXNzQ2hhbm5lbCAgICAgICAgPSBuZXcgQ29tcG9zaXRlQ2hhbm5lbCh7XG4gICAgICAgIHNlbnRpbmVsOiB0aGlzLFxuICAgICAgICBsaXN0ZW46IFt0aGlzLl9vbmVTaG90Q2hhbm5lbCwgdGhpcy5fcmVxdWVzdFJlcGx5Q2hhbm5lbF1cbiAgICAgIH0pO1xuICAgICAgdGhpcy5fc3RhdGVHdWFyZCAgICAgICAgICAgID0gbmV3IFN0YXRlR3VhcmQoW1wiZGlzcG9zZWRcIl0pO1xuXG4gICAgICB0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RJZHMgPSBNLnNldCgpO1xuICAgIH0sXG5cbiAgICBpZDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5faWQ7XG4gICAgfSxcblxuICAgIG93bmVySWRlbnRpdHk6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX293bmVySWRlbnRpdHk7XG4gICAgfSxcblxuICAgIGRpc3Bvc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHRoaXMuX3N0YXRlR3VhcmQuYXBwbGllZChcImRpc3Bvc2VkXCIpKXtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9vbmVTaG90Q2hhbm5lbC5kaXNwb3NlKCk7XG4gICAgICB0aGlzLl9yZXF1ZXN0UmVwbHlDaGFubmVsLmRpc3Bvc2UoKTtcbiAgICAgIHRoaXMuX2luZ3Jlc3NDaGFubmVsLmRpc3Bvc2UoKTtcblxuICAgICAgLy8gQXR0ZW1wdCB0byBjYW5jZWwgYWxsIG91dHN0YW5kaW5nIHJlcXVlc3RzLlxuICAgICAgLy8gVGhpcyBpcyBhbiBhc3luYyByZXF1ZXN0LCBzbyB3ZSBqdXN0IGhhdmUgdG8gZmlyZSBhbmRcbiAgICAgIC8vIGZvcmdlIHRoZW0uXG4gICAgICAvL1xuICAgICAgLy8gSWYgeW91J3JlIGRpc3Bvc2luZyBvZiBhIG1haWxib3ggYmVmb3JlIHJlcXVlc3RzXG4gICAgICAvLyBjb21wbGV0ZSwgeW91IG1pZ2h0IGhhdmUgYSBiYWQgdGltZS4gVGhlIGdvb2RcbiAgICAgIC8vIG5ld3MgaXMgYmVjYXVzZSByZXNwb25zZXMgYXJlIGZlcnJpZWQgYmFjayBmcm9tIHRoZSBmaWJlclxuICAgICAgLy8gdG8gdGhlIG1haWxib3ggY2FsbGVyIHZpYSB0aGUgUHJvbWlzZSBpbnRlcmZhY2UgcmF0aGVyXG4gICAgICAvLyB0aGFuIGNoYW5uZWxzLCB0aGV5IHNob3VsZCBzdGlsbCBnZXQgQ2FuY2VsbGF0aW9uRXJyb3JzXG4gICAgICB2YXIgcmVxcyA9IHRoaXMuX291dHN0YW5kaW5nUmVxdWVzdElkcztcbiAgICAgIHRoaXMuX291dHN0YW5kaW5nUmVxdWVzdElkcyA9IE0uc2V0KCk7XG5cbiAgICAgIE0uZWFjaChyZXFzLCBfLmJpbmQoZnVuY3Rpb24ocmVxSWQpIHtcbiAgICAgICAgdGhpcy5fZXhjaGFuZ2UuY2FuY2VsU2VuZEFuZFJlY2VpdmUocmVxSWQpO1xuICAgICAgfSwgdGhpcykpO1xuXG4gICAgICB0aGlzLl9vbmVTaG90Q2hhbm5lbCAgICAgID0gbnVsbDtcbiAgICAgIHRoaXMuX3JlcXVlc3RSZXBseUNoYW5uZWwgPSBudWxsO1xuICAgICAgdGhpcy5faW5ncmVzc0NoYW5uZWwgICAgICA9IG51bGw7XG5cbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQuYXBwbHkoXCJkaXNwb3NlZFwiKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIG5ldyBDaGFpbmVkQ2hhbm5lbCBjaGFpbmVkIHRvIHRoaXMgTWFpbGJveCdzXG4gICAgICogcHJpdmF0ZWx5LW93bmVkIGluYm91bmQgQ2hhbm5lbC5cbiAgICAgKiBAcmV0dXJucyB7Q2hhaW5lZENoYW5uZWx9XG4gICAgICovXG4gICAgaW5ncmVzc0NoYW5uZWw6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2luZ3Jlc3NDaGFubmVsO1xuICAgIH0sXG5cbiAgICBvbmVTaG90Q2hhbm5lbDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fb25lU2hvdENoYW5uZWw7XG4gICAgfSxcblxuICAgIHJlcXVlc3RSZXBseUNoYW5uZWw6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3JlcXVlc3RSZXBseUNoYW5uZWw7XG4gICAgfSxcblxuICAgIHNlbmQ6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKGVudikge1xuICAgICAgdGhpcy5fc3RhdGVHdWFyZC5kZW55KFwiZGlzcG9zZWRcIik7XG5cbiAgICAgIGVudiA9IF8uZXh0ZW5kKHt9LCBlbnYgfHwge30sIHtcbiAgICAgICAgZnJvbTogdGhpcy5fb3duZXJJZGVudGl0eVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gdGhpcy5fZXhjaGFuZ2Uuc2VuZChlbnYpO1xuICAgIH0pLFxuXG4gICAgcmVwbHk6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKG1zZ0lkLCBlbnYpIHtcbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQuZGVueShcImRpc3Bvc2VkXCIpO1xuXG4gICAgICBlbnYgPSBfLmV4dGVuZCh7fSwgZW52IHx8IHt9LCB7XG4gICAgICAgIHJNc2dJZDogbXNnSWQsXG4gICAgICAgIGZyb206IHRoaXMuX293bmVySWRlbnRpdHlcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gdGhpcy5fZXhjaGFuZ2UucmVwbHkoZW52KTtcbiAgICB9KSxcblxuICAgIHNlbmRBbmRSZWNlaXZlOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbihlbnYsIG9wdHMpIHtcbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQuZGVueShcImRpc3Bvc2VkXCIpO1xuXG4gICAgICB2YXIgcmVxSWQgPSAob3B0cyB8fCB7fSkucmVxSWQgfHwgVVVJRC52NCgpO1xuXG4gICAgICBlbnYgPSBfLmV4dGVuZCh7fSwgZW52IHx8IHt9LCB7XG4gICAgICAgIGZyb206IHRoaXMuX293bmVySWRlbnRpdHlcbiAgICAgIH0pO1xuXG4gICAgICBvcHRzID0gXy5leHRlbmQoe30sIG9wdHMgfHwge30sIHtcbiAgICAgICAgcmVxSWQ6IHJlcUlkXG4gICAgICB9KTtcblxuICAgICAgdGhpcy5fb3V0c3RhbmRpbmdSZXF1ZXN0SWRzID0gTS5jb25qKHRoaXMuX291dHN0YW5kaW5nUmVxdWVzdElkcywgcmVxSWQpO1xuXG4gICAgICByZXR1cm4gdGhpcy5fZXhjaGFuZ2VcbiAgICAgICAgLnNlbmRBbmRSZWNlaXZlKGVudiwgb3B0cylcbiAgICAgICAgLmJpbmQodGhpcylcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzcCkge1xuICAgICAgICAgIHRoaXMuX291dHN0YW5kaW5nUmVxdWVzdElkcyA9IE0uZGlzaih0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RJZHMsIHJlcUlkKTtcbiAgICAgICAgICByZXR1cm4gcmVzcDtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdWdodChQcm9taXNlLkNhbmNlbGxhdGlvbkVycm9yLCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICB0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RJZHMgPSBNLmRpc2oodGhpcy5fb3V0c3RhbmRpbmdSZXF1ZXN0SWRzLCByZXFJZCk7XG4gICAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgICB9KVxuICAgICAgICAuY2F1Z2h0KFByb21pc2UuVGltZW91dEVycm9yLCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICB0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RJZHMgPSBNLmRpc2oodGhpcy5fb3V0c3RhbmRpbmdSZXF1ZXN0SWRzLCByZXFJZCk7XG4gICAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgICB9KTtcbiAgICB9KSxcblxuXG4gICAgb3V0c3RhbmRpbmdSZXF1ZXN0Q291bnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIE0uY291bnQodGhpcy5fb3V0c3RhbmRpbmdSZXF1ZXN0SWRzKTtcbiAgICB9LFxuXG5cbiAgICBjYW5jZWxTZW5kQW5kUmVjZWl2ZTogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24ocmVxSWQpIHtcbiAgICAgIHJldHVybiB0aGlzLl9leGNoYW5nZVxuICAgICAgICAuY2FuY2VsU2VuZEFuZFJlY2VpdmUocmVxSWQpXG4gICAgICAgIC5iaW5kKHRoaXMpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHRoaXMuX291dHN0YW5kaW5nUmVxdWVzdElkcyA9IE0uZGlzaih0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RJZHMsIHJlcUlkKTtcbiAgICAgICAgfSk7XG4gICAgfSksXG5cbiAgICBfcmVjZWl2ZU9uZVNob3Q6IGZ1bmN0aW9uKG1zZykge1xuICAgICAgdGhpcy5fb25lU2hvdENoYW5uZWwucHVibGlzaCh0aGlzLCBtc2cpO1xuICAgIH0sXG5cbiAgICBfcmVjZWl2ZVJlcXVlc3RSZXBseTogZnVuY3Rpb24obXNnKSB7XG4gICAgICB0aGlzLl9yZXF1ZXN0UmVwbHlDaGFubmVsLnB1Ymxpc2godGhpcywgbXNnKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBNYWlsYm94O1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiYmx1ZWJpcmRcIiksXG4gIHJlcXVpcmUoXCJtb3JpXCIpLFxuICByZXF1aXJlKFwiLi4vLi4vY29yZS9vcHRpb25zXCIpLFxuICByZXF1aXJlKFwiLi4vLi4vY29yZS91dWlkXCIpLFxuICByZXF1aXJlKFwiLi4vLi4vY29yZS9jaGFubmVsL2NoYWluZWQtY2hhbm5lbFwiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvY2hhbm5lbC9jaGFubmVsXCIpLFxuICByZXF1aXJlKFwiLi4vLi4vY29yZS9jaGFubmVsL2NvbXBvc2l0ZS1jaGFubmVsXCIpLFxuICByZXF1aXJlKFwiLi4vLi4vY29yZS9zdGF0ZS1ndWFyZFwiKVxuKTtcblxufSkoKSIsIi8vIHNoaW0gZm9yIHVzaW5nIHByb2Nlc3MgaW4gYnJvd3NlclxuXG52YXIgcHJvY2VzcyA9IG1vZHVsZS5leHBvcnRzID0ge307XG5cbnByb2Nlc3MubmV4dFRpY2sgPSAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBjYW5TZXRJbW1lZGlhdGUgPSB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJ1xuICAgICYmIHdpbmRvdy5zZXRJbW1lZGlhdGU7XG4gICAgdmFyIGNhblBvc3QgPSB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJ1xuICAgICYmIHdpbmRvdy5wb3N0TWVzc2FnZSAmJiB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lclxuICAgIDtcblxuICAgIGlmIChjYW5TZXRJbW1lZGlhdGUpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiB3aW5kb3cuc2V0SW1tZWRpYXRlKGYpIH07XG4gICAgfVxuXG4gICAgaWYgKGNhblBvc3QpIHtcbiAgICAgICAgdmFyIHF1ZXVlID0gW107XG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgZnVuY3Rpb24gKGV2KSB7XG4gICAgICAgICAgICB2YXIgc291cmNlID0gZXYuc291cmNlO1xuICAgICAgICAgICAgaWYgKChzb3VyY2UgPT09IHdpbmRvdyB8fCBzb3VyY2UgPT09IG51bGwpICYmIGV2LmRhdGEgPT09ICdwcm9jZXNzLXRpY2snKSB7XG4gICAgICAgICAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgaWYgKHF1ZXVlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZuID0gcXVldWUuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgZm4oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHRydWUpO1xuXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBuZXh0VGljayhmbikge1xuICAgICAgICAgICAgcXVldWUucHVzaChmbik7XG4gICAgICAgICAgICB3aW5kb3cucG9zdE1lc3NhZ2UoJ3Byb2Nlc3MtdGljaycsICcqJyk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIGZ1bmN0aW9uIG5leHRUaWNrKGZuKSB7XG4gICAgICAgIHNldFRpbWVvdXQoZm4sIDApO1xuICAgIH07XG59KSgpO1xuXG5wcm9jZXNzLnRpdGxlID0gJ2Jyb3dzZXInO1xucHJvY2Vzcy5icm93c2VyID0gdHJ1ZTtcbnByb2Nlc3MuZW52ID0ge307XG5wcm9jZXNzLmFyZ3YgPSBbXTtcblxucHJvY2Vzcy5iaW5kaW5nID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuYmluZGluZyBpcyBub3Qgc3VwcG9ydGVkJyk7XG59XG5cbi8vIFRPRE8oc2h0eWxtYW4pXG5wcm9jZXNzLmN3ZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICcvJyB9O1xucHJvY2Vzcy5jaGRpciA9IGZ1bmN0aW9uIChkaXIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuY2hkaXIgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcbiIsIihmdW5jdGlvbihwcm9jZXNzKXsvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xudmFyIG9sZDtcbmlmICh0eXBlb2YgUHJvbWlzZSAhPT0gXCJ1bmRlZmluZWRcIikgb2xkID0gUHJvbWlzZTtcbmZ1bmN0aW9uIG5vQ29uZmxpY3QoYmx1ZWJpcmQpIHtcbiAgICB0cnkgeyBpZiAoUHJvbWlzZSA9PT0gYmx1ZWJpcmQpIFByb21pc2UgPSBvbGQ7IH1cbiAgICBjYXRjaCAoZSkge31cbiAgICByZXR1cm4gYmx1ZWJpcmQ7XG59XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCkge1xudmFyIHV0aWwgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpO1xudmFyIGFzeW5jID0gcmVxdWlyZShcIi4vYXN5bmMuanNcIik7XG52YXIgZXJyb3JzID0gcmVxdWlyZShcIi4vZXJyb3JzLmpzXCIpO1xuXG52YXIgSU5URVJOQUwgPSBmdW5jdGlvbigpe307XG52YXIgQVBQTFkgPSB7fTtcbnZhciBORVhUX0ZJTFRFUiA9IHtlOiBudWxsfTtcblxudmFyIGNhc3QgPSByZXF1aXJlKFwiLi90aGVuYWJsZXMuanNcIikoUHJvbWlzZSwgSU5URVJOQUwpO1xudmFyIFByb21pc2VBcnJheSA9IHJlcXVpcmUoXCIuL3Byb21pc2VfYXJyYXkuanNcIikoUHJvbWlzZSwgSU5URVJOQUwsIGNhc3QpO1xudmFyIENhcHR1cmVkVHJhY2UgPSByZXF1aXJlKFwiLi9jYXB0dXJlZF90cmFjZS5qc1wiKSgpO1xudmFyIENhdGNoRmlsdGVyID0gcmVxdWlyZShcIi4vY2F0Y2hfZmlsdGVyLmpzXCIpKE5FWFRfRklMVEVSKTtcbnZhciBQcm9taXNlUmVzb2x2ZXIgPSByZXF1aXJlKFwiLi9wcm9taXNlX3Jlc29sdmVyLmpzXCIpO1xuXG52YXIgaXNBcnJheSA9IHV0aWwuaXNBcnJheTtcblxudmFyIGVycm9yT2JqID0gdXRpbC5lcnJvck9iajtcbnZhciB0cnlDYXRjaDEgPSB1dGlsLnRyeUNhdGNoMTtcbnZhciB0cnlDYXRjaDIgPSB1dGlsLnRyeUNhdGNoMjtcbnZhciB0cnlDYXRjaEFwcGx5ID0gdXRpbC50cnlDYXRjaEFwcGx5O1xudmFyIFJhbmdlRXJyb3IgPSBlcnJvcnMuUmFuZ2VFcnJvcjtcbnZhciBUeXBlRXJyb3IgPSBlcnJvcnMuVHlwZUVycm9yO1xudmFyIENhbmNlbGxhdGlvbkVycm9yID0gZXJyb3JzLkNhbmNlbGxhdGlvbkVycm9yO1xudmFyIFRpbWVvdXRFcnJvciA9IGVycm9ycy5UaW1lb3V0RXJyb3I7XG52YXIgT3BlcmF0aW9uYWxFcnJvciA9IGVycm9ycy5PcGVyYXRpb25hbEVycm9yO1xudmFyIG9yaWdpbmF0ZXNGcm9tUmVqZWN0aW9uID0gZXJyb3JzLm9yaWdpbmF0ZXNGcm9tUmVqZWN0aW9uO1xudmFyIG1hcmtBc09yaWdpbmF0aW5nRnJvbVJlamVjdGlvbiA9IGVycm9ycy5tYXJrQXNPcmlnaW5hdGluZ0Zyb21SZWplY3Rpb247XG52YXIgY2FuQXR0YWNoID0gZXJyb3JzLmNhbkF0dGFjaDtcbnZhciB0aHJvd2VyID0gdXRpbC50aHJvd2VyO1xudmFyIGFwaVJlamVjdGlvbiA9IHJlcXVpcmUoXCIuL2Vycm9yc19hcGlfcmVqZWN0aW9uXCIpKFByb21pc2UpO1xuXG5cbnZhciBtYWtlU2VsZlJlc29sdXRpb25FcnJvciA9IGZ1bmN0aW9uIFByb21pc2UkX21ha2VTZWxmUmVzb2x1dGlvbkVycm9yKCkge1xuICAgIHJldHVybiBuZXcgVHlwZUVycm9yKFwiY2lyY3VsYXIgcHJvbWlzZSByZXNvbHV0aW9uIGNoYWluXCIpO1xufTtcblxuZnVuY3Rpb24gUHJvbWlzZShyZXNvbHZlcikge1xuICAgIGlmICh0eXBlb2YgcmVzb2x2ZXIgIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwidGhlIHByb21pc2UgY29uc3RydWN0b3IgcmVxdWlyZXMgYSByZXNvbHZlciBmdW5jdGlvblwiKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuY29uc3RydWN0b3IgIT09IFByb21pc2UpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcInRoZSBwcm9taXNlIGNvbnN0cnVjdG9yIGNhbm5vdCBiZSBpbnZva2VkIGRpcmVjdGx5XCIpO1xuICAgIH1cbiAgICB0aGlzLl9iaXRGaWVsZCA9IDA7XG4gICAgdGhpcy5fZnVsZmlsbG1lbnRIYW5kbGVyMCA9IHZvaWQgMDtcbiAgICB0aGlzLl9yZWplY3Rpb25IYW5kbGVyMCA9IHZvaWQgMDtcbiAgICB0aGlzLl9wcm9taXNlMCA9IHZvaWQgMDtcbiAgICB0aGlzLl9yZWNlaXZlcjAgPSB2b2lkIDA7XG4gICAgdGhpcy5fc2V0dGxlZFZhbHVlID0gdm9pZCAwO1xuICAgIHRoaXMuX2JvdW5kVG8gPSB2b2lkIDA7XG4gICAgaWYgKHJlc29sdmVyICE9PSBJTlRFUk5BTCkgdGhpcy5fcmVzb2x2ZUZyb21SZXNvbHZlcihyZXNvbHZlcik7XG59XG5cblByb21pc2UucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiBQcm9taXNlJGJpbmQodGhpc0FyZykge1xuICAgIHZhciByZXQgPSBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG4gICAgcmV0Ll9mb2xsb3codGhpcyk7XG4gICAgcmV0Ll9wcm9wYWdhdGVGcm9tKHRoaXMsIDIgfCAxKTtcbiAgICByZXQuX3NldEJvdW5kVG8odGhpc0FyZyk7XG4gICAgcmV0dXJuIHJldDtcbn07XG5cblByb21pc2UucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gUHJvbWlzZSR0b1N0cmluZygpIHtcbiAgICByZXR1cm4gXCJbb2JqZWN0IFByb21pc2VdXCI7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5jYXVnaHQgPSBQcm9taXNlLnByb3RvdHlwZVtcImNhdGNoXCJdID1cbmZ1bmN0aW9uIFByb21pc2UkY2F0Y2goZm4pIHtcbiAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aDtcbiAgICBpZiAobGVuID4gMSkge1xuICAgICAgICB2YXIgY2F0Y2hJbnN0YW5jZXMgPSBuZXcgQXJyYXkobGVuIC0gMSksXG4gICAgICAgICAgICBqID0gMCwgaTtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGxlbiAtIDE7ICsraSkge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBhcmd1bWVudHNbaV07XG4gICAgICAgICAgICBpZiAodHlwZW9mIGl0ZW0gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgIGNhdGNoSW5zdGFuY2VzW2orK10gPSBpdGVtO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgY2F0Y2hGaWx0ZXJUeXBlRXJyb3IgPVxuICAgICAgICAgICAgICAgICAgICBuZXcgVHlwZUVycm9yKFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJBIGNhdGNoIGZpbHRlciBtdXN0IGJlIGFuIGVycm9yIGNvbnN0cnVjdG9yIFwiXG4gICAgICAgICAgICAgICAgICAgICAgICArIFwib3IgYSBmaWx0ZXIgZnVuY3Rpb25cIik7XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9hdHRhY2hFeHRyYVRyYWNlKGNhdGNoRmlsdGVyVHlwZUVycm9yKTtcbiAgICAgICAgICAgICAgICBhc3luYy5pbnZva2UodGhpcy5fcmVqZWN0LCB0aGlzLCBjYXRjaEZpbHRlclR5cGVFcnJvcik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoSW5zdGFuY2VzLmxlbmd0aCA9IGo7XG4gICAgICAgIGZuID0gYXJndW1lbnRzW2ldO1xuXG4gICAgICAgIHRoaXMuX3Jlc2V0VHJhY2UoKTtcbiAgICAgICAgdmFyIGNhdGNoRmlsdGVyID0gbmV3IENhdGNoRmlsdGVyKGNhdGNoSW5zdGFuY2VzLCBmbiwgdGhpcyk7XG4gICAgICAgIHJldHVybiB0aGlzLl90aGVuKHZvaWQgMCwgY2F0Y2hGaWx0ZXIuZG9GaWx0ZXIsIHZvaWQgMCxcbiAgICAgICAgICAgIGNhdGNoRmlsdGVyLCB2b2lkIDApO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5fdGhlbih2b2lkIDAsIGZuLCB2b2lkIDAsIHZvaWQgMCwgdm9pZCAwKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLnRoZW4gPVxuZnVuY3Rpb24gUHJvbWlzZSR0aGVuKGRpZEZ1bGZpbGwsIGRpZFJlamVjdCwgZGlkUHJvZ3Jlc3MpIHtcbiAgICByZXR1cm4gdGhpcy5fdGhlbihkaWRGdWxmaWxsLCBkaWRSZWplY3QsIGRpZFByb2dyZXNzLFxuICAgICAgICB2b2lkIDAsIHZvaWQgMCk7XG59O1xuXG5cblByb21pc2UucHJvdG90eXBlLmRvbmUgPVxuZnVuY3Rpb24gUHJvbWlzZSRkb25lKGRpZEZ1bGZpbGwsIGRpZFJlamVjdCwgZGlkUHJvZ3Jlc3MpIHtcbiAgICB2YXIgcHJvbWlzZSA9IHRoaXMuX3RoZW4oZGlkRnVsZmlsbCwgZGlkUmVqZWN0LCBkaWRQcm9ncmVzcyxcbiAgICAgICAgdm9pZCAwLCB2b2lkIDApO1xuICAgIHByb21pc2UuX3NldElzRmluYWwoKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLnNwcmVhZCA9IGZ1bmN0aW9uIFByb21pc2Ukc3ByZWFkKGRpZEZ1bGZpbGwsIGRpZFJlamVjdCkge1xuICAgIHJldHVybiB0aGlzLl90aGVuKGRpZEZ1bGZpbGwsIGRpZFJlamVjdCwgdm9pZCAwLFxuICAgICAgICBBUFBMWSwgdm9pZCAwKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLmlzQ2FuY2VsbGFibGUgPSBmdW5jdGlvbiBQcm9taXNlJGlzQ2FuY2VsbGFibGUoKSB7XG4gICAgcmV0dXJuICF0aGlzLmlzUmVzb2x2ZWQoKSAmJlxuICAgICAgICB0aGlzLl9jYW5jZWxsYWJsZSgpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gUHJvbWlzZSR0b0pTT04oKSB7XG4gICAgdmFyIHJldCA9IHtcbiAgICAgICAgaXNGdWxmaWxsZWQ6IGZhbHNlLFxuICAgICAgICBpc1JlamVjdGVkOiBmYWxzZSxcbiAgICAgICAgZnVsZmlsbG1lbnRWYWx1ZTogdm9pZCAwLFxuICAgICAgICByZWplY3Rpb25SZWFzb246IHZvaWQgMFxuICAgIH07XG4gICAgaWYgKHRoaXMuaXNGdWxmaWxsZWQoKSkge1xuICAgICAgICByZXQuZnVsZmlsbG1lbnRWYWx1ZSA9IHRoaXMuX3NldHRsZWRWYWx1ZTtcbiAgICAgICAgcmV0LmlzRnVsZmlsbGVkID0gdHJ1ZTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuaXNSZWplY3RlZCgpKSB7XG4gICAgICAgIHJldC5yZWplY3Rpb25SZWFzb24gPSB0aGlzLl9zZXR0bGVkVmFsdWU7XG4gICAgICAgIHJldC5pc1JlamVjdGVkID0gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIHJldDtcbn07XG5cblByb21pc2UucHJvdG90eXBlLmFsbCA9IGZ1bmN0aW9uIFByb21pc2UkYWxsKCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZUFycmF5KHRoaXMpLnByb21pc2UoKTtcbn07XG5cblxuUHJvbWlzZS5pcyA9IGZ1bmN0aW9uIFByb21pc2UkSXModmFsKSB7XG4gICAgcmV0dXJuIHZhbCBpbnN0YW5jZW9mIFByb21pc2U7XG59O1xuXG5Qcm9taXNlLmFsbCA9IGZ1bmN0aW9uIFByb21pc2UkQWxsKHByb21pc2VzKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlQXJyYXkocHJvbWlzZXMpLnByb21pc2UoKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gUHJvbWlzZSRfZXJyb3IoZm4pIHtcbiAgICByZXR1cm4gdGhpcy5jYXVnaHQob3JpZ2luYXRlc0Zyb21SZWplY3Rpb24sIGZuKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9yZXNvbHZlRnJvbVN5bmNWYWx1ZSA9XG5mdW5jdGlvbiBQcm9taXNlJF9yZXNvbHZlRnJvbVN5bmNWYWx1ZSh2YWx1ZSkge1xuICAgIGlmICh2YWx1ZSA9PT0gZXJyb3JPYmopIHtcbiAgICAgICAgdGhpcy5fY2xlYW5WYWx1ZXMoKTtcbiAgICAgICAgdGhpcy5fc2V0UmVqZWN0ZWQoKTtcbiAgICAgICAgdGhpcy5fc2V0dGxlZFZhbHVlID0gdmFsdWUuZTtcbiAgICAgICAgdGhpcy5fZW5zdXJlUG9zc2libGVSZWplY3Rpb25IYW5kbGVkKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIG1heWJlUHJvbWlzZSA9IGNhc3QodmFsdWUsIHZvaWQgMCk7XG4gICAgICAgIGlmIChtYXliZVByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgICAgICB0aGlzLl9mb2xsb3cobWF5YmVQcm9taXNlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2NsZWFuVmFsdWVzKCk7XG4gICAgICAgICAgICB0aGlzLl9zZXRGdWxmaWxsZWQoKTtcbiAgICAgICAgICAgIHRoaXMuX3NldHRsZWRWYWx1ZSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxufTtcblxuUHJvbWlzZS5tZXRob2QgPSBmdW5jdGlvbiBQcm9taXNlJF9NZXRob2QoZm4pIHtcbiAgICBpZiAodHlwZW9mIGZuICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcImZuIG11c3QgYmUgYSBmdW5jdGlvblwiKTtcbiAgICB9XG4gICAgcmV0dXJuIGZ1bmN0aW9uIFByb21pc2UkX21ldGhvZCgpIHtcbiAgICAgICAgdmFyIHZhbHVlO1xuICAgICAgICBzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCkge1xuICAgICAgICBjYXNlIDA6IHZhbHVlID0gdHJ5Q2F0Y2gxKGZuLCB0aGlzLCB2b2lkIDApOyBicmVhaztcbiAgICAgICAgY2FzZSAxOiB2YWx1ZSA9IHRyeUNhdGNoMShmbiwgdGhpcywgYXJndW1lbnRzWzBdKTsgYnJlYWs7XG4gICAgICAgIGNhc2UgMjogdmFsdWUgPSB0cnlDYXRjaDIoZm4sIHRoaXMsIGFyZ3VtZW50c1swXSwgYXJndW1lbnRzWzFdKTsgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICB2YXIgJF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoO3ZhciBhcmdzID0gbmV3IEFycmF5KCRfbGVuKTsgZm9yKHZhciAkX2kgPSAwOyAkX2kgPCAkX2xlbjsgKyskX2kpIHthcmdzWyRfaV0gPSBhcmd1bWVudHNbJF9pXTt9XG4gICAgICAgICAgICB2YWx1ZSA9IHRyeUNhdGNoQXBwbHkoZm4sIGFyZ3MsIHRoaXMpOyBicmVhaztcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmV0ID0gbmV3IFByb21pc2UoSU5URVJOQUwpO1xuICAgICAgICByZXQuX3NldFRyYWNlKHZvaWQgMCk7XG4gICAgICAgIHJldC5fcmVzb2x2ZUZyb21TeW5jVmFsdWUodmFsdWUpO1xuICAgICAgICByZXR1cm4gcmV0O1xuICAgIH07XG59O1xuXG5Qcm9taXNlLmF0dGVtcHQgPSBQcm9taXNlW1widHJ5XCJdID0gZnVuY3Rpb24gUHJvbWlzZSRfVHJ5KGZuLCBhcmdzLCBjdHgpIHtcbiAgICBpZiAodHlwZW9mIGZuICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgcmV0dXJuIGFwaVJlamVjdGlvbihcImZuIG11c3QgYmUgYSBmdW5jdGlvblwiKTtcbiAgICB9XG4gICAgdmFyIHZhbHVlID0gaXNBcnJheShhcmdzKVxuICAgICAgICA/IHRyeUNhdGNoQXBwbHkoZm4sIGFyZ3MsIGN0eClcbiAgICAgICAgOiB0cnlDYXRjaDEoZm4sIGN0eCwgYXJncyk7XG5cbiAgICB2YXIgcmV0ID0gbmV3IFByb21pc2UoSU5URVJOQUwpO1xuICAgIHJldC5fc2V0VHJhY2Uodm9pZCAwKTtcbiAgICByZXQuX3Jlc29sdmVGcm9tU3luY1ZhbHVlKHZhbHVlKTtcbiAgICByZXR1cm4gcmV0O1xufTtcblxuUHJvbWlzZS5kZWZlciA9IFByb21pc2UucGVuZGluZyA9IGZ1bmN0aW9uIFByb21pc2UkRGVmZXIoKSB7XG4gICAgdmFyIHByb21pc2UgPSBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG4gICAgcHJvbWlzZS5fc2V0VHJhY2Uodm9pZCAwKTtcbiAgICByZXR1cm4gbmV3IFByb21pc2VSZXNvbHZlcihwcm9taXNlKTtcbn07XG5cblByb21pc2UuYmluZCA9IGZ1bmN0aW9uIFByb21pc2UkQmluZCh0aGlzQXJnKSB7XG4gICAgdmFyIHJldCA9IG5ldyBQcm9taXNlKElOVEVSTkFMKTtcbiAgICByZXQuX3NldFRyYWNlKHZvaWQgMCk7XG4gICAgcmV0Ll9zZXRGdWxmaWxsZWQoKTtcbiAgICByZXQuX3NldEJvdW5kVG8odGhpc0FyZyk7XG4gICAgcmV0dXJuIHJldDtcbn07XG5cblByb21pc2UuY2FzdCA9IGZ1bmN0aW9uIFByb21pc2UkX0Nhc3Qob2JqKSB7XG4gICAgdmFyIHJldCA9IGNhc3Qob2JqLCB2b2lkIDApO1xuICAgIGlmICghKHJldCBpbnN0YW5jZW9mIFByb21pc2UpKSB7XG4gICAgICAgIHZhciB2YWwgPSByZXQ7XG4gICAgICAgIHJldCA9IG5ldyBQcm9taXNlKElOVEVSTkFMKTtcbiAgICAgICAgcmV0Ll9zZXRUcmFjZSh2b2lkIDApO1xuICAgICAgICByZXQuX3NldEZ1bGZpbGxlZCgpO1xuICAgICAgICByZXQuX2NsZWFuVmFsdWVzKCk7XG4gICAgICAgIHJldC5fc2V0dGxlZFZhbHVlID0gdmFsO1xuICAgIH1cbiAgICByZXR1cm4gcmV0O1xufTtcblxuUHJvbWlzZS5yZXNvbHZlID0gUHJvbWlzZS5mdWxmaWxsZWQgPSBQcm9taXNlLmNhc3Q7XG5cblByb21pc2UucmVqZWN0ID0gUHJvbWlzZS5yZWplY3RlZCA9IGZ1bmN0aW9uIFByb21pc2UkUmVqZWN0KHJlYXNvbikge1xuICAgIHZhciByZXQgPSBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG4gICAgcmV0Ll9zZXRUcmFjZSh2b2lkIDApO1xuICAgIG1hcmtBc09yaWdpbmF0aW5nRnJvbVJlamVjdGlvbihyZWFzb24pO1xuICAgIHJldC5fY2xlYW5WYWx1ZXMoKTtcbiAgICByZXQuX3NldFJlamVjdGVkKCk7XG4gICAgcmV0Ll9zZXR0bGVkVmFsdWUgPSByZWFzb247XG4gICAgaWYgKCFjYW5BdHRhY2gocmVhc29uKSkge1xuICAgICAgICB2YXIgdHJhY2UgPSBuZXcgRXJyb3IocmVhc29uICsgXCJcIik7XG4gICAgICAgIHJldC5fc2V0Q2FycmllZFN0YWNrVHJhY2UodHJhY2UpO1xuICAgIH1cbiAgICByZXQuX2Vuc3VyZVBvc3NpYmxlUmVqZWN0aW9uSGFuZGxlZCgpO1xuICAgIHJldHVybiByZXQ7XG59O1xuXG5Qcm9taXNlLm9uUG9zc2libHlVbmhhbmRsZWRSZWplY3Rpb24gPVxuZnVuY3Rpb24gUHJvbWlzZSRPblBvc3NpYmx5VW5oYW5kbGVkUmVqZWN0aW9uKGZuKSB7XG4gICAgICAgIENhcHR1cmVkVHJhY2UucG9zc2libHlVbmhhbmRsZWRSZWplY3Rpb24gPSB0eXBlb2YgZm4gPT09IFwiZnVuY3Rpb25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gZm4gOiB2b2lkIDA7XG59O1xuXG52YXIgdW5oYW5kbGVkUmVqZWN0aW9uSGFuZGxlZDtcblByb21pc2Uub25VbmhhbmRsZWRSZWplY3Rpb25IYW5kbGVkID1cbmZ1bmN0aW9uIFByb21pc2Ukb25VbmhhbmRsZWRSZWplY3Rpb25IYW5kbGVkKGZuKSB7XG4gICAgdW5oYW5kbGVkUmVqZWN0aW9uSGFuZGxlZCA9IHR5cGVvZiBmbiA9PT0gXCJmdW5jdGlvblwiID8gZm4gOiB2b2lkIDA7XG59O1xuXG52YXIgZGVidWdnaW5nID0gZmFsc2UgfHwgISEoXG4gICAgdHlwZW9mIHByb2Nlc3MgIT09IFwidW5kZWZpbmVkXCIgJiZcbiAgICB0eXBlb2YgcHJvY2Vzcy5leGVjUGF0aCA9PT0gXCJzdHJpbmdcIiAmJlxuICAgIHR5cGVvZiBwcm9jZXNzLmVudiA9PT0gXCJvYmplY3RcIiAmJlxuICAgIChwcm9jZXNzLmVudltcIkJMVUVCSVJEX0RFQlVHXCJdIHx8XG4gICAgICAgIHByb2Nlc3MuZW52W1wiTk9ERV9FTlZcIl0gPT09IFwiZGV2ZWxvcG1lbnRcIilcbik7XG5cblxuUHJvbWlzZS5sb25nU3RhY2tUcmFjZXMgPSBmdW5jdGlvbiBQcm9taXNlJExvbmdTdGFja1RyYWNlcygpIHtcbiAgICBpZiAoYXN5bmMuaGF2ZUl0ZW1zUXVldWVkKCkgJiZcbiAgICAgICAgZGVidWdnaW5nID09PSBmYWxzZVxuICAgKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcImNhbm5vdCBlbmFibGUgbG9uZyBzdGFjayB0cmFjZXMgYWZ0ZXIgcHJvbWlzZXMgaGF2ZSBiZWVuIGNyZWF0ZWRcIik7XG4gICAgfVxuICAgIGRlYnVnZ2luZyA9IENhcHR1cmVkVHJhY2UuaXNTdXBwb3J0ZWQoKTtcbn07XG5cblByb21pc2UuaGFzTG9uZ1N0YWNrVHJhY2VzID0gZnVuY3Rpb24gUHJvbWlzZSRIYXNMb25nU3RhY2tUcmFjZXMoKSB7XG4gICAgcmV0dXJuIGRlYnVnZ2luZyAmJiBDYXB0dXJlZFRyYWNlLmlzU3VwcG9ydGVkKCk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fdGhlbiA9XG5mdW5jdGlvbiBQcm9taXNlJF90aGVuKFxuICAgIGRpZEZ1bGZpbGwsXG4gICAgZGlkUmVqZWN0LFxuICAgIGRpZFByb2dyZXNzLFxuICAgIHJlY2VpdmVyLFxuICAgIGludGVybmFsRGF0YVxuKSB7XG4gICAgdmFyIGhhdmVJbnRlcm5hbERhdGEgPSBpbnRlcm5hbERhdGEgIT09IHZvaWQgMDtcbiAgICB2YXIgcmV0ID0gaGF2ZUludGVybmFsRGF0YSA/IGludGVybmFsRGF0YSA6IG5ldyBQcm9taXNlKElOVEVSTkFMKTtcblxuICAgIGlmICghaGF2ZUludGVybmFsRGF0YSkge1xuICAgICAgICBpZiAoZGVidWdnaW5nKSB7XG4gICAgICAgICAgICB2YXIgaGF2ZVNhbWVDb250ZXh0ID0gdGhpcy5fcGVla0NvbnRleHQoKSA9PT0gdGhpcy5fdHJhY2VQYXJlbnQ7XG4gICAgICAgICAgICByZXQuX3RyYWNlUGFyZW50ID0gaGF2ZVNhbWVDb250ZXh0ID8gdGhpcy5fdHJhY2VQYXJlbnQgOiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIHJldC5fcHJvcGFnYXRlRnJvbSh0aGlzLCA3KTtcbiAgICB9XG5cbiAgICB2YXIgY2FsbGJhY2tJbmRleCA9XG4gICAgICAgIHRoaXMuX2FkZENhbGxiYWNrcyhkaWRGdWxmaWxsLCBkaWRSZWplY3QsIGRpZFByb2dyZXNzLCByZXQsIHJlY2VpdmVyKTtcblxuICAgIGlmICh0aGlzLmlzUmVzb2x2ZWQoKSkge1xuICAgICAgICBhc3luYy5pbnZva2UodGhpcy5fcXVldWVTZXR0bGVBdCwgdGhpcywgY2FsbGJhY2tJbmRleCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJldDtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9sZW5ndGggPSBmdW5jdGlvbiBQcm9taXNlJF9sZW5ndGgoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2JpdEZpZWxkICYgMjYyMTQzO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2lzRm9sbG93aW5nT3JGdWxmaWxsZWRPclJlamVjdGVkID1cbmZ1bmN0aW9uIFByb21pc2UkX2lzRm9sbG93aW5nT3JGdWxmaWxsZWRPclJlamVjdGVkKCkge1xuICAgIHJldHVybiAodGhpcy5fYml0RmllbGQgJiA5Mzk1MjQwOTYpID4gMDtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9pc0ZvbGxvd2luZyA9IGZ1bmN0aW9uIFByb21pc2UkX2lzRm9sbG93aW5nKCkge1xuICAgIHJldHVybiAodGhpcy5fYml0RmllbGQgJiA1MzY4NzA5MTIpID09PSA1MzY4NzA5MTI7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fc2V0TGVuZ3RoID0gZnVuY3Rpb24gUHJvbWlzZSRfc2V0TGVuZ3RoKGxlbikge1xuICAgIHRoaXMuX2JpdEZpZWxkID0gKHRoaXMuX2JpdEZpZWxkICYgLTI2MjE0NCkgfFxuICAgICAgICAobGVuICYgMjYyMTQzKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9zZXRGdWxmaWxsZWQgPSBmdW5jdGlvbiBQcm9taXNlJF9zZXRGdWxmaWxsZWQoKSB7XG4gICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCB8IDI2ODQzNTQ1Njtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9zZXRSZWplY3RlZCA9IGZ1bmN0aW9uIFByb21pc2UkX3NldFJlamVjdGVkKCkge1xuICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgfCAxMzQyMTc3Mjg7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fc2V0Rm9sbG93aW5nID0gZnVuY3Rpb24gUHJvbWlzZSRfc2V0Rm9sbG93aW5nKCkge1xuICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgfCA1MzY4NzA5MTI7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fc2V0SXNGaW5hbCA9IGZ1bmN0aW9uIFByb21pc2UkX3NldElzRmluYWwoKSB7XG4gICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCB8IDMzNTU0NDMyO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2lzRmluYWwgPSBmdW5jdGlvbiBQcm9taXNlJF9pc0ZpbmFsKCkge1xuICAgIHJldHVybiAodGhpcy5fYml0RmllbGQgJiAzMzU1NDQzMikgPiAwO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2NhbmNlbGxhYmxlID0gZnVuY3Rpb24gUHJvbWlzZSRfY2FuY2VsbGFibGUoKSB7XG4gICAgcmV0dXJuICh0aGlzLl9iaXRGaWVsZCAmIDY3MTA4ODY0KSA+IDA7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fc2V0Q2FuY2VsbGFibGUgPSBmdW5jdGlvbiBQcm9taXNlJF9zZXRDYW5jZWxsYWJsZSgpIHtcbiAgICB0aGlzLl9iaXRGaWVsZCA9IHRoaXMuX2JpdEZpZWxkIHwgNjcxMDg4NjQ7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fdW5zZXRDYW5jZWxsYWJsZSA9IGZ1bmN0aW9uIFByb21pc2UkX3Vuc2V0Q2FuY2VsbGFibGUoKSB7XG4gICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCAmICh+NjcxMDg4NjQpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3NldFJlamVjdGlvbklzVW5oYW5kbGVkID1cbmZ1bmN0aW9uIFByb21pc2UkX3NldFJlamVjdGlvbklzVW5oYW5kbGVkKCkge1xuICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgfCAyMDk3MTUyO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3Vuc2V0UmVqZWN0aW9uSXNVbmhhbmRsZWQgPVxuZnVuY3Rpb24gUHJvbWlzZSRfdW5zZXRSZWplY3Rpb25Jc1VuaGFuZGxlZCgpIHtcbiAgICB0aGlzLl9iaXRGaWVsZCA9IHRoaXMuX2JpdEZpZWxkICYgKH4yMDk3MTUyKTtcbiAgICBpZiAodGhpcy5faXNVbmhhbmRsZWRSZWplY3Rpb25Ob3RpZmllZCgpKSB7XG4gICAgICAgIHRoaXMuX3Vuc2V0VW5oYW5kbGVkUmVqZWN0aW9uSXNOb3RpZmllZCgpO1xuICAgICAgICB0aGlzLl9ub3RpZnlVbmhhbmRsZWRSZWplY3Rpb25Jc0hhbmRsZWQoKTtcbiAgICB9XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5faXNSZWplY3Rpb25VbmhhbmRsZWQgPVxuZnVuY3Rpb24gUHJvbWlzZSRfaXNSZWplY3Rpb25VbmhhbmRsZWQoKSB7XG4gICAgcmV0dXJuICh0aGlzLl9iaXRGaWVsZCAmIDIwOTcxNTIpID4gMDtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9zZXRVbmhhbmRsZWRSZWplY3Rpb25Jc05vdGlmaWVkID1cbmZ1bmN0aW9uIFByb21pc2UkX3NldFVuaGFuZGxlZFJlamVjdGlvbklzTm90aWZpZWQoKSB7XG4gICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCB8IDUyNDI4ODtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl91bnNldFVuaGFuZGxlZFJlamVjdGlvbklzTm90aWZpZWQgPVxuZnVuY3Rpb24gUHJvbWlzZSRfdW5zZXRVbmhhbmRsZWRSZWplY3Rpb25Jc05vdGlmaWVkKCkge1xuICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgJiAofjUyNDI4OCk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5faXNVbmhhbmRsZWRSZWplY3Rpb25Ob3RpZmllZCA9XG5mdW5jdGlvbiBQcm9taXNlJF9pc1VuaGFuZGxlZFJlamVjdGlvbk5vdGlmaWVkKCkge1xuICAgIHJldHVybiAodGhpcy5fYml0RmllbGQgJiA1MjQyODgpID4gMDtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9zZXRDYXJyaWVkU3RhY2tUcmFjZSA9XG5mdW5jdGlvbiBQcm9taXNlJF9zZXRDYXJyaWVkU3RhY2tUcmFjZShjYXB0dXJlZFRyYWNlKSB7XG4gICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCB8IDEwNDg1NzY7XG4gICAgdGhpcy5fZnVsZmlsbG1lbnRIYW5kbGVyMCA9IGNhcHR1cmVkVHJhY2U7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fdW5zZXRDYXJyaWVkU3RhY2tUcmFjZSA9XG5mdW5jdGlvbiBQcm9taXNlJF91bnNldENhcnJpZWRTdGFja1RyYWNlKCkge1xuICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgJiAofjEwNDg1NzYpO1xuICAgIHRoaXMuX2Z1bGZpbGxtZW50SGFuZGxlcjAgPSB2b2lkIDA7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5faXNDYXJyeWluZ1N0YWNrVHJhY2UgPVxuZnVuY3Rpb24gUHJvbWlzZSRfaXNDYXJyeWluZ1N0YWNrVHJhY2UoKSB7XG4gICAgcmV0dXJuICh0aGlzLl9iaXRGaWVsZCAmIDEwNDg1NzYpID4gMDtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9nZXRDYXJyaWVkU3RhY2tUcmFjZSA9XG5mdW5jdGlvbiBQcm9taXNlJF9nZXRDYXJyaWVkU3RhY2tUcmFjZSgpIHtcbiAgICByZXR1cm4gdGhpcy5faXNDYXJyeWluZ1N0YWNrVHJhY2UoKVxuICAgICAgICA/IHRoaXMuX2Z1bGZpbGxtZW50SGFuZGxlcjBcbiAgICAgICAgOiB2b2lkIDA7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fcmVjZWl2ZXJBdCA9IGZ1bmN0aW9uIFByb21pc2UkX3JlY2VpdmVyQXQoaW5kZXgpIHtcbiAgICB2YXIgcmV0ID0gaW5kZXggPT09IDBcbiAgICAgICAgPyB0aGlzLl9yZWNlaXZlcjBcbiAgICAgICAgOiB0aGlzWyhpbmRleCA8PCAyKSArIGluZGV4IC0gNSArIDRdO1xuICAgIGlmICh0aGlzLl9pc0JvdW5kKCkgJiYgcmV0ID09PSB2b2lkIDApIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2JvdW5kVG87XG4gICAgfVxuICAgIHJldHVybiByZXQ7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fcHJvbWlzZUF0ID0gZnVuY3Rpb24gUHJvbWlzZSRfcHJvbWlzZUF0KGluZGV4KSB7XG4gICAgcmV0dXJuIGluZGV4ID09PSAwXG4gICAgICAgID8gdGhpcy5fcHJvbWlzZTBcbiAgICAgICAgOiB0aGlzWyhpbmRleCA8PCAyKSArIGluZGV4IC0gNSArIDNdO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2Z1bGZpbGxtZW50SGFuZGxlckF0ID1cbmZ1bmN0aW9uIFByb21pc2UkX2Z1bGZpbGxtZW50SGFuZGxlckF0KGluZGV4KSB7XG4gICAgcmV0dXJuIGluZGV4ID09PSAwXG4gICAgICAgID8gdGhpcy5fZnVsZmlsbG1lbnRIYW5kbGVyMFxuICAgICAgICA6IHRoaXNbKGluZGV4IDw8IDIpICsgaW5kZXggLSA1ICsgMF07XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fcmVqZWN0aW9uSGFuZGxlckF0ID1cbmZ1bmN0aW9uIFByb21pc2UkX3JlamVjdGlvbkhhbmRsZXJBdChpbmRleCkge1xuICAgIHJldHVybiBpbmRleCA9PT0gMFxuICAgICAgICA/IHRoaXMuX3JlamVjdGlvbkhhbmRsZXIwXG4gICAgICAgIDogdGhpc1soaW5kZXggPDwgMikgKyBpbmRleCAtIDUgKyAxXTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9hZGRDYWxsYmFja3MgPSBmdW5jdGlvbiBQcm9taXNlJF9hZGRDYWxsYmFja3MoXG4gICAgZnVsZmlsbCxcbiAgICByZWplY3QsXG4gICAgcHJvZ3Jlc3MsXG4gICAgcHJvbWlzZSxcbiAgICByZWNlaXZlclxuKSB7XG4gICAgdmFyIGluZGV4ID0gdGhpcy5fbGVuZ3RoKCk7XG5cbiAgICBpZiAoaW5kZXggPj0gMjYyMTQzIC0gNSkge1xuICAgICAgICBpbmRleCA9IDA7XG4gICAgICAgIHRoaXMuX3NldExlbmd0aCgwKTtcbiAgICB9XG5cbiAgICBpZiAoaW5kZXggPT09IDApIHtcbiAgICAgICAgdGhpcy5fcHJvbWlzZTAgPSBwcm9taXNlO1xuICAgICAgICBpZiAocmVjZWl2ZXIgIT09IHZvaWQgMCkgdGhpcy5fcmVjZWl2ZXIwID0gcmVjZWl2ZXI7XG4gICAgICAgIGlmICh0eXBlb2YgZnVsZmlsbCA9PT0gXCJmdW5jdGlvblwiICYmICF0aGlzLl9pc0NhcnJ5aW5nU3RhY2tUcmFjZSgpKVxuICAgICAgICAgICAgdGhpcy5fZnVsZmlsbG1lbnRIYW5kbGVyMCA9IGZ1bGZpbGw7XG4gICAgICAgIGlmICh0eXBlb2YgcmVqZWN0ID09PSBcImZ1bmN0aW9uXCIpIHRoaXMuX3JlamVjdGlvbkhhbmRsZXIwID0gcmVqZWN0O1xuICAgICAgICBpZiAodHlwZW9mIHByb2dyZXNzID09PSBcImZ1bmN0aW9uXCIpIHRoaXMuX3Byb2dyZXNzSGFuZGxlcjAgPSBwcm9ncmVzcztcbiAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgYmFzZSA9IChpbmRleCA8PCAyKSArIGluZGV4IC0gNTtcbiAgICAgICAgdGhpc1tiYXNlICsgM10gPSBwcm9taXNlO1xuICAgICAgICB0aGlzW2Jhc2UgKyA0XSA9IHJlY2VpdmVyO1xuICAgICAgICB0aGlzW2Jhc2UgKyAwXSA9IHR5cGVvZiBmdWxmaWxsID09PSBcImZ1bmN0aW9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBmdWxmaWxsIDogdm9pZCAwO1xuICAgICAgICB0aGlzW2Jhc2UgKyAxXSA9IHR5cGVvZiByZWplY3QgPT09IFwiZnVuY3Rpb25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHJlamVjdCA6IHZvaWQgMDtcbiAgICAgICAgdGhpc1tiYXNlICsgMl0gPSB0eXBlb2YgcHJvZ3Jlc3MgPT09IFwiZnVuY3Rpb25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHByb2dyZXNzIDogdm9pZCAwO1xuICAgIH1cbiAgICB0aGlzLl9zZXRMZW5ndGgoaW5kZXggKyAxKTtcbiAgICByZXR1cm4gaW5kZXg7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fc2V0UHJveHlIYW5kbGVycyA9XG5mdW5jdGlvbiBQcm9taXNlJF9zZXRQcm94eUhhbmRsZXJzKHJlY2VpdmVyLCBwcm9taXNlU2xvdFZhbHVlKSB7XG4gICAgdmFyIGluZGV4ID0gdGhpcy5fbGVuZ3RoKCk7XG5cbiAgICBpZiAoaW5kZXggPj0gMjYyMTQzIC0gNSkge1xuICAgICAgICBpbmRleCA9IDA7XG4gICAgICAgIHRoaXMuX3NldExlbmd0aCgwKTtcbiAgICB9XG4gICAgaWYgKGluZGV4ID09PSAwKSB7XG4gICAgICAgIHRoaXMuX3Byb21pc2UwID0gcHJvbWlzZVNsb3RWYWx1ZTtcbiAgICAgICAgdGhpcy5fcmVjZWl2ZXIwID0gcmVjZWl2ZXI7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIGJhc2UgPSAoaW5kZXggPDwgMikgKyBpbmRleCAtIDU7XG4gICAgICAgIHRoaXNbYmFzZSArIDNdID0gcHJvbWlzZVNsb3RWYWx1ZTtcbiAgICAgICAgdGhpc1tiYXNlICsgNF0gPSByZWNlaXZlcjtcbiAgICAgICAgdGhpc1tiYXNlICsgMF0gPVxuICAgICAgICB0aGlzW2Jhc2UgKyAxXSA9XG4gICAgICAgIHRoaXNbYmFzZSArIDJdID0gdm9pZCAwO1xuICAgIH1cbiAgICB0aGlzLl9zZXRMZW5ndGgoaW5kZXggKyAxKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9wcm94eVByb21pc2VBcnJheSA9XG5mdW5jdGlvbiBQcm9taXNlJF9wcm94eVByb21pc2VBcnJheShwcm9taXNlQXJyYXksIGluZGV4KSB7XG4gICAgdGhpcy5fc2V0UHJveHlIYW5kbGVycyhwcm9taXNlQXJyYXksIGluZGV4KTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9wcm94eVByb21pc2UgPSBmdW5jdGlvbiBQcm9taXNlJF9wcm94eVByb21pc2UocHJvbWlzZSkge1xuICAgIHByb21pc2UuX3NldFByb3hpZWQoKTtcbiAgICB0aGlzLl9zZXRQcm94eUhhbmRsZXJzKHByb21pc2UsIC0xKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9zZXRCb3VuZFRvID0gZnVuY3Rpb24gUHJvbWlzZSRfc2V0Qm91bmRUbyhvYmopIHtcbiAgICBpZiAob2JqICE9PSB2b2lkIDApIHtcbiAgICAgICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCB8IDgzODg2MDg7XG4gICAgICAgIHRoaXMuX2JvdW5kVG8gPSBvYmo7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCAmICh+ODM4ODYwOCk7XG4gICAgfVxufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2lzQm91bmQgPSBmdW5jdGlvbiBQcm9taXNlJF9pc0JvdW5kKCkge1xuICAgIHJldHVybiAodGhpcy5fYml0RmllbGQgJiA4Mzg4NjA4KSA9PT0gODM4ODYwODtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9yZXNvbHZlRnJvbVJlc29sdmVyID1cbmZ1bmN0aW9uIFByb21pc2UkX3Jlc29sdmVGcm9tUmVzb2x2ZXIocmVzb2x2ZXIpIHtcbiAgICB2YXIgcHJvbWlzZSA9IHRoaXM7XG4gICAgdGhpcy5fc2V0VHJhY2Uodm9pZCAwKTtcbiAgICB0aGlzLl9wdXNoQ29udGV4dCgpO1xuXG4gICAgZnVuY3Rpb24gUHJvbWlzZSRfcmVzb2x2ZXIodmFsKSB7XG4gICAgICAgIGlmIChwcm9taXNlLl90cnlGb2xsb3codmFsKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHByb21pc2UuX2Z1bGZpbGwodmFsKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gUHJvbWlzZSRfcmVqZWN0ZXIodmFsKSB7XG4gICAgICAgIHZhciB0cmFjZSA9IGNhbkF0dGFjaCh2YWwpID8gdmFsIDogbmV3IEVycm9yKHZhbCArIFwiXCIpO1xuICAgICAgICBwcm9taXNlLl9hdHRhY2hFeHRyYVRyYWNlKHRyYWNlKTtcbiAgICAgICAgbWFya0FzT3JpZ2luYXRpbmdGcm9tUmVqZWN0aW9uKHZhbCk7XG4gICAgICAgIHByb21pc2UuX3JlamVjdCh2YWwsIHRyYWNlID09PSB2YWwgPyB2b2lkIDAgOiB0cmFjZSk7XG4gICAgfVxuICAgIHZhciByID0gdHJ5Q2F0Y2gyKHJlc29sdmVyLCB2b2lkIDAsIFByb21pc2UkX3Jlc29sdmVyLCBQcm9taXNlJF9yZWplY3Rlcik7XG4gICAgdGhpcy5fcG9wQ29udGV4dCgpO1xuXG4gICAgaWYgKHIgIT09IHZvaWQgMCAmJiByID09PSBlcnJvck9iaikge1xuICAgICAgICB2YXIgZSA9IHIuZTtcbiAgICAgICAgdmFyIHRyYWNlID0gY2FuQXR0YWNoKGUpID8gZSA6IG5ldyBFcnJvcihlICsgXCJcIik7XG4gICAgICAgIHByb21pc2UuX3JlamVjdChlLCB0cmFjZSk7XG4gICAgfVxufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3NwcmVhZFNsb3dDYXNlID1cbmZ1bmN0aW9uIFByb21pc2UkX3NwcmVhZFNsb3dDYXNlKHRhcmdldEZuLCBwcm9taXNlLCB2YWx1ZXMsIGJvdW5kVG8pIHtcbiAgICB2YXIgcHJvbWlzZUZvckFsbCA9IG5ldyBQcm9taXNlQXJyYXkodmFsdWVzKS5wcm9taXNlKCk7XG4gICAgdmFyIHByb21pc2UyID0gcHJvbWlzZUZvckFsbC5fdGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRhcmdldEZuLmFwcGx5KGJvdW5kVG8sIGFyZ3VtZW50cyk7XG4gICAgfSwgdm9pZCAwLCB2b2lkIDAsIEFQUExZLCB2b2lkIDApO1xuICAgIHByb21pc2UuX2ZvbGxvdyhwcm9taXNlMik7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fY2FsbFNwcmVhZCA9XG5mdW5jdGlvbiBQcm9taXNlJF9jYWxsU3ByZWFkKGhhbmRsZXIsIHByb21pc2UsIHZhbHVlKSB7XG4gICAgdmFyIGJvdW5kVG8gPSB0aGlzLl9ib3VuZFRvO1xuICAgIGlmIChpc0FycmF5KHZhbHVlKSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gdmFsdWUubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHtcbiAgICAgICAgICAgIGlmIChjYXN0KHZhbHVlW2ldLCB2b2lkIDApIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3NwcmVhZFNsb3dDYXNlKGhhbmRsZXIsIHByb21pc2UsIHZhbHVlLCBib3VuZFRvKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcHJvbWlzZS5fcHVzaENvbnRleHQoKTtcbiAgICByZXR1cm4gdHJ5Q2F0Y2hBcHBseShoYW5kbGVyLCB2YWx1ZSwgYm91bmRUbyk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fY2FsbEhhbmRsZXIgPVxuZnVuY3Rpb24gUHJvbWlzZSRfY2FsbEhhbmRsZXIoXG4gICAgaGFuZGxlciwgcmVjZWl2ZXIsIHByb21pc2UsIHZhbHVlKSB7XG4gICAgdmFyIHg7XG4gICAgaWYgKHJlY2VpdmVyID09PSBBUFBMWSAmJiAhdGhpcy5pc1JlamVjdGVkKCkpIHtcbiAgICAgICAgeCA9IHRoaXMuX2NhbGxTcHJlYWQoaGFuZGxlciwgcHJvbWlzZSwgdmFsdWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHByb21pc2UuX3B1c2hDb250ZXh0KCk7XG4gICAgICAgIHggPSB0cnlDYXRjaDEoaGFuZGxlciwgcmVjZWl2ZXIsIHZhbHVlKTtcbiAgICB9XG4gICAgcHJvbWlzZS5fcG9wQ29udGV4dCgpO1xuICAgIHJldHVybiB4O1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3NldHRsZVByb21pc2VGcm9tSGFuZGxlciA9XG5mdW5jdGlvbiBQcm9taXNlJF9zZXR0bGVQcm9taXNlRnJvbUhhbmRsZXIoXG4gICAgaGFuZGxlciwgcmVjZWl2ZXIsIHZhbHVlLCBwcm9taXNlXG4pIHtcbiAgICBpZiAoIShwcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkpIHtcbiAgICAgICAgaGFuZGxlci5jYWxsKHJlY2VpdmVyLCB2YWx1ZSwgcHJvbWlzZSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHggPSB0aGlzLl9jYWxsSGFuZGxlcihoYW5kbGVyLCByZWNlaXZlciwgcHJvbWlzZSwgdmFsdWUpO1xuICAgIGlmIChwcm9taXNlLl9pc0ZvbGxvd2luZygpKSByZXR1cm47XG5cbiAgICBpZiAoeCA9PT0gZXJyb3JPYmogfHwgeCA9PT0gcHJvbWlzZSB8fCB4ID09PSBORVhUX0ZJTFRFUikge1xuICAgICAgICB2YXIgZXJyID0geCA9PT0gcHJvbWlzZVxuICAgICAgICAgICAgICAgICAgICA/IG1ha2VTZWxmUmVzb2x1dGlvbkVycm9yKClcbiAgICAgICAgICAgICAgICAgICAgOiB4LmU7XG4gICAgICAgIHZhciB0cmFjZSA9IGNhbkF0dGFjaChlcnIpID8gZXJyIDogbmV3IEVycm9yKGVyciArIFwiXCIpO1xuICAgICAgICBpZiAoeCAhPT0gTkVYVF9GSUxURVIpIHByb21pc2UuX2F0dGFjaEV4dHJhVHJhY2UodHJhY2UpO1xuICAgICAgICBwcm9taXNlLl9yZWplY3RVbmNoZWNrZWQoZXJyLCB0cmFjZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIGNhc3RWYWx1ZSA9IGNhc3QoeCwgcHJvbWlzZSk7XG4gICAgICAgIGlmIChjYXN0VmFsdWUgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgICAgICBpZiAoY2FzdFZhbHVlLmlzUmVqZWN0ZWQoKSAmJlxuICAgICAgICAgICAgICAgICFjYXN0VmFsdWUuX2lzQ2FycnlpbmdTdGFja1RyYWNlKCkgJiZcbiAgICAgICAgICAgICAgICAhY2FuQXR0YWNoKGNhc3RWYWx1ZS5fc2V0dGxlZFZhbHVlKSkge1xuICAgICAgICAgICAgICAgIHZhciB0cmFjZSA9IG5ldyBFcnJvcihjYXN0VmFsdWUuX3NldHRsZWRWYWx1ZSArIFwiXCIpO1xuICAgICAgICAgICAgICAgIHByb21pc2UuX2F0dGFjaEV4dHJhVHJhY2UodHJhY2UpO1xuICAgICAgICAgICAgICAgIGNhc3RWYWx1ZS5fc2V0Q2FycmllZFN0YWNrVHJhY2UodHJhY2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcHJvbWlzZS5fZm9sbG93KGNhc3RWYWx1ZSk7XG4gICAgICAgICAgICBwcm9taXNlLl9wcm9wYWdhdGVGcm9tKGNhc3RWYWx1ZSwgMSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBwcm9taXNlLl9mdWxmaWxsVW5jaGVja2VkKHgpO1xuICAgICAgICB9XG4gICAgfVxufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2ZvbGxvdyA9XG5mdW5jdGlvbiBQcm9taXNlJF9mb2xsb3cocHJvbWlzZSkge1xuICAgIHRoaXMuX3NldEZvbGxvd2luZygpO1xuXG4gICAgaWYgKHByb21pc2UuaXNQZW5kaW5nKCkpIHtcbiAgICAgICAgdGhpcy5fcHJvcGFnYXRlRnJvbShwcm9taXNlLCAxKTtcbiAgICAgICAgcHJvbWlzZS5fcHJveHlQcm9taXNlKHRoaXMpO1xuICAgIH0gZWxzZSBpZiAocHJvbWlzZS5pc0Z1bGZpbGxlZCgpKSB7XG4gICAgICAgIHRoaXMuX2Z1bGZpbGxVbmNoZWNrZWQocHJvbWlzZS5fc2V0dGxlZFZhbHVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl9yZWplY3RVbmNoZWNrZWQocHJvbWlzZS5fc2V0dGxlZFZhbHVlLFxuICAgICAgICAgICAgcHJvbWlzZS5fZ2V0Q2FycmllZFN0YWNrVHJhY2UoKSk7XG4gICAgfVxuXG4gICAgaWYgKHByb21pc2UuX2lzUmVqZWN0aW9uVW5oYW5kbGVkKCkpIHByb21pc2UuX3Vuc2V0UmVqZWN0aW9uSXNVbmhhbmRsZWQoKTtcblxuICAgIGlmIChkZWJ1Z2dpbmcgJiZcbiAgICAgICAgcHJvbWlzZS5fdHJhY2VQYXJlbnQgPT0gbnVsbCkge1xuICAgICAgICBwcm9taXNlLl90cmFjZVBhcmVudCA9IHRoaXM7XG4gICAgfVxufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3RyeUZvbGxvdyA9XG5mdW5jdGlvbiBQcm9taXNlJF90cnlGb2xsb3codmFsdWUpIHtcbiAgICBpZiAodGhpcy5faXNGb2xsb3dpbmdPckZ1bGZpbGxlZE9yUmVqZWN0ZWQoKSB8fFxuICAgICAgICB2YWx1ZSA9PT0gdGhpcykge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBtYXliZVByb21pc2UgPSBjYXN0KHZhbHVlLCB2b2lkIDApO1xuICAgIGlmICghKG1heWJlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdGhpcy5fZm9sbG93KG1heWJlUHJvbWlzZSk7XG4gICAgcmV0dXJuIHRydWU7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fcmVzZXRUcmFjZSA9IGZ1bmN0aW9uIFByb21pc2UkX3Jlc2V0VHJhY2UoKSB7XG4gICAgaWYgKGRlYnVnZ2luZykge1xuICAgICAgICB0aGlzLl90cmFjZSA9IG5ldyBDYXB0dXJlZFRyYWNlKHRoaXMuX3BlZWtDb250ZXh0KCkgPT09IHZvaWQgMCk7XG4gICAgfVxufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3NldFRyYWNlID0gZnVuY3Rpb24gUHJvbWlzZSRfc2V0VHJhY2UocGFyZW50KSB7XG4gICAgaWYgKGRlYnVnZ2luZykge1xuICAgICAgICB2YXIgY29udGV4dCA9IHRoaXMuX3BlZWtDb250ZXh0KCk7XG4gICAgICAgIHRoaXMuX3RyYWNlUGFyZW50ID0gY29udGV4dDtcbiAgICAgICAgdmFyIGlzVG9wTGV2ZWwgPSBjb250ZXh0ID09PSB2b2lkIDA7XG4gICAgICAgIGlmIChwYXJlbnQgIT09IHZvaWQgMCAmJlxuICAgICAgICAgICAgcGFyZW50Ll90cmFjZVBhcmVudCA9PT0gY29udGV4dCkge1xuICAgICAgICAgICAgdGhpcy5fdHJhY2UgPSBwYXJlbnQuX3RyYWNlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fdHJhY2UgPSBuZXcgQ2FwdHVyZWRUcmFjZShpc1RvcExldmVsKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9hdHRhY2hFeHRyYVRyYWNlID1cbmZ1bmN0aW9uIFByb21pc2UkX2F0dGFjaEV4dHJhVHJhY2UoZXJyb3IpIHtcbiAgICBpZiAoZGVidWdnaW5nKSB7XG4gICAgICAgIHZhciBwcm9taXNlID0gdGhpcztcbiAgICAgICAgdmFyIHN0YWNrID0gZXJyb3Iuc3RhY2s7XG4gICAgICAgIHN0YWNrID0gdHlwZW9mIHN0YWNrID09PSBcInN0cmluZ1wiID8gc3RhY2suc3BsaXQoXCJcXG5cIikgOiBbXTtcbiAgICAgICAgQ2FwdHVyZWRUcmFjZS5wcm90ZWN0RXJyb3JNZXNzYWdlTmV3bGluZXMoc3RhY2spO1xuICAgICAgICB2YXIgaGVhZGVyTGluZUNvdW50ID0gMTtcbiAgICAgICAgdmFyIGNvbWJpbmVkVHJhY2VzID0gMTtcbiAgICAgICAgd2hpbGUocHJvbWlzZSAhPSBudWxsICYmXG4gICAgICAgICAgICBwcm9taXNlLl90cmFjZSAhPSBudWxsKSB7XG4gICAgICAgICAgICBzdGFjayA9IENhcHR1cmVkVHJhY2UuY29tYmluZShcbiAgICAgICAgICAgICAgICBzdGFjayxcbiAgICAgICAgICAgICAgICBwcm9taXNlLl90cmFjZS5zdGFjay5zcGxpdChcIlxcblwiKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHByb21pc2UgPSBwcm9taXNlLl90cmFjZVBhcmVudDtcbiAgICAgICAgICAgIGNvbWJpbmVkVHJhY2VzKys7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgc3RhY2tUcmFjZUxpbWl0ID0gRXJyb3Iuc3RhY2tUcmFjZUxpbWl0IHx8IDEwO1xuICAgICAgICB2YXIgbWF4ID0gKHN0YWNrVHJhY2VMaW1pdCArIGhlYWRlckxpbmVDb3VudCkgKiBjb21iaW5lZFRyYWNlcztcbiAgICAgICAgdmFyIGxlbiA9IHN0YWNrLmxlbmd0aDtcbiAgICAgICAgaWYgKGxlbiA+IG1heCkge1xuICAgICAgICAgICAgc3RhY2subGVuZ3RoID0gbWF4O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGxlbiA+IDApXG4gICAgICAgICAgICBzdGFja1swXSA9IHN0YWNrWzBdLnNwbGl0KFwiXFx1MDAwMlxcdTAwMDBcXHUwMDAxXCIpLmpvaW4oXCJcXG5cIik7XG5cbiAgICAgICAgaWYgKHN0YWNrLmxlbmd0aCA8PSBoZWFkZXJMaW5lQ291bnQpIHtcbiAgICAgICAgICAgIGVycm9yLnN0YWNrID0gXCIoTm8gc3RhY2sgdHJhY2UpXCI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBlcnJvci5zdGFjayA9IHN0YWNrLmpvaW4oXCJcXG5cIik7XG4gICAgICAgIH1cbiAgICB9XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fY2xlYW5WYWx1ZXMgPSBmdW5jdGlvbiBQcm9taXNlJF9jbGVhblZhbHVlcygpIHtcbiAgICBpZiAodGhpcy5fY2FuY2VsbGFibGUoKSkge1xuICAgICAgICB0aGlzLl9jYW5jZWxsYXRpb25QYXJlbnQgPSB2b2lkIDA7XG4gICAgfVxufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3Byb3BhZ2F0ZUZyb20gPVxuZnVuY3Rpb24gUHJvbWlzZSRfcHJvcGFnYXRlRnJvbShwYXJlbnQsIGZsYWdzKSB7XG4gICAgaWYgKChmbGFncyAmIDEpID4gMCAmJiBwYXJlbnQuX2NhbmNlbGxhYmxlKCkpIHtcbiAgICAgICAgdGhpcy5fc2V0Q2FuY2VsbGFibGUoKTtcbiAgICAgICAgdGhpcy5fY2FuY2VsbGF0aW9uUGFyZW50ID0gcGFyZW50O1xuICAgIH1cbiAgICBpZiAoKGZsYWdzICYgNCkgPiAwKSB7XG4gICAgICAgIHRoaXMuX3NldEJvdW5kVG8ocGFyZW50Ll9ib3VuZFRvKTtcbiAgICB9XG4gICAgaWYgKChmbGFncyAmIDIpID4gMCkge1xuICAgICAgICB0aGlzLl9zZXRUcmFjZShwYXJlbnQpO1xuICAgIH1cbn07XG5cblByb21pc2UucHJvdG90eXBlLl9mdWxmaWxsID0gZnVuY3Rpb24gUHJvbWlzZSRfZnVsZmlsbCh2YWx1ZSkge1xuICAgIGlmICh0aGlzLl9pc0ZvbGxvd2luZ09yRnVsZmlsbGVkT3JSZWplY3RlZCgpKSByZXR1cm47XG4gICAgdGhpcy5fZnVsZmlsbFVuY2hlY2tlZCh2YWx1ZSk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fcmVqZWN0ID1cbmZ1bmN0aW9uIFByb21pc2UkX3JlamVjdChyZWFzb24sIGNhcnJpZWRTdGFja1RyYWNlKSB7XG4gICAgaWYgKHRoaXMuX2lzRm9sbG93aW5nT3JGdWxmaWxsZWRPclJlamVjdGVkKCkpIHJldHVybjtcbiAgICB0aGlzLl9yZWplY3RVbmNoZWNrZWQocmVhc29uLCBjYXJyaWVkU3RhY2tUcmFjZSk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fc2V0dGxlUHJvbWlzZUF0ID0gZnVuY3Rpb24gUHJvbWlzZSRfc2V0dGxlUHJvbWlzZUF0KGluZGV4KSB7XG4gICAgdmFyIGhhbmRsZXIgPSB0aGlzLmlzRnVsZmlsbGVkKClcbiAgICAgICAgPyB0aGlzLl9mdWxmaWxsbWVudEhhbmRsZXJBdChpbmRleClcbiAgICAgICAgOiB0aGlzLl9yZWplY3Rpb25IYW5kbGVyQXQoaW5kZXgpO1xuXG4gICAgdmFyIHZhbHVlID0gdGhpcy5fc2V0dGxlZFZhbHVlO1xuICAgIHZhciByZWNlaXZlciA9IHRoaXMuX3JlY2VpdmVyQXQoaW5kZXgpO1xuICAgIHZhciBwcm9taXNlID0gdGhpcy5fcHJvbWlzZUF0KGluZGV4KTtcblxuICAgIGlmICh0eXBlb2YgaGFuZGxlciA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHRoaXMuX3NldHRsZVByb21pc2VGcm9tSGFuZGxlcihoYW5kbGVyLCByZWNlaXZlciwgdmFsdWUsIHByb21pc2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBkb25lID0gZmFsc2U7XG4gICAgICAgIHZhciBpc0Z1bGZpbGxlZCA9IHRoaXMuaXNGdWxmaWxsZWQoKTtcbiAgICAgICAgaWYgKHJlY2VpdmVyICE9PSB2b2lkIDApIHtcbiAgICAgICAgICAgIGlmIChyZWNlaXZlciBpbnN0YW5jZW9mIFByb21pc2UgJiZcbiAgICAgICAgICAgICAgICByZWNlaXZlci5faXNQcm94aWVkKCkpIHtcbiAgICAgICAgICAgICAgICByZWNlaXZlci5fdW5zZXRQcm94aWVkKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoaXNGdWxmaWxsZWQpIHJlY2VpdmVyLl9mdWxmaWxsVW5jaGVja2VkKHZhbHVlKTtcbiAgICAgICAgICAgICAgICBlbHNlIHJlY2VpdmVyLl9yZWplY3RVbmNoZWNrZWQodmFsdWUsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2dldENhcnJpZWRTdGFja1RyYWNlKCkpO1xuICAgICAgICAgICAgICAgIGRvbmUgPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChyZWNlaXZlciBpbnN0YW5jZW9mIFByb21pc2VBcnJheSkge1xuICAgICAgICAgICAgICAgIGlmIChpc0Z1bGZpbGxlZCkgcmVjZWl2ZXIuX3Byb21pc2VGdWxmaWxsZWQodmFsdWUsIHByb21pc2UpO1xuICAgICAgICAgICAgICAgIGVsc2UgcmVjZWl2ZXIuX3Byb21pc2VSZWplY3RlZCh2YWx1ZSwgcHJvbWlzZSk7XG4gICAgICAgICAgICAgICAgZG9uZSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWRvbmUpIHtcbiAgICAgICAgICAgIGlmIChpc0Z1bGZpbGxlZCkgcHJvbWlzZS5fZnVsZmlsbCh2YWx1ZSk7XG4gICAgICAgICAgICBlbHNlIHByb21pc2UuX3JlamVjdCh2YWx1ZSwgdGhpcy5fZ2V0Q2FycmllZFN0YWNrVHJhY2UoKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoaW5kZXggPj0gMjU2KSB7XG4gICAgICAgIHRoaXMuX3F1ZXVlR0MoKTtcbiAgICB9XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5faXNQcm94aWVkID0gZnVuY3Rpb24gUHJvbWlzZSRfaXNQcm94aWVkKCkge1xuICAgIHJldHVybiAodGhpcy5fYml0RmllbGQgJiA0MTk0MzA0KSA9PT0gNDE5NDMwNDtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9zZXRQcm94aWVkID0gZnVuY3Rpb24gUHJvbWlzZSRfc2V0UHJveGllZCgpIHtcbiAgICB0aGlzLl9iaXRGaWVsZCA9IHRoaXMuX2JpdEZpZWxkIHwgNDE5NDMwNDtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl91bnNldFByb3hpZWQgPSBmdW5jdGlvbiBQcm9taXNlJF91bnNldFByb3hpZWQoKSB7XG4gICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCAmICh+NDE5NDMwNCk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5faXNHY1F1ZXVlZCA9IGZ1bmN0aW9uIFByb21pc2UkX2lzR2NRdWV1ZWQoKSB7XG4gICAgcmV0dXJuICh0aGlzLl9iaXRGaWVsZCAmIC0xMDczNzQxODI0KSA9PT0gLTEwNzM3NDE4MjQ7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fc2V0R2NRdWV1ZWQgPSBmdW5jdGlvbiBQcm9taXNlJF9zZXRHY1F1ZXVlZCgpIHtcbiAgICB0aGlzLl9iaXRGaWVsZCA9IHRoaXMuX2JpdEZpZWxkIHwgLTEwNzM3NDE4MjQ7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fdW5zZXRHY1F1ZXVlZCA9IGZ1bmN0aW9uIFByb21pc2UkX3Vuc2V0R2NRdWV1ZWQoKSB7XG4gICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCAmICh+LTEwNzM3NDE4MjQpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3F1ZXVlR0MgPSBmdW5jdGlvbiBQcm9taXNlJF9xdWV1ZUdDKCkge1xuICAgIGlmICh0aGlzLl9pc0djUXVldWVkKCkpIHJldHVybjtcbiAgICB0aGlzLl9zZXRHY1F1ZXVlZCgpO1xuICAgIGFzeW5jLmludm9rZUxhdGVyKHRoaXMuX2djLCB0aGlzLCB2b2lkIDApO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2djID0gZnVuY3Rpb24gUHJvbWlzZSRnYygpIHtcbiAgICB2YXIgbGVuID0gdGhpcy5fbGVuZ3RoKCkgKiA1O1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgZGVsZXRlIHRoaXNbaV07XG4gICAgfVxuICAgIHRoaXMuX3NldExlbmd0aCgwKTtcbiAgICB0aGlzLl91bnNldEdjUXVldWVkKCk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fcXVldWVTZXR0bGVBdCA9IGZ1bmN0aW9uIFByb21pc2UkX3F1ZXVlU2V0dGxlQXQoaW5kZXgpIHtcbiAgICBpZiAodGhpcy5faXNSZWplY3Rpb25VbmhhbmRsZWQoKSkgdGhpcy5fdW5zZXRSZWplY3Rpb25Jc1VuaGFuZGxlZCgpO1xuICAgIGFzeW5jLmludm9rZSh0aGlzLl9zZXR0bGVQcm9taXNlQXQsIHRoaXMsIGluZGV4KTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9mdWxmaWxsVW5jaGVja2VkID1cbmZ1bmN0aW9uIFByb21pc2UkX2Z1bGZpbGxVbmNoZWNrZWQodmFsdWUpIHtcbiAgICBpZiAoIXRoaXMuaXNQZW5kaW5nKCkpIHJldHVybjtcbiAgICBpZiAodmFsdWUgPT09IHRoaXMpIHtcbiAgICAgICAgdmFyIGVyciA9IG1ha2VTZWxmUmVzb2x1dGlvbkVycm9yKCk7XG4gICAgICAgIHRoaXMuX2F0dGFjaEV4dHJhVHJhY2UoZXJyKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JlamVjdFVuY2hlY2tlZChlcnIsIHZvaWQgMCk7XG4gICAgfVxuICAgIHRoaXMuX2NsZWFuVmFsdWVzKCk7XG4gICAgdGhpcy5fc2V0RnVsZmlsbGVkKCk7XG4gICAgdGhpcy5fc2V0dGxlZFZhbHVlID0gdmFsdWU7XG4gICAgdmFyIGxlbiA9IHRoaXMuX2xlbmd0aCgpO1xuXG4gICAgaWYgKGxlbiA+IDApIHtcbiAgICAgICAgYXN5bmMuaW52b2tlKHRoaXMuX3NldHRsZVByb21pc2VzLCB0aGlzLCBsZW4pO1xuICAgIH1cbn07XG5cblByb21pc2UucHJvdG90eXBlLl9yZWplY3RVbmNoZWNrZWRDaGVja0Vycm9yID1cbmZ1bmN0aW9uIFByb21pc2UkX3JlamVjdFVuY2hlY2tlZENoZWNrRXJyb3IocmVhc29uKSB7XG4gICAgdmFyIHRyYWNlID0gY2FuQXR0YWNoKHJlYXNvbikgPyByZWFzb24gOiBuZXcgRXJyb3IocmVhc29uICsgXCJcIik7XG4gICAgdGhpcy5fcmVqZWN0VW5jaGVja2VkKHJlYXNvbiwgdHJhY2UgPT09IHJlYXNvbiA/IHZvaWQgMCA6IHRyYWNlKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9yZWplY3RVbmNoZWNrZWQgPVxuZnVuY3Rpb24gUHJvbWlzZSRfcmVqZWN0VW5jaGVja2VkKHJlYXNvbiwgdHJhY2UpIHtcbiAgICBpZiAoIXRoaXMuaXNQZW5kaW5nKCkpIHJldHVybjtcbiAgICBpZiAocmVhc29uID09PSB0aGlzKSB7XG4gICAgICAgIHZhciBlcnIgPSBtYWtlU2VsZlJlc29sdXRpb25FcnJvcigpO1xuICAgICAgICB0aGlzLl9hdHRhY2hFeHRyYVRyYWNlKGVycik7XG4gICAgICAgIHJldHVybiB0aGlzLl9yZWplY3RVbmNoZWNrZWQoZXJyKTtcbiAgICB9XG4gICAgdGhpcy5fY2xlYW5WYWx1ZXMoKTtcbiAgICB0aGlzLl9zZXRSZWplY3RlZCgpO1xuICAgIHRoaXMuX3NldHRsZWRWYWx1ZSA9IHJlYXNvbjtcblxuICAgIGlmICh0aGlzLl9pc0ZpbmFsKCkpIHtcbiAgICAgICAgYXN5bmMuaW52b2tlTGF0ZXIodGhyb3dlciwgdm9pZCAwLCB0cmFjZSA9PT0gdm9pZCAwID8gcmVhc29uIDogdHJhY2UpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBsZW4gPSB0aGlzLl9sZW5ndGgoKTtcblxuICAgIGlmICh0cmFjZSAhPT0gdm9pZCAwKSB0aGlzLl9zZXRDYXJyaWVkU3RhY2tUcmFjZSh0cmFjZSk7XG5cbiAgICBpZiAobGVuID4gMCkge1xuICAgICAgICBhc3luYy5pbnZva2UodGhpcy5fcmVqZWN0UHJvbWlzZXMsIHRoaXMsIG51bGwpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX2Vuc3VyZVBvc3NpYmxlUmVqZWN0aW9uSGFuZGxlZCgpO1xuICAgIH1cbn07XG5cblByb21pc2UucHJvdG90eXBlLl9yZWplY3RQcm9taXNlcyA9IGZ1bmN0aW9uIFByb21pc2UkX3JlamVjdFByb21pc2VzKCkge1xuICAgIHRoaXMuX3NldHRsZVByb21pc2VzKCk7XG4gICAgdGhpcy5fdW5zZXRDYXJyaWVkU3RhY2tUcmFjZSgpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3NldHRsZVByb21pc2VzID0gZnVuY3Rpb24gUHJvbWlzZSRfc2V0dGxlUHJvbWlzZXMoKSB7XG4gICAgdmFyIGxlbiA9IHRoaXMuX2xlbmd0aCgpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgdGhpcy5fc2V0dGxlUHJvbWlzZUF0KGkpO1xuICAgIH1cbn07XG5cblByb21pc2UucHJvdG90eXBlLl9lbnN1cmVQb3NzaWJsZVJlamVjdGlvbkhhbmRsZWQgPVxuZnVuY3Rpb24gUHJvbWlzZSRfZW5zdXJlUG9zc2libGVSZWplY3Rpb25IYW5kbGVkKCkge1xuICAgIHRoaXMuX3NldFJlamVjdGlvbklzVW5oYW5kbGVkKCk7XG4gICAgaWYgKENhcHR1cmVkVHJhY2UucG9zc2libHlVbmhhbmRsZWRSZWplY3Rpb24gIT09IHZvaWQgMCkge1xuICAgICAgICBhc3luYy5pbnZva2VMYXRlcih0aGlzLl9ub3RpZnlVbmhhbmRsZWRSZWplY3Rpb24sIHRoaXMsIHZvaWQgMCk7XG4gICAgfVxufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX25vdGlmeVVuaGFuZGxlZFJlamVjdGlvbklzSGFuZGxlZCA9XG5mdW5jdGlvbiBQcm9taXNlJF9ub3RpZnlVbmhhbmRsZWRSZWplY3Rpb25Jc0hhbmRsZWQoKSB7XG4gICAgaWYgKHR5cGVvZiB1bmhhbmRsZWRSZWplY3Rpb25IYW5kbGVkID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgYXN5bmMuaW52b2tlTGF0ZXIodW5oYW5kbGVkUmVqZWN0aW9uSGFuZGxlZCwgdm9pZCAwLCB0aGlzKTtcbiAgICB9XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fbm90aWZ5VW5oYW5kbGVkUmVqZWN0aW9uID1cbmZ1bmN0aW9uIFByb21pc2UkX25vdGlmeVVuaGFuZGxlZFJlamVjdGlvbigpIHtcbiAgICBpZiAodGhpcy5faXNSZWplY3Rpb25VbmhhbmRsZWQoKSkge1xuICAgICAgICB2YXIgcmVhc29uID0gdGhpcy5fc2V0dGxlZFZhbHVlO1xuICAgICAgICB2YXIgdHJhY2UgPSB0aGlzLl9nZXRDYXJyaWVkU3RhY2tUcmFjZSgpO1xuXG4gICAgICAgIHRoaXMuX3NldFVuaGFuZGxlZFJlamVjdGlvbklzTm90aWZpZWQoKTtcblxuICAgICAgICBpZiAodHJhY2UgIT09IHZvaWQgMCkge1xuICAgICAgICAgICAgdGhpcy5fdW5zZXRDYXJyaWVkU3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgcmVhc29uID0gdHJhY2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBDYXB0dXJlZFRyYWNlLnBvc3NpYmx5VW5oYW5kbGVkUmVqZWN0aW9uID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIENhcHR1cmVkVHJhY2UucG9zc2libHlVbmhhbmRsZWRSZWplY3Rpb24ocmVhc29uLCB0aGlzKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cbnZhciBjb250ZXh0U3RhY2sgPSBbXTtcblByb21pc2UucHJvdG90eXBlLl9wZWVrQ29udGV4dCA9IGZ1bmN0aW9uIFByb21pc2UkX3BlZWtDb250ZXh0KCkge1xuICAgIHZhciBsYXN0SW5kZXggPSBjb250ZXh0U3RhY2subGVuZ3RoIC0gMTtcbiAgICBpZiAobGFzdEluZGV4ID49IDApIHtcbiAgICAgICAgcmV0dXJuIGNvbnRleHRTdGFja1tsYXN0SW5kZXhdO1xuICAgIH1cbiAgICByZXR1cm4gdm9pZCAwO1xuXG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fcHVzaENvbnRleHQgPSBmdW5jdGlvbiBQcm9taXNlJF9wdXNoQ29udGV4dCgpIHtcbiAgICBpZiAoIWRlYnVnZ2luZykgcmV0dXJuO1xuICAgIGNvbnRleHRTdGFjay5wdXNoKHRoaXMpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3BvcENvbnRleHQgPSBmdW5jdGlvbiBQcm9taXNlJF9wb3BDb250ZXh0KCkge1xuICAgIGlmICghZGVidWdnaW5nKSByZXR1cm47XG4gICAgY29udGV4dFN0YWNrLnBvcCgpO1xufTtcblxuUHJvbWlzZS5ub0NvbmZsaWN0ID0gZnVuY3Rpb24gUHJvbWlzZSROb0NvbmZsaWN0KCkge1xuICAgIHJldHVybiBub0NvbmZsaWN0KFByb21pc2UpO1xufTtcblxuUHJvbWlzZS5zZXRTY2hlZHVsZXIgPSBmdW5jdGlvbihmbikge1xuICAgIGlmICh0eXBlb2YgZm4gIT09IFwiZnVuY3Rpb25cIikgdGhyb3cgbmV3IFR5cGVFcnJvcihcImZuIG11c3QgYmUgYSBmdW5jdGlvblwiKTtcbiAgICBhc3luYy5fc2NoZWR1bGUgPSBmbjtcbn07XG5cbmlmICghQ2FwdHVyZWRUcmFjZS5pc1N1cHBvcnRlZCgpKSB7XG4gICAgUHJvbWlzZS5sb25nU3RhY2tUcmFjZXMgPSBmdW5jdGlvbigpe307XG4gICAgZGVidWdnaW5nID0gZmFsc2U7XG59XG5cblByb21pc2UuX21ha2VTZWxmUmVzb2x1dGlvbkVycm9yID0gbWFrZVNlbGZSZXNvbHV0aW9uRXJyb3I7XG5yZXF1aXJlKFwiLi9maW5hbGx5LmpzXCIpKFByb21pc2UsIE5FWFRfRklMVEVSLCBjYXN0KTtcbnJlcXVpcmUoXCIuL2RpcmVjdF9yZXNvbHZlLmpzXCIpKFByb21pc2UpO1xucmVxdWlyZShcIi4vc3luY2hyb25vdXNfaW5zcGVjdGlvbi5qc1wiKShQcm9taXNlKTtcbnJlcXVpcmUoXCIuL2pvaW4uanNcIikoUHJvbWlzZSwgUHJvbWlzZUFycmF5LCBjYXN0LCBJTlRFUk5BTCk7XG5Qcm9taXNlLlJhbmdlRXJyb3IgPSBSYW5nZUVycm9yO1xuUHJvbWlzZS5DYW5jZWxsYXRpb25FcnJvciA9IENhbmNlbGxhdGlvbkVycm9yO1xuUHJvbWlzZS5UaW1lb3V0RXJyb3IgPSBUaW1lb3V0RXJyb3I7XG5Qcm9taXNlLlR5cGVFcnJvciA9IFR5cGVFcnJvcjtcblByb21pc2UuT3BlcmF0aW9uYWxFcnJvciA9IE9wZXJhdGlvbmFsRXJyb3I7XG5Qcm9taXNlLlJlamVjdGlvbkVycm9yID0gT3BlcmF0aW9uYWxFcnJvcjtcblByb21pc2UuQWdncmVnYXRlRXJyb3IgPSBlcnJvcnMuQWdncmVnYXRlRXJyb3I7XG5cbnV0aWwudG9GYXN0UHJvcGVydGllcyhQcm9taXNlKTtcbnV0aWwudG9GYXN0UHJvcGVydGllcyhQcm9taXNlLnByb3RvdHlwZSk7XG5Qcm9taXNlLlByb21pc2UgPSBQcm9taXNlO1xucmVxdWlyZSgnLi90aW1lcnMuanMnKShQcm9taXNlLElOVEVSTkFMLGNhc3QpO1xucmVxdWlyZSgnLi9yYWNlLmpzJykoUHJvbWlzZSxJTlRFUk5BTCxjYXN0KTtcbnJlcXVpcmUoJy4vY2FsbF9nZXQuanMnKShQcm9taXNlKTtcbnJlcXVpcmUoJy4vZ2VuZXJhdG9ycy5qcycpKFByb21pc2UsYXBpUmVqZWN0aW9uLElOVEVSTkFMLGNhc3QpO1xucmVxdWlyZSgnLi9tYXAuanMnKShQcm9taXNlLFByb21pc2VBcnJheSxhcGlSZWplY3Rpb24sY2FzdCxJTlRFUk5BTCk7XG5yZXF1aXJlKCcuL25vZGVpZnkuanMnKShQcm9taXNlKTtcbnJlcXVpcmUoJy4vcHJvbWlzaWZ5LmpzJykoUHJvbWlzZSxJTlRFUk5BTCk7XG5yZXF1aXJlKCcuL3Byb3BzLmpzJykoUHJvbWlzZSxQcm9taXNlQXJyYXksY2FzdCk7XG5yZXF1aXJlKCcuL3JlZHVjZS5qcycpKFByb21pc2UsUHJvbWlzZUFycmF5LGFwaVJlamVjdGlvbixjYXN0LElOVEVSTkFMKTtcbnJlcXVpcmUoJy4vc2V0dGxlLmpzJykoUHJvbWlzZSxQcm9taXNlQXJyYXkpO1xucmVxdWlyZSgnLi9zb21lLmpzJykoUHJvbWlzZSxQcm9taXNlQXJyYXksYXBpUmVqZWN0aW9uKTtcbnJlcXVpcmUoJy4vcHJvZ3Jlc3MuanMnKShQcm9taXNlLFByb21pc2VBcnJheSk7XG5yZXF1aXJlKCcuL2NhbmNlbC5qcycpKFByb21pc2UsSU5URVJOQUwpO1xucmVxdWlyZSgnLi9maWx0ZXIuanMnKShQcm9taXNlLElOVEVSTkFMKTtcbnJlcXVpcmUoJy4vYW55LmpzJykoUHJvbWlzZSxQcm9taXNlQXJyYXkpO1xucmVxdWlyZSgnLi9lYWNoLmpzJykoUHJvbWlzZSxJTlRFUk5BTCk7XG5yZXF1aXJlKCcuL3VzaW5nLmpzJykoUHJvbWlzZSxhcGlSZWplY3Rpb24sY2FzdCk7XG5cblByb21pc2UucHJvdG90eXBlID0gUHJvbWlzZS5wcm90b3R5cGU7XG5yZXR1cm4gUHJvbWlzZTtcblxufTtcblxufSkocmVxdWlyZShcIl9fYnJvd3NlcmlmeV9wcm9jZXNzXCIpKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfXG4pIHtcblxuICAvKipcbiAgICogQSBiYXNpYyBSZWYgc2VydmVzIGFzIGEgbWVhbnMgb2YgaW5kaXJlY3Rpb24gYmV0d2VlbiByZWZlcmVuY2VzIGFuZCB0aGVpclxuICAgKiB2YWx1ZXMsIGFsbG93aW5nIGFuIG91dHNpZGUgYWdlbnQgdG8gbW9kaWZ5IHRoZSB1bmRlcmx5aW5nIHZhbHVlLlxuICAgKi9cbiAgdmFyIFJlZiA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKFJlZi5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbih2YWwpIHtcbiAgICAgIHRoaXMuX3ZhbCA9IHZhbDtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSB2YWx1ZSBib3hlZCBieSB0aGlzIFJlZlxuICAgICAqXG4gICAgICogQHJldHVybnMge2R5bmFtaWN9XG4gICAgICovXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl92YWw7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFNldCBhIG5ldyBib3hlZCB2YWx1ZS4gTm90ZSB0aGlzIG1ldGhvZCBpcyBzcGVjaWZpYyB0byB0aGlzIFJlZlxuICAgICAqIGltcGxlbWVudGF0aW9uLCBhbmQgbm90IHRoZSBSZWYgcHJvdG9jb2wsIHdoaWNoIG9ubHkgZGVmaW5lc1xuICAgICAqIGBSZWYjZ2V0KClgLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5ld1ZhbCB7ZHluYW1pY30gdGhlIHZhbHVlIHRvIGJveFxuICAgICAqL1xuICAgIHNldDogZnVuY3Rpb24obmV3VmFsKSB7XG4gICAgICBpZiAobmV3VmFsIGluc3RhbmNlb2YgUmVmKSB7XG4gICAgICAgIHRoaXMuX3ZhbCA9IG5ld1ZhbC5nZXQoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX3ZhbCA9IG5ld1ZhbDtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBSZWY7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgX1xuKSB7XG5cbiAgLyoqXG4gICAqIEEgcmVmIHdob3NlIGJveGVkIHZhbHVlIGlzIGFub3RoZXIgcmVmXG4gICAqL1xuICB2YXIgRGVsZWdhdGluZ1JlZiA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKERlbGVnYXRpbmdSZWYucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ocmVmKSB7XG4gICAgICB0aGlzLl9kZWxlZ2F0ZVJlZiA9IHJlZjtcbiAgICB9LFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fZGVsZWdhdGVSZWYuZ2V0KCk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gRGVsZWdhdGluZ1JlZjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKVxuKTtcblxufSkoKSIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UpIHtcbmZ1bmN0aW9uIFByb21pc2VJbnNwZWN0aW9uKHByb21pc2UpIHtcbiAgICBpZiAocHJvbWlzZSAhPT0gdm9pZCAwKSB7XG4gICAgICAgIHRoaXMuX2JpdEZpZWxkID0gcHJvbWlzZS5fYml0RmllbGQ7XG4gICAgICAgIHRoaXMuX3NldHRsZWRWYWx1ZSA9IHByb21pc2UuaXNSZXNvbHZlZCgpXG4gICAgICAgICAgICA/IHByb21pc2UuX3NldHRsZWRWYWx1ZVxuICAgICAgICAgICAgOiB2b2lkIDA7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB0aGlzLl9iaXRGaWVsZCA9IDA7XG4gICAgICAgIHRoaXMuX3NldHRsZWRWYWx1ZSA9IHZvaWQgMDtcbiAgICB9XG59XG5cblByb21pc2VJbnNwZWN0aW9uLnByb3RvdHlwZS5pc0Z1bGZpbGxlZCA9XG5Qcm9taXNlLnByb3RvdHlwZS5pc0Z1bGZpbGxlZCA9IGZ1bmN0aW9uIFByb21pc2UkaXNGdWxmaWxsZWQoKSB7XG4gICAgcmV0dXJuICh0aGlzLl9iaXRGaWVsZCAmIDI2ODQzNTQ1NikgPiAwO1xufTtcblxuUHJvbWlzZUluc3BlY3Rpb24ucHJvdG90eXBlLmlzUmVqZWN0ZWQgPVxuUHJvbWlzZS5wcm90b3R5cGUuaXNSZWplY3RlZCA9IGZ1bmN0aW9uIFByb21pc2UkaXNSZWplY3RlZCgpIHtcbiAgICByZXR1cm4gKHRoaXMuX2JpdEZpZWxkICYgMTM0MjE3NzI4KSA+IDA7XG59O1xuXG5Qcm9taXNlSW5zcGVjdGlvbi5wcm90b3R5cGUuaXNQZW5kaW5nID1cblByb21pc2UucHJvdG90eXBlLmlzUGVuZGluZyA9IGZ1bmN0aW9uIFByb21pc2UkaXNQZW5kaW5nKCkge1xuICAgIHJldHVybiAodGhpcy5fYml0RmllbGQgJiA0MDI2NTMxODQpID09PSAwO1xufTtcblxuUHJvbWlzZUluc3BlY3Rpb24ucHJvdG90eXBlLnZhbHVlID1cblByb21pc2UucHJvdG90eXBlLnZhbHVlID0gZnVuY3Rpb24gUHJvbWlzZSR2YWx1ZSgpIHtcbiAgICBpZiAoIXRoaXMuaXNGdWxmaWxsZWQoKSkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiY2Fubm90IGdldCBmdWxmaWxsbWVudCB2YWx1ZSBvZiBhIG5vbi1mdWxmaWxsZWQgcHJvbWlzZVwiKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuX3NldHRsZWRWYWx1ZTtcbn07XG5cblByb21pc2VJbnNwZWN0aW9uLnByb3RvdHlwZS5lcnJvciA9XG5Qcm9taXNlSW5zcGVjdGlvbi5wcm90b3R5cGUucmVhc29uID1cblByb21pc2UucHJvdG90eXBlLnJlYXNvbiA9IGZ1bmN0aW9uIFByb21pc2UkcmVhc29uKCkge1xuICAgIGlmICghdGhpcy5pc1JlamVjdGVkKCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcImNhbm5vdCBnZXQgcmVqZWN0aW9uIHJlYXNvbiBvZiBhIG5vbi1yZWplY3RlZCBwcm9taXNlXCIpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5fc2V0dGxlZFZhbHVlO1xufTtcblxuUHJvbWlzZUluc3BlY3Rpb24ucHJvdG90eXBlLmlzUmVzb2x2ZWQgPVxuUHJvbWlzZS5wcm90b3R5cGUuaXNSZXNvbHZlZCA9IGZ1bmN0aW9uIFByb21pc2UkaXNSZXNvbHZlZCgpIHtcbiAgICByZXR1cm4gKHRoaXMuX2JpdEZpZWxkICYgNDAyNjUzMTg0KSA+IDA7XG59O1xuXG5Qcm9taXNlLlByb21pc2VJbnNwZWN0aW9uID0gUHJvbWlzZUluc3BlY3Rpb247XG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSwgSU5URVJOQUwpIHtcbnZhciBQcm9taXNlTWFwID0gUHJvbWlzZS5tYXA7XG5cblByb21pc2UucHJvdG90eXBlLmZpbHRlciA9IGZ1bmN0aW9uIFByb21pc2UkZmlsdGVyKGZuLCBvcHRpb25zKSB7XG4gICAgcmV0dXJuIFByb21pc2VNYXAodGhpcywgZm4sIG9wdGlvbnMsIElOVEVSTkFMKTtcbn07XG5cblByb21pc2UuZmlsdGVyID0gZnVuY3Rpb24gUHJvbWlzZSRGaWx0ZXIocHJvbWlzZXMsIGZuLCBvcHRpb25zKSB7XG4gICAgcmV0dXJuIFByb21pc2VNYXAocHJvbWlzZXMsIGZuLCBvcHRpb25zLCBJTlRFUk5BTCk7XG59O1xufTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UpIHtcbnZhciBTb21lUHJvbWlzZUFycmF5ID0gUHJvbWlzZS5fU29tZVByb21pc2VBcnJheTtcbmZ1bmN0aW9uIFByb21pc2UkX0FueShwcm9taXNlcykge1xuICAgIHZhciByZXQgPSBuZXcgU29tZVByb21pc2VBcnJheShwcm9taXNlcyk7XG4gICAgdmFyIHByb21pc2UgPSByZXQucHJvbWlzZSgpO1xuICAgIGlmIChwcm9taXNlLmlzUmVqZWN0ZWQoKSkge1xuICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICB9XG4gICAgcmV0LnNldEhvd01hbnkoMSk7XG4gICAgcmV0LnNldFVud3JhcCgpO1xuICAgIHJldC5pbml0KCk7XG4gICAgcmV0dXJuIHByb21pc2U7XG59XG5cblByb21pc2UuYW55ID0gZnVuY3Rpb24gUHJvbWlzZSRBbnkocHJvbWlzZXMpIHtcbiAgICByZXR1cm4gUHJvbWlzZSRfQW55KHByb21pc2VzKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLmFueSA9IGZ1bmN0aW9uIFByb21pc2UkYW55KCkge1xuICAgIHJldHVybiBQcm9taXNlJF9BbnkodGhpcyk7XG59O1xuXG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSwgSU5URVJOQUwpIHtcbnZhciBQcm9taXNlUmVkdWNlID0gUHJvbWlzZS5yZWR1Y2U7XG5cblByb21pc2UucHJvdG90eXBlLmVhY2ggPSBmdW5jdGlvbiBQcm9taXNlJGVhY2goZm4pIHtcbiAgICByZXR1cm4gUHJvbWlzZVJlZHVjZSh0aGlzLCBmbiwgbnVsbCwgSU5URVJOQUwpO1xufTtcblxuUHJvbWlzZS5lYWNoID0gZnVuY3Rpb24gUHJvbWlzZSRFYWNoKHByb21pc2VzLCBmbikge1xuICAgIHJldHVybiBQcm9taXNlUmVkdWNlKHByb21pc2VzLCBmbiwgbnVsbCwgSU5URVJOQUwpO1xufTtcbn07XG4iLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfXG4pIHtcblxuICB2YXIgU2V0VGltZW91dFNjaGVkdWxlciA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9XG5cbiAgXy5leHRlbmQoU2V0VGltZW91dFNjaGVkdWxlci5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbigpIHt9LFxuXG4gICAgcnVuU29vbjogZnVuY3Rpb24oZm4pIHtcbiAgICAgIHRoaXMuc2NoZWR1bGUoZm4pO1xuICAgIH0sXG4gICAgc2NoZWR1bGU6IGZ1bmN0aW9uKGZuLCBkZWxheSkge1xuICAgICAgZGVsYXkgPSBkZWxheSB8fCAxO1xuICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZm4sIGRlbGF5KTtcbiAgICB9LFxuXG4gICAgdW5zY2hlZHVsZTogZnVuY3Rpb24oaWQpIHtcbiAgICAgIHJldHVybiBjbGVhclRpbWVvdXQoaWQpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIFNldFRpbWVvdXRTY2hlZHVsZXI7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIilcbik7XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xudmFyIGVzNSA9IHJlcXVpcmUoXCIuL2VzNS5qc1wiKTtcbnZhciBoYXZlR2V0dGVycyA9IChmdW5jdGlvbigpe1xuICAgIHRyeSB7XG4gICAgICAgIHZhciBvID0ge307XG4gICAgICAgIGVzNS5kZWZpbmVQcm9wZXJ0eShvLCBcImZcIiwge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gby5mID09PSAzO1xuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG59KSgpO1xudmFyIGNhbkV2YWx1YXRlID0gdHlwZW9mIG5hdmlnYXRvciA9PSBcInVuZGVmaW5lZFwiO1xudmFyIGVycm9yT2JqID0ge2U6IHt9fTtcbmZ1bmN0aW9uIHRyeUNhdGNoMShmbiwgcmVjZWl2ZXIsIGFyZykge1xuICAgIHRyeSB7IHJldHVybiBmbi5jYWxsKHJlY2VpdmVyLCBhcmcpOyB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgZXJyb3JPYmouZSA9IGU7XG4gICAgICAgIHJldHVybiBlcnJvck9iajtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHRyeUNhdGNoMihmbiwgcmVjZWl2ZXIsIGFyZywgYXJnMikge1xuICAgIHRyeSB7IHJldHVybiBmbi5jYWxsKHJlY2VpdmVyLCBhcmcsIGFyZzIpOyB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgZXJyb3JPYmouZSA9IGU7XG4gICAgICAgIHJldHVybiBlcnJvck9iajtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHRyeUNhdGNoMyhmbiwgcmVjZWl2ZXIsIGFyZywgYXJnMiwgYXJnMykge1xuICAgIHRyeSB7IHJldHVybiBmbi5jYWxsKHJlY2VpdmVyLCBhcmcsIGFyZzIsIGFyZzMpOyB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgZXJyb3JPYmouZSA9IGU7XG4gICAgICAgIHJldHVybiBlcnJvck9iajtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHRyeUNhdGNoNChmbiwgcmVjZWl2ZXIsIGFyZywgYXJnMiwgYXJnMywgYXJnNCkge1xuICAgIHRyeSB7IHJldHVybiBmbi5jYWxsKHJlY2VpdmVyLCBhcmcsIGFyZzIsIGFyZzMsIGFyZzQpOyB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgZXJyb3JPYmouZSA9IGU7XG4gICAgICAgIHJldHVybiBlcnJvck9iajtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHRyeUNhdGNoQXBwbHkoZm4sIGFyZ3MsIHJlY2VpdmVyKSB7XG4gICAgdHJ5IHsgcmV0dXJuIGZuLmFwcGx5KHJlY2VpdmVyLCBhcmdzKTsgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIGVycm9yT2JqLmUgPSBlO1xuICAgICAgICByZXR1cm4gZXJyb3JPYmo7XG4gICAgfVxufVxuXG52YXIgaW5oZXJpdHMgPSBmdW5jdGlvbihDaGlsZCwgUGFyZW50KSB7XG4gICAgdmFyIGhhc1Byb3AgPSB7fS5oYXNPd25Qcm9wZXJ0eTtcblxuICAgIGZ1bmN0aW9uIFQoKSB7XG4gICAgICAgIHRoaXMuY29uc3RydWN0b3IgPSBDaGlsZDtcbiAgICAgICAgdGhpcy5jb25zdHJ1Y3RvciQgPSBQYXJlbnQ7XG4gICAgICAgIGZvciAodmFyIHByb3BlcnR5TmFtZSBpbiBQYXJlbnQucHJvdG90eXBlKSB7XG4gICAgICAgICAgICBpZiAoaGFzUHJvcC5jYWxsKFBhcmVudC5wcm90b3R5cGUsIHByb3BlcnR5TmFtZSkgJiZcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eU5hbWUuY2hhckF0KHByb3BlcnR5TmFtZS5sZW5ndGgtMSkgIT09IFwiJFwiXG4gICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIHRoaXNbcHJvcGVydHlOYW1lICsgXCIkXCJdID0gUGFyZW50LnByb3RvdHlwZVtwcm9wZXJ0eU5hbWVdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIFQucHJvdG90eXBlID0gUGFyZW50LnByb3RvdHlwZTtcbiAgICBDaGlsZC5wcm90b3R5cGUgPSBuZXcgVCgpO1xuICAgIHJldHVybiBDaGlsZC5wcm90b3R5cGU7XG59O1xuXG5mdW5jdGlvbiBhc1N0cmluZyh2YWwpIHtcbiAgICByZXR1cm4gdHlwZW9mIHZhbCA9PT0gXCJzdHJpbmdcIiA/IHZhbCA6IChcIlwiICsgdmFsKTtcbn1cblxuZnVuY3Rpb24gaXNQcmltaXRpdmUodmFsKSB7XG4gICAgcmV0dXJuIHZhbCA9PSBudWxsIHx8IHZhbCA9PT0gdHJ1ZSB8fCB2YWwgPT09IGZhbHNlIHx8XG4gICAgICAgIHR5cGVvZiB2YWwgPT09IFwic3RyaW5nXCIgfHwgdHlwZW9mIHZhbCA9PT0gXCJudW1iZXJcIjtcblxufVxuXG5mdW5jdGlvbiBpc09iamVjdCh2YWx1ZSkge1xuICAgIHJldHVybiAhaXNQcmltaXRpdmUodmFsdWUpO1xufVxuXG5mdW5jdGlvbiBtYXliZVdyYXBBc0Vycm9yKG1heWJlRXJyb3IpIHtcbiAgICBpZiAoIWlzUHJpbWl0aXZlKG1heWJlRXJyb3IpKSByZXR1cm4gbWF5YmVFcnJvcjtcblxuICAgIHJldHVybiBuZXcgRXJyb3IoYXNTdHJpbmcobWF5YmVFcnJvcikpO1xufVxuXG5mdW5jdGlvbiB3aXRoQXBwZW5kZWQodGFyZ2V0LCBhcHBlbmRlZSkge1xuICAgIHZhciBsZW4gPSB0YXJnZXQubGVuZ3RoO1xuICAgIHZhciByZXQgPSBuZXcgQXJyYXkobGVuICsgMSk7XG4gICAgdmFyIGk7XG4gICAgZm9yIChpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgIHJldFtpXSA9IHRhcmdldFtpXTtcbiAgICB9XG4gICAgcmV0W2ldID0gYXBwZW5kZWU7XG4gICAgcmV0dXJuIHJldDtcbn1cblxuZnVuY3Rpb24gZ2V0RGF0YVByb3BlcnR5T3JEZWZhdWx0KG9iaiwga2V5LCBkZWZhdWx0VmFsdWUpIHtcbiAgICBpZiAoZXM1LmlzRVM1KSB7XG4gICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSk7XG4gICAgICAgIGlmIChkZXNjICE9IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybiBkZXNjLmdldCA9PSBudWxsICYmIGRlc2Muc2V0ID09IG51bGxcbiAgICAgICAgICAgICAgICAgICAgPyBkZXNjLnZhbHVlXG4gICAgICAgICAgICAgICAgICAgIDogZGVmYXVsdFZhbHVlO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHt9Lmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpID8gb2JqW2tleV0gOiB2b2lkIDA7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBub3RFbnVtZXJhYmxlUHJvcChvYmosIG5hbWUsIHZhbHVlKSB7XG4gICAgaWYgKGlzUHJpbWl0aXZlKG9iaikpIHJldHVybiBvYmo7XG4gICAgdmFyIGRlc2NyaXB0b3IgPSB7XG4gICAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgd3JpdGFibGU6IHRydWVcbiAgICB9O1xuICAgIGVzNS5kZWZpbmVQcm9wZXJ0eShvYmosIG5hbWUsIGRlc2NyaXB0b3IpO1xuICAgIHJldHVybiBvYmo7XG59XG5cblxudmFyIHdyYXBzUHJpbWl0aXZlUmVjZWl2ZXIgPSAoZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMgIT09IFwic3RyaW5nXCI7XG59KS5jYWxsKFwic3RyaW5nXCIpO1xuXG5mdW5jdGlvbiB0aHJvd2VyKHIpIHtcbiAgICB0aHJvdyByO1xufVxuXG52YXIgaW5oZXJpdGVkRGF0YUtleXMgPSAoZnVuY3Rpb24oKSB7XG4gICAgaWYgKGVzNS5pc0VTNSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24ob2JqLCBvcHRzKSB7XG4gICAgICAgICAgICB2YXIgcmV0ID0gW107XG4gICAgICAgICAgICB2YXIgdmlzaXRlZEtleXMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgICAgICAgICAgdmFyIGdldEtleXMgPSBPYmplY3Qob3B0cykuaW5jbHVkZUhpZGRlblxuICAgICAgICAgICAgICAgID8gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXNcbiAgICAgICAgICAgICAgICA6IE9iamVjdC5rZXlzO1xuICAgICAgICAgICAgd2hpbGUgKG9iaiAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdmFyIGtleXM7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAga2V5cyA9IGdldEtleXMob2JqKTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIga2V5ID0ga2V5c1tpXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZpc2l0ZWRLZXlzW2tleV0pIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICB2aXNpdGVkS2V5c1trZXldID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRlc2MgIT0gbnVsbCAmJiBkZXNjLmdldCA9PSBudWxsICYmIGRlc2Muc2V0ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldC5wdXNoKGtleSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgb2JqID0gZXM1LmdldFByb3RvdHlwZU9mKG9iaik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbihvYmopIHtcbiAgICAgICAgICAgIHZhciByZXQgPSBbXTtcbiAgICAgICAgICAgIC8qanNoaW50IGZvcmluOmZhbHNlICovXG4gICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG4gICAgICAgICAgICAgICAgcmV0LnB1c2goa2V5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgIH07XG4gICAgfVxuXG59KSgpO1xuXG5mdW5jdGlvbiBpc0NsYXNzKGZuKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKHR5cGVvZiBmbiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICB2YXIga2V5cyA9IGVzNS5rZXlzKGZuLnByb3RvdHlwZSk7XG4gICAgICAgICAgICByZXR1cm4ga2V5cy5sZW5ndGggPiAwICYmXG4gICAgICAgICAgICAgICAgICAgIShrZXlzLmxlbmd0aCA9PT0gMSAmJiBrZXlzWzBdID09PSBcImNvbnN0cnVjdG9yXCIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHRvRmFzdFByb3BlcnRpZXMob2JqKSB7XG4gICAgLypqc2hpbnQgLVcwMjcqL1xuICAgIGZ1bmN0aW9uIGYoKSB7fVxuICAgIGYucHJvdG90eXBlID0gb2JqO1xuICAgIHJldHVybiBmO1xuICAgIGV2YWwob2JqKTtcbn1cblxudmFyIHJpZGVudCA9IC9eW2EteiRfXVthLXokXzAtOV0qJC9pO1xuZnVuY3Rpb24gaXNJZGVudGlmaWVyKHN0cikge1xuICAgIHJldHVybiByaWRlbnQudGVzdChzdHIpO1xufVxuXG5mdW5jdGlvbiBmaWxsZWRSYW5nZShjb3VudCwgcHJlZml4LCBzdWZmaXgpIHtcbiAgICB2YXIgcmV0ID0gbmV3IEFycmF5KGNvdW50KTtcbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgY291bnQ7ICsraSkge1xuICAgICAgICByZXRbaV0gPSBwcmVmaXggKyBpICsgc3VmZml4O1xuICAgIH1cbiAgICByZXR1cm4gcmV0O1xufVxuXG52YXIgcmV0ID0ge1xuICAgIGlzQ2xhc3M6IGlzQ2xhc3MsXG4gICAgaXNJZGVudGlmaWVyOiBpc0lkZW50aWZpZXIsXG4gICAgaW5oZXJpdGVkRGF0YUtleXM6IGluaGVyaXRlZERhdGFLZXlzLFxuICAgIGdldERhdGFQcm9wZXJ0eU9yRGVmYXVsdDogZ2V0RGF0YVByb3BlcnR5T3JEZWZhdWx0LFxuICAgIHRocm93ZXI6IHRocm93ZXIsXG4gICAgaXNBcnJheTogZXM1LmlzQXJyYXksXG4gICAgaGF2ZUdldHRlcnM6IGhhdmVHZXR0ZXJzLFxuICAgIG5vdEVudW1lcmFibGVQcm9wOiBub3RFbnVtZXJhYmxlUHJvcCxcbiAgICBpc1ByaW1pdGl2ZTogaXNQcmltaXRpdmUsXG4gICAgaXNPYmplY3Q6IGlzT2JqZWN0LFxuICAgIGNhbkV2YWx1YXRlOiBjYW5FdmFsdWF0ZSxcbiAgICBlcnJvck9iajogZXJyb3JPYmosXG4gICAgdHJ5Q2F0Y2gxOiB0cnlDYXRjaDEsXG4gICAgdHJ5Q2F0Y2gyOiB0cnlDYXRjaDIsXG4gICAgdHJ5Q2F0Y2gzOiB0cnlDYXRjaDMsXG4gICAgdHJ5Q2F0Y2g0OiB0cnlDYXRjaDQsXG4gICAgdHJ5Q2F0Y2hBcHBseTogdHJ5Q2F0Y2hBcHBseSxcbiAgICBpbmhlcml0czogaW5oZXJpdHMsXG4gICAgd2l0aEFwcGVuZGVkOiB3aXRoQXBwZW5kZWQsXG4gICAgYXNTdHJpbmc6IGFzU3RyaW5nLFxuICAgIG1heWJlV3JhcEFzRXJyb3I6IG1heWJlV3JhcEFzRXJyb3IsXG4gICAgd3JhcHNQcmltaXRpdmVSZWNlaXZlcjogd3JhcHNQcmltaXRpdmVSZWNlaXZlcixcbiAgICB0b0Zhc3RQcm9wZXJ0aWVzOiB0b0Zhc3RQcm9wZXJ0aWVzLFxuICAgIGZpbGxlZFJhbmdlOiBmaWxsZWRSYW5nZVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSByZXQ7XG4iLCIoZnVuY3Rpb24ocHJvY2Vzcyl7LyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbnZhciBzY2hlZHVsZSA9IHJlcXVpcmUoXCIuL3NjaGVkdWxlLmpzXCIpO1xudmFyIFF1ZXVlID0gcmVxdWlyZShcIi4vcXVldWUuanNcIik7XG52YXIgZXJyb3JPYmogPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpLmVycm9yT2JqO1xudmFyIHRyeUNhdGNoMSA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIikudHJ5Q2F0Y2gxO1xudmFyIF9wcm9jZXNzID0gdHlwZW9mIHByb2Nlc3MgIT09IFwidW5kZWZpbmVkXCIgPyBwcm9jZXNzIDogdm9pZCAwO1xuXG5mdW5jdGlvbiBBc3luYygpIHtcbiAgICB0aGlzLl9pc1RpY2tVc2VkID0gZmFsc2U7XG4gICAgdGhpcy5fc2NoZWR1bGUgPSBzY2hlZHVsZTtcbiAgICB0aGlzLl9sZW5ndGggPSAwO1xuICAgIHRoaXMuX2xhdGVCdWZmZXIgPSBuZXcgUXVldWUoMTYpO1xuICAgIHRoaXMuX2Z1bmN0aW9uQnVmZmVyID0gbmV3IFF1ZXVlKDY1NTM2KTtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdGhpcy5jb25zdW1lRnVuY3Rpb25CdWZmZXIgPSBmdW5jdGlvbiBBc3luYyRjb25zdW1lRnVuY3Rpb25CdWZmZXIoKSB7XG4gICAgICAgIHNlbGYuX2NvbnN1bWVGdW5jdGlvbkJ1ZmZlcigpO1xuICAgIH07XG59XG5cbkFzeW5jLnByb3RvdHlwZS5oYXZlSXRlbXNRdWV1ZWQgPSBmdW5jdGlvbiBBc3luYyRoYXZlSXRlbXNRdWV1ZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2xlbmd0aCA+IDA7XG59O1xuXG5Bc3luYy5wcm90b3R5cGUuaW52b2tlTGF0ZXIgPSBmdW5jdGlvbiBBc3luYyRpbnZva2VMYXRlcihmbiwgcmVjZWl2ZXIsIGFyZykge1xuICAgIGlmIChfcHJvY2VzcyAhPT0gdm9pZCAwICYmXG4gICAgICAgIF9wcm9jZXNzLmRvbWFpbiAhPSBudWxsICYmXG4gICAgICAgICFmbi5kb21haW4pIHtcbiAgICAgICAgZm4gPSBfcHJvY2Vzcy5kb21haW4uYmluZChmbik7XG4gICAgfVxuICAgIHRoaXMuX2xhdGVCdWZmZXIucHVzaChmbiwgcmVjZWl2ZXIsIGFyZyk7XG4gICAgdGhpcy5fcXVldWVUaWNrKCk7XG59O1xuXG5Bc3luYy5wcm90b3R5cGUuaW52b2tlID0gZnVuY3Rpb24gQXN5bmMkaW52b2tlKGZuLCByZWNlaXZlciwgYXJnKSB7XG4gICAgaWYgKF9wcm9jZXNzICE9PSB2b2lkIDAgJiZcbiAgICAgICAgX3Byb2Nlc3MuZG9tYWluICE9IG51bGwgJiZcbiAgICAgICAgIWZuLmRvbWFpbikge1xuICAgICAgICBmbiA9IF9wcm9jZXNzLmRvbWFpbi5iaW5kKGZuKTtcbiAgICB9XG4gICAgdmFyIGZ1bmN0aW9uQnVmZmVyID0gdGhpcy5fZnVuY3Rpb25CdWZmZXI7XG4gICAgZnVuY3Rpb25CdWZmZXIucHVzaChmbiwgcmVjZWl2ZXIsIGFyZyk7XG4gICAgdGhpcy5fbGVuZ3RoID0gZnVuY3Rpb25CdWZmZXIubGVuZ3RoKCk7XG4gICAgdGhpcy5fcXVldWVUaWNrKCk7XG59O1xuXG5Bc3luYy5wcm90b3R5cGUuX2NvbnN1bWVGdW5jdGlvbkJ1ZmZlciA9XG5mdW5jdGlvbiBBc3luYyRfY29uc3VtZUZ1bmN0aW9uQnVmZmVyKCkge1xuICAgIHZhciBmdW5jdGlvbkJ1ZmZlciA9IHRoaXMuX2Z1bmN0aW9uQnVmZmVyO1xuICAgIHdoaWxlIChmdW5jdGlvbkJ1ZmZlci5sZW5ndGgoKSA+IDApIHtcbiAgICAgICAgdmFyIGZuID0gZnVuY3Rpb25CdWZmZXIuc2hpZnQoKTtcbiAgICAgICAgdmFyIHJlY2VpdmVyID0gZnVuY3Rpb25CdWZmZXIuc2hpZnQoKTtcbiAgICAgICAgdmFyIGFyZyA9IGZ1bmN0aW9uQnVmZmVyLnNoaWZ0KCk7XG4gICAgICAgIGZuLmNhbGwocmVjZWl2ZXIsIGFyZyk7XG4gICAgfVxuICAgIHRoaXMuX3Jlc2V0KCk7XG4gICAgdGhpcy5fY29uc3VtZUxhdGVCdWZmZXIoKTtcbn07XG5cbkFzeW5jLnByb3RvdHlwZS5fY29uc3VtZUxhdGVCdWZmZXIgPSBmdW5jdGlvbiBBc3luYyRfY29uc3VtZUxhdGVCdWZmZXIoKSB7XG4gICAgdmFyIGJ1ZmZlciA9IHRoaXMuX2xhdGVCdWZmZXI7XG4gICAgd2hpbGUoYnVmZmVyLmxlbmd0aCgpID4gMCkge1xuICAgICAgICB2YXIgZm4gPSBidWZmZXIuc2hpZnQoKTtcbiAgICAgICAgdmFyIHJlY2VpdmVyID0gYnVmZmVyLnNoaWZ0KCk7XG4gICAgICAgIHZhciBhcmcgPSBidWZmZXIuc2hpZnQoKTtcbiAgICAgICAgdmFyIHJlcyA9IHRyeUNhdGNoMShmbiwgcmVjZWl2ZXIsIGFyZyk7XG4gICAgICAgIGlmIChyZXMgPT09IGVycm9yT2JqKSB7XG4gICAgICAgICAgICB0aGlzLl9xdWV1ZVRpY2soKTtcbiAgICAgICAgICAgIGlmIChmbi5kb21haW4gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGZuLmRvbWFpbi5lbWl0KFwiZXJyb3JcIiwgcmVzLmUpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyByZXMuZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn07XG5cbkFzeW5jLnByb3RvdHlwZS5fcXVldWVUaWNrID0gZnVuY3Rpb24gQXN5bmMkX3F1ZXVlKCkge1xuICAgIGlmICghdGhpcy5faXNUaWNrVXNlZCkge1xuICAgICAgICB0aGlzLl9zY2hlZHVsZSh0aGlzLmNvbnN1bWVGdW5jdGlvbkJ1ZmZlcik7XG4gICAgICAgIHRoaXMuX2lzVGlja1VzZWQgPSB0cnVlO1xuICAgIH1cbn07XG5cbkFzeW5jLnByb3RvdHlwZS5fcmVzZXQgPSBmdW5jdGlvbiBBc3luYyRfcmVzZXQoKSB7XG4gICAgdGhpcy5faXNUaWNrVXNlZCA9IGZhbHNlO1xuICAgIHRoaXMuX2xlbmd0aCA9IDA7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBBc3luYygpO1xuXG59KShyZXF1aXJlKFwiX19icm93c2VyaWZ5X3Byb2Nlc3NcIikpIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbnZhciBPYmplY3RmcmVlemUgPSByZXF1aXJlKFwiLi9lczUuanNcIikuZnJlZXplO1xudmFyIHV0aWwgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpO1xudmFyIGluaGVyaXRzID0gdXRpbC5pbmhlcml0cztcbnZhciBub3RFbnVtZXJhYmxlUHJvcCA9IHV0aWwubm90RW51bWVyYWJsZVByb3A7XG5cbmZ1bmN0aW9uIG1hcmtBc09yaWdpbmF0aW5nRnJvbVJlamVjdGlvbihlKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgbm90RW51bWVyYWJsZVByb3AoZSwgXCJpc09wZXJhdGlvbmFsXCIsIHRydWUpO1xuICAgIH1cbiAgICBjYXRjaChpZ25vcmUpIHt9XG59XG5cbmZ1bmN0aW9uIG9yaWdpbmF0ZXNGcm9tUmVqZWN0aW9uKGUpIHtcbiAgICBpZiAoZSA9PSBudWxsKSByZXR1cm4gZmFsc2U7XG4gICAgcmV0dXJuICgoZSBpbnN0YW5jZW9mIE9wZXJhdGlvbmFsRXJyb3IpIHx8XG4gICAgICAgIGVbXCJpc09wZXJhdGlvbmFsXCJdID09PSB0cnVlKTtcbn1cblxuZnVuY3Rpb24gaXNFcnJvcihvYmopIHtcbiAgICByZXR1cm4gb2JqIGluc3RhbmNlb2YgRXJyb3I7XG59XG5cbmZ1bmN0aW9uIGNhbkF0dGFjaChvYmopIHtcbiAgICByZXR1cm4gaXNFcnJvcihvYmopO1xufVxuXG5mdW5jdGlvbiBzdWJFcnJvcihuYW1lUHJvcGVydHksIGRlZmF1bHRNZXNzYWdlKSB7XG4gICAgZnVuY3Rpb24gU3ViRXJyb3IobWVzc2FnZSkge1xuICAgICAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgU3ViRXJyb3IpKSByZXR1cm4gbmV3IFN1YkVycm9yKG1lc3NhZ2UpO1xuICAgICAgICB0aGlzLm1lc3NhZ2UgPSB0eXBlb2YgbWVzc2FnZSA9PT0gXCJzdHJpbmdcIiA/IG1lc3NhZ2UgOiBkZWZhdWx0TWVzc2FnZTtcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZVByb3BlcnR5O1xuICAgICAgICBpZiAoRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UpIHtcbiAgICAgICAgICAgIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKHRoaXMsIHRoaXMuY29uc3RydWN0b3IpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGluaGVyaXRzKFN1YkVycm9yLCBFcnJvcik7XG4gICAgcmV0dXJuIFN1YkVycm9yO1xufVxuXG52YXIgX1R5cGVFcnJvciwgX1JhbmdlRXJyb3I7XG52YXIgQ2FuY2VsbGF0aW9uRXJyb3IgPSBzdWJFcnJvcihcIkNhbmNlbGxhdGlvbkVycm9yXCIsIFwiY2FuY2VsbGF0aW9uIGVycm9yXCIpO1xudmFyIFRpbWVvdXRFcnJvciA9IHN1YkVycm9yKFwiVGltZW91dEVycm9yXCIsIFwidGltZW91dCBlcnJvclwiKTtcbnZhciBBZ2dyZWdhdGVFcnJvciA9IHN1YkVycm9yKFwiQWdncmVnYXRlRXJyb3JcIiwgXCJhZ2dyZWdhdGUgZXJyb3JcIik7XG50cnkge1xuICAgIF9UeXBlRXJyb3IgPSBUeXBlRXJyb3I7XG4gICAgX1JhbmdlRXJyb3IgPSBSYW5nZUVycm9yO1xufSBjYXRjaChlKSB7XG4gICAgX1R5cGVFcnJvciA9IHN1YkVycm9yKFwiVHlwZUVycm9yXCIsIFwidHlwZSBlcnJvclwiKTtcbiAgICBfUmFuZ2VFcnJvciA9IHN1YkVycm9yKFwiUmFuZ2VFcnJvclwiLCBcInJhbmdlIGVycm9yXCIpO1xufVxuXG52YXIgbWV0aG9kcyA9IChcImpvaW4gcG9wIHB1c2ggc2hpZnQgdW5zaGlmdCBzbGljZSBmaWx0ZXIgZm9yRWFjaCBzb21lIFwiICtcbiAgICBcImV2ZXJ5IG1hcCBpbmRleE9mIGxhc3RJbmRleE9mIHJlZHVjZSByZWR1Y2VSaWdodCBzb3J0IHJldmVyc2VcIikuc3BsaXQoXCIgXCIpO1xuXG5mb3IgKHZhciBpID0gMDsgaSA8IG1ldGhvZHMubGVuZ3RoOyArK2kpIHtcbiAgICBpZiAodHlwZW9mIEFycmF5LnByb3RvdHlwZVttZXRob2RzW2ldXSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIEFnZ3JlZ2F0ZUVycm9yLnByb3RvdHlwZVttZXRob2RzW2ldXSA9IEFycmF5LnByb3RvdHlwZVttZXRob2RzW2ldXTtcbiAgICB9XG59XG5cbkFnZ3JlZ2F0ZUVycm9yLnByb3RvdHlwZS5sZW5ndGggPSAwO1xuQWdncmVnYXRlRXJyb3IucHJvdG90eXBlW1wiaXNPcGVyYXRpb25hbFwiXSA9IHRydWU7XG52YXIgbGV2ZWwgPSAwO1xuQWdncmVnYXRlRXJyb3IucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGluZGVudCA9IEFycmF5KGxldmVsICogNCArIDEpLmpvaW4oXCIgXCIpO1xuICAgIHZhciByZXQgPSBcIlxcblwiICsgaW5kZW50ICsgXCJBZ2dyZWdhdGVFcnJvciBvZjpcIiArIFwiXFxuXCI7XG4gICAgbGV2ZWwrKztcbiAgICBpbmRlbnQgPSBBcnJheShsZXZlbCAqIDQgKyAxKS5qb2luKFwiIFwiKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgdmFyIHN0ciA9IHRoaXNbaV0gPT09IHRoaXMgPyBcIltDaXJjdWxhciBBZ2dyZWdhdGVFcnJvcl1cIiA6IHRoaXNbaV0gKyBcIlwiO1xuICAgICAgICB2YXIgbGluZXMgPSBzdHIuc3BsaXQoXCJcXG5cIik7XG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbGluZXMubGVuZ3RoOyArK2opIHtcbiAgICAgICAgICAgIGxpbmVzW2pdID0gaW5kZW50ICsgbGluZXNbal07XG4gICAgICAgIH1cbiAgICAgICAgc3RyID0gbGluZXMuam9pbihcIlxcblwiKTtcbiAgICAgICAgcmV0ICs9IHN0ciArIFwiXFxuXCI7XG4gICAgfVxuICAgIGxldmVsLS07XG4gICAgcmV0dXJuIHJldDtcbn07XG5cbmZ1bmN0aW9uIE9wZXJhdGlvbmFsRXJyb3IobWVzc2FnZSkge1xuICAgIHRoaXMubmFtZSA9IFwiT3BlcmF0aW9uYWxFcnJvclwiO1xuICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgdGhpcy5jYXVzZSA9IG1lc3NhZ2U7XG4gICAgdGhpc1tcImlzT3BlcmF0aW9uYWxcIl0gPSB0cnVlO1xuXG4gICAgaWYgKG1lc3NhZ2UgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlLm1lc3NhZ2U7XG4gICAgICAgIHRoaXMuc3RhY2sgPSBtZXNzYWdlLnN0YWNrO1xuICAgIH0gZWxzZSBpZiAoRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UpIHtcbiAgICAgICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UodGhpcywgdGhpcy5jb25zdHJ1Y3Rvcik7XG4gICAgfVxuXG59XG5pbmhlcml0cyhPcGVyYXRpb25hbEVycm9yLCBFcnJvcik7XG5cbnZhciBrZXkgPSBcIl9fQmx1ZWJpcmRFcnJvclR5cGVzX19cIjtcbnZhciBlcnJvclR5cGVzID0gRXJyb3Jba2V5XTtcbmlmICghZXJyb3JUeXBlcykge1xuICAgIGVycm9yVHlwZXMgPSBPYmplY3RmcmVlemUoe1xuICAgICAgICBDYW5jZWxsYXRpb25FcnJvcjogQ2FuY2VsbGF0aW9uRXJyb3IsXG4gICAgICAgIFRpbWVvdXRFcnJvcjogVGltZW91dEVycm9yLFxuICAgICAgICBPcGVyYXRpb25hbEVycm9yOiBPcGVyYXRpb25hbEVycm9yLFxuICAgICAgICBSZWplY3Rpb25FcnJvcjogT3BlcmF0aW9uYWxFcnJvcixcbiAgICAgICAgQWdncmVnYXRlRXJyb3I6IEFnZ3JlZ2F0ZUVycm9yXG4gICAgfSk7XG4gICAgbm90RW51bWVyYWJsZVByb3AoRXJyb3IsIGtleSwgZXJyb3JUeXBlcyk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICAgIEVycm9yOiBFcnJvcixcbiAgICBUeXBlRXJyb3I6IF9UeXBlRXJyb3IsXG4gICAgUmFuZ2VFcnJvcjogX1JhbmdlRXJyb3IsXG4gICAgQ2FuY2VsbGF0aW9uRXJyb3I6IGVycm9yVHlwZXMuQ2FuY2VsbGF0aW9uRXJyb3IsXG4gICAgT3BlcmF0aW9uYWxFcnJvcjogZXJyb3JUeXBlcy5PcGVyYXRpb25hbEVycm9yLFxuICAgIFRpbWVvdXRFcnJvcjogZXJyb3JUeXBlcy5UaW1lb3V0RXJyb3IsXG4gICAgQWdncmVnYXRlRXJyb3I6IGVycm9yVHlwZXMuQWdncmVnYXRlRXJyb3IsXG4gICAgb3JpZ2luYXRlc0Zyb21SZWplY3Rpb246IG9yaWdpbmF0ZXNGcm9tUmVqZWN0aW9uLFxuICAgIG1hcmtBc09yaWdpbmF0aW5nRnJvbVJlamVjdGlvbjogbWFya0FzT3JpZ2luYXRpbmdGcm9tUmVqZWN0aW9uLFxuICAgIGNhbkF0dGFjaDogY2FuQXR0YWNoXG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSwgSU5URVJOQUwpIHtcbnZhciB1dGlsID0gcmVxdWlyZShcIi4vdXRpbC5qc1wiKTtcbnZhciBjYW5BdHRhY2ggPSByZXF1aXJlKFwiLi9lcnJvcnMuanNcIikuY2FuQXR0YWNoO1xudmFyIGVycm9yT2JqID0gdXRpbC5lcnJvck9iajtcbnZhciBpc09iamVjdCA9IHV0aWwuaXNPYmplY3Q7XG5cbmZ1bmN0aW9uIGdldFRoZW4ob2JqKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIG9iai50aGVuO1xuICAgIH1cbiAgICBjYXRjaChlKSB7XG4gICAgICAgIGVycm9yT2JqLmUgPSBlO1xuICAgICAgICByZXR1cm4gZXJyb3JPYmo7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBQcm9taXNlJF9DYXN0KG9iaiwgb3JpZ2luYWxQcm9taXNlKSB7XG4gICAgaWYgKGlzT2JqZWN0KG9iaikpIHtcbiAgICAgICAgaWYgKG9iaiBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgICAgIHJldHVybiBvYmo7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoaXNBbnlCbHVlYmlyZFByb21pc2Uob2JqKSkge1xuICAgICAgICAgICAgdmFyIHJldCA9IG5ldyBQcm9taXNlKElOVEVSTkFMKTtcbiAgICAgICAgICAgIHJldC5fc2V0VHJhY2Uodm9pZCAwKTtcbiAgICAgICAgICAgIG9iai5fdGhlbihcbiAgICAgICAgICAgICAgICByZXQuX2Z1bGZpbGxVbmNoZWNrZWQsXG4gICAgICAgICAgICAgICAgcmV0Ll9yZWplY3RVbmNoZWNrZWRDaGVja0Vycm9yLFxuICAgICAgICAgICAgICAgIHJldC5fcHJvZ3Jlc3NVbmNoZWNrZWQsXG4gICAgICAgICAgICAgICAgcmV0LFxuICAgICAgICAgICAgICAgIG51bGxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICByZXQuX3NldEZvbGxvd2luZygpO1xuICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdGhlbiA9IGdldFRoZW4ob2JqKTtcbiAgICAgICAgaWYgKHRoZW4gPT09IGVycm9yT2JqKSB7XG4gICAgICAgICAgICBpZiAob3JpZ2luYWxQcm9taXNlICE9PSB2b2lkIDAgJiYgY2FuQXR0YWNoKHRoZW4uZSkpIHtcbiAgICAgICAgICAgICAgICBvcmlnaW5hbFByb21pc2UuX2F0dGFjaEV4dHJhVHJhY2UodGhlbi5lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdCh0aGVuLmUpO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB0aGVuID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlJF9kb1RoZW5hYmxlKG9iaiwgdGhlbiwgb3JpZ2luYWxQcm9taXNlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gb2JqO1xufVxuXG52YXIgaGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5O1xuZnVuY3Rpb24gaXNBbnlCbHVlYmlyZFByb21pc2Uob2JqKSB7XG4gICAgcmV0dXJuIGhhc1Byb3AuY2FsbChvYmosIFwiX3Byb21pc2UwXCIpO1xufVxuXG5mdW5jdGlvbiBQcm9taXNlJF9kb1RoZW5hYmxlKHgsIHRoZW4sIG9yaWdpbmFsUHJvbWlzZSkge1xuICAgIHZhciByZXNvbHZlciA9IFByb21pc2UuZGVmZXIoKTtcbiAgICB2YXIgY2FsbGVkID0gZmFsc2U7XG4gICAgdHJ5IHtcbiAgICAgICAgdGhlbi5jYWxsKFxuICAgICAgICAgICAgeCxcbiAgICAgICAgICAgIFByb21pc2UkX3Jlc29sdmVGcm9tVGhlbmFibGUsXG4gICAgICAgICAgICBQcm9taXNlJF9yZWplY3RGcm9tVGhlbmFibGUsXG4gICAgICAgICAgICBQcm9taXNlJF9wcm9ncmVzc0Zyb21UaGVuYWJsZVxuICAgICAgICApO1xuICAgIH0gY2F0Y2goZSkge1xuICAgICAgICBpZiAoIWNhbGxlZCkge1xuICAgICAgICAgICAgY2FsbGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHZhciB0cmFjZSA9IGNhbkF0dGFjaChlKSA/IGUgOiBuZXcgRXJyb3IoZSArIFwiXCIpO1xuICAgICAgICAgICAgaWYgKG9yaWdpbmFsUHJvbWlzZSAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgICAgICAgb3JpZ2luYWxQcm9taXNlLl9hdHRhY2hFeHRyYVRyYWNlKHRyYWNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlc29sdmVyLnByb21pc2UuX3JlamVjdChlLCB0cmFjZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc29sdmVyLnByb21pc2U7XG5cbiAgICBmdW5jdGlvbiBQcm9taXNlJF9yZXNvbHZlRnJvbVRoZW5hYmxlKHkpIHtcbiAgICAgICAgaWYgKGNhbGxlZCkgcmV0dXJuO1xuICAgICAgICBjYWxsZWQgPSB0cnVlO1xuXG4gICAgICAgIGlmICh4ID09PSB5KSB7XG4gICAgICAgICAgICB2YXIgZSA9IFByb21pc2UuX21ha2VTZWxmUmVzb2x1dGlvbkVycm9yKCk7XG4gICAgICAgICAgICBpZiAob3JpZ2luYWxQcm9taXNlICE9PSB2b2lkIDApIHtcbiAgICAgICAgICAgICAgICBvcmlnaW5hbFByb21pc2UuX2F0dGFjaEV4dHJhVHJhY2UoZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXNvbHZlci5wcm9taXNlLl9yZWplY3QoZSwgdm9pZCAwKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICByZXNvbHZlci5yZXNvbHZlKHkpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIFByb21pc2UkX3JlamVjdEZyb21UaGVuYWJsZShyKSB7XG4gICAgICAgIGlmIChjYWxsZWQpIHJldHVybjtcbiAgICAgICAgY2FsbGVkID0gdHJ1ZTtcbiAgICAgICAgdmFyIHRyYWNlID0gY2FuQXR0YWNoKHIpID8gciA6IG5ldyBFcnJvcihyICsgXCJcIik7XG4gICAgICAgIGlmIChvcmlnaW5hbFByb21pc2UgIT09IHZvaWQgMCkge1xuICAgICAgICAgICAgb3JpZ2luYWxQcm9taXNlLl9hdHRhY2hFeHRyYVRyYWNlKHRyYWNlKTtcbiAgICAgICAgfVxuICAgICAgICByZXNvbHZlci5wcm9taXNlLl9yZWplY3QociwgdHJhY2UpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIFByb21pc2UkX3Byb2dyZXNzRnJvbVRoZW5hYmxlKHYpIHtcbiAgICAgICAgaWYgKGNhbGxlZCkgcmV0dXJuO1xuICAgICAgICB2YXIgcHJvbWlzZSA9IHJlc29sdmVyLnByb21pc2U7XG4gICAgICAgIGlmICh0eXBlb2YgcHJvbWlzZS5fcHJvZ3Jlc3MgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgcHJvbWlzZS5fcHJvZ3Jlc3Modik7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbnJldHVybiBQcm9taXNlJF9DYXN0O1xufTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UsIElOVEVSTkFMLCBjYXN0KSB7XG52YXIgY2FuQXR0YWNoID0gcmVxdWlyZShcIi4vZXJyb3JzLmpzXCIpLmNhbkF0dGFjaDtcbnZhciB1dGlsID0gcmVxdWlyZShcIi4vdXRpbC5qc1wiKTtcbnZhciBpc0FycmF5ID0gdXRpbC5pc0FycmF5O1xuXG5mdW5jdGlvbiB0b1Jlc29sdXRpb25WYWx1ZSh2YWwpIHtcbiAgICBzd2l0Y2godmFsKSB7XG4gICAgY2FzZSAtMTogcmV0dXJuIHZvaWQgMDtcbiAgICBjYXNlIC0yOiByZXR1cm4gW107XG4gICAgY2FzZSAtMzogcmV0dXJuIHt9O1xuICAgIH1cbn1cblxuZnVuY3Rpb24gUHJvbWlzZUFycmF5KHZhbHVlcykge1xuICAgIHZhciBwcm9taXNlID0gdGhpcy5fcHJvbWlzZSA9IG5ldyBQcm9taXNlKElOVEVSTkFMKTtcbiAgICB2YXIgcGFyZW50ID0gdm9pZCAwO1xuICAgIGlmICh2YWx1ZXMgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgIHBhcmVudCA9IHZhbHVlcztcbiAgICAgICAgcHJvbWlzZS5fcHJvcGFnYXRlRnJvbShwYXJlbnQsIDEgfCA0KTtcbiAgICB9XG4gICAgcHJvbWlzZS5fc2V0VHJhY2UocGFyZW50KTtcbiAgICB0aGlzLl92YWx1ZXMgPSB2YWx1ZXM7XG4gICAgdGhpcy5fbGVuZ3RoID0gMDtcbiAgICB0aGlzLl90b3RhbFJlc29sdmVkID0gMDtcbiAgICB0aGlzLl9pbml0KHZvaWQgMCwgLTIpO1xufVxuUHJvbWlzZUFycmF5LnByb3RvdHlwZS5sZW5ndGggPSBmdW5jdGlvbiBQcm9taXNlQXJyYXkkbGVuZ3RoKCkge1xuICAgIHJldHVybiB0aGlzLl9sZW5ndGg7XG59O1xuXG5Qcm9taXNlQXJyYXkucHJvdG90eXBlLnByb21pc2UgPSBmdW5jdGlvbiBQcm9taXNlQXJyYXkkcHJvbWlzZSgpIHtcbiAgICByZXR1cm4gdGhpcy5fcHJvbWlzZTtcbn07XG5cblByb21pc2VBcnJheS5wcm90b3R5cGUuX2luaXQgPVxuZnVuY3Rpb24gUHJvbWlzZUFycmF5JF9pbml0KF8sIHJlc29sdmVWYWx1ZUlmRW1wdHkpIHtcbiAgICB2YXIgdmFsdWVzID0gY2FzdCh0aGlzLl92YWx1ZXMsIHZvaWQgMCk7XG4gICAgaWYgKHZhbHVlcyBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgdGhpcy5fdmFsdWVzID0gdmFsdWVzO1xuICAgICAgICB2YWx1ZXMuX3NldEJvdW5kVG8odGhpcy5fcHJvbWlzZS5fYm91bmRUbyk7XG4gICAgICAgIGlmICh2YWx1ZXMuaXNGdWxmaWxsZWQoKSkge1xuICAgICAgICAgICAgdmFsdWVzID0gdmFsdWVzLl9zZXR0bGVkVmFsdWU7XG4gICAgICAgICAgICBpZiAoIWlzQXJyYXkodmFsdWVzKSkge1xuICAgICAgICAgICAgICAgIHZhciBlcnIgPSBuZXcgUHJvbWlzZS5UeXBlRXJyb3IoXCJleHBlY3RpbmcgYW4gYXJyYXksIGEgcHJvbWlzZSBvciBhIHRoZW5hYmxlXCIpO1xuICAgICAgICAgICAgICAgIHRoaXMuX19oYXJkUmVqZWN0X18oZXJyKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAodmFsdWVzLmlzUGVuZGluZygpKSB7XG4gICAgICAgICAgICB2YWx1ZXMuX3RoZW4oXG4gICAgICAgICAgICAgICAgUHJvbWlzZUFycmF5JF9pbml0LFxuICAgICAgICAgICAgICAgIHRoaXMuX3JlamVjdCxcbiAgICAgICAgICAgICAgICB2b2lkIDAsXG4gICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICByZXNvbHZlVmFsdWVJZkVtcHR5XG4gICAgICAgICAgICk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YWx1ZXMuX3Vuc2V0UmVqZWN0aW9uSXNVbmhhbmRsZWQoKTtcbiAgICAgICAgICAgIHRoaXMuX3JlamVjdCh2YWx1ZXMuX3NldHRsZWRWYWx1ZSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9IGVsc2UgaWYgKCFpc0FycmF5KHZhbHVlcykpIHtcbiAgICAgICAgdmFyIGVyciA9IG5ldyBQcm9taXNlLlR5cGVFcnJvcihcImV4cGVjdGluZyBhbiBhcnJheSwgYSBwcm9taXNlIG9yIGEgdGhlbmFibGVcIik7XG4gICAgICAgIHRoaXMuX19oYXJkUmVqZWN0X18oZXJyKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICh2YWx1ZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGlmIChyZXNvbHZlVmFsdWVJZkVtcHR5ID09PSAtNSkge1xuICAgICAgICAgICAgdGhpcy5fcmVzb2x2ZUVtcHR5QXJyYXkoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX3Jlc29sdmUodG9SZXNvbHV0aW9uVmFsdWUocmVzb2x2ZVZhbHVlSWZFbXB0eSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIGxlbiA9IHRoaXMuZ2V0QWN0dWFsTGVuZ3RoKHZhbHVlcy5sZW5ndGgpO1xuICAgIHZhciBuZXdMZW4gPSBsZW47XG4gICAgdmFyIG5ld1ZhbHVlcyA9IHRoaXMuc2hvdWxkQ29weVZhbHVlcygpID8gbmV3IEFycmF5KGxlbikgOiB0aGlzLl92YWx1ZXM7XG4gICAgdmFyIGlzRGlyZWN0U2Nhbk5lZWRlZCA9IGZhbHNlO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyArK2kpIHtcbiAgICAgICAgdmFyIG1heWJlUHJvbWlzZSA9IGNhc3QodmFsdWVzW2ldLCB2b2lkIDApO1xuICAgICAgICBpZiAobWF5YmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgICAgaWYgKG1heWJlUHJvbWlzZS5pc1BlbmRpbmcoKSkge1xuICAgICAgICAgICAgICAgIG1heWJlUHJvbWlzZS5fcHJveHlQcm9taXNlQXJyYXkodGhpcywgaSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG1heWJlUHJvbWlzZS5fdW5zZXRSZWplY3Rpb25Jc1VuaGFuZGxlZCgpO1xuICAgICAgICAgICAgICAgIGlzRGlyZWN0U2Nhbk5lZWRlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpc0RpcmVjdFNjYW5OZWVkZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIG5ld1ZhbHVlc1tpXSA9IG1heWJlUHJvbWlzZTtcbiAgICB9XG4gICAgdGhpcy5fdmFsdWVzID0gbmV3VmFsdWVzO1xuICAgIHRoaXMuX2xlbmd0aCA9IG5ld0xlbjtcbiAgICBpZiAoaXNEaXJlY3RTY2FuTmVlZGVkKSB7XG4gICAgICAgIHRoaXMuX3NjYW5EaXJlY3RWYWx1ZXMobGVuKTtcbiAgICB9XG59O1xuXG5Qcm9taXNlQXJyYXkucHJvdG90eXBlLl9zZXR0bGVQcm9taXNlQXQgPVxuZnVuY3Rpb24gUHJvbWlzZUFycmF5JF9zZXR0bGVQcm9taXNlQXQoaW5kZXgpIHtcbiAgICB2YXIgdmFsdWUgPSB0aGlzLl92YWx1ZXNbaW5kZXhdO1xuICAgIGlmICghKHZhbHVlIGluc3RhbmNlb2YgUHJvbWlzZSkpIHtcbiAgICAgICAgdGhpcy5fcHJvbWlzZUZ1bGZpbGxlZCh2YWx1ZSwgaW5kZXgpO1xuICAgIH0gZWxzZSBpZiAodmFsdWUuaXNGdWxmaWxsZWQoKSkge1xuICAgICAgICB0aGlzLl9wcm9taXNlRnVsZmlsbGVkKHZhbHVlLl9zZXR0bGVkVmFsdWUsIGluZGV4KTtcbiAgICB9IGVsc2UgaWYgKHZhbHVlLmlzUmVqZWN0ZWQoKSkge1xuICAgICAgICB0aGlzLl9wcm9taXNlUmVqZWN0ZWQodmFsdWUuX3NldHRsZWRWYWx1ZSwgaW5kZXgpO1xuICAgIH1cbn07XG5cblByb21pc2VBcnJheS5wcm90b3R5cGUuX3NjYW5EaXJlY3RWYWx1ZXMgPVxuZnVuY3Rpb24gUHJvbWlzZUFycmF5JF9zY2FuRGlyZWN0VmFsdWVzKGxlbikge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyArK2kpIHtcbiAgICAgICAgaWYgKHRoaXMuX2lzUmVzb2x2ZWQoKSkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fc2V0dGxlUHJvbWlzZUF0KGkpO1xuICAgIH1cbn07XG5cblByb21pc2VBcnJheS5wcm90b3R5cGUuX2lzUmVzb2x2ZWQgPSBmdW5jdGlvbiBQcm9taXNlQXJyYXkkX2lzUmVzb2x2ZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3ZhbHVlcyA9PT0gbnVsbDtcbn07XG5cblByb21pc2VBcnJheS5wcm90b3R5cGUuX3Jlc29sdmUgPSBmdW5jdGlvbiBQcm9taXNlQXJyYXkkX3Jlc29sdmUodmFsdWUpIHtcbiAgICB0aGlzLl92YWx1ZXMgPSBudWxsO1xuICAgIHRoaXMuX3Byb21pc2UuX2Z1bGZpbGwodmFsdWUpO1xufTtcblxuUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fX2hhcmRSZWplY3RfXyA9XG5Qcm9taXNlQXJyYXkucHJvdG90eXBlLl9yZWplY3QgPSBmdW5jdGlvbiBQcm9taXNlQXJyYXkkX3JlamVjdChyZWFzb24pIHtcbiAgICB0aGlzLl92YWx1ZXMgPSBudWxsO1xuICAgIHZhciB0cmFjZSA9IGNhbkF0dGFjaChyZWFzb24pID8gcmVhc29uIDogbmV3IEVycm9yKHJlYXNvbiArIFwiXCIpO1xuICAgIHRoaXMuX3Byb21pc2UuX2F0dGFjaEV4dHJhVHJhY2UodHJhY2UpO1xuICAgIHRoaXMuX3Byb21pc2UuX3JlamVjdChyZWFzb24sIHRyYWNlKTtcbn07XG5cblByb21pc2VBcnJheS5wcm90b3R5cGUuX3Byb21pc2VQcm9ncmVzc2VkID1cbmZ1bmN0aW9uIFByb21pc2VBcnJheSRfcHJvbWlzZVByb2dyZXNzZWQocHJvZ3Jlc3NWYWx1ZSwgaW5kZXgpIHtcbiAgICBpZiAodGhpcy5faXNSZXNvbHZlZCgpKSByZXR1cm47XG4gICAgdGhpcy5fcHJvbWlzZS5fcHJvZ3Jlc3Moe1xuICAgICAgICBpbmRleDogaW5kZXgsXG4gICAgICAgIHZhbHVlOiBwcm9ncmVzc1ZhbHVlXG4gICAgfSk7XG59O1xuXG5cblByb21pc2VBcnJheS5wcm90b3R5cGUuX3Byb21pc2VGdWxmaWxsZWQgPVxuZnVuY3Rpb24gUHJvbWlzZUFycmF5JF9wcm9taXNlRnVsZmlsbGVkKHZhbHVlLCBpbmRleCkge1xuICAgIGlmICh0aGlzLl9pc1Jlc29sdmVkKCkpIHJldHVybjtcbiAgICB0aGlzLl92YWx1ZXNbaW5kZXhdID0gdmFsdWU7XG4gICAgdmFyIHRvdGFsUmVzb2x2ZWQgPSArK3RoaXMuX3RvdGFsUmVzb2x2ZWQ7XG4gICAgaWYgKHRvdGFsUmVzb2x2ZWQgPj0gdGhpcy5fbGVuZ3RoKSB7XG4gICAgICAgIHRoaXMuX3Jlc29sdmUodGhpcy5fdmFsdWVzKTtcbiAgICB9XG59O1xuXG5Qcm9taXNlQXJyYXkucHJvdG90eXBlLl9wcm9taXNlUmVqZWN0ZWQgPVxuZnVuY3Rpb24gUHJvbWlzZUFycmF5JF9wcm9taXNlUmVqZWN0ZWQocmVhc29uLCBpbmRleCkge1xuICAgIGlmICh0aGlzLl9pc1Jlc29sdmVkKCkpIHJldHVybjtcbiAgICB0aGlzLl90b3RhbFJlc29sdmVkKys7XG4gICAgdGhpcy5fcmVqZWN0KHJlYXNvbik7XG59O1xuXG5Qcm9taXNlQXJyYXkucHJvdG90eXBlLnNob3VsZENvcHlWYWx1ZXMgPVxuZnVuY3Rpb24gUHJvbWlzZUFycmF5JF9zaG91bGRDb3B5VmFsdWVzKCkge1xuICAgIHJldHVybiB0cnVlO1xufTtcblxuUHJvbWlzZUFycmF5LnByb3RvdHlwZS5nZXRBY3R1YWxMZW5ndGggPVxuZnVuY3Rpb24gUHJvbWlzZUFycmF5JGdldEFjdHVhbExlbmd0aChsZW4pIHtcbiAgICByZXR1cm4gbGVuO1xufTtcblxucmV0dXJuIFByb21pc2VBcnJheTtcbn07XG4iLCIoZnVuY3Rpb24oKXsvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpIHtcbnZhciBpbmhlcml0cyA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIikuaW5oZXJpdHM7XG52YXIgZGVmaW5lUHJvcGVydHkgPSByZXF1aXJlKFwiLi9lczUuanNcIikuZGVmaW5lUHJvcGVydHk7XG5cbnZhciByaWdub3JlID0gbmV3IFJlZ0V4cChcbiAgICBcIlxcXFxiKD86W2EtekEtWjAtOS5dK1xcXFwkX1xcXFx3K3xcIiArXG4gICAgXCJ0cnlDYXRjaCg/OjF8MnwzfDR8QXBwbHkpfG5ldyBcXFxcdypQcm9taXNlQXJyYXl8XCIgK1xuICAgIFwiXFxcXHcqUHJvbWlzZUFycmF5XFxcXC5cXFxcdypQcm9taXNlQXJyYXl8XCIgK1xuICAgIFwic2V0VGltZW91dHxDYXRjaEZpbHRlclxcXFwkX1xcXFx3K3xtYWtlTm9kZVByb21pc2lmaWVkfHByb2Nlc3NJbW1lZGlhdGV8XCIgK1xuICAgIFwicHJvY2Vzcy5fdGlja0NhbGxiYWNrfG5leHRUaWNrfEFzeW5jXFxcXCRcXFxcdyspXFxcXGJcIlxuKTtcblxudmFyIHJ0cmFjZWxpbmUgPSBudWxsO1xudmFyIGZvcm1hdFN0YWNrID0gbnVsbDtcblxuZnVuY3Rpb24gZm9ybWF0Tm9uRXJyb3Iob2JqKSB7XG4gICAgdmFyIHN0cjtcbiAgICBpZiAodHlwZW9mIG9iaiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHN0ciA9IFwiW2Z1bmN0aW9uIFwiICtcbiAgICAgICAgICAgIChvYmoubmFtZSB8fCBcImFub255bW91c1wiKSArXG4gICAgICAgICAgICBcIl1cIjtcbiAgICB9IGVsc2Uge1xuICAgICAgICBzdHIgPSBvYmoudG9TdHJpbmcoKTtcbiAgICAgICAgdmFyIHJ1c2VsZXNzVG9TdHJpbmcgPSAvXFxbb2JqZWN0IFthLXpBLVowLTkkX10rXFxdLztcbiAgICAgICAgaWYgKHJ1c2VsZXNzVG9TdHJpbmcudGVzdChzdHIpKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHZhciBuZXdTdHIgPSBKU09OLnN0cmluZ2lmeShvYmopO1xuICAgICAgICAgICAgICAgIHN0ciA9IG5ld1N0cjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoKGUpIHtcblxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChzdHIubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBzdHIgPSBcIihlbXB0eSBhcnJheSlcIjtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gKFwiKDxcIiArIHNuaXAoc3RyKSArIFwiPiwgbm8gc3RhY2sgdHJhY2UpXCIpO1xufVxuXG5mdW5jdGlvbiBzbmlwKHN0cikge1xuICAgIHZhciBtYXhDaGFycyA9IDQxO1xuICAgIGlmIChzdHIubGVuZ3RoIDwgbWF4Q2hhcnMpIHtcbiAgICAgICAgcmV0dXJuIHN0cjtcbiAgICB9XG4gICAgcmV0dXJuIHN0ci5zdWJzdHIoMCwgbWF4Q2hhcnMgLSAzKSArIFwiLi4uXCI7XG59XG5cbmZ1bmN0aW9uIENhcHR1cmVkVHJhY2UoaWdub3JlVW50aWwsIGlzVG9wTGV2ZWwpIHtcbiAgICB0aGlzLmNhcHR1cmVTdGFja1RyYWNlKENhcHR1cmVkVHJhY2UsIGlzVG9wTGV2ZWwpO1xuXG59XG5pbmhlcml0cyhDYXB0dXJlZFRyYWNlLCBFcnJvcik7XG5cbkNhcHR1cmVkVHJhY2UucHJvdG90eXBlLmNhcHR1cmVTdGFja1RyYWNlID1cbmZ1bmN0aW9uIENhcHR1cmVkVHJhY2UkY2FwdHVyZVN0YWNrVHJhY2UoaWdub3JlVW50aWwsIGlzVG9wTGV2ZWwpIHtcbiAgICBjYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCBpZ25vcmVVbnRpbCwgaXNUb3BMZXZlbCk7XG59O1xuXG5DYXB0dXJlZFRyYWNlLnBvc3NpYmx5VW5oYW5kbGVkUmVqZWN0aW9uID1cbmZ1bmN0aW9uIENhcHR1cmVkVHJhY2UkUG9zc2libHlVbmhhbmRsZWRSZWplY3Rpb24ocmVhc29uKSB7XG4gICAgaWYgKHR5cGVvZiBjb25zb2xlID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgIHZhciBtZXNzYWdlO1xuICAgICAgICBpZiAodHlwZW9mIHJlYXNvbiA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgcmVhc29uID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHZhciBzdGFjayA9IHJlYXNvbi5zdGFjaztcbiAgICAgICAgICAgIG1lc3NhZ2UgPSBcIlBvc3NpYmx5IHVuaGFuZGxlZCBcIiArIGZvcm1hdFN0YWNrKHN0YWNrLCByZWFzb24pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbWVzc2FnZSA9IFwiUG9zc2libHkgdW5oYW5kbGVkIFwiICsgU3RyaW5nKHJlYXNvbik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBjb25zb2xlLmVycm9yID09PSBcImZ1bmN0aW9uXCIgfHxcbiAgICAgICAgICAgIHR5cGVvZiBjb25zb2xlLmVycm9yID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKG1lc3NhZ2UpO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBjb25zb2xlLmxvZyA9PT0gXCJmdW5jdGlvblwiIHx8XG4gICAgICAgICAgICB0eXBlb2YgY29uc29sZS5sb2cgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKG1lc3NhZ2UpO1xuICAgICAgICB9XG4gICAgfVxufTtcblxuQ2FwdHVyZWRUcmFjZS5jb21iaW5lID0gZnVuY3Rpb24gQ2FwdHVyZWRUcmFjZSRDb21iaW5lKGN1cnJlbnQsIHByZXYpIHtcbiAgICB2YXIgY3VyTGFzdCA9IGN1cnJlbnQubGVuZ3RoIC0gMTtcbiAgICBmb3IgKHZhciBpID0gcHJldi5sZW5ndGggLSAxOyBpID49IDA7IC0taSkge1xuICAgICAgICB2YXIgbGluZSA9IHByZXZbaV07XG4gICAgICAgIGlmIChjdXJyZW50W2N1ckxhc3RdID09PSBsaW5lKSB7XG4gICAgICAgICAgICBjdXJyZW50LnBvcCgpO1xuICAgICAgICAgICAgY3VyTGFzdC0tO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjdXJyZW50LnB1c2goXCJGcm9tIHByZXZpb3VzIGV2ZW50OlwiKTtcbiAgICB2YXIgbGluZXMgPSBjdXJyZW50LmNvbmNhdChwcmV2KTtcblxuICAgIHZhciByZXQgPSBbXTtcblxuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBsaW5lcy5sZW5ndGg7IGkgPCBsZW47ICsraSkge1xuXG4gICAgICAgIGlmICgocmlnbm9yZS50ZXN0KGxpbmVzW2ldKSB8fFxuICAgICAgICAgICAgKGkgPiAwICYmICFydHJhY2VsaW5lLnRlc3QobGluZXNbaV0pKSAmJlxuICAgICAgICAgICAgbGluZXNbaV0gIT09IFwiRnJvbSBwcmV2aW91cyBldmVudDpcIilcbiAgICAgICApIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldC5wdXNoKGxpbmVzW2ldKTtcbiAgICB9XG4gICAgcmV0dXJuIHJldDtcbn07XG5cbkNhcHR1cmVkVHJhY2UucHJvdGVjdEVycm9yTWVzc2FnZU5ld2xpbmVzID0gZnVuY3Rpb24oc3RhY2spIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN0YWNrLmxlbmd0aDsgKytpKSB7XG4gICAgICAgIGlmIChydHJhY2VsaW5lLnRlc3Qoc3RhY2tbaV0pKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmIChpIDw9IDEpIHJldHVybjtcblxuICAgIHZhciBlcnJvck1lc3NhZ2VMaW5lcyA9IFtdO1xuICAgIGZvciAodmFyIGogPSAwOyBqIDwgaTsgKytqKSB7XG4gICAgICAgIGVycm9yTWVzc2FnZUxpbmVzLnB1c2goc3RhY2suc2hpZnQoKSk7XG4gICAgfVxuICAgIHN0YWNrLnVuc2hpZnQoZXJyb3JNZXNzYWdlTGluZXMuam9pbihcIlxcdTAwMDJcXHUwMDAwXFx1MDAwMVwiKSk7XG59O1xuXG5DYXB0dXJlZFRyYWNlLmlzU3VwcG9ydGVkID0gZnVuY3Rpb24gQ2FwdHVyZWRUcmFjZSRJc1N1cHBvcnRlZCgpIHtcbiAgICByZXR1cm4gdHlwZW9mIGNhcHR1cmVTdGFja1RyYWNlID09PSBcImZ1bmN0aW9uXCI7XG59O1xuXG52YXIgY2FwdHVyZVN0YWNrVHJhY2UgPSAoZnVuY3Rpb24gc3RhY2tEZXRlY3Rpb24oKSB7XG4gICAgaWYgKHR5cGVvZiBFcnJvci5zdGFja1RyYWNlTGltaXQgPT09IFwibnVtYmVyXCIgJiZcbiAgICAgICAgdHlwZW9mIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgcnRyYWNlbGluZSA9IC9eXFxzKmF0XFxzKi87XG4gICAgICAgIGZvcm1hdFN0YWNrID0gZnVuY3Rpb24oc3RhY2ssIGVycm9yKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHN0YWNrID09PSBcInN0cmluZ1wiKSByZXR1cm4gc3RhY2s7XG5cbiAgICAgICAgICAgIGlmIChlcnJvci5uYW1lICE9PSB2b2lkIDAgJiZcbiAgICAgICAgICAgICAgICBlcnJvci5tZXNzYWdlICE9PSB2b2lkIDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZXJyb3IubmFtZSArIFwiLiBcIiArIGVycm9yLm1lc3NhZ2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZm9ybWF0Tm9uRXJyb3IoZXJyb3IpO1xuXG5cbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGNhcHR1cmVTdGFja1RyYWNlID0gRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2U7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBDYXB0dXJlZFRyYWNlJF9jYXB0dXJlU3RhY2tUcmFjZShcbiAgICAgICAgICAgIHJlY2VpdmVyLCBpZ25vcmVVbnRpbCkge1xuICAgICAgICAgICAgY2FwdHVyZVN0YWNrVHJhY2UocmVjZWl2ZXIsIGlnbm9yZVVudGlsKTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgdmFyIGVyciA9IG5ldyBFcnJvcigpO1xuXG4gICAgaWYgKHR5cGVvZiBlcnIuc3RhY2sgPT09IFwic3RyaW5nXCIgJiZcbiAgICAgICAgdHlwZW9mIFwiXCIuc3RhcnRzV2l0aCA9PT0gXCJmdW5jdGlvblwiICYmXG4gICAgICAgIChlcnIuc3RhY2suc3RhcnRzV2l0aChcInN0YWNrRGV0ZWN0aW9uQFwiKSkgJiZcbiAgICAgICAgc3RhY2tEZXRlY3Rpb24ubmFtZSA9PT0gXCJzdGFja0RldGVjdGlvblwiKSB7XG5cbiAgICAgICAgZGVmaW5lUHJvcGVydHkoRXJyb3IsIFwic3RhY2tUcmFjZUxpbWl0XCIsIHtcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IGZhbHNlLFxuICAgICAgICAgICAgdmFsdWU6IDI1XG4gICAgICAgIH0pO1xuICAgICAgICBydHJhY2VsaW5lID0gL0AvO1xuICAgICAgICB2YXIgcmxpbmUgPSAvW0BcXG5dLztcblxuICAgICAgICBmb3JtYXRTdGFjayA9IGZ1bmN0aW9uKHN0YWNrLCBlcnJvcikge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBzdGFjayA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgIHJldHVybiAoZXJyb3IubmFtZSArIFwiLiBcIiArIGVycm9yLm1lc3NhZ2UgKyBcIlxcblwiICsgc3RhY2spO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoZXJyb3IubmFtZSAhPT0gdm9pZCAwICYmXG4gICAgICAgICAgICAgICAgZXJyb3IubWVzc2FnZSAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGVycm9yLm5hbWUgKyBcIi4gXCIgKyBlcnJvci5tZXNzYWdlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZvcm1hdE5vbkVycm9yKGVycm9yKTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gY2FwdHVyZVN0YWNrVHJhY2Uobykge1xuICAgICAgICAgICAgdmFyIHN0YWNrID0gbmV3IEVycm9yKCkuc3RhY2s7XG4gICAgICAgICAgICB2YXIgc3BsaXQgPSBzdGFjay5zcGxpdChybGluZSk7XG4gICAgICAgICAgICB2YXIgbGVuID0gc3BsaXQubGVuZ3RoO1xuICAgICAgICAgICAgdmFyIHJldCA9IFwiXCI7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSArPSAyKSB7XG4gICAgICAgICAgICAgICAgcmV0ICs9IHNwbGl0W2ldO1xuICAgICAgICAgICAgICAgIHJldCArPSBcIkBcIjtcbiAgICAgICAgICAgICAgICByZXQgKz0gc3BsaXRbaSArIDFdO1xuICAgICAgICAgICAgICAgIHJldCArPSBcIlxcblwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgby5zdGFjayA9IHJldDtcbiAgICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBmb3JtYXRTdGFjayA9IGZ1bmN0aW9uKHN0YWNrLCBlcnJvcikge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBzdGFjayA9PT0gXCJzdHJpbmdcIikgcmV0dXJuIHN0YWNrO1xuXG4gICAgICAgICAgICBpZiAoKHR5cGVvZiBlcnJvciA9PT0gXCJvYmplY3RcIiB8fFxuICAgICAgICAgICAgICAgIHR5cGVvZiBlcnJvciA9PT0gXCJmdW5jdGlvblwiKSAmJlxuICAgICAgICAgICAgICAgIGVycm9yLm5hbWUgIT09IHZvaWQgMCAmJlxuICAgICAgICAgICAgICAgIGVycm9yLm1lc3NhZ2UgIT09IHZvaWQgMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBlcnJvci5uYW1lICsgXCIuIFwiICsgZXJyb3IubWVzc2FnZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmb3JtYXROb25FcnJvcihlcnJvcik7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxufSkoKTtcblxucmV0dXJuIENhcHR1cmVkVHJhY2U7XG59O1xuXG59KSgpIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oTkVYVF9GSUxURVIpIHtcbnZhciB1dGlsID0gcmVxdWlyZShcIi4vdXRpbC5qc1wiKTtcbnZhciBlcnJvcnMgPSByZXF1aXJlKFwiLi9lcnJvcnMuanNcIik7XG52YXIgdHJ5Q2F0Y2gxID0gdXRpbC50cnlDYXRjaDE7XG52YXIgZXJyb3JPYmogPSB1dGlsLmVycm9yT2JqO1xudmFyIGtleXMgPSByZXF1aXJlKFwiLi9lczUuanNcIikua2V5cztcbnZhciBUeXBlRXJyb3IgPSBlcnJvcnMuVHlwZUVycm9yO1xuXG5mdW5jdGlvbiBDYXRjaEZpbHRlcihpbnN0YW5jZXMsIGNhbGxiYWNrLCBwcm9taXNlKSB7XG4gICAgdGhpcy5faW5zdGFuY2VzID0gaW5zdGFuY2VzO1xuICAgIHRoaXMuX2NhbGxiYWNrID0gY2FsbGJhY2s7XG4gICAgdGhpcy5fcHJvbWlzZSA9IHByb21pc2U7XG59XG5cbmZ1bmN0aW9uIENhdGNoRmlsdGVyJF9zYWZlUHJlZGljYXRlKHByZWRpY2F0ZSwgZSkge1xuICAgIHZhciBzYWZlT2JqZWN0ID0ge307XG4gICAgdmFyIHJldGZpbHRlciA9IHRyeUNhdGNoMShwcmVkaWNhdGUsIHNhZmVPYmplY3QsIGUpO1xuXG4gICAgaWYgKHJldGZpbHRlciA9PT0gZXJyb3JPYmopIHJldHVybiByZXRmaWx0ZXI7XG5cbiAgICB2YXIgc2FmZUtleXMgPSBrZXlzKHNhZmVPYmplY3QpO1xuICAgIGlmIChzYWZlS2V5cy5sZW5ndGgpIHtcbiAgICAgICAgZXJyb3JPYmouZSA9IG5ldyBUeXBlRXJyb3IoXG4gICAgICAgICAgICBcIkNhdGNoIGZpbHRlciBtdXN0IGluaGVyaXQgZnJvbSBFcnJvciBcIlxuICAgICAgICAgICsgXCJvciBiZSBhIHNpbXBsZSBwcmVkaWNhdGUgZnVuY3Rpb25cIik7XG4gICAgICAgIHJldHVybiBlcnJvck9iajtcbiAgICB9XG4gICAgcmV0dXJuIHJldGZpbHRlcjtcbn1cblxuQ2F0Y2hGaWx0ZXIucHJvdG90eXBlLmRvRmlsdGVyID0gZnVuY3Rpb24gQ2F0Y2hGaWx0ZXIkX2RvRmlsdGVyKGUpIHtcbiAgICB2YXIgY2IgPSB0aGlzLl9jYWxsYmFjaztcbiAgICB2YXIgcHJvbWlzZSA9IHRoaXMuX3Byb21pc2U7XG4gICAgdmFyIGJvdW5kVG8gPSBwcm9taXNlLl9ib3VuZFRvO1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSB0aGlzLl9pbnN0YW5jZXMubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHtcbiAgICAgICAgdmFyIGl0ZW0gPSB0aGlzLl9pbnN0YW5jZXNbaV07XG4gICAgICAgIHZhciBpdGVtSXNFcnJvclR5cGUgPSBpdGVtID09PSBFcnJvciB8fFxuICAgICAgICAgICAgKGl0ZW0gIT0gbnVsbCAmJiBpdGVtLnByb3RvdHlwZSBpbnN0YW5jZW9mIEVycm9yKTtcblxuICAgICAgICBpZiAoaXRlbUlzRXJyb3JUeXBlICYmIGUgaW5zdGFuY2VvZiBpdGVtKSB7XG4gICAgICAgICAgICB2YXIgcmV0ID0gdHJ5Q2F0Y2gxKGNiLCBib3VuZFRvLCBlKTtcbiAgICAgICAgICAgIGlmIChyZXQgPT09IGVycm9yT2JqKSB7XG4gICAgICAgICAgICAgICAgTkVYVF9GSUxURVIuZSA9IHJldC5lO1xuICAgICAgICAgICAgICAgIHJldHVybiBORVhUX0ZJTFRFUjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGl0ZW0gPT09IFwiZnVuY3Rpb25cIiAmJiAhaXRlbUlzRXJyb3JUeXBlKSB7XG4gICAgICAgICAgICB2YXIgc2hvdWxkSGFuZGxlID0gQ2F0Y2hGaWx0ZXIkX3NhZmVQcmVkaWNhdGUoaXRlbSwgZSk7XG4gICAgICAgICAgICBpZiAoc2hvdWxkSGFuZGxlID09PSBlcnJvck9iaikge1xuICAgICAgICAgICAgICAgIHZhciB0cmFjZSA9IGVycm9ycy5jYW5BdHRhY2goZXJyb3JPYmouZSlcbiAgICAgICAgICAgICAgICAgICAgPyBlcnJvck9iai5lXG4gICAgICAgICAgICAgICAgICAgIDogbmV3IEVycm9yKGVycm9yT2JqLmUgKyBcIlwiKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9wcm9taXNlLl9hdHRhY2hFeHRyYVRyYWNlKHRyYWNlKTtcbiAgICAgICAgICAgICAgICBlID0gZXJyb3JPYmouZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc2hvdWxkSGFuZGxlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJldCA9IHRyeUNhdGNoMShjYiwgYm91bmRUbywgZSk7XG4gICAgICAgICAgICAgICAgaWYgKHJldCA9PT0gZXJyb3JPYmopIHtcbiAgICAgICAgICAgICAgICAgICAgTkVYVF9GSUxURVIuZSA9IHJldC5lO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gTkVYVF9GSUxURVI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgTkVYVF9GSUxURVIuZSA9IGU7XG4gICAgcmV0dXJuIE5FWFRfRklMVEVSO1xufTtcblxucmV0dXJuIENhdGNoRmlsdGVyO1xufTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG52YXIgdXRpbCA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIik7XG52YXIgbWF5YmVXcmFwQXNFcnJvciA9IHV0aWwubWF5YmVXcmFwQXNFcnJvcjtcbnZhciBlcnJvcnMgPSByZXF1aXJlKFwiLi9lcnJvcnMuanNcIik7XG52YXIgVGltZW91dEVycm9yID0gZXJyb3JzLlRpbWVvdXRFcnJvcjtcbnZhciBPcGVyYXRpb25hbEVycm9yID0gZXJyb3JzLk9wZXJhdGlvbmFsRXJyb3I7XG52YXIgYXN5bmMgPSByZXF1aXJlKFwiLi9hc3luYy5qc1wiKTtcbnZhciBoYXZlR2V0dGVycyA9IHV0aWwuaGF2ZUdldHRlcnM7XG52YXIgZXM1ID0gcmVxdWlyZShcIi4vZXM1LmpzXCIpO1xuXG5mdW5jdGlvbiBpc1VudHlwZWRFcnJvcihvYmopIHtcbiAgICByZXR1cm4gb2JqIGluc3RhbmNlb2YgRXJyb3IgJiZcbiAgICAgICAgZXM1LmdldFByb3RvdHlwZU9mKG9iaikgPT09IEVycm9yLnByb3RvdHlwZTtcbn1cblxuZnVuY3Rpb24gd3JhcEFzT3BlcmF0aW9uYWxFcnJvcihvYmopIHtcbiAgICB2YXIgcmV0O1xuICAgIGlmIChpc1VudHlwZWRFcnJvcihvYmopKSB7XG4gICAgICAgIHJldCA9IG5ldyBPcGVyYXRpb25hbEVycm9yKG9iaik7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0ID0gb2JqO1xuICAgIH1cbiAgICBlcnJvcnMubWFya0FzT3JpZ2luYXRpbmdGcm9tUmVqZWN0aW9uKHJldCk7XG4gICAgcmV0dXJuIHJldDtcbn1cblxuZnVuY3Rpb24gbm9kZWJhY2tGb3JQcm9taXNlKHByb21pc2UpIHtcbiAgICBmdW5jdGlvbiBQcm9taXNlUmVzb2x2ZXIkX2NhbGxiYWNrKGVyciwgdmFsdWUpIHtcbiAgICAgICAgaWYgKHByb21pc2UgPT09IG51bGwpIHJldHVybjtcblxuICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICB2YXIgd3JhcHBlZCA9IHdyYXBBc09wZXJhdGlvbmFsRXJyb3IobWF5YmVXcmFwQXNFcnJvcihlcnIpKTtcbiAgICAgICAgICAgIHByb21pc2UuX2F0dGFjaEV4dHJhVHJhY2Uod3JhcHBlZCk7XG4gICAgICAgICAgICBwcm9taXNlLl9yZWplY3Qod3JhcHBlZCk7XG4gICAgICAgIH0gZWxzZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDIpIHtcbiAgICAgICAgICAgIHZhciAkX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGg7dmFyIGFyZ3MgPSBuZXcgQXJyYXkoJF9sZW4gLSAxKTsgZm9yKHZhciAkX2kgPSAxOyAkX2kgPCAkX2xlbjsgKyskX2kpIHthcmdzWyRfaSAtIDFdID0gYXJndW1lbnRzWyRfaV07fVxuICAgICAgICAgICAgcHJvbWlzZS5fZnVsZmlsbChhcmdzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHByb21pc2UuX2Z1bGZpbGwodmFsdWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgcHJvbWlzZSA9IG51bGw7XG4gICAgfVxuICAgIHJldHVybiBQcm9taXNlUmVzb2x2ZXIkX2NhbGxiYWNrO1xufVxuXG5cbnZhciBQcm9taXNlUmVzb2x2ZXI7XG5pZiAoIWhhdmVHZXR0ZXJzKSB7XG4gICAgUHJvbWlzZVJlc29sdmVyID0gZnVuY3Rpb24gUHJvbWlzZVJlc29sdmVyKHByb21pc2UpIHtcbiAgICAgICAgdGhpcy5wcm9taXNlID0gcHJvbWlzZTtcbiAgICAgICAgdGhpcy5hc0NhbGxiYWNrID0gbm9kZWJhY2tGb3JQcm9taXNlKHByb21pc2UpO1xuICAgICAgICB0aGlzLmNhbGxiYWNrID0gdGhpcy5hc0NhbGxiYWNrO1xuICAgIH07XG59XG5lbHNlIHtcbiAgICBQcm9taXNlUmVzb2x2ZXIgPSBmdW5jdGlvbiBQcm9taXNlUmVzb2x2ZXIocHJvbWlzZSkge1xuICAgICAgICB0aGlzLnByb21pc2UgPSBwcm9taXNlO1xuICAgIH07XG59XG5pZiAoaGF2ZUdldHRlcnMpIHtcbiAgICB2YXIgcHJvcCA9IHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBub2RlYmFja0ZvclByb21pc2UodGhpcy5wcm9taXNlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgZXM1LmRlZmluZVByb3BlcnR5KFByb21pc2VSZXNvbHZlci5wcm90b3R5cGUsIFwiYXNDYWxsYmFja1wiLCBwcm9wKTtcbiAgICBlczUuZGVmaW5lUHJvcGVydHkoUHJvbWlzZVJlc29sdmVyLnByb3RvdHlwZSwgXCJjYWxsYmFja1wiLCBwcm9wKTtcbn1cblxuUHJvbWlzZVJlc29sdmVyLl9ub2RlYmFja0ZvclByb21pc2UgPSBub2RlYmFja0ZvclByb21pc2U7XG5cblByb21pc2VSZXNvbHZlci5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiBQcm9taXNlUmVzb2x2ZXIkdG9TdHJpbmcoKSB7XG4gICAgcmV0dXJuIFwiW29iamVjdCBQcm9taXNlUmVzb2x2ZXJdXCI7XG59O1xuXG5Qcm9taXNlUmVzb2x2ZXIucHJvdG90eXBlLnJlc29sdmUgPVxuUHJvbWlzZVJlc29sdmVyLnByb3RvdHlwZS5mdWxmaWxsID0gZnVuY3Rpb24gUHJvbWlzZVJlc29sdmVyJHJlc29sdmUodmFsdWUpIHtcbiAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgUHJvbWlzZVJlc29sdmVyKSkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiSWxsZWdhbCBpbnZvY2F0aW9uLCByZXNvbHZlciByZXNvbHZlL3JlamVjdCBtdXN0IGJlIGNhbGxlZCB3aXRoaW4gYSByZXNvbHZlciBjb250ZXh0LiBDb25zaWRlciB1c2luZyB0aGUgcHJvbWlzZSBjb25zdHJ1Y3RvciBpbnN0ZWFkLlwiKTtcbiAgICB9XG5cbiAgICB2YXIgcHJvbWlzZSA9IHRoaXMucHJvbWlzZTtcbiAgICBpZiAocHJvbWlzZS5fdHJ5Rm9sbG93KHZhbHVlKSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGFzeW5jLmludm9rZShwcm9taXNlLl9mdWxmaWxsLCBwcm9taXNlLCB2YWx1ZSk7XG59O1xuXG5Qcm9taXNlUmVzb2x2ZXIucHJvdG90eXBlLnJlamVjdCA9IGZ1bmN0aW9uIFByb21pc2VSZXNvbHZlciRyZWplY3QocmVhc29uKSB7XG4gICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFByb21pc2VSZXNvbHZlcikpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIklsbGVnYWwgaW52b2NhdGlvbiwgcmVzb2x2ZXIgcmVzb2x2ZS9yZWplY3QgbXVzdCBiZSBjYWxsZWQgd2l0aGluIGEgcmVzb2x2ZXIgY29udGV4dC4gQ29uc2lkZXIgdXNpbmcgdGhlIHByb21pc2UgY29uc3RydWN0b3IgaW5zdGVhZC5cIik7XG4gICAgfVxuXG4gICAgdmFyIHByb21pc2UgPSB0aGlzLnByb21pc2U7XG4gICAgZXJyb3JzLm1hcmtBc09yaWdpbmF0aW5nRnJvbVJlamVjdGlvbihyZWFzb24pO1xuICAgIHZhciB0cmFjZSA9IGVycm9ycy5jYW5BdHRhY2gocmVhc29uKSA/IHJlYXNvbiA6IG5ldyBFcnJvcihyZWFzb24gKyBcIlwiKTtcbiAgICBwcm9taXNlLl9hdHRhY2hFeHRyYVRyYWNlKHRyYWNlKTtcbiAgICBhc3luYy5pbnZva2UocHJvbWlzZS5fcmVqZWN0LCBwcm9taXNlLCByZWFzb24pO1xuICAgIGlmICh0cmFjZSAhPT0gcmVhc29uKSB7XG4gICAgICAgIGFzeW5jLmludm9rZSh0aGlzLl9zZXRDYXJyaWVkU3RhY2tUcmFjZSwgdGhpcywgdHJhY2UpO1xuICAgIH1cbn07XG5cblByb21pc2VSZXNvbHZlci5wcm90b3R5cGUucHJvZ3Jlc3MgPVxuZnVuY3Rpb24gUHJvbWlzZVJlc29sdmVyJHByb2dyZXNzKHZhbHVlKSB7XG4gICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFByb21pc2VSZXNvbHZlcikpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIklsbGVnYWwgaW52b2NhdGlvbiwgcmVzb2x2ZXIgcmVzb2x2ZS9yZWplY3QgbXVzdCBiZSBjYWxsZWQgd2l0aGluIGEgcmVzb2x2ZXIgY29udGV4dC4gQ29uc2lkZXIgdXNpbmcgdGhlIHByb21pc2UgY29uc3RydWN0b3IgaW5zdGVhZC5cIik7XG4gICAgfVxuICAgIGFzeW5jLmludm9rZSh0aGlzLnByb21pc2UuX3Byb2dyZXNzLCB0aGlzLnByb21pc2UsIHZhbHVlKTtcbn07XG5cblByb21pc2VSZXNvbHZlci5wcm90b3R5cGUuY2FuY2VsID0gZnVuY3Rpb24gUHJvbWlzZVJlc29sdmVyJGNhbmNlbCgpIHtcbiAgICBhc3luYy5pbnZva2UodGhpcy5wcm9taXNlLmNhbmNlbCwgdGhpcy5wcm9taXNlLCB2b2lkIDApO1xufTtcblxuUHJvbWlzZVJlc29sdmVyLnByb3RvdHlwZS50aW1lb3V0ID0gZnVuY3Rpb24gUHJvbWlzZVJlc29sdmVyJHRpbWVvdXQoKSB7XG4gICAgdGhpcy5yZWplY3QobmV3IFRpbWVvdXRFcnJvcihcInRpbWVvdXRcIikpO1xufTtcblxuUHJvbWlzZVJlc29sdmVyLnByb3RvdHlwZS5pc1Jlc29sdmVkID0gZnVuY3Rpb24gUHJvbWlzZVJlc29sdmVyJGlzUmVzb2x2ZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMucHJvbWlzZS5pc1Jlc29sdmVkKCk7XG59O1xuXG5Qcm9taXNlUmVzb2x2ZXIucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uIFByb21pc2VSZXNvbHZlciR0b0pTT04oKSB7XG4gICAgcmV0dXJuIHRoaXMucHJvbWlzZS50b0pTT04oKTtcbn07XG5cblByb21pc2VSZXNvbHZlci5wcm90b3R5cGUuX3NldENhcnJpZWRTdGFja1RyYWNlID1cbmZ1bmN0aW9uIFByb21pc2VSZXNvbHZlciRfc2V0Q2FycmllZFN0YWNrVHJhY2UodHJhY2UpIHtcbiAgICBpZiAodGhpcy5wcm9taXNlLmlzUmVqZWN0ZWQoKSkge1xuICAgICAgICB0aGlzLnByb21pc2UuX3NldENhcnJpZWRTdGFja1RyYWNlKHRyYWNlKTtcbiAgICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFByb21pc2VSZXNvbHZlcjtcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UsIE5FWFRfRklMVEVSLCBjYXN0KSB7XG52YXIgdXRpbCA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIik7XG52YXIgd3JhcHNQcmltaXRpdmVSZWNlaXZlciA9IHV0aWwud3JhcHNQcmltaXRpdmVSZWNlaXZlcjtcbnZhciBpc1ByaW1pdGl2ZSA9IHV0aWwuaXNQcmltaXRpdmU7XG52YXIgdGhyb3dlciA9IHV0aWwudGhyb3dlcjtcblxuZnVuY3Rpb24gcmV0dXJuVGhpcygpIHtcbiAgICByZXR1cm4gdGhpcztcbn1cbmZ1bmN0aW9uIHRocm93VGhpcygpIHtcbiAgICB0aHJvdyB0aGlzO1xufVxuZnVuY3Rpb24gcmV0dXJuJChyKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIFByb21pc2UkX3JldHVybmVyKCkge1xuICAgICAgICByZXR1cm4gcjtcbiAgICB9O1xufVxuZnVuY3Rpb24gdGhyb3ckKHIpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gUHJvbWlzZSRfdGhyb3dlcigpIHtcbiAgICAgICAgdGhyb3cgcjtcbiAgICB9O1xufVxuZnVuY3Rpb24gcHJvbWlzZWRGaW5hbGx5KHJldCwgcmVhc29uT3JWYWx1ZSwgaXNGdWxmaWxsZWQpIHtcbiAgICB2YXIgdGhlbjtcbiAgICBpZiAod3JhcHNQcmltaXRpdmVSZWNlaXZlciAmJiBpc1ByaW1pdGl2ZShyZWFzb25PclZhbHVlKSkge1xuICAgICAgICB0aGVuID0gaXNGdWxmaWxsZWQgPyByZXR1cm4kKHJlYXNvbk9yVmFsdWUpIDogdGhyb3ckKHJlYXNvbk9yVmFsdWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRoZW4gPSBpc0Z1bGZpbGxlZCA/IHJldHVyblRoaXMgOiB0aHJvd1RoaXM7XG4gICAgfVxuICAgIHJldHVybiByZXQuX3RoZW4odGhlbiwgdGhyb3dlciwgdm9pZCAwLCByZWFzb25PclZhbHVlLCB2b2lkIDApO1xufVxuXG5mdW5jdGlvbiBmaW5hbGx5SGFuZGxlcihyZWFzb25PclZhbHVlKSB7XG4gICAgdmFyIHByb21pc2UgPSB0aGlzLnByb21pc2U7XG4gICAgdmFyIGhhbmRsZXIgPSB0aGlzLmhhbmRsZXI7XG5cbiAgICB2YXIgcmV0ID0gcHJvbWlzZS5faXNCb3VuZCgpXG4gICAgICAgICAgICAgICAgICAgID8gaGFuZGxlci5jYWxsKHByb21pc2UuX2JvdW5kVG8pXG4gICAgICAgICAgICAgICAgICAgIDogaGFuZGxlcigpO1xuXG4gICAgaWYgKHJldCAhPT0gdm9pZCAwKSB7XG4gICAgICAgIHZhciBtYXliZVByb21pc2UgPSBjYXN0KHJldCwgdm9pZCAwKTtcbiAgICAgICAgaWYgKG1heWJlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlZEZpbmFsbHkobWF5YmVQcm9taXNlLCByZWFzb25PclZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvbWlzZS5pc0Z1bGZpbGxlZCgpKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmIChwcm9taXNlLmlzUmVqZWN0ZWQoKSkge1xuICAgICAgICBORVhUX0ZJTFRFUi5lID0gcmVhc29uT3JWYWx1ZTtcbiAgICAgICAgcmV0dXJuIE5FWFRfRklMVEVSO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiByZWFzb25PclZhbHVlO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gdGFwSGFuZGxlcih2YWx1ZSkge1xuICAgIHZhciBwcm9taXNlID0gdGhpcy5wcm9taXNlO1xuICAgIHZhciBoYW5kbGVyID0gdGhpcy5oYW5kbGVyO1xuXG4gICAgdmFyIHJldCA9IHByb21pc2UuX2lzQm91bmQoKVxuICAgICAgICAgICAgICAgICAgICA/IGhhbmRsZXIuY2FsbChwcm9taXNlLl9ib3VuZFRvLCB2YWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgOiBoYW5kbGVyKHZhbHVlKTtcblxuICAgIGlmIChyZXQgIT09IHZvaWQgMCkge1xuICAgICAgICB2YXIgbWF5YmVQcm9taXNlID0gY2FzdChyZXQsIHZvaWQgMCk7XG4gICAgICAgIGlmIChtYXliZVByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgICAgICByZXR1cm4gcHJvbWlzZWRGaW5hbGx5KG1heWJlUHJvbWlzZSwgdmFsdWUsIHRydWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZTtcbn1cblxuUHJvbWlzZS5wcm90b3R5cGUuX3Bhc3NUaHJvdWdoSGFuZGxlciA9XG5mdW5jdGlvbiBQcm9taXNlJF9wYXNzVGhyb3VnaEhhbmRsZXIoaGFuZGxlciwgaXNGaW5hbGx5KSB7XG4gICAgaWYgKHR5cGVvZiBoYW5kbGVyICE9PSBcImZ1bmN0aW9uXCIpIHJldHVybiB0aGlzLnRoZW4oKTtcblxuICAgIHZhciBwcm9taXNlQW5kSGFuZGxlciA9IHtcbiAgICAgICAgcHJvbWlzZTogdGhpcyxcbiAgICAgICAgaGFuZGxlcjogaGFuZGxlclxuICAgIH07XG5cbiAgICByZXR1cm4gdGhpcy5fdGhlbihcbiAgICAgICAgICAgIGlzRmluYWxseSA/IGZpbmFsbHlIYW5kbGVyIDogdGFwSGFuZGxlcixcbiAgICAgICAgICAgIGlzRmluYWxseSA/IGZpbmFsbHlIYW5kbGVyIDogdm9pZCAwLCB2b2lkIDAsXG4gICAgICAgICAgICBwcm9taXNlQW5kSGFuZGxlciwgdm9pZCAwKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLmxhc3RseSA9XG5Qcm9taXNlLnByb3RvdHlwZVtcImZpbmFsbHlcIl0gPSBmdW5jdGlvbiBQcm9taXNlJGZpbmFsbHkoaGFuZGxlcikge1xuICAgIHJldHVybiB0aGlzLl9wYXNzVGhyb3VnaEhhbmRsZXIoaGFuZGxlciwgdHJ1ZSk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS50YXAgPSBmdW5jdGlvbiBQcm9taXNlJHRhcChoYW5kbGVyKSB7XG4gICAgcmV0dXJuIHRoaXMuX3Bhc3NUaHJvdWdoSGFuZGxlcihoYW5kbGVyLCBmYWxzZSk7XG59O1xufTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG52YXIgdXRpbCA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIik7XG52YXIgaXNQcmltaXRpdmUgPSB1dGlsLmlzUHJpbWl0aXZlO1xudmFyIHdyYXBzUHJpbWl0aXZlUmVjZWl2ZXIgPSB1dGlsLndyYXBzUHJpbWl0aXZlUmVjZWl2ZXI7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSkge1xudmFyIHJldHVybmVyID0gZnVuY3Rpb24gUHJvbWlzZSRfcmV0dXJuZXIoKSB7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xudmFyIHRocm93ZXIgPSBmdW5jdGlvbiBQcm9taXNlJF90aHJvd2VyKCkge1xuICAgIHRocm93IHRoaXM7XG59O1xuXG52YXIgd3JhcHBlciA9IGZ1bmN0aW9uIFByb21pc2UkX3dyYXBwZXIodmFsdWUsIGFjdGlvbikge1xuICAgIGlmIChhY3Rpb24gPT09IDEpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIFByb21pc2UkX3Rocm93ZXIoKSB7XG4gICAgICAgICAgICB0aHJvdyB2YWx1ZTtcbiAgICAgICAgfTtcbiAgICB9IGVsc2UgaWYgKGFjdGlvbiA9PT0gMikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gUHJvbWlzZSRfcmV0dXJuZXIoKSB7XG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgIH07XG4gICAgfVxufTtcblxuXG5Qcm9taXNlLnByb3RvdHlwZVtcInJldHVyblwiXSA9XG5Qcm9taXNlLnByb3RvdHlwZS50aGVuUmV0dXJuID1cbmZ1bmN0aW9uIFByb21pc2UkdGhlblJldHVybih2YWx1ZSkge1xuICAgIGlmICh3cmFwc1ByaW1pdGl2ZVJlY2VpdmVyICYmIGlzUHJpbWl0aXZlKHZhbHVlKSkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdGhlbihcbiAgICAgICAgICAgIHdyYXBwZXIodmFsdWUsIDIpLFxuICAgICAgICAgICAgdm9pZCAwLFxuICAgICAgICAgICAgdm9pZCAwLFxuICAgICAgICAgICAgdm9pZCAwLFxuICAgICAgICAgICAgdm9pZCAwXG4gICAgICAgKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuX3RoZW4ocmV0dXJuZXIsIHZvaWQgMCwgdm9pZCAwLCB2YWx1ZSwgdm9pZCAwKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlW1widGhyb3dcIl0gPVxuUHJvbWlzZS5wcm90b3R5cGUudGhlblRocm93ID1cbmZ1bmN0aW9uIFByb21pc2UkdGhlblRocm93KHJlYXNvbikge1xuICAgIGlmICh3cmFwc1ByaW1pdGl2ZVJlY2VpdmVyICYmIGlzUHJpbWl0aXZlKHJlYXNvbikpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RoZW4oXG4gICAgICAgICAgICB3cmFwcGVyKHJlYXNvbiwgMSksXG4gICAgICAgICAgICB2b2lkIDAsXG4gICAgICAgICAgICB2b2lkIDAsXG4gICAgICAgICAgICB2b2lkIDAsXG4gICAgICAgICAgICB2b2lkIDBcbiAgICAgICApO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5fdGhlbih0aHJvd2VyLCB2b2lkIDAsIHZvaWQgMCwgcmVhc29uLCB2b2lkIDApO1xufTtcbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xubW9kdWxlLmV4cG9ydHMgPVxuZnVuY3Rpb24oUHJvbWlzZSwgUHJvbWlzZUFycmF5LCBjYXN0LCBJTlRFUk5BTCkge1xudmFyIHV0aWwgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpO1xudmFyIGNhbkV2YWx1YXRlID0gdXRpbC5jYW5FdmFsdWF0ZTtcbnZhciB0cnlDYXRjaDEgPSB1dGlsLnRyeUNhdGNoMTtcbnZhciBlcnJvck9iaiA9IHV0aWwuZXJyb3JPYmo7XG5cblxuaWYgKGNhbkV2YWx1YXRlKSB7XG4gICAgdmFyIHRoZW5DYWxsYmFjayA9IGZ1bmN0aW9uKGkpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBGdW5jdGlvbihcInZhbHVlXCIsIFwiaG9sZGVyXCIsIFwiICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgJ3VzZSBzdHJpY3QnOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgaG9sZGVyLnBJbmRleCA9IHZhbHVlOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgaG9sZGVyLmNoZWNrRnVsZmlsbG1lbnQodGhpcyk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgXCIucmVwbGFjZSgvSW5kZXgvZywgaSkpO1xuICAgIH07XG5cbiAgICB2YXIgY2FsbGVyID0gZnVuY3Rpb24oY291bnQpIHtcbiAgICAgICAgdmFyIHZhbHVlcyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8PSBjb3VudDsgKytpKSB2YWx1ZXMucHVzaChcImhvbGRlci5wXCIgKyBpKTtcbiAgICAgICAgcmV0dXJuIG5ldyBGdW5jdGlvbihcImhvbGRlclwiLCBcIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICd1c2Ugc3RyaWN0JzsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIHZhciBjYWxsYmFjayA9IGhvbGRlci5mbjsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIHJldHVybiBjYWxsYmFjayh2YWx1ZXMpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIFwiLnJlcGxhY2UoL3ZhbHVlcy9nLCB2YWx1ZXMuam9pbihcIiwgXCIpKSk7XG4gICAgfTtcbiAgICB2YXIgdGhlbkNhbGxiYWNrcyA9IFtdO1xuICAgIHZhciBjYWxsZXJzID0gW3ZvaWQgMF07XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPD0gNTsgKytpKSB7XG4gICAgICAgIHRoZW5DYWxsYmFja3MucHVzaCh0aGVuQ2FsbGJhY2soaSkpO1xuICAgICAgICBjYWxsZXJzLnB1c2goY2FsbGVyKGkpKTtcbiAgICB9XG5cbiAgICB2YXIgSG9sZGVyID0gZnVuY3Rpb24odG90YWwsIGZuKSB7XG4gICAgICAgIHRoaXMucDEgPSB0aGlzLnAyID0gdGhpcy5wMyA9IHRoaXMucDQgPSB0aGlzLnA1ID0gbnVsbDtcbiAgICAgICAgdGhpcy5mbiA9IGZuO1xuICAgICAgICB0aGlzLnRvdGFsID0gdG90YWw7XG4gICAgICAgIHRoaXMubm93ID0gMDtcbiAgICB9O1xuXG4gICAgSG9sZGVyLnByb3RvdHlwZS5jYWxsZXJzID0gY2FsbGVycztcbiAgICBIb2xkZXIucHJvdG90eXBlLmNoZWNrRnVsZmlsbG1lbnQgPSBmdW5jdGlvbihwcm9taXNlKSB7XG4gICAgICAgIHZhciBub3cgPSB0aGlzLm5vdztcbiAgICAgICAgbm93Kys7XG4gICAgICAgIHZhciB0b3RhbCA9IHRoaXMudG90YWw7XG4gICAgICAgIGlmIChub3cgPj0gdG90YWwpIHtcbiAgICAgICAgICAgIHZhciBoYW5kbGVyID0gdGhpcy5jYWxsZXJzW3RvdGFsXTtcbiAgICAgICAgICAgIHZhciByZXQgPSB0cnlDYXRjaDEoaGFuZGxlciwgdm9pZCAwLCB0aGlzKTtcbiAgICAgICAgICAgIGlmIChyZXQgPT09IGVycm9yT2JqKSB7XG4gICAgICAgICAgICAgICAgcHJvbWlzZS5fcmVqZWN0VW5jaGVja2VkKHJldC5lKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIXByb21pc2UuX3RyeUZvbGxvdyhyZXQpKSB7XG4gICAgICAgICAgICAgICAgcHJvbWlzZS5fZnVsZmlsbFVuY2hlY2tlZChyZXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5ub3cgPSBub3c7XG4gICAgICAgIH1cbiAgICB9O1xufVxuXG5cblxuXG5Qcm9taXNlLmpvaW4gPSBmdW5jdGlvbiBQcm9taXNlJEpvaW4oKSB7XG4gICAgdmFyIGxhc3QgPSBhcmd1bWVudHMubGVuZ3RoIC0gMTtcbiAgICB2YXIgZm47XG4gICAgaWYgKGxhc3QgPiAwICYmIHR5cGVvZiBhcmd1bWVudHNbbGFzdF0gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICBmbiA9IGFyZ3VtZW50c1tsYXN0XTtcbiAgICAgICAgaWYgKGxhc3QgPCA2ICYmIGNhbkV2YWx1YXRlKSB7XG4gICAgICAgICAgICB2YXIgcmV0ID0gbmV3IFByb21pc2UoSU5URVJOQUwpO1xuICAgICAgICAgICAgcmV0Ll9zZXRUcmFjZSh2b2lkIDApO1xuICAgICAgICAgICAgdmFyIGhvbGRlciA9IG5ldyBIb2xkZXIobGFzdCwgZm4pO1xuICAgICAgICAgICAgdmFyIHJlamVjdCA9IHJldC5fcmVqZWN0O1xuICAgICAgICAgICAgdmFyIGNhbGxiYWNrcyA9IHRoZW5DYWxsYmFja3M7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxhc3Q7ICsraSkge1xuICAgICAgICAgICAgICAgIHZhciBtYXliZVByb21pc2UgPSBjYXN0KGFyZ3VtZW50c1tpXSwgdm9pZCAwKTtcbiAgICAgICAgICAgICAgICBpZiAobWF5YmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobWF5YmVQcm9taXNlLmlzUGVuZGluZygpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXliZVByb21pc2UuX3RoZW4oY2FsbGJhY2tzW2ldLCByZWplY3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAwLCByZXQsIGhvbGRlcik7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobWF5YmVQcm9taXNlLmlzRnVsZmlsbGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrc1tpXS5jYWxsKHJldCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heWJlUHJvbWlzZS5fc2V0dGxlZFZhbHVlLCBob2xkZXIpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0Ll9yZWplY3QobWF5YmVQcm9taXNlLl9zZXR0bGVkVmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbWF5YmVQcm9taXNlLl91bnNldFJlamVjdGlvbklzVW5oYW5kbGVkKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjYWxsYmFja3NbaV0uY2FsbChyZXQsIG1heWJlUHJvbWlzZSwgaG9sZGVyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9XG4gICAgfVxuICAgIHZhciAkX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGg7dmFyIGFyZ3MgPSBuZXcgQXJyYXkoJF9sZW4pOyBmb3IodmFyICRfaSA9IDA7ICRfaSA8ICRfbGVuOyArKyRfaSkge2FyZ3NbJF9pXSA9IGFyZ3VtZW50c1skX2ldO31cbiAgICB2YXIgcmV0ID0gbmV3IFByb21pc2VBcnJheShhcmdzKS5wcm9taXNlKCk7XG4gICAgcmV0dXJuIGZuICE9PSB2b2lkIDAgPyByZXQuc3ByZWFkKGZuKSA6IHJldDtcbn07XG5cbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlLCBJTlRFUk5BTCwgY2FzdCkge1xudmFyIGFwaVJlamVjdGlvbiA9IHJlcXVpcmUoXCIuL2Vycm9yc19hcGlfcmVqZWN0aW9uLmpzXCIpKFByb21pc2UpO1xudmFyIGlzQXJyYXkgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpLmlzQXJyYXk7XG5cbnZhciByYWNlTGF0ZXIgPSBmdW5jdGlvbiBQcm9taXNlJF9yYWNlTGF0ZXIocHJvbWlzZSkge1xuICAgIHJldHVybiBwcm9taXNlLnRoZW4oZnVuY3Rpb24oYXJyYXkpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UkX1JhY2UoYXJyYXksIHByb21pc2UpO1xuICAgIH0pO1xufTtcblxudmFyIGhhc093biA9IHt9Lmhhc093blByb3BlcnR5O1xuZnVuY3Rpb24gUHJvbWlzZSRfUmFjZShwcm9taXNlcywgcGFyZW50KSB7XG4gICAgdmFyIG1heWJlUHJvbWlzZSA9IGNhc3QocHJvbWlzZXMsIHZvaWQgMCk7XG5cbiAgICBpZiAobWF5YmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICByZXR1cm4gcmFjZUxhdGVyKG1heWJlUHJvbWlzZSk7XG4gICAgfSBlbHNlIGlmICghaXNBcnJheShwcm9taXNlcykpIHtcbiAgICAgICAgcmV0dXJuIGFwaVJlamVjdGlvbihcImV4cGVjdGluZyBhbiBhcnJheSwgYSBwcm9taXNlIG9yIGEgdGhlbmFibGVcIik7XG4gICAgfVxuXG4gICAgdmFyIHJldCA9IG5ldyBQcm9taXNlKElOVEVSTkFMKTtcbiAgICBpZiAocGFyZW50ICE9PSB2b2lkIDApIHtcbiAgICAgICAgcmV0Ll9wcm9wYWdhdGVGcm9tKHBhcmVudCwgNyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0Ll9zZXRUcmFjZSh2b2lkIDApO1xuICAgIH1cbiAgICB2YXIgZnVsZmlsbCA9IHJldC5fZnVsZmlsbDtcbiAgICB2YXIgcmVqZWN0ID0gcmV0Ll9yZWplY3Q7XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHByb21pc2VzLmxlbmd0aDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgIHZhciB2YWwgPSBwcm9taXNlc1tpXTtcblxuICAgICAgICBpZiAodmFsID09PSB2b2lkIDAgJiYgIShoYXNPd24uY2FsbChwcm9taXNlcywgaSkpKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIFByb21pc2UuY2FzdCh2YWwpLl90aGVuKGZ1bGZpbGwsIHJlamVjdCwgdm9pZCAwLCByZXQsIG51bGwpO1xuICAgIH1cbiAgICByZXR1cm4gcmV0O1xufVxuXG5Qcm9taXNlLnJhY2UgPSBmdW5jdGlvbiBQcm9taXNlJFJhY2UocHJvbWlzZXMpIHtcbiAgICByZXR1cm4gUHJvbWlzZSRfUmFjZShwcm9taXNlcywgdm9pZCAwKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLnJhY2UgPSBmdW5jdGlvbiBQcm9taXNlJHJhY2UoKSB7XG4gICAgcmV0dXJuIFByb21pc2UkX1JhY2UodGhpcywgdm9pZCAwKTtcbn07XG5cbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xudmFyIGNyID0gT2JqZWN0LmNyZWF0ZTtcbmlmIChjcikge1xuICAgIHZhciBjYWxsZXJDYWNoZSA9IGNyKG51bGwpO1xuICAgIHZhciBnZXR0ZXJDYWNoZSA9IGNyKG51bGwpO1xuICAgIGNhbGxlckNhY2hlW1wiIHNpemVcIl0gPSBnZXR0ZXJDYWNoZVtcIiBzaXplXCJdID0gMDtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlKSB7XG52YXIgdXRpbCA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIik7XG52YXIgY2FuRXZhbHVhdGUgPSB1dGlsLmNhbkV2YWx1YXRlO1xudmFyIGlzSWRlbnRpZmllciA9IHV0aWwuaXNJZGVudGlmaWVyO1xuXG5mdW5jdGlvbiBtYWtlTWV0aG9kQ2FsbGVyIChtZXRob2ROYW1lKSB7XG4gICAgcmV0dXJuIG5ldyBGdW5jdGlvbihcIm9ialwiLCBcIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICd1c2Ugc3RyaWN0JyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgIHZhciBsZW4gPSB0aGlzLmxlbmd0aDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgIHN3aXRjaChsZW4pIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICBjYXNlIDE6IHJldHVybiBvYmoubWV0aG9kTmFtZSh0aGlzWzBdKTsgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICBjYXNlIDI6IHJldHVybiBvYmoubWV0aG9kTmFtZSh0aGlzWzBdLCB0aGlzWzFdKTsgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICBjYXNlIDM6IHJldHVybiBvYmoubWV0aG9kTmFtZSh0aGlzWzBdLCB0aGlzWzFdLCB0aGlzWzJdKTsgICAgICAgIFxcblxcXG4gICAgICAgICAgICBjYXNlIDA6IHJldHVybiBvYmoubWV0aG9kTmFtZSgpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICBkZWZhdWx0OiByZXR1cm4gb2JqLm1ldGhvZE5hbWUuYXBwbHkob2JqLCB0aGlzKTsgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgIFwiLnJlcGxhY2UoL21ldGhvZE5hbWUvZywgbWV0aG9kTmFtZSkpO1xufVxuXG5mdW5jdGlvbiBtYWtlR2V0dGVyIChwcm9wZXJ0eU5hbWUpIHtcbiAgICByZXR1cm4gbmV3IEZ1bmN0aW9uKFwib2JqXCIsIFwiICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgJ3VzZSBzdHJpY3QnOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgcmV0dXJuIG9iai5wcm9wZXJ0eU5hbWU7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgXCIucmVwbGFjZShcInByb3BlcnR5TmFtZVwiLCBwcm9wZXJ0eU5hbWUpKTtcbn1cblxuZnVuY3Rpb24gZ2V0Q29tcGlsZWQobmFtZSwgY29tcGlsZXIsIGNhY2hlKSB7XG4gICAgdmFyIHJldCA9IGNhY2hlW25hbWVdO1xuICAgIGlmICh0eXBlb2YgcmV0ICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgaWYgKCFpc0lkZW50aWZpZXIobmFtZSkpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldCA9IGNvbXBpbGVyKG5hbWUpO1xuICAgICAgICBjYWNoZVtuYW1lXSA9IHJldDtcbiAgICAgICAgY2FjaGVbXCIgc2l6ZVwiXSsrO1xuICAgICAgICBpZiAoY2FjaGVbXCIgc2l6ZVwiXSA+IDUxMikge1xuICAgICAgICAgICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhjYWNoZSk7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDI1NjsgKytpKSBkZWxldGUgY2FjaGVba2V5c1tpXV07XG4gICAgICAgICAgICBjYWNoZVtcIiBzaXplXCJdID0ga2V5cy5sZW5ndGggLSAyNTY7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJldDtcbn1cblxuZnVuY3Rpb24gZ2V0TWV0aG9kQ2FsbGVyKG5hbWUpIHtcbiAgICByZXR1cm4gZ2V0Q29tcGlsZWQobmFtZSwgbWFrZU1ldGhvZENhbGxlciwgY2FsbGVyQ2FjaGUpO1xufVxuXG5mdW5jdGlvbiBnZXRHZXR0ZXIobmFtZSkge1xuICAgIHJldHVybiBnZXRDb21waWxlZChuYW1lLCBtYWtlR2V0dGVyLCBnZXR0ZXJDYWNoZSk7XG59XG5cbmZ1bmN0aW9uIGNhbGxlcihvYmopIHtcbiAgICByZXR1cm4gb2JqW3RoaXMucG9wKCldLmFwcGx5KG9iaiwgdGhpcyk7XG59XG5Qcm9taXNlLnByb3RvdHlwZS5jYWxsID0gZnVuY3Rpb24gUHJvbWlzZSRjYWxsKG1ldGhvZE5hbWUpIHtcbiAgICB2YXIgJF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoO3ZhciBhcmdzID0gbmV3IEFycmF5KCRfbGVuIC0gMSk7IGZvcih2YXIgJF9pID0gMTsgJF9pIDwgJF9sZW47ICsrJF9pKSB7YXJnc1skX2kgLSAxXSA9IGFyZ3VtZW50c1skX2ldO31cbiAgICBpZiAoY2FuRXZhbHVhdGUpIHtcbiAgICAgICAgdmFyIG1heWJlQ2FsbGVyID0gZ2V0TWV0aG9kQ2FsbGVyKG1ldGhvZE5hbWUpO1xuICAgICAgICBpZiAobWF5YmVDYWxsZXIgIT09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl90aGVuKG1heWJlQ2FsbGVyLCB2b2lkIDAsIHZvaWQgMCwgYXJncywgdm9pZCAwKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhcmdzLnB1c2gobWV0aG9kTmFtZSk7XG4gICAgcmV0dXJuIHRoaXMuX3RoZW4oY2FsbGVyLCB2b2lkIDAsIHZvaWQgMCwgYXJncywgdm9pZCAwKTtcbn07XG5cbmZ1bmN0aW9uIG5hbWVkR2V0dGVyKG9iaikge1xuICAgIHJldHVybiBvYmpbdGhpc107XG59XG5mdW5jdGlvbiBpbmRleGVkR2V0dGVyKG9iaikge1xuICAgIHJldHVybiBvYmpbdGhpc107XG59XG5Qcm9taXNlLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiBQcm9taXNlJGdldChwcm9wZXJ0eU5hbWUpIHtcbiAgICB2YXIgaXNJbmRleCA9ICh0eXBlb2YgcHJvcGVydHlOYW1lID09PSBcIm51bWJlclwiKTtcbiAgICB2YXIgZ2V0dGVyO1xuICAgIGlmICghaXNJbmRleCkge1xuICAgICAgICBpZiAoY2FuRXZhbHVhdGUpIHtcbiAgICAgICAgICAgIHZhciBtYXliZUdldHRlciA9IGdldEdldHRlcihwcm9wZXJ0eU5hbWUpO1xuICAgICAgICAgICAgZ2V0dGVyID0gbWF5YmVHZXR0ZXIgIT09IG51bGwgPyBtYXliZUdldHRlciA6IG5hbWVkR2V0dGVyO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZ2V0dGVyID0gbmFtZWRHZXR0ZXI7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBnZXR0ZXIgPSBpbmRleGVkR2V0dGVyO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5fdGhlbihnZXR0ZXIsIHZvaWQgMCwgdm9pZCAwLCBwcm9wZXJ0eU5hbWUsIHZvaWQgMCk7XG59O1xufTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UsIGFwaVJlamVjdGlvbiwgSU5URVJOQUwsIGNhc3QpIHtcbnZhciBlcnJvcnMgPSByZXF1aXJlKFwiLi9lcnJvcnMuanNcIik7XG52YXIgVHlwZUVycm9yID0gZXJyb3JzLlR5cGVFcnJvcjtcbnZhciBkZXByZWNhdGVkID0gcmVxdWlyZShcIi4vdXRpbC5qc1wiKS5kZXByZWNhdGVkO1xudmFyIHV0aWwgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpO1xudmFyIGVycm9yT2JqID0gdXRpbC5lcnJvck9iajtcbnZhciB0cnlDYXRjaDEgPSB1dGlsLnRyeUNhdGNoMTtcbnZhciB5aWVsZEhhbmRsZXJzID0gW107XG5cbmZ1bmN0aW9uIHByb21pc2VGcm9tWWllbGRIYW5kbGVyKHZhbHVlLCB5aWVsZEhhbmRsZXJzKSB7XG4gICAgdmFyIF9lcnJvck9iaiA9IGVycm9yT2JqO1xuICAgIHZhciBfUHJvbWlzZSA9IFByb21pc2U7XG4gICAgdmFyIGxlbiA9IHlpZWxkSGFuZGxlcnMubGVuZ3RoO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyArK2kpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHRyeUNhdGNoMSh5aWVsZEhhbmRsZXJzW2ldLCB2b2lkIDAsIHZhbHVlKTtcbiAgICAgICAgaWYgKHJlc3VsdCA9PT0gX2Vycm9yT2JqKSB7XG4gICAgICAgICAgICByZXR1cm4gX1Byb21pc2UucmVqZWN0KF9lcnJvck9iai5lKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbWF5YmVQcm9taXNlID0gY2FzdChyZXN1bHQsIHByb21pc2VGcm9tWWllbGRIYW5kbGVyKTtcbiAgICAgICAgaWYgKG1heWJlUHJvbWlzZSBpbnN0YW5jZW9mIF9Qcm9taXNlKSByZXR1cm4gbWF5YmVQcm9taXNlO1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn1cblxuZnVuY3Rpb24gUHJvbWlzZVNwYXduKGdlbmVyYXRvckZ1bmN0aW9uLCByZWNlaXZlciwgeWllbGRIYW5kbGVyKSB7XG4gICAgdmFyIHByb21pc2UgPSB0aGlzLl9wcm9taXNlID0gbmV3IFByb21pc2UoSU5URVJOQUwpO1xuICAgIHByb21pc2UuX3NldFRyYWNlKHZvaWQgMCk7XG4gICAgdGhpcy5fZ2VuZXJhdG9yRnVuY3Rpb24gPSBnZW5lcmF0b3JGdW5jdGlvbjtcbiAgICB0aGlzLl9yZWNlaXZlciA9IHJlY2VpdmVyO1xuICAgIHRoaXMuX2dlbmVyYXRvciA9IHZvaWQgMDtcbiAgICB0aGlzLl95aWVsZEhhbmRsZXJzID0gdHlwZW9mIHlpZWxkSGFuZGxlciA9PT0gXCJmdW5jdGlvblwiXG4gICAgICAgID8gW3lpZWxkSGFuZGxlcl0uY29uY2F0KHlpZWxkSGFuZGxlcnMpXG4gICAgICAgIDogeWllbGRIYW5kbGVycztcbn1cblxuUHJvbWlzZVNwYXduLnByb3RvdHlwZS5wcm9taXNlID0gZnVuY3Rpb24gUHJvbWlzZVNwYXduJHByb21pc2UoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3Byb21pc2U7XG59O1xuXG5Qcm9taXNlU3Bhd24ucHJvdG90eXBlLl9ydW4gPSBmdW5jdGlvbiBQcm9taXNlU3Bhd24kX3J1bigpIHtcbiAgICB0aGlzLl9nZW5lcmF0b3IgPSB0aGlzLl9nZW5lcmF0b3JGdW5jdGlvbi5jYWxsKHRoaXMuX3JlY2VpdmVyKTtcbiAgICB0aGlzLl9yZWNlaXZlciA9XG4gICAgICAgIHRoaXMuX2dlbmVyYXRvckZ1bmN0aW9uID0gdm9pZCAwO1xuICAgIHRoaXMuX25leHQodm9pZCAwKTtcbn07XG5cblByb21pc2VTcGF3bi5wcm90b3R5cGUuX2NvbnRpbnVlID0gZnVuY3Rpb24gUHJvbWlzZVNwYXduJF9jb250aW51ZShyZXN1bHQpIHtcbiAgICBpZiAocmVzdWx0ID09PSBlcnJvck9iaikge1xuICAgICAgICB0aGlzLl9nZW5lcmF0b3IgPSB2b2lkIDA7XG4gICAgICAgIHZhciB0cmFjZSA9IGVycm9ycy5jYW5BdHRhY2gocmVzdWx0LmUpXG4gICAgICAgICAgICA/IHJlc3VsdC5lIDogbmV3IEVycm9yKHJlc3VsdC5lICsgXCJcIik7XG4gICAgICAgIHRoaXMuX3Byb21pc2UuX2F0dGFjaEV4dHJhVHJhY2UodHJhY2UpO1xuICAgICAgICB0aGlzLl9wcm9taXNlLl9yZWplY3QocmVzdWx0LmUsIHRyYWNlKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciB2YWx1ZSA9IHJlc3VsdC52YWx1ZTtcbiAgICBpZiAocmVzdWx0LmRvbmUgPT09IHRydWUpIHtcbiAgICAgICAgdGhpcy5fZ2VuZXJhdG9yID0gdm9pZCAwO1xuICAgICAgICBpZiAoIXRoaXMuX3Byb21pc2UuX3RyeUZvbGxvdyh2YWx1ZSkpIHtcbiAgICAgICAgICAgIHRoaXMuX3Byb21pc2UuX2Z1bGZpbGwodmFsdWUpO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIG1heWJlUHJvbWlzZSA9IGNhc3QodmFsdWUsIHZvaWQgMCk7XG4gICAgICAgIGlmICghKG1heWJlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpKSB7XG4gICAgICAgICAgICBtYXliZVByb21pc2UgPVxuICAgICAgICAgICAgICAgIHByb21pc2VGcm9tWWllbGRIYW5kbGVyKG1heWJlUHJvbWlzZSwgdGhpcy5feWllbGRIYW5kbGVycyk7XG4gICAgICAgICAgICBpZiAobWF5YmVQcm9taXNlID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdGhyb3cobmV3IFR5cGVFcnJvcihcIkEgdmFsdWUgd2FzIHlpZWxkZWQgdGhhdCBjb3VsZCBub3QgYmUgdHJlYXRlZCBhcyBhIHByb21pc2VcIikpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBtYXliZVByb21pc2UuX3RoZW4oXG4gICAgICAgICAgICB0aGlzLl9uZXh0LFxuICAgICAgICAgICAgdGhpcy5fdGhyb3csXG4gICAgICAgICAgICB2b2lkIDAsXG4gICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgbnVsbFxuICAgICAgICk7XG4gICAgfVxufTtcblxuUHJvbWlzZVNwYXduLnByb3RvdHlwZS5fdGhyb3cgPSBmdW5jdGlvbiBQcm9taXNlU3Bhd24kX3Rocm93KHJlYXNvbikge1xuICAgIGlmIChlcnJvcnMuY2FuQXR0YWNoKHJlYXNvbikpXG4gICAgICAgIHRoaXMuX3Byb21pc2UuX2F0dGFjaEV4dHJhVHJhY2UocmVhc29uKTtcbiAgICB0aGlzLl9jb250aW51ZShcbiAgICAgICAgdHJ5Q2F0Y2gxKHRoaXMuX2dlbmVyYXRvcltcInRocm93XCJdLCB0aGlzLl9nZW5lcmF0b3IsIHJlYXNvbilcbiAgICk7XG59O1xuXG5Qcm9taXNlU3Bhd24ucHJvdG90eXBlLl9uZXh0ID0gZnVuY3Rpb24gUHJvbWlzZVNwYXduJF9uZXh0KHZhbHVlKSB7XG4gICAgdGhpcy5fY29udGludWUoXG4gICAgICAgIHRyeUNhdGNoMSh0aGlzLl9nZW5lcmF0b3IubmV4dCwgdGhpcy5fZ2VuZXJhdG9yLCB2YWx1ZSlcbiAgICk7XG59O1xuXG5Qcm9taXNlLmNvcm91dGluZSA9XG5mdW5jdGlvbiBQcm9taXNlJENvcm91dGluZShnZW5lcmF0b3JGdW5jdGlvbiwgb3B0aW9ucykge1xuICAgIGlmICh0eXBlb2YgZ2VuZXJhdG9yRnVuY3Rpb24gIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiZ2VuZXJhdG9yRnVuY3Rpb24gbXVzdCBiZSBhIGZ1bmN0aW9uXCIpO1xuICAgIH1cbiAgICB2YXIgeWllbGRIYW5kbGVyID0gT2JqZWN0KG9wdGlvbnMpLnlpZWxkSGFuZGxlcjtcbiAgICB2YXIgUHJvbWlzZVNwYXduJCA9IFByb21pc2VTcGF3bjtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZ2VuZXJhdG9yID0gZ2VuZXJhdG9yRnVuY3Rpb24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgdmFyIHNwYXduID0gbmV3IFByb21pc2VTcGF3biQodm9pZCAwLCB2b2lkIDAsIHlpZWxkSGFuZGxlcik7XG4gICAgICAgIHNwYXduLl9nZW5lcmF0b3IgPSBnZW5lcmF0b3I7XG4gICAgICAgIHNwYXduLl9uZXh0KHZvaWQgMCk7XG4gICAgICAgIHJldHVybiBzcGF3bi5wcm9taXNlKCk7XG4gICAgfTtcbn07XG5cblByb21pc2UuY29yb3V0aW5lLmFkZFlpZWxkSGFuZGxlciA9IGZ1bmN0aW9uKGZuKSB7XG4gICAgaWYgKHR5cGVvZiBmbiAhPT0gXCJmdW5jdGlvblwiKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiZm4gbXVzdCBiZSBhIGZ1bmN0aW9uXCIpO1xuICAgIHlpZWxkSGFuZGxlcnMucHVzaChmbik7XG59O1xuXG5Qcm9taXNlLnNwYXduID0gZnVuY3Rpb24gUHJvbWlzZSRTcGF3bihnZW5lcmF0b3JGdW5jdGlvbikge1xuICAgIGRlcHJlY2F0ZWQoXCJQcm9taXNlLnNwYXduIGlzIGRlcHJlY2F0ZWQuIFVzZSBQcm9taXNlLmNvcm91dGluZSBpbnN0ZWFkLlwiKTtcbiAgICBpZiAodHlwZW9mIGdlbmVyYXRvckZ1bmN0aW9uICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgcmV0dXJuIGFwaVJlamVjdGlvbihcImdlbmVyYXRvckZ1bmN0aW9uIG11c3QgYmUgYSBmdW5jdGlvblwiKTtcbiAgICB9XG4gICAgdmFyIHNwYXduID0gbmV3IFByb21pc2VTcGF3bihnZW5lcmF0b3JGdW5jdGlvbiwgdGhpcyk7XG4gICAgdmFyIHJldCA9IHNwYXduLnByb21pc2UoKTtcbiAgICBzcGF3bi5fcnVuKFByb21pc2Uuc3Bhd24pO1xuICAgIHJldHVybiByZXQ7XG59O1xufTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UsIFByb21pc2VBcnJheSwgYXBpUmVqZWN0aW9uLCBjYXN0LCBJTlRFUk5BTCkge1xudmFyIHV0aWwgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpO1xudmFyIHRyeUNhdGNoMyA9IHV0aWwudHJ5Q2F0Y2gzO1xudmFyIGVycm9yT2JqID0gdXRpbC5lcnJvck9iajtcbnZhciBQRU5ESU5HID0ge307XG52YXIgRU1QVFlfQVJSQVkgPSBbXTtcblxuZnVuY3Rpb24gTWFwcGluZ1Byb21pc2VBcnJheShwcm9taXNlcywgZm4sIGxpbWl0LCBfZmlsdGVyKSB7XG4gICAgdGhpcy5jb25zdHJ1Y3RvciQocHJvbWlzZXMpO1xuICAgIHRoaXMuX2NhbGxiYWNrID0gZm47XG4gICAgdGhpcy5fcHJlc2VydmVkVmFsdWVzID0gX2ZpbHRlciA9PT0gSU5URVJOQUxcbiAgICAgICAgPyBuZXcgQXJyYXkodGhpcy5sZW5ndGgoKSlcbiAgICAgICAgOiBudWxsO1xuICAgIHRoaXMuX2xpbWl0ID0gbGltaXQ7XG4gICAgdGhpcy5faW5GbGlnaHQgPSAwO1xuICAgIHRoaXMuX3F1ZXVlID0gbGltaXQgPj0gMSA/IFtdIDogRU1QVFlfQVJSQVk7XG4gICAgdGhpcy5faW5pdCQodm9pZCAwLCAtMik7XG59XG51dGlsLmluaGVyaXRzKE1hcHBpbmdQcm9taXNlQXJyYXksIFByb21pc2VBcnJheSk7XG5cbk1hcHBpbmdQcm9taXNlQXJyYXkucHJvdG90eXBlLl9pbml0ID0gZnVuY3Rpb24gTWFwcGluZ1Byb21pc2VBcnJheSRfaW5pdCgpIHt9O1xuXG5NYXBwaW5nUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fcHJvbWlzZUZ1bGZpbGxlZCA9XG5mdW5jdGlvbiBNYXBwaW5nUHJvbWlzZUFycmF5JF9wcm9taXNlRnVsZmlsbGVkKHZhbHVlLCBpbmRleCkge1xuICAgIHZhciB2YWx1ZXMgPSB0aGlzLl92YWx1ZXM7XG4gICAgaWYgKHZhbHVlcyA9PT0gbnVsbCkgcmV0dXJuO1xuXG4gICAgdmFyIGxlbmd0aCA9IHRoaXMubGVuZ3RoKCk7XG4gICAgdmFyIHByZXNlcnZlZFZhbHVlcyA9IHRoaXMuX3ByZXNlcnZlZFZhbHVlcztcbiAgICB2YXIgbGltaXQgPSB0aGlzLl9saW1pdDtcbiAgICBpZiAodmFsdWVzW2luZGV4XSA9PT0gUEVORElORykge1xuICAgICAgICB2YWx1ZXNbaW5kZXhdID0gdmFsdWU7XG4gICAgICAgIGlmIChsaW1pdCA+PSAxKSB7XG4gICAgICAgICAgICB0aGlzLl9pbkZsaWdodC0tO1xuICAgICAgICAgICAgdGhpcy5fZHJhaW5RdWV1ZSgpO1xuICAgICAgICAgICAgaWYgKHRoaXMuX2lzUmVzb2x2ZWQoKSkgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGxpbWl0ID49IDEgJiYgdGhpcy5faW5GbGlnaHQgPj0gbGltaXQpIHtcbiAgICAgICAgICAgIHZhbHVlc1tpbmRleF0gPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMuX3F1ZXVlLnB1c2goaW5kZXgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwcmVzZXJ2ZWRWYWx1ZXMgIT09IG51bGwpIHByZXNlcnZlZFZhbHVlc1tpbmRleF0gPSB2YWx1ZTtcblxuICAgICAgICB2YXIgY2FsbGJhY2sgPSB0aGlzLl9jYWxsYmFjaztcbiAgICAgICAgdmFyIHJlY2VpdmVyID0gdGhpcy5fcHJvbWlzZS5fYm91bmRUbztcbiAgICAgICAgdmFyIHJldCA9IHRyeUNhdGNoMyhjYWxsYmFjaywgcmVjZWl2ZXIsIHZhbHVlLCBpbmRleCwgbGVuZ3RoKTtcbiAgICAgICAgaWYgKHJldCA9PT0gZXJyb3JPYmopIHJldHVybiB0aGlzLl9yZWplY3QocmV0LmUpO1xuXG4gICAgICAgIHZhciBtYXliZVByb21pc2UgPSBjYXN0KHJldCwgdm9pZCAwKTtcbiAgICAgICAgaWYgKG1heWJlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgICAgIGlmIChtYXliZVByb21pc2UuaXNQZW5kaW5nKCkpIHtcbiAgICAgICAgICAgICAgICBpZiAobGltaXQgPj0gMSkgdGhpcy5faW5GbGlnaHQrKztcbiAgICAgICAgICAgICAgICB2YWx1ZXNbaW5kZXhdID0gUEVORElORztcbiAgICAgICAgICAgICAgICByZXR1cm4gbWF5YmVQcm9taXNlLl9wcm94eVByb21pc2VBcnJheSh0aGlzLCBpbmRleCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG1heWJlUHJvbWlzZS5pc0Z1bGZpbGxlZCgpKSB7XG4gICAgICAgICAgICAgICAgcmV0ID0gbWF5YmVQcm9taXNlLnZhbHVlKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG1heWJlUHJvbWlzZS5fdW5zZXRSZWplY3Rpb25Jc1VuaGFuZGxlZCgpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZWplY3QobWF5YmVQcm9taXNlLnJlYXNvbigpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YWx1ZXNbaW5kZXhdID0gcmV0O1xuICAgIH1cbiAgICB2YXIgdG90YWxSZXNvbHZlZCA9ICsrdGhpcy5fdG90YWxSZXNvbHZlZDtcbiAgICBpZiAodG90YWxSZXNvbHZlZCA+PSBsZW5ndGgpIHtcbiAgICAgICAgaWYgKHByZXNlcnZlZFZhbHVlcyAhPT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5fZmlsdGVyKHZhbHVlcywgcHJlc2VydmVkVmFsdWVzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX3Jlc29sdmUodmFsdWVzKTtcbiAgICAgICAgfVxuXG4gICAgfVxufTtcblxuTWFwcGluZ1Byb21pc2VBcnJheS5wcm90b3R5cGUuX2RyYWluUXVldWUgPVxuZnVuY3Rpb24gTWFwcGluZ1Byb21pc2VBcnJheSRfZHJhaW5RdWV1ZSgpIHtcbiAgICB2YXIgcXVldWUgPSB0aGlzLl9xdWV1ZTtcbiAgICB2YXIgbGltaXQgPSB0aGlzLl9saW1pdDtcbiAgICB2YXIgdmFsdWVzID0gdGhpcy5fdmFsdWVzO1xuICAgIHdoaWxlIChxdWV1ZS5sZW5ndGggPiAwICYmIHRoaXMuX2luRmxpZ2h0IDwgbGltaXQpIHtcbiAgICAgICAgdmFyIGluZGV4ID0gcXVldWUucG9wKCk7XG4gICAgICAgIHRoaXMuX3Byb21pc2VGdWxmaWxsZWQodmFsdWVzW2luZGV4XSwgaW5kZXgpO1xuICAgIH1cbn07XG5cbk1hcHBpbmdQcm9taXNlQXJyYXkucHJvdG90eXBlLl9maWx0ZXIgPVxuZnVuY3Rpb24gTWFwcGluZ1Byb21pc2VBcnJheSRfZmlsdGVyKGJvb2xlYW5zLCB2YWx1ZXMpIHtcbiAgICB2YXIgbGVuID0gdmFsdWVzLmxlbmd0aDtcbiAgICB2YXIgcmV0ID0gbmV3IEFycmF5KGxlbik7XG4gICAgdmFyIGogPSAwO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyArK2kpIHtcbiAgICAgICAgaWYgKGJvb2xlYW5zW2ldKSByZXRbaisrXSA9IHZhbHVlc1tpXTtcbiAgICB9XG4gICAgcmV0Lmxlbmd0aCA9IGo7XG4gICAgdGhpcy5fcmVzb2x2ZShyZXQpO1xufTtcblxuTWFwcGluZ1Byb21pc2VBcnJheS5wcm90b3R5cGUucHJlc2VydmVkVmFsdWVzID1cbmZ1bmN0aW9uIE1hcHBpbmdQcm9taXNlQXJyYXkkcHJlc2VydmVWYWx1ZXMoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3ByZXNlcnZlZFZhbHVlcztcbn07XG5cbmZ1bmN0aW9uIG1hcChwcm9taXNlcywgZm4sIG9wdGlvbnMsIF9maWx0ZXIpIHtcbiAgICB2YXIgbGltaXQgPSB0eXBlb2Ygb3B0aW9ucyA9PT0gXCJvYmplY3RcIiAmJiBvcHRpb25zICE9PSBudWxsXG4gICAgICAgID8gb3B0aW9ucy5jb25jdXJyZW5jeVxuICAgICAgICA6IDA7XG4gICAgbGltaXQgPSB0eXBlb2YgbGltaXQgPT09IFwibnVtYmVyXCIgJiZcbiAgICAgICAgaXNGaW5pdGUobGltaXQpICYmIGxpbWl0ID49IDEgPyBsaW1pdCA6IDA7XG4gICAgcmV0dXJuIG5ldyBNYXBwaW5nUHJvbWlzZUFycmF5KHByb21pc2VzLCBmbiwgbGltaXQsIF9maWx0ZXIpO1xufVxuXG5Qcm9taXNlLnByb3RvdHlwZS5tYXAgPSBmdW5jdGlvbiBQcm9taXNlJG1hcChmbiwgb3B0aW9ucykge1xuICAgIGlmICh0eXBlb2YgZm4gIT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIGFwaVJlamVjdGlvbihcImZuIG11c3QgYmUgYSBmdW5jdGlvblwiKTtcblxuICAgIHJldHVybiBtYXAodGhpcywgZm4sIG9wdGlvbnMsIG51bGwpLnByb21pc2UoKTtcbn07XG5cblByb21pc2UubWFwID0gZnVuY3Rpb24gUHJvbWlzZSRNYXAocHJvbWlzZXMsIGZuLCBvcHRpb25zLCBfZmlsdGVyKSB7XG4gICAgaWYgKHR5cGVvZiBmbiAhPT0gXCJmdW5jdGlvblwiKSByZXR1cm4gYXBpUmVqZWN0aW9uKFwiZm4gbXVzdCBiZSBhIGZ1bmN0aW9uXCIpO1xuICAgIHJldHVybiBtYXAocHJvbWlzZXMsIGZuLCBvcHRpb25zLCBfZmlsdGVyKS5wcm9taXNlKCk7XG59O1xuXG5cbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlKSB7XG52YXIgdXRpbCA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIik7XG52YXIgYXN5bmMgPSByZXF1aXJlKFwiLi9hc3luYy5qc1wiKTtcbnZhciB0cnlDYXRjaDIgPSB1dGlsLnRyeUNhdGNoMjtcbnZhciB0cnlDYXRjaDEgPSB1dGlsLnRyeUNhdGNoMTtcbnZhciBlcnJvck9iaiA9IHV0aWwuZXJyb3JPYmo7XG5cbmZ1bmN0aW9uIHRocm93ZXIocikge1xuICAgIHRocm93IHI7XG59XG5cbmZ1bmN0aW9uIFByb21pc2UkX3NwcmVhZEFkYXB0ZXIodmFsLCByZWNlaXZlcikge1xuICAgIGlmICghdXRpbC5pc0FycmF5KHZhbCkpIHJldHVybiBQcm9taXNlJF9zdWNjZXNzQWRhcHRlcih2YWwsIHJlY2VpdmVyKTtcbiAgICB2YXIgcmV0ID0gdXRpbC50cnlDYXRjaEFwcGx5KHRoaXMsIFtudWxsXS5jb25jYXQodmFsKSwgcmVjZWl2ZXIpO1xuICAgIGlmIChyZXQgPT09IGVycm9yT2JqKSB7XG4gICAgICAgIGFzeW5jLmludm9rZUxhdGVyKHRocm93ZXIsIHZvaWQgMCwgcmV0LmUpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gUHJvbWlzZSRfc3VjY2Vzc0FkYXB0ZXIodmFsLCByZWNlaXZlcikge1xuICAgIHZhciBub2RlYmFjayA9IHRoaXM7XG4gICAgdmFyIHJldCA9IHZhbCA9PT0gdm9pZCAwXG4gICAgICAgID8gdHJ5Q2F0Y2gxKG5vZGViYWNrLCByZWNlaXZlciwgbnVsbClcbiAgICAgICAgOiB0cnlDYXRjaDIobm9kZWJhY2ssIHJlY2VpdmVyLCBudWxsLCB2YWwpO1xuICAgIGlmIChyZXQgPT09IGVycm9yT2JqKSB7XG4gICAgICAgIGFzeW5jLmludm9rZUxhdGVyKHRocm93ZXIsIHZvaWQgMCwgcmV0LmUpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIFByb21pc2UkX2Vycm9yQWRhcHRlcihyZWFzb24sIHJlY2VpdmVyKSB7XG4gICAgdmFyIG5vZGViYWNrID0gdGhpcztcbiAgICB2YXIgcmV0ID0gdHJ5Q2F0Y2gxKG5vZGViYWNrLCByZWNlaXZlciwgcmVhc29uKTtcbiAgICBpZiAocmV0ID09PSBlcnJvck9iaikge1xuICAgICAgICBhc3luYy5pbnZva2VMYXRlcih0aHJvd2VyLCB2b2lkIDAsIHJldC5lKTtcbiAgICB9XG59XG5cblByb21pc2UucHJvdG90eXBlLm5vZGVpZnkgPSBmdW5jdGlvbiBQcm9taXNlJG5vZGVpZnkobm9kZWJhY2ssIG9wdGlvbnMpIHtcbiAgICBpZiAodHlwZW9mIG5vZGViYWNrID09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICB2YXIgYWRhcHRlciA9IFByb21pc2UkX3N1Y2Nlc3NBZGFwdGVyO1xuICAgICAgICBpZiAob3B0aW9ucyAhPT0gdm9pZCAwICYmIE9iamVjdChvcHRpb25zKS5zcHJlYWQpIHtcbiAgICAgICAgICAgIGFkYXB0ZXIgPSBQcm9taXNlJF9zcHJlYWRBZGFwdGVyO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3RoZW4oXG4gICAgICAgICAgICBhZGFwdGVyLFxuICAgICAgICAgICAgUHJvbWlzZSRfZXJyb3JBZGFwdGVyLFxuICAgICAgICAgICAgdm9pZCAwLFxuICAgICAgICAgICAgbm9kZWJhY2ssXG4gICAgICAgICAgICB0aGlzLl9ib3VuZFRvXG4gICAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xufTtcbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlLCBQcm9taXNlQXJyYXksIGFwaVJlamVjdGlvbiwgY2FzdCwgSU5URVJOQUwpIHtcbnZhciB1dGlsID0gcmVxdWlyZShcIi4vdXRpbC5qc1wiKTtcbnZhciB0cnlDYXRjaDQgPSB1dGlsLnRyeUNhdGNoNDtcbnZhciB0cnlDYXRjaDMgPSB1dGlsLnRyeUNhdGNoMztcbnZhciBlcnJvck9iaiA9IHV0aWwuZXJyb3JPYmo7XG5mdW5jdGlvbiBSZWR1Y3Rpb25Qcm9taXNlQXJyYXkocHJvbWlzZXMsIGZuLCBhY2N1bSwgX2VhY2gpIHtcbiAgICB0aGlzLmNvbnN0cnVjdG9yJChwcm9taXNlcyk7XG4gICAgdGhpcy5fcHJlc2VydmVkVmFsdWVzID0gX2VhY2ggPT09IElOVEVSTkFMID8gW10gOiBudWxsO1xuICAgIHRoaXMuX3plcm90aElzQWNjdW0gPSAoYWNjdW0gPT09IHZvaWQgMCk7XG4gICAgdGhpcy5fZ290QWNjdW0gPSBmYWxzZTtcbiAgICB0aGlzLl9yZWR1Y2luZ0luZGV4ID0gKHRoaXMuX3plcm90aElzQWNjdW0gPyAxIDogMCk7XG4gICAgdGhpcy5fdmFsdWVzUGhhc2UgPSB1bmRlZmluZWQ7XG5cbiAgICB2YXIgbWF5YmVQcm9taXNlID0gY2FzdChhY2N1bSwgdm9pZCAwKTtcbiAgICB2YXIgcmVqZWN0ZWQgPSBmYWxzZTtcbiAgICB2YXIgaXNQcm9taXNlID0gbWF5YmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZTtcbiAgICBpZiAoaXNQcm9taXNlKSB7XG4gICAgICAgIGlmIChtYXliZVByb21pc2UuaXNQZW5kaW5nKCkpIHtcbiAgICAgICAgICAgIG1heWJlUHJvbWlzZS5fcHJveHlQcm9taXNlQXJyYXkodGhpcywgLTEpO1xuICAgICAgICB9IGVsc2UgaWYgKG1heWJlUHJvbWlzZS5pc0Z1bGZpbGxlZCgpKSB7XG4gICAgICAgICAgICBhY2N1bSA9IG1heWJlUHJvbWlzZS52YWx1ZSgpO1xuICAgICAgICAgICAgdGhpcy5fZ290QWNjdW0gPSB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbWF5YmVQcm9taXNlLl91bnNldFJlamVjdGlvbklzVW5oYW5kbGVkKCk7XG4gICAgICAgICAgICB0aGlzLl9yZWplY3QobWF5YmVQcm9taXNlLnJlYXNvbigpKTtcbiAgICAgICAgICAgIHJlamVjdGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoIShpc1Byb21pc2UgfHwgdGhpcy5femVyb3RoSXNBY2N1bSkpIHRoaXMuX2dvdEFjY3VtID0gdHJ1ZTtcbiAgICB0aGlzLl9jYWxsYmFjayA9IGZuO1xuICAgIHRoaXMuX2FjY3VtID0gYWNjdW07XG4gICAgaWYgKCFyZWplY3RlZCkgdGhpcy5faW5pdCQodm9pZCAwLCAtNSk7XG59XG51dGlsLmluaGVyaXRzKFJlZHVjdGlvblByb21pc2VBcnJheSwgUHJvbWlzZUFycmF5KTtcblxuUmVkdWN0aW9uUHJvbWlzZUFycmF5LnByb3RvdHlwZS5faW5pdCA9XG5mdW5jdGlvbiBSZWR1Y3Rpb25Qcm9taXNlQXJyYXkkX2luaXQoKSB7fTtcblxuUmVkdWN0aW9uUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fcmVzb2x2ZUVtcHR5QXJyYXkgPVxuZnVuY3Rpb24gUmVkdWN0aW9uUHJvbWlzZUFycmF5JF9yZXNvbHZlRW1wdHlBcnJheSgpIHtcbiAgICBpZiAodGhpcy5fZ290QWNjdW0gfHwgdGhpcy5femVyb3RoSXNBY2N1bSkge1xuICAgICAgICB0aGlzLl9yZXNvbHZlKHRoaXMuX3ByZXNlcnZlZFZhbHVlcyAhPT0gbnVsbFxuICAgICAgICAgICAgICAgICAgICAgICAgPyBbXSA6IHRoaXMuX2FjY3VtKTtcbiAgICB9XG59O1xuXG5SZWR1Y3Rpb25Qcm9taXNlQXJyYXkucHJvdG90eXBlLl9wcm9taXNlRnVsZmlsbGVkID1cbmZ1bmN0aW9uIFJlZHVjdGlvblByb21pc2VBcnJheSRfcHJvbWlzZUZ1bGZpbGxlZCh2YWx1ZSwgaW5kZXgpIHtcbiAgICB2YXIgdmFsdWVzID0gdGhpcy5fdmFsdWVzO1xuICAgIGlmICh2YWx1ZXMgPT09IG51bGwpIHJldHVybjtcbiAgICB2YXIgbGVuZ3RoID0gdGhpcy5sZW5ndGgoKTtcbiAgICB2YXIgcHJlc2VydmVkVmFsdWVzID0gdGhpcy5fcHJlc2VydmVkVmFsdWVzO1xuICAgIHZhciBpc0VhY2ggPSBwcmVzZXJ2ZWRWYWx1ZXMgIT09IG51bGw7XG4gICAgdmFyIGdvdEFjY3VtID0gdGhpcy5fZ290QWNjdW07XG4gICAgdmFyIHZhbHVlc1BoYXNlID0gdGhpcy5fdmFsdWVzUGhhc2U7XG4gICAgdmFyIHZhbHVlc1BoYXNlSW5kZXg7XG4gICAgaWYgKCF2YWx1ZXNQaGFzZSkge1xuICAgICAgICB2YWx1ZXNQaGFzZSA9IHRoaXMuX3ZhbHVlc1BoYXNlID0gQXJyYXkobGVuZ3RoKTtcbiAgICAgICAgZm9yICh2YWx1ZXNQaGFzZUluZGV4PTA7IHZhbHVlc1BoYXNlSW5kZXg8bGVuZ3RoOyArK3ZhbHVlc1BoYXNlSW5kZXgpIHtcbiAgICAgICAgICAgIHZhbHVlc1BoYXNlW3ZhbHVlc1BoYXNlSW5kZXhdID0gMDtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YWx1ZXNQaGFzZUluZGV4ID0gdmFsdWVzUGhhc2VbaW5kZXhdO1xuXG4gICAgaWYgKGluZGV4ID09PSAwICYmIHRoaXMuX3plcm90aElzQWNjdW0pIHtcbiAgICAgICAgaWYgKCFnb3RBY2N1bSkge1xuICAgICAgICAgICAgdGhpcy5fYWNjdW0gPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMuX2dvdEFjY3VtID0gZ290QWNjdW0gPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHZhbHVlc1BoYXNlW2luZGV4XSA9ICgodmFsdWVzUGhhc2VJbmRleCA9PT0gMClcbiAgICAgICAgICAgID8gMSA6IDIpO1xuICAgIH0gZWxzZSBpZiAoaW5kZXggPT09IC0xKSB7XG4gICAgICAgIGlmICghZ290QWNjdW0pIHtcbiAgICAgICAgICAgIHRoaXMuX2FjY3VtID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLl9nb3RBY2N1bSA9IGdvdEFjY3VtID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICh2YWx1ZXNQaGFzZUluZGV4ID09PSAwKSB7XG4gICAgICAgICAgICB2YWx1ZXNQaGFzZVtpbmRleF0gPSAxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFsdWVzUGhhc2VbaW5kZXhdID0gMjtcbiAgICAgICAgICAgIGlmIChnb3RBY2N1bSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2FjY3VtID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKCFnb3RBY2N1bSkgcmV0dXJuO1xuXG4gICAgdmFyIGNhbGxiYWNrID0gdGhpcy5fY2FsbGJhY2s7XG4gICAgdmFyIHJlY2VpdmVyID0gdGhpcy5fcHJvbWlzZS5fYm91bmRUbztcbiAgICB2YXIgcmV0O1xuXG4gICAgZm9yICh2YXIgaSA9IHRoaXMuX3JlZHVjaW5nSW5kZXg7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgICAgICB2YWx1ZXNQaGFzZUluZGV4ID0gdmFsdWVzUGhhc2VbaV07XG4gICAgICAgIGlmICh2YWx1ZXNQaGFzZUluZGV4ID09PSAyKSB7XG4gICAgICAgICAgICB0aGlzLl9yZWR1Y2luZ0luZGV4ID0gaSArIDE7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodmFsdWVzUGhhc2VJbmRleCAhPT0gMSkgcmV0dXJuO1xuXG4gICAgICAgIHZhbHVlID0gdmFsdWVzW2ldO1xuICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgICAgICBpZiAodmFsdWUuaXNGdWxmaWxsZWQoKSkge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUuX3NldHRsZWRWYWx1ZTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUuaXNQZW5kaW5nKCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhbHVlLl91bnNldFJlamVjdGlvbklzVW5oYW5kbGVkKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlamVjdCh2YWx1ZS5yZWFzb24oKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaXNFYWNoKSB7XG4gICAgICAgICAgICBwcmVzZXJ2ZWRWYWx1ZXMucHVzaCh2YWx1ZSk7XG4gICAgICAgICAgICByZXQgPSB0cnlDYXRjaDMoY2FsbGJhY2ssIHJlY2VpdmVyLCB2YWx1ZSwgaSwgbGVuZ3RoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldCA9IHRyeUNhdGNoNChjYWxsYmFjaywgcmVjZWl2ZXIsIHRoaXMuX2FjY3VtLCB2YWx1ZSwgaSwgbGVuZ3RoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChyZXQgPT09IGVycm9yT2JqKSByZXR1cm4gdGhpcy5fcmVqZWN0KHJldC5lKTtcblxuICAgICAgICB2YXIgbWF5YmVQcm9taXNlID0gY2FzdChyZXQsIHZvaWQgMCk7XG4gICAgICAgIGlmIChtYXliZVByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgICAgICBpZiAobWF5YmVQcm9taXNlLmlzUGVuZGluZygpKSB7XG4gICAgICAgICAgICAgICAgdmFsdWVzUGhhc2VbaV0gPSA0O1xuICAgICAgICAgICAgICAgIHJldHVybiBtYXliZVByb21pc2UuX3Byb3h5UHJvbWlzZUFycmF5KHRoaXMsIGkpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChtYXliZVByb21pc2UuaXNGdWxmaWxsZWQoKSkge1xuICAgICAgICAgICAgICAgIHJldCA9IG1heWJlUHJvbWlzZS52YWx1ZSgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBtYXliZVByb21pc2UuX3Vuc2V0UmVqZWN0aW9uSXNVbmhhbmRsZWQoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVqZWN0KG1heWJlUHJvbWlzZS5yZWFzb24oKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9yZWR1Y2luZ0luZGV4ID0gaSArIDE7XG4gICAgICAgIHRoaXMuX2FjY3VtID0gcmV0O1xuICAgIH1cblxuICAgIGlmICh0aGlzLl9yZWR1Y2luZ0luZGV4IDwgbGVuZ3RoKSByZXR1cm47XG4gICAgdGhpcy5fcmVzb2x2ZShpc0VhY2ggPyBwcmVzZXJ2ZWRWYWx1ZXMgOiB0aGlzLl9hY2N1bSk7XG59O1xuXG5mdW5jdGlvbiByZWR1Y2UocHJvbWlzZXMsIGZuLCBpbml0aWFsVmFsdWUsIF9lYWNoKSB7XG4gICAgaWYgKHR5cGVvZiBmbiAhPT0gXCJmdW5jdGlvblwiKSByZXR1cm4gYXBpUmVqZWN0aW9uKFwiZm4gbXVzdCBiZSBhIGZ1bmN0aW9uXCIpO1xuICAgIHZhciBhcnJheSA9IG5ldyBSZWR1Y3Rpb25Qcm9taXNlQXJyYXkocHJvbWlzZXMsIGZuLCBpbml0aWFsVmFsdWUsIF9lYWNoKTtcbiAgICByZXR1cm4gYXJyYXkucHJvbWlzZSgpO1xufVxuXG5Qcm9taXNlLnByb3RvdHlwZS5yZWR1Y2UgPSBmdW5jdGlvbiBQcm9taXNlJHJlZHVjZShmbiwgaW5pdGlhbFZhbHVlKSB7XG4gICAgcmV0dXJuIHJlZHVjZSh0aGlzLCBmbiwgaW5pdGlhbFZhbHVlLCBudWxsKTtcbn07XG5cblByb21pc2UucmVkdWNlID0gZnVuY3Rpb24gUHJvbWlzZSRSZWR1Y2UocHJvbWlzZXMsIGZuLCBpbml0aWFsVmFsdWUsIF9lYWNoKSB7XG4gICAgcmV0dXJuIHJlZHVjZShwcm9taXNlcywgZm4sIGluaXRpYWxWYWx1ZSwgX2VhY2gpO1xufTtcbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xubW9kdWxlLmV4cG9ydHMgPVxuICAgIGZ1bmN0aW9uKFByb21pc2UsIFByb21pc2VBcnJheSkge1xudmFyIFByb21pc2VJbnNwZWN0aW9uID0gUHJvbWlzZS5Qcm9taXNlSW5zcGVjdGlvbjtcbnZhciB1dGlsID0gcmVxdWlyZShcIi4vdXRpbC5qc1wiKTtcblxuZnVuY3Rpb24gU2V0dGxlZFByb21pc2VBcnJheSh2YWx1ZXMpIHtcbiAgICB0aGlzLmNvbnN0cnVjdG9yJCh2YWx1ZXMpO1xufVxudXRpbC5pbmhlcml0cyhTZXR0bGVkUHJvbWlzZUFycmF5LCBQcm9taXNlQXJyYXkpO1xuXG5TZXR0bGVkUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fcHJvbWlzZVJlc29sdmVkID1cbmZ1bmN0aW9uIFNldHRsZWRQcm9taXNlQXJyYXkkX3Byb21pc2VSZXNvbHZlZChpbmRleCwgaW5zcGVjdGlvbikge1xuICAgIHRoaXMuX3ZhbHVlc1tpbmRleF0gPSBpbnNwZWN0aW9uO1xuICAgIHZhciB0b3RhbFJlc29sdmVkID0gKyt0aGlzLl90b3RhbFJlc29sdmVkO1xuICAgIGlmICh0b3RhbFJlc29sdmVkID49IHRoaXMuX2xlbmd0aCkge1xuICAgICAgICB0aGlzLl9yZXNvbHZlKHRoaXMuX3ZhbHVlcyk7XG4gICAgfVxufTtcblxuU2V0dGxlZFByb21pc2VBcnJheS5wcm90b3R5cGUuX3Byb21pc2VGdWxmaWxsZWQgPVxuZnVuY3Rpb24gU2V0dGxlZFByb21pc2VBcnJheSRfcHJvbWlzZUZ1bGZpbGxlZCh2YWx1ZSwgaW5kZXgpIHtcbiAgICBpZiAodGhpcy5faXNSZXNvbHZlZCgpKSByZXR1cm47XG4gICAgdmFyIHJldCA9IG5ldyBQcm9taXNlSW5zcGVjdGlvbigpO1xuICAgIHJldC5fYml0RmllbGQgPSAyNjg0MzU0NTY7XG4gICAgcmV0Ll9zZXR0bGVkVmFsdWUgPSB2YWx1ZTtcbiAgICB0aGlzLl9wcm9taXNlUmVzb2x2ZWQoaW5kZXgsIHJldCk7XG59O1xuU2V0dGxlZFByb21pc2VBcnJheS5wcm90b3R5cGUuX3Byb21pc2VSZWplY3RlZCA9XG5mdW5jdGlvbiBTZXR0bGVkUHJvbWlzZUFycmF5JF9wcm9taXNlUmVqZWN0ZWQocmVhc29uLCBpbmRleCkge1xuICAgIGlmICh0aGlzLl9pc1Jlc29sdmVkKCkpIHJldHVybjtcbiAgICB2YXIgcmV0ID0gbmV3IFByb21pc2VJbnNwZWN0aW9uKCk7XG4gICAgcmV0Ll9iaXRGaWVsZCA9IDEzNDIxNzcyODtcbiAgICByZXQuX3NldHRsZWRWYWx1ZSA9IHJlYXNvbjtcbiAgICB0aGlzLl9wcm9taXNlUmVzb2x2ZWQoaW5kZXgsIHJldCk7XG59O1xuXG5Qcm9taXNlLnNldHRsZSA9IGZ1bmN0aW9uIFByb21pc2UkU2V0dGxlKHByb21pc2VzKSB7XG4gICAgcmV0dXJuIG5ldyBTZXR0bGVkUHJvbWlzZUFycmF5KHByb21pc2VzKS5wcm9taXNlKCk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5zZXR0bGUgPSBmdW5jdGlvbiBQcm9taXNlJHNldHRsZSgpIHtcbiAgICByZXR1cm4gbmV3IFNldHRsZWRQcm9taXNlQXJyYXkodGhpcykucHJvbWlzZSgpO1xufTtcbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xubW9kdWxlLmV4cG9ydHMgPVxuZnVuY3Rpb24oUHJvbWlzZSwgUHJvbWlzZUFycmF5LCBhcGlSZWplY3Rpb24pIHtcbnZhciB1dGlsID0gcmVxdWlyZShcIi4vdXRpbC5qc1wiKTtcbnZhciBSYW5nZUVycm9yID0gcmVxdWlyZShcIi4vZXJyb3JzLmpzXCIpLlJhbmdlRXJyb3I7XG52YXIgQWdncmVnYXRlRXJyb3IgPSByZXF1aXJlKFwiLi9lcnJvcnMuanNcIikuQWdncmVnYXRlRXJyb3I7XG52YXIgaXNBcnJheSA9IHV0aWwuaXNBcnJheTtcblxuXG5mdW5jdGlvbiBTb21lUHJvbWlzZUFycmF5KHZhbHVlcykge1xuICAgIHRoaXMuY29uc3RydWN0b3IkKHZhbHVlcyk7XG4gICAgdGhpcy5faG93TWFueSA9IDA7XG4gICAgdGhpcy5fdW53cmFwID0gZmFsc2U7XG4gICAgdGhpcy5faW5pdGlhbGl6ZWQgPSBmYWxzZTtcbn1cbnV0aWwuaW5oZXJpdHMoU29tZVByb21pc2VBcnJheSwgUHJvbWlzZUFycmF5KTtcblxuU29tZVByb21pc2VBcnJheS5wcm90b3R5cGUuX2luaXQgPSBmdW5jdGlvbiBTb21lUHJvbWlzZUFycmF5JF9pbml0KCkge1xuICAgIGlmICghdGhpcy5faW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAodGhpcy5faG93TWFueSA9PT0gMCkge1xuICAgICAgICB0aGlzLl9yZXNvbHZlKFtdKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLl9pbml0JCh2b2lkIDAsIC01KTtcbiAgICB2YXIgaXNBcnJheVJlc29sdmVkID0gaXNBcnJheSh0aGlzLl92YWx1ZXMpO1xuICAgIGlmICghdGhpcy5faXNSZXNvbHZlZCgpICYmXG4gICAgICAgIGlzQXJyYXlSZXNvbHZlZCAmJlxuICAgICAgICB0aGlzLl9ob3dNYW55ID4gdGhpcy5fY2FuUG9zc2libHlGdWxmaWxsKCkpIHtcbiAgICAgICAgdGhpcy5fcmVqZWN0KHRoaXMuX2dldFJhbmdlRXJyb3IodGhpcy5sZW5ndGgoKSkpO1xuICAgIH1cbn07XG5cblNvbWVQcm9taXNlQXJyYXkucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiBTb21lUHJvbWlzZUFycmF5JGluaXQoKSB7XG4gICAgdGhpcy5faW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgIHRoaXMuX2luaXQoKTtcbn07XG5cblNvbWVQcm9taXNlQXJyYXkucHJvdG90eXBlLnNldFVud3JhcCA9IGZ1bmN0aW9uIFNvbWVQcm9taXNlQXJyYXkkc2V0VW53cmFwKCkge1xuICAgIHRoaXMuX3Vud3JhcCA9IHRydWU7XG59O1xuXG5Tb21lUHJvbWlzZUFycmF5LnByb3RvdHlwZS5ob3dNYW55ID0gZnVuY3Rpb24gU29tZVByb21pc2VBcnJheSRob3dNYW55KCkge1xuICAgIHJldHVybiB0aGlzLl9ob3dNYW55O1xufTtcblxuU29tZVByb21pc2VBcnJheS5wcm90b3R5cGUuc2V0SG93TWFueSA9XG5mdW5jdGlvbiBTb21lUHJvbWlzZUFycmF5JHNldEhvd01hbnkoY291bnQpIHtcbiAgICBpZiAodGhpcy5faXNSZXNvbHZlZCgpKSByZXR1cm47XG4gICAgdGhpcy5faG93TWFueSA9IGNvdW50O1xufTtcblxuU29tZVByb21pc2VBcnJheS5wcm90b3R5cGUuX3Byb21pc2VGdWxmaWxsZWQgPVxuZnVuY3Rpb24gU29tZVByb21pc2VBcnJheSRfcHJvbWlzZUZ1bGZpbGxlZCh2YWx1ZSkge1xuICAgIGlmICh0aGlzLl9pc1Jlc29sdmVkKCkpIHJldHVybjtcbiAgICB0aGlzLl9hZGRGdWxmaWxsZWQodmFsdWUpO1xuICAgIGlmICh0aGlzLl9mdWxmaWxsZWQoKSA9PT0gdGhpcy5ob3dNYW55KCkpIHtcbiAgICAgICAgdGhpcy5fdmFsdWVzLmxlbmd0aCA9IHRoaXMuaG93TWFueSgpO1xuICAgICAgICBpZiAodGhpcy5ob3dNYW55KCkgPT09IDEgJiYgdGhpcy5fdW53cmFwKSB7XG4gICAgICAgICAgICB0aGlzLl9yZXNvbHZlKHRoaXMuX3ZhbHVlc1swXSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9yZXNvbHZlKHRoaXMuX3ZhbHVlcyk7XG4gICAgICAgIH1cbiAgICB9XG5cbn07XG5Tb21lUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fcHJvbWlzZVJlamVjdGVkID1cbmZ1bmN0aW9uIFNvbWVQcm9taXNlQXJyYXkkX3Byb21pc2VSZWplY3RlZChyZWFzb24pIHtcbiAgICBpZiAodGhpcy5faXNSZXNvbHZlZCgpKSByZXR1cm47XG4gICAgdGhpcy5fYWRkUmVqZWN0ZWQocmVhc29uKTtcbiAgICBpZiAodGhpcy5ob3dNYW55KCkgPiB0aGlzLl9jYW5Qb3NzaWJseUZ1bGZpbGwoKSkge1xuICAgICAgICB2YXIgZSA9IG5ldyBBZ2dyZWdhdGVFcnJvcigpO1xuICAgICAgICBmb3IgKHZhciBpID0gdGhpcy5sZW5ndGgoKTsgaSA8IHRoaXMuX3ZhbHVlcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgZS5wdXNoKHRoaXMuX3ZhbHVlc1tpXSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fcmVqZWN0KGUpO1xuICAgIH1cbn07XG5cblNvbWVQcm9taXNlQXJyYXkucHJvdG90eXBlLl9mdWxmaWxsZWQgPSBmdW5jdGlvbiBTb21lUHJvbWlzZUFycmF5JF9mdWxmaWxsZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3RvdGFsUmVzb2x2ZWQ7XG59O1xuXG5Tb21lUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fcmVqZWN0ZWQgPSBmdW5jdGlvbiBTb21lUHJvbWlzZUFycmF5JF9yZWplY3RlZCgpIHtcbiAgICByZXR1cm4gdGhpcy5fdmFsdWVzLmxlbmd0aCAtIHRoaXMubGVuZ3RoKCk7XG59O1xuXG5Tb21lUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fYWRkUmVqZWN0ZWQgPVxuZnVuY3Rpb24gU29tZVByb21pc2VBcnJheSRfYWRkUmVqZWN0ZWQocmVhc29uKSB7XG4gICAgdGhpcy5fdmFsdWVzLnB1c2gocmVhc29uKTtcbn07XG5cblNvbWVQcm9taXNlQXJyYXkucHJvdG90eXBlLl9hZGRGdWxmaWxsZWQgPVxuZnVuY3Rpb24gU29tZVByb21pc2VBcnJheSRfYWRkRnVsZmlsbGVkKHZhbHVlKSB7XG4gICAgdGhpcy5fdmFsdWVzW3RoaXMuX3RvdGFsUmVzb2x2ZWQrK10gPSB2YWx1ZTtcbn07XG5cblNvbWVQcm9taXNlQXJyYXkucHJvdG90eXBlLl9jYW5Qb3NzaWJseUZ1bGZpbGwgPVxuZnVuY3Rpb24gU29tZVByb21pc2VBcnJheSRfY2FuUG9zc2libHlGdWxmaWxsKCkge1xuICAgIHJldHVybiB0aGlzLmxlbmd0aCgpIC0gdGhpcy5fcmVqZWN0ZWQoKTtcbn07XG5cblNvbWVQcm9taXNlQXJyYXkucHJvdG90eXBlLl9nZXRSYW5nZUVycm9yID1cbmZ1bmN0aW9uIFNvbWVQcm9taXNlQXJyYXkkX2dldFJhbmdlRXJyb3IoY291bnQpIHtcbiAgICB2YXIgbWVzc2FnZSA9IFwiSW5wdXQgYXJyYXkgbXVzdCBjb250YWluIGF0IGxlYXN0IFwiICtcbiAgICAgICAgICAgIHRoaXMuX2hvd01hbnkgKyBcIiBpdGVtcyBidXQgY29udGFpbnMgb25seSBcIiArIGNvdW50ICsgXCIgaXRlbXNcIjtcbiAgICByZXR1cm4gbmV3IFJhbmdlRXJyb3IobWVzc2FnZSk7XG59O1xuXG5Tb21lUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fcmVzb2x2ZUVtcHR5QXJyYXkgPVxuZnVuY3Rpb24gU29tZVByb21pc2VBcnJheSRfcmVzb2x2ZUVtcHR5QXJyYXkoKSB7XG4gICAgdGhpcy5fcmVqZWN0KHRoaXMuX2dldFJhbmdlRXJyb3IoMCkpO1xufTtcblxuZnVuY3Rpb24gUHJvbWlzZSRfU29tZShwcm9taXNlcywgaG93TWFueSkge1xuICAgIGlmICgoaG93TWFueSB8IDApICE9PSBob3dNYW55IHx8IGhvd01hbnkgPCAwKSB7XG4gICAgICAgIHJldHVybiBhcGlSZWplY3Rpb24oXCJleHBlY3RpbmcgYSBwb3NpdGl2ZSBpbnRlZ2VyXCIpO1xuICAgIH1cbiAgICB2YXIgcmV0ID0gbmV3IFNvbWVQcm9taXNlQXJyYXkocHJvbWlzZXMpO1xuICAgIHZhciBwcm9taXNlID0gcmV0LnByb21pc2UoKTtcbiAgICBpZiAocHJvbWlzZS5pc1JlamVjdGVkKCkpIHtcbiAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgfVxuICAgIHJldC5zZXRIb3dNYW55KGhvd01hbnkpO1xuICAgIHJldC5pbml0KCk7XG4gICAgcmV0dXJuIHByb21pc2U7XG59XG5cblByb21pc2Uuc29tZSA9IGZ1bmN0aW9uIFByb21pc2UkU29tZShwcm9taXNlcywgaG93TWFueSkge1xuICAgIHJldHVybiBQcm9taXNlJF9Tb21lKHByb21pc2VzLCBob3dNYW55KTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLnNvbWUgPSBmdW5jdGlvbiBQcm9taXNlJHNvbWUoaG93TWFueSkge1xuICAgIHJldHVybiBQcm9taXNlJF9Tb21lKHRoaXMsIGhvd01hbnkpO1xufTtcblxuUHJvbWlzZS5fU29tZVByb21pc2VBcnJheSA9IFNvbWVQcm9taXNlQXJyYXk7XG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSwgUHJvbWlzZUFycmF5KSB7XG52YXIgdXRpbCA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIik7XG52YXIgYXN5bmMgPSByZXF1aXJlKFwiLi9hc3luYy5qc1wiKTtcbnZhciBlcnJvcnMgPSByZXF1aXJlKFwiLi9lcnJvcnMuanNcIik7XG52YXIgdHJ5Q2F0Y2gxID0gdXRpbC50cnlDYXRjaDE7XG52YXIgZXJyb3JPYmogPSB1dGlsLmVycm9yT2JqO1xuXG5Qcm9taXNlLnByb3RvdHlwZS5wcm9ncmVzc2VkID0gZnVuY3Rpb24gUHJvbWlzZSRwcm9ncmVzc2VkKGhhbmRsZXIpIHtcbiAgICByZXR1cm4gdGhpcy5fdGhlbih2b2lkIDAsIHZvaWQgMCwgaGFuZGxlciwgdm9pZCAwLCB2b2lkIDApO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3Byb2dyZXNzID0gZnVuY3Rpb24gUHJvbWlzZSRfcHJvZ3Jlc3MocHJvZ3Jlc3NWYWx1ZSkge1xuICAgIGlmICh0aGlzLl9pc0ZvbGxvd2luZ09yRnVsZmlsbGVkT3JSZWplY3RlZCgpKSByZXR1cm47XG4gICAgdGhpcy5fcHJvZ3Jlc3NVbmNoZWNrZWQocHJvZ3Jlc3NWYWx1ZSk7XG5cbn07XG5cblByb21pc2UucHJvdG90eXBlLl9wcm9ncmVzc0hhbmRsZXJBdCA9XG5mdW5jdGlvbiBQcm9taXNlJF9wcm9ncmVzc0hhbmRsZXJBdChpbmRleCkge1xuICAgIHJldHVybiBpbmRleCA9PT0gMFxuICAgICAgICA/IHRoaXMuX3Byb2dyZXNzSGFuZGxlcjBcbiAgICAgICAgOiB0aGlzWyhpbmRleCA8PCAyKSArIGluZGV4IC0gNSArIDJdO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2RvUHJvZ3Jlc3NXaXRoID1cbmZ1bmN0aW9uIFByb21pc2UkX2RvUHJvZ3Jlc3NXaXRoKHByb2dyZXNzaW9uKSB7XG4gICAgdmFyIHByb2dyZXNzVmFsdWUgPSBwcm9ncmVzc2lvbi52YWx1ZTtcbiAgICB2YXIgaGFuZGxlciA9IHByb2dyZXNzaW9uLmhhbmRsZXI7XG4gICAgdmFyIHByb21pc2UgPSBwcm9ncmVzc2lvbi5wcm9taXNlO1xuICAgIHZhciByZWNlaXZlciA9IHByb2dyZXNzaW9uLnJlY2VpdmVyO1xuXG4gICAgdmFyIHJldCA9IHRyeUNhdGNoMShoYW5kbGVyLCByZWNlaXZlciwgcHJvZ3Jlc3NWYWx1ZSk7XG4gICAgaWYgKHJldCA9PT0gZXJyb3JPYmopIHtcbiAgICAgICAgaWYgKHJldC5lICE9IG51bGwgJiZcbiAgICAgICAgICAgIHJldC5lLm5hbWUgIT09IFwiU3RvcFByb2dyZXNzUHJvcGFnYXRpb25cIikge1xuICAgICAgICAgICAgdmFyIHRyYWNlID0gZXJyb3JzLmNhbkF0dGFjaChyZXQuZSlcbiAgICAgICAgICAgICAgICA/IHJldC5lIDogbmV3IEVycm9yKHJldC5lICsgXCJcIik7XG4gICAgICAgICAgICBwcm9taXNlLl9hdHRhY2hFeHRyYVRyYWNlKHRyYWNlKTtcbiAgICAgICAgICAgIHByb21pc2UuX3Byb2dyZXNzKHJldC5lKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSBpZiAocmV0IGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICByZXQuX3RoZW4ocHJvbWlzZS5fcHJvZ3Jlc3MsIG51bGwsIG51bGwsIHByb21pc2UsIHZvaWQgMCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcHJvbWlzZS5fcHJvZ3Jlc3MocmV0KTtcbiAgICB9XG59O1xuXG5cblByb21pc2UucHJvdG90eXBlLl9wcm9ncmVzc1VuY2hlY2tlZCA9XG5mdW5jdGlvbiBQcm9taXNlJF9wcm9ncmVzc1VuY2hlY2tlZChwcm9ncmVzc1ZhbHVlKSB7XG4gICAgaWYgKCF0aGlzLmlzUGVuZGluZygpKSByZXR1cm47XG4gICAgdmFyIGxlbiA9IHRoaXMuX2xlbmd0aCgpO1xuICAgIHZhciBwcm9ncmVzcyA9IHRoaXMuX3Byb2dyZXNzO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgdmFyIGhhbmRsZXIgPSB0aGlzLl9wcm9ncmVzc0hhbmRsZXJBdChpKTtcbiAgICAgICAgdmFyIHByb21pc2UgPSB0aGlzLl9wcm9taXNlQXQoaSk7XG4gICAgICAgIGlmICghKHByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSkge1xuICAgICAgICAgICAgdmFyIHJlY2VpdmVyID0gdGhpcy5fcmVjZWl2ZXJBdChpKTtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgaGFuZGxlciA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgaGFuZGxlci5jYWxsKHJlY2VpdmVyLCBwcm9ncmVzc1ZhbHVlLCBwcm9taXNlKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVjZWl2ZXIgaW5zdGFuY2VvZiBQcm9taXNlICYmIHJlY2VpdmVyLl9pc1Byb3hpZWQoKSkge1xuICAgICAgICAgICAgICAgIHJlY2VpdmVyLl9wcm9ncmVzc1VuY2hlY2tlZChwcm9ncmVzc1ZhbHVlKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVjZWl2ZXIgaW5zdGFuY2VvZiBQcm9taXNlQXJyYXkpIHtcbiAgICAgICAgICAgICAgICByZWNlaXZlci5fcHJvbWlzZVByb2dyZXNzZWQocHJvZ3Jlc3NWYWx1ZSwgcHJvbWlzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0eXBlb2YgaGFuZGxlciA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICBhc3luYy5pbnZva2UodGhpcy5fZG9Qcm9ncmVzc1dpdGgsIHRoaXMsIHtcbiAgICAgICAgICAgICAgICBoYW5kbGVyOiBoYW5kbGVyLFxuICAgICAgICAgICAgICAgIHByb21pc2U6IHByb21pc2UsXG4gICAgICAgICAgICAgICAgcmVjZWl2ZXI6IHRoaXMuX3JlY2VpdmVyQXQoaSksXG4gICAgICAgICAgICAgICAgdmFsdWU6IHByb2dyZXNzVmFsdWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXN5bmMuaW52b2tlKHByb2dyZXNzLCBwcm9taXNlLCBwcm9ncmVzc1ZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSwgSU5URVJOQUwpIHtcbnZhciBlcnJvcnMgPSByZXF1aXJlKFwiLi9lcnJvcnMuanNcIik7XG52YXIgY2FuQXR0YWNoID0gZXJyb3JzLmNhbkF0dGFjaDtcbnZhciBhc3luYyA9IHJlcXVpcmUoXCIuL2FzeW5jLmpzXCIpO1xudmFyIENhbmNlbGxhdGlvbkVycm9yID0gZXJyb3JzLkNhbmNlbGxhdGlvbkVycm9yO1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fY2FuY2VsID0gZnVuY3Rpb24gUHJvbWlzZSRfY2FuY2VsKHJlYXNvbikge1xuICAgIGlmICghdGhpcy5pc0NhbmNlbGxhYmxlKCkpIHJldHVybiB0aGlzO1xuICAgIHZhciBwYXJlbnQ7XG4gICAgdmFyIHByb21pc2VUb1JlamVjdCA9IHRoaXM7XG4gICAgd2hpbGUgKChwYXJlbnQgPSBwcm9taXNlVG9SZWplY3QuX2NhbmNlbGxhdGlvblBhcmVudCkgIT09IHZvaWQgMCAmJlxuICAgICAgICBwYXJlbnQuaXNDYW5jZWxsYWJsZSgpKSB7XG4gICAgICAgIHByb21pc2VUb1JlamVjdCA9IHBhcmVudDtcbiAgICB9XG4gICAgcHJvbWlzZVRvUmVqZWN0Ll9hdHRhY2hFeHRyYVRyYWNlKHJlYXNvbik7XG4gICAgcHJvbWlzZVRvUmVqZWN0Ll9yZWplY3RVbmNoZWNrZWQocmVhc29uKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLmNhbmNlbCA9IGZ1bmN0aW9uIFByb21pc2UkY2FuY2VsKHJlYXNvbikge1xuICAgIGlmICghdGhpcy5pc0NhbmNlbGxhYmxlKCkpIHJldHVybiB0aGlzO1xuICAgIHJlYXNvbiA9IHJlYXNvbiAhPT0gdm9pZCAwXG4gICAgICAgID8gKGNhbkF0dGFjaChyZWFzb24pID8gcmVhc29uIDogbmV3IEVycm9yKHJlYXNvbiArIFwiXCIpKVxuICAgICAgICA6IG5ldyBDYW5jZWxsYXRpb25FcnJvcigpO1xuICAgIGFzeW5jLmludm9rZUxhdGVyKHRoaXMuX2NhbmNlbCwgdGhpcywgcmVhc29uKTtcbiAgICByZXR1cm4gdGhpcztcbn07XG5cblByb21pc2UucHJvdG90eXBlLmNhbmNlbGxhYmxlID0gZnVuY3Rpb24gUHJvbWlzZSRjYW5jZWxsYWJsZSgpIHtcbiAgICBpZiAodGhpcy5fY2FuY2VsbGFibGUoKSkgcmV0dXJuIHRoaXM7XG4gICAgdGhpcy5fc2V0Q2FuY2VsbGFibGUoKTtcbiAgICB0aGlzLl9jYW5jZWxsYXRpb25QYXJlbnQgPSB2b2lkIDA7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS51bmNhbmNlbGxhYmxlID0gZnVuY3Rpb24gUHJvbWlzZSR1bmNhbmNlbGxhYmxlKCkge1xuICAgIHZhciByZXQgPSBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG4gICAgcmV0Ll9wcm9wYWdhdGVGcm9tKHRoaXMsIDIgfCA0KTtcbiAgICByZXQuX2ZvbGxvdyh0aGlzKTtcbiAgICByZXQuX3Vuc2V0Q2FuY2VsbGFibGUoKTtcbiAgICByZXR1cm4gcmV0O1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuZm9yayA9XG5mdW5jdGlvbiBQcm9taXNlJGZvcmsoZGlkRnVsZmlsbCwgZGlkUmVqZWN0LCBkaWRQcm9ncmVzcykge1xuICAgIHZhciByZXQgPSB0aGlzLl90aGVuKGRpZEZ1bGZpbGwsIGRpZFJlamVjdCwgZGlkUHJvZ3Jlc3MsXG4gICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAwLCB2b2lkIDApO1xuXG4gICAgcmV0Ll9zZXRDYW5jZWxsYWJsZSgpO1xuICAgIHJldC5fY2FuY2VsbGF0aW9uUGFyZW50ID0gdm9pZCAwO1xuICAgIHJldHVybiByZXQ7XG59O1xufTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChQcm9taXNlLCBhcGlSZWplY3Rpb24sIGNhc3QpIHtcbiAgICB2YXIgVHlwZUVycm9yID0gcmVxdWlyZShcIi4vZXJyb3JzLmpzXCIpLlR5cGVFcnJvcjtcbiAgICB2YXIgaW5oZXJpdHMgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpLmluaGVyaXRzO1xuICAgIHZhciBQcm9taXNlSW5zcGVjdGlvbiA9IFByb21pc2UuUHJvbWlzZUluc3BlY3Rpb247XG5cbiAgICBmdW5jdGlvbiBpbnNwZWN0aW9uTWFwcGVyKGluc3BlY3Rpb25zKSB7XG4gICAgICAgIHZhciBsZW4gPSBpbnNwZWN0aW9ucy5sZW5ndGg7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBpbnNwZWN0aW9uID0gaW5zcGVjdGlvbnNbaV07XG4gICAgICAgICAgICBpZiAoaW5zcGVjdGlvbi5pc1JlamVjdGVkKCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoaW5zcGVjdGlvbi5lcnJvcigpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGluc3BlY3Rpb25zW2ldID0gaW5zcGVjdGlvbi52YWx1ZSgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpbnNwZWN0aW9ucztcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB0aHJvd2VyKGUpIHtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe3Rocm93IGU7fSwgMCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGlzcG9zZShyZXNvdXJjZXMsIGluc3BlY3Rpb24pIHtcbiAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICB2YXIgbGVuID0gcmVzb3VyY2VzLmxlbmd0aDtcbiAgICAgICAgdmFyIHJldCA9IFByb21pc2UuZGVmZXIoKTtcbiAgICAgICAgZnVuY3Rpb24gaXRlcmF0b3IoKSB7XG4gICAgICAgICAgICBpZiAoaSA+PSBsZW4pIHJldHVybiByZXQucmVzb2x2ZSgpO1xuICAgICAgICAgICAgdmFyIG1heWJlUHJvbWlzZSA9IGNhc3QocmVzb3VyY2VzW2krK10sIHZvaWQgMCk7XG4gICAgICAgICAgICBpZiAobWF5YmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSAmJlxuICAgICAgICAgICAgICAgIG1heWJlUHJvbWlzZS5faXNEaXNwb3NhYmxlKCkpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBtYXliZVByb21pc2UgPSBjYXN0KG1heWJlUHJvbWlzZS5fZ2V0RGlzcG9zZXIoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50cnlEaXNwb3NlKGluc3BlY3Rpb24pLCB2b2lkIDApO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRocm93ZXIoZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChtYXliZVByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBtYXliZVByb21pc2UuX3RoZW4oaXRlcmF0b3IsIHRocm93ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVsbCwgbnVsbCwgbnVsbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaXRlcmF0b3IoKTtcbiAgICAgICAgfVxuICAgICAgICBpdGVyYXRvcigpO1xuICAgICAgICByZXR1cm4gcmV0LnByb21pc2U7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGlzcG9zZXJTdWNjZXNzKHZhbHVlKSB7XG4gICAgICAgIHZhciBpbnNwZWN0aW9uID0gbmV3IFByb21pc2VJbnNwZWN0aW9uKCk7XG4gICAgICAgIGluc3BlY3Rpb24uX3NldHRsZWRWYWx1ZSA9IHZhbHVlO1xuICAgICAgICBpbnNwZWN0aW9uLl9iaXRGaWVsZCA9IDI2ODQzNTQ1NjtcbiAgICAgICAgcmV0dXJuIGRpc3Bvc2UodGhpcywgaW5zcGVjdGlvbikudGhlblJldHVybih2YWx1ZSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGlzcG9zZXJGYWlsKHJlYXNvbikge1xuICAgICAgICB2YXIgaW5zcGVjdGlvbiA9IG5ldyBQcm9taXNlSW5zcGVjdGlvbigpO1xuICAgICAgICBpbnNwZWN0aW9uLl9zZXR0bGVkVmFsdWUgPSByZWFzb247XG4gICAgICAgIGluc3BlY3Rpb24uX2JpdEZpZWxkID0gMTM0MjE3NzI4O1xuICAgICAgICByZXR1cm4gZGlzcG9zZSh0aGlzLCBpbnNwZWN0aW9uKS50aGVuVGhyb3cocmVhc29uKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBEaXNwb3NlcihkYXRhLCBwcm9taXNlKSB7XG4gICAgICAgIHRoaXMuX2RhdGEgPSBkYXRhO1xuICAgICAgICB0aGlzLl9wcm9taXNlID0gcHJvbWlzZTtcbiAgICB9XG5cbiAgICBEaXNwb3Nlci5wcm90b3R5cGUuZGF0YSA9IGZ1bmN0aW9uIERpc3Bvc2VyJGRhdGEoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9kYXRhO1xuICAgIH07XG5cbiAgICBEaXNwb3Nlci5wcm90b3R5cGUucHJvbWlzZSA9IGZ1bmN0aW9uIERpc3Bvc2VyJHByb21pc2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wcm9taXNlO1xuICAgIH07XG5cbiAgICBEaXNwb3Nlci5wcm90b3R5cGUucmVzb3VyY2UgPSBmdW5jdGlvbiBEaXNwb3NlciRyZXNvdXJjZSgpIHtcbiAgICAgICAgaWYgKHRoaXMucHJvbWlzZSgpLmlzRnVsZmlsbGVkKCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb21pc2UoKS52YWx1ZSgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG5cbiAgICBEaXNwb3Nlci5wcm90b3R5cGUudHJ5RGlzcG9zZSA9IGZ1bmN0aW9uKGluc3BlY3Rpb24pIHtcbiAgICAgICAgdmFyIHJlc291cmNlID0gdGhpcy5yZXNvdXJjZSgpO1xuICAgICAgICB2YXIgcmV0ID0gcmVzb3VyY2UgIT09IG51bGxcbiAgICAgICAgICAgID8gdGhpcy5kb0Rpc3Bvc2UocmVzb3VyY2UsIGluc3BlY3Rpb24pIDogbnVsbDtcbiAgICAgICAgdGhpcy5fcHJvbWlzZS5fdW5zZXREaXNwb3NhYmxlKCk7XG4gICAgICAgIHRoaXMuX2RhdGEgPSB0aGlzLl9wcm9taXNlID0gbnVsbDtcbiAgICAgICAgcmV0dXJuIHJldDtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gRnVuY3Rpb25EaXNwb3NlcihmbiwgcHJvbWlzZSkge1xuICAgICAgICB0aGlzLmNvbnN0cnVjdG9yJChmbiwgcHJvbWlzZSk7XG4gICAgfVxuICAgIGluaGVyaXRzKEZ1bmN0aW9uRGlzcG9zZXIsIERpc3Bvc2VyKTtcblxuICAgIEZ1bmN0aW9uRGlzcG9zZXIucHJvdG90eXBlLmRvRGlzcG9zZSA9IGZ1bmN0aW9uIChyZXNvdXJjZSwgaW5zcGVjdGlvbikge1xuICAgICAgICB2YXIgZm4gPSB0aGlzLmRhdGEoKTtcbiAgICAgICAgcmV0dXJuIGZuLmNhbGwocmVzb3VyY2UsIHJlc291cmNlLCBpbnNwZWN0aW9uKTtcbiAgICB9O1xuXG4gICAgUHJvbWlzZS51c2luZyA9IGZ1bmN0aW9uIFByb21pc2UkdXNpbmcoKSB7XG4gICAgICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoO1xuICAgICAgICBpZiAobGVuIDwgMikgcmV0dXJuIGFwaVJlamVjdGlvbihcbiAgICAgICAgICAgICAgICAgICAgICAgIFwieW91IG11c3QgcGFzcyBhdCBsZWFzdCAyIGFyZ3VtZW50cyB0byBQcm9taXNlLnVzaW5nXCIpO1xuICAgICAgICB2YXIgZm4gPSBhcmd1bWVudHNbbGVuIC0gMV07XG4gICAgICAgIGlmICh0eXBlb2YgZm4gIT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIGFwaVJlamVjdGlvbihcImZuIG11c3QgYmUgYSBmdW5jdGlvblwiKTtcbiAgICAgICAgbGVuLS07XG4gICAgICAgIHZhciByZXNvdXJjZXMgPSBuZXcgQXJyYXkobGVuKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47ICsraSkge1xuICAgICAgICAgICAgdmFyIHJlc291cmNlID0gYXJndW1lbnRzW2ldO1xuICAgICAgICAgICAgaWYgKHJlc291cmNlIGluc3RhbmNlb2YgRGlzcG9zZXIpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGlzcG9zZXIgPSByZXNvdXJjZTtcbiAgICAgICAgICAgICAgICByZXNvdXJjZSA9IHJlc291cmNlLnByb21pc2UoKTtcbiAgICAgICAgICAgICAgICByZXNvdXJjZS5fc2V0RGlzcG9zYWJsZShkaXNwb3Nlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXNvdXJjZXNbaV0gPSByZXNvdXJjZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBQcm9taXNlLnNldHRsZShyZXNvdXJjZXMpXG4gICAgICAgICAgICAudGhlbihpbnNwZWN0aW9uTWFwcGVyKVxuICAgICAgICAgICAgLnNwcmVhZChmbilcbiAgICAgICAgICAgIC5fdGhlbihkaXNwb3NlclN1Y2Nlc3MsIGRpc3Bvc2VyRmFpbCwgdm9pZCAwLCByZXNvdXJjZXMsIHZvaWQgMCk7XG4gICAgfTtcblxuICAgIFByb21pc2UucHJvdG90eXBlLl9zZXREaXNwb3NhYmxlID1cbiAgICBmdW5jdGlvbiBQcm9taXNlJF9zZXREaXNwb3NhYmxlKGRpc3Bvc2VyKSB7XG4gICAgICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgfCAyNjIxNDQ7XG4gICAgICAgIHRoaXMuX2Rpc3Bvc2VyID0gZGlzcG9zZXI7XG4gICAgfTtcblxuICAgIFByb21pc2UucHJvdG90eXBlLl9pc0Rpc3Bvc2FibGUgPSBmdW5jdGlvbiBQcm9taXNlJF9pc0Rpc3Bvc2FibGUoKSB7XG4gICAgICAgIHJldHVybiAodGhpcy5fYml0RmllbGQgJiAyNjIxNDQpID4gMDtcbiAgICB9O1xuXG4gICAgUHJvbWlzZS5wcm90b3R5cGUuX2dldERpc3Bvc2VyID0gZnVuY3Rpb24gUHJvbWlzZSRfZ2V0RGlzcG9zZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9kaXNwb3NlcjtcbiAgICB9O1xuXG4gICAgUHJvbWlzZS5wcm90b3R5cGUuX3Vuc2V0RGlzcG9zYWJsZSA9IGZ1bmN0aW9uIFByb21pc2UkX3Vuc2V0RGlzcG9zYWJsZSgpIHtcbiAgICAgICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCAmICh+MjYyMTQ0KTtcbiAgICAgICAgdGhpcy5fZGlzcG9zZXIgPSB2b2lkIDA7XG4gICAgfTtcblxuICAgIFByb21pc2UucHJvdG90eXBlLmRpc3Bvc2VyID0gZnVuY3Rpb24gUHJvbWlzZSRkaXNwb3Nlcihmbikge1xuICAgICAgICBpZiAodHlwZW9mIGZuID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgRnVuY3Rpb25EaXNwb3NlcihmbiwgdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigpO1xuICAgIH07XG5cbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlKSB7XG52YXIgVHlwZUVycm9yID0gcmVxdWlyZSgnLi9lcnJvcnMuanMnKS5UeXBlRXJyb3I7XG5cbmZ1bmN0aW9uIGFwaVJlamVjdGlvbihtc2cpIHtcbiAgICB2YXIgZXJyb3IgPSBuZXcgVHlwZUVycm9yKG1zZyk7XG4gICAgdmFyIHJldCA9IFByb21pc2UucmVqZWN0ZWQoZXJyb3IpO1xuICAgIHZhciBwYXJlbnQgPSByZXQuX3BlZWtDb250ZXh0KCk7XG4gICAgaWYgKHBhcmVudCAhPSBudWxsKSB7XG4gICAgICAgIHBhcmVudC5fYXR0YWNoRXh0cmFUcmFjZShlcnJvcik7XG4gICAgfVxuICAgIHJldHVybiByZXQ7XG59XG5cbnJldHVybiBhcGlSZWplY3Rpb247XG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbnZhciBfc2V0VGltZW91dCA9IGZ1bmN0aW9uKGZuLCBtcykge1xuICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoO1xuICAgIHZhciBhcmcwID0gYXJndW1lbnRzWzJdO1xuICAgIHZhciBhcmcxID0gYXJndW1lbnRzWzNdO1xuICAgIHZhciBhcmcyID0gbGVuID49IDUgPyBhcmd1bWVudHNbNF0gOiB2b2lkIDA7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgZm4oYXJnMCwgYXJnMSwgYXJnMik7XG4gICAgfSwgbXMpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlLCBJTlRFUk5BTCwgY2FzdCkge1xudmFyIHV0aWwgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpO1xudmFyIGVycm9ycyA9IHJlcXVpcmUoXCIuL2Vycm9ycy5qc1wiKTtcbnZhciBhcGlSZWplY3Rpb24gPSByZXF1aXJlKFwiLi9lcnJvcnNfYXBpX3JlamVjdGlvblwiKShQcm9taXNlKTtcbnZhciBUaW1lb3V0RXJyb3IgPSBQcm9taXNlLlRpbWVvdXRFcnJvcjtcblxudmFyIGFmdGVyVGltZW91dCA9IGZ1bmN0aW9uIFByb21pc2UkX2FmdGVyVGltZW91dChwcm9taXNlLCBtZXNzYWdlLCBtcykge1xuICAgIGlmICghcHJvbWlzZS5pc1BlbmRpbmcoKSkgcmV0dXJuO1xuICAgIGlmICh0eXBlb2YgbWVzc2FnZSAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICBtZXNzYWdlID0gXCJvcGVyYXRpb24gdGltZWQgb3V0IGFmdGVyXCIgKyBcIiBcIiArIG1zICsgXCIgbXNcIlxuICAgIH1cbiAgICB2YXIgZXJyID0gbmV3IFRpbWVvdXRFcnJvcihtZXNzYWdlKTtcbiAgICBlcnJvcnMubWFya0FzT3JpZ2luYXRpbmdGcm9tUmVqZWN0aW9uKGVycik7XG4gICAgcHJvbWlzZS5fYXR0YWNoRXh0cmFUcmFjZShlcnIpO1xuICAgIHByb21pc2UuX2NhbmNlbChlcnIpO1xufTtcblxudmFyIGFmdGVyRGVsYXkgPSBmdW5jdGlvbiBQcm9taXNlJF9hZnRlckRlbGF5KHZhbHVlLCBwcm9taXNlKSB7XG4gICAgcHJvbWlzZS5fZnVsZmlsbCh2YWx1ZSk7XG59O1xuXG52YXIgZGVsYXkgPSBQcm9taXNlLmRlbGF5ID0gZnVuY3Rpb24gUHJvbWlzZSREZWxheSh2YWx1ZSwgbXMpIHtcbiAgICBpZiAobXMgPT09IHZvaWQgMCkge1xuICAgICAgICBtcyA9IHZhbHVlO1xuICAgICAgICB2YWx1ZSA9IHZvaWQgMDtcbiAgICB9XG4gICAgbXMgPSArbXM7XG4gICAgdmFyIG1heWJlUHJvbWlzZSA9IGNhc3QodmFsdWUsIHZvaWQgMCk7XG4gICAgdmFyIHByb21pc2UgPSBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG5cbiAgICBpZiAobWF5YmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICBwcm9taXNlLl9wcm9wYWdhdGVGcm9tKG1heWJlUHJvbWlzZSwgNyk7XG4gICAgICAgIHByb21pc2UuX2ZvbGxvdyhtYXliZVByb21pc2UpO1xuICAgICAgICByZXR1cm4gcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5kZWxheSh2YWx1ZSwgbXMpO1xuICAgICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBwcm9taXNlLl9zZXRUcmFjZSh2b2lkIDApO1xuICAgICAgICBfc2V0VGltZW91dChhZnRlckRlbGF5LCBtcywgdmFsdWUsIHByb21pc2UpO1xuICAgIH1cbiAgICByZXR1cm4gcHJvbWlzZTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLmRlbGF5ID0gZnVuY3Rpb24gUHJvbWlzZSRkZWxheShtcykge1xuICAgIHJldHVybiBkZWxheSh0aGlzLCBtcyk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS50aW1lb3V0ID0gZnVuY3Rpb24gUHJvbWlzZSR0aW1lb3V0KG1zLCBtZXNzYWdlKSB7XG4gICAgbXMgPSArbXM7XG5cbiAgICB2YXIgcmV0ID0gbmV3IFByb21pc2UoSU5URVJOQUwpO1xuICAgIHJldC5fcHJvcGFnYXRlRnJvbSh0aGlzLCA3KTtcbiAgICByZXQuX2ZvbGxvdyh0aGlzKTtcbiAgICBfc2V0VGltZW91dChhZnRlclRpbWVvdXQsIG1zLCByZXQsIG1lc3NhZ2UsIG1zKTtcbiAgICByZXR1cm4gcmV0LmNhbmNlbGxhYmxlKCk7XG59O1xuXG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSwgSU5URVJOQUwpIHtcbnZhciBUSElTID0ge307XG52YXIgdXRpbCA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIik7XG52YXIgbm9kZWJhY2tGb3JQcm9taXNlID0gcmVxdWlyZShcIi4vcHJvbWlzZV9yZXNvbHZlci5qc1wiKVxuICAgIC5fbm9kZWJhY2tGb3JQcm9taXNlO1xudmFyIHdpdGhBcHBlbmRlZCA9IHV0aWwud2l0aEFwcGVuZGVkO1xudmFyIG1heWJlV3JhcEFzRXJyb3IgPSB1dGlsLm1heWJlV3JhcEFzRXJyb3I7XG52YXIgY2FuRXZhbHVhdGUgPSB1dGlsLmNhbkV2YWx1YXRlO1xudmFyIFR5cGVFcnJvciA9IHJlcXVpcmUoXCIuL2Vycm9yc1wiKS5UeXBlRXJyb3I7XG52YXIgZGVmYXVsdFN1ZmZpeCA9IFwiQXN5bmNcIjtcbnZhciBkZWZhdWx0RmlsdGVyID0gZnVuY3Rpb24obmFtZSwgZnVuYykge1xuICAgIHJldHVybiB1dGlsLmlzSWRlbnRpZmllcihuYW1lKSAmJlxuICAgICAgICBuYW1lLmNoYXJBdCgwKSAhPT0gXCJfXCIgJiZcbiAgICAgICAgIXV0aWwuaXNDbGFzcyhmdW5jKTtcbn07XG52YXIgZGVmYXVsdFByb21pc2lmaWVkID0ge19faXNQcm9taXNpZmllZF9fOiB0cnVlfTtcblxuXG5mdW5jdGlvbiBlc2NhcGVJZGVudFJlZ2V4KHN0cikge1xuICAgIHJldHVybiBzdHIucmVwbGFjZSgvKFskXSkvLCBcIlxcXFwkXCIpO1xufVxuXG5mdW5jdGlvbiBpc1Byb21pc2lmaWVkKGZuKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIGZuLl9faXNQcm9taXNpZmllZF9fID09PSB0cnVlO1xuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBoYXNQcm9taXNpZmllZChvYmosIGtleSwgc3VmZml4KSB7XG4gICAgdmFyIHZhbCA9IHV0aWwuZ2V0RGF0YVByb3BlcnR5T3JEZWZhdWx0KG9iaiwga2V5ICsgc3VmZml4LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0UHJvbWlzaWZpZWQpO1xuICAgIHJldHVybiB2YWwgPyBpc1Byb21pc2lmaWVkKHZhbCkgOiBmYWxzZTtcbn1cbmZ1bmN0aW9uIGNoZWNrVmFsaWQocmV0LCBzdWZmaXgsIHN1ZmZpeFJlZ2V4cCkge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmV0Lmxlbmd0aDsgaSArPSAyKSB7XG4gICAgICAgIHZhciBrZXkgPSByZXRbaV07XG4gICAgICAgIGlmIChzdWZmaXhSZWdleHAudGVzdChrZXkpKSB7XG4gICAgICAgICAgICB2YXIga2V5V2l0aG91dEFzeW5jU3VmZml4ID0ga2V5LnJlcGxhY2Uoc3VmZml4UmVnZXhwLCBcIlwiKTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgcmV0Lmxlbmd0aDsgaiArPSAyKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJldFtqXSA9PT0ga2V5V2l0aG91dEFzeW5jU3VmZml4KSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgcHJvbWlzaWZ5IGFuIEFQSSBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcInRoYXQgaGFzIG5vcm1hbCBtZXRob2RzIHdpdGggJ1wiK3N1ZmZpeCtcIictc3VmZml4XCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gcHJvbWlzaWZpYWJsZU1ldGhvZHMob2JqLCBzdWZmaXgsIHN1ZmZpeFJlZ2V4cCwgZmlsdGVyKSB7XG4gICAgdmFyIGtleXMgPSB1dGlsLmluaGVyaXRlZERhdGFLZXlzKG9iaik7XG4gICAgdmFyIHJldCA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7ICsraSkge1xuICAgICAgICB2YXIga2V5ID0ga2V5c1tpXTtcbiAgICAgICAgdmFyIHZhbHVlID0gb2JqW2tleV07XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwiZnVuY3Rpb25cIiAmJlxuICAgICAgICAgICAgIWlzUHJvbWlzaWZpZWQodmFsdWUpICYmXG4gICAgICAgICAgICAhaGFzUHJvbWlzaWZpZWQob2JqLCBrZXksIHN1ZmZpeCkgJiZcbiAgICAgICAgICAgIGZpbHRlcihrZXksIHZhbHVlLCBvYmopKSB7XG4gICAgICAgICAgICByZXQucHVzaChrZXksIHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjaGVja1ZhbGlkKHJldCwgc3VmZml4LCBzdWZmaXhSZWdleHApO1xuICAgIHJldHVybiByZXQ7XG59XG5cbmZ1bmN0aW9uIHN3aXRjaENhc2VBcmd1bWVudE9yZGVyKGxpa2VseUFyZ3VtZW50Q291bnQpIHtcbiAgICB2YXIgcmV0ID0gW2xpa2VseUFyZ3VtZW50Q291bnRdO1xuICAgIHZhciBtaW4gPSBNYXRoLm1heCgwLCBsaWtlbHlBcmd1bWVudENvdW50IC0gMSAtIDUpO1xuICAgIGZvcih2YXIgaSA9IGxpa2VseUFyZ3VtZW50Q291bnQgLSAxOyBpID49IG1pbjsgLS1pKSB7XG4gICAgICAgIGlmIChpID09PSBsaWtlbHlBcmd1bWVudENvdW50KSBjb250aW51ZTtcbiAgICAgICAgcmV0LnB1c2goaSk7XG4gICAgfVxuICAgIGZvcih2YXIgaSA9IGxpa2VseUFyZ3VtZW50Q291bnQgKyAxOyBpIDw9IDU7ICsraSkge1xuICAgICAgICByZXQucHVzaChpKTtcbiAgICB9XG4gICAgcmV0dXJuIHJldDtcbn1cblxuZnVuY3Rpb24gYXJndW1lbnRTZXF1ZW5jZShhcmd1bWVudENvdW50KSB7XG4gICAgcmV0dXJuIHV0aWwuZmlsbGVkUmFuZ2UoYXJndW1lbnRDb3VudCwgXCJhcmd1bWVudHNbXCIsIFwiXVwiKTtcbn1cblxuZnVuY3Rpb24gcGFyYW1ldGVyRGVjbGFyYXRpb24ocGFyYW1ldGVyQ291bnQpIHtcbiAgICByZXR1cm4gdXRpbC5maWxsZWRSYW5nZShwYXJhbWV0ZXJDb3VudCwgXCJfYXJnXCIsIFwiXCIpO1xufVxuXG5mdW5jdGlvbiBwYXJhbWV0ZXJDb3VudChmbikge1xuICAgIGlmICh0eXBlb2YgZm4ubGVuZ3RoID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgIHJldHVybiBNYXRoLm1heChNYXRoLm1pbihmbi5sZW5ndGgsIDEwMjMgKyAxKSwgMCk7XG4gICAgfVxuICAgIHJldHVybiAwO1xufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZVByb3BlcnR5QWNjZXNzKGtleSkge1xuICAgIGlmICh1dGlsLmlzSWRlbnRpZmllcihrZXkpKSB7XG4gICAgICAgIHJldHVybiBcIi5cIiArIGtleTtcbiAgICB9XG4gICAgZWxzZSByZXR1cm4gXCJbJ1wiICsga2V5LnJlcGxhY2UoLyhbJ1xcXFxdKS9nLCBcIlxcXFwkMVwiKSArIFwiJ11cIjtcbn1cblxuZnVuY3Rpb24gbWFrZU5vZGVQcm9taXNpZmllZEV2YWwoY2FsbGJhY2ssIHJlY2VpdmVyLCBvcmlnaW5hbE5hbWUsIGZuLCBzdWZmaXgpIHtcbiAgICB2YXIgbmV3UGFyYW1ldGVyQ291bnQgPSBNYXRoLm1heCgwLCBwYXJhbWV0ZXJDb3VudChmbikgLSAxKTtcbiAgICB2YXIgYXJndW1lbnRPcmRlciA9IHN3aXRjaENhc2VBcmd1bWVudE9yZGVyKG5ld1BhcmFtZXRlckNvdW50KTtcbiAgICB2YXIgY2FsbGJhY2tOYW1lID1cbiAgICAgICAgKHR5cGVvZiBvcmlnaW5hbE5hbWUgPT09IFwic3RyaW5nXCIgJiYgdXRpbC5pc0lkZW50aWZpZXIob3JpZ2luYWxOYW1lKVxuICAgICAgICAgICAgPyBvcmlnaW5hbE5hbWUgKyBzdWZmaXhcbiAgICAgICAgICAgIDogXCJwcm9taXNpZmllZFwiKTtcblxuICAgIGZ1bmN0aW9uIGdlbmVyYXRlQ2FsbEZvckFyZ3VtZW50Q291bnQoY291bnQpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudFNlcXVlbmNlKGNvdW50KS5qb2luKFwiLCBcIik7XG4gICAgICAgIHZhciBjb21tYSA9IGNvdW50ID4gMCA/IFwiLCBcIiA6IFwiXCI7XG4gICAgICAgIHZhciByZXQ7XG4gICAgICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHJldCA9IFwiICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAgICAgdGhpcy5tZXRob2QoYXJncywgZm4pOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAgICAgYnJlYWs7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICBcIi5yZXBsYWNlKFwiLm1ldGhvZFwiLCBnZW5lcmF0ZVByb3BlcnR5QWNjZXNzKGNhbGxiYWNrKSk7XG4gICAgICAgIH0gZWxzZSBpZiAocmVjZWl2ZXIgPT09IFRISVMpIHtcbiAgICAgICAgICAgIHJldCA9ICBcIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAgICAgY2FsbGJhY2suY2FsbCh0aGlzLCBhcmdzLCBmbik7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAgICAgYnJlYWs7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICBcIjtcbiAgICAgICAgfSBlbHNlIGlmIChyZWNlaXZlciAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgICByZXQgPSAgXCIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgICAgIGNhbGxiYWNrLmNhbGwocmVjZWl2ZXIsIGFyZ3MsIGZuKTsgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgICAgIGJyZWFrOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgXCI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXQgPSAgXCIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGFyZ3MsIGZuKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgICAgIGJyZWFrOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgXCI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJldC5yZXBsYWNlKFwiYXJnc1wiLCBhcmdzKS5yZXBsYWNlKFwiLCBcIiwgY29tbWEpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdlbmVyYXRlQXJndW1lbnRTd2l0Y2hDYXNlKCkge1xuICAgICAgICB2YXIgcmV0ID0gXCJcIjtcbiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IGFyZ3VtZW50T3JkZXIubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHJldCArPSBcImNhc2UgXCIgKyBhcmd1bWVudE9yZGVyW2ldICtcIjpcIiArXG4gICAgICAgICAgICAgICAgZ2VuZXJhdGVDYWxsRm9yQXJndW1lbnRDb3VudChhcmd1bWVudE9yZGVyW2ldKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY29kZUZvckNhbGw7XG4gICAgICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIGNvZGVGb3JDYWxsID0gXCIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wZXJ0eS5hcHBseSh0aGlzLCBhcmdzKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICBcIlxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiLnByb3BlcnR5XCIsIGdlbmVyYXRlUHJvcGVydHlBY2Nlc3MoY2FsbGJhY2spKTtcbiAgICAgICAgfSBlbHNlIGlmIChyZWNlaXZlciA9PT0gVEhJUykge1xuICAgICAgICAgICAgY29kZUZvckNhbGwgPSBcIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICAgICBjYWxsYmFjay5hcHBseSh0aGlzLCBhcmdzKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIFwiO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29kZUZvckNhbGwgPSBcIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICAgICBjYWxsYmFjay5hcHBseShyZWNlaXZlciwgYXJncyk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIFwiO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0ICs9IFwiICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgIGRlZmF1bHQ6ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICB2YXIgYXJncyA9IG5ldyBBcnJheShsZW4gKyAxKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICB2YXIgaSA9IDA7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAgICBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICB9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICBhcmdzW2ldID0gZm47ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICBbQ29kZUZvckNhbGxdICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICBicmVhazsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgIFwiLnJlcGxhY2UoXCJbQ29kZUZvckNhbGxdXCIsIGNvZGVGb3JDYWxsKTtcbiAgICAgICAgcmV0dXJuIHJldDtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IEZ1bmN0aW9uKFwiUHJvbWlzZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJjYWxsYmFja1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWNlaXZlclwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ3aXRoQXBwZW5kZWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibWF5YmVXcmFwQXNFcnJvclwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJub2RlYmFja0ZvclByb21pc2VcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiSU5URVJOQUxcIixcIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgdmFyIHJldCA9IGZ1bmN0aW9uIEZ1bmN0aW9uTmFtZShQYXJhbWV0ZXJzKSB7ICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICd1c2Ugc3RyaWN0JzsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIHZhciBwcm9taXNlID0gbmV3IFByb21pc2UoSU5URVJOQUwpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIHByb21pc2UuX3NldFRyYWNlKHZvaWQgMCk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIHZhciBmbiA9IG5vZGViYWNrRm9yUHJvbWlzZShwcm9taXNlKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIHRyeSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICAgICBzd2l0Y2gobGVuKSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICAgICAgICAgW0NvZGVGb3JTd2l0Y2hDYXNlXSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICAgICB9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICAgICB2YXIgd3JhcHBlZCA9IG1heWJlV3JhcEFzRXJyb3IoZSk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICAgICBwcm9taXNlLl9hdHRhY2hFeHRyYVRyYWNlKHdyYXBwZWQpOyAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICAgICBwcm9taXNlLl9yZWplY3Qod3JhcHBlZCk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgfTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgcmV0Ll9faXNQcm9taXNpZmllZF9fID0gdHJ1ZTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgcmV0dXJuIHJldDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgXCJcbiAgICAgICAgLnJlcGxhY2UoXCJGdW5jdGlvbk5hbWVcIiwgY2FsbGJhY2tOYW1lKVxuICAgICAgICAucmVwbGFjZShcIlBhcmFtZXRlcnNcIiwgcGFyYW1ldGVyRGVjbGFyYXRpb24obmV3UGFyYW1ldGVyQ291bnQpKVxuICAgICAgICAucmVwbGFjZShcIltDb2RlRm9yU3dpdGNoQ2FzZV1cIiwgZ2VuZXJhdGVBcmd1bWVudFN3aXRjaENhc2UoKSkpKFxuICAgICAgICAgICAgUHJvbWlzZSxcbiAgICAgICAgICAgIGNhbGxiYWNrLFxuICAgICAgICAgICAgcmVjZWl2ZXIsXG4gICAgICAgICAgICB3aXRoQXBwZW5kZWQsXG4gICAgICAgICAgICBtYXliZVdyYXBBc0Vycm9yLFxuICAgICAgICAgICAgbm9kZWJhY2tGb3JQcm9taXNlLFxuICAgICAgICAgICAgSU5URVJOQUxcbiAgICAgICAgKTtcbn1cblxuZnVuY3Rpb24gbWFrZU5vZGVQcm9taXNpZmllZENsb3N1cmUoY2FsbGJhY2ssIHJlY2VpdmVyKSB7XG4gICAgZnVuY3Rpb24gcHJvbWlzaWZpZWQoKSB7XG4gICAgICAgIHZhciBfcmVjZWl2ZXIgPSByZWNlaXZlcjtcbiAgICAgICAgaWYgKHJlY2VpdmVyID09PSBUSElTKSBfcmVjZWl2ZXIgPSB0aGlzO1xuICAgICAgICBpZiAodHlwZW9mIGNhbGxiYWNrID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICBjYWxsYmFjayA9IF9yZWNlaXZlcltjYWxsYmFja107XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHByb21pc2UgPSBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG4gICAgICAgIHByb21pc2UuX3NldFRyYWNlKHZvaWQgMCk7XG4gICAgICAgIHZhciBmbiA9IG5vZGViYWNrRm9yUHJvbWlzZShwcm9taXNlKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNhbGxiYWNrLmFwcGx5KF9yZWNlaXZlciwgd2l0aEFwcGVuZGVkKGFyZ3VtZW50cywgZm4pKTtcbiAgICAgICAgfSBjYXRjaChlKSB7XG4gICAgICAgICAgICB2YXIgd3JhcHBlZCA9IG1heWJlV3JhcEFzRXJyb3IoZSk7XG4gICAgICAgICAgICBwcm9taXNlLl9hdHRhY2hFeHRyYVRyYWNlKHdyYXBwZWQpO1xuICAgICAgICAgICAgcHJvbWlzZS5fcmVqZWN0KHdyYXBwZWQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH1cbiAgICBwcm9taXNpZmllZC5fX2lzUHJvbWlzaWZpZWRfXyA9IHRydWU7XG4gICAgcmV0dXJuIHByb21pc2lmaWVkO1xufVxuXG52YXIgbWFrZU5vZGVQcm9taXNpZmllZCA9IGNhbkV2YWx1YXRlXG4gICAgPyBtYWtlTm9kZVByb21pc2lmaWVkRXZhbFxuICAgIDogbWFrZU5vZGVQcm9taXNpZmllZENsb3N1cmU7XG5cbmZ1bmN0aW9uIHByb21pc2lmeUFsbChvYmosIHN1ZmZpeCwgZmlsdGVyLCBwcm9taXNpZmllcikge1xuICAgIHZhciBzdWZmaXhSZWdleHAgPSBuZXcgUmVnRXhwKGVzY2FwZUlkZW50UmVnZXgoc3VmZml4KSArIFwiJFwiKTtcbiAgICB2YXIgbWV0aG9kcyA9XG4gICAgICAgIHByb21pc2lmaWFibGVNZXRob2RzKG9iaiwgc3VmZml4LCBzdWZmaXhSZWdleHAsIGZpbHRlcik7XG5cbiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gbWV0aG9kcy5sZW5ndGg7IGkgPCBsZW47IGkrPSAyKSB7XG4gICAgICAgIHZhciBrZXkgPSBtZXRob2RzW2ldO1xuICAgICAgICB2YXIgZm4gPSBtZXRob2RzW2krMV07XG4gICAgICAgIHZhciBwcm9taXNpZmllZEtleSA9IGtleSArIHN1ZmZpeDtcbiAgICAgICAgb2JqW3Byb21pc2lmaWVkS2V5XSA9IHByb21pc2lmaWVyID09PSBtYWtlTm9kZVByb21pc2lmaWVkXG4gICAgICAgICAgICAgICAgPyBtYWtlTm9kZVByb21pc2lmaWVkKGtleSwgVEhJUywga2V5LCBmbiwgc3VmZml4KVxuICAgICAgICAgICAgICAgIDogcHJvbWlzaWZpZXIoZm4pO1xuICAgIH1cbiAgICB1dGlsLnRvRmFzdFByb3BlcnRpZXMob2JqKTtcbiAgICByZXR1cm4gb2JqO1xufVxuXG5mdW5jdGlvbiBwcm9taXNpZnkoY2FsbGJhY2ssIHJlY2VpdmVyKSB7XG4gICAgcmV0dXJuIG1ha2VOb2RlUHJvbWlzaWZpZWQoY2FsbGJhY2ssIHJlY2VpdmVyLCB2b2lkIDAsIGNhbGxiYWNrKTtcbn1cblxuUHJvbWlzZS5wcm9taXNpZnkgPSBmdW5jdGlvbiBQcm9taXNlJFByb21pc2lmeShmbiwgcmVjZWl2ZXIpIHtcbiAgICBpZiAodHlwZW9mIGZuICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcImZuIG11c3QgYmUgYSBmdW5jdGlvblwiKTtcbiAgICB9XG4gICAgaWYgKGlzUHJvbWlzaWZpZWQoZm4pKSB7XG4gICAgICAgIHJldHVybiBmbjtcbiAgICB9XG4gICAgcmV0dXJuIHByb21pc2lmeShmbiwgYXJndW1lbnRzLmxlbmd0aCA8IDIgPyBUSElTIDogcmVjZWl2ZXIpO1xufTtcblxuUHJvbWlzZS5wcm9taXNpZnlBbGwgPSBmdW5jdGlvbiBQcm9taXNlJFByb21pc2lmeUFsbCh0YXJnZXQsIG9wdGlvbnMpIHtcbiAgICBpZiAodHlwZW9mIHRhcmdldCAhPT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiB0YXJnZXQgIT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcInRoZSB0YXJnZXQgb2YgcHJvbWlzaWZ5QWxsIG11c3QgYmUgYW4gb2JqZWN0IG9yIGEgZnVuY3Rpb25cIik7XG4gICAgfVxuICAgIG9wdGlvbnMgPSBPYmplY3Qob3B0aW9ucyk7XG4gICAgdmFyIHN1ZmZpeCA9IG9wdGlvbnMuc3VmZml4O1xuICAgIGlmICh0eXBlb2Ygc3VmZml4ICE9PSBcInN0cmluZ1wiKSBzdWZmaXggPSBkZWZhdWx0U3VmZml4O1xuICAgIHZhciBmaWx0ZXIgPSBvcHRpb25zLmZpbHRlcjtcbiAgICBpZiAodHlwZW9mIGZpbHRlciAhPT0gXCJmdW5jdGlvblwiKSBmaWx0ZXIgPSBkZWZhdWx0RmlsdGVyO1xuICAgIHZhciBwcm9taXNpZmllciA9IG9wdGlvbnMucHJvbWlzaWZpZXI7XG4gICAgaWYgKHR5cGVvZiBwcm9taXNpZmllciAhPT0gXCJmdW5jdGlvblwiKSBwcm9taXNpZmllciA9IG1ha2VOb2RlUHJvbWlzaWZpZWQ7XG5cbiAgICBpZiAoIXV0aWwuaXNJZGVudGlmaWVyKHN1ZmZpeCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoXCJzdWZmaXggbXVzdCBiZSBhIHZhbGlkIGlkZW50aWZpZXJcIik7XG4gICAgfVxuXG4gICAgdmFyIGtleXMgPSB1dGlsLmluaGVyaXRlZERhdGFLZXlzKHRhcmdldCwge2luY2x1ZGVIaWRkZW46IHRydWV9KTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gdGFyZ2V0W2tleXNbaV1dO1xuICAgICAgICBpZiAoa2V5c1tpXSAhPT0gXCJjb25zdHJ1Y3RvclwiICYmXG4gICAgICAgICAgICB1dGlsLmlzQ2xhc3ModmFsdWUpKSB7XG4gICAgICAgICAgICBwcm9taXNpZnlBbGwodmFsdWUucHJvdG90eXBlLCBzdWZmaXgsIGZpbHRlciwgcHJvbWlzaWZpZXIpO1xuICAgICAgICAgICAgcHJvbWlzaWZ5QWxsKHZhbHVlLCBzdWZmaXgsIGZpbHRlciwgcHJvbWlzaWZpZXIpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHByb21pc2lmeUFsbCh0YXJnZXQsIHN1ZmZpeCwgZmlsdGVyLCBwcm9taXNpZmllcik7XG59O1xufTtcblxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSwgUHJvbWlzZUFycmF5LCBjYXN0KSB7XG52YXIgdXRpbCA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIik7XG52YXIgYXBpUmVqZWN0aW9uID0gcmVxdWlyZShcIi4vZXJyb3JzX2FwaV9yZWplY3Rpb25cIikoUHJvbWlzZSk7XG52YXIgaXNPYmplY3QgPSB1dGlsLmlzT2JqZWN0O1xudmFyIGVzNSA9IHJlcXVpcmUoXCIuL2VzNS5qc1wiKTtcblxuZnVuY3Rpb24gUHJvcGVydGllc1Byb21pc2VBcnJheShvYmopIHtcbiAgICB2YXIga2V5cyA9IGVzNS5rZXlzKG9iaik7XG4gICAgdmFyIGxlbiA9IGtleXMubGVuZ3RoO1xuICAgIHZhciB2YWx1ZXMgPSBuZXcgQXJyYXkobGVuICogMik7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47ICsraSkge1xuICAgICAgICB2YXIga2V5ID0ga2V5c1tpXTtcbiAgICAgICAgdmFsdWVzW2ldID0gb2JqW2tleV07XG4gICAgICAgIHZhbHVlc1tpICsgbGVuXSA9IGtleTtcbiAgICB9XG4gICAgdGhpcy5jb25zdHJ1Y3RvciQodmFsdWVzKTtcbn1cbnV0aWwuaW5oZXJpdHMoUHJvcGVydGllc1Byb21pc2VBcnJheSwgUHJvbWlzZUFycmF5KTtcblxuUHJvcGVydGllc1Byb21pc2VBcnJheS5wcm90b3R5cGUuX2luaXQgPVxuZnVuY3Rpb24gUHJvcGVydGllc1Byb21pc2VBcnJheSRfaW5pdCgpIHtcbiAgICB0aGlzLl9pbml0JCh2b2lkIDAsIC0zKSA7XG59O1xuXG5Qcm9wZXJ0aWVzUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fcHJvbWlzZUZ1bGZpbGxlZCA9XG5mdW5jdGlvbiBQcm9wZXJ0aWVzUHJvbWlzZUFycmF5JF9wcm9taXNlRnVsZmlsbGVkKHZhbHVlLCBpbmRleCkge1xuICAgIGlmICh0aGlzLl9pc1Jlc29sdmVkKCkpIHJldHVybjtcbiAgICB0aGlzLl92YWx1ZXNbaW5kZXhdID0gdmFsdWU7XG4gICAgdmFyIHRvdGFsUmVzb2x2ZWQgPSArK3RoaXMuX3RvdGFsUmVzb2x2ZWQ7XG4gICAgaWYgKHRvdGFsUmVzb2x2ZWQgPj0gdGhpcy5fbGVuZ3RoKSB7XG4gICAgICAgIHZhciB2YWwgPSB7fTtcbiAgICAgICAgdmFyIGtleU9mZnNldCA9IHRoaXMubGVuZ3RoKCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSB0aGlzLmxlbmd0aCgpOyBpIDwgbGVuOyArK2kpIHtcbiAgICAgICAgICAgIHZhbFt0aGlzLl92YWx1ZXNbaSArIGtleU9mZnNldF1dID0gdGhpcy5fdmFsdWVzW2ldO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3Jlc29sdmUodmFsKTtcbiAgICB9XG59O1xuXG5Qcm9wZXJ0aWVzUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fcHJvbWlzZVByb2dyZXNzZWQgPVxuZnVuY3Rpb24gUHJvcGVydGllc1Byb21pc2VBcnJheSRfcHJvbWlzZVByb2dyZXNzZWQodmFsdWUsIGluZGV4KSB7XG4gICAgaWYgKHRoaXMuX2lzUmVzb2x2ZWQoKSkgcmV0dXJuO1xuXG4gICAgdGhpcy5fcHJvbWlzZS5fcHJvZ3Jlc3Moe1xuICAgICAgICBrZXk6IHRoaXMuX3ZhbHVlc1tpbmRleCArIHRoaXMubGVuZ3RoKCldLFxuICAgICAgICB2YWx1ZTogdmFsdWVcbiAgICB9KTtcbn07XG5cblByb3BlcnRpZXNQcm9taXNlQXJyYXkucHJvdG90eXBlLnNob3VsZENvcHlWYWx1ZXMgPVxuZnVuY3Rpb24gUHJvcGVydGllc1Byb21pc2VBcnJheSRfc2hvdWxkQ29weVZhbHVlcygpIHtcbiAgICByZXR1cm4gZmFsc2U7XG59O1xuXG5Qcm9wZXJ0aWVzUHJvbWlzZUFycmF5LnByb3RvdHlwZS5nZXRBY3R1YWxMZW5ndGggPVxuZnVuY3Rpb24gUHJvcGVydGllc1Byb21pc2VBcnJheSRnZXRBY3R1YWxMZW5ndGgobGVuKSB7XG4gICAgcmV0dXJuIGxlbiA+PiAxO1xufTtcblxuZnVuY3Rpb24gUHJvbWlzZSRfUHJvcHMocHJvbWlzZXMpIHtcbiAgICB2YXIgcmV0O1xuICAgIHZhciBjYXN0VmFsdWUgPSBjYXN0KHByb21pc2VzLCB2b2lkIDApO1xuXG4gICAgaWYgKCFpc09iamVjdChjYXN0VmFsdWUpKSB7XG4gICAgICAgIHJldHVybiBhcGlSZWplY3Rpb24oXCJjYW5ub3QgYXdhaXQgcHJvcGVydGllcyBvZiBhIG5vbi1vYmplY3RcIik7XG4gICAgfSBlbHNlIGlmIChjYXN0VmFsdWUgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgIHJldCA9IGNhc3RWYWx1ZS5fdGhlbihQcm9taXNlLnByb3BzLCB2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCB2b2lkIDApO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldCA9IG5ldyBQcm9wZXJ0aWVzUHJvbWlzZUFycmF5KGNhc3RWYWx1ZSkucHJvbWlzZSgpO1xuICAgIH1cblxuICAgIGlmIChjYXN0VmFsdWUgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgIHJldC5fcHJvcGFnYXRlRnJvbShjYXN0VmFsdWUsIDQpO1xuICAgIH1cbiAgICByZXR1cm4gcmV0O1xufVxuXG5Qcm9taXNlLnByb3RvdHlwZS5wcm9wcyA9IGZ1bmN0aW9uIFByb21pc2UkcHJvcHMoKSB7XG4gICAgcmV0dXJuIFByb21pc2UkX1Byb3BzKHRoaXMpO1xufTtcblxuUHJvbWlzZS5wcm9wcyA9IGZ1bmN0aW9uIFByb21pc2UkUHJvcHMocHJvbWlzZXMpIHtcbiAgICByZXR1cm4gUHJvbWlzZSRfUHJvcHMocHJvbWlzZXMpO1xufTtcbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cbnZhciBpc0VTNSA9IChmdW5jdGlvbigpe1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIHJldHVybiB0aGlzID09PSB2b2lkIDA7XG59KSgpO1xuXG5pZiAoaXNFUzUpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IHtcbiAgICAgICAgZnJlZXplOiBPYmplY3QuZnJlZXplLFxuICAgICAgICBkZWZpbmVQcm9wZXJ0eTogT2JqZWN0LmRlZmluZVByb3BlcnR5LFxuICAgICAgICBrZXlzOiBPYmplY3Qua2V5cyxcbiAgICAgICAgZ2V0UHJvdG90eXBlT2Y6IE9iamVjdC5nZXRQcm90b3R5cGVPZixcbiAgICAgICAgaXNBcnJheTogQXJyYXkuaXNBcnJheSxcbiAgICAgICAgaXNFUzU6IGlzRVM1XG4gICAgfTtcbn0gZWxzZSB7XG4gICAgdmFyIGhhcyA9IHt9Lmhhc093blByb3BlcnR5O1xuICAgIHZhciBzdHIgPSB7fS50b1N0cmluZztcbiAgICB2YXIgcHJvdG8gPSB7fS5jb25zdHJ1Y3Rvci5wcm90b3R5cGU7XG5cbiAgICB2YXIgT2JqZWN0S2V5cyA9IGZ1bmN0aW9uIE9iamVjdEtleXMobykge1xuICAgICAgICB2YXIgcmV0ID0gW107XG4gICAgICAgIGZvciAodmFyIGtleSBpbiBvKSB7XG4gICAgICAgICAgICBpZiAoaGFzLmNhbGwobywga2V5KSkge1xuICAgICAgICAgICAgICAgIHJldC5wdXNoKGtleSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJldDtcbiAgICB9XG5cbiAgICB2YXIgT2JqZWN0RGVmaW5lUHJvcGVydHkgPSBmdW5jdGlvbiBPYmplY3REZWZpbmVQcm9wZXJ0eShvLCBrZXksIGRlc2MpIHtcbiAgICAgICAgb1trZXldID0gZGVzYy52YWx1ZTtcbiAgICAgICAgcmV0dXJuIG87XG4gICAgfVxuXG4gICAgdmFyIE9iamVjdEZyZWV6ZSA9IGZ1bmN0aW9uIE9iamVjdEZyZWV6ZShvYmopIHtcbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICB9XG5cbiAgICB2YXIgT2JqZWN0R2V0UHJvdG90eXBlT2YgPSBmdW5jdGlvbiBPYmplY3RHZXRQcm90b3R5cGVPZihvYmopIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBPYmplY3Qob2JqKS5jb25zdHJ1Y3Rvci5wcm90b3R5cGU7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHJldHVybiBwcm90bztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHZhciBBcnJheUlzQXJyYXkgPSBmdW5jdGlvbiBBcnJheUlzQXJyYXkob2JqKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gc3RyLmNhbGwob2JqKSA9PT0gXCJbb2JqZWN0IEFycmF5XVwiO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoKGUpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG1vZHVsZS5leHBvcnRzID0ge1xuICAgICAgICBpc0FycmF5OiBBcnJheUlzQXJyYXksXG4gICAgICAgIGtleXM6IE9iamVjdEtleXMsXG4gICAgICAgIGRlZmluZVByb3BlcnR5OiBPYmplY3REZWZpbmVQcm9wZXJ0eSxcbiAgICAgICAgZnJlZXplOiBPYmplY3RGcmVlemUsXG4gICAgICAgIGdldFByb3RvdHlwZU9mOiBPYmplY3RHZXRQcm90b3R5cGVPZixcbiAgICAgICAgaXNFUzU6IGlzRVM1XG4gICAgfTtcbn1cbiIsIihmdW5jdGlvbihwcm9jZXNzKXsvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xudmFyIHNjaGVkdWxlO1xudmFyIF9NdXRhdGlvbk9ic2VydmVyO1xuaWYgKHR5cGVvZiBwcm9jZXNzID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBwcm9jZXNzLnZlcnNpb24gPT09IFwic3RyaW5nXCIpIHtcbiAgICBzY2hlZHVsZSA9IGZ1bmN0aW9uIFByb21pc2UkX1NjaGVkdWxlcihmbikge1xuICAgICAgICBwcm9jZXNzLm5leHRUaWNrKGZuKTtcbiAgICB9O1xufVxuZWxzZSBpZiAoKHR5cGVvZiBNdXRhdGlvbk9ic2VydmVyICE9PSBcInVuZGVmaW5lZFwiICYmXG4gICAgICAgICAoX011dGF0aW9uT2JzZXJ2ZXIgPSBNdXRhdGlvbk9ic2VydmVyKSkgfHxcbiAgICAgICAgICh0eXBlb2YgV2ViS2l0TXV0YXRpb25PYnNlcnZlciAhPT0gXCJ1bmRlZmluZWRcIiAmJlxuICAgICAgICAgKF9NdXRhdGlvbk9ic2VydmVyID0gV2ViS2l0TXV0YXRpb25PYnNlcnZlcikpKSB7XG4gICAgc2NoZWR1bGUgPSAoZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICB2YXIgcXVldWVkRm4gPSB2b2lkIDA7XG4gICAgICAgIHZhciBvYnNlcnZlciA9IG5ldyBfTXV0YXRpb25PYnNlcnZlcihcbiAgICAgICAgICAgIGZ1bmN0aW9uIFByb21pc2UkX1NjaGVkdWxlcigpIHtcbiAgICAgICAgICAgICAgICB2YXIgZm4gPSBxdWV1ZWRGbjtcbiAgICAgICAgICAgICAgICBxdWV1ZWRGbiA9IHZvaWQgMDtcbiAgICAgICAgICAgICAgICBmbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICk7XG4gICAgICAgIG9ic2VydmVyLm9ic2VydmUoZGl2LCB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVzOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gUHJvbWlzZSRfU2NoZWR1bGVyKGZuKSB7XG4gICAgICAgICAgICBxdWV1ZWRGbiA9IGZuO1xuICAgICAgICAgICAgZGl2LnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwiZm9vXCIpO1xuICAgICAgICB9O1xuXG4gICAgfSkoKTtcbn1cbmVsc2UgaWYgKHR5cGVvZiBzZXRUaW1lb3V0ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgc2NoZWR1bGUgPSBmdW5jdGlvbiBQcm9taXNlJF9TY2hlZHVsZXIoZm4pIHtcbiAgICAgICAgc2V0VGltZW91dChmbiwgMCk7XG4gICAgfTtcbn1cbmVsc2UgdGhyb3cgbmV3IEVycm9yKFwibm8gYXN5bmMgc2NoZWR1bGVyIGF2YWlsYWJsZVwiKTtcbm1vZHVsZS5leHBvcnRzID0gc2NoZWR1bGU7XG5cbn0pKHJlcXVpcmUoXCJfX2Jyb3dzZXJpZnlfcHJvY2Vzc1wiKSkiLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xuZnVuY3Rpb24gYXJyYXlDb3B5KHNyYywgc3JjSW5kZXgsIGRzdCwgZHN0SW5kZXgsIGxlbikge1xuICAgIGZvciAodmFyIGogPSAwOyBqIDwgbGVuOyArK2opIHtcbiAgICAgICAgZHN0W2ogKyBkc3RJbmRleF0gPSBzcmNbaiArIHNyY0luZGV4XTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIFF1ZXVlKGNhcGFjaXR5KSB7XG4gICAgdGhpcy5fY2FwYWNpdHkgPSBjYXBhY2l0eTtcbiAgICB0aGlzLl9sZW5ndGggPSAwO1xuICAgIHRoaXMuX2Zyb250ID0gMDtcbiAgICB0aGlzLl9tYWtlQ2FwYWNpdHkoKTtcbn1cblxuUXVldWUucHJvdG90eXBlLl93aWxsQmVPdmVyQ2FwYWNpdHkgPVxuZnVuY3Rpb24gUXVldWUkX3dpbGxCZU92ZXJDYXBhY2l0eShzaXplKSB7XG4gICAgcmV0dXJuIHRoaXMuX2NhcGFjaXR5IDwgc2l6ZTtcbn07XG5cblF1ZXVlLnByb3RvdHlwZS5fcHVzaE9uZSA9IGZ1bmN0aW9uIFF1ZXVlJF9wdXNoT25lKGFyZykge1xuICAgIHZhciBsZW5ndGggPSB0aGlzLmxlbmd0aCgpO1xuICAgIHRoaXMuX2NoZWNrQ2FwYWNpdHkobGVuZ3RoICsgMSk7XG4gICAgdmFyIGkgPSAodGhpcy5fZnJvbnQgKyBsZW5ndGgpICYgKHRoaXMuX2NhcGFjaXR5IC0gMSk7XG4gICAgdGhpc1tpXSA9IGFyZztcbiAgICB0aGlzLl9sZW5ndGggPSBsZW5ndGggKyAxO1xufTtcblxuUXVldWUucHJvdG90eXBlLnB1c2ggPSBmdW5jdGlvbiBRdWV1ZSRwdXNoKGZuLCByZWNlaXZlciwgYXJnKSB7XG4gICAgdmFyIGxlbmd0aCA9IHRoaXMubGVuZ3RoKCkgKyAzO1xuICAgIGlmICh0aGlzLl93aWxsQmVPdmVyQ2FwYWNpdHkobGVuZ3RoKSkge1xuICAgICAgICB0aGlzLl9wdXNoT25lKGZuKTtcbiAgICAgICAgdGhpcy5fcHVzaE9uZShyZWNlaXZlcik7XG4gICAgICAgIHRoaXMuX3B1c2hPbmUoYXJnKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgaiA9IHRoaXMuX2Zyb250ICsgbGVuZ3RoIC0gMztcbiAgICB0aGlzLl9jaGVja0NhcGFjaXR5KGxlbmd0aCk7XG4gICAgdmFyIHdyYXBNYXNrID0gdGhpcy5fY2FwYWNpdHkgLSAxO1xuICAgIHRoaXNbKGogKyAwKSAmIHdyYXBNYXNrXSA9IGZuO1xuICAgIHRoaXNbKGogKyAxKSAmIHdyYXBNYXNrXSA9IHJlY2VpdmVyO1xuICAgIHRoaXNbKGogKyAyKSAmIHdyYXBNYXNrXSA9IGFyZztcbiAgICB0aGlzLl9sZW5ndGggPSBsZW5ndGg7XG59O1xuXG5RdWV1ZS5wcm90b3R5cGUuc2hpZnQgPSBmdW5jdGlvbiBRdWV1ZSRzaGlmdCgpIHtcbiAgICB2YXIgZnJvbnQgPSB0aGlzLl9mcm9udCxcbiAgICAgICAgcmV0ID0gdGhpc1tmcm9udF07XG5cbiAgICB0aGlzW2Zyb250XSA9IHZvaWQgMDtcbiAgICB0aGlzLl9mcm9udCA9IChmcm9udCArIDEpICYgKHRoaXMuX2NhcGFjaXR5IC0gMSk7XG4gICAgdGhpcy5fbGVuZ3RoLS07XG4gICAgcmV0dXJuIHJldDtcbn07XG5cblF1ZXVlLnByb3RvdHlwZS5sZW5ndGggPSBmdW5jdGlvbiBRdWV1ZSRsZW5ndGgoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2xlbmd0aDtcbn07XG5cblF1ZXVlLnByb3RvdHlwZS5fbWFrZUNhcGFjaXR5ID0gZnVuY3Rpb24gUXVldWUkX21ha2VDYXBhY2l0eSgpIHtcbiAgICB2YXIgbGVuID0gdGhpcy5fY2FwYWNpdHk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47ICsraSkge1xuICAgICAgICB0aGlzW2ldID0gdm9pZCAwO1xuICAgIH1cbn07XG5cblF1ZXVlLnByb3RvdHlwZS5fY2hlY2tDYXBhY2l0eSA9IGZ1bmN0aW9uIFF1ZXVlJF9jaGVja0NhcGFjaXR5KHNpemUpIHtcbiAgICBpZiAodGhpcy5fY2FwYWNpdHkgPCBzaXplKSB7XG4gICAgICAgIHRoaXMuX3Jlc2l6ZVRvKHRoaXMuX2NhcGFjaXR5IDw8IDMpO1xuICAgIH1cbn07XG5cblF1ZXVlLnByb3RvdHlwZS5fcmVzaXplVG8gPSBmdW5jdGlvbiBRdWV1ZSRfcmVzaXplVG8oY2FwYWNpdHkpIHtcbiAgICB2YXIgb2xkRnJvbnQgPSB0aGlzLl9mcm9udDtcbiAgICB2YXIgb2xkQ2FwYWNpdHkgPSB0aGlzLl9jYXBhY2l0eTtcbiAgICB2YXIgb2xkUXVldWUgPSBuZXcgQXJyYXkob2xkQ2FwYWNpdHkpO1xuICAgIHZhciBsZW5ndGggPSB0aGlzLmxlbmd0aCgpO1xuXG4gICAgYXJyYXlDb3B5KHRoaXMsIDAsIG9sZFF1ZXVlLCAwLCBvbGRDYXBhY2l0eSk7XG4gICAgdGhpcy5fY2FwYWNpdHkgPSBjYXBhY2l0eTtcbiAgICB0aGlzLl9tYWtlQ2FwYWNpdHkoKTtcbiAgICB0aGlzLl9mcm9udCA9IDA7XG4gICAgaWYgKG9sZEZyb250ICsgbGVuZ3RoIDw9IG9sZENhcGFjaXR5KSB7XG4gICAgICAgIGFycmF5Q29weShvbGRRdWV1ZSwgb2xkRnJvbnQsIHRoaXMsIDAsIGxlbmd0aCk7XG4gICAgfSBlbHNlIHsgICAgICAgIHZhciBsZW5ndGhCZWZvcmVXcmFwcGluZyA9XG4gICAgICAgICAgICBsZW5ndGggLSAoKG9sZEZyb250ICsgbGVuZ3RoKSAmIChvbGRDYXBhY2l0eSAtIDEpKTtcblxuICAgICAgICBhcnJheUNvcHkob2xkUXVldWUsIG9sZEZyb250LCB0aGlzLCAwLCBsZW5ndGhCZWZvcmVXcmFwcGluZyk7XG4gICAgICAgIGFycmF5Q29weShvbGRRdWV1ZSwgMCwgdGhpcywgbGVuZ3RoQmVmb3JlV3JhcHBpbmcsXG4gICAgICAgICAgICAgICAgICAgIGxlbmd0aCAtIGxlbmd0aEJlZm9yZVdyYXBwaW5nKTtcbiAgICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFF1ZXVlO1xuIl19
;