;(function(e,t,n){function i(n,s){if(!t[n]){if(!e[n]){var o=typeof require=="function"&&require;if(!s&&o)return o(n,!0);if(r)return r(n,!0);throw new Error("Cannot find module '"+n+"'")}var u=t[n]={exports:{}};e[n][0].call(u.exports,function(t){var r=e[n][1][t];return i(r?r:t)},u,u.exports)}return t[n].exports}var r=typeof require=="function"&&require;for(var s=0;s<n.length;s++)i(n[s]);return i})({1:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  ComponentRegistry,
  webAliases,
  nodeAliases
) {
  var c = new ComponentRegistry();


  c.registerMany([
    {
      module: require("./util/component-loader"),
      as: "component-loader"
    },

    {
      module: require("./util/periodic"),
      as: "periodic"
    },

    {
      module: require("./core/dispatcher"),
      as: "dispatcher"
    },

    {
      module: require("./core/countdown-latch"),
      as: "countdown-latch"
    },

    {
      module: require("./core/options"),
      as: "options"
    },

    {
      module: require("./core/lang"),
      as: "lang"
    },

    {
      module: require("./core/ref"),
      as: "ref"
    },

    {
      module: require("./core/state-guard"),
      as: "state-guard"
    },


    {
      module: require("./core/pub-sub"),
      as: "pub-sub"
    },

    {
      module: require("./core/sequencer/unit-sequencer"),
      as: ["unit-sequencer", "sequencer"]
    },


    {
      module: require("./core/sequencer/clock-sequencer"),
      as: "clock-sequencer"
    },

    {
      module: require("./core/sequencer/delegating-composite-sequencer"),
      as: "delegating-composite-sequencer"
    },

    {
      module: require("./core/sequencer/delegating-forwarding-sequencer"),
      as: "delegating-forwarding-sequencer"
    },

    {
      module: require("./collection/doubly-linked-list"),
      as: "doubly-linked-list"
    },

    {
      module: require("./collection/object-hash-map"),
      as: ["hash-map", "object-hash-map"]
    },

    {
      module: require("./collection/lru-hash-map"),
      as: "lru-hash-map"
    },

    {
      module: require("./storage/caching-data-store"),
      as: "caching-data-store"
    },

    {
      module: require("./storage/in-memory-data-store"),
      as: "in-memory-data-store"
    },

    {
      module: require("./storage/lru-data-store"),
      as: "lru-data-store"
    },

    {
      module: require("./storage/signaling-data-store"),
      as: "signaling-data-store"
    },

    {
      module: require("./time/clock/logical-clock"),
      as: "logical-clock"
    },

    {
      module: require("./time/clock/system-clock"),
      as: "system-clock"
    },

    {
      module: require("./appkit/configuration-magic"),
      as: "configuration-magic"
    },

    {
      module: require("./appkit/config/scoped-configuration-resolver"),
      as: "scoped-configuration-resolver"
    },

    {
      module: require("./appkit/config/scoped-configuration"),
      as: ["scoped-configuration", "config/scoped-configuration"]
    },

    {
      module: require("./appkit/app"),
      as: "app"
    },

    {
      module: require("./runtime"),
      as: "runtime"
    },

    {
      module: require("./core/logging/logger"),
      as: "logger"
    },

    {
      module: require("./core/logging/appenders/console-log-appender"),
      as: ["appenders/console-log", "console-log-appender"]
    },

    {
      module: require("./core/channel/channel"),
      as: "channel"
    },

    {
      module: require("./core/channel/chained-channel"),
      as: "chained-channel"
    },

    {
      module: require("./core/channel/composite-channel"),
      as: "composite-channel"
    },

    {
      module: require("./messaging/exchange"),
      as: "messaging/exchange"
    },

    {
      module: require("./messaging/courier"),
      as: "messaging/courier"
    },

    {
      module: require("./messaging/fiber/in-memory-fiber"),
      as: "messaging/fibers/in-memory"
    },

    {
      module: require("./messaging/fiber/linkable-fiber"),
      as: "messaging/fibers/linkable"
    },

    {
      module: require("./core/uuid"),
      as: "uuid"
    },

    {
      module: require("./core/serde/json-serde"),
      as: ["serde/json", "json-serde"]
    }
  ]);

  c.selfRegister({
    as: "component-registry"
  });

  webAliases(c);
  nodeAliases(c);

  return c;
};

var g = (typeof window === "undefined" ? {} : window);
g.thicket = module.exports = mod(
  require("./util/component-registry"),
  require("./web"),
  require("./node")
);

})()
},{"./util/component-loader":2,"./util/periodic":3,"./core/dispatcher":4,"./core/countdown-latch":5,"./core/options":6,"./core/lang":7,"./core/state-guard":8,"./core/pub-sub":9,"./core/sequencer/unit-sequencer":10,"./core/sequencer/clock-sequencer":11,"./core/sequencer/delegating-composite-sequencer":12,"./core/sequencer/delegating-forwarding-sequencer":13,"./collection/doubly-linked-list":14,"./collection/object-hash-map":15,"./collection/lru-hash-map":16,"./storage/caching-data-store":17,"./storage/in-memory-data-store":18,"./storage/lru-data-store":19,"./storage/signaling-data-store":20,"./time/clock/logical-clock":21,"./time/clock/system-clock":22,"./appkit/configuration-magic":23,"./appkit/config/scoped-configuration-resolver":24,"./appkit/config/scoped-configuration":25,"./appkit/app":26,"./core/logging/logger":27,"./core/logging/appenders/console-log-appender":28,"./core/channel/channel":29,"./core/channel/chained-channel":30,"./core/channel/composite-channel":31,"./messaging/exchange":32,"./messaging/courier":33,"./messaging/fiber/in-memory-fiber":34,"./messaging/fiber/linkable-fiber":35,"./core/uuid":36,"./core/serde/json-serde":37,"./util/component-registry":38,"./web":39,"./node":40,"./core/ref":41,"./runtime":42}],40:[function(require,module,exports){
module.exports = function(c) {};

},{}],39:[function(require,module,exports){
module.exports = function(c) {
  c.registerMany([
    {
      module: require("./appkit/bootstrapper"),
      as: "bootstrapper"
    },
    {
      module: require("./appkit/web-app-container"),
      as: "app-container"
    },
    {
      module: require("./scheduler/web-scheduler"),
      as: "scheduler"
    }
  ]);

  require("./browserify2-list");
};

},{"./appkit/bootstrapper":43,"./appkit/web-app-container":44,"./scheduler/web-scheduler":45,"./browserify2-list":46}],42:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

module.exports = require("./default-runtime");

})()
},{"./default-runtime":47}],46:[function(require,module,exports){
(function(){require("./node.js");
require("./appkit/config/scoped-configuration-resolver.js");
require("./appkit/config/scoped-configuration.js");
require("./appkit/bootstrapper.js");
require("./appkit/configuration-magic.js");
require("./appkit/internal/process-keep-alive.js");
require("./appkit/app.js");
require("./appkit/web-app-container.js");
require("./web.js");
require("./storage/in-memory-data-store.js");
require("./storage/lru-data-store.js");
require("./storage/internals/expiring-entry.js");
require("./storage/signaling-data-store.js");
require("./storage/caching-data-store.js");
require("./util/periodic.js");
require("./util/component-loader.js");
require("./util/component-registry.js");
require("./time/clock/system-clock.js");
require("./time/clock/logical-clock.js");
require("./messaging/m-type.js");
require("./messaging/fiber/in-memory-fiber.js");
require("./messaging/fiber/linkable-fiber.js");
require("./messaging/internals/mailbox.js");
require("./messaging/courier.js");
require("./messaging/exchange.js");
require("./scheduler/web-scheduler.js");
require("./scheduler/index.js");
require("./index.js");
require("./runtime/index.js");
require("./runtime/default-runtime.js");
require("./collection/object-hash-map.js");
require("./collection/lru-hash-map.js");
require("./collection/doubly-linked-list.js");
require("./core/sequencer/delegating-forwarding-sequencer.js");
require("./core/sequencer/unit-sequencer.js");
require("./core/sequencer/clock-sequencer.js");
require("./core/sequencer/delegating-composite-sequencer.js");
require("./core/ref/index.js");
require("./core/ref/delegating-ref.js");
require("./core/ref/ref.js");
require("./core/countdown-latch.js");
require("./core/uuid.js");
require("./core/logging/appenders/console-log-appender.js");
require("./core/logging/logger.js");
require("./core/lang.js");
require("./core/scheduler/set-timeout-scheduler.js");
require("./core/state-guard.js");
require("./core/dispatcher.js");
require("./core/serde/json-serde.js");
require("./core/options.js");
require("./core/pub-sub.js");
require("./core/channel/channel.js");
require("./core/channel/chained-channel.js");
require("./core/channel/composite-channel.js");

})()
},{"./node.js":40,"./appkit/config/scoped-configuration-resolver.js":24,"./appkit/config/scoped-configuration.js":25,"./appkit/bootstrapper.js":43,"./appkit/configuration-magic.js":23,"./appkit/internal/process-keep-alive.js":48,"./appkit/app.js":26,"./appkit/web-app-container.js":44,"./web.js":39,"./storage/in-memory-data-store.js":18,"./storage/lru-data-store.js":19,"./storage/internals/expiring-entry.js":49,"./storage/signaling-data-store.js":20,"./storage/caching-data-store.js":17,"./util/periodic.js":3,"./util/component-loader.js":2,"./util/component-registry.js":38,"./time/clock/system-clock.js":22,"./time/clock/logical-clock.js":21,"./messaging/m-type.js":50,"./messaging/fiber/in-memory-fiber.js":34,"./messaging/fiber/linkable-fiber.js":35,"./messaging/internals/mailbox.js":51,"./messaging/courier.js":33,"./messaging/exchange.js":32,"./scheduler/web-scheduler.js":45,"./scheduler/index.js":52,"./index.js":1,"./runtime/index.js":42,"./runtime/default-runtime.js":47,"./collection/object-hash-map.js":15,"./collection/lru-hash-map.js":16,"./collection/doubly-linked-list.js":14,"./core/sequencer/delegating-forwarding-sequencer.js":13,"./core/sequencer/unit-sequencer.js":10,"./core/sequencer/clock-sequencer.js":11,"./core/sequencer/delegating-composite-sequencer.js":12,"./core/ref/index.js":41,"./core/ref/delegating-ref.js":53,"./core/ref/ref.js":54,"./core/countdown-latch.js":5,"./core/uuid.js":36,"./core/logging/appenders/console-log-appender.js":28,"./core/logging/logger.js":27,"./core/lang.js":7,"./core/scheduler/set-timeout-scheduler.js":55,"./core/state-guard.js":8,"./core/dispatcher.js":4,"./core/serde/json-serde.js":37,"./core/options.js":6,"./core/pub-sub.js":9,"./core/channel/channel.js":29,"./core/channel/chained-channel.js":30,"./core/channel/composite-channel.js":31}],2:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var factory = function(
  _,
  Options
) {
  var ComponentLoader = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(ComponentLoader.prototype, {
    initialize: function(requireFun) {
      this._requireFun = requireFun;
      this._aliases = {};
      this._pathTransform = function(id) { return id;};
    },

    setPathTransform: function(pathTransform) {
      this._pathTransform = pathTransform;
      return this;
    },

    alias: function(opts) {
      opts = Options.fromObject(opts);
      var aliasName  = opts.getOrError("as");
      this._aliases[aliasName] = opts.getOrError("module");
    },

    bulkAlias: function(aliases) {
      _.each(aliases, function(aliasNames, moduleName) {
        if (!_.isArray(aliasNames)) {
          aliasNames = [aliasNames]
        }
        _.each(aliasNames, function(aliasName) {
          this.alias({module: moduleName, as: aliasName});
        }, this);
      }, this);
    },

    component: function(alias) {
      var mod = this._aliases[alias];
      if (!mod) {
        throw new Error("Invalid alias provided (no such module): `"+alias+"'");
      }
      return this._requireFun(this._pathTransform(mod));
    },

    c: function(alias) {
      return this.component.apply(this, arguments);
    }
  });

  return ComponentLoader;
};

module.exports = factory(
  require("underscore"),
  require("../core/options")
);

})()
},{"../core/options":6,"underscore":56}],3:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options,
  StateGuard,
  Channel,
  ChainedChannel,
  Logger
) {

  var Periodic = function() {
    this.initialize.apply(this, arguments);
  };

  var Log = Logger.create("Periodic");

  _.extend(Periodic.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._schedulerRef = opts.getOrError("scheduler");
      this._task         = opts.getOrElse("task");
      this._interval     = opts.getOrError("interval");

      this._stateGuard   = new StateGuard(["disposed", "started"]);
      this._channel      = new Channel({ sentinel: this });
      this._taskId       = null;

      _.bindAll(this, "_runTask");
    },


    start: function(){
      this._stateGuard
        .deny("disposed", "started")
        .apply("started");

      this._scheduleNext(true);
    },


    stop: function() {
      this._cancelPending();
      this._cancelOutstanding();
      this._stateGuard.unapply("started");
    },

    egressChannel: function() {
      return new ChainedChannel({
        sentinel: this,
        chainTo: this._channel
      });
    },

    _runTask: function() {
      var results = {
        mT: "results",
        result: null,
        err: null
      };

      this._taskId = null;
      this._currentRun = Promise
        .bind(this)
        .cancellable()
        .then(function() {
          return this._task();
        })
        .then(function(result) {
          results.result = result;
        })
        .caught(Promise.CancellationError, function() {
          // Let it be. Don't want it to trickle into the results.
        })
        .caught(function(err) {
          results.err = err;
        })
        .lastly(function() {
          this._currentRun = null;
          this._notifyResults(results);
          this._scheduleNext();
        });
    },


    _notifyResults: function(results) {
      this._schedulerRef.get().runSoon(_.bind(function() {

        if (this._stateGuard.applied("disposed") || !this._stateGuard.applied("started")) {
          return;
        }

        if (Log.isTraceEnabled()) {
          Log.trace("Notifying results", results);
        }

        this._channel.publish(this, results);
      }, this));
    },


    _scheduleNext: function(now) {
      if (this._stateGuard.applied("disposed") || !this._stateGuard.applied("started")) {
        return;
      }
      this._taskId = this._schedulerRef.get().schedule(this._runTask, now ? 0 : this._interval);
      Log.trace("Scheduled task", this._taskId);
    },


    _cancelPending: function() {
      Log.trace("cancelPending requested, looking for pending task.");
      if (this._taskId) {
        Log.trace("Found pending task; cancelling", this._taskId);
        this._schedulerRef.get().unschedule(this._taskId);
        this._taskId = null;
      }
    },

    _cancelOutstanding: function() {
      Log.trace("cancelOutstanding requested, looking for outstanding work.");
      if (this._currentRun) {
        Log.trace("Outstanding work found; cancelling");
        this._currentRun.cancel();
        this._currentRun = null;
      }
    },

    dispose: function(){
      if (this._stateGuard.applied("disposed")) {
        return;
      }

      this._cancelPending();
      this._cancelOutstanding();

      this._stateGuard.apply("disposed");
    }
  });

  return Periodic;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../core/options"),
  require("../core/state-guard"),
  require("../core/channel/channel"),
  require("../core/channel/chained-channel"),
  require("../core/logging/logger")
);

})()
},{"../core/options":6,"../core/state-guard":8,"../core/channel/channel":29,"../core/channel/chained-channel":30,"../core/logging/logger":27,"underscore":56,"bluebird":57}],4:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  M,
  Options,
  StateGuard
) {

  /**
   * Attempts to intelligently dispatch an object with an mT attribute, using
   * the rules provided at instantiation.
   *
   * For a given mTyped object, searches the provided `delegate` for a method
   * named [prefix][camel-cased mT], and if present, calls it. If not found,
   * looks for [prefix]Else. If the mT attribute isn't found, dispatches to
   * [prefix]Malformed.
   */
  var Dispatcher = function() {
    this.initialize.apply(this, arguments);
  };

  var DEFAULT_CONTEXT_DELEGATE = function() {
    return {};
  };

  _.extend(Dispatcher.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._delegate        = opts.getOrError("delegate"),
      this._prefix          = opts.getOrElse("prefix", "onMsg");
      this._elseSuffix      = opts.getOrElse("elseSuffix", "else");
      this._malformedSuffix = opts.getOrElse("malformedSuffix", "malformed");
      this._contextDelegate = opts.getOrElse("contextDelegate", DEFAULT_CONTEXT_DELEGATE);
      this._stateGuard      = new StateGuard(["disposed"]);
      this._subs            = M.hash_map();

      var channels = opts.getOrElse("listen", []);

      if (!_.isArray(channels)) {
        channels = [channels];
      }

      _.each(channels, _.bind(function(c) {
        this.listen(c)
      }, this));
    },

    listen: function(channel) {
      this._stateGuard.deny("disposed");

      var sub = channel.subscribe(_.bind(function(msg) {
        this.dispatch(msg);
      }, this));

      this._subs = M.assoc(this._subs, sub.id(), sub);

      return {
        dispose: _.bind(function(){
          var nSub = M.get(this._subs, sub.id());
          if (nSub) {
            this._subs = M.dissoc(this._subs, sub.id());
            nSub.dispose();
          }
        }, this)
      }
    },

    dispatch: function(mTyped, ctx) {
      if (this._stateGuard.applied("disposed")) {
        return;
      }

      var handler = this._getVettedHandlerName(mTyped);

      if (handler) {
        this._delegate[handler](mTyped, this._contextDelegate(mTyped, ctx));
      }
    },

    /**
     * Like `dispatch`, but expects delegate to return a Promise<object>
     */
    dispatchAsync: function(mTyped, ctx) {
      if (this._stateGuard.applied("disposed")) {
        return;
      }

      var handler = this._getVettedHandlerName(mTyped);
      if (handler) {
        return this._delegate[handler](mTyped, this._contextDelegate(mTyped, ctx));
      }
    },

    dispose: function() {
      if (this._stateGuard.applied("disposed")) {
        return;
      }

      var subs = this._subs;
      this._subs = M.hash_map();

      M.each(subs, function(pair) {
        M.nth(pair, 1).dispose();
      });

      this._delegate = null;

      this._stateGuard.apply("disposed");
    },

    _getHandlerName: function(prefix, suffix) {
      return prefix + suffix.charAt(0).toUpperCase() + suffix.substr(1);
    },

    _getVettedHandlerName: function(mTyped) {
      var mT = mTyped.mT,
          prefix = this._prefix,
          potentialHandlerName,
          finalHandlerName;

      if (!mT) {
        finalHandlerName = this._getHandlerName(prefix, this._malformedSuffix);
      } else {
        potentialHandlerName = this._getHandlerName(prefix, mT);
        if (_.isFunction(this._delegate[potentialHandlerName])) {
          finalHandlerName = potentialHandlerName;
        } else {
          finalHandlerName = this._getHandlerName(prefix, this._elseSuffix);
        }
      }

      if (_.isFunction(this._delegate[finalHandlerName])) {
        return finalHandlerName;
      }
    }
  });

  return Dispatcher;
};

module.exports = mod(
  require("underscore"),
  require("mori"),
  require("./options"),
  require("./state-guard")
);

})()
},{"./options":6,"./state-guard":8,"underscore":56,"mori":58}],5:[function(require,module,exports){
(function(){/*global require: false, module: false */

var mod = function (
  _
  ) {

  var CountdownLatch = function () {
        this.initialize.apply(this, arguments);
      },
      noop = function() {};

  _.extend(CountdownLatch.prototype, {
    initialize: function (steps, completionCallback) {
      this._steps = steps || 0;
      this._completionCallback = completionCallback || noop;
      _.bindAll(this, "_completionCallback", "_triggerCompletion");
      if(isNaN(this._steps) || this._steps < 0) {
        throw new Error("CountdownLatch: Number of steps are invalid.");
      }
      this._current = 0;
      this._complete = false;
      this._error = null;
      if(this._steps === 0) {
        _.defer(this._triggerCompletion);
        return;
      }
    },
    step: function (steps) {
      if (this._complete || this._steps === 0) {
        return;
      }
      this._current += steps || 1;
      if (this._current >= this._steps) {
        this._triggerCompletion();
      }
    },
    error: function (err) {
      if (this._complete || this._steps === 0) {
        return;
      }
      this._error = err;
      this._triggerCompletion();
    },
    _triggerCompletion: function () {
      if (this._complete) {
        return;
      }
      this._complete = true;
      if (this._error) {
        _.defer(_.bind(this._completionCallback, null, this._error));
      } else {
        _.defer(this._completionCallback);
      }
    }
  });

  return CountdownLatch;
};

module.exports = mod(
  require("underscore")
);

})()
},{"underscore":56}],6:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var factory = function(
  _
) {

  /**
   *
   * Helper for dealing with hash-style function arguments, which can be useful
   * in methods with optional/default values.
   *
   * Usage:
   *
   *   var foo = function(opts) {
   *       opts = Options.fromObject(opts);
   *
   *       var one = opts.getOrError("one"),
   *           two = opts.getOrElse("two", 2),
   *           three = opts.getOrElseFn("three", function() {
   *             return 3;
   *           });
   *
   *     console.log(one, two, three);
   *   };
   *
   *   foo({ one: 1 }); // logs "1, 2, 3"
   *   foo(); // throws Error
   *   foo({one: 1, two: false, three: 4}); // logs "1, false, 4"
   *
   */
  var Options = function(opts) {
    this.initialize.apply(this, arguments);
  }

  _.extend(Options.prototype, {
    initialize: function(opts) {
      this._providedOpts = opts || {};
    },

    /**
     * Attempts to return the value for the requested `key`. If the value
     * is undefined or null, instead returns the provided `fallbackValue`.
     *
     * @param key (required) attribute to be read
     * @param fallbackValue  returned if `key` attribute is null or undefined
     *
     * @returns requested value for `key`, or fallbackValue`
     */
    getOrElse: function(key, defaultValue) {
      if (this._isUndefOrNull(key)) {
        return defaultValue;
      } else {
        return this._providedOpts[key];
      }
    },

    /**
     * Attempts to return the value for the requested `key`. If the value
     * is undefined or null, throws an error.
     *
     * @param key (required) attribute to be read
     * @param err            message provided to Error constructor if `key`
     *                       is null or not defined
     *
     * @returns the value for the requested key
     */
    getOrError: function(key, errorMsg) {
      if (this._isUndefOrNull(key)) {
        errorMsg = errorMsg || "Option requested but not found: `"+key+"`";
        throw new Error(errorMsg);
      }

      return this._providedOpts[key];
    },

    /**
     * Attempts to return the value for the requested `key`. If the value
     * is undefined or null, instead evaluates `fallbackValueFn` and returns
     * its value.
     *
     * This is useful for simulating non-strict evaluation.
     *
     * @param key (required)  attribute to be read
     * @param fallbackValueFn evaluated and return value returned if `key`
     *                        attribute is null or undefined
     *
     * @returns requested value for `key` or the return value of evaluated
     *          `fallbackValueFn`
     */
    getOrElseFn: function(key, defaultValueFn) {
      if (typeof defaultValueFn !== "function") {
        throw new Error("Options#getOrElseFn requires a defaultValueFn");
      }

      if (this._isUndefOrNull(key)) {
        return defaultValueFn();
      } else {
        return this._providedOpts[key];
      }
    },


    toObject: function() {
      return _.clone(this._providedOpts);
    },

    scope: function(prefix) {
      return Options.fromObjectWithPrefix(this.toObject(), prefix);
    },

    _isUndefOrNull: function(key) {
      return typeof this._providedOpts[key] === "undefined" || this._providedOpts[key] === null;
    }
  });

  _.extend(Options, {
    fromObject: function(opts) {
      return new Options(opts);
    },


    fromObjectWithPrefix: function(opts, prefix) {
      opts = _.reduce(opts, function(memo, val, key) {
        var rest, newKey;
        if (key.indexOf(prefix) === 0) {
          rest = key.substr(prefix.length);
          if (rest.length > 1) {
            newKey = rest.charAt(0).toLowerCase() + rest.substr(1);
            memo[newKey] = val;
          }
        }
        return memo;
      }, {});

      return new Options(opts);
    }
  })

  return Options;
};

module.exports = factory(
  require("underscore")
);

})()
},{"underscore":56}],7:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var factory = function(
  _,
  Promise,
  Options
) {

  var Lang = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Lang.prototype, {
    initialize: function(){}
  });

  _.extend(Lang, {
    noop: function() {},

    partiallyApply: function() {
      var args = _.toArray(arguments),
          fun  = args.shift();

      return function() {
        return fun.apply(null, args.concat(arguments));
      };
    },

    makeErrorClass: function(name, defaultMessage) {
      if (!name) {
        throw new Error("makeErrorClass requires `name`");
      }

      var klass = function(message) {
        this.name    = name;
        this.message = this.name + ": " + (message || defaultMessage || "An unexpected error occurred");

        if (Error.captureStackTrace) {
          Error.captureStackTrace(this, klass);
        }
      };

      klass.prototype = Object.create(Error.prototype);
      klass.prototype.constructor = klass;
      return klass;
    },

    pojoClass: function(attributes, options) {
      if (!_.isArray(attributes)) {
        throw new Error("Lang#pojoClass requires attributes array");
      }

      var options = Options.fromObject(options),
          // optional specifies keys that are optional, with values that are default if not provided
          defaults = options.getOrElse("defaults", {}),
          optionalAttributes = _.keys(defaults);

      var toAttributeName = function(attr) {
            return "_" + attr;
          },
          toGetter = function(attr) {
            return attr;
          },
          toSetter = function(attr) {
            return "set" + attr.charAt(0).toUpperCase() + attr.substr(1);
          };

      var klass = function() {
        this.initialize.apply(this, arguments);
      };

      _.extend(klass.prototype, {
        initialize: function(opts) {
          opts = Options.fromObject(opts);
          _.each(attributes, function(attr) {
            if (_.contains(optionalAttributes, attr)) {
              this[toAttributeName(attr)] = opts.getOrElse(attr, defaults[attr]);
            } else {
              this[toAttributeName(attr)] = opts.getOrError(attr);
            }
          }, this);
        }
      });

      _.each(attributes, function(attr) {
        klass.prototype[toGetter(attr)] = function() {
          return this[toAttributeName(attr)];
        };
        klass.prototype[toSetter(attr)] = function(v) {
          this[toAttributeName(attr)] = v;
        };
      });

      return klass;
    },

    deferred: function(promiseClass) {
      promiseClass = promiseClass || Promise;
      var res = null, rej = null;
      var p = new promiseClass(function() {
        res = arguments[0];
        rej = arguments[1];
      });

      return {
        promise: p,
        resolve: res,
        reject: rej
      };
    }
  });

  return Lang;
};

module.exports = factory(
  require("underscore"),
  require("bluebird"),
  require("./options")
);

})()
},{"./options":6,"underscore":56,"bluebird":57}],8:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise
) {

  /**
   * A StateGuard does what its name implies. Valid states are provided during instantiation, and are applied, ensured,
   * denied, etc, through the course of the owner's lifetime.
   *
   * For example, if you'd like to ensure that Foo#bar raises an error after Foo#dispose is called, you might do the
   * following:
   *
   *   var Foo = function() {
   *     this.initialize.apply(this, arguments);
   *   };
   *
   *   _.extend(Foo.prototype, {
   *     initialize: function() {
   *       this._expensiveResource = new ExpensiveResource();
   *       this._stateGuard = new StateGuard(["disposed"]);
   *     },
   *     dispose: function() {
   *       // #dispose should be idempotent, so here we just check to see if we've already disposed, and return.
   *       // Note that if dispose were async, we'd need to add a "disposing" state.
   *       if (this._stateGuard.applied("disposed")) {
   *         return;
   *       }
   *
   *       if (this._expensiveResource) {
   *         this._expensiveResource.dispose();
   *         this._expensiveResource = null;
   *       }
   *       this._stateGuard.apply("disposed");
   *     },
   *     bar: function() {
   *       this._stateGuard.deny("disposed"); // Throws exception if #dispose was called
   *
   *       return this._expensiveResource.someMethod();
   *     }
   *   });
   *
   * In this case, where we have only one state, it's useful to simply create a scoped StateGuard, which behaves
   * identically to a regular one, except every enforcement/query method has the scope provided during instantiation
   * as a first, implicit argument:
   *
   *   // Identical to previous version.
   *
   *   var Foo = function() {
   *     this.initialize.apply(this, arguments);
   *   };
   *
   *   _.extend(Foo.prototype, {
   *     initialize: function() {
   *       this._expensiveResource = new ExpensiveResource();
   *       this._stateGuard = StateGuard.scoped("disposed");
   *     },
   *     dispose: function() {
   *       // #dispose should be idempotent, so here we just check to see if we've already disposed, and return.
   *       // Note that if dispose were async, we'd need to add a "disposing" state.
   *       if (this._stateGuard.applied()) {
   *         return;
   *       }
   *
   *       if (this._expensiveResource) {
   *         this._expensiveResource.dispose();
   *         this._expensiveResource = null;
   *       }
   *       this._stateGuard.apply();
   *     },
   *     bar: function() {
   *       this._stateGuard.deny(); // Throws exception if #dispose was called
   *
   *       return this._expensiveResource.someMethod();
   *     }
   *   });
   *
   */
  var StateGuard = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(StateGuard.prototype, {
    initialize: function(states) {
      this._validStates = _.reduce(states, function(memo, state) {
        memo[state] = true;
        return memo;
      }, {});

      this._appliedStates = {};
    },

    scope: function(state) {
      var skip = ["scope", "initialize"],
          self = this,
          scoped = {};

      _.each(StateGuard.prototype, function(fun, methodName) {
        if (_.contains(skip, methodName)) {
          return;
        }

        scoped[methodName] = function() {
          var args = _.toArray(arguments);
          args.unshift(state);
          return fun.apply(self, args);
        };
      });

      return scoped;
    },

    apply: function() {
      var states = aryOrVariadicToArray(arguments);
      checkValidStatesOrThrow(this._validStates, states);

      _.each(states, function(state) {
        this._appliedStates[state] = true;
      }, this);

      return this;
    },

    applyAsync: Promise.method(function() {
      return this.apply.apply(this, arguments);
    }),

    applyAsyncFn: function() {
      var args = arguments;
      return _.bind(function() {
        return this.applyAsync.apply(this, args);
      }, this);
    },

    unapply: function() {
      var states = aryOrVariadicToArray(arguments);
      checkValidStatesOrThrow(this._validStates, states);

      _.each(states, function(state) {
        if (this._appliedStates[state]) {
          delete this._appliedStates[state];
        }
      }, this);

      return this;
    },

    unapplyAsync: Promise.method(function() {
      return this.unapply.apply(this, arguments);
    }),

    unapplyAsyncFn: function(states) {
      var args = arguments;
      return _.bind(function() {
        return this.unapplyAsync.apply(this, args)
      }, this);
    },

    deny: function() {
      var states = aryOrVariadicToArray(arguments);
      checkValidStatesOrThrow(this._validStates, states);

      var applied = _.filter(states, function(state) {
        return this._appliedStates[state];
      }, this);

      if (applied.length > 0) {
        throw new Error("State denial requested, but applied: " + pretty(applied));
      }

      return this;
    },

    denyAsync: Promise.method(function() {
      return this.deny.apply(this, arguments);
    }),

    denyAsyncFn: function() {
      var args = arguments;
      return _.bind(function() {
        return this.denyAsync.apply(this, args)
      }, this);
    },

    ensure: function() {
      var states = aryOrVariadicToArray(arguments);
      checkValidStatesOrThrow(this._validStates, states);
      var missing = _.reject(states, function(state) {
        return this._appliedStates[state];
      }, this);

      if (missing.length > 0) {
        throw new Error("State ensurance requested, but not applied: " + pretty(missing));
      }
      return this;
    },

    ensureAsync: Promise.method(function() {
      return this.ensure.apply(this, arguments);
    }),

    ensureAsyncFn: function() {
      var args = arguments;
      return _.bind(function() {
        return this.ensureAsync.apply(this, args);
      }, this);
    },

    applied: function() {
      var states = aryOrVariadicToArray(arguments);
      checkValidStatesOrThrow(this._validStates, states);

      return _.every(states, function(state) {
        return this._appliedStates[state];
      }, this);
    },

    appliedAsync: Promise.method(function() {
      return this.applied.apply(this, arguments);
    }),

    appliedAsyncFn: function() {
      var args = arguments;
      return _.bind(function() {
        return this.appliedAsync.apply(this, args)
      }, this);
    }
  });

  var aryOrVariadicToArray = function(args) {
    return _.chain(args).toArray().flatten().value();
  };

  var checkValidStatesOrThrow = function(validStatesMap, states) {
    var invalidStates = _.reject(states, function(state) {
      return !!validStatesMap[state];
    });

    if (invalidStates.length > 0) {
      throw new Error("Invalid states provided: " + pretty(invalidStates));
    }
  };

  var pretty = function(states) {
    return "["+states.join(",")+"]";
  };

  _.extend(StateGuard, {
    scoped: function(scope) {
      return (new StateGuard([scope])).scope(scope);
    }
  })

  return StateGuard;
};

module.exports = mod(
  require("underscore"),
  require("bluebird")
);

})()
},{"underscore":56,"bluebird":57}],9:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _
) {

  var PubSub = {
    on: function(eventName, handler, context) {
      var bucket = this.__pubSubBucket(eventName);
      bucket.subscribe(handler, context);
    },
    off: function(eventName, handler, context) {
      var bucket = this.__pubSubBucket(eventName);
      bucket.unsubscribe(handler, context);
    },
    notify: function() {
      var args      = _.toArray(arguments),
          eventName = args.shift();

      var bucket = this.__pubSubBucket(eventName);
      bucket.notify(args);
    },
    __pubSubBucket: function(eventName) {
      this.__pubSubEvents = this.__pubSubEvents || {};
      this.__pubSubEvents[eventName] = this.__pubSubEvents[eventName] || new EventBucket(eventName);
      return this.__pubSubEvents[eventName];
    }
  };

  var EventBucket = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(EventBucket.prototype, {
    initialize: function(eventName) {
      this._eventName = eventName;
      this._subscriptions = [];
    },
    subscribe: function(handler, context) {
      if (handler) {
        this._subscriptions.push(new Subscription(handler, context));
      } else {
        throw new Error("Subscription requires handler: " + this._eventName);
      }
    },
    unsubscribe: function(handler, context) {
      var subs;
      if (handler) {
        subs = _.filter(this._subscriptions, function(sub) {
          return sub.matches(handler, context);
        });
      } else {
        subs = this._subscriptions;
      }

      _.each(subs, function(sub) {
        sub.dispose();
      });

      this._subscriptions = _.difference(this._subscriptions, subs);
    },
    notify: function(args) {
      _.invoke(this._subscriptions, "notify", args);
    }
  });

  var Subscription = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Subscription.prototype, {
    initialize: function(handler, context) {
      this._handler = handler;
      this._context = context;
    },
    matches: function(handler, context) {
      if (this._context) {
        // Compare context refs as refs iff we have a context object
        return (handler === this._handler && context === this._context);
      } else {
        // Otherwise, just make sure we don't have a context (null or undefined are fine)
        return (handler === this._handler && !context);
      }
    },
    notify: function(args) {
      // We shouldn't be called after dispose, but
      // just in case...
      if (this._handler) {
        this._handler.apply(this._context, args);
      } else {
        console.log("WTF");
      }
    },
    dispose: function() {
      this._handler = null;
      this._context = null;
    }
  })

  return PubSub;
};

module.exports = mod(
  require("underscore")
);

})()
},{"underscore":56}],14:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options
) {

  var DoublyLinkedList = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(DoublyLinkedList.prototype, {
    initialize: function() {
      this._front = null;
      this._back = null;
      this._size = 0;
    },

    get: function(idx) {
      this._checkElementIdxOrThrow(idx);
      var node = this._walkToIdx(idx);
      return node.value();
    },

    exists: function(value) {
      var node = this._walkToValue(value);
      return !!node;
    },

    size: function() {
      return this._size;
    },

    add: function(value) {
      return this.addBack.apply(this, arguments);
    },

    addFront: function(value) {
      this._linkFront(value);
    },

    addBack: function(value) {
      this._linkBack(value);
    },

    remove: function(value) {
      var node = this._walkToValue(value);
      return this._unlink(node);
    },

    removeFront: function() {
      if (this._front === null) {
        throw new Error("No such element");
      }
      return this._unlinkFront(this._front);
    },

    removeBack: function() {
      if (this._back === null) {
        throw new Error("No such element");
      }
      return this._unlinkBack(this._back);
    },

    insertAtIndex: function(idx, value) {
      this._checkIsElementPositionOrThrow(idx);

      if (idx === this._size) {
        this.addBack(value);
      } else {
        var node = this._walkToIdx(idx);
        this._linkBefore(value, node);
      }
    },

    removeAtIndex: function(idx) {
      this._checkElementIdxOrThrow(idx);
      if (idx === 0) {
        return this._unlinkFront(this._front);
      } else if ( idx === (this._size - 1) ) {
        return this._unlinkBack(this._back);
      } else {
        var node = this._walkToIdx(idx);
        return this._unlink(node);
      }
    },

    clear: function() {
      var node = this._front,
          next;

      while (node !== null) {
        next = node.next();
        node.dispose();
        node = next;
      }
      this._front = null;
      this._back  = null;
      this._size = 0;
    },

    _linkFront: function(value) {
      var oldFront = this._front,
          newNode = new Node({value: value});
      this._front = newNode;

      if (oldFront === null) {
        this._back = newNode;
      } else {
        oldFront.setPrev(newNode);
        newNode.setNext(oldFront);
      }

      this._size++;
      return newNode;
    },

    _linkBack: function(value) {
      var oldBack = this._back,
          newNode = new Node({value: value});

      this._back = newNode;
      if (oldBack === null) {
        this._front = newNode;
      } else {
        oldBack.setNext(newNode);
        newNode.setPrev(oldBack);
      }

      this._size++;
      return newNode;
    },

    _linkBefore: function(value, node) {
      var pred    = node.prev(),
          newNode = new Node({value: value, prev: pred, next: node});

      node.setPrev(newNode);
      if (pred === null) {
        this._front = newNode;
      } else {
        pred.setNext(newNode);
      }
      this._size++;
      return newNode;
    },

    _unlinkFront: function(node) {
      var value    = node.value(),
          newFront = node.next();

      node.dispose();
      this._front = newFront;
      if (newFront === null) {
        this._back = null;
      } else {
        newFront.setPrev(null);
      }
      this._size--;
      return value;
    },

    _unlinkBack: function(node) {
      var value   = node.value(),
          newBack = node.prev();

      node.dispose();
      this._back = newBack;
      if (newBack == null) {
        this._front = null;
      } else {
        newBack.setNext(null);
      }
      this._size--;
      return value;
    },

    _unlink: function(node) {
      var prev  = node.prev(),
          next  = node.next(),
          value = node.value();

      if (prev === null) {
        this._front = next;
      } else {
        prev.setNext(next);
      }

      if (next === null) {
        this._back = prev;
      } else {
        next.setPrev(prev);
      }

      node.dispose();
      this._size--;
      return value;
    },

    _walkToIdx: function(idx) {
      var node, current;
      if (idx < this._size / 2) {
        node = this._front;
        current = 0;
        while(current !== idx) {
          node = node.next();
          current++;
        }
      } else {
        node = this._back;
        current = this._size - 1;

        while(current !== idx) {
          node = node.prev();
          current--;
        }
      }
      return node;
    },

    _walkToValue: function(value) {
      var n = this._front;
      while (n !==null ) {
        if (n.match(value)) {
          return n;
        }
        n = n.next();
      }
      return null;
    },

    _isElementIdx: function(idx) {
      return (idx >= 0 && idx < this._size);
    },

    _isElementPosition: function(idx) {
      return (idx >= 0 && idx <= this._size);
    },

    _checkElementIdxOrThrow: function(idx) {
      if (!this._isElementIdx(idx)) {
        throw new Error("Index out of bounds; size: " + this._size + "; idx: " + idx);
      }
    },

    _checkIsElementPositionOrThrow: function(idx) {
      if (!this._isElementPosition(idx)) {
        throw new Error("Index out of bounds; size: " + this._size + "; idx: " + idx);
      }
    }

  });

  var Node = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Node.prototype, {
    initialize: function(opts) {
      opts        = Options.fromObject(opts);
      this._next  = opts.getOrElse("next", null);
      this._prev  = opts.getOrElse("prev", null);
      this._value = opts.getOrElse("value", null);
    },

    next: function() {
      return this._next;
    },

    prev: function() {
      return this._prev;
    },

    setNext: function(node) {
      this._next = node;
    },

    setPrev: function(node) {
      this._prev = node;
    },

    value: function() {
      return this._value;
    },

    dispose: function() {
      this._next  = null;
      this._prev  = null;
      this._value = null;
    },

    match: function(value) {
      return this._value === value;
    }
  });

  return DoublyLinkedList;
};

module.exports = mod(
  require("underscore"),
  require("../core/options")
);

})()
},{"../core/options":6,"underscore":56}],15:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options
) {

  /**
   * Delegates storage to a JS object.
   */
  var ObjectHashMap = function() {
    this.initialize.apply(this, arguments);
  };


  _.extend(ObjectHashMap.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._store = {};
      this._keyPrefix = opts.getOrElse("keyPrefix", "ohm-");
    },
    get: function(key){
      return this._store[this._makeKey(key)];
    },
    put: function(key, val) {
      this._store[this._makeKey(key)] = val;
    },
    remove: function(key) {
      var val;
      key = this._makeKey(key);
      if (_.has(this._store, key)) {
        val = this._store[key];
        delete this._store[key];
      }
      return val;
    },
    exists: function(key) {
      return _.has(this._store, this._makeKey(key));
    },
    size: function() {
      return _.size(this._store);
    },
    clear: function() {
      this._store = {};
    },
    _makeKey: function(key) {
      return this._keyPrefix + key;
    }
  });


  return ObjectHashMap;
};

module.exports = mod(
  require("underscore"),
  require("../core/options")
);

})()
},{"../core/options":6,"underscore":56}],16:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options,
  ObjectHashMap,
  DoublyLinkedList
) {

  var LRUHashMap = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(LRUHashMap.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._capacity = opts.getOrError("capacity");
      this._keyAccessList = new DoublyLinkedList();
      // TODO: Really need a proper HashMap at some point...
      this._store = new ObjectHashMap();
    },
    get: function(key) {
      var entry = this._store.get(key);
      if (!entry) {
        return;
      }

      // As a perf optimization, we keep a ref
      // to the node in the entry.
      var node = entry.node();
      this._keyAccessList._unlink(node);

      // Get the new node
      node = this._keyAccessList._linkFront(entry.key());

      // Save it
      entry.setNode(node);
      // Return the value
      return entry.value();
    },

    put: function(key, val) {
      var entry = this._store.get(key),
          node;
      if (!entry) {
        // If no entry, make a new entry
        if (this._keyAccessList.size() >= this._capacity) {
          // Have to make room for it
          var evictedKey = this._keyAccessList.removeBack(),
              evictedEntry = this._store.get(evictedKey);

          evictedEntry.dispose();
          this._store.remove(evictedKey);
        }

        node = this._keyAccessList._linkFront(key);
        entry = new Entry({
          key: key,
          value: val,
          node: node
        });
        this._store.put(key, entry);
      } else {
        // "Touch" the entry, set new value
        node = entry.node();
        this._keyAccessList._unlink(node);
        node = this._keyAccessList._linkFront(entry.key());
        // Update with the new node and value
        entry.setNode(node);
        entry.setValue(val);
      }
    },

    remove: function(key) {
      var entry = this._store.get(key),
          value,
          node;
      if (entry) {
        value = entry.value();
        node = entry.node();
        this._keyAccessList._unlink(node);
        entry.dispose();
        this._store.remove(key);
        return value;
      }
    },

    exists: function(key) {
      return this._store.exists(key);
    },

    size: function() {
      return this._store.size();
    },

    clear: function() {
      this._store.clear();
      this._keyAccessList.clear();
    }
  });

  var Entry = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Entry.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      // Though the Node should have the key, if the node
      // is unlinked from the list, its boxed value will disappear
      this._key   = opts.getOrError("key");
      this._value = opts.getOrError("value");
      this._node  = opts.getOrError("node");
    },
    node: function() {
      return this._node;
    },
    setNode: function(node) {
      this._node = node;
    },
    value: function() {
      return this._value;
    },
    setValue: function(value) {
      this._value = value;
    },
    key: function() {
      return this._key;
    },
    dispose: function() {
      this._key = null;
      this._value = null;
      this._node = null;
    }
  });

  return LRUHashMap;
};

module.exports = mod(
  require("underscore"),
  require("../core/options"),
  require("./object-hash-map"),
  require("./doubly-linked-list")
);

})()
},{"../core/options":6,"./object-hash-map":15,"./doubly-linked-list":14,"underscore":56}],17:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options,
  InMemoryDataStore,
  UnitSequencer,
  Entry
) {

  // Appropriate for the default sequencer (non-temporal)
  var DEFAULT_TTL = 1;


  /**
   * A look-aside caching data store. Note: it's generally not useful to allow
   * null/undefined stored values. When an item is evicted from the cache, a
   * subsequent `get` call will return `undefined`, so it can be difficult to
   * determine if there was a cache miss if the value you're storing is, in fact,
   * `undefined`, unless you prefix every check with `exists`, which also does
   * cache eviction on check.
   */
  var CachingDataStore = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(CachingDataStore.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._ttl = opts.getOrElse("ttl", DEFAULT_TTL);

      // Default sequencer is a linear/unit sequencer. The default TTL is
      // 1. Therefore, all values will expire with single advance of the
      // sequencer. Note that the data store doesn't advance the
      // sequencer itself. The store owner is responsible for doing
      // this.
      //
      // This is especially important to note for time-based sequencers.
      // Time will not advance automatically. The store owner is responsible
      // for scheduling the sequencer to advance with time. This keeps the
      // CachingDataStore's lifecycle simple with respect to time.
      this._sequencer = opts.getOrElseFn("sequencer", function() {
        return new UnitSequencer();
      });

      // By default, we delegate to an in-memory store. Fine for simple
      // cases, but not optimal.
      this._backingStore = opts.getOrElseFn("backingStore", function() {
        return new InMemoryDataStore();
      });

      // Updates the lastUpdated time to "now" on read - keeps entries
      // from expiring when they're being accessed, but can cause
      // staleness issues.
      this._shouldTouchOnRead = opts.getOrElse("touchOnRead", false);
    },

    sequencer: function() {
      return this._sequencer;
    },


    /**
     * Gets the value associated with the provided key. If the object has
     * expired, it will be evicted from the cache, and `undefined` will
     * be returned instead.
     *
     * @param key {string} (required)
     * @async
     * @returns {Promise<Object>} requested value
     */
    get: Promise.method(function(key) {
      return Promise
        .bind(this)
        .then(function() {
          return this._backingStore.get(key);
        })
        .then(function(entry){
          if (!entry) {
            return;
          }

          if (!entry.isExpired(this._sequencer.value(), this._ttl)) {
            if (this._shouldTouchOnRead) {
              entry.touch(this._sequencer.value());
            }
            return Promise
              .bind(this)
              .then(function() {
                return this._backingStore.put(key, entry);
              })
              .return(entry.value());
          } else {
            return Promise
              .bind(this)
              .then(function() {
                return this.remove(key)
              })
              .then(function() {
                // .thenReturn is a lie.
                return;
              });
          }
        });
    }),

    /**
     * Stores the provided `val`, identified by `key`
     *
     * @param `key` {string}  (required) identifier for value to be stored
     * @param `val` {dynamic} (required) value to be stored
     * @async
     * @returns {Promise<>}
     */
    put: Promise.method(function(key, val) {
      return Promise
        .bind(this)
        .then(function() {
          return this._backingStore.get(key);
        })
        .then(function(entry) {
          // If we have an entry, we should just update
          // Else, we make new one.
          // Pesist, then return nothing.
          if (entry) {
            entry.update(val, this._sequencer.value());
          } else {
            entry = new Entry({
              value: val,
              initialSequence: this._sequencer.value()
            });
          }

          return Promise
            .bind(this)
            .then(function() {
              return this._backingStore.put(key, entry)
            })
            .then(function() {
              return;
            });
        });
    }),

    /**
     * Removes the value associated with the provided `key`
     *
     * @param `key` {string} (required) identifier for value to be removed
     * @async
     * @returns {Promise<dynamic>} Removed value, if present in store.
     */
    remove: Promise.method(function(key) {
      var val;
      return this._backingStore
        .remove(key)
        .then(function(entry) {
          if (entry) {
            val = entry.value();
            entry.dispose();
            return val;
          }
        });
    }),

    exists: Promise.method(function(key){
      // It's not sufficient to delegate this call to the underlying
      // backing store. We need to perform eviction, as a subsequent call
      // to get would do the same. If the `exists` check says it exists,
      // bet it doesn't when we `get`, then `exists` is a worthless operation.
      //
      // Note that if you're using a CachingDataStore backed by an InMemoryDataStore
      // backed by an LRUHashMap, this will cause the entry to be "touched", whereas
      // a normal "exists" check would not.
      return Promise
        .bind(this)
        .then(function() {
          return this._backingStore.get(key);
        })
        .then(function(entry) {
            if (!entry) {
              return false;
            } else {
              if (!entry.isExpired(this._sequencer.value(), this._ttl)) {
                return true;
              } else {
                return this._backingStore.remove(key)
                  .then(function() {
                    entry.dispose();
                  })
                  .thenReturn(false);
              }
            }
        });
    }),

    clear: Promise.method(function() {
      return this._backingStore.clear();
    })
  });

  return CachingDataStore;

};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../core/options"),
  require("./in-memory-data-store"),
  require("../core/sequencer/unit-sequencer"),
  require("./internals/expiring-entry")
);

})()
},{"../core/options":6,"./in-memory-data-store":18,"../core/sequencer/unit-sequencer":10,"./internals/expiring-entry":49,"underscore":56,"bluebird":57}],18:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options,
  ObjectHashMap
) {

  /**
   * InMemoryDataStore delegates to a backing HashMap. By default, this
   * will be a "poor man's HashMap", a.k.a., the ObjectHashMap.
   */
  var InMemoryDataStore = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(InMemoryDataStore.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._map = opts.getOrElseFn("backingHashMap", function() {
        return new ObjectHashMap();
      });
    },

    get: Promise.method(function(key) {
      return this._map.get(key);
    }),

    put: Promise.method(function(key, val) {
      return this._map.put(key, val);
    }),

    remove: Promise.method(function(key) {
      return this._map.remove(key);
    }),

    exists: Promise.method(function(key){
      return this._map.exists(key);
    }),

    clear: Promise.method(function() {
      return this._map.clear();
    })
  });

  return InMemoryDataStore;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../core/options"),
  require("../collection/object-hash-map")
);

})()
},{"../core/options":6,"../collection/object-hash-map":15,"underscore":56,"bluebird":57}],19:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options,
  InMemoryDataStore,
  LRUHashMap
) {

  var LRUDataStore = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(LRUDataStore.prototype, InMemoryDataStore.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      var map = new LRUHashMap({
        capacity: opts.getOrError("capacity")
      });
      InMemoryDataStore.prototype.initialize.call(this, {
        backingHashMap: map
      });
    }
  });

  return LRUDataStore;
};

module.exports = mod(
  require("underscore"),
  require("../core/options"),
  require("./in-memory-data-store"),
  require("../collection/lru-hash-map")
);

})()
},{"../core/options":6,"./in-memory-data-store":18,"../collection/lru-hash-map":16,"underscore":56}],20:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  M,
  Options,
  Channel,
  ChainedChannel,
  UnitSequencer,
  DelegatingForwardingSequencer,
  InMemoryDataStore,
  Entry
) {

  /**
   * Semantically similar to a CachingDataStore, except:
   *   1) Expiry is check both on access, and whenever `advance` is
   *      called on the `sentrySequencer`.
   *   2) Records are not automatically removed; instead, a signal is sent
   *      along the `signalChannel`. The signal dispatch is deferred, so
   *      an access-triggered evocation signal won't be received until a
   *      subsequent tick. Since promises are asynchronous, this means
   *      the caller may receive a value from the store, and may also
   *      receive an event from the Store indicating expiry - in non-deterministic
   *      order. It's up to the caller to choose a resolution.
   *      Additionally, there is no guarantee that a single expiry event
   *      will be sent for a given key; instead, the event will continue
   *      to be dispatched for as long as the key remains in the store.
   * @constructor
   */
  var SignalingDataStore = function() {
    this.initialize.apply(this, arguments);
  };

  var DEFAULT_TTL = 1;

  _.extend(SignalingDataStore.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._ttl = opts.getOrElse("ttl", DEFAULT_TTL);

      this._sequencer = opts.getOrElseFn("sequencer", function() {
        return new UnitSequencer();
      });

      _.bindAll(this, "_doCheck");

      this._sentrySequencer = new DelegatingForwardingSequencer({
        delegate: new UnitSequencer(),
        targets: [{
          advance: this._doCheck
        }]
      });

      this._backingStore = opts.getOrElseFn("backingStore", function() {
        return new InMemoryDataStore();
      });

      this._shouldTouchOnRead = opts.getOrElse("touchOnRead", false);

      this._signalChannel = new Channel({ sentinel: this });

      this._keys = M.set();
    },

    sequencer: function() {
      return this._sequencer;
    },

    sentrySequencer: function() {
      return this._sentrySequencer;
    },

    signalChannel: function() {
      return new ChainedChannel({
        sentinel: this,
        chainTo: this._signalChannel
      });
    },

    _doCheck: function() {
      var work = M.map(_.bind(function(key) {
        return Promise
          .bind(this)
          .then(function() {
            return this._backingStore.get(key);
          })
          .then(function(entry) {
            if (entry && entry.isExpired(this._sequencer.value(), this._ttl)) {
              this._signalExpirySoon(key, this._sequencer.value());
            }
          });
        }, this), this._keys);

      return Promise.all(M.into_array(work));
    },

    /**
     * Gets the value associated with the provided `key`. If the object
     * has expired, it will still be returned from the Store, but an mT:expired
     * message will be sent along the `signalChannel`.
     *
     * @param key {string}
     * @async
     * @returns {Promise<object>} requested value
     */
    get: Promise.method(function(key){
      return Promise
        .bind(this)
        .then(function() {
          return this._backingStore.get(key);
        })
        .then(function(entry) {
          if (!entry) {
            return;
          }

          var isExpired = entry.isExpired(this._sequencer.value(), this._ttl);

          if (isExpired) {
            this._signalExpirySoon(key, this._sequencer.value());
          }

          if (!isExpired && this._shouldTouchOnRead) {
            entry.touch(this._sequencer.value());
            return Promise
              .bind(this)
              .then(function() {
                return this._backingStore.put(key, entry);
              })
              .thenReturn(entry.value());
          } else {
            return entry.value();
          }
        });
    }),

    /**
     * Stores the provided `val`, identified by `key`, with a TTL optionally
     * supplied by `opts.ttl` (overrides pre-configured Store TTL.
     *
     * @param key {String}
     * @param val {object} value to be stored
     * @async
     * @returns {Promise<>}
     */
    put: Promise.method(function(key, val, opts) {
      opts = Options.fromObject(opts);

      return Promise
        .bind(this)
        .then(function() {
          return this._backingStore.get(key);
        })
        .then(function(entry) {
          if (entry) {
            entry.update(val, this._sequencer.value(), {
              ttl: opts.getOrElse("ttl")
            });
          } else {
            entry = new Entry({
              value: val,
              initialSequence: this._sequencer.value(),
              ttl: opts.getOrElse("ttl")
            });
          }
          return Promise
            .bind(this)
            .then(function () {
              return this._backingStore.put(key, entry);
            })
            .then(function() {
              this._keys = M.conj(this._keys, key);
              return; // Because thenReturn doesn't work with an empty value.
            });
        });
    }),


    /**
     * Removes the value associated with the provided `key`
     */
    remove: Promise.method(function(key){
      var val;
      return this._backingStore
        .remove(key)
        .bind(this)
        .then(function(entry) {
          if (entry) {
            this._keys = M.disj(this._keys, key);

            val = entry.value();
            entry.dispose();
            return val;
          }
        });
    }),


    exists: Promise.method(function(key){
      // Unlike in the CachingDataStore, where we have to perform eviction rules before
      // returning the answer, here we can just delegate straight to the backing store.
      return this._backingStore.exists(key);
    }),


    clear: Promise.method(function(){
      return this._backingStore.clear();
    }),


    _signalExpirySoon: function(key, sequence) {
      _.defer(_.bind(function(){
        this._signalChannel.publish(this, {
          mT: "expired",
          key: key,
          sequence: sequence
        });
      }, this));
    }
  });

  return SignalingDataStore;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("mori"),
  require("../core/options"),
  require("../core/channel/channel"),
  require("../core/channel/chained-channel"),
  require("../core/sequencer/unit-sequencer"),
  require("../core/sequencer/delegating-forwarding-sequencer"),
  require("./in-memory-data-store"),
  require("./internals/expiring-entry")
);

})()
},{"../core/options":6,"../core/channel/channel":29,"../core/channel/chained-channel":30,"../core/sequencer/unit-sequencer":10,"../core/sequencer/delegating-forwarding-sequencer":13,"./in-memory-data-store":18,"./internals/expiring-entry":49,"underscore":56,"bluebird":57,"mori":58}],23:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  ScopedConfigurationResolver
) {

  var ConfigurationMagic = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(ConfigurationMagic.prototype, {
    initialize: function() {}
  });

  _.extend(ConfigurationMagic, {
    resolveConfig: function(scopes, configObjects) {
      var r = new ScopedConfigurationResolver();
      _.each(configObjects, function(c) {
        r.add(c);
      });
      return r.resolve(scopes);
    }
  });

  return ConfigurationMagic;
};

module.exports = mod(
  require("underscore"),
  require("./config/scoped-configuration-resolver")
);

})()
},{"./config/scoped-configuration-resolver":24,"underscore":56}],26:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Logger,
  Options,
  StateGuard,
  Runtime,
  ProcessKeepAlive
) {
  var Log = Logger.create("App");

  var App = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(App.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._guard = new StateGuard(["starting", "started", "stopping", "stopped"]);
      this._rawConfig = opts.getOrError("configuration");
      this._config = Options.fromObject(this._rawConfig);

      // The default Runtime has sensible defaults.
      this._runtime = opts.getOrElseFn("runtime", function() {
        return new Runtime();
      });

      this._keepAlive = new ProcessKeepAlive({
        scheduler: this._runtime.scheduler()
      });

      var up   = opts.getOrElse("up"),
          down = opts.getOrElse("down");

      if (up) {
        this.up = Promise.method(_.bind(function() {
          return up.call(this, this._config);
        }, this));
      }

      if (down) {
        this.down = Promise.method(_.bind(function() {
          return down.call(this, this._config);
        }, this));
      }

    },

    start: Promise.method(function() {
      Log.debug("Starting App");
      this._guard
        .deny("starting")
        .apply("starting");

      this._keepAlive.start();
      Log.debug("Calling App#up()");

      return this.up()
        .then(this._guard.applyAsyncFn("started"));
    }),

    stop: Promise.method(function() {
      Log.debug("Stopping App");
      this._guard
        .deny("stopping")
        .apply("stopping");

      this._keepAlive.stop();
      Log.debug("Calling App#down()");

      return this.down()
        .then(this._guard.applyAsyncFn("stopped"));
    }),

    /**
     * Returns the requested configuration value, or throws an error.
     * @param key the configuration key request from the Configuration.
     * @returns {Object}
     */
    config: function(key) {
      return this._config.getOrError(key);
    },

    /**
     * TODO: Doc. Subclass should override.
     */
    up: Promise.method(function() {}),

    /**
     * TODO: Doc. Subclass should override.
     */
    down: Promise.method(function() {})
  });

  return App;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../core/logging/logger"),
  require("../core/options"),
  require("../core/state-guard"),
  require("../runtime"),
  require("./internal/process-keep-alive")
);

})()
},{"../core/logging/logger":27,"../core/options":6,"../core/state-guard":8,"./internal/process-keep-alive":48,"../runtime":42,"underscore":56,"bluebird":57}],32:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  M,
  Logger,
  Options,
  UUID,
  DelegatingForwardingSequencer,
  UnitSequencer,
  InMemoryFiber,
  Mailbox,
  Dispatcher,
  SignalingDataStore,
  Periodic,
  ClockSequencer,
  SystemClock,
  Runtime
  ) {

  var Exchange = function() {
    this.initialize.apply(this, arguments);
  };

  var MSG_SEND             = Exchange.MSG_SEND             = "send",
      MSG_SEND_AND_RECEIVE = Exchange.MSG_SEND_AND_RECEIVE = "sendAndReceive",
      MSG_REPLY            = Exchange.MSG_REPLY            = "reply";

  // 7.5 seconds is reasonable, yes?
  var DEFAULT_REPLY_TIMEOUT = 7500;

  var Log = Logger.create("Exchange");


  _.extend(Exchange.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);

      this._identity = opts.getOrElse("identity", UUID.v4());

      this._runtime = opts.getOrElseFn("runtime", function() {
        return new Runtime();
      });

      this._mailboxFiberDelegate = {
        receiveFiberMessage: this._receiveMailboxFiberMessage.bind(this)
      };

      this._mailboxes = M.hash_map();

      this._fiber     = opts.getOrElseFn("fiber", function() {
        return new InMemoryFiber();
      });

      this._fiber.registerEntity({
        identity: this._identity,
        delegate: this
      });

      this._mailboxDispatcher = new Dispatcher({
        delegate: this,
        prefix: "_onMbx"
      });

      var usedDefaultClock = false;

      // For requester-provided requestId to messageId mapping.
      // Used for cancelling outstanding sendAndReceive requests.
      this._reqToMsg = M.hash_map();

      // Data store for pending requests
      this._outstandingRequests = new SignalingDataStore({
        ttl: opts.getOrElse("replyTimeout", DEFAULT_REPLY_TIMEOUT),
        sequencer: new ClockSequencer({
          clock: opts.getOrElseFn("clock", function() {
            usedDefaultClock = true;
            return new SystemClock();
          }),
          // Hax - Since we want time to be async, but provide a default system clock
          // we need to get the initial clock sequence sync, by bypassing the clock call.
          // If you provide an async clock, you should either provide an initial time, or
          // ensure that the first getTime has resolved before instantiating the exchange.
          // OR, in the future, we have to add a start()/stop() to Exchange.
          initialSequence: opts.getOrElse("initialSequence", (usedDefaultClock ? +new Date() : undefined))
        })
      });

      // Dispatches store signals (e.g., expiry)
      this._expiryDispatcher = new Dispatcher({
        delegate: this,
        prefix: "_onStoreSignal",
        listen: this._outstandingRequests.signalChannel()
      });

      this._compositeSeq = new DelegatingForwardingSequencer({
        delegate: new UnitSequencer(),
        targets: [this._outstandingRequests.sequencer(), this._outstandingRequests.sentrySequencer()]
      })

      // This guy triggers periodic expiry checks in the store
      this._checkExpiry = new Periodic({
        scheduler: this._runtime.scheduler(),
        task: _.bind(function() {
          return this._compositeSeq.advance();
        }, this),
        interval: opts.getOrElse("expiryInterval", 1000)
      });

      this._checkExpiry.start();
    },


    dispose: function() {
      // TODO: Cancel outstanding requests

      this._expiryDispatcher.dispose();

      this._outstandingRequests.clear();

      // TODO: Dispose all the things
      this._checkExpiry.dispose();
    },


    /**
     * Builds a Mailbox for the provided `requesterIdentity`. The
     * `RequesterIdentity` must never have been used for requesting
     * a mailbox previously.
     *
     * We attempt to validate unique mailbox names, but because mailbox names
     * are global and there is no checking between fibers, it's only a best-effort.
     *
     * @param requesterIdentity
     * @returns {Mailbox}
     */
    mailbox: function(requesterIdentity) {
      this._assertUniqueOwner(requesterIdentity);

      var mailbox = new Mailbox({
        exchange:      this,
        ownerIdentity: requesterIdentity
      });

      this._mailboxes = M.assoc(this._mailboxes, requesterIdentity, mailbox);

      this._fiber.registerEntity({
        identity: requesterIdentity,
        delegate: this._mailboxFiberDelegate
      });

      return mailbox;
    },


    send: function(env) {
      env = Options.fromObject(env);

      return this._fiber.send({
        from:  env.getOrError("from"),
        to:    env.getOrError("to"),
        body:  env.getOrError("body"),
        mT:    MSG_SEND,
        msgId: UUID.v4()
      });
    },


    reply: function(env) {
      env = Options.fromObject(env);
      return this._fiber.send({
        from:   env.getOrError("from"),
        to:     env.getOrError("to"),
        body:   env.getOrError("body"),
        mT:     MSG_REPLY,
        msgId:  UUID.v4(),
        rMsgId: env.getOrError("rMsgId")
      });
    },


    sendAndReceive: function(env, opts) {
      env  = Options.fromObject(env);
      opts = Options.fromObject(opts);

      var msgId = UUID.v4(),
          reqId    = opts.getOrError("reqId"),
          deferred = defer(),
          fibEnv   = {
            from:  env.getOrError("from"),
            to:    env.getOrError("to"),
            body:  env.getOrError("body"),
            mT:    MSG_SEND_AND_RECEIVE,
            msgId: msgId
          },
          req      = {
            reqId:    reqId,
            deferred: deferred,
            fibEnv:   fibEnv
          };

      this._reqToMsg = M.assoc(this._reqToMsg, reqId, msgId);

      return this
        ._outstandingRequests
        .put(msgId, req, {ttl: opts.getOrElse("replyTimeout")})
        .bind(this)
        .then(function() {
          return this._fiber.send(fibEnv);
        })
        .then(function() {
          return req.deferred.promise;
        });
    },

    cancelSendAndReceive: Promise.method(function(reqId) {
      var msgId = M.get(this._reqToMsg, reqId);

      if (msgId) {
        Log.debug("Canceling request", reqId, "with msgId", msgId);
        this._reqToMsg = M.dissoc(this._reqToMsg, reqId);

        return Promise
          .bind(this)
          .then(function() {
            return this._outstandingRequests.remove(msgId);
          })
          .then(function(req) {
            if (req) {
              req.deferred.reject(new Promise.CancellationError());
            }
          })
      } else {
        Log.warn("Tried to cancel request, but no oustanding request with that ID found;", reqId);
      }
    }),


    _assertUniqueOwner: function(identity) {
      if (M.get(this._mailboxes, identity)) {
        throw new Error("Mailbox registration requires a unique identity");
      }
    },


    /**
     * Fiber delegate protocol method for a message bound for a Mailbox owned by
     * this exchange.
     *
     * @param env
     * @private
     */
    _receiveMailboxFiberMessage: function(env) {
      this._mailboxDispatcher.dispatch(env);
    },


    _onMbxSend: function(env) {
      var oEnv     = Options.fromObject(env),
          identity = oEnv.getOrElse("to"),
          body     = oEnv.getOrElse("body");

      if (!(identity || body)) {
        Log.info("Exchange received a message with missing envelope information", env);
        return;
      }

      var mbox = M.get(this._mailboxes, identity);
      if (mbox) {
        mbox._receiveOneShot(env);
      }
    },

    // TODO: Should this go along the mailbox ingress channel?
    // Or should it be cb-based?
    _onMbxSendAndReceive: function(env) {
      var oEnv = Options.fromObject(env),
          identity = oEnv.getOrElse("to"),
          body = oEnv.getOrElse("body");

      if (!(identity || body)) {
        Log.info("Exchange received a message with missing envelope information", env);
        return;
      }

      var mbox = M.get(this._mailboxes, identity);
      if (mbox) {
        mbox._receiveRequestReply(env);
      }
    },


    _onMbxReply: function(env) {
      var oEnv     = Options.fromObject(env),
          rMsgId   = oEnv.getOrElse("rMsgId");



      // Don't dispatch vetted replies. Just fulfill the promise
      Promise
        .bind(this)
        .then(function(){
          return this._outstandingRequests.remove(rMsgId);
        })
        .then(function(request) {
          if (request) {
            this._reqToMsg = M.dissoc(this._reqToMsg, request.reqId);
            request.deferred.resolve(env);
          }
        });
    },


    /**
     * Fired when a request in the outstanding requests store is past due.
     */
    _onStoreSignalExpired: function(sig) {
      Log.debug("Expired entry in store", sig);
      Promise
        .bind(this)
        .then(function() {
          return this._outstandingRequests.remove(sig.key);
        })
        .then(function(request) {
          if (request) {
            this._reqToMsg = M.dissoc(this._reqToMsg, request.reqId);
            request.deferred.reject(new Promise.TimeoutError());
          }
        });
    },


    /**
     * Fiber delegate protocol method for a message bound for this Exchange directly.
     *
     * @param env
     * @private
     */
    receiveFiberMessage: function(env) {
      throw new Error("Not implemented");
    }
  });


  var defer = function(){
    var res, rej;
    var p = new Promise(function() {
      res = arguments[0];
      rej = arguments[1];
    });

    return {
      promise: p,
      resolve: res,
      reject: rej
    };
  };

  return Exchange;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("mori"),
  require("../core/logging/logger"),
  require("../core/options"),
  require("../core/uuid"),
  require("../core/sequencer/delegating-forwarding-sequencer"),
  require("../core/sequencer/unit-sequencer"),
  require("./fiber/in-memory-fiber"),
  require("./internals/mailbox"),
  require("../core/dispatcher"),
  require("../storage/signaling-data-store"),
  require("../util/periodic"),
  require("../core/sequencer/clock-sequencer"),
  require("../time/clock/system-clock"),
  require("../runtime")
);

})()
},{"../core/logging/logger":27,"../core/options":6,"../core/uuid":36,"../core/sequencer/delegating-forwarding-sequencer":13,"../core/sequencer/unit-sequencer":10,"./fiber/in-memory-fiber":34,"./internals/mailbox":51,"../core/dispatcher":4,"../storage/signaling-data-store":20,"../util/periodic":3,"../core/sequencer/clock-sequencer":11,"../time/clock/system-clock":22,"../runtime":42,"underscore":56,"bluebird":57,"mori":58}],33:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  M,
  Options,
  UUID,
  StateGuard,
  Logger,
  Dispatcher
) {

  var Courier = function() {
    this.initialize.apply(this, arguments);
  };

  var MSG_REPLY = Courier.MSG_REPLY = "cReply";

  var Log = Logger.create("Courier");

  _.extend(Courier.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);

      this._id         = UUID.v4();
      this._delegate   = opts.getOrError("delegate");
      this._mailbox    = opts.getOrError("mailbox");
      this._stateGuard = new StateGuard(["disposed"]);

      _.bindAll(this, "_onOneShotMessage", "_onRequestReplyMessage", "_defaultContextDelegate");

      this._contextDelegate = opts.getOrElse("contextDelegate", this._defaultContextDelegate);

      this._oneShotDispatcher = new Dispatcher({
        delegate: this._delegate,
        prefix: opts.getOrElse("oneShotPrefix", "onMsg"),
        contextDelegate: this._contextDelegate
      });

      this._requestReplyDispatcher = new Dispatcher({
        delegate: this._delegate,
        prefix: opts.getOrElse("requestReplyPrefix", "onReq"),
        contextDelegate: this._contextDelegate
      });

      this._subs = M.vector(
        this._mailbox.oneShotChannel().subscribe(this._onOneShotMessage),
        this._mailbox.requestReplyChannel().subscribe(this._onRequestReplyMessage)
      );
    },


    id: function() {
      return this._id;
    },

    send: Promise.method(function(to, msg) {
      this._stateGuard.deny("disposed");

      return this._mailbox.send({
        to: to,
        body: msg
      });
    }),

    sendAndReceive: Promise.method(function(to, msg, opts) {
      this._stateGuard.deny("disposed");

      return this._mailbox
        .sendAndReceive({
          to: to,
          body: msg
        }, opts)
        .then(function(res) {

          if (res.body && res.body.mT === MSG_REPLY && res.body.body) {
            // Unwrap the remote message
            if (res.body.body.err) {
              throw new Error(res.body.body.err);
            }
            return res.body.body.res;
          } else {
            // Someone is misbehaving
            Log.warn("Received sendAndReceive reply, but it isn't Courier-compatible", this._mailbox.ownerIdentity(), res);
            return res;
          }
        })
    }),

    dispose: function() {
      if (this._stateGuard.applied("disposed")) {
        return;
      }


      M.each(this._subs, function(sub) {
        sub.dispose();
      });

      this._subs     = null;
      this._mailbox  = null;
      this._delegate = null;

      this._stateGuard.apply("disposed");
    },

    _defaultContextDelegate: function(mTyped) {
      return {
        mailbox: this._mailbox
      };
    },

    _onOneShotMessage: function(msg) {
      this._oneShotDispatcher.dispatch(msg.body, msg);
    },


    _onRequestReplyMessage: function(msg) {
      this._requestReplyDispatcher
        .dispatchAsync(msg.body, msg)
        .bind({
          mbox: this._mailbox,
          err: null,
          result: null
        })
        .then(function(result){
          this.result = result;
        })
        .caught(function(err) {
          this.err = err.message;
        })
        .lastly(function() {
          this.mbox.reply(msg.msgId, {
            to: msg.from,
            body: {
              mT: MSG_REPLY,
              body: {
                err: this.err,
                res: this.result
              }
            }
          });
        });
    }
  });

  return Courier;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("mori"),
  require("../core/options"),
  require("../core/uuid"),
  require("../core/state-guard"),
  require("../core/logging/logger"),
  require("../core/dispatcher")
);

})()
},{"../core/options":6,"../core/uuid":36,"../core/state-guard":8,"../core/logging/logger":27,"../core/dispatcher":4,"underscore":56,"bluebird":57,"mori":58}],36:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

/**
 * Exports a singleton
 */

var mod = function(
  _
) {

  var UUID = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(UUID.prototype, {
    initialize: function() {},
    // See: http://en.wikipedia.org/wiki/Universally_unique_identifier#Version_4_.28random.29
    v4: function() {
      return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
        var r = Math.random() * 16 | 0;
        // 0x3       = 0b00011
        // 0x8       = 0b01000
        // 0x3 | 0x8 = 0b01011
        // r & 0x3   = (0b00000 | 0b00001 | 0b00010 | 0b00011)
        var v = (c == 'x' ? r : (r & 0x3 | 0x8));
        return v.toString(16);
      });
    }
  });

  return new UUID();
};

module.exports = mod(
  require("underscore")
);

})()
},{"underscore":56}],38:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options
) {

  var ComponentRegistry = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(ComponentRegistry.prototype, {
    initialize: function() {
      this._modules = {};
    },


    register: function(opts) {
      opts = Options.fromObject(opts);
      var aliases   = opts.getOrError("as"),
          modObject = opts.getOrError("module");

      if (!_.isArray(aliases)) {
        aliases = [ aliases ];
      }

      _.each(aliases, _.bind(function(alias) {
        this._modules[alias] = modObject;
      }, this));

      return this;
    },

    selfRegister: function(opts) {
      opts = Options.fromObject(opts);

      return this.register({
        as: opts.getOrError("as"),
        module: ComponentRegistry
      });
    },


    registerMany: function(aliasesAry) {
      _.each(aliasesAry, _.bind(function(alias) {
        this.register(alias);
      }, this));
      return this;
    },

    component: function(alias) {
      var m = this._modules[alias];
      if (!m) {
        throw new Error("Invalid alias provided (no such module): `"+alias+"'");
      }
      return m;
    }

  });

  ComponentRegistry.prototype.c = ComponentRegistry.prototype.component;

  return ComponentRegistry;
};

module.exports = mod(
  require("underscore"),
  require("../core/options")
);

})()
},{"../core/options":6,"underscore":56}],52:[function(require,module,exports){
"use strict";

module.exports = require("./web-scheduler");

},{"./web-scheduler":45}],56:[function(require,module,exports){
(function(){//     Underscore.js 1.6.0
//     http://underscorejs.org
//     (c) 2009-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.

(function() {

  // Baseline setup
  // --------------

  // Establish the root object, `window` in the browser, or `exports` on the server.
  var root = this;

  // Save the previous value of the `_` variable.
  var previousUnderscore = root._;

  // Establish the object that gets returned to break out of a loop iteration.
  var breaker = {};

  // Save bytes in the minified (but not gzipped) version:
  var ArrayProto = Array.prototype, ObjProto = Object.prototype, FuncProto = Function.prototype;

  // Create quick reference variables for speed access to core prototypes.
  var
    push             = ArrayProto.push,
    slice            = ArrayProto.slice,
    concat           = ArrayProto.concat,
    toString         = ObjProto.toString,
    hasOwnProperty   = ObjProto.hasOwnProperty;

  // All **ECMAScript 5** native function implementations that we hope to use
  // are declared here.
  var
    nativeForEach      = ArrayProto.forEach,
    nativeMap          = ArrayProto.map,
    nativeReduce       = ArrayProto.reduce,
    nativeReduceRight  = ArrayProto.reduceRight,
    nativeFilter       = ArrayProto.filter,
    nativeEvery        = ArrayProto.every,
    nativeSome         = ArrayProto.some,
    nativeIndexOf      = ArrayProto.indexOf,
    nativeLastIndexOf  = ArrayProto.lastIndexOf,
    nativeIsArray      = Array.isArray,
    nativeKeys         = Object.keys,
    nativeBind         = FuncProto.bind;

  // Create a safe reference to the Underscore object for use below.
  var _ = function(obj) {
    if (obj instanceof _) return obj;
    if (!(this instanceof _)) return new _(obj);
    this._wrapped = obj;
  };

  // Export the Underscore object for **Node.js**, with
  // backwards-compatibility for the old `require()` API. If we're in
  // the browser, add `_` as a global object via a string identifier,
  // for Closure Compiler "advanced" mode.
  if (typeof exports !== 'undefined') {
    if (typeof module !== 'undefined' && module.exports) {
      exports = module.exports = _;
    }
    exports._ = _;
  } else {
    root._ = _;
  }

  // Current version.
  _.VERSION = '1.6.0';

  // Collection Functions
  // --------------------

  // The cornerstone, an `each` implementation, aka `forEach`.
  // Handles objects with the built-in `forEach`, arrays, and raw objects.
  // Delegates to **ECMAScript 5**'s native `forEach` if available.
  var each = _.each = _.forEach = function(obj, iterator, context) {
    if (obj == null) return obj;
    if (nativeForEach && obj.forEach === nativeForEach) {
      obj.forEach(iterator, context);
    } else if (obj.length === +obj.length) {
      for (var i = 0, length = obj.length; i < length; i++) {
        if (iterator.call(context, obj[i], i, obj) === breaker) return;
      }
    } else {
      var keys = _.keys(obj);
      for (var i = 0, length = keys.length; i < length; i++) {
        if (iterator.call(context, obj[keys[i]], keys[i], obj) === breaker) return;
      }
    }
    return obj;
  };

  // Return the results of applying the iterator to each element.
  // Delegates to **ECMAScript 5**'s native `map` if available.
  _.map = _.collect = function(obj, iterator, context) {
    var results = [];
    if (obj == null) return results;
    if (nativeMap && obj.map === nativeMap) return obj.map(iterator, context);
    each(obj, function(value, index, list) {
      results.push(iterator.call(context, value, index, list));
    });
    return results;
  };

  var reduceError = 'Reduce of empty array with no initial value';

  // **Reduce** builds up a single result from a list of values, aka `inject`,
  // or `foldl`. Delegates to **ECMAScript 5**'s native `reduce` if available.
  _.reduce = _.foldl = _.inject = function(obj, iterator, memo, context) {
    var initial = arguments.length > 2;
    if (obj == null) obj = [];
    if (nativeReduce && obj.reduce === nativeReduce) {
      if (context) iterator = _.bind(iterator, context);
      return initial ? obj.reduce(iterator, memo) : obj.reduce(iterator);
    }
    each(obj, function(value, index, list) {
      if (!initial) {
        memo = value;
        initial = true;
      } else {
        memo = iterator.call(context, memo, value, index, list);
      }
    });
    if (!initial) throw new TypeError(reduceError);
    return memo;
  };

  // The right-associative version of reduce, also known as `foldr`.
  // Delegates to **ECMAScript 5**'s native `reduceRight` if available.
  _.reduceRight = _.foldr = function(obj, iterator, memo, context) {
    var initial = arguments.length > 2;
    if (obj == null) obj = [];
    if (nativeReduceRight && obj.reduceRight === nativeReduceRight) {
      if (context) iterator = _.bind(iterator, context);
      return initial ? obj.reduceRight(iterator, memo) : obj.reduceRight(iterator);
    }
    var length = obj.length;
    if (length !== +length) {
      var keys = _.keys(obj);
      length = keys.length;
    }
    each(obj, function(value, index, list) {
      index = keys ? keys[--length] : --length;
      if (!initial) {
        memo = obj[index];
        initial = true;
      } else {
        memo = iterator.call(context, memo, obj[index], index, list);
      }
    });
    if (!initial) throw new TypeError(reduceError);
    return memo;
  };

  // Return the first value which passes a truth test. Aliased as `detect`.
  _.find = _.detect = function(obj, predicate, context) {
    var result;
    any(obj, function(value, index, list) {
      if (predicate.call(context, value, index, list)) {
        result = value;
        return true;
      }
    });
    return result;
  };

  // Return all the elements that pass a truth test.
  // Delegates to **ECMAScript 5**'s native `filter` if available.
  // Aliased as `select`.
  _.filter = _.select = function(obj, predicate, context) {
    var results = [];
    if (obj == null) return results;
    if (nativeFilter && obj.filter === nativeFilter) return obj.filter(predicate, context);
    each(obj, function(value, index, list) {
      if (predicate.call(context, value, index, list)) results.push(value);
    });
    return results;
  };

  // Return all the elements for which a truth test fails.
  _.reject = function(obj, predicate, context) {
    return _.filter(obj, function(value, index, list) {
      return !predicate.call(context, value, index, list);
    }, context);
  };

  // Determine whether all of the elements match a truth test.
  // Delegates to **ECMAScript 5**'s native `every` if available.
  // Aliased as `all`.
  _.every = _.all = function(obj, predicate, context) {
    predicate || (predicate = _.identity);
    var result = true;
    if (obj == null) return result;
    if (nativeEvery && obj.every === nativeEvery) return obj.every(predicate, context);
    each(obj, function(value, index, list) {
      if (!(result = result && predicate.call(context, value, index, list))) return breaker;
    });
    return !!result;
  };

  // Determine if at least one element in the object matches a truth test.
  // Delegates to **ECMAScript 5**'s native `some` if available.
  // Aliased as `any`.
  var any = _.some = _.any = function(obj, predicate, context) {
    predicate || (predicate = _.identity);
    var result = false;
    if (obj == null) return result;
    if (nativeSome && obj.some === nativeSome) return obj.some(predicate, context);
    each(obj, function(value, index, list) {
      if (result || (result = predicate.call(context, value, index, list))) return breaker;
    });
    return !!result;
  };

  // Determine if the array or object contains a given value (using `===`).
  // Aliased as `include`.
  _.contains = _.include = function(obj, target) {
    if (obj == null) return false;
    if (nativeIndexOf && obj.indexOf === nativeIndexOf) return obj.indexOf(target) != -1;
    return any(obj, function(value) {
      return value === target;
    });
  };

  // Invoke a method (with arguments) on every item in a collection.
  _.invoke = function(obj, method) {
    var args = slice.call(arguments, 2);
    var isFunc = _.isFunction(method);
    return _.map(obj, function(value) {
      return (isFunc ? method : value[method]).apply(value, args);
    });
  };

  // Convenience version of a common use case of `map`: fetching a property.
  _.pluck = function(obj, key) {
    return _.map(obj, _.property(key));
  };

  // Convenience version of a common use case of `filter`: selecting only objects
  // containing specific `key:value` pairs.
  _.where = function(obj, attrs) {
    return _.filter(obj, _.matches(attrs));
  };

  // Convenience version of a common use case of `find`: getting the first object
  // containing specific `key:value` pairs.
  _.findWhere = function(obj, attrs) {
    return _.find(obj, _.matches(attrs));
  };

  // Return the maximum element or (element-based computation).
  // Can't optimize arrays of integers longer than 65,535 elements.
  // See [WebKit Bug 80797](https://bugs.webkit.org/show_bug.cgi?id=80797)
  _.max = function(obj, iterator, context) {
    if (!iterator && _.isArray(obj) && obj[0] === +obj[0] && obj.length < 65535) {
      return Math.max.apply(Math, obj);
    }
    var result = -Infinity, lastComputed = -Infinity;
    each(obj, function(value, index, list) {
      var computed = iterator ? iterator.call(context, value, index, list) : value;
      if (computed > lastComputed) {
        result = value;
        lastComputed = computed;
      }
    });
    return result;
  };

  // Return the minimum element (or element-based computation).
  _.min = function(obj, iterator, context) {
    if (!iterator && _.isArray(obj) && obj[0] === +obj[0] && obj.length < 65535) {
      return Math.min.apply(Math, obj);
    }
    var result = Infinity, lastComputed = Infinity;
    each(obj, function(value, index, list) {
      var computed = iterator ? iterator.call(context, value, index, list) : value;
      if (computed < lastComputed) {
        result = value;
        lastComputed = computed;
      }
    });
    return result;
  };

  // Shuffle an array, using the modern version of the
  // [Fisher-Yates shuffle](http://en.wikipedia.org/wiki/FisherYates_shuffle).
  _.shuffle = function(obj) {
    var rand;
    var index = 0;
    var shuffled = [];
    each(obj, function(value) {
      rand = _.random(index++);
      shuffled[index - 1] = shuffled[rand];
      shuffled[rand] = value;
    });
    return shuffled;
  };

  // Sample **n** random values from a collection.
  // If **n** is not specified, returns a single random element.
  // The internal `guard` argument allows it to work with `map`.
  _.sample = function(obj, n, guard) {
    if (n == null || guard) {
      if (obj.length !== +obj.length) obj = _.values(obj);
      return obj[_.random(obj.length - 1)];
    }
    return _.shuffle(obj).slice(0, Math.max(0, n));
  };

  // An internal function to generate lookup iterators.
  var lookupIterator = function(value) {
    if (value == null) return _.identity;
    if (_.isFunction(value)) return value;
    return _.property(value);
  };

  // Sort the object's values by a criterion produced by an iterator.
  _.sortBy = function(obj, iterator, context) {
    iterator = lookupIterator(iterator);
    return _.pluck(_.map(obj, function(value, index, list) {
      return {
        value: value,
        index: index,
        criteria: iterator.call(context, value, index, list)
      };
    }).sort(function(left, right) {
      var a = left.criteria;
      var b = right.criteria;
      if (a !== b) {
        if (a > b || a === void 0) return 1;
        if (a < b || b === void 0) return -1;
      }
      return left.index - right.index;
    }), 'value');
  };

  // An internal function used for aggregate "group by" operations.
  var group = function(behavior) {
    return function(obj, iterator, context) {
      var result = {};
      iterator = lookupIterator(iterator);
      each(obj, function(value, index) {
        var key = iterator.call(context, value, index, obj);
        behavior(result, key, value);
      });
      return result;
    };
  };

  // Groups the object's values by a criterion. Pass either a string attribute
  // to group by, or a function that returns the criterion.
  _.groupBy = group(function(result, key, value) {
    _.has(result, key) ? result[key].push(value) : result[key] = [value];
  });

  // Indexes the object's values by a criterion, similar to `groupBy`, but for
  // when you know that your index values will be unique.
  _.indexBy = group(function(result, key, value) {
    result[key] = value;
  });

  // Counts instances of an object that group by a certain criterion. Pass
  // either a string attribute to count by, or a function that returns the
  // criterion.
  _.countBy = group(function(result, key) {
    _.has(result, key) ? result[key]++ : result[key] = 1;
  });

  // Use a comparator function to figure out the smallest index at which
  // an object should be inserted so as to maintain order. Uses binary search.
  _.sortedIndex = function(array, obj, iterator, context) {
    iterator = lookupIterator(iterator);
    var value = iterator.call(context, obj);
    var low = 0, high = array.length;
    while (low < high) {
      var mid = (low + high) >>> 1;
      iterator.call(context, array[mid]) < value ? low = mid + 1 : high = mid;
    }
    return low;
  };

  // Safely create a real, live array from anything iterable.
  _.toArray = function(obj) {
    if (!obj) return [];
    if (_.isArray(obj)) return slice.call(obj);
    if (obj.length === +obj.length) return _.map(obj, _.identity);
    return _.values(obj);
  };

  // Return the number of elements in an object.
  _.size = function(obj) {
    if (obj == null) return 0;
    return (obj.length === +obj.length) ? obj.length : _.keys(obj).length;
  };

  // Array Functions
  // ---------------

  // Get the first element of an array. Passing **n** will return the first N
  // values in the array. Aliased as `head` and `take`. The **guard** check
  // allows it to work with `_.map`.
  _.first = _.head = _.take = function(array, n, guard) {
    if (array == null) return void 0;
    if ((n == null) || guard) return array[0];
    if (n < 0) return [];
    return slice.call(array, 0, n);
  };

  // Returns everything but the last entry of the array. Especially useful on
  // the arguments object. Passing **n** will return all the values in
  // the array, excluding the last N. The **guard** check allows it to work with
  // `_.map`.
  _.initial = function(array, n, guard) {
    return slice.call(array, 0, array.length - ((n == null) || guard ? 1 : n));
  };

  // Get the last element of an array. Passing **n** will return the last N
  // values in the array. The **guard** check allows it to work with `_.map`.
  _.last = function(array, n, guard) {
    if (array == null) return void 0;
    if ((n == null) || guard) return array[array.length - 1];
    return slice.call(array, Math.max(array.length - n, 0));
  };

  // Returns everything but the first entry of the array. Aliased as `tail` and `drop`.
  // Especially useful on the arguments object. Passing an **n** will return
  // the rest N values in the array. The **guard**
  // check allows it to work with `_.map`.
  _.rest = _.tail = _.drop = function(array, n, guard) {
    return slice.call(array, (n == null) || guard ? 1 : n);
  };

  // Trim out all falsy values from an array.
  _.compact = function(array) {
    return _.filter(array, _.identity);
  };

  // Internal implementation of a recursive `flatten` function.
  var flatten = function(input, shallow, output) {
    if (shallow && _.every(input, _.isArray)) {
      return concat.apply(output, input);
    }
    each(input, function(value) {
      if (_.isArray(value) || _.isArguments(value)) {
        shallow ? push.apply(output, value) : flatten(value, shallow, output);
      } else {
        output.push(value);
      }
    });
    return output;
  };

  // Flatten out an array, either recursively (by default), or just one level.
  _.flatten = function(array, shallow) {
    return flatten(array, shallow, []);
  };

  // Return a version of the array that does not contain the specified value(s).
  _.without = function(array) {
    return _.difference(array, slice.call(arguments, 1));
  };

  // Split an array into two arrays: one whose elements all satisfy the given
  // predicate, and one whose elements all do not satisfy the predicate.
  _.partition = function(array, predicate) {
    var pass = [], fail = [];
    each(array, function(elem) {
      (predicate(elem) ? pass : fail).push(elem);
    });
    return [pass, fail];
  };

  // Produce a duplicate-free version of the array. If the array has already
  // been sorted, you have the option of using a faster algorithm.
  // Aliased as `unique`.
  _.uniq = _.unique = function(array, isSorted, iterator, context) {
    if (_.isFunction(isSorted)) {
      context = iterator;
      iterator = isSorted;
      isSorted = false;
    }
    var initial = iterator ? _.map(array, iterator, context) : array;
    var results = [];
    var seen = [];
    each(initial, function(value, index) {
      if (isSorted ? (!index || seen[seen.length - 1] !== value) : !_.contains(seen, value)) {
        seen.push(value);
        results.push(array[index]);
      }
    });
    return results;
  };

  // Produce an array that contains the union: each distinct element from all of
  // the passed-in arrays.
  _.union = function() {
    return _.uniq(_.flatten(arguments, true));
  };

  // Produce an array that contains every item shared between all the
  // passed-in arrays.
  _.intersection = function(array) {
    var rest = slice.call(arguments, 1);
    return _.filter(_.uniq(array), function(item) {
      return _.every(rest, function(other) {
        return _.contains(other, item);
      });
    });
  };

  // Take the difference between one array and a number of other arrays.
  // Only the elements present in just the first array will remain.
  _.difference = function(array) {
    var rest = concat.apply(ArrayProto, slice.call(arguments, 1));
    return _.filter(array, function(value){ return !_.contains(rest, value); });
  };

  // Zip together multiple lists into a single array -- elements that share
  // an index go together.
  _.zip = function() {
    var length = _.max(_.pluck(arguments, 'length').concat(0));
    var results = new Array(length);
    for (var i = 0; i < length; i++) {
      results[i] = _.pluck(arguments, '' + i);
    }
    return results;
  };

  // Converts lists into objects. Pass either a single array of `[key, value]`
  // pairs, or two parallel arrays of the same length -- one of keys, and one of
  // the corresponding values.
  _.object = function(list, values) {
    if (list == null) return {};
    var result = {};
    for (var i = 0, length = list.length; i < length; i++) {
      if (values) {
        result[list[i]] = values[i];
      } else {
        result[list[i][0]] = list[i][1];
      }
    }
    return result;
  };

  // If the browser doesn't supply us with indexOf (I'm looking at you, **MSIE**),
  // we need this function. Return the position of the first occurrence of an
  // item in an array, or -1 if the item is not included in the array.
  // Delegates to **ECMAScript 5**'s native `indexOf` if available.
  // If the array is large and already in sort order, pass `true`
  // for **isSorted** to use binary search.
  _.indexOf = function(array, item, isSorted) {
    if (array == null) return -1;
    var i = 0, length = array.length;
    if (isSorted) {
      if (typeof isSorted == 'number') {
        i = (isSorted < 0 ? Math.max(0, length + isSorted) : isSorted);
      } else {
        i = _.sortedIndex(array, item);
        return array[i] === item ? i : -1;
      }
    }
    if (nativeIndexOf && array.indexOf === nativeIndexOf) return array.indexOf(item, isSorted);
    for (; i < length; i++) if (array[i] === item) return i;
    return -1;
  };

  // Delegates to **ECMAScript 5**'s native `lastIndexOf` if available.
  _.lastIndexOf = function(array, item, from) {
    if (array == null) return -1;
    var hasIndex = from != null;
    if (nativeLastIndexOf && array.lastIndexOf === nativeLastIndexOf) {
      return hasIndex ? array.lastIndexOf(item, from) : array.lastIndexOf(item);
    }
    var i = (hasIndex ? from : array.length);
    while (i--) if (array[i] === item) return i;
    return -1;
  };

  // Generate an integer Array containing an arithmetic progression. A port of
  // the native Python `range()` function. See
  // [the Python documentation](http://docs.python.org/library/functions.html#range).
  _.range = function(start, stop, step) {
    if (arguments.length <= 1) {
      stop = start || 0;
      start = 0;
    }
    step = arguments[2] || 1;

    var length = Math.max(Math.ceil((stop - start) / step), 0);
    var idx = 0;
    var range = new Array(length);

    while(idx < length) {
      range[idx++] = start;
      start += step;
    }

    return range;
  };

  // Function (ahem) Functions
  // ------------------

  // Reusable constructor function for prototype setting.
  var ctor = function(){};

  // Create a function bound to a given object (assigning `this`, and arguments,
  // optionally). Delegates to **ECMAScript 5**'s native `Function.bind` if
  // available.
  _.bind = function(func, context) {
    var args, bound;
    if (nativeBind && func.bind === nativeBind) return nativeBind.apply(func, slice.call(arguments, 1));
    if (!_.isFunction(func)) throw new TypeError;
    args = slice.call(arguments, 2);
    return bound = function() {
      if (!(this instanceof bound)) return func.apply(context, args.concat(slice.call(arguments)));
      ctor.prototype = func.prototype;
      var self = new ctor;
      ctor.prototype = null;
      var result = func.apply(self, args.concat(slice.call(arguments)));
      if (Object(result) === result) return result;
      return self;
    };
  };

  // Partially apply a function by creating a version that has had some of its
  // arguments pre-filled, without changing its dynamic `this` context. _ acts
  // as a placeholder, allowing any combination of arguments to be pre-filled.
  _.partial = function(func) {
    var boundArgs = slice.call(arguments, 1);
    return function() {
      var position = 0;
      var args = boundArgs.slice();
      for (var i = 0, length = args.length; i < length; i++) {
        if (args[i] === _) args[i] = arguments[position++];
      }
      while (position < arguments.length) args.push(arguments[position++]);
      return func.apply(this, args);
    };
  };

  // Bind a number of an object's methods to that object. Remaining arguments
  // are the method names to be bound. Useful for ensuring that all callbacks
  // defined on an object belong to it.
  _.bindAll = function(obj) {
    var funcs = slice.call(arguments, 1);
    if (funcs.length === 0) throw new Error('bindAll must be passed function names');
    each(funcs, function(f) { obj[f] = _.bind(obj[f], obj); });
    return obj;
  };

  // Memoize an expensive function by storing its results.
  _.memoize = function(func, hasher) {
    var memo = {};
    hasher || (hasher = _.identity);
    return function() {
      var key = hasher.apply(this, arguments);
      return _.has(memo, key) ? memo[key] : (memo[key] = func.apply(this, arguments));
    };
  };

  // Delays a function for the given number of milliseconds, and then calls
  // it with the arguments supplied.
  _.delay = function(func, wait) {
    var args = slice.call(arguments, 2);
    return setTimeout(function(){ return func.apply(null, args); }, wait);
  };

  // Defers a function, scheduling it to run after the current call stack has
  // cleared.
  _.defer = function(func) {
    return _.delay.apply(_, [func, 1].concat(slice.call(arguments, 1)));
  };

  // Returns a function, that, when invoked, will only be triggered at most once
  // during a given window of time. Normally, the throttled function will run
  // as much as it can, without ever going more than once per `wait` duration;
  // but if you'd like to disable the execution on the leading edge, pass
  // `{leading: false}`. To disable execution on the trailing edge, ditto.
  _.throttle = function(func, wait, options) {
    var context, args, result;
    var timeout = null;
    var previous = 0;
    options || (options = {});
    var later = function() {
      previous = options.leading === false ? 0 : _.now();
      timeout = null;
      result = func.apply(context, args);
      context = args = null;
    };
    return function() {
      var now = _.now();
      if (!previous && options.leading === false) previous = now;
      var remaining = wait - (now - previous);
      context = this;
      args = arguments;
      if (remaining <= 0) {
        clearTimeout(timeout);
        timeout = null;
        previous = now;
        result = func.apply(context, args);
        context = args = null;
      } else if (!timeout && options.trailing !== false) {
        timeout = setTimeout(later, remaining);
      }
      return result;
    };
  };

  // Returns a function, that, as long as it continues to be invoked, will not
  // be triggered. The function will be called after it stops being called for
  // N milliseconds. If `immediate` is passed, trigger the function on the
  // leading edge, instead of the trailing.
  _.debounce = function(func, wait, immediate) {
    var timeout, args, context, timestamp, result;

    var later = function() {
      var last = _.now() - timestamp;
      if (last < wait) {
        timeout = setTimeout(later, wait - last);
      } else {
        timeout = null;
        if (!immediate) {
          result = func.apply(context, args);
          context = args = null;
        }
      }
    };

    return function() {
      context = this;
      args = arguments;
      timestamp = _.now();
      var callNow = immediate && !timeout;
      if (!timeout) {
        timeout = setTimeout(later, wait);
      }
      if (callNow) {
        result = func.apply(context, args);
        context = args = null;
      }

      return result;
    };
  };

  // Returns a function that will be executed at most one time, no matter how
  // often you call it. Useful for lazy initialization.
  _.once = function(func) {
    var ran = false, memo;
    return function() {
      if (ran) return memo;
      ran = true;
      memo = func.apply(this, arguments);
      func = null;
      return memo;
    };
  };

  // Returns the first function passed as an argument to the second,
  // allowing you to adjust arguments, run code before and after, and
  // conditionally execute the original function.
  _.wrap = function(func, wrapper) {
    return _.partial(wrapper, func);
  };

  // Returns a function that is the composition of a list of functions, each
  // consuming the return value of the function that follows.
  _.compose = function() {
    var funcs = arguments;
    return function() {
      var args = arguments;
      for (var i = funcs.length - 1; i >= 0; i--) {
        args = [funcs[i].apply(this, args)];
      }
      return args[0];
    };
  };

  // Returns a function that will only be executed after being called N times.
  _.after = function(times, func) {
    return function() {
      if (--times < 1) {
        return func.apply(this, arguments);
      }
    };
  };

  // Object Functions
  // ----------------

  // Retrieve the names of an object's properties.
  // Delegates to **ECMAScript 5**'s native `Object.keys`
  _.keys = function(obj) {
    if (!_.isObject(obj)) return [];
    if (nativeKeys) return nativeKeys(obj);
    var keys = [];
    for (var key in obj) if (_.has(obj, key)) keys.push(key);
    return keys;
  };

  // Retrieve the values of an object's properties.
  _.values = function(obj) {
    var keys = _.keys(obj);
    var length = keys.length;
    var values = new Array(length);
    for (var i = 0; i < length; i++) {
      values[i] = obj[keys[i]];
    }
    return values;
  };

  // Convert an object into a list of `[key, value]` pairs.
  _.pairs = function(obj) {
    var keys = _.keys(obj);
    var length = keys.length;
    var pairs = new Array(length);
    for (var i = 0; i < length; i++) {
      pairs[i] = [keys[i], obj[keys[i]]];
    }
    return pairs;
  };

  // Invert the keys and values of an object. The values must be serializable.
  _.invert = function(obj) {
    var result = {};
    var keys = _.keys(obj);
    for (var i = 0, length = keys.length; i < length; i++) {
      result[obj[keys[i]]] = keys[i];
    }
    return result;
  };

  // Return a sorted list of the function names available on the object.
  // Aliased as `methods`
  _.functions = _.methods = function(obj) {
    var names = [];
    for (var key in obj) {
      if (_.isFunction(obj[key])) names.push(key);
    }
    return names.sort();
  };

  // Extend a given object with all the properties in passed-in object(s).
  _.extend = function(obj) {
    each(slice.call(arguments, 1), function(source) {
      if (source) {
        for (var prop in source) {
          obj[prop] = source[prop];
        }
      }
    });
    return obj;
  };

  // Return a copy of the object only containing the whitelisted properties.
  _.pick = function(obj) {
    var copy = {};
    var keys = concat.apply(ArrayProto, slice.call(arguments, 1));
    each(keys, function(key) {
      if (key in obj) copy[key] = obj[key];
    });
    return copy;
  };

   // Return a copy of the object without the blacklisted properties.
  _.omit = function(obj) {
    var copy = {};
    var keys = concat.apply(ArrayProto, slice.call(arguments, 1));
    for (var key in obj) {
      if (!_.contains(keys, key)) copy[key] = obj[key];
    }
    return copy;
  };

  // Fill in a given object with default properties.
  _.defaults = function(obj) {
    each(slice.call(arguments, 1), function(source) {
      if (source) {
        for (var prop in source) {
          if (obj[prop] === void 0) obj[prop] = source[prop];
        }
      }
    });
    return obj;
  };

  // Create a (shallow-cloned) duplicate of an object.
  _.clone = function(obj) {
    if (!_.isObject(obj)) return obj;
    return _.isArray(obj) ? obj.slice() : _.extend({}, obj);
  };

  // Invokes interceptor with the obj, and then returns obj.
  // The primary purpose of this method is to "tap into" a method chain, in
  // order to perform operations on intermediate results within the chain.
  _.tap = function(obj, interceptor) {
    interceptor(obj);
    return obj;
  };

  // Internal recursive comparison function for `isEqual`.
  var eq = function(a, b, aStack, bStack) {
    // Identical objects are equal. `0 === -0`, but they aren't identical.
    // See the [Harmony `egal` proposal](http://wiki.ecmascript.org/doku.php?id=harmony:egal).
    if (a === b) return a !== 0 || 1 / a == 1 / b;
    // A strict comparison is necessary because `null == undefined`.
    if (a == null || b == null) return a === b;
    // Unwrap any wrapped objects.
    if (a instanceof _) a = a._wrapped;
    if (b instanceof _) b = b._wrapped;
    // Compare `[[Class]]` names.
    var className = toString.call(a);
    if (className != toString.call(b)) return false;
    switch (className) {
      // Strings, numbers, dates, and booleans are compared by value.
      case '[object String]':
        // Primitives and their corresponding object wrappers are equivalent; thus, `"5"` is
        // equivalent to `new String("5")`.
        return a == String(b);
      case '[object Number]':
        // `NaN`s are equivalent, but non-reflexive. An `egal` comparison is performed for
        // other numeric values.
        return a != +a ? b != +b : (a == 0 ? 1 / a == 1 / b : a == +b);
      case '[object Date]':
      case '[object Boolean]':
        // Coerce dates and booleans to numeric primitive values. Dates are compared by their
        // millisecond representations. Note that invalid dates with millisecond representations
        // of `NaN` are not equivalent.
        return +a == +b;
      // RegExps are compared by their source patterns and flags.
      case '[object RegExp]':
        return a.source == b.source &&
               a.global == b.global &&
               a.multiline == b.multiline &&
               a.ignoreCase == b.ignoreCase;
    }
    if (typeof a != 'object' || typeof b != 'object') return false;
    // Assume equality for cyclic structures. The algorithm for detecting cyclic
    // structures is adapted from ES 5.1 section 15.12.3, abstract operation `JO`.
    var length = aStack.length;
    while (length--) {
      // Linear search. Performance is inversely proportional to the number of
      // unique nested structures.
      if (aStack[length] == a) return bStack[length] == b;
    }
    // Objects with different constructors are not equivalent, but `Object`s
    // from different frames are.
    var aCtor = a.constructor, bCtor = b.constructor;
    if (aCtor !== bCtor && !(_.isFunction(aCtor) && (aCtor instanceof aCtor) &&
                             _.isFunction(bCtor) && (bCtor instanceof bCtor))
                        && ('constructor' in a && 'constructor' in b)) {
      return false;
    }
    // Add the first object to the stack of traversed objects.
    aStack.push(a);
    bStack.push(b);
    var size = 0, result = true;
    // Recursively compare objects and arrays.
    if (className == '[object Array]') {
      // Compare array lengths to determine if a deep comparison is necessary.
      size = a.length;
      result = size == b.length;
      if (result) {
        // Deep compare the contents, ignoring non-numeric properties.
        while (size--) {
          if (!(result = eq(a[size], b[size], aStack, bStack))) break;
        }
      }
    } else {
      // Deep compare objects.
      for (var key in a) {
        if (_.has(a, key)) {
          // Count the expected number of properties.
          size++;
          // Deep compare each member.
          if (!(result = _.has(b, key) && eq(a[key], b[key], aStack, bStack))) break;
        }
      }
      // Ensure that both objects contain the same number of properties.
      if (result) {
        for (key in b) {
          if (_.has(b, key) && !(size--)) break;
        }
        result = !size;
      }
    }
    // Remove the first object from the stack of traversed objects.
    aStack.pop();
    bStack.pop();
    return result;
  };

  // Perform a deep comparison to check if two objects are equal.
  _.isEqual = function(a, b) {
    return eq(a, b, [], []);
  };

  // Is a given array, string, or object empty?
  // An "empty" object has no enumerable own-properties.
  _.isEmpty = function(obj) {
    if (obj == null) return true;
    if (_.isArray(obj) || _.isString(obj)) return obj.length === 0;
    for (var key in obj) if (_.has(obj, key)) return false;
    return true;
  };

  // Is a given value a DOM element?
  _.isElement = function(obj) {
    return !!(obj && obj.nodeType === 1);
  };

  // Is a given value an array?
  // Delegates to ECMA5's native Array.isArray
  _.isArray = nativeIsArray || function(obj) {
    return toString.call(obj) == '[object Array]';
  };

  // Is a given variable an object?
  _.isObject = function(obj) {
    return obj === Object(obj);
  };

  // Add some isType methods: isArguments, isFunction, isString, isNumber, isDate, isRegExp.
  each(['Arguments', 'Function', 'String', 'Number', 'Date', 'RegExp'], function(name) {
    _['is' + name] = function(obj) {
      return toString.call(obj) == '[object ' + name + ']';
    };
  });

  // Define a fallback version of the method in browsers (ahem, IE), where
  // there isn't any inspectable "Arguments" type.
  if (!_.isArguments(arguments)) {
    _.isArguments = function(obj) {
      return !!(obj && _.has(obj, 'callee'));
    };
  }

  // Optimize `isFunction` if appropriate.
  if (typeof (/./) !== 'function') {
    _.isFunction = function(obj) {
      return typeof obj === 'function';
    };
  }

  // Is a given object a finite number?
  _.isFinite = function(obj) {
    return isFinite(obj) && !isNaN(parseFloat(obj));
  };

  // Is the given value `NaN`? (NaN is the only number which does not equal itself).
  _.isNaN = function(obj) {
    return _.isNumber(obj) && obj != +obj;
  };

  // Is a given value a boolean?
  _.isBoolean = function(obj) {
    return obj === true || obj === false || toString.call(obj) == '[object Boolean]';
  };

  // Is a given value equal to null?
  _.isNull = function(obj) {
    return obj === null;
  };

  // Is a given variable undefined?
  _.isUndefined = function(obj) {
    return obj === void 0;
  };

  // Shortcut function for checking if an object has a given property directly
  // on itself (in other words, not on a prototype).
  _.has = function(obj, key) {
    return hasOwnProperty.call(obj, key);
  };

  // Utility Functions
  // -----------------

  // Run Underscore.js in *noConflict* mode, returning the `_` variable to its
  // previous owner. Returns a reference to the Underscore object.
  _.noConflict = function() {
    root._ = previousUnderscore;
    return this;
  };

  // Keep the identity function around for default iterators.
  _.identity = function(value) {
    return value;
  };

  _.constant = function(value) {
    return function () {
      return value;
    };
  };

  _.property = function(key) {
    return function(obj) {
      return obj[key];
    };
  };

  // Returns a predicate for checking whether an object has a given set of `key:value` pairs.
  _.matches = function(attrs) {
    return function(obj) {
      if (obj === attrs) return true; //avoid comparing an object to itself.
      for (var key in attrs) {
        if (attrs[key] !== obj[key])
          return false;
      }
      return true;
    }
  };

  // Run a function **n** times.
  _.times = function(n, iterator, context) {
    var accum = Array(Math.max(0, n));
    for (var i = 0; i < n; i++) accum[i] = iterator.call(context, i);
    return accum;
  };

  // Return a random integer between min and max (inclusive).
  _.random = function(min, max) {
    if (max == null) {
      max = min;
      min = 0;
    }
    return min + Math.floor(Math.random() * (max - min + 1));
  };

  // A (possibly faster) way to get the current timestamp as an integer.
  _.now = Date.now || function() { return new Date().getTime(); };

  // List of HTML entities for escaping.
  var entityMap = {
    escape: {
      '&': '&amp;',
      '<': '&lt;',
      '>': '&gt;',
      '"': '&quot;',
      "'": '&#x27;'
    }
  };
  entityMap.unescape = _.invert(entityMap.escape);

  // Regexes containing the keys and values listed immediately above.
  var entityRegexes = {
    escape:   new RegExp('[' + _.keys(entityMap.escape).join('') + ']', 'g'),
    unescape: new RegExp('(' + _.keys(entityMap.unescape).join('|') + ')', 'g')
  };

  // Functions for escaping and unescaping strings to/from HTML interpolation.
  _.each(['escape', 'unescape'], function(method) {
    _[method] = function(string) {
      if (string == null) return '';
      return ('' + string).replace(entityRegexes[method], function(match) {
        return entityMap[method][match];
      });
    };
  });

  // If the value of the named `property` is a function then invoke it with the
  // `object` as context; otherwise, return it.
  _.result = function(object, property) {
    if (object == null) return void 0;
    var value = object[property];
    return _.isFunction(value) ? value.call(object) : value;
  };

  // Add your own custom functions to the Underscore object.
  _.mixin = function(obj) {
    each(_.functions(obj), function(name) {
      var func = _[name] = obj[name];
      _.prototype[name] = function() {
        var args = [this._wrapped];
        push.apply(args, arguments);
        return result.call(this, func.apply(_, args));
      };
    });
  };

  // Generate a unique integer id (unique within the entire client session).
  // Useful for temporary DOM ids.
  var idCounter = 0;
  _.uniqueId = function(prefix) {
    var id = ++idCounter + '';
    return prefix ? prefix + id : id;
  };

  // By default, Underscore uses ERB-style template delimiters, change the
  // following template settings to use alternative delimiters.
  _.templateSettings = {
    evaluate    : /<%([\s\S]+?)%>/g,
    interpolate : /<%=([\s\S]+?)%>/g,
    escape      : /<%-([\s\S]+?)%>/g
  };

  // When customizing `templateSettings`, if you don't want to define an
  // interpolation, evaluation or escaping regex, we need one that is
  // guaranteed not to match.
  var noMatch = /(.)^/;

  // Certain characters need to be escaped so that they can be put into a
  // string literal.
  var escapes = {
    "'":      "'",
    '\\':     '\\',
    '\r':     'r',
    '\n':     'n',
    '\t':     't',
    '\u2028': 'u2028',
    '\u2029': 'u2029'
  };

  var escaper = /\\|'|\r|\n|\t|\u2028|\u2029/g;

  // JavaScript micro-templating, similar to John Resig's implementation.
  // Underscore templating handles arbitrary delimiters, preserves whitespace,
  // and correctly escapes quotes within interpolated code.
  _.template = function(text, data, settings) {
    var render;
    settings = _.defaults({}, settings, _.templateSettings);

    // Combine delimiters into one regular expression via alternation.
    var matcher = new RegExp([
      (settings.escape || noMatch).source,
      (settings.interpolate || noMatch).source,
      (settings.evaluate || noMatch).source
    ].join('|') + '|$', 'g');

    // Compile the template source, escaping string literals appropriately.
    var index = 0;
    var source = "__p+='";
    text.replace(matcher, function(match, escape, interpolate, evaluate, offset) {
      source += text.slice(index, offset)
        .replace(escaper, function(match) { return '\\' + escapes[match]; });

      if (escape) {
        source += "'+\n((__t=(" + escape + "))==null?'':_.escape(__t))+\n'";
      }
      if (interpolate) {
        source += "'+\n((__t=(" + interpolate + "))==null?'':__t)+\n'";
      }
      if (evaluate) {
        source += "';\n" + evaluate + "\n__p+='";
      }
      index = offset + match.length;
      return match;
    });
    source += "';\n";

    // If a variable is not specified, place data values in local scope.
    if (!settings.variable) source = 'with(obj||{}){\n' + source + '}\n';

    source = "var __t,__p='',__j=Array.prototype.join," +
      "print=function(){__p+=__j.call(arguments,'');};\n" +
      source + "return __p;\n";

    try {
      render = new Function(settings.variable || 'obj', '_', source);
    } catch (e) {
      e.source = source;
      throw e;
    }

    if (data) return render(data, _);
    var template = function(data) {
      return render.call(this, data, _);
    };

    // Provide the compiled function source as a convenience for precompilation.
    template.source = 'function(' + (settings.variable || 'obj') + '){\n' + source + '}';

    return template;
  };

  // Add a "chain" function, which will delegate to the wrapper.
  _.chain = function(obj) {
    return _(obj).chain();
  };

  // OOP
  // ---------------
  // If Underscore is called as a function, it returns a wrapped object that
  // can be used OO-style. This wrapper holds altered versions of all the
  // underscore functions. Wrapped objects may be chained.

  // Helper function to continue chaining intermediate results.
  var result = function(obj) {
    return this._chain ? _(obj).chain() : obj;
  };

  // Add all of the Underscore functions to the wrapper object.
  _.mixin(_);

  // Add all mutator Array functions to the wrapper.
  each(['pop', 'push', 'reverse', 'shift', 'sort', 'splice', 'unshift'], function(name) {
    var method = ArrayProto[name];
    _.prototype[name] = function() {
      var obj = this._wrapped;
      method.apply(obj, arguments);
      if ((name == 'shift' || name == 'splice') && obj.length === 0) delete obj[0];
      return result.call(this, obj);
    };
  });

  // Add all accessor Array functions to the wrapper.
  each(['concat', 'join', 'slice'], function(name) {
    var method = ArrayProto[name];
    _.prototype[name] = function() {
      return result.call(this, method.apply(this._wrapped, arguments));
    };
  });

  _.extend(_.prototype, {

    // Start chaining a wrapped Underscore object.
    chain: function() {
      this._chain = true;
      return this;
    },

    // Extracts the result from a wrapped and chained object.
    value: function() {
      return this._wrapped;
    }

  });

  // AMD registration happens at the end for compatibility with AMD loaders
  // that may not enforce next-turn semantics on modules. Even though general
  // practice for AMD registration is to be anonymous, underscore registers
  // as a named module because, like jQuery, it is a base library that is
  // popular enough to be bundled in a third party lib, but not be part of
  // an AMD load request. Those cases could generate an error when an
  // anonymous define() is called outside of a loader request.
  if (typeof define === 'function' && define.amd) {
    define('underscore', [], function() {
      return _;
    });
  }
}).call(this);

})()
},{}],58:[function(require,module,exports){
(function(definition){if(typeof exports==="object"){module.exports=definition();}else if(typeof define==="function"&&define.amd){define(definition);}else{mori=definition();}})(function(){return function(){
var g,aa=this;
function m(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";else if("function"==
b&&"undefined"==typeof a.call)return"object";return b}var ba="closure_uid_"+(1E9*Math.random()>>>0),ca=0;function p(a,b){var c=a.split("."),d=aa;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d=d[e]?d[e]:d[e]={}:d[e]=b};function da(a,b){for(var c in a)b.call(void 0,a[c],c,a)};function ea(a,b){null!=a&&this.append.apply(this,arguments)}ea.prototype.Va="";ea.prototype.append=function(a,b,c){this.Va+=a;if(null!=b)for(var d=1;d<arguments.length;d++)this.Va+=arguments[d];return this};ea.prototype.toString=function(){return this.Va};function fa(a,b){a.sort(b||ga)}function ha(a,b){for(var c=0;c<a.length;c++)a[c]={index:c,value:a[c]};var d=b||ga;fa(a,function(a,b){return d(a.value,b.value)||a.index-b.index});for(c=0;c<a.length;c++)a[c]=a[c].value}function ga(a,b){return a>b?1:a<b?-1:0};var ia=null,ja=null;function ka(){return new la(null,5,[ma,!0,oa,!0,pa,!1,qa,!1,ra,ia],null)}function r(a){return null!=a&&!1!==a}function sa(a){return r(a)?!1:!0}function s(a,b){return a[m(null==b?null:b)]?!0:a._?!0:u?!1:null}function ta(a){return null==a?null:a.constructor}function x(a,b){var c=ta(b),c=r(r(c)?c.Db:c)?c.Bb:m(b);return Error(["No protocol method ",a," defined for type ",c,": ",b].join(""))}function ua(a){var b=a.Bb;return r(b)?b:""+A.b(a)}
function va(a){for(var b=a.length,c=Array(b),d=0;;)if(d<b)c[d]=a[d],d+=1;else break;return c}function wa(a){return Array.prototype.slice.call(arguments)}
var xa=function(){function a(a,b){return C.c?C.c(function(a,b){a.push(b);return a},[],b):C.call(null,function(a,b){a.push(b);return a},[],b)}function b(a){return c.a(null,a)}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,0,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),ya={},za={};
function Aa(a){if(a?a.L:a)return a.L(a);var b;b=Aa[m(null==a?null:a)];if(!b&&(b=Aa._,!b))throw x("ICounted.-count",a);return b.call(null,a)}function Ba(a){if(a?a.I:a)return a.I(a);var b;b=Ba[m(null==a?null:a)];if(!b&&(b=Ba._,!b))throw x("IEmptyableCollection.-empty",a);return b.call(null,a)}var Ca={};function Da(a,b){if(a?a.G:a)return a.G(a,b);var c;c=Da[m(null==a?null:a)];if(!c&&(c=Da._,!c))throw x("ICollection.-conj",a);return c.call(null,a,b)}
var Ea={},D=function(){function a(a,b,c){if(a?a.aa:a)return a.aa(a,b,c);var h;h=D[m(null==a?null:a)];if(!h&&(h=D._,!h))throw x("IIndexed.-nth",a);return h.call(null,a,b,c)}function b(a,b){if(a?a.J:a)return a.J(a,b);var c;c=D[m(null==a?null:a)];if(!c&&(c=D._,!c))throw x("IIndexed.-nth",a);return c.call(null,a,b)}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}(),
Fa={};function Ha(a){if(a?a.Q:a)return a.Q(a);var b;b=Ha[m(null==a?null:a)];if(!b&&(b=Ha._,!b))throw x("ISeq.-first",a);return b.call(null,a)}function Ia(a){if(a?a.S:a)return a.S(a);var b;b=Ia[m(null==a?null:a)];if(!b&&(b=Ia._,!b))throw x("ISeq.-rest",a);return b.call(null,a)}
var Ja={},Ka={},La=function(){function a(a,b,c){if(a?a.C:a)return a.C(a,b,c);var h;h=La[m(null==a?null:a)];if(!h&&(h=La._,!h))throw x("ILookup.-lookup",a);return h.call(null,a,b,c)}function b(a,b){if(a?a.u:a)return a.u(a,b);var c;c=La[m(null==a?null:a)];if(!c&&(c=La._,!c))throw x("ILookup.-lookup",a);return c.call(null,a,b)}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=
a;return c}(),Ma={};function Na(a,b){if(a?a.kb:a)return a.kb(a,b);var c;c=Na[m(null==a?null:a)];if(!c&&(c=Na._,!c))throw x("IAssociative.-contains-key?",a);return c.call(null,a,b)}function Oa(a,b,c){if(a?a.ua:a)return a.ua(a,b,c);var d;d=Oa[m(null==a?null:a)];if(!d&&(d=Oa._,!d))throw x("IAssociative.-assoc",a);return d.call(null,a,b,c)}var Pa={};function Qa(a,b){if(a?a.nb:a)return a.nb(a,b);var c;c=Qa[m(null==a?null:a)];if(!c&&(c=Qa._,!c))throw x("IMap.-dissoc",a);return c.call(null,a,b)}var Sa={};
function Ta(a){if(a?a.$a:a)return a.$a(a);var b;b=Ta[m(null==a?null:a)];if(!b&&(b=Ta._,!b))throw x("IMapEntry.-key",a);return b.call(null,a)}function Ua(a){if(a?a.ab:a)return a.ab(a);var b;b=Ua[m(null==a?null:a)];if(!b&&(b=Ua._,!b))throw x("IMapEntry.-val",a);return b.call(null,a)}var Va={};function Wa(a,b){if(a?a.vb:a)return a.vb(a,b);var c;c=Wa[m(null==a?null:a)];if(!c&&(c=Wa._,!c))throw x("ISet.-disjoin",a);return c.call(null,a,b)}
function Xa(a){if(a?a.Ia:a)return a.Ia(a);var b;b=Xa[m(null==a?null:a)];if(!b&&(b=Xa._,!b))throw x("IStack.-peek",a);return b.call(null,a)}function Ya(a){if(a?a.Ja:a)return a.Ja(a);var b;b=Ya[m(null==a?null:a)];if(!b&&(b=Ya._,!b))throw x("IStack.-pop",a);return b.call(null,a)}var Za={};function $a(a,b,c){if(a?a.Pa:a)return a.Pa(a,b,c);var d;d=$a[m(null==a?null:a)];if(!d&&(d=$a._,!d))throw x("IVector.-assoc-n",a);return d.call(null,a,b,c)}
function ab(a){if(a?a.ub:a)return a.ub(a);var b;b=ab[m(null==a?null:a)];if(!b&&(b=ab._,!b))throw x("IDeref.-deref",a);return b.call(null,a)}var bb={};function cb(a){if(a?a.D:a)return a.D(a);var b;b=cb[m(null==a?null:a)];if(!b&&(b=cb._,!b))throw x("IMeta.-meta",a);return b.call(null,a)}var db={};function eb(a,b){if(a?a.F:a)return a.F(a,b);var c;c=eb[m(null==a?null:a)];if(!c&&(c=eb._,!c))throw x("IWithMeta.-with-meta",a);return c.call(null,a,b)}
var fb={},gb=function(){function a(a,b,c){if(a?a.M:a)return a.M(a,b,c);var h;h=gb[m(null==a?null:a)];if(!h&&(h=gb._,!h))throw x("IReduce.-reduce",a);return h.call(null,a,b,c)}function b(a,b){if(a?a.N:a)return a.N(a,b);var c;c=gb[m(null==a?null:a)];if(!c&&(c=gb._,!c))throw x("IReduce.-reduce",a);return c.call(null,a,b)}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}();
function hb(a,b,c){if(a?a.Za:a)return a.Za(a,b,c);var d;d=hb[m(null==a?null:a)];if(!d&&(d=hb._,!d))throw x("IKVReduce.-kv-reduce",a);return d.call(null,a,b,c)}function ib(a,b){if(a?a.v:a)return a.v(a,b);var c;c=ib[m(null==a?null:a)];if(!c&&(c=ib._,!c))throw x("IEquiv.-equiv",a);return c.call(null,a,b)}function jb(a){if(a?a.B:a)return a.B(a);var b;b=jb[m(null==a?null:a)];if(!b&&(b=jb._,!b))throw x("IHash.-hash",a);return b.call(null,a)}var kb={};
function lb(a){if(a?a.H:a)return a.H(a);var b;b=lb[m(null==a?null:a)];if(!b&&(b=lb._,!b))throw x("ISeqable.-seq",a);return b.call(null,a)}var mb={},nb={},ob={};function pb(a){if(a?a.Xa:a)return a.Xa(a);var b;b=pb[m(null==a?null:a)];if(!b&&(b=pb._,!b))throw x("IReversible.-rseq",a);return b.call(null,a)}function qb(a,b){if(a?a.yb:a)return a.yb(a,b);var c;c=qb[m(null==a?null:a)];if(!c&&(c=qb._,!c))throw x("ISorted.-sorted-seq",a);return c.call(null,a,b)}
function rb(a,b,c){if(a?a.zb:a)return a.zb(a,b,c);var d;d=rb[m(null==a?null:a)];if(!d&&(d=rb._,!d))throw x("ISorted.-sorted-seq-from",a);return d.call(null,a,b,c)}function sb(a,b){if(a?a.xb:a)return a.xb(a,b);var c;c=sb[m(null==a?null:a)];if(!c&&(c=sb._,!c))throw x("ISorted.-entry-key",a);return c.call(null,a,b)}function tb(a){if(a?a.wb:a)return a.wb(a);var b;b=tb[m(null==a?null:a)];if(!b&&(b=tb._,!b))throw x("ISorted.-comparator",a);return b.call(null,a)}
function ub(a,b){if(a?a.Sb:a)return a.Sb(0,b);var c;c=ub[m(null==a?null:a)];if(!c&&(c=ub._,!c))throw x("IWriter.-write",a);return c.call(null,a,b)}var vb={};function wb(a,b,c){if(a?a.w:a)return a.w(a,b,c);var d;d=wb[m(null==a?null:a)];if(!d&&(d=wb._,!d))throw x("IPrintWithWriter.-pr-writer",a);return d.call(null,a,b,c)}function xb(a,b,c){if(a?a.Rb:a)return a.Rb(0,b,c);var d;d=xb[m(null==a?null:a)];if(!d&&(d=xb._,!d))throw x("IWatchable.-notify-watches",a);return d.call(null,a,b,c)}
function yb(a){if(a?a.Wa:a)return a.Wa(a);var b;b=yb[m(null==a?null:a)];if(!b&&(b=yb._,!b))throw x("IEditableCollection.-as-transient",a);return b.call(null,a)}function zb(a,b){if(a?a.Ka:a)return a.Ka(a,b);var c;c=zb[m(null==a?null:a)];if(!c&&(c=zb._,!c))throw x("ITransientCollection.-conj!",a);return c.call(null,a,b)}function Ab(a){if(a?a.Oa:a)return a.Oa(a);var b;b=Ab[m(null==a?null:a)];if(!b&&(b=Ab._,!b))throw x("ITransientCollection.-persistent!",a);return b.call(null,a)}
function Bb(a,b,c){if(a?a.cb:a)return a.cb(a,b,c);var d;d=Bb[m(null==a?null:a)];if(!d&&(d=Bb._,!d))throw x("ITransientAssociative.-assoc!",a);return d.call(null,a,b,c)}function Cb(a,b){if(a?a.Ab:a)return a.Ab(a,b);var c;c=Cb[m(null==a?null:a)];if(!c&&(c=Cb._,!c))throw x("ITransientMap.-dissoc!",a);return c.call(null,a,b)}function Db(a,b,c){if(a?a.Pb:a)return a.Pb(0,b,c);var d;d=Db[m(null==a?null:a)];if(!d&&(d=Db._,!d))throw x("ITransientVector.-assoc-n!",a);return d.call(null,a,b,c)}
function Eb(a){if(a?a.Qb:a)return a.Qb();var b;b=Eb[m(null==a?null:a)];if(!b&&(b=Eb._,!b))throw x("ITransientVector.-pop!",a);return b.call(null,a)}function Fb(a,b){if(a?a.Ob:a)return a.Ob(0,b);var c;c=Fb[m(null==a?null:a)];if(!c&&(c=Fb._,!c))throw x("ITransientSet.-disjoin!",a);return c.call(null,a,b)}function Gb(a){if(a?a.Kb:a)return a.Kb();var b;b=Gb[m(null==a?null:a)];if(!b&&(b=Gb._,!b))throw x("IChunk.-drop-first",a);return b.call(null,a)}
function Hb(a){if(a?a.sb:a)return a.sb(a);var b;b=Hb[m(null==a?null:a)];if(!b&&(b=Hb._,!b))throw x("IChunkedSeq.-chunked-first",a);return b.call(null,a)}function Ib(a){if(a?a.tb:a)return a.tb(a);var b;b=Ib[m(null==a?null:a)];if(!b&&(b=Ib._,!b))throw x("IChunkedSeq.-chunked-rest",a);return b.call(null,a)}function Jb(a){if(a?a.rb:a)return a.rb(a);var b;b=Jb[m(null==a?null:a)];if(!b&&(b=Jb._,!b))throw x("IChunkedNext.-chunked-next",a);return b.call(null,a)}
function Kb(a){this.vc=a;this.q=0;this.i=1073741824}Kb.prototype.Sb=function(a,b){return this.vc.append(b)};function Lb(a){var b=new ea;a.w(null,new Kb(b),ka());return""+A.b(b)}var Mb="undefined"!==typeof Math.imul&&0!==(Math.imul.a?Math.imul.a(4294967295,5):Math.imul.call(null,4294967295,5))?function(a,b){return Math.imul(a,b)}:function(a,b){var c=a&65535,d=b&65535;return c*d+((a>>>16&65535)*d+c*(b>>>16&65535)<<16>>>0)|0};function Nb(a){a=Mb(a,3432918353);return Mb(a<<15|a>>>-15,461845907)}
function Ob(a,b){var c=a^b;return Mb(c<<13|c>>>-13,5)+3864292196}function Pb(a,b){var c=a^b,c=Mb(c^c>>>16,2246822507),c=Mb(c^c>>>13,3266489909);return c^c>>>16}var Qb={},Rb=0;function Sb(a){255<Rb&&(Qb={},Rb=0);var b=Qb[a];if("number"!==typeof b){a:if(null!=a)if(b=a.length,0<b){for(var c=0,d=0;;)if(c<b)var e=c+1,d=Mb(31,d)+a.charCodeAt(c),c=e;else{b=d;break a}b=void 0}else b=0;else b=0;Qb[a]=b;Rb+=1}return a=b}
function Tb(a){a&&(a.i&4194304||a.Dc)?a=a.B(null):"number"===typeof a?a=Math.floor(a)%2147483647:!0===a?a=1:!1===a?a=0:"string"===typeof a?(a=Sb(a),0!==a&&(a=Nb(a),a=Ob(0,a),a=Pb(a,4))):a=null==a?0:u?jb(a):null;return a}
function Ub(a){var b;b=a.name;var c;a:{c=1;for(var d=0;;)if(c<b.length){var e=c+2,d=Ob(d,Nb(b.charCodeAt(c-1)|b.charCodeAt(c)<<16));c=e}else{c=d;break a}c=void 0}c=1===(b.length&1)?c^Nb(b.charCodeAt(b.length-1)):c;b=Pb(c,Mb(2,b.length));a=Sb(a.fa);return b^a+2654435769+(b<<6)+(b>>2)}
function Vb(a,b){if(r(Wb.a?Wb.a(a,b):Wb.call(null,a,b)))return 0;var c=sa(a.fa);if(r(c?b.fa:c))return-1;if(r(a.fa)){if(sa(b.fa))return 1;c=Xb.a?Xb.a(a.fa,b.fa):Xb.call(null,a.fa,b.fa);return 0===c?Xb.a?Xb.a(a.name,b.name):Xb.call(null,a.name,b.name):c}return Yb?Xb.a?Xb.a(a.name,b.name):Xb.call(null,a.name,b.name):null}function Zb(a,b,c,d,e){this.fa=a;this.name=b;this.Na=c;this.Ua=d;this.W=e;this.i=2154168321;this.q=4096}g=Zb.prototype;g.w=function(a,b){return ub(b,this.Na)};
g.B=function(){var a=this.Ua;return null!=a?a:this.Ua=a=Ub(this)};g.F=function(a,b){return new Zb(this.fa,this.name,this.Na,this.Ua,b)};g.D=function(){return this.W};g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return La.c(c,this,null);case 3:return La.c(c,this,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return La.c(a,this,null)};
g.a=function(a,b){return La.c(a,this,b)};g.v=function(a,b){return b instanceof Zb?this.Na===b.Na:!1};g.toString=function(){return this.Na};var $b=function(){function a(a,b){var c=null!=a?""+A.b(a)+"/"+A.b(b):b;return new Zb(a,b,c,null,null)}function b(a){return a instanceof Zb?a:c.a(null,a)}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}();
function E(a){if(null==a)return null;if(a&&(a.i&8388608||a.hc))return a.H(null);if(a instanceof Array||"string"===typeof a)return 0===a.length?null:new ac(a,0);if(s(kb,a))return lb(a);if(u)throw Error(""+A.b(a)+" is not ISeqable");return null}function F(a){if(null==a)return null;if(a&&(a.i&64||a.bb))return a.Q(null);a=E(a);return null==a?null:Ha(a)}function G(a){return null!=a?a&&(a.i&64||a.bb)?a.S(null):(a=E(a))?Ia(a):H:H}function I(a){return null==a?null:a&&(a.i&128||a.ob)?a.U(null):E(G(a))}
var Wb=function(){function a(a,b){return null==a?null==b:a===b||ib(a,b)}var b=null,c=function(){function a(b,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,b,d,l)}function c(a,d,e){for(;;)if(b.a(a,d))if(I(e))a=d,d=F(e),e=I(e);else return b.a(d,F(e));else return!1}a.k=2;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};a.d=c;return a}(),b=function(b,e,f){switch(arguments.length){case 1:return!0;case 2:return a.call(this,b,
e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;b.b=function(){return!0};b.a=a;b.d=c.d;return b}();function bc(a,b){var c=Nb(a),c=Ob(0,c);return Pb(c,b)}function cc(a){var b=0,c=1;for(a=E(a);;)if(null!=a)b+=1,c=Mb(31,c)+Tb(F(a))|0,a=I(a);else return bc(c,b)}function dc(a){var b=0,c=0;for(a=E(a);;)if(null!=a)b+=1,c=c+Tb(F(a))|0,a=I(a);else return bc(c,b)}za["null"]=!0;Aa["null"]=function(){return 0};
Date.prototype.v=function(a,b){return b instanceof Date&&this.toString()===b.toString()};ib.number=function(a,b){return a===b};bb["function"]=!0;cb["function"]=function(){return null};ya["function"]=!0;jb._=function(a){return a[ba]||(a[ba]=++ca)};function ec(a){this.l=a;this.q=0;this.i=32768}ec.prototype.ub=function(){return this.l};function fc(a){return a instanceof ec}
var gc=function(){function a(a,b,c,d){for(var l=Aa(a);;)if(d<l){c=b.a?b.a(c,D.a(a,d)):b.call(null,c,D.a(a,d));if(fc(c))return K.b?K.b(c):K.call(null,c);d+=1}else return c}function b(a,b,c){for(var d=Aa(a),l=0;;)if(l<d){c=b.a?b.a(c,D.a(a,l)):b.call(null,c,D.a(a,l));if(fc(c))return K.b?K.b(c):K.call(null,c);l+=1}else return c}function c(a,b){var c=Aa(a);if(0===c)return b.o?b.o():b.call(null);for(var d=D.a(a,0),l=1;;)if(l<c){d=b.a?b.a(d,D.a(a,l)):b.call(null,d,D.a(a,l));if(fc(d))return K.b?K.b(d):K.call(null,
d);l+=1}else return d}var d=null,d=function(d,f,h,k){switch(arguments.length){case 2:return c.call(this,d,f);case 3:return b.call(this,d,f,h);case 4:return a.call(this,d,f,h,k)}throw Error("Invalid arity: "+arguments.length);};d.a=c;d.c=b;d.n=a;return d}(),hc=function(){function a(a,b,c,d){for(var l=a.length;;)if(d<l){c=b.a?b.a(c,a[d]):b.call(null,c,a[d]);if(fc(c))return K.b?K.b(c):K.call(null,c);d+=1}else return c}function b(a,b,c){for(var d=a.length,l=0;;)if(l<d){c=b.a?b.a(c,a[l]):b.call(null,c,
a[l]);if(fc(c))return K.b?K.b(c):K.call(null,c);l+=1}else return c}function c(a,b){var c=a.length;if(0===a.length)return b.o?b.o():b.call(null);for(var d=a[0],l=1;;)if(l<c){d=b.a?b.a(d,a[l]):b.call(null,d,a[l]);if(fc(d))return K.b?K.b(d):K.call(null,d);l+=1}else return d}var d=null,d=function(d,f,h,k){switch(arguments.length){case 2:return c.call(this,d,f);case 3:return b.call(this,d,f,h);case 4:return a.call(this,d,f,h,k)}throw Error("Invalid arity: "+arguments.length);};d.a=c;d.c=b;d.n=a;return d}();
function ic(a){return a?a.i&2||a.Yb?!0:a.i?!1:s(za,a):s(za,a)}function jc(a){return a?a.i&16||a.Lb?!0:a.i?!1:s(Ea,a):s(Ea,a)}function ac(a,b){this.e=a;this.p=b;this.i=166199550;this.q=8192}g=ac.prototype;g.toString=function(){return Lb(this)};g.J=function(a,b){var c=b+this.p;return c<this.e.length?this.e[c]:null};g.aa=function(a,b,c){a=b+this.p;return a<this.e.length?this.e[a]:c};g.U=function(){return this.p+1<this.e.length?new ac(this.e,this.p+1):null};g.L=function(){return this.e.length-this.p};
g.Xa=function(){var a=Aa(this);return 0<a?new kc(this,a-1,null):null};g.B=function(){return cc(this)};g.v=function(a,b){return lc.a?lc.a(this,b):lc.call(null,this,b)};g.I=function(){return H};g.N=function(a,b){return hc.n(this.e,b,this.e[this.p],this.p+1)};g.M=function(a,b,c){return hc.n(this.e,b,c,this.p)};g.Q=function(){return this.e[this.p]};g.S=function(){return this.p+1<this.e.length?new ac(this.e,this.p+1):H};g.H=function(){return this};
g.G=function(a,b){return M.a?M.a(b,this):M.call(null,b,this)};
var mc=function(){function a(a,b){return b<a.length?new ac(a,b):null}function b(a){return c.a(a,0)}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),J=function(){function a(a,b){return mc.a(a,b)}function b(a){return mc.a(a,0)}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+
arguments.length);};c.b=b;c.a=a;return c}();function kc(a,b,c){this.jb=a;this.p=b;this.j=c;this.i=32374990;this.q=8192}g=kc.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.j};g.U=function(){return 0<this.p?new kc(this.jb,this.p-1,null):null};g.L=function(){return this.p+1};g.B=function(){return cc(this)};g.v=function(a,b){return lc.a?lc.a(this,b):lc.call(null,this,b)};g.I=function(){return N.a?N.a(H,this.j):N.call(null,H,this.j)};
g.N=function(a,b){return nc.a?nc.a(b,this):nc.call(null,b,this)};g.M=function(a,b,c){return nc.c?nc.c(b,c,this):nc.call(null,b,c,this)};g.Q=function(){return D.a(this.jb,this.p)};g.S=function(){return 0<this.p?new kc(this.jb,this.p-1,null):H};g.H=function(){return this};g.F=function(a,b){return new kc(this.jb,this.p,b)};g.G=function(a,b){return M.a?M.a(b,this):M.call(null,b,this)};function oc(a){for(;;){var b=I(a);if(null!=b)a=b;else return F(a)}}ib._=function(a,b){return a===b};
var pc=function(){function a(a,b){return null!=a?Da(a,b):Da(H,b)}var b=null,c=function(){function a(b,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,b,d,l)}function c(a,d,e){for(;;)if(r(e))a=b.a(a,d),d=F(e),e=I(e);else return b.a(a,d)}a.k=2;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};a.d=c;return a}(),b=function(b,e,f){switch(arguments.length){case 2:return a.call(this,b,e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+
arguments.length);};b.k=2;b.f=c.f;b.a=a;b.d=c.d;return b}();function qc(a){return null==a?null:Ba(a)}function O(a){if(null!=a)if(a&&(a.i&2||a.Yb))a=a.L(null);else if(a instanceof Array)a=a.length;else if("string"===typeof a)a=a.length;else if(s(za,a))a=Aa(a);else if(u)a:{a=E(a);for(var b=0;;){if(ic(a)){a=b+Aa(a);break a}a=I(a);b+=1}a=void 0}else a=null;else a=0;return a}
var rc=function(){function a(a,b,c){for(;;){if(null==a)return c;if(0===b)return E(a)?F(a):c;if(jc(a))return D.c(a,b,c);if(E(a))a=I(a),b-=1;else return u?c:null}}function b(a,b){for(;;){if(null==a)throw Error("Index out of bounds");if(0===b){if(E(a))return F(a);throw Error("Index out of bounds");}if(jc(a))return D.a(a,b);if(E(a)){var c=I(a),h=b-1;a=c;b=h}else{if(u)throw Error("Index out of bounds");return null}}}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,
c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}(),P=function(){function a(a,b,c){if("number"!==typeof b)throw Error("index argument to nth must be a number.");if(null==a)return c;if(a&&(a.i&16||a.Lb))return a.aa(null,b,c);if(a instanceof Array||"string"===typeof a)return b<a.length?a[b]:c;if(s(Ea,a))return D.a(a,b);if(a?a.i&64||a.bb||(a.i?0:s(Fa,a)):s(Fa,a))return rc.c(a,b,c);if(u)throw Error("nth not supported on this type "+A.b(ua(ta(a))));return null}function b(a,
b){if("number"!==typeof b)throw Error("index argument to nth must be a number");if(null==a)return a;if(a&&(a.i&16||a.Lb))return a.J(null,b);if(a instanceof Array||"string"===typeof a)return b<a.length?a[b]:null;if(s(Ea,a))return D.a(a,b);if(a?a.i&64||a.bb||(a.i?0:s(Fa,a)):s(Fa,a))return rc.a(a,b);if(u)throw Error("nth not supported on this type "+A.b(ua(ta(a))));return null}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+
arguments.length);};c.a=b;c.c=a;return c}(),Q=function(){function a(a,b,c){return null!=a?a&&(a.i&256||a.Mb)?a.C(null,b,c):a instanceof Array?b<a.length?a[b]:c:"string"===typeof a?b<a.length?a[b]:c:s(Ka,a)?La.c(a,b,c):u?c:null:c}function b(a,b){return null==a?null:a&&(a.i&256||a.Mb)?a.u(null,b):a instanceof Array?b<a.length?a[b]:null:"string"===typeof a?b<a.length?a[b]:null:s(Ka,a)?La.a(a,b):null}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,
c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}(),R=function(){function a(a,b,c){return null!=a?Oa(a,b,c):sc.a?sc.a([b],[c]):sc.call(null,[b],[c])}var b=null,c=function(){function a(b,d,k,l){var n=null;3<arguments.length&&(n=J(Array.prototype.slice.call(arguments,3),0));return c.call(this,b,d,k,n)}function c(a,d,e,l){for(;;)if(a=b.c(a,d,e),r(l))d=F(l),e=F(I(l)),l=I(I(l));else return a}a.k=3;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=I(a);var l=F(a);a=G(a);return c(b,
d,l,a)};a.d=c;return a}(),b=function(b,e,f,h){switch(arguments.length){case 3:return a.call(this,b,e,f);default:return c.d(b,e,f,J(arguments,3))}throw Error("Invalid arity: "+arguments.length);};b.k=3;b.f=c.f;b.c=a;b.d=c.d;return b}(),tc=function(){function a(a,b){return null==a?null:Qa(a,b)}var b=null,c=function(){function a(b,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,b,d,l)}function c(a,d,e){for(;;){if(null==a)return null;a=b.a(a,d);
if(r(e))d=F(e),e=I(e);else return a}}a.k=2;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};a.d=c;return a}(),b=function(b,e,f){switch(arguments.length){case 1:return b;case 2:return a.call(this,b,e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;b.b=function(a){return a};b.a=a;b.d=c.d;return b}();function uc(a){var b="function"==m(a);return b?b:a?r(r(null)?null:a.Xb)?!0:a.Cb?!1:s(ya,a):s(ya,a)}
function vc(a,b){this.h=a;this.j=b;this.q=0;this.i=393217}g=vc.prototype;
g.call=function(){var a=null;return a=function(a,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga,Ra,wc){switch(arguments.length){case 1:var z=a,z=this;return z.h.o?z.h.o():z.h.call(null);case 2:return z=a,z=this,z.h.b?z.h.b(c):z.h.call(null,c);case 3:return z=a,z=this,z.h.a?z.h.a(c,d):z.h.call(null,c,d);case 4:return z=a,z=this,z.h.c?z.h.c(c,d,e):z.h.call(null,c,d,e);case 5:return z=a,z=this,z.h.n?z.h.n(c,d,e,f):z.h.call(null,c,d,e,f);case 6:return z=a,z=this,z.h.s?z.h.s(c,d,e,f,h):z.h.call(null,c,d,e,f,
h);case 7:return z=a,z=this,z.h.X?z.h.X(c,d,e,f,h,k):z.h.call(null,c,d,e,f,h,k);case 8:return z=a,z=this,z.h.ga?z.h.ga(c,d,e,f,h,k,l):z.h.call(null,c,d,e,f,h,k,l);case 9:return z=a,z=this,z.h.Ga?z.h.Ga(c,d,e,f,h,k,l,n):z.h.call(null,c,d,e,f,h,k,l,n);case 10:return z=a,z=this,z.h.Ha?z.h.Ha(c,d,e,f,h,k,l,n,q):z.h.call(null,c,d,e,f,h,k,l,n,q);case 11:return z=a,z=this,z.h.va?z.h.va(c,d,e,f,h,k,l,n,q,t):z.h.call(null,c,d,e,f,h,k,l,n,q,t);case 12:return z=a,z=this,z.h.wa?z.h.wa(c,d,e,f,h,k,l,n,q,t,v):
z.h.call(null,c,d,e,f,h,k,l,n,q,t,v);case 13:return z=a,z=this,z.h.xa?z.h.xa(c,d,e,f,h,k,l,n,q,t,v,w):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w);case 14:return z=a,z=this,z.h.ya?z.h.ya(c,d,e,f,h,k,l,n,q,t,v,w,y):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y);case 15:return z=a,z=this,z.h.za?z.h.za(c,d,e,f,h,k,l,n,q,t,v,w,y,B):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B);case 16:return z=a,z=this,z.h.Aa?z.h.Aa(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L);case 17:return z=a,z=this,
z.h.Ba?z.h.Ba(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U);case 18:return z=a,z=this,z.h.Ca?z.h.Ca(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z);case 19:return z=a,z=this,z.h.Da?z.h.Da(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na);case 20:return z=a,z=this,z.h.Ea?z.h.Ea(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga);case 21:return z=
a,z=this,z.h.Fa?z.h.Fa(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga,Ra):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga,Ra);case 22:return z=a,z=this,S.bc?S.bc(z.h,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga,Ra,wc):S.call(null,z.h,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga,Ra,wc)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.o=function(){return this.h.o?this.h.o():this.h.call(null)};
g.b=function(a){return this.h.b?this.h.b(a):this.h.call(null,a)};g.a=function(a,b){return this.h.a?this.h.a(a,b):this.h.call(null,a,b)};g.c=function(a,b,c){return this.h.c?this.h.c(a,b,c):this.h.call(null,a,b,c)};g.n=function(a,b,c,d){return this.h.n?this.h.n(a,b,c,d):this.h.call(null,a,b,c,d)};g.s=function(a,b,c,d,e){return this.h.s?this.h.s(a,b,c,d,e):this.h.call(null,a,b,c,d,e)};g.X=function(a,b,c,d,e,f){return this.h.X?this.h.X(a,b,c,d,e,f):this.h.call(null,a,b,c,d,e,f)};
g.ga=function(a,b,c,d,e,f,h){return this.h.ga?this.h.ga(a,b,c,d,e,f,h):this.h.call(null,a,b,c,d,e,f,h)};g.Ga=function(a,b,c,d,e,f,h,k){return this.h.Ga?this.h.Ga(a,b,c,d,e,f,h,k):this.h.call(null,a,b,c,d,e,f,h,k)};g.Ha=function(a,b,c,d,e,f,h,k,l){return this.h.Ha?this.h.Ha(a,b,c,d,e,f,h,k,l):this.h.call(null,a,b,c,d,e,f,h,k,l)};g.va=function(a,b,c,d,e,f,h,k,l,n){return this.h.va?this.h.va(a,b,c,d,e,f,h,k,l,n):this.h.call(null,a,b,c,d,e,f,h,k,l,n)};
g.wa=function(a,b,c,d,e,f,h,k,l,n,q){return this.h.wa?this.h.wa(a,b,c,d,e,f,h,k,l,n,q):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q)};g.xa=function(a,b,c,d,e,f,h,k,l,n,q,t){return this.h.xa?this.h.xa(a,b,c,d,e,f,h,k,l,n,q,t):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t)};g.ya=function(a,b,c,d,e,f,h,k,l,n,q,t,v){return this.h.ya?this.h.ya(a,b,c,d,e,f,h,k,l,n,q,t,v):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t,v)};
g.za=function(a,b,c,d,e,f,h,k,l,n,q,t,v,w){return this.h.za?this.h.za(a,b,c,d,e,f,h,k,l,n,q,t,v,w):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t,v,w)};g.Aa=function(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y){return this.h.Aa?this.h.Aa(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t,v,w,y)};g.Ba=function(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B){return this.h.Ba?this.h.Ba(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B)};
g.Ca=function(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L){return this.h.Ca?this.h.Ca(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L)};g.Da=function(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U){return this.h.Da?this.h.Da(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U)};
g.Ea=function(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z){return this.h.Ea?this.h.Ea(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z)};g.Fa=function(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na){return this.h.Fa?this.h.Fa(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na)};g.Xb=!0;g.F=function(a,b){return new vc(this.h,b)};g.D=function(){return this.j};
function N(a,b){return uc(a)&&!(a?a.i&262144||a.oc||(a.i?0:s(db,a)):s(db,a))?new vc(a,b):null==a?null:eb(a,b)}function xc(a){var b=null!=a;return(b?a?a.i&131072||a.ec||(a.i?0:s(bb,a)):s(bb,a):b)?cb(a):null}function yc(a){return null==a?null:Xa(a)}function zc(a){return null==a?null:Ya(a)}
var Ac=function(){function a(a,b){return null==a?null:Wa(a,b)}var b=null,c=function(){function a(b,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,b,d,l)}function c(a,d,e){for(;;){if(null==a)return null;a=b.a(a,d);if(r(e))d=F(e),e=I(e);else return a}}a.k=2;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};a.d=c;return a}(),b=function(b,e,f){switch(arguments.length){case 1:return b;case 2:return a.call(this,b,e);default:return c.d(b,
e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;b.b=function(a){return a};b.a=a;b.d=c.d;return b}();function Bc(a){return null==a||sa(E(a))}function Cc(a){return null==a?!1:a?a.i&8||a.Ac?!0:a.i?!1:s(Ca,a):s(Ca,a)}function Dc(a){return null==a?!1:a?a.i&4096||a.jc?!0:a.i?!1:s(Va,a):s(Va,a)}function Ec(a){return a?a.i&512||a.yc?!0:a.i?!1:s(Ma,a):s(Ma,a)}function Fc(a){return a?a.i&16777216||a.ic?!0:a.i?!1:s(mb,a):s(mb,a)}
function Gc(a){return null==a?!1:a?a.i&1024||a.cc?!0:a.i?!1:s(Pa,a):s(Pa,a)}function Hc(a){return a?a.i&16384||a.Gc?!0:a.i?!1:s(Za,a):s(Za,a)}function Ic(a){return a?a.q&512||a.zc?!0:!1:!1}function Jc(a){var b=[];da(a,function(a){return function(b,e){return a.push(e)}}(b));return b}function Kc(a,b,c,d,e){for(;0!==e;)c[d]=a[b],d+=1,e-=1,b+=1}var Lc={};function Mc(a){return null==a?!1:a?a.i&64||a.bb?!0:a.i?!1:s(Fa,a):s(Fa,a)}function Nc(a){return r(a)?!0:!1}
function Oc(a,b){return Q.c(a,b,Lc)===Lc?!1:!0}function Xb(a,b){if(a===b)return 0;if(null==a)return-1;if(null==b)return 1;if(ta(a)===ta(b))return a&&(a.q&2048||a.lb)?a.mb(null,b):ga(a,b);if(u)throw Error("compare on non-nil objects of different types");return null}
var Pc=function(){function a(a,b,c,h){for(;;){var k=Xb(P.a(a,h),P.a(b,h));if(0===k&&h+1<c)h+=1;else return k}}function b(a,b){var f=O(a),h=O(b);return f<h?-1:f>h?1:u?c.n(a,b,f,0):null}var c=null,c=function(c,e,f,h){switch(arguments.length){case 2:return b.call(this,c,e);case 4:return a.call(this,c,e,f,h)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.n=a;return c}();
function Qc(a){return Wb.a(a,Xb)?Xb:function(b,c){var d=a.a?a.a(b,c):a.call(null,b,c);return"number"===typeof d?d:r(d)?-1:r(a.a?a.a(c,b):a.call(null,c,b))?1:0}}
var Sc=function(){function a(a,b){if(E(b)){var c=Rc.b?Rc.b(b):Rc.call(null,b);ha(c,Qc(a));return E(c)}return H}function b(a){return c.a(Xb,a)}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),Tc=function(){function a(a,b,c){return Sc.a(function(c,f){return Qc(b).call(null,a.b?a.b(c):a.call(null,c),a.b?a.b(f):a.call(null,f))},c)}function b(a,b){return c.c(a,Xb,b)}
var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}(),nc=function(){function a(a,b,c){for(c=E(c);;)if(c){b=a.a?a.a(b,F(c)):a.call(null,b,F(c));if(fc(b))return K.b?K.b(b):K.call(null,b);c=I(c)}else return b}function b(a,b){var c=E(b);return c?C.c?C.c(a,F(c),I(c)):C.call(null,a,F(c),I(c)):a.o?a.o():a.call(null)}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,
c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}(),C=function(){function a(a,b,c){return c&&(c.i&524288||c.Nb)?c.M(null,a,b):c instanceof Array?hc.c(c,a,b):"string"===typeof c?hc.c(c,a,b):s(fb,c)?gb.c(c,a,b):u?nc.c(a,b,c):null}function b(a,b){return b&&(b.i&524288||b.Nb)?b.N(null,a):b instanceof Array?hc.a(b,a):"string"===typeof b?hc.a(b,a):s(fb,b)?gb.a(b,a):u?nc.a(a,b):null}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,
c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}(),Uc=function(){var a=null,b=function(){function a(c,f,h){var k=null;2<arguments.length&&(k=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,f,k)}function b(a,c,d){for(;;)if(a>c)if(I(d))a=c,c=F(d),d=I(d);else return c>F(d);else return!1}a.k=2;a.f=function(a){var c=F(a);a=I(a);var h=F(a);a=G(a);return b(c,h,a)};a.d=b;return a}(),a=function(a,d,e){switch(arguments.length){case 1:return!0;
case 2:return a>d;default:return b.d(a,d,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};a.k=2;a.f=b.f;a.b=function(){return!0};a.a=function(a,b){return a>b};a.d=b.d;return a}(),Vc=function(){var a=null,b=function(){function a(c,f,h){var k=null;2<arguments.length&&(k=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,f,k)}function b(a,c,d){for(;;)if(a>=c)if(I(d))a=c,c=F(d),d=I(d);else return c>=F(d);else return!1}a.k=2;a.f=function(a){var c=F(a);a=I(a);var h=F(a);
a=G(a);return b(c,h,a)};a.d=b;return a}(),a=function(a,d,e){switch(arguments.length){case 1:return!0;case 2:return a>=d;default:return b.d(a,d,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};a.k=2;a.f=b.f;a.b=function(){return!0};a.a=function(a,b){return a>=b};a.d=b.d;return a}();function Wc(a){return a-1}
var Xc=function(){function a(a,b){return a>b?a:b}var b=null,c=function(){function a(b,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,b,d,l)}function c(a,d,e){return C.c(b,a>d?a:d,e)}a.k=2;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};a.d=c;return a}(),b=function(b,e,f){switch(arguments.length){case 1:return b;case 2:return a.call(this,b,e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);
};b.k=2;b.f=c.f;b.b=function(a){return a};b.a=a;b.d=c.d;return b}();function Yc(a){a=(a-a%2)/2;return 0<=a?Math.floor.b?Math.floor.b(a):Math.floor.call(null,a):Math.ceil.b?Math.ceil.b(a):Math.ceil.call(null,a)}function Zc(a){a-=a>>1&1431655765;a=(a&858993459)+(a>>2&858993459);return 16843009*(a+(a>>4)&252645135)>>24}function $c(a){var b=1;for(a=E(a);;)if(a&&0<b)b-=1,a=I(a);else return a}
var A=function(){function a(a){return null==a?"":a.toString()}var b=null,c=function(){function a(b,d){var k=null;1<arguments.length&&(k=J(Array.prototype.slice.call(arguments,1),0));return c.call(this,b,k)}function c(a,d){for(var e=new ea(b.b(a)),l=d;;)if(r(l))e=e.append(b.b(F(l))),l=I(l);else return e.toString()}a.k=1;a.f=function(a){var b=F(a);a=G(a);return c(b,a)};a.d=c;return a}(),b=function(b,e){switch(arguments.length){case 0:return"";case 1:return a.call(this,b);default:return c.d(b,J(arguments,
1))}throw Error("Invalid arity: "+arguments.length);};b.k=1;b.f=c.f;b.o=function(){return""};b.b=a;b.d=c.d;return b}(),ad=function(){var a=null,a=function(a,c,d){switch(arguments.length){case 2:return a.substring(c);case 3:return a.substring(c,d)}throw Error("Invalid arity: "+arguments.length);};a.a=function(a,c){return a.substring(c)};a.c=function(a,c,d){return a.substring(c,d)};return a}();
function lc(a,b){return Nc(Fc(b)?function(){for(var c=E(a),d=E(b);;){if(null==c)return null==d;if(null==d)return!1;if(Wb.a(F(c),F(d)))c=I(c),d=I(d);else return u?!1:null}}():null)}function bd(a,b,c,d,e){this.j=a;this.first=b;this.ta=c;this.count=d;this.m=e;this.i=65937646;this.q=8192}g=bd.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.j};g.U=function(){return 1===this.count?null:this.ta};g.L=function(){return this.count};g.Ia=function(){return this.first};g.Ja=function(){return Ia(this)};
g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return H};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return this.first};g.S=function(){return 1===this.count?H:this.ta};g.H=function(){return this};g.F=function(a,b){return new bd(b,this.first,this.ta,this.count,this.m)};g.G=function(a,b){return new bd(this.j,b,this,this.count+1,null)};
function cd(a){this.j=a;this.i=65937614;this.q=8192}g=cd.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.j};g.U=function(){return null};g.L=function(){return 0};g.Ia=function(){return null};g.Ja=function(){throw Error("Can't pop empty list");};g.B=function(){return 0};g.v=function(a,b){return lc(this,b)};g.I=function(){return this};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return null};g.S=function(){return H};
g.H=function(){return null};g.F=function(a,b){return new cd(b)};g.G=function(a,b){return new bd(this.j,b,null,1,null)};var H=new cd(null);function dd(a){return a?a.i&134217728||a.Fc?!0:a.i?!1:s(ob,a):s(ob,a)}function ed(a){return dd(a)?pb(a):C.c(pc,H,a)}
var fd=function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){var b;if(a instanceof ac&&0===a.p)b=a.e;else a:{for(b=[];;)if(null!=a)b.push(a.Q(null)),a=a.U(null);else break a;b=void 0}a=b.length;for(var e=H;;)if(0<a){var f=a-1,e=e.G(null,b[a-1]);a=f}else return e}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}();function gd(a,b,c,d){this.j=a;this.first=b;this.ta=c;this.m=d;this.i=65929452;this.q=8192}
g=gd.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.j};g.U=function(){return null==this.ta?null:E(this.ta)};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.j)};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return this.first};g.S=function(){return null==this.ta?H:this.ta};g.H=function(){return this};
g.F=function(a,b){return new gd(b,this.first,this.ta,this.m)};g.G=function(a,b){return new gd(null,b,this,this.m)};function M(a,b){var c=null==b;return(c?c:b&&(b.i&64||b.bb))?new gd(null,a,b,null):new gd(null,a,E(b),null)}function T(a,b,c,d){this.fa=a;this.name=b;this.sa=c;this.Ua=d;this.i=2153775105;this.q=4096}g=T.prototype;g.w=function(a,b){return ub(b,":"+A.b(this.sa))};g.B=function(){var a=this.Ua;return null!=a?a:this.Ua=a=Ub(this)+2654435769};
g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return Q.a(c,this);case 3:return Q.c(c,this,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return Q.a(a,this)};g.a=function(a,b){return Q.c(a,this,b)};g.v=function(a,b){return b instanceof T?this.sa===b.sa:!1};g.toString=function(){return":"+A.b(this.sa)};
function hd(a,b){return a===b?!0:a instanceof T&&b instanceof T?a.sa===b.sa:!1}
var jd=function(){function a(a,b){return new T(a,b,""+A.b(r(a)?""+A.b(a)+"/":null)+A.b(b),null)}function b(a){if(a instanceof T)return a;if(a instanceof Zb){var b;if(a&&(a.q&4096||a.fc))b=a.fa;else throw Error("Doesn't support namespace: "+A.b(a));return new T(b,id.b?id.b(a):id.call(null,a),a.Na,null)}return"string"===typeof a?(b=a.split("/"),2===b.length?new T(b[0],b[1],a,null):new T(null,b[0],a,null)):null}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,
c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}();function V(a,b,c,d){this.j=a;this.Ya=b;this.r=c;this.m=d;this.q=0;this.i=32374988}g=V.prototype;g.toString=function(){return Lb(this)};function kd(a){null!=a.Ya&&(a.r=a.Ya.o?a.Ya.o():a.Ya.call(null),a.Ya=null);return a.r}g.D=function(){return this.j};g.U=function(){lb(this);return null==this.r?null:I(this.r)};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};
g.I=function(){return N(H,this.j)};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){lb(this);return null==this.r?null:F(this.r)};g.S=function(){lb(this);return null!=this.r?G(this.r):H};g.H=function(){kd(this);if(null==this.r)return null;for(var a=this.r;;)if(a instanceof V)a=kd(a);else return this.r=a,E(this.r)};g.F=function(a,b){return new V(b,this.Ya,this.r,this.m)};g.G=function(a,b){return M(b,this)};
function ld(a,b){this.qb=a;this.end=b;this.q=0;this.i=2}ld.prototype.L=function(){return this.end};ld.prototype.add=function(a){this.qb[this.end]=a;return this.end+=1};ld.prototype.da=function(){var a=new md(this.qb,0,this.end);this.qb=null;return a};function md(a,b,c){this.e=a;this.O=b;this.end=c;this.q=0;this.i=524306}g=md.prototype;g.N=function(a,b){return hc.n(this.e,b,this.e[this.O],this.O+1)};g.M=function(a,b,c){return hc.n(this.e,b,c,this.O)};
g.Kb=function(){if(this.O===this.end)throw Error("-drop-first of empty chunk");return new md(this.e,this.O+1,this.end)};g.J=function(a,b){return this.e[this.O+b]};g.aa=function(a,b,c){return 0<=b&&b<this.end-this.O?this.e[this.O+b]:c};g.L=function(){return this.end-this.O};
var nd=function(){function a(a,b,c){return new md(a,b,c)}function b(a,b){return new md(a,b,a.length)}function c(a){return new md(a,0,a.length)}var d=null,d=function(d,f,h){switch(arguments.length){case 1:return c.call(this,d);case 2:return b.call(this,d,f);case 3:return a.call(this,d,f,h)}throw Error("Invalid arity: "+arguments.length);};d.b=c;d.a=b;d.c=a;return d}();function od(a,b,c,d){this.da=a;this.oa=b;this.j=c;this.m=d;this.i=31850732;this.q=1536}g=od.prototype;g.toString=function(){return Lb(this)};
g.D=function(){return this.j};g.U=function(){if(1<Aa(this.da))return new od(Gb(this.da),this.oa,this.j,null);var a=lb(this.oa);return null==a?null:a};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.j)};g.Q=function(){return D.a(this.da,0)};g.S=function(){return 1<Aa(this.da)?new od(Gb(this.da),this.oa,this.j,null):null==this.oa?H:this.oa};g.H=function(){return this};g.sb=function(){return this.da};
g.tb=function(){return null==this.oa?H:this.oa};g.F=function(a,b){return new od(this.da,this.oa,b,this.m)};g.G=function(a,b){return M(b,this)};g.rb=function(){return null==this.oa?null:this.oa};function pd(a,b){return 0===Aa(a)?b:new od(a,b,null,null)}function Rc(a){for(var b=[];;)if(E(a))b.push(F(a)),a=I(a);else return b}function qd(a,b){if(ic(a))return O(a);for(var c=a,d=b,e=0;;)if(0<d&&E(c))c=I(c),d-=1,e+=1;else return e}
var sd=function rd(b){return null==b?null:null==I(b)?E(F(b)):u?M(F(b),rd(I(b))):null},td=function(){function a(a,b){return new V(null,function(){var c=E(a);return c?Ic(c)?pd(Hb(c),d.a(Ib(c),b)):M(F(c),d.a(G(c),b)):b},null,null)}function b(a){return new V(null,function(){return a},null,null)}function c(){return new V(null,function(){return null},null,null)}var d=null,e=function(){function a(c,d,e){var f=null;2<arguments.length&&(f=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,
d,f)}function b(a,c,e){return function t(a,b){return new V(null,function(){var c=E(a);return c?Ic(c)?pd(Hb(c),t(Ib(c),b)):M(F(c),t(G(c),b)):r(b)?t(F(b),I(b)):null},null,null)}(d.a(a,c),e)}a.k=2;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=G(a);return b(c,d,a)};a.d=b;return a}(),d=function(d,h,k){switch(arguments.length){case 0:return c.call(this);case 1:return b.call(this,d);case 2:return a.call(this,d,h);default:return e.d(d,h,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};d.k=
2;d.f=e.f;d.o=c;d.b=b;d.a=a;d.d=e.d;return d}(),ud=function(){function a(a,b,c,d){return M(a,M(b,M(c,d)))}function b(a,b,c){return M(a,M(b,c))}var c=null,d=function(){function a(c,d,e,n,q){var t=null;4<arguments.length&&(t=J(Array.prototype.slice.call(arguments,4),0));return b.call(this,c,d,e,n,t)}function b(a,c,d,e,f){return M(a,M(c,M(d,M(e,sd(f)))))}a.k=4;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=I(a);var e=F(a);a=I(a);var q=F(a);a=G(a);return b(c,d,e,q,a)};a.d=b;return a}(),c=function(c,f,
h,k,l){switch(arguments.length){case 1:return E(c);case 2:return M(c,f);case 3:return b.call(this,c,f,h);case 4:return a.call(this,c,f,h,k);default:return d.d(c,f,h,k,J(arguments,4))}throw Error("Invalid arity: "+arguments.length);};c.k=4;c.f=d.f;c.b=function(a){return E(a)};c.a=function(a,b){return M(a,b)};c.c=b;c.n=a;c.d=d.d;return c}();function vd(a){return Ab(a)}
var wd=function(){var a=null,b=function(){function a(c,f,h){var k=null;2<arguments.length&&(k=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,f,k)}function b(a,c,d){for(;;)if(a=zb(a,c),r(d))c=F(d),d=I(d);else return a}a.k=2;a.f=function(a){var c=F(a);a=I(a);var h=F(a);a=G(a);return b(c,h,a)};a.d=b;return a}(),a=function(a,d,e){switch(arguments.length){case 2:return zb(a,d);default:return b.d(a,d,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};a.k=2;a.f=b.f;a.a=
function(a,b){return zb(a,b)};a.d=b.d;return a}(),xd=function(){var a=null,b=function(){function a(c,f,h,k){var l=null;3<arguments.length&&(l=J(Array.prototype.slice.call(arguments,3),0));return b.call(this,c,f,h,l)}function b(a,c,d,k){for(;;)if(a=Bb(a,c,d),r(k))c=F(k),d=F(I(k)),k=I(I(k));else return a}a.k=3;a.f=function(a){var c=F(a);a=I(a);var h=F(a);a=I(a);var k=F(a);a=G(a);return b(c,h,k,a)};a.d=b;return a}(),a=function(a,d,e,f){switch(arguments.length){case 3:return Bb(a,d,e);default:return b.d(a,
d,e,J(arguments,3))}throw Error("Invalid arity: "+arguments.length);};a.k=3;a.f=b.f;a.c=function(a,b,e){return Bb(a,b,e)};a.d=b.d;return a}(),yd=function(){var a=null,b=function(){function a(c,f,h){var k=null;2<arguments.length&&(k=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,f,k)}function b(a,c,d){for(;;)if(a=Cb(a,c),r(d))c=F(d),d=I(d);else return a}a.k=2;a.f=function(a){var c=F(a);a=I(a);var h=F(a);a=G(a);return b(c,h,a)};a.d=b;return a}(),a=function(a,d,e){switch(arguments.length){case 2:return Cb(a,
d);default:return b.d(a,d,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};a.k=2;a.f=b.f;a.a=function(a,b){return Cb(a,b)};a.d=b.d;return a}(),zd=function(){var a=null,b=function(){function a(c,f,h){var k=null;2<arguments.length&&(k=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,f,k)}function b(a,c,d){for(;;)if(a=Fb(a,c),r(d))c=F(d),d=I(d);else return a}a.k=2;a.f=function(a){var c=F(a);a=I(a);var h=F(a);a=G(a);return b(c,h,a)};a.d=b;return a}(),a=function(a,d,
e){switch(arguments.length){case 2:return Fb(a,d);default:return b.d(a,d,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};a.k=2;a.f=b.f;a.a=function(a,b){return Fb(a,b)};a.d=b.d;return a}();
function Ad(a,b,c){var d=E(c);if(0===b)return a.o?a.o():a.call(null);c=Ha(d);var e=Ia(d);if(1===b)return a.b?a.b(c):a.b?a.b(c):a.call(null,c);var d=Ha(e),f=Ia(e);if(2===b)return a.a?a.a(c,d):a.a?a.a(c,d):a.call(null,c,d);var e=Ha(f),h=Ia(f);if(3===b)return a.c?a.c(c,d,e):a.c?a.c(c,d,e):a.call(null,c,d,e);var f=Ha(h),k=Ia(h);if(4===b)return a.n?a.n(c,d,e,f):a.n?a.n(c,d,e,f):a.call(null,c,d,e,f);var h=Ha(k),l=Ia(k);if(5===b)return a.s?a.s(c,d,e,f,h):a.s?a.s(c,d,e,f,h):a.call(null,c,d,e,f,h);var k=Ha(l),
n=Ia(l);if(6===b)return a.X?a.X(c,d,e,f,h,k):a.X?a.X(c,d,e,f,h,k):a.call(null,c,d,e,f,h,k);var l=Ha(n),q=Ia(n);if(7===b)return a.ga?a.ga(c,d,e,f,h,k,l):a.ga?a.ga(c,d,e,f,h,k,l):a.call(null,c,d,e,f,h,k,l);var n=Ha(q),t=Ia(q);if(8===b)return a.Ga?a.Ga(c,d,e,f,h,k,l,n):a.Ga?a.Ga(c,d,e,f,h,k,l,n):a.call(null,c,d,e,f,h,k,l,n);var q=Ha(t),v=Ia(t);if(9===b)return a.Ha?a.Ha(c,d,e,f,h,k,l,n,q):a.Ha?a.Ha(c,d,e,f,h,k,l,n,q):a.call(null,c,d,e,f,h,k,l,n,q);var t=Ha(v),w=Ia(v);if(10===b)return a.va?a.va(c,d,e,
f,h,k,l,n,q,t):a.va?a.va(c,d,e,f,h,k,l,n,q,t):a.call(null,c,d,e,f,h,k,l,n,q,t);var v=Ha(w),y=Ia(w);if(11===b)return a.wa?a.wa(c,d,e,f,h,k,l,n,q,t,v):a.wa?a.wa(c,d,e,f,h,k,l,n,q,t,v):a.call(null,c,d,e,f,h,k,l,n,q,t,v);var w=Ha(y),B=Ia(y);if(12===b)return a.xa?a.xa(c,d,e,f,h,k,l,n,q,t,v,w):a.xa?a.xa(c,d,e,f,h,k,l,n,q,t,v,w):a.call(null,c,d,e,f,h,k,l,n,q,t,v,w);var y=Ha(B),L=Ia(B);if(13===b)return a.ya?a.ya(c,d,e,f,h,k,l,n,q,t,v,w,y):a.ya?a.ya(c,d,e,f,h,k,l,n,q,t,v,w,y):a.call(null,c,d,e,f,h,k,l,n,q,
t,v,w,y);var B=Ha(L),U=Ia(L);if(14===b)return a.za?a.za(c,d,e,f,h,k,l,n,q,t,v,w,y,B):a.za?a.za(c,d,e,f,h,k,l,n,q,t,v,w,y,B):a.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B);var L=Ha(U),Z=Ia(U);if(15===b)return a.Aa?a.Aa(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L):a.Aa?a.Aa(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L):a.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L);var U=Ha(Z),na=Ia(Z);if(16===b)return a.Ba?a.Ba(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U):a.Ba?a.Ba(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U):a.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U);var Z=
Ha(na),Ga=Ia(na);if(17===b)return a.Ca?a.Ca(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z):a.Ca?a.Ca(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z):a.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z);var na=Ha(Ga),Ra=Ia(Ga);if(18===b)return a.Da?a.Da(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na):a.Da?a.Da(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na):a.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na);Ga=Ha(Ra);Ra=Ia(Ra);if(19===b)return a.Ea?a.Ea(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga):a.Ea?a.Ea(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga):a.call(null,
c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga);var wc=Ha(Ra);Ia(Ra);if(20===b)return a.Fa?a.Fa(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga,wc):a.Fa?a.Fa(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga,wc):a.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga,wc);throw Error("Only up to 20 arguments supported on functions");}
var S=function(){function a(a,b,c,d,e){b=ud.n(b,c,d,e);c=a.k;return a.f?(d=qd(b,c+1),d<=c?Ad(a,d,b):a.f(b)):a.apply(a,Rc(b))}function b(a,b,c,d){b=ud.c(b,c,d);c=a.k;return a.f?(d=qd(b,c+1),d<=c?Ad(a,d,b):a.f(b)):a.apply(a,Rc(b))}function c(a,b,c){b=ud.a(b,c);c=a.k;if(a.f){var d=qd(b,c+1);return d<=c?Ad(a,d,b):a.f(b)}return a.apply(a,Rc(b))}function d(a,b){var c=a.k;if(a.f){var d=qd(b,c+1);return d<=c?Ad(a,d,b):a.f(b)}return a.apply(a,Rc(b))}var e=null,f=function(){function a(c,d,e,f,h,w){var y=null;
5<arguments.length&&(y=J(Array.prototype.slice.call(arguments,5),0));return b.call(this,c,d,e,f,h,y)}function b(a,c,d,e,f,h){c=M(c,M(d,M(e,M(f,sd(h)))));d=a.k;return a.f?(e=qd(c,d+1),e<=d?Ad(a,e,c):a.f(c)):a.apply(a,Rc(c))}a.k=5;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=I(a);var e=F(a);a=I(a);var f=F(a);a=I(a);var h=F(a);a=G(a);return b(c,d,e,f,h,a)};a.d=b;return a}(),e=function(e,k,l,n,q,t){switch(arguments.length){case 2:return d.call(this,e,k);case 3:return c.call(this,e,k,l);case 4:return b.call(this,
e,k,l,n);case 5:return a.call(this,e,k,l,n,q);default:return f.d(e,k,l,n,q,J(arguments,5))}throw Error("Invalid arity: "+arguments.length);};e.k=5;e.f=f.f;e.a=d;e.c=c;e.n=b;e.s=a;e.d=f.d;return e}(),Bd=function(){function a(a,b){return!Wb.a(a,b)}var b=null,c=function(){function a(c,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,d,l)}function b(a,c,d){return sa(S.n(Wb,a,c,d))}a.k=2;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=G(a);return b(c,
d,a)};a.d=b;return a}(),b=function(b,e,f){switch(arguments.length){case 1:return!1;case 2:return a.call(this,b,e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;b.b=function(){return!1};b.a=a;b.d=c.d;return b}();function Cd(a){return E(a)?a:null}function Dd(a,b){for(;;){if(null==E(b))return!0;if(r(a.b?a.b(F(b)):a.call(null,F(b)))){var c=a,d=I(b);a=c;b=d}else return u?!1:null}}
function Ed(a,b){for(;;)if(E(b)){var c=a.b?a.b(F(b)):a.call(null,F(b));if(r(c))return c;var c=a,d=I(b);a=c;b=d}else return null}function Fd(a){return a}
function Gd(a){return function(){var b=null,c=function(){function b(a,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,a,d,l)}function c(b,d,e){return sa(S.n(a,b,d,e))}b.k=2;b.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};b.d=c;return b}(),b=function(b,e,f){switch(arguments.length){case 0:return sa(a.o?a.o():a.call(null));case 1:var h=b;return sa(a.b?a.b(h):a.call(null,h));case 2:var h=b,k=e;return sa(a.a?a.a(h,k):a.call(null,
h,k));default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;return b}()}
var Hd=function(){function a(a,b,c){return function(){var d=null,l=function(){function d(a,b,c,e){var f=null;3<arguments.length&&(f=J(Array.prototype.slice.call(arguments,3),0));return k.call(this,a,b,c,f)}function k(d,l,n,q){return a.b?a.b(b.b?b.b(S.s(c,d,l,n,q)):b.call(null,S.s(c,d,l,n,q))):a.call(null,b.b?b.b(S.s(c,d,l,n,q)):b.call(null,S.s(c,d,l,n,q)))}d.k=3;d.f=function(a){var b=F(a);a=I(a);var c=F(a);a=I(a);var d=F(a);a=G(a);return k(b,c,d,a)};d.d=k;return d}(),d=function(d,k,t,v){switch(arguments.length){case 0:return a.b?
a.b(b.b?b.b(c.o?c.o():c.call(null)):b.call(null,c.o?c.o():c.call(null))):a.call(null,b.b?b.b(c.o?c.o():c.call(null)):b.call(null,c.o?c.o():c.call(null)));case 1:var w=d;return a.b?a.b(b.b?b.b(c.b?c.b(w):c.call(null,w)):b.call(null,c.b?c.b(w):c.call(null,w))):a.call(null,b.b?b.b(c.b?c.b(w):c.call(null,w)):b.call(null,c.b?c.b(w):c.call(null,w)));case 2:var w=d,y=k;return a.b?a.b(b.b?b.b(c.a?c.a(w,y):c.call(null,w,y)):b.call(null,c.a?c.a(w,y):c.call(null,w,y))):a.call(null,b.b?b.b(c.a?c.a(w,y):c.call(null,
w,y)):b.call(null,c.a?c.a(w,y):c.call(null,w,y)));case 3:var w=d,y=k,B=t;return a.b?a.b(b.b?b.b(c.c?c.c(w,y,B):c.call(null,w,y,B)):b.call(null,c.c?c.c(w,y,B):c.call(null,w,y,B))):a.call(null,b.b?b.b(c.c?c.c(w,y,B):c.call(null,w,y,B)):b.call(null,c.c?c.c(w,y,B):c.call(null,w,y,B)));default:return l.d(d,k,t,J(arguments,3))}throw Error("Invalid arity: "+arguments.length);};d.k=3;d.f=l.f;return d}()}function b(a,b){return function(){var c=null,d=function(){function c(a,b,e,f){var h=null;3<arguments.length&&
(h=J(Array.prototype.slice.call(arguments,3),0));return d.call(this,a,b,e,h)}function d(c,h,k,l){return a.b?a.b(S.s(b,c,h,k,l)):a.call(null,S.s(b,c,h,k,l))}c.k=3;c.f=function(a){var b=F(a);a=I(a);var c=F(a);a=I(a);var e=F(a);a=G(a);return d(b,c,e,a)};c.d=d;return c}(),c=function(c,h,q,t){switch(arguments.length){case 0:return a.b?a.b(b.o?b.o():b.call(null)):a.call(null,b.o?b.o():b.call(null));case 1:var v=c;return a.b?a.b(b.b?b.b(v):b.call(null,v)):a.call(null,b.b?b.b(v):b.call(null,v));case 2:var v=
c,w=h;return a.b?a.b(b.a?b.a(v,w):b.call(null,v,w)):a.call(null,b.a?b.a(v,w):b.call(null,v,w));case 3:var v=c,w=h,y=q;return a.b?a.b(b.c?b.c(v,w,y):b.call(null,v,w,y)):a.call(null,b.c?b.c(v,w,y):b.call(null,v,w,y));default:return d.d(c,h,q,J(arguments,3))}throw Error("Invalid arity: "+arguments.length);};c.k=3;c.f=d.f;return c}()}var c=null,d=function(){function a(c,d,e,n){var q=null;3<arguments.length&&(q=J(Array.prototype.slice.call(arguments,3),0));return b.call(this,c,d,e,q)}function b(a,c,d,
e){return function(a){return function(){function b(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return c.call(this,d)}function c(b){b=S.a(F(a),b);for(var d=I(a);;)if(d)b=F(d).call(null,b),d=I(d);else return b}b.k=0;b.f=function(a){a=E(a);return c(a)};b.d=c;return b}()}(ed(ud.n(a,c,d,e)))}a.k=3;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=I(a);var e=F(a);a=G(a);return b(c,d,e,a)};a.d=b;return a}(),c=function(c,f,h,k){switch(arguments.length){case 0:return Fd;
case 1:return c;case 2:return b.call(this,c,f);case 3:return a.call(this,c,f,h);default:return d.d(c,f,h,J(arguments,3))}throw Error("Invalid arity: "+arguments.length);};c.k=3;c.f=d.f;c.o=function(){return Fd};c.b=function(a){return a};c.a=b;c.c=a;c.d=d.d;return c}(),Id=function(){function a(a,b,c,d){return function(){function e(a){var b=null;0<arguments.length&&(b=J(Array.prototype.slice.call(arguments,0),0));return q.call(this,b)}function q(e){return S.s(a,b,c,d,e)}e.k=0;e.f=function(a){a=E(a);
return q(a)};e.d=q;return e}()}function b(a,b,c){return function(){function d(a){var b=null;0<arguments.length&&(b=J(Array.prototype.slice.call(arguments,0),0));return e.call(this,b)}function e(d){return S.n(a,b,c,d)}d.k=0;d.f=function(a){a=E(a);return e(a)};d.d=e;return d}()}function c(a,b){return function(){function c(a){var b=null;0<arguments.length&&(b=J(Array.prototype.slice.call(arguments,0),0));return d.call(this,b)}function d(c){return S.c(a,b,c)}c.k=0;c.f=function(a){a=E(a);return d(a)};
c.d=d;return c}()}var d=null,e=function(){function a(c,d,e,f,t){var v=null;4<arguments.length&&(v=J(Array.prototype.slice.call(arguments,4),0));return b.call(this,c,d,e,f,v)}function b(a,c,d,e,f){return function(){function b(a){var c=null;0<arguments.length&&(c=J(Array.prototype.slice.call(arguments,0),0));return h.call(this,c)}function h(b){return S.s(a,c,d,e,td.a(f,b))}b.k=0;b.f=function(a){a=E(a);return h(a)};b.d=h;return b}()}a.k=4;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=I(a);var e=F(a);
a=I(a);var f=F(a);a=G(a);return b(c,d,e,f,a)};a.d=b;return a}(),d=function(d,h,k,l,n){switch(arguments.length){case 1:return d;case 2:return c.call(this,d,h);case 3:return b.call(this,d,h,k);case 4:return a.call(this,d,h,k,l);default:return e.d(d,h,k,l,J(arguments,4))}throw Error("Invalid arity: "+arguments.length);};d.k=4;d.f=e.f;d.b=function(a){return a};d.a=c;d.c=b;d.n=a;d.d=e.d;return d}(),Jd=function(){function a(a,b,c,d){return function(){var l=null,n=function(){function l(a,b,c,d){var e=null;
3<arguments.length&&(e=J(Array.prototype.slice.call(arguments,3),0));return n.call(this,a,b,c,e)}function n(l,q,t,B){return S.s(a,null==l?b:l,null==q?c:q,null==t?d:t,B)}l.k=3;l.f=function(a){var b=F(a);a=I(a);var c=F(a);a=I(a);var d=F(a);a=G(a);return n(b,c,d,a)};l.d=n;return l}(),l=function(l,t,v,w){switch(arguments.length){case 2:var y=l,B=t;return a.a?a.a(null==y?b:y,null==B?c:B):a.call(null,null==y?b:y,null==B?c:B);case 3:var y=l,B=t,L=v;return a.c?a.c(null==y?b:y,null==B?c:B,null==L?d:L):a.call(null,
null==y?b:y,null==B?c:B,null==L?d:L);default:return n.d(l,t,v,J(arguments,3))}throw Error("Invalid arity: "+arguments.length);};l.k=3;l.f=n.f;return l}()}function b(a,b,c){return function(){var d=null,l=function(){function d(a,b,c,e){var f=null;3<arguments.length&&(f=J(Array.prototype.slice.call(arguments,3),0));return k.call(this,a,b,c,f)}function k(d,l,n,q){return S.s(a,null==d?b:d,null==l?c:l,n,q)}d.k=3;d.f=function(a){var b=F(a);a=I(a);var c=F(a);a=I(a);var d=F(a);a=G(a);return k(b,c,d,a)};d.d=
k;return d}(),d=function(d,k,t,v){switch(arguments.length){case 2:var w=d,y=k;return a.a?a.a(null==w?b:w,null==y?c:y):a.call(null,null==w?b:w,null==y?c:y);case 3:var w=d,y=k,B=t;return a.c?a.c(null==w?b:w,null==y?c:y,B):a.call(null,null==w?b:w,null==y?c:y,B);default:return l.d(d,k,t,J(arguments,3))}throw Error("Invalid arity: "+arguments.length);};d.k=3;d.f=l.f;return d}()}function c(a,b){return function(){var c=null,d=function(){function c(a,b,e,f){var h=null;3<arguments.length&&(h=J(Array.prototype.slice.call(arguments,
3),0));return d.call(this,a,b,e,h)}function d(c,h,k,l){return S.s(a,null==c?b:c,h,k,l)}c.k=3;c.f=function(a){var b=F(a);a=I(a);var c=F(a);a=I(a);var e=F(a);a=G(a);return d(b,c,e,a)};c.d=d;return c}(),c=function(c,h,q,t){switch(arguments.length){case 1:var v=c;return a.b?a.b(null==v?b:v):a.call(null,null==v?b:v);case 2:var v=c,w=h;return a.a?a.a(null==v?b:v,w):a.call(null,null==v?b:v,w);case 3:var v=c,w=h,y=q;return a.c?a.c(null==v?b:v,w,y):a.call(null,null==v?b:v,w,y);default:return d.d(c,h,q,J(arguments,
3))}throw Error("Invalid arity: "+arguments.length);};c.k=3;c.f=d.f;return c}()}var d=null,d=function(d,f,h,k){switch(arguments.length){case 2:return c.call(this,d,f);case 3:return b.call(this,d,f,h);case 4:return a.call(this,d,f,h,k)}throw Error("Invalid arity: "+arguments.length);};d.a=c;d.c=b;d.n=a;return d}(),Kd=function(){function a(a,b,c,e){return new V(null,function(){var n=E(b),q=E(c),t=E(e);return n&&q&&t?M(a.c?a.c(F(n),F(q),F(t)):a.call(null,F(n),F(q),F(t)),d.n(a,G(n),G(q),G(t))):null},
null,null)}function b(a,b,c){return new V(null,function(){var e=E(b),n=E(c);return e&&n?M(a.a?a.a(F(e),F(n)):a.call(null,F(e),F(n)),d.c(a,G(e),G(n))):null},null,null)}function c(a,b){return new V(null,function(){var c=E(b);if(c){if(Ic(c)){for(var e=Hb(c),n=O(e),q=new ld(Array(n),0),t=0;;)if(t<n){var v=a.b?a.b(D.a(e,t)):a.call(null,D.a(e,t));q.add(v);t+=1}else break;return pd(q.da(),d.a(a,Ib(c)))}return M(a.b?a.b(F(c)):a.call(null,F(c)),d.a(a,G(c)))}return null},null,null)}var d=null,e=function(){function a(c,
d,e,f,t){var v=null;4<arguments.length&&(v=J(Array.prototype.slice.call(arguments,4),0));return b.call(this,c,d,e,f,v)}function b(a,c,e,f,h){var v=function y(a){return new V(null,function(){var b=d.a(E,a);return Dd(Fd,b)?M(d.a(F,b),y(d.a(G,b))):null},null,null)};return d.a(function(){return function(b){return S.a(a,b)}}(v),v(pc.d(h,f,J([e,c],0))))}a.k=4;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=I(a);var e=F(a);a=I(a);var f=F(a);a=G(a);return b(c,d,e,f,a)};a.d=b;return a}(),d=function(d,h,k,l,
n){switch(arguments.length){case 2:return c.call(this,d,h);case 3:return b.call(this,d,h,k);case 4:return a.call(this,d,h,k,l);default:return e.d(d,h,k,l,J(arguments,4))}throw Error("Invalid arity: "+arguments.length);};d.k=4;d.f=e.f;d.a=c;d.c=b;d.n=a;d.d=e.d;return d}(),Md=function Ld(b,c){return new V(null,function(){if(0<b){var d=E(c);return d?M(F(d),Ld(b-1,G(d))):null}return null},null,null)};
function Nd(a,b){return new V(null,function(c){return function(){return c(a,b)}}(function(a,b){for(;;){var e=E(b);if(0<a&&e){var f=a-1,e=G(e);a=f;b=e}else return e}}),null,null)}
var Od=function(){function a(a,b){return Md(a,c.b(b))}function b(a){return new V(null,function(){return M(a,c.b(a))},null,null)}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),Pd=function(){function a(a,b){return Md(a,c.b(b))}function b(a){return new V(null,function(){return M(a.o?a.o():a.call(null),c.b(a))},null,null)}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,
c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),Qd=function(){function a(a,c){return new V(null,function(){var f=E(a),h=E(c);return f&&h?M(F(f),M(F(h),b.a(G(f),G(h)))):null},null,null)}var b=null,c=function(){function a(b,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,b,d,l)}function c(a,d,e){return new V(null,function(){var c=Kd.a(E,pc.d(e,d,J([a],0)));return Dd(Fd,c)?td.a(Kd.a(F,
c),S.a(b,Kd.a(G,c))):null},null,null)}a.k=2;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};a.d=c;return a}(),b=function(b,e,f){switch(arguments.length){case 2:return a.call(this,b,e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;b.a=a;b.d=c.d;return b}();function Rd(a){return function c(a,e){return new V(null,function(){var f=E(a);return f?M(F(f),c(G(f),e)):E(e)?c(F(e),G(e)):null},null,null)}(null,a)}
var Sd=function(){function a(a,b){return Rd(Kd.a(a,b))}var b=null,c=function(){function a(c,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,d,l)}function b(a,c,d){return Rd(S.n(Kd,a,c,d))}a.k=2;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=G(a);return b(c,d,a)};a.d=b;return a}(),b=function(b,e,f){switch(arguments.length){case 2:return a.call(this,b,e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};
b.k=2;b.f=c.f;b.a=a;b.d=c.d;return b}(),Ud=function Td(b,c){return new V(null,function(){var d=E(c);if(d){if(Ic(d)){for(var e=Hb(d),f=O(e),h=new ld(Array(f),0),k=0;;)if(k<f){if(r(b.b?b.b(D.a(e,k)):b.call(null,D.a(e,k)))){var l=D.a(e,k);h.add(l)}k+=1}else break;return pd(h.da(),Td(b,Ib(d)))}e=F(d);d=G(d);return r(b.b?b.b(e):b.call(null,e))?M(e,Td(b,d)):Td(b,d)}return null},null,null)};function Vd(a,b){return Ud(Gd(a),b)}
function Wd(a){var b=Xd;return function d(a){return new V(null,function(){return M(a,r(b.b?b.b(a):b.call(null,a))?Sd.a(d,E.b?E.b(a):E.call(null,a)):null)},null,null)}(a)}function Yd(a,b){return null!=a?a&&(a.q&4||a.Bc)?vd(C.c(zb,yb(a),b)):C.c(Da,a,b):C.c(pc,H,b)}
var Zd=function(){function a(a,b,c,k){return new V(null,function(){var l=E(k);if(l){var n=Md(a,l);return a===O(n)?M(n,d.n(a,b,c,Nd(b,l))):Da(H,Md(a,td.a(n,c)))}return null},null,null)}function b(a,b,c){return new V(null,function(){var k=E(c);if(k){var l=Md(a,k);return a===O(l)?M(l,d.c(a,b,Nd(b,k))):null}return null},null,null)}function c(a,b){return d.c(a,a,b)}var d=null,d=function(d,f,h,k){switch(arguments.length){case 2:return c.call(this,d,f);case 3:return b.call(this,d,f,h);case 4:return a.call(this,
d,f,h,k)}throw Error("Invalid arity: "+arguments.length);};d.a=c;d.c=b;d.n=a;return d}(),$d=function(){function a(a,b,c){var h=Lc;for(b=E(b);;)if(b){var k=a;if(k?k.i&256||k.Mb||(k.i?0:s(Ka,k)):s(Ka,k)){a=Q.c(a,F(b),h);if(h===a)return c;b=I(b)}else return c}else return a}function b(a,b){return c.c(a,b,null)}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}(),ae=
function(){function a(a,b,c,d,f,t){var v=P.c(b,0,null);return(b=$c(b))?R.c(a,v,e.X(Q.a(a,v),b,c,d,f,t)):R.c(a,v,c.n?c.n(Q.a(a,v),d,f,t):c.call(null,Q.a(a,v),d,f,t))}function b(a,b,c,d,f){var t=P.c(b,0,null);return(b=$c(b))?R.c(a,t,e.s(Q.a(a,t),b,c,d,f)):R.c(a,t,c.c?c.c(Q.a(a,t),d,f):c.call(null,Q.a(a,t),d,f))}function c(a,b,c,d){var f=P.c(b,0,null);return(b=$c(b))?R.c(a,f,e.n(Q.a(a,f),b,c,d)):R.c(a,f,c.a?c.a(Q.a(a,f),d):c.call(null,Q.a(a,f),d))}function d(a,b,c){var d=P.c(b,0,null);return(b=$c(b))?
R.c(a,d,e.c(Q.a(a,d),b,c)):R.c(a,d,c.b?c.b(Q.a(a,d)):c.call(null,Q.a(a,d)))}var e=null,f=function(){function a(c,d,e,f,h,w,y){var B=null;6<arguments.length&&(B=J(Array.prototype.slice.call(arguments,6),0));return b.call(this,c,d,e,f,h,w,B)}function b(a,c,d,f,h,k,y){var B=P.c(c,0,null);return(c=$c(c))?R.c(a,B,S.d(e,Q.a(a,B),c,d,f,J([h,k,y],0))):R.c(a,B,S.d(d,Q.a(a,B),f,h,k,J([y],0)))}a.k=6;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=I(a);var e=F(a);a=I(a);var f=F(a);a=I(a);var h=F(a);a=I(a);var y=
F(a);a=G(a);return b(c,d,e,f,h,y,a)};a.d=b;return a}(),e=function(e,k,l,n,q,t,v){switch(arguments.length){case 3:return d.call(this,e,k,l);case 4:return c.call(this,e,k,l,n);case 5:return b.call(this,e,k,l,n,q);case 6:return a.call(this,e,k,l,n,q,t);default:return f.d(e,k,l,n,q,t,J(arguments,6))}throw Error("Invalid arity: "+arguments.length);};e.k=6;e.f=f.f;e.c=d;e.n=c;e.s=b;e.X=a;e.d=f.d;return e}();function be(a,b){this.t=a;this.e=b}
function ce(a){return new be(a,[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null])}function de(a){return new be(a.t,va(a.e))}function ee(a){a=a.g;return 32>a?0:a-1>>>5<<5}function fe(a,b,c){for(;;){if(0===b)return c;var d=ce(a);d.e[0]=c;c=d;b-=5}}var he=function ge(b,c,d,e){var f=de(d),h=b.g-1>>>c&31;5===c?f.e[h]=e:(d=d.e[h],b=null!=d?ge(b,c-5,d,e):fe(null,c-5,e),f.e[h]=b);return f};
function ie(a,b){throw Error("No item "+A.b(a)+" in vector of length "+A.b(b));}function je(a){var b=a.root;for(a=a.shift;;)if(0<a)a-=5,b=b.e[0];else return b.e}function ke(a,b){if(b>=ee(a))return a.R;for(var c=a.root,d=a.shift;;)if(0<d)var e=d-5,c=c.e[b>>>d&31],d=e;else return c.e}function le(a,b){return 0<=b&&b<a.g?ke(a,b):ie(b,a.g)}
var ne=function me(b,c,d,e,f){var h=de(d);if(0===c)h.e[e&31]=f;else{var k=e>>>c&31;b=me(b,c-5,d.e[k],e,f);h.e[k]=b}return h},pe=function oe(b,c,d){var e=b.g-2>>>c&31;if(5<c){b=oe(b,c-5,d.e[e]);if(null==b&&0===e)return null;d=de(d);d.e[e]=b;return d}return 0===e?null:u?(d=de(d),d.e[e]=null,d):null};function W(a,b,c,d,e,f){this.j=a;this.g=b;this.shift=c;this.root=d;this.R=e;this.m=f;this.i=167668511;this.q=8196}g=W.prototype;g.toString=function(){return Lb(this)};
g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){return"number"===typeof b?D.c(this,b,c):c};g.Za=function(a,b,c){a=[0,c];for(c=0;;)if(c<this.g){var d=ke(this,c),e=d.length;a:{for(var f=0,h=a[1];;)if(f<e){h=b.c?b.c(h,f+c,d[f]):b.call(null,h,f+c,d[f]);if(fc(h)){d=h;break a}f+=1}else{a[0]=e;d=a[1]=h;break a}d=void 0}if(fc(d))return K.b?K.b(d):K.call(null,d);c+=a[0]}else return a[1]};g.J=function(a,b){return le(this,b)[b&31]};
g.aa=function(a,b,c){return 0<=b&&b<this.g?ke(this,b)[b&31]:c};g.Pa=function(a,b,c){if(0<=b&&b<this.g)return ee(this)<=b?(a=va(this.R),a[b&31]=c,new W(this.j,this.g,this.shift,this.root,a,null)):new W(this.j,this.g,this.shift,ne(this,this.shift,this.root,b,c),this.R,null);if(b===this.g)return Da(this,c);if(u)throw Error("Index "+A.b(b)+" out of bounds  [0,"+A.b(this.g)+"]");return null};g.D=function(){return this.j};g.L=function(){return this.g};g.$a=function(){return D.a(this,0)};
g.ab=function(){return D.a(this,1)};g.Ia=function(){return 0<this.g?D.a(this,this.g-1):null};g.Ja=function(){if(0===this.g)throw Error("Can't pop empty vector");if(1===this.g)return eb(qe,this.j);if(1<this.g-ee(this))return new W(this.j,this.g-1,this.shift,this.root,this.R.slice(0,-1),null);if(u){var a=ke(this,this.g-2),b=pe(this,this.shift,this.root),b=null==b?X:b,c=this.g-1;return 5<this.shift&&null==b.e[1]?new W(this.j,c,this.shift-5,b.e[0],a,null):new W(this.j,c,this.shift,b,a,null)}return null};
g.Xa=function(){return 0<this.g?new kc(this,this.g-1,null):null};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.Wa=function(){return new re(this.g,this.shift,se.b?se.b(this.root):se.call(null,this.root),te.b?te.b(this.R):te.call(null,this.R))};g.I=function(){return N(qe,this.j)};g.N=function(a,b){return gc.a(this,b)};g.M=function(a,b,c){return gc.c(this,b,c)};
g.ua=function(a,b,c){if("number"===typeof b)return $a(this,b,c);throw Error("Vector's key for assoc must be a number.");};g.H=function(){return 0===this.g?null:32>=this.g?new ac(this.R,0):u?ue.n?ue.n(this,je(this),0,0):ue.call(null,this,je(this),0,0):null};g.F=function(a,b){return new W(b,this.g,this.shift,this.root,this.R,this.m)};
g.G=function(a,b){if(32>this.g-ee(this)){for(var c=this.R.length,d=Array(c+1),e=0;;)if(e<c)d[e]=this.R[e],e+=1;else break;d[c]=b;return new W(this.j,this.g+1,this.shift,this.root,d,null)}c=(d=this.g>>>5>1<<this.shift)?this.shift+5:this.shift;d?(d=ce(null),d.e[0]=this.root,e=fe(null,this.shift,new be(null,this.R)),d.e[1]=e):d=he(this,this.shift,this.root,new be(null,this.R));return new W(this.j,this.g+1,c,d,[b],null)};
g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.J(null,c);case 3:return this.aa(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return this.J(null,a)};g.a=function(a,b){return this.aa(null,a,b)};
var X=new be(null,[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]),qe=new W(null,0,5,X,[],0);function ve(a,b){var c=a.length,d=b?a:va(a);if(32>c)return new W(null,c,5,X,d,null);for(var e=32,f=(new W(null,32,5,X,d.slice(0,32),null)).Wa(null);;)if(e<c)var h=e+1,f=wd.a(f,d[e]),e=h;else return Ab(f)}function we(a){return Ab(C.c(zb,yb(qe),a))}
var xe=function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){return a instanceof ac&&0===a.p?ve.a?ve.a(a.e,!0):ve.call(null,a.e,!0):we(a)}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}();function ye(a,b,c,d,e,f){this.P=a;this.ea=b;this.p=c;this.O=d;this.j=e;this.m=f;this.i=32243948;this.q=1536}g=ye.prototype;g.toString=function(){return Lb(this)};
g.U=function(){if(this.O+1<this.ea.length){var a=ue.n?ue.n(this.P,this.ea,this.p,this.O+1):ue.call(null,this.P,this.ea,this.p,this.O+1);return null==a?null:a}return Jb(this)};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(qe,this.j)};g.N=function(a,b){return gc.a(ze.c?ze.c(this.P,this.p+this.O,O(this.P)):ze.call(null,this.P,this.p+this.O,O(this.P)),b)};
g.M=function(a,b,c){return gc.c(ze.c?ze.c(this.P,this.p+this.O,O(this.P)):ze.call(null,this.P,this.p+this.O,O(this.P)),b,c)};g.Q=function(){return this.ea[this.O]};g.S=function(){if(this.O+1<this.ea.length){var a=ue.n?ue.n(this.P,this.ea,this.p,this.O+1):ue.call(null,this.P,this.ea,this.p,this.O+1);return null==a?H:a}return Ib(this)};g.H=function(){return this};g.sb=function(){return nd.a(this.ea,this.O)};
g.tb=function(){var a=this.p+this.ea.length;return a<Aa(this.P)?ue.n?ue.n(this.P,ke(this.P,a),a,0):ue.call(null,this.P,ke(this.P,a),a,0):H};g.F=function(a,b){return ue.s?ue.s(this.P,this.ea,this.p,this.O,b):ue.call(null,this.P,this.ea,this.p,this.O,b)};g.G=function(a,b){return M(b,this)};g.rb=function(){var a=this.p+this.ea.length;return a<Aa(this.P)?ue.n?ue.n(this.P,ke(this.P,a),a,0):ue.call(null,this.P,ke(this.P,a),a,0):null};
var ue=function(){function a(a,b,c,d,l){return new ye(a,b,c,d,l,null)}function b(a,b,c,d){return new ye(a,b,c,d,null,null)}function c(a,b,c){return new ye(a,le(a,b),b,c,null,null)}var d=null,d=function(d,f,h,k,l){switch(arguments.length){case 3:return c.call(this,d,f,h);case 4:return b.call(this,d,f,h,k);case 5:return a.call(this,d,f,h,k,l)}throw Error("Invalid arity: "+arguments.length);};d.c=c;d.n=b;d.s=a;return d}();
function Ae(a,b,c,d,e){this.j=a;this.ca=b;this.start=c;this.end=d;this.m=e;this.i=166617887;this.q=8192}g=Ae.prototype;g.toString=function(){return Lb(this)};g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){return"number"===typeof b?D.c(this,b,c):c};g.J=function(a,b){return 0>b||this.end<=this.start+b?ie(b,this.end-this.start):D.a(this.ca,this.start+b)};g.aa=function(a,b,c){return 0>b||this.end<=this.start+b?c:D.c(this.ca,this.start+b,c)};
g.Pa=function(a,b,c){var d=this,e=d.start+b;return Be.s?Be.s(d.j,R.c(d.ca,e,c),d.start,function(){var a=d.end,b=e+1;return a>b?a:b}(),null):Be.call(null,d.j,R.c(d.ca,e,c),d.start,function(){var a=d.end,b=e+1;return a>b?a:b}(),null)};g.D=function(){return this.j};g.L=function(){return this.end-this.start};g.Ia=function(){return D.a(this.ca,this.end-1)};
g.Ja=function(){if(this.start===this.end)throw Error("Can't pop empty vector");return Be.s?Be.s(this.j,this.ca,this.start,this.end-1,null):Be.call(null,this.j,this.ca,this.start,this.end-1,null)};g.Xa=function(){return this.start!==this.end?new kc(this,this.end-this.start-1,null):null};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(qe,this.j)};g.N=function(a,b){return gc.a(this,b)};
g.M=function(a,b,c){return gc.c(this,b,c)};g.ua=function(a,b,c){if("number"===typeof b)return $a(this,b,c);throw Error("Subvec's key for assoc must be a number.");};g.H=function(){var a=this;return function(b){return function d(e){return e===a.end?null:M(D.a(a.ca,e),new V(null,function(){return function(){return d(e+1)}}(b),null,null))}}(this)(a.start)};g.F=function(a,b){return Be.s?Be.s(b,this.ca,this.start,this.end,this.m):Be.call(null,b,this.ca,this.start,this.end,this.m)};
g.G=function(a,b){return Be.s?Be.s(this.j,$a(this.ca,this.end,b),this.start,this.end+1,null):Be.call(null,this.j,$a(this.ca,this.end,b),this.start,this.end+1,null)};g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.J(null,c);case 3:return this.aa(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return this.J(null,a)};
g.a=function(a,b){return this.aa(null,a,b)};function Be(a,b,c,d,e){for(;;)if(b instanceof Ae)c=b.start+c,d=b.start+d,b=b.ca;else{var f=O(b);if(0>c||0>d||c>f||d>f)throw Error("Index out of bounds");return new Ae(a,b,c,d,e)}}
var ze=function(){function a(a,b,c){return Be(null,a,b,c,null)}function b(a,b){return c.c(a,b,O(a))}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}();function Ce(a,b){return a===b.t?b:new be(a,va(b.e))}function se(a){return new be({},va(a.e))}
function te(a){var b=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];Kc(a,0,b,0,a.length);return b}
var Ee=function De(b,c,d,e){d=Ce(b.root.t,d);var f=b.g-1>>>c&31;if(5===c)b=e;else{var h=d.e[f];b=null!=h?De(b,c-5,h,e):fe(b.root.t,c-5,e)}d.e[f]=b;return d},Ge=function Fe(b,c,d){d=Ce(b.root.t,d);var e=b.g-2>>>c&31;if(5<c){b=Fe(b,c-5,d.e[e]);if(null==b&&0===e)return null;d.e[e]=b;return d}return 0===e?null:u?(d.e[e]=null,d):null};function re(a,b,c,d){this.g=a;this.shift=b;this.root=c;this.R=d;this.i=275;this.q=88}g=re.prototype;
g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.u(null,c);case 3:return this.C(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return this.u(null,a)};g.a=function(a,b){return this.C(null,a,b)};g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){return"number"===typeof b?D.c(this,b,c):c};
g.J=function(a,b){if(this.root.t)return le(this,b)[b&31];throw Error("nth after persistent!");};g.aa=function(a,b,c){return 0<=b&&b<this.g?D.a(this,b):c};g.L=function(){if(this.root.t)return this.g;throw Error("count after persistent!");};
g.Pb=function(a,b,c){var d=this;if(d.root.t){if(0<=b&&b<d.g)return ee(this)<=b?d.R[b&31]=c:(a=function(){return function f(a,k){var l=Ce(d.root.t,k);if(0===a)l.e[b&31]=c;else{var n=b>>>a&31,q=f(a-5,l.e[n]);l.e[n]=q}return l}}(this).call(null,d.shift,d.root),d.root=a),this;if(b===d.g)return zb(this,c);if(u)throw Error("Index "+A.b(b)+" out of bounds for TransientVector of length"+A.b(d.g));return null}throw Error("assoc! after persistent!");};
g.Qb=function(){if(this.root.t){if(0===this.g)throw Error("Can't pop empty vector");if(1===this.g)return this.g=0,this;if(0<(this.g-1&31))return this.g-=1,this;if(u){var a;a:if(a=this.g-2,a>=ee(this))a=this.R;else{for(var b=this.root,c=b,d=this.shift;;)if(0<d)c=Ce(b.t,c.e[a>>>d&31]),d-=5;else{a=c.e;break a}a=void 0}b=Ge(this,this.shift,this.root);b=null!=b?b:new be(this.root.t,[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,
null,null,null,null,null,null,null,null]);5<this.shift&&null==b.e[1]?(this.root=Ce(this.root.t,b.e[0]),this.shift-=5):this.root=b;this.g-=1;this.R=a;return this}return null}throw Error("pop! after persistent!");};g.cb=function(a,b,c){if("number"===typeof b)return Db(this,b,c);throw Error("TransientVector's key for assoc! must be a number.");};
g.Ka=function(a,b){if(this.root.t){if(32>this.g-ee(this))this.R[this.g&31]=b;else{var c=new be(this.root.t,this.R),d=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];d[0]=b;this.R=d;if(this.g>>>5>1<<this.shift){var d=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],e=this.shift+
5;d[0]=this.root;d[1]=fe(this.root.t,this.shift,c);this.root=new be(this.root.t,d);this.shift=e}else this.root=Ee(this,this.shift,this.root,c)}this.g+=1;return this}throw Error("conj! after persistent!");};g.Oa=function(){if(this.root.t){this.root.t=null;var a=this.g-ee(this),b=Array(a);Kc(this.R,0,b,0,a);return new W(null,this.g,this.shift,this.root,b,null)}throw Error("persistent! called twice");};function He(a,b,c,d){this.j=a;this.ba=b;this.pa=c;this.m=d;this.q=0;this.i=31850572}g=He.prototype;
g.toString=function(){return Lb(this)};g.D=function(){return this.j};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.j)};g.Q=function(){return F(this.ba)};g.S=function(){var a=I(this.ba);return a?new He(this.j,a,this.pa,null):null==this.pa?Ba(this):new He(this.j,this.pa,null,null)};g.H=function(){return this};g.F=function(a,b){return new He(b,this.ba,this.pa,this.m)};g.G=function(a,b){return M(b,this)};
function Ie(a,b,c,d,e){this.j=a;this.count=b;this.ba=c;this.pa=d;this.m=e;this.i=31858766;this.q=8192}g=Ie.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.j};g.L=function(){return this.count};g.Ia=function(){return F(this.ba)};g.Ja=function(){if(r(this.ba)){var a=I(this.ba);return a?new Ie(this.j,this.count-1,a,this.pa,null):new Ie(this.j,this.count-1,E(this.pa),qe,null)}return this};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};
g.v=function(a,b){return lc(this,b)};g.I=function(){return Je};g.Q=function(){return F(this.ba)};g.S=function(){return G(E(this))};g.H=function(){var a=E(this.pa),b=this.ba;return r(r(b)?b:a)?new He(null,this.ba,E(a),null):null};g.F=function(a,b){return new Ie(b,this.count,this.ba,this.pa,this.m)};g.G=function(a,b){var c;r(this.ba)?(c=this.pa,c=new Ie(this.j,this.count+1,this.ba,pc.a(r(c)?c:qe,b),null)):c=new Ie(this.j,this.count+1,pc.a(this.ba,b),qe,null);return c};var Je=new Ie(null,0,null,qe,0);
function Ke(){this.q=0;this.i=2097152}Ke.prototype.v=function(){return!1};var Le=new Ke;function Me(a,b){return Nc(Gc(b)?O(a)===O(b)?Dd(Fd,Kd.a(function(a){return Wb.a(Q.c(b,F(a),Le),F(I(a)))},a)):null:null)}function Ne(a){this.r=a}Ne.prototype.next=function(){if(null!=this.r){var a=F(this.r);this.r=I(this.r);return{done:!1,value:a}}return{done:!0,value:null}};function Oe(a){return new Ne(E(a))}function Pe(a){this.r=a}
Pe.prototype.next=function(){if(null!=this.r){var a=F(this.r),b=P.c(a,0,null),a=P.c(a,1,null);this.r=I(this.r);return{done:!1,value:[b,a]}}return{done:!0,value:null}};function Qe(a){return new Pe(E(a))}function Re(a){this.r=a}Re.prototype.next=function(){if(null!=this.r){var a=F(this.r);this.r=I(this.r);return{done:!1,value:[a,a]}}return{done:!0,value:null}};function Se(a){return new Re(E(a))}
function Te(a,b){var c=a.e;if(b instanceof T)a:{for(var d=c.length,e=b.sa,f=0;;){if(d<=f){c=-1;break a}var h=c[f];if(h instanceof T&&e===h.sa){c=f;break a}if(u)f+=2;else{c=null;break a}}c=void 0}else if("string"==typeof b||"number"===typeof b)a:{d=c.length;for(e=0;;){if(d<=e){c=-1;break a}if(b===c[e]){c=e;break a}if(u)e+=2;else{c=null;break a}}c=void 0}else if(b instanceof Zb)a:{d=c.length;e=b.Na;for(f=0;;){if(d<=f){c=-1;break a}h=c[f];if(h instanceof Zb&&e===h.Na){c=f;break a}if(u)f+=2;else{c=null;
break a}}c=void 0}else if(null==b)a:{d=c.length;for(e=0;;){if(d<=e){c=-1;break a}if(null==c[e]){c=e;break a}if(u)e+=2;else{c=null;break a}}c=void 0}else if(u)a:{d=c.length;for(e=0;;){if(d<=e){c=-1;break a}if(Wb.a(b,c[e])){c=e;break a}if(u)e+=2;else{c=null;break a}}c=void 0}else c=null;return c}function Ue(a,b,c){this.e=a;this.p=b;this.W=c;this.q=0;this.i=32374990}g=Ue.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.W};
g.U=function(){return this.p<this.e.length-2?new Ue(this.e,this.p+2,this.W):null};g.L=function(){return(this.e.length-this.p)/2};g.B=function(){return cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.W)};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return new W(null,2,5,X,[this.e[this.p],this.e[this.p+1]],null)};g.S=function(){return this.p<this.e.length-2?new Ue(this.e,this.p+2,this.W):H};g.H=function(){return this};
g.F=function(a,b){return new Ue(this.e,this.p,b)};g.G=function(a,b){return M(b,this)};function la(a,b,c,d){this.j=a;this.g=b;this.e=c;this.m=d;this.i=16647951;this.q=8196}g=la.prototype;g.toString=function(){return Lb(this)};g.keys=function(){return Oe(Ve.b?Ve.b(this):Ve.call(null,this))};g.entries=function(){return Qe(E(this))};g.values=function(){return Oe(We.b?We.b(this):We.call(null,this))};g.has=function(a){return Oc(this,a)};g.get=function(a){return this.u(null,a)};
g.forEach=function(a){for(var b=E(this),c=null,d=0,e=0;;)if(e<d){var f=c.J(null,e),h=P.c(f,0,null),f=P.c(f,1,null);a.a?a.a(f,h):a.call(null,f,h);e+=1}else if(b=E(b))Ic(b)?(c=Hb(b),b=Ib(b),h=c,d=O(c),c=h):(c=F(b),h=P.c(c,0,null),f=P.c(c,1,null),a.a?a.a(f,h):a.call(null,f,h),b=I(b),c=null,d=0),e=0;else return null};g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){a=Te(this,b);return-1===a?c:this.e[a+1]};
g.Za=function(a,b,c){a=this.e.length;for(var d=0;;)if(d<a){c=b.c?b.c(c,this.e[d],this.e[d+1]):b.call(null,c,this.e[d],this.e[d+1]);if(fc(c))return K.b?K.b(c):K.call(null,c);d+=2}else return c};g.D=function(){return this.j};g.L=function(){return this.g};g.B=function(){var a=this.m;return null!=a?a:this.m=a=dc(this)};g.v=function(a,b){return Me(this,b)};g.Wa=function(){return new Xe({},this.e.length,va(this.e))};g.I=function(){return eb(Ye,this.j)};g.N=function(a,b){return nc.a(b,this)};
g.M=function(a,b,c){return nc.c(b,c,this)};g.nb=function(a,b){if(0<=Te(this,b)){var c=this.e.length,d=c-2;if(0===d)return Ba(this);for(var d=Array(d),e=0,f=0;;){if(e>=c)return new la(this.j,this.g-1,d,null);if(Wb.a(b,this.e[e]))e+=2;else if(u)d[f]=this.e[e],d[f+1]=this.e[e+1],f+=2,e+=2;else return null}}else return this};
g.ua=function(a,b,c){a=Te(this,b);if(-1===a){if(this.g<Ze){a=this.e;for(var d=a.length,e=Array(d+2),f=0;;)if(f<d)e[f]=a[f],f+=1;else break;e[d]=b;e[d+1]=c;return new la(this.j,this.g+1,e,null)}return eb(Oa(Yd($e,this),b,c),this.j)}return c===this.e[a+1]?this:u?(b=va(this.e),b[a+1]=c,new la(this.j,this.g,b,null)):null};g.kb=function(a,b){return-1!==Te(this,b)};g.H=function(){var a=this.e;return 0<=a.length-2?new Ue(a,0,null):null};g.F=function(a,b){return new la(b,this.g,this.e,this.m)};
g.G=function(a,b){if(Hc(b))return Oa(this,D.a(b,0),D.a(b,1));for(var c=this,d=E(b);;){if(null==d)return c;var e=F(d);if(Hc(e))c=Oa(c,D.a(e,0),D.a(e,1)),d=I(d);else throw Error("conj on a map takes map entries or seqables of map entries");}};g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.u(null,c);case 3:return this.C(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};
g.b=function(a){return this.u(null,a)};g.a=function(a,b){return this.C(null,a,b)};var Ye=new la(null,0,[],null),Ze=8;function af(a){for(var b=a.length,c=0,d=yb(Ye);;)if(c<b)var e=c+2,d=Bb(d,a[c],a[c+1]),c=e;else return Ab(d)}function Xe(a,b,c){this.Ra=a;this.ja=b;this.e=c;this.q=56;this.i=258}g=Xe.prototype;
g.Ab=function(a,b){if(r(this.Ra)){var c=Te(this,b);0<=c&&(this.e[c]=this.e[this.ja-2],this.e[c+1]=this.e[this.ja-1],c=this.e,c.pop(),c.pop(),this.ja-=2);return this}throw Error("dissoc! after persistent!");};g.cb=function(a,b,c){if(r(this.Ra)){a=Te(this,b);if(-1===a)return this.ja+2<=2*Ze?(this.ja+=2,this.e.push(b),this.e.push(c),this):xd.c(bf.a?bf.a(this.ja,this.e):bf.call(null,this.ja,this.e),b,c);c!==this.e[a+1]&&(this.e[a+1]=c);return this}throw Error("assoc! after persistent!");};
g.Ka=function(a,b){if(r(this.Ra)){if(b?b.i&2048||b.dc||(b.i?0:s(Sa,b)):s(Sa,b))return Bb(this,cf.b?cf.b(b):cf.call(null,b),df.b?df.b(b):df.call(null,b));for(var c=E(b),d=this;;){var e=F(c);if(r(e))c=I(c),d=Bb(d,cf.b?cf.b(e):cf.call(null,e),df.b?df.b(e):df.call(null,e));else return d}}else throw Error("conj! after persistent!");};g.Oa=function(){if(r(this.Ra))return this.Ra=!1,new la(null,Yc(this.ja),this.e,null);throw Error("persistent! called twice");};g.u=function(a,b){return La.c(this,b,null)};
g.C=function(a,b,c){if(r(this.Ra))return a=Te(this,b),-1===a?c:this.e[a+1];throw Error("lookup after persistent!");};g.L=function(){if(r(this.Ra))return Yc(this.ja);throw Error("count after persistent!");};function bf(a,b){for(var c=yb($e),d=0;;)if(d<a)c=xd.c(c,b[d],b[d+1]),d+=2;else return c}function ef(){this.l=!1}function ff(a,b){return a===b?!0:hd(a,b)?!0:u?Wb.a(a,b):null}
var gf=function(){function a(a,b,c,h,k){a=va(a);a[b]=c;a[h]=k;return a}function b(a,b,c){a=va(a);a[b]=c;return a}var c=null,c=function(c,e,f,h,k){switch(arguments.length){case 3:return b.call(this,c,e,f);case 5:return a.call(this,c,e,f,h,k)}throw Error("Invalid arity: "+arguments.length);};c.c=b;c.s=a;return c}();function hf(a,b){var c=Array(a.length-2);Kc(a,0,c,0,2*b);Kc(a,2*(b+1),c,2*b,c.length-2*b);return c}
var jf=function(){function a(a,b,c,h,k,l){a=a.La(b);a.e[c]=h;a.e[k]=l;return a}function b(a,b,c,h){a=a.La(b);a.e[c]=h;return a}var c=null,c=function(c,e,f,h,k,l){switch(arguments.length){case 4:return b.call(this,c,e,f,h);case 6:return a.call(this,c,e,f,h,k,l)}throw Error("Invalid arity: "+arguments.length);};c.n=b;c.X=a;return c}();
function kf(a,b,c){for(var d=a.length,e=0;;)if(e<d){var f=a[e];null!=f?c=b.c?b.c(c,f,a[e+1]):b.call(null,c,f,a[e+1]):(f=a[e+1],c=null!=f?f.Ta(b,c):c);if(fc(c))return K.b?K.b(c):K.call(null,c);e+=2}else return c}function lf(a,b,c){this.t=a;this.A=b;this.e=c}g=lf.prototype;g.La=function(a){if(a===this.t)return this;var b=Zc(this.A),c=Array(0>b?4:2*(b+1));Kc(this.e,0,c,0,2*b);return new lf(a,this.A,c)};
g.gb=function(a,b,c,d,e){var f=1<<(c>>>b&31);if(0===(this.A&f))return this;var h=Zc(this.A&f-1),k=this.e[2*h],l=this.e[2*h+1];return null==k?(b=l.gb(a,b+5,c,d,e),b===l?this:null!=b?jf.n(this,a,2*h+1,b):this.A===f?null:u?mf(this,a,f,h):null):ff(d,k)?(e[0]=!0,mf(this,a,f,h)):u?this:null};function mf(a,b,c,d){if(a.A===c)return null;a=a.La(b);b=a.e;var e=b.length;a.A^=c;Kc(b,2*(d+1),b,2*d,e-2*(d+1));b[e-2]=null;b[e-1]=null;return a}g.eb=function(){return nf.b?nf.b(this.e):nf.call(null,this.e)};
g.Ta=function(a,b){return kf(this.e,a,b)};g.Ma=function(a,b,c,d){var e=1<<(b>>>a&31);if(0===(this.A&e))return d;var f=Zc(this.A&e-1),e=this.e[2*f],f=this.e[2*f+1];return null==e?f.Ma(a+5,b,c,d):ff(c,e)?f:u?d:null};
g.ia=function(a,b,c,d,e,f){var h=1<<(c>>>b&31),k=Zc(this.A&h-1);if(0===(this.A&h)){var l=Zc(this.A);if(2*l<this.e.length){a=this.La(a);b=a.e;f.l=!0;a:for(c=2*(l-k),f=2*k+(c-1),l=2*(k+1)+(c-1);;){if(0===c)break a;b[l]=b[f];l-=1;c-=1;f-=1}b[2*k]=d;b[2*k+1]=e;a.A|=h;return a}if(16<=l){k=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];k[c>>>b&31]=of.ia(a,b+5,c,d,e,f);for(e=d=0;;)if(32>d)0!==
(this.A>>>d&1)&&(k[d]=null!=this.e[e]?of.ia(a,b+5,Tb(this.e[e]),this.e[e],this.e[e+1],f):this.e[e+1],e+=2),d+=1;else break;return new pf(a,l+1,k)}return u?(b=Array(2*(l+4)),Kc(this.e,0,b,0,2*k),b[2*k]=d,b[2*k+1]=e,Kc(this.e,2*k,b,2*(k+1),2*(l-k)),f.l=!0,a=this.La(a),a.e=b,a.A|=h,a):null}l=this.e[2*k];h=this.e[2*k+1];return null==l?(l=h.ia(a,b+5,c,d,e,f),l===h?this:jf.n(this,a,2*k+1,l)):ff(d,l)?e===h?this:jf.n(this,a,2*k+1,e):u?(f.l=!0,jf.X(this,a,2*k,null,2*k+1,qf.ga?qf.ga(a,b+5,l,h,c,d,e):qf.call(null,
a,b+5,l,h,c,d,e))):null};
g.ha=function(a,b,c,d,e){var f=1<<(b>>>a&31),h=Zc(this.A&f-1);if(0===(this.A&f)){var k=Zc(this.A);if(16<=k){h=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];h[b>>>a&31]=of.ha(a+5,b,c,d,e);for(d=c=0;;)if(32>c)0!==(this.A>>>c&1)&&(h[c]=null!=this.e[d]?of.ha(a+5,Tb(this.e[d]),this.e[d],this.e[d+1],e):this.e[d+1],d+=2),c+=1;else break;return new pf(null,k+1,h)}a=Array(2*(k+1));Kc(this.e,
0,a,0,2*h);a[2*h]=c;a[2*h+1]=d;Kc(this.e,2*h,a,2*(h+1),2*(k-h));e.l=!0;return new lf(null,this.A|f,a)}k=this.e[2*h];f=this.e[2*h+1];return null==k?(k=f.ha(a+5,b,c,d,e),k===f?this:new lf(null,this.A,gf.c(this.e,2*h+1,k))):ff(c,k)?d===f?this:new lf(null,this.A,gf.c(this.e,2*h+1,d)):u?(e.l=!0,new lf(null,this.A,gf.s(this.e,2*h,null,2*h+1,qf.X?qf.X(a+5,k,f,b,c,d):qf.call(null,a+5,k,f,b,c,d)))):null};
g.fb=function(a,b,c){var d=1<<(b>>>a&31);if(0===(this.A&d))return this;var e=Zc(this.A&d-1),f=this.e[2*e],h=this.e[2*e+1];return null==f?(a=h.fb(a+5,b,c),a===h?this:null!=a?new lf(null,this.A,gf.c(this.e,2*e+1,a)):this.A===d?null:u?new lf(null,this.A^d,hf(this.e,e)):null):ff(c,f)?new lf(null,this.A^d,hf(this.e,e)):u?this:null};var of=new lf(null,0,[]);
function rf(a,b,c){var d=a.e;a=2*(a.g-1);for(var e=Array(a),f=0,h=1,k=0;;)if(f<a)f!==c&&null!=d[f]&&(e[h]=d[f],h+=2,k|=1<<f),f+=1;else return new lf(b,k,e)}function pf(a,b,c){this.t=a;this.g=b;this.e=c}g=pf.prototype;g.La=function(a){return a===this.t?this:new pf(a,this.g,va(this.e))};
g.gb=function(a,b,c,d,e){var f=c>>>b&31,h=this.e[f];if(null==h)return this;b=h.gb(a,b+5,c,d,e);if(b===h)return this;if(null==b){if(8>=this.g)return rf(this,a,f);a=jf.n(this,a,f,b);a.g-=1;return a}return u?jf.n(this,a,f,b):null};g.eb=function(){return sf.b?sf.b(this.e):sf.call(null,this.e)};g.Ta=function(a,b){for(var c=this.e.length,d=0,e=b;;)if(d<c){var f=this.e[d];if(null!=f&&(e=f.Ta(a,e),fc(e)))return K.b?K.b(e):K.call(null,e);d+=1}else return e};
g.Ma=function(a,b,c,d){var e=this.e[b>>>a&31];return null!=e?e.Ma(a+5,b,c,d):d};g.ia=function(a,b,c,d,e,f){var h=c>>>b&31,k=this.e[h];if(null==k)return a=jf.n(this,a,h,of.ia(a,b+5,c,d,e,f)),a.g+=1,a;b=k.ia(a,b+5,c,d,e,f);return b===k?this:jf.n(this,a,h,b)};g.ha=function(a,b,c,d,e){var f=b>>>a&31,h=this.e[f];if(null==h)return new pf(null,this.g+1,gf.c(this.e,f,of.ha(a+5,b,c,d,e)));a=h.ha(a+5,b,c,d,e);return a===h?this:new pf(null,this.g,gf.c(this.e,f,a))};
g.fb=function(a,b,c){var d=b>>>a&31,e=this.e[d];return null!=e?(a=e.fb(a+5,b,c),a===e?this:null==a?8>=this.g?rf(this,null,d):new pf(null,this.g-1,gf.c(this.e,d,a)):u?new pf(null,this.g,gf.c(this.e,d,a)):null):this};function tf(a,b,c){b*=2;for(var d=0;;)if(d<b){if(ff(c,a[d]))return d;d+=2}else return-1}function uf(a,b,c,d){this.t=a;this.ra=b;this.g=c;this.e=d}g=uf.prototype;
g.La=function(a){if(a===this.t)return this;var b=Array(2*(this.g+1));Kc(this.e,0,b,0,2*this.g);return new uf(a,this.ra,this.g,b)};g.gb=function(a,b,c,d,e){b=tf(this.e,this.g,d);if(-1===b)return this;e[0]=!0;if(1===this.g)return null;a=this.La(a);e=a.e;e[b]=e[2*this.g-2];e[b+1]=e[2*this.g-1];e[2*this.g-1]=null;e[2*this.g-2]=null;a.g-=1;return a};g.eb=function(){return nf.b?nf.b(this.e):nf.call(null,this.e)};g.Ta=function(a,b){return kf(this.e,a,b)};
g.Ma=function(a,b,c,d){a=tf(this.e,this.g,c);return 0>a?d:ff(c,this.e[a])?this.e[a+1]:u?d:null};
g.ia=function(a,b,c,d,e,f){if(c===this.ra){b=tf(this.e,this.g,d);if(-1===b){if(this.e.length>2*this.g)return a=jf.X(this,a,2*this.g,d,2*this.g+1,e),f.l=!0,a.g+=1,a;c=this.e.length;b=Array(c+2);Kc(this.e,0,b,0,c);b[c]=d;b[c+1]=e;f.l=!0;f=this.g+1;a===this.t?(this.e=b,this.g=f,a=this):a=new uf(this.t,this.ra,f,b);return a}return this.e[b+1]===e?this:jf.n(this,a,b+1,e)}return(new lf(a,1<<(this.ra>>>b&31),[null,this,null,null])).ia(a,b,c,d,e,f)};
g.ha=function(a,b,c,d,e){return b===this.ra?(a=tf(this.e,this.g,c),-1===a?(a=2*this.g,b=Array(a+2),Kc(this.e,0,b,0,a),b[a]=c,b[a+1]=d,e.l=!0,new uf(null,this.ra,this.g+1,b)):Wb.a(this.e[a],d)?this:new uf(null,this.ra,this.g,gf.c(this.e,a+1,d))):(new lf(null,1<<(this.ra>>>a&31),[null,this])).ha(a,b,c,d,e)};g.fb=function(a,b,c){a=tf(this.e,this.g,c);return-1===a?this:1===this.g?null:u?new uf(null,this.ra,this.g-1,hf(this.e,Yc(a))):null};
var qf=function(){function a(a,b,c,h,k,l,n){var q=Tb(c);if(q===k)return new uf(null,q,2,[c,h,l,n]);var t=new ef;return of.ia(a,b,q,c,h,t).ia(a,b,k,l,n,t)}function b(a,b,c,h,k,l){var n=Tb(b);if(n===h)return new uf(null,n,2,[b,c,k,l]);var q=new ef;return of.ha(a,n,b,c,q).ha(a,h,k,l,q)}var c=null,c=function(c,e,f,h,k,l,n){switch(arguments.length){case 6:return b.call(this,c,e,f,h,k,l);case 7:return a.call(this,c,e,f,h,k,l,n)}throw Error("Invalid arity: "+arguments.length);};c.X=b;c.ga=a;return c}();
function vf(a,b,c,d,e){this.j=a;this.ka=b;this.p=c;this.r=d;this.m=e;this.q=0;this.i=32374860}g=vf.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.j};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.j)};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return null==this.r?new W(null,2,5,X,[this.ka[this.p],this.ka[this.p+1]],null):F(this.r)};
g.S=function(){return null==this.r?nf.c?nf.c(this.ka,this.p+2,null):nf.call(null,this.ka,this.p+2,null):nf.c?nf.c(this.ka,this.p,I(this.r)):nf.call(null,this.ka,this.p,I(this.r))};g.H=function(){return this};g.F=function(a,b){return new vf(b,this.ka,this.p,this.r,this.m)};g.G=function(a,b){return M(b,this)};
var nf=function(){function a(a,b,c){if(null==c)for(c=a.length;;)if(b<c){if(null!=a[b])return new vf(null,a,b,null,null);var h=a[b+1];if(r(h)&&(h=h.eb(),r(h)))return new vf(null,a,b+2,h,null);b+=2}else return null;else return new vf(null,a,b,c,null)}function b(a){return c.c(a,0,null)}var c=null,c=function(c,e,f){switch(arguments.length){case 1:return b.call(this,c);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.c=a;return c}();
function wf(a,b,c,d,e){this.j=a;this.ka=b;this.p=c;this.r=d;this.m=e;this.q=0;this.i=32374860}g=wf.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.j};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.j)};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return F(this.r)};
g.S=function(){return sf.n?sf.n(null,this.ka,this.p,I(this.r)):sf.call(null,null,this.ka,this.p,I(this.r))};g.H=function(){return this};g.F=function(a,b){return new wf(b,this.ka,this.p,this.r,this.m)};g.G=function(a,b){return M(b,this)};
var sf=function(){function a(a,b,c,h){if(null==h)for(h=b.length;;)if(c<h){var k=b[c];if(r(k)&&(k=k.eb(),r(k)))return new wf(a,b,c+1,k,null);c+=1}else return null;else return new wf(a,b,c,h,null)}function b(a){return c.n(null,a,0,null)}var c=null,c=function(c,e,f,h){switch(arguments.length){case 1:return b.call(this,c);case 4:return a.call(this,c,e,f,h)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.n=a;return c}();
function xf(a,b,c,d,e,f){this.j=a;this.g=b;this.root=c;this.T=d;this.Y=e;this.m=f;this.i=16123663;this.q=8196}g=xf.prototype;g.toString=function(){return Lb(this)};g.keys=function(){return Oe(Ve.b?Ve.b(this):Ve.call(null,this))};g.entries=function(){return Qe(E(this))};g.values=function(){return Oe(We.b?We.b(this):We.call(null,this))};g.has=function(a){return Oc(this,a)};g.get=function(a){return this.u(null,a)};
g.forEach=function(a){for(var b=E(this),c=null,d=0,e=0;;)if(e<d){var f=c.J(null,e),h=P.c(f,0,null),f=P.c(f,1,null);a.a?a.a(f,h):a.call(null,f,h);e+=1}else if(b=E(b))Ic(b)?(c=Hb(b),b=Ib(b),h=c,d=O(c),c=h):(c=F(b),h=P.c(c,0,null),f=P.c(c,1,null),a.a?a.a(f,h):a.call(null,f,h),b=I(b),c=null,d=0),e=0;else return null};g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){return null==b?this.T?this.Y:c:null==this.root?c:u?this.root.Ma(0,Tb(b),b,c):null};
g.Za=function(a,b,c){a=this.T?b.c?b.c(c,null,this.Y):b.call(null,c,null,this.Y):c;return fc(a)?K.b?K.b(a):K.call(null,a):null!=this.root?this.root.Ta(b,a):u?a:null};g.D=function(){return this.j};g.L=function(){return this.g};g.B=function(){var a=this.m;return null!=a?a:this.m=a=dc(this)};g.v=function(a,b){return Me(this,b)};g.Wa=function(){return new yf({},this.root,this.g,this.T,this.Y)};g.I=function(){return eb($e,this.j)};
g.nb=function(a,b){if(null==b)return this.T?new xf(this.j,this.g-1,this.root,!1,null,null):this;if(null==this.root)return this;if(u){var c=this.root.fb(0,Tb(b),b);return c===this.root?this:new xf(this.j,this.g-1,c,this.T,this.Y,null)}return null};
g.ua=function(a,b,c){if(null==b)return this.T&&c===this.Y?this:new xf(this.j,this.T?this.g:this.g+1,this.root,!0,c,null);a=new ef;b=(null==this.root?of:this.root).ha(0,Tb(b),b,c,a);return b===this.root?this:new xf(this.j,a.l?this.g+1:this.g,b,this.T,this.Y,null)};g.kb=function(a,b){return null==b?this.T:null==this.root?!1:u?this.root.Ma(0,Tb(b),b,Lc)!==Lc:null};g.H=function(){if(0<this.g){var a=null!=this.root?this.root.eb():null;return this.T?M(new W(null,2,5,X,[null,this.Y],null),a):a}return null};
g.F=function(a,b){return new xf(b,this.g,this.root,this.T,this.Y,this.m)};g.G=function(a,b){if(Hc(b))return Oa(this,D.a(b,0),D.a(b,1));for(var c=this,d=E(b);;){if(null==d)return c;var e=F(d);if(Hc(e))c=Oa(c,D.a(e,0),D.a(e,1)),d=I(d);else throw Error("conj on a map takes map entries or seqables of map entries");}};
g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.u(null,c);case 3:return this.C(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return this.u(null,a)};g.a=function(a,b){return this.C(null,a,b)};var $e=new xf(null,0,null,!1,null,0);function sc(a,b){for(var c=a.length,d=0,e=yb($e);;)if(d<c)var f=d+1,e=e.cb(null,a[d],b[d]),d=f;else return Ab(e)}
function yf(a,b,c,d,e){this.t=a;this.root=b;this.count=c;this.T=d;this.Y=e;this.q=56;this.i=258}g=yf.prototype;g.Ab=function(a,b){if(this.t)if(null==b)this.T&&(this.T=!1,this.Y=null,this.count-=1);else{if(null!=this.root){var c=new ef,d=this.root.gb(this.t,0,Tb(b),b,c);d!==this.root&&(this.root=d);r(c[0])&&(this.count-=1)}}else throw Error("dissoc! after persistent!");return this};g.cb=function(a,b,c){return zf(this,b,c)};
g.Ka=function(a,b){var c;a:{if(this.t){if(b?b.i&2048||b.dc||(b.i?0:s(Sa,b)):s(Sa,b)){c=zf(this,cf.b?cf.b(b):cf.call(null,b),df.b?df.b(b):df.call(null,b));break a}c=E(b);for(var d=this;;){var e=F(c);if(r(e))c=I(c),d=zf(d,cf.b?cf.b(e):cf.call(null,e),df.b?df.b(e):df.call(null,e));else{c=d;break a}}}else throw Error("conj! after persistent");c=void 0}return c};
g.Oa=function(){var a;if(this.t)this.t=null,a=new xf(null,this.count,this.root,this.T,this.Y,null);else throw Error("persistent! called twice");return a};g.u=function(a,b){return null==b?this.T?this.Y:null:null==this.root?null:this.root.Ma(0,Tb(b),b)};g.C=function(a,b,c){return null==b?this.T?this.Y:c:null==this.root?c:this.root.Ma(0,Tb(b),b,c)};g.L=function(){if(this.t)return this.count;throw Error("count after persistent!");};
function zf(a,b,c){if(a.t){if(null==b)a.Y!==c&&(a.Y=c),a.T||(a.count+=1,a.T=!0);else{var d=new ef;b=(null==a.root?of:a.root).ia(a.t,0,Tb(b),b,c,d);b!==a.root&&(a.root=b);d.l&&(a.count+=1)}return a}throw Error("assoc! after persistent!");}function Af(a,b,c){for(var d=b;;)if(null!=a)b=c?a.left:a.right,d=pc.a(d,a),a=b;else return d}function Bf(a,b,c,d,e){this.j=a;this.stack=b;this.ib=c;this.g=d;this.m=e;this.q=0;this.i=32374862}g=Bf.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.j};
g.L=function(){return 0>this.g?O(I(this))+1:this.g};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.j)};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return yc(this.stack)};g.S=function(){var a=F(this.stack),a=Af(this.ib?a.right:a.left,I(this.stack),this.ib);return null!=a?new Bf(null,a,this.ib,this.g-1,null):H};g.H=function(){return this};
g.F=function(a,b){return new Bf(b,this.stack,this.ib,this.g,this.m)};g.G=function(a,b){return M(b,this)};function Cf(a,b,c){return new Bf(null,Af(a,null,b),b,c,null)}function Df(a,b,c,d){return c instanceof Y?c.left instanceof Y?new Y(c.key,c.l,c.left.qa(),new $(a,b,c.right,d,null),null):c.right instanceof Y?new Y(c.right.key,c.right.l,new $(c.key,c.l,c.left,c.right.left,null),new $(a,b,c.right.right,d,null),null):u?new $(a,b,c,d,null):null:new $(a,b,c,d,null)}
function Ef(a,b,c,d){return d instanceof Y?d.right instanceof Y?new Y(d.key,d.l,new $(a,b,c,d.left,null),d.right.qa(),null):d.left instanceof Y?new Y(d.left.key,d.left.l,new $(a,b,c,d.left.left,null),new $(d.key,d.l,d.left.right,d.right,null),null):u?new $(a,b,c,d,null):null:new $(a,b,c,d,null)}
function Ff(a,b,c,d){if(c instanceof Y)return new Y(a,b,c.qa(),d,null);if(d instanceof $)return Ef(a,b,c,d.hb());if(d instanceof Y&&d.left instanceof $)return new Y(d.left.key,d.left.l,new $(a,b,c,d.left.left,null),Ef(d.key,d.l,d.left.right,d.right.hb()),null);if(u)throw Error("red-black tree invariant violation");return null}
var Hf=function Gf(b,c,d){d=null!=b.left?Gf(b.left,c,d):d;if(fc(d))return K.b?K.b(d):K.call(null,d);d=c.c?c.c(d,b.key,b.l):c.call(null,d,b.key,b.l);if(fc(d))return K.b?K.b(d):K.call(null,d);b=null!=b.right?Gf(b.right,c,d):d;return fc(b)?K.b?K.b(b):K.call(null,b):b};function $(a,b,c,d,e){this.key=a;this.l=b;this.left=c;this.right=d;this.m=e;this.q=0;this.i=32402207}g=$.prototype;g.Hb=function(a){return a.Jb(this)};g.hb=function(){return new Y(this.key,this.l,this.left,this.right,null)};g.qa=function(){return this};
g.Gb=function(a){return a.Ib(this)};g.replace=function(a,b,c,d){return new $(a,b,c,d,null)};g.Ib=function(a){return new $(a.key,a.l,this,a.right,null)};g.Jb=function(a){return new $(a.key,a.l,a.left,this,null)};g.Ta=function(a,b){return Hf(this,a,b)};g.u=function(a,b){return D.c(this,b,null)};g.C=function(a,b,c){return D.c(this,b,c)};g.J=function(a,b){return 0===b?this.key:1===b?this.l:null};g.aa=function(a,b,c){return 0===b?this.key:1===b?this.l:u?c:null};
g.Pa=function(a,b,c){return(new W(null,2,5,X,[this.key,this.l],null)).Pa(null,b,c)};g.D=function(){return null};g.L=function(){return 2};g.$a=function(){return this.key};g.ab=function(){return this.l};g.Ia=function(){return this.l};g.Ja=function(){return new W(null,1,5,X,[this.key],null)};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return qe};g.N=function(a,b){return gc.a(this,b)};g.M=function(a,b,c){return gc.c(this,b,c)};
g.ua=function(a,b,c){return R.c(new W(null,2,5,X,[this.key,this.l],null),b,c)};g.H=function(){return Da(Da(H,this.l),this.key)};g.F=function(a,b){return N(new W(null,2,5,X,[this.key,this.l],null),b)};g.G=function(a,b){return new W(null,3,5,X,[this.key,this.l,b],null)};g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.u(null,c);case 3:return this.C(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();
g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return this.u(null,a)};g.a=function(a,b){return this.C(null,a,b)};function Y(a,b,c,d,e){this.key=a;this.l=b;this.left=c;this.right=d;this.m=e;this.q=0;this.i=32402207}g=Y.prototype;g.Hb=function(a){return new Y(this.key,this.l,this.left,a,null)};g.hb=function(){throw Error("red-black tree invariant violation");};g.qa=function(){return new $(this.key,this.l,this.left,this.right,null)};
g.Gb=function(a){return new Y(this.key,this.l,a,this.right,null)};g.replace=function(a,b,c,d){return new Y(a,b,c,d,null)};g.Ib=function(a){return this.left instanceof Y?new Y(this.key,this.l,this.left.qa(),new $(a.key,a.l,this.right,a.right,null),null):this.right instanceof Y?new Y(this.right.key,this.right.l,new $(this.key,this.l,this.left,this.right.left,null),new $(a.key,a.l,this.right.right,a.right,null),null):u?new $(a.key,a.l,this,a.right,null):null};
g.Jb=function(a){return this.right instanceof Y?new Y(this.key,this.l,new $(a.key,a.l,a.left,this.left,null),this.right.qa(),null):this.left instanceof Y?new Y(this.left.key,this.left.l,new $(a.key,a.l,a.left,this.left.left,null),new $(this.key,this.l,this.left.right,this.right,null),null):u?new $(a.key,a.l,a.left,this,null):null};g.Ta=function(a,b){return Hf(this,a,b)};g.u=function(a,b){return D.c(this,b,null)};g.C=function(a,b,c){return D.c(this,b,c)};
g.J=function(a,b){return 0===b?this.key:1===b?this.l:null};g.aa=function(a,b,c){return 0===b?this.key:1===b?this.l:u?c:null};g.Pa=function(a,b,c){return(new W(null,2,5,X,[this.key,this.l],null)).Pa(null,b,c)};g.D=function(){return null};g.L=function(){return 2};g.$a=function(){return this.key};g.ab=function(){return this.l};g.Ia=function(){return this.l};g.Ja=function(){return new W(null,1,5,X,[this.key],null)};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};
g.v=function(a,b){return lc(this,b)};g.I=function(){return qe};g.N=function(a,b){return gc.a(this,b)};g.M=function(a,b,c){return gc.c(this,b,c)};g.ua=function(a,b,c){return R.c(new W(null,2,5,X,[this.key,this.l],null),b,c)};g.H=function(){return Da(Da(H,this.l),this.key)};g.F=function(a,b){return N(new W(null,2,5,X,[this.key,this.l],null),b)};g.G=function(a,b){return new W(null,3,5,X,[this.key,this.l,b],null)};
g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.u(null,c);case 3:return this.C(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return this.u(null,a)};g.a=function(a,b){return this.C(null,a,b)};
var Jf=function If(b,c,d,e,f){if(null==c)return new Y(d,e,null,null,null);var h=b.a?b.a(d,c.key):b.call(null,d,c.key);return 0===h?(f[0]=c,null):0>h?(b=If(b,c.left,d,e,f),null!=b?c.Gb(b):null):u?(b=If(b,c.right,d,e,f),null!=b?c.Hb(b):null):null},Lf=function Kf(b,c){if(null==b)return c;if(null==c)return b;if(b instanceof Y){if(c instanceof Y){var d=Kf(b.right,c.left);return d instanceof Y?new Y(d.key,d.l,new Y(b.key,b.l,b.left,d.left,null),new Y(c.key,c.l,d.right,c.right,null),null):new Y(b.key,b.l,
b.left,new Y(c.key,c.l,d,c.right,null),null)}return new Y(b.key,b.l,b.left,Kf(b.right,c),null)}return c instanceof Y?new Y(c.key,c.l,Kf(b,c.left),c.right,null):u?(d=Kf(b.right,c.left),d instanceof Y?new Y(d.key,d.l,new $(b.key,b.l,b.left,d.left,null),new $(c.key,c.l,d.right,c.right,null),null):Ff(b.key,b.l,b.left,new $(c.key,c.l,d,c.right,null))):null},Nf=function Mf(b,c,d,e){if(null!=c){var f=b.a?b.a(d,c.key):b.call(null,d,c.key);if(0===f)return e[0]=c,Lf(c.left,c.right);if(0>f)return b=Mf(b,c.left,
d,e),null!=b||null!=e[0]?c.left instanceof $?Ff(c.key,c.l,b,c.right):new Y(c.key,c.l,b,c.right,null):null;if(u){b=Mf(b,c.right,d,e);if(null!=b||null!=e[0])if(c.right instanceof $)if(e=c.key,d=c.l,c=c.left,b instanceof Y)c=new Y(e,d,c,b.qa(),null);else if(c instanceof $)c=Df(e,d,c.hb(),b);else if(c instanceof Y&&c.right instanceof $)c=new Y(c.right.key,c.right.l,Df(c.key,c.l,c.left.hb(),c.right.left),new $(e,d,c.right.right,b,null),null);else{if(u)throw Error("red-black tree invariant violation");
c=null}else c=new Y(c.key,c.l,c.left,b,null);else c=null;return c}}return null},Pf=function Of(b,c,d,e){var f=c.key,h=b.a?b.a(d,f):b.call(null,d,f);return 0===h?c.replace(f,e,c.left,c.right):0>h?c.replace(f,c.l,Of(b,c.left,d,e),c.right):u?c.replace(f,c.l,c.left,Of(b,c.right,d,e)):null};function Qf(a,b,c,d,e){this.Z=a;this.ma=b;this.g=c;this.j=d;this.m=e;this.i=418776847;this.q=8192}g=Qf.prototype;g.toString=function(){return Lb(this)};g.keys=function(){return Oe(Ve.b?Ve.b(this):Ve.call(null,this))};
g.entries=function(){return Qe(E(this))};g.values=function(){return Oe(We.b?We.b(this):We.call(null,this))};g.has=function(a){return Oc(this,a)};g.get=function(a){return this.u(null,a)};g.forEach=function(a){for(var b=E(this),c=null,d=0,e=0;;)if(e<d){var f=c.J(null,e),h=P.c(f,0,null),f=P.c(f,1,null);a.a?a.a(f,h):a.call(null,f,h);e+=1}else if(b=E(b))Ic(b)?(c=Hb(b),b=Ib(b),h=c,d=O(c),c=h):(c=F(b),h=P.c(c,0,null),f=P.c(c,1,null),a.a?a.a(f,h):a.call(null,f,h),b=I(b),c=null,d=0),e=0;else return null};
function Rf(a,b){for(var c=a.ma;;)if(null!=c){var d=a.Z.a?a.Z.a(b,c.key):a.Z.call(null,b,c.key);if(0===d)return c;if(0>d)c=c.left;else if(u)c=c.right;else return null}else return null}g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){a=Rf(this,b);return null!=a?a.l:c};g.Za=function(a,b,c){return null!=this.ma?Hf(this.ma,b,c):c};g.D=function(){return this.j};g.L=function(){return this.g};g.Xa=function(){return 0<this.g?Cf(this.ma,!1,this.g):null};
g.B=function(){var a=this.m;return null!=a?a:this.m=a=dc(this)};g.v=function(a,b){return Me(this,b)};g.I=function(){return N(Sf,this.j)};g.nb=function(a,b){var c=[null],d=Nf(this.Z,this.ma,b,c);return null==d?null==P.a(c,0)?this:new Qf(this.Z,null,0,this.j,null):new Qf(this.Z,d.qa(),this.g-1,this.j,null)};
g.ua=function(a,b,c){a=[null];var d=Jf(this.Z,this.ma,b,c,a);return null==d?(a=P.a(a,0),Wb.a(c,a.l)?this:new Qf(this.Z,Pf(this.Z,this.ma,b,c),this.g,this.j,null)):new Qf(this.Z,d.qa(),this.g+1,this.j,null)};g.kb=function(a,b){return null!=Rf(this,b)};g.H=function(){return 0<this.g?Cf(this.ma,!0,this.g):null};g.F=function(a,b){return new Qf(this.Z,this.ma,this.g,b,this.m)};
g.G=function(a,b){if(Hc(b))return Oa(this,D.a(b,0),D.a(b,1));for(var c=this,d=E(b);;){if(null==d)return c;var e=F(d);if(Hc(e))c=Oa(c,D.a(e,0),D.a(e,1)),d=I(d);else throw Error("conj on a map takes map entries or seqables of map entries");}};g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.u(null,c);case 3:return this.C(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};
g.b=function(a){return this.u(null,a)};g.a=function(a,b){return this.C(null,a,b)};g.yb=function(a,b){return 0<this.g?Cf(this.ma,b,this.g):null};g.zb=function(a,b,c){if(0<this.g){a=null;for(var d=this.ma;;)if(null!=d){var e=this.Z.a?this.Z.a(b,d.key):this.Z.call(null,b,d.key);if(0===e)return new Bf(null,pc.a(a,d),c,-1,null);if(r(c))0>e?(a=pc.a(a,d),d=d.left):d=d.right;else if(u)0<e?(a=pc.a(a,d),d=d.right):d=d.left;else return null}else return null==a?null:new Bf(null,a,c,-1,null)}else return null};
g.xb=function(a,b){return cf.b?cf.b(b):cf.call(null,b)};g.wb=function(){return this.Z};
var Sf=new Qf(Xb,null,0,null,0),Tf=function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){a=E(a);for(var b=yb($e);;)if(a){var e=I(I(a)),b=xd.c(b,F(a),F(I(a)));a=e}else return Ab(b)}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}(),Uf=function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){return new la(null,Yc(O(a)),S.a(wa,
a),null)}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}(),Vf=function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){a=E(a);for(var b=Sf;;)if(a){var e=I(I(a)),b=R.c(b,F(a),F(I(a)));a=e}else return b}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}(),Wf=function(){function a(a,d){var e=null;1<arguments.length&&(e=J(Array.prototype.slice.call(arguments,1),0));return b.call(this,a,e)}function b(a,
b){for(var e=E(b),f=new Qf(Qc(a),null,0,null,0);;)if(e)var h=I(I(e)),f=R.c(f,F(e),F(I(e))),e=h;else return f}a.k=1;a.f=function(a){var d=F(a);a=G(a);return b(d,a)};a.d=b;return a}();function Xf(a,b){this.V=a;this.W=b;this.q=0;this.i=32374988}g=Xf.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.W};g.U=function(){var a=this.V,a=(a?a.i&128||a.ob||(a.i?0:s(Ja,a)):s(Ja,a))?this.V.U(null):I(this.V);return null==a?null:new Xf(a,this.W)};g.B=function(){return cc(this)};
g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.W)};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return this.V.Q(null).$a(null)};g.S=function(){var a=this.V,a=(a?a.i&128||a.ob||(a.i?0:s(Ja,a)):s(Ja,a))?this.V.U(null):I(this.V);return null!=a?new Xf(a,this.W):H};g.H=function(){return this};g.F=function(a,b){return new Xf(this.V,b)};g.G=function(a,b){return M(b,this)};function Ve(a){return(a=E(a))?new Xf(a,null):null}
function cf(a){return Ta(a)}function Yf(a,b){this.V=a;this.W=b;this.q=0;this.i=32374988}g=Yf.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.W};g.U=function(){var a=this.V,a=(a?a.i&128||a.ob||(a.i?0:s(Ja,a)):s(Ja,a))?this.V.U(null):I(this.V);return null==a?null:new Yf(a,this.W)};g.B=function(){return cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.W)};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return this.V.Q(null).ab(null)};
g.S=function(){var a=this.V,a=(a?a.i&128||a.ob||(a.i?0:s(Ja,a)):s(Ja,a))?this.V.U(null):I(this.V);return null!=a?new Yf(a,this.W):H};g.H=function(){return this};g.F=function(a,b){return new Yf(this.V,b)};g.G=function(a,b){return M(b,this)};function We(a){return(a=E(a))?new Yf(a,null):null}function df(a){return Ua(a)}
var Zf=function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){return r(Ed(Fd,a))?C.a(function(a,b){return pc.a(r(a)?a:Ye,b)},a):null}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}();function $f(a,b,c){this.j=a;this.Sa=b;this.m=c;this.i=15077647;this.q=8196}g=$f.prototype;g.toString=function(){return Lb(this)};g.keys=function(){return Oe(E(this))};g.entries=function(){return Se(E(this))};g.values=function(){return Oe(E(this))};
g.has=function(a){return Oc(this,a)};g.forEach=function(a){for(var b=E(this),c=null,d=0,e=0;;)if(e<d){var f=c.J(null,e),h=P.c(f,0,null),f=P.c(f,1,null);a.a?a.a(f,h):a.call(null,f,h);e+=1}else if(b=E(b))Ic(b)?(c=Hb(b),b=Ib(b),h=c,d=O(c),c=h):(c=F(b),h=P.c(c,0,null),f=P.c(c,1,null),a.a?a.a(f,h):a.call(null,f,h),b=I(b),c=null,d=0),e=0;else return null};g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){return Na(this.Sa,b)?b:c};g.D=function(){return this.j};g.L=function(){return Aa(this.Sa)};
g.B=function(){var a=this.m;return null!=a?a:this.m=a=dc(this)};g.v=function(a,b){return Dc(b)&&O(this)===O(b)&&Dd(function(a){return function(b){return Oc(a,b)}}(this),b)};g.Wa=function(){return new ag(yb(this.Sa))};g.I=function(){return N(bg,this.j)};g.vb=function(a,b){return new $f(this.j,Qa(this.Sa,b),null)};g.H=function(){return Ve(this.Sa)};g.F=function(a,b){return new $f(b,this.Sa,this.m)};g.G=function(a,b){return new $f(this.j,R.c(this.Sa,b,null),null)};
g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.u(null,c);case 3:return this.C(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return this.u(null,a)};g.a=function(a,b){return this.C(null,a,b)};var bg=new $f(null,Ye,0);function ag(a){this.la=a;this.i=259;this.q=136}g=ag.prototype;
g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return La.c(this.la,c,Lc)===Lc?null:c;case 3:return La.c(this.la,c,Lc)===Lc?d:c}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return La.c(this.la,a,Lc)===Lc?null:a};g.a=function(a,b){return La.c(this.la,a,Lc)===Lc?b:a};g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){return La.c(this.la,b,Lc)===Lc?c:b};
g.L=function(){return O(this.la)};g.Ob=function(a,b){this.la=yd.a(this.la,b);return this};g.Ka=function(a,b){this.la=xd.c(this.la,b,null);return this};g.Oa=function(){return new $f(null,Ab(this.la),null)};function cg(a,b,c){this.j=a;this.na=b;this.m=c;this.i=417730831;this.q=8192}g=cg.prototype;g.toString=function(){return Lb(this)};g.keys=function(){return Oe(E(this))};g.entries=function(){return Se(E(this))};g.values=function(){return Oe(E(this))};g.has=function(a){return Oc(this,a)};
g.forEach=function(a){for(var b=E(this),c=null,d=0,e=0;;)if(e<d){var f=c.J(null,e),h=P.c(f,0,null),f=P.c(f,1,null);a.a?a.a(f,h):a.call(null,f,h);e+=1}else if(b=E(b))Ic(b)?(c=Hb(b),b=Ib(b),h=c,d=O(c),c=h):(c=F(b),h=P.c(c,0,null),f=P.c(c,1,null),a.a?a.a(f,h):a.call(null,f,h),b=I(b),c=null,d=0),e=0;else return null};g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){a=Rf(this.na,b);return null!=a?a.key:c};g.D=function(){return this.j};g.L=function(){return O(this.na)};
g.Xa=function(){return 0<O(this.na)?Kd.a(cf,pb(this.na)):null};g.B=function(){var a=this.m;return null!=a?a:this.m=a=dc(this)};g.v=function(a,b){return Dc(b)&&O(this)===O(b)&&Dd(function(a){return function(b){return Oc(a,b)}}(this),b)};g.I=function(){return N(dg,this.j)};g.vb=function(a,b){return new cg(this.j,tc.a(this.na,b),null)};g.H=function(){return Ve(this.na)};g.F=function(a,b){return new cg(b,this.na,this.m)};g.G=function(a,b){return new cg(this.j,R.c(this.na,b,null),null)};
g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.u(null,c);case 3:return this.C(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return this.u(null,a)};g.a=function(a,b){return this.C(null,a,b)};g.yb=function(a,b){return Kd.a(cf,qb(this.na,b))};g.zb=function(a,b,c){return Kd.a(cf,rb(this.na,b,c))};g.xb=function(a,b){return b};g.wb=function(){return tb(this.na)};
var dg=new cg(null,Sf,0);function eg(a){a=E(a);if(null==a)return bg;if(a instanceof ac&&0===a.p){a=a.e;a:{for(var b=0,c=yb(bg);;)if(b<a.length)var d=b+1,c=c.Ka(null,a[b]),b=d;else{a=c;break a}a=void 0}return a.Oa(null)}if(u)for(d=yb(bg);;)if(null!=a)b=a.U(null),d=d.Ka(null,a.Q(null)),a=b;else return d.Oa(null);else return null}
var fg=function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){return C.c(Da,dg,a)}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}(),gg=function(){function a(a,d){var e=null;1<arguments.length&&(e=J(Array.prototype.slice.call(arguments,1),0));return b.call(this,a,e)}function b(a,b){return C.c(Da,new cg(null,Wf(a),0),b)}a.k=1;a.f=function(a){var d=F(a);a=G(a);return b(d,a)};a.d=b;return a}();
function hg(a){for(var b=qe;;)if(I(a))b=pc.a(b,F(a)),a=I(a);else return E(b)}function id(a){if(a&&(a.q&4096||a.fc))return a.name;if("string"===typeof a)return a;throw Error("Doesn't support name: "+A.b(a));}
var ig=function(){function a(a,b,c){return(a.b?a.b(b):a.call(null,b))>(a.b?a.b(c):a.call(null,c))?b:c}var b=null,c=function(){function a(b,d,k,l){var n=null;3<arguments.length&&(n=J(Array.prototype.slice.call(arguments,3),0));return c.call(this,b,d,k,n)}function c(a,d,e,l){return C.c(function(c,d){return b.c(a,c,d)},b.c(a,d,e),l)}a.k=3;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=I(a);var l=F(a);a=G(a);return c(b,d,l,a)};a.d=c;return a}(),b=function(b,e,f,h){switch(arguments.length){case 2:return e;
case 3:return a.call(this,b,e,f);default:return c.d(b,e,f,J(arguments,3))}throw Error("Invalid arity: "+arguments.length);};b.k=3;b.f=c.f;b.a=function(a,b){return b};b.c=a;b.d=c.d;return b}(),jg=function(){function a(a,b,f){return new V(null,function(){var h=E(f);return h?M(Md(a,h),c.c(a,b,Nd(b,h))):null},null,null)}function b(a,b){return c.c(a,a,b)}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);
};c.a=b;c.c=a;return c}(),lg=function kg(b,c){return new V(null,function(){var d=E(c);return d?r(b.b?b.b(F(d)):b.call(null,F(d)))?M(F(d),kg(b,G(d))):null:null},null,null)};function mg(a,b,c){return function(d){var e=tb(a);return b.a?b.a(e.a?e.a(sb(a,d),c):e.call(null,sb(a,d),c),0):b.call(null,e.a?e.a(sb(a,d),c):e.call(null,sb(a,d),c),0)}}
var ng=function(){function a(a,b,c,h,k){var l=rb(a,c,!0);if(r(l)){var n=P.c(l,0,null);return lg(mg(a,h,k),r(mg(a,b,c).call(null,n))?l:I(l))}return null}function b(a,b,c){var h=mg(a,b,c),k;a:{k=[Uc,Vc];var l=k.length;if(l<=Ze)for(var n=0,q=yb(Ye);;)if(n<l)var t=n+1,q=Bb(q,k[n],null),n=t;else{k=new $f(null,Ab(q),null);break a}else for(n=0,q=yb(bg);;)if(n<l)t=n+1,q=zb(q,k[n]),n=t;else{k=Ab(q);break a}k=void 0}return r(k.call(null,b))?(a=rb(a,c,!0),r(a)?(b=P.c(a,0,null),r(h.b?h.b(b):h.call(null,b))?a:
I(a)):null):lg(h,qb(a,!0))}var c=null,c=function(c,e,f,h,k){switch(arguments.length){case 3:return b.call(this,c,e,f);case 5:return a.call(this,c,e,f,h,k)}throw Error("Invalid arity: "+arguments.length);};c.c=b;c.s=a;return c}();function og(a,b,c,d,e){this.j=a;this.start=b;this.end=c;this.step=d;this.m=e;this.i=32375006;this.q=8192}g=og.prototype;g.toString=function(){return Lb(this)};
g.J=function(a,b){if(b<Aa(this))return this.start+b*this.step;if(this.start>this.end&&0===this.step)return this.start;throw Error("Index out of bounds");};g.aa=function(a,b,c){return b<Aa(this)?this.start+b*this.step:this.start>this.end&&0===this.step?this.start:c};g.D=function(){return this.j};
g.U=function(){return 0<this.step?this.start+this.step<this.end?new og(this.j,this.start+this.step,this.end,this.step,null):null:this.start+this.step>this.end?new og(this.j,this.start+this.step,this.end,this.step,null):null};g.L=function(){return sa(lb(this))?0:Math.ceil((this.end-this.start)/this.step)};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.j)};g.N=function(a,b){return gc.a(this,b)};
g.M=function(a,b,c){return gc.c(this,b,c)};g.Q=function(){return null==lb(this)?null:this.start};g.S=function(){return null!=lb(this)?new og(this.j,this.start+this.step,this.end,this.step,null):H};g.H=function(){return 0<this.step?this.start<this.end?this:null:this.start>this.end?this:null};g.F=function(a,b){return new og(b,this.start,this.end,this.step,this.m)};g.G=function(a,b){return M(b,this)};
var pg=function(){function a(a,b,c){return new og(null,a,b,c,null)}function b(a,b){return e.c(a,b,1)}function c(a){return e.c(0,a,1)}function d(){return e.c(0,Number.MAX_VALUE,1)}var e=null,e=function(e,h,k){switch(arguments.length){case 0:return d.call(this);case 1:return c.call(this,e);case 2:return b.call(this,e,h);case 3:return a.call(this,e,h,k)}throw Error("Invalid arity: "+arguments.length);};e.o=d;e.b=c;e.a=b;e.c=a;return e}(),qg=function(){function a(a,b){for(;;)if(E(b)&&0<a){var c=a-1,h=
I(b);a=c;b=h}else return null}function b(a){for(;;)if(E(a))a=I(a);else return null}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),rg=function(){function a(a,b){qg.a(a,b);return b}function b(a){qg.b(a);return a}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);
};c.b=b;c.a=a;return c}();function sg(a,b){if("string"===typeof b){var c=a.exec(b);return Wb.a(F(c),b)?1===O(c)?F(c):we(c):null}throw new TypeError("re-matches must match against a string.");}function tg(a){var b;b=/^(?:\(\?([idmsux]*)\))?(.*)/;if("string"===typeof a)a=b.exec(a),b=null==a?null:1===O(a)?F(a):we(a);else throw new TypeError("re-find must match against a string.");P.c(b,0,null);a=P.c(b,1,null);b=P.c(b,2,null);return new RegExp(b,a)}
function ug(a,b,c,d,e,f,h){var k=ja;try{ja=null==ja?null:ja-1;if(null!=ja&&0>ja)return ub(a,"#");ub(a,c);E(h)&&(b.c?b.c(F(h),a,f):b.call(null,F(h),a,f));for(var l=I(h),n=ra.b(f)-1;;)if(!l||null!=n&&0===n){E(l)&&0===n&&(ub(a,d),ub(a,"..."));break}else{ub(a,d);b.c?b.c(F(l),a,f):b.call(null,F(l),a,f);var q=I(l);c=n-1;l=q;n=c}return ub(a,e)}finally{ja=k}}
var vg=function(){function a(a,d){var e=null;1<arguments.length&&(e=J(Array.prototype.slice.call(arguments,1),0));return b.call(this,a,e)}function b(a,b){for(var e=E(b),f=null,h=0,k=0;;)if(k<h){var l=f.J(null,k);ub(a,l);k+=1}else if(e=E(e))f=e,Ic(f)?(e=Hb(f),h=Ib(f),f=e,l=O(e),e=h,h=l):(l=F(f),ub(a,l),e=I(f),f=null,h=0),k=0;else return null}a.k=1;a.f=function(a){var d=F(a);a=G(a);return b(d,a)};a.d=b;return a}(),wg={'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t"};
function xg(a){return'"'+A.b(a.replace(RegExp('[\\\\"\b\f\n\r\t]',"g"),function(a){return wg[a]}))+'"'}
var Ag=function yg(b,c,d){if(null==b)return ub(c,"nil");if(void 0===b)return ub(c,"#\x3cundefined\x3e");if(u){r(function(){var c=Q.a(d,pa);return r(c)?(c=b?b.i&131072||b.ec?!0:b.i?!1:s(bb,b):s(bb,b))?xc(b):c:c}())&&(ub(c,"^"),yg(xc(b),c,d),ub(c," "));if(null==b)return ub(c,"nil");if(b.Db)return b.Tb(b,c,d);if(b&&(b.i&2147483648||b.K))return b.w(null,c,d);if(ta(b)===Boolean||"number"===typeof b)return ub(c,""+A.b(b));if(null!=b&&b.constructor===Object)return ub(c,"#js "),zg.n?zg.n(Kd.a(function(c){return new W(null,
2,5,X,[jd.b(c),b[c]],null)},Jc(b)),yg,c,d):zg.call(null,Kd.a(function(c){return new W(null,2,5,X,[jd.b(c),b[c]],null)},Jc(b)),yg,c,d);if(b instanceof Array)return ug(c,yg,"#js ["," ","]",d,b);if("string"==typeof b)return r(oa.b(d))?ub(c,xg(b)):ub(c,b);if(uc(b))return vg.d(c,J(["#\x3c",""+A.b(b),"\x3e"],0));if(b instanceof Date){var e=function(b,c){for(var d=""+A.b(b);;)if(O(d)<c)d="0"+A.b(d);else return d};return vg.d(c,J(['#inst "',""+A.b(b.getUTCFullYear()),"-",e(b.getUTCMonth()+1,2),"-",e(b.getUTCDate(),
2),"T",e(b.getUTCHours(),2),":",e(b.getUTCMinutes(),2),":",e(b.getUTCSeconds(),2),".",e(b.getUTCMilliseconds(),3),"-",'00:00"'],0))}return b instanceof RegExp?vg.d(c,J(['#"',b.source,'"'],0)):(b?b.i&2147483648||b.K||(b.i?0:s(vb,b)):s(vb,b))?wb(b,c,d):u?vg.d(c,J(["#\x3c",""+A.b(b),"\x3e"],0)):null}return null};
function Bg(a,b){var c=new ea;a:{var d=new Kb(c);Ag(F(a),d,b);for(var e=E(I(a)),f=null,h=0,k=0;;)if(k<h){var l=f.J(null,k);ub(d," ");Ag(l,d,b);k+=1}else if(e=E(e))f=e,Ic(f)?(e=Hb(f),h=Ib(f),f=e,l=O(e),e=h,h=l):(l=F(f),ub(d," "),Ag(l,d,b),e=I(f),f=null,h=0),k=0;else break a}return c}
var Cg=function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){var b=ka();return Bc(a)?"":""+A.b(Bg(a,b))}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}();function zg(a,b,c,d){return ug(c,function(a,c,d){b.c?b.c(Ta(a),c,d):b.call(null,Ta(a),c,d);ub(c," ");return b.c?b.c(Ua(a),c,d):b.call(null,Ua(a),c,d)},"{",", ","}",d,E(a))}ac.prototype.K=!0;
ac.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};V.prototype.K=!0;V.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};Bf.prototype.K=!0;Bf.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};vf.prototype.K=!0;vf.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};$.prototype.K=!0;$.prototype.w=function(a,b,c){return ug(b,Ag,"["," ","]",c,this)};Ue.prototype.K=!0;Ue.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};
cg.prototype.K=!0;cg.prototype.w=function(a,b,c){return ug(b,Ag,"#{"," ","}",c,this)};ye.prototype.K=!0;ye.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};gd.prototype.K=!0;gd.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};kc.prototype.K=!0;kc.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};xf.prototype.K=!0;xf.prototype.w=function(a,b,c){return zg(this,Ag,b,c)};wf.prototype.K=!0;wf.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};
Ae.prototype.K=!0;Ae.prototype.w=function(a,b,c){return ug(b,Ag,"["," ","]",c,this)};Qf.prototype.K=!0;Qf.prototype.w=function(a,b,c){return zg(this,Ag,b,c)};$f.prototype.K=!0;$f.prototype.w=function(a,b,c){return ug(b,Ag,"#{"," ","}",c,this)};od.prototype.K=!0;od.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};Yf.prototype.K=!0;Yf.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};Y.prototype.K=!0;Y.prototype.w=function(a,b,c){return ug(b,Ag,"["," ","]",c,this)};
W.prototype.K=!0;W.prototype.w=function(a,b,c){return ug(b,Ag,"["," ","]",c,this)};He.prototype.K=!0;He.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};cd.prototype.K=!0;cd.prototype.w=function(a,b){return ub(b,"()")};Ie.prototype.K=!0;Ie.prototype.w=function(a,b,c){return ug(b,Ag,"#queue ["," ","]",c,E(this))};la.prototype.K=!0;la.prototype.w=function(a,b,c){return zg(this,Ag,b,c)};og.prototype.K=!0;og.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};
Xf.prototype.K=!0;Xf.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};bd.prototype.K=!0;bd.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};W.prototype.lb=!0;W.prototype.mb=function(a,b){return Pc.a(this,b)};Ae.prototype.lb=!0;Ae.prototype.mb=function(a,b){return Pc.a(this,b)};T.prototype.lb=!0;T.prototype.mb=function(a,b){return Vb(this,b)};Zb.prototype.lb=!0;Zb.prototype.mb=function(a,b){return Vb(this,b)};
function Dg(a,b){if(a?a.gc:a)return a.gc(a,b);var c;c=Dg[m(null==a?null:a)];if(!c&&(c=Dg._,!c))throw x("IReset.-reset!",a);return c.call(null,a,b)}
var Eg=function(){function a(a,b,c,d,e){if(a?a.nc:a)return a.nc(a,b,c,d,e);var q;q=Eg[m(null==a?null:a)];if(!q&&(q=Eg._,!q))throw x("ISwap.-swap!",a);return q.call(null,a,b,c,d,e)}function b(a,b,c,d){if(a?a.mc:a)return a.mc(a,b,c,d);var e;e=Eg[m(null==a?null:a)];if(!e&&(e=Eg._,!e))throw x("ISwap.-swap!",a);return e.call(null,a,b,c,d)}function c(a,b,c){if(a?a.lc:a)return a.lc(a,b,c);var d;d=Eg[m(null==a?null:a)];if(!d&&(d=Eg._,!d))throw x("ISwap.-swap!",a);return d.call(null,a,b,c)}function d(a,b){if(a?
a.kc:a)return a.kc(a,b);var c;c=Eg[m(null==a?null:a)];if(!c&&(c=Eg._,!c))throw x("ISwap.-swap!",a);return c.call(null,a,b)}var e=null,e=function(e,h,k,l,n){switch(arguments.length){case 2:return d.call(this,e,h);case 3:return c.call(this,e,h,k);case 4:return b.call(this,e,h,k,l);case 5:return a.call(this,e,h,k,l,n)}throw Error("Invalid arity: "+arguments.length);};e.a=d;e.c=c;e.n=b;e.s=a;return e}();function Fg(a,b,c,d){this.state=a;this.j=b;this.wc=c;this.Wb=d;this.i=2153938944;this.q=16386}g=Fg.prototype;
g.B=function(){return this[ba]||(this[ba]=++ca)};g.Rb=function(a,b,c){a=E(this.Wb);for(var d=null,e=0,f=0;;)if(f<e){var h=d.J(null,f),k=P.c(h,0,null),h=P.c(h,1,null);h.n?h.n(k,this,b,c):h.call(null,k,this,b,c);f+=1}else if(a=E(a))Ic(a)?(d=Hb(a),a=Ib(a),k=d,e=O(d),d=k):(d=F(a),k=P.c(d,0,null),h=P.c(d,1,null),h.n?h.n(k,this,b,c):h.call(null,k,this,b,c),a=I(a),d=null,e=0),f=0;else return null};g.w=function(a,b,c){ub(b,"#\x3cAtom: ");Ag(this.state,b,c);return ub(b,"\x3e")};g.D=function(){return this.j};
g.ub=function(){return this.state};g.v=function(a,b){return this===b};
var Hg=function(){function a(a){return new Fg(a,null,null,null)}var b=null,c=function(){function a(c,d){var k=null;1<arguments.length&&(k=J(Array.prototype.slice.call(arguments,1),0));return b.call(this,c,k)}function b(a,c){var d=Mc(c)?S.a(Tf,c):c,e=Q.a(d,Gg),d=Q.a(d,pa);return new Fg(a,d,e,null)}a.k=1;a.f=function(a){var c=F(a);a=G(a);return b(c,a)};a.d=b;return a}(),b=function(b,e){switch(arguments.length){case 1:return a.call(this,b);default:return c.d(b,J(arguments,1))}throw Error("Invalid arity: "+
arguments.length);};b.k=1;b.f=c.f;b.b=a;b.d=c.d;return b}();function Ig(a,b){if(a instanceof Fg){var c=a.wc;if(null!=c&&!r(c.b?c.b(b):c.call(null,b)))throw Error("Assert failed: Validator rejected reference state\n"+A.b(Cg.d(J([fd(new Zb(null,"validate","validate",1439230700,null),new Zb(null,"new-value","new-value",-1567397401,null))],0))));c=a.state;a.state=b;null!=a.Wb&&xb(a,c,b);return b}return Dg(a,b)}function K(a){return ab(a)}
var Jg=function(){function a(a,b,c,d){return a instanceof Fg?Ig(a,b.c?b.c(a.state,c,d):b.call(null,a.state,c,d)):Eg.n(a,b,c,d)}function b(a,b,c){return a instanceof Fg?Ig(a,b.a?b.a(a.state,c):b.call(null,a.state,c)):Eg.c(a,b,c)}function c(a,b){return a instanceof Fg?Ig(a,b.b?b.b(a.state):b.call(null,a.state)):Eg.a(a,b)}var d=null,e=function(){function a(c,d,e,f,t){var v=null;4<arguments.length&&(v=J(Array.prototype.slice.call(arguments,4),0));return b.call(this,c,d,e,f,v)}function b(a,c,d,e,f){return a instanceof
Fg?Ig(a,S.s(c,a.state,d,e,f)):Eg.s(a,c,d,e,f)}a.k=4;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=I(a);var e=F(a);a=I(a);var f=F(a);a=G(a);return b(c,d,e,f,a)};a.d=b;return a}(),d=function(d,h,k,l,n){switch(arguments.length){case 2:return c.call(this,d,h);case 3:return b.call(this,d,h,k);case 4:return a.call(this,d,h,k,l);default:return e.d(d,h,k,l,J(arguments,4))}throw Error("Invalid arity: "+arguments.length);};d.k=4;d.f=e.f;d.a=c;d.c=b;d.n=a;d.d=e.d;return d}(),Kg={};
function Lg(a){if(a?a.ac:a)return a.ac(a);var b;b=Lg[m(null==a?null:a)];if(!b&&(b=Lg._,!b))throw x("IEncodeJS.-clj-\x3ejs",a);return b.call(null,a)}function Mg(a){return(a?r(r(null)?null:a.$b)||(a.Cb?0:s(Kg,a)):s(Kg,a))?Lg(a):"string"===typeof a||"number"===typeof a||a instanceof T||a instanceof Zb?Ng.b?Ng.b(a):Ng.call(null,a):Cg.d(J([a],0))}
var Ng=function Og(b){if(null==b)return null;if(b?r(r(null)?null:b.$b)||(b.Cb?0:s(Kg,b)):s(Kg,b))return Lg(b);if(b instanceof T)return id(b);if(b instanceof Zb)return""+A.b(b);if(Gc(b)){var c={};b=E(b);for(var d=null,e=0,f=0;;)if(f<e){var h=d.J(null,f),k=P.c(h,0,null),h=P.c(h,1,null);c[Mg(k)]=Og(h);f+=1}else if(b=E(b))Ic(b)?(e=Hb(b),b=Ib(b),d=e,e=O(e)):(e=F(b),d=P.c(e,0,null),e=P.c(e,1,null),c[Mg(d)]=Og(e),b=I(b),d=null,e=0),f=0;else break;return c}if(Cc(b)){c=[];b=E(Kd.a(Og,b));d=null;for(f=e=0;;)if(f<
e)k=d.J(null,f),c.push(k),f+=1;else if(b=E(b))d=b,Ic(d)?(b=Hb(d),f=Ib(d),d=b,e=O(b),b=f):(b=F(d),c.push(b),b=I(d),d=null,e=0),f=0;else break;return c}return u?b:null},Pg={};function Qg(a,b){if(a?a.Zb:a)return a.Zb(a,b);var c;c=Qg[m(null==a?null:a)];if(!c&&(c=Qg._,!c))throw x("IEncodeClojure.-js-\x3eclj",a);return c.call(null,a,b)}
var Sg=function(){function a(a){return b.d(a,J([new la(null,1,[Rg,!1],null)],0))}var b=null,c=function(){function a(c,d){var k=null;1<arguments.length&&(k=J(Array.prototype.slice.call(arguments,1),0));return b.call(this,c,k)}function b(a,c){if(a?r(r(null)?null:a.Cc)||(a.Cb?0:s(Pg,a)):s(Pg,a))return Qg(a,S.a(Uf,c));if(E(c)){var d=Mc(c)?S.a(Tf,c):c,e=Q.a(d,Rg);return function(a,b,c,d){return function y(e){return Mc(e)?rg.b(Kd.a(y,e)):Cc(e)?Yd(qc(e),Kd.a(y,e)):e instanceof Array?we(Kd.a(y,e)):ta(e)===
Object?Yd(Ye,function(){return function(a,b,c,d){return function Ra(f){return new V(null,function(a,b,c,d){return function(){for(;;){var a=E(f);if(a){if(Ic(a)){var b=Hb(a),c=O(b),h=new ld(Array(c),0);a:{for(var k=0;;)if(k<c){var l=D.a(b,k),l=new W(null,2,5,X,[d.b?d.b(l):d.call(null,l),y(e[l])],null);h.add(l);k+=1}else{b=!0;break a}b=void 0}return b?pd(h.da(),Ra(Ib(a))):pd(h.da(),null)}h=F(a);return M(new W(null,2,5,X,[d.b?d.b(h):d.call(null,h),y(e[h])],null),Ra(G(a)))}return null}}}(a,b,c,d),null,
null)}}(a,b,c,d)(Jc(e))}()):u?e:null}}(c,d,e,r(e)?jd:A)(a)}return null}a.k=1;a.f=function(a){var c=F(a);a=G(a);return b(c,a)};a.d=b;return a}(),b=function(b,e){switch(arguments.length){case 1:return a.call(this,b);default:return c.d(b,J(arguments,1))}throw Error("Invalid arity: "+arguments.length);};b.k=1;b.f=c.f;b.b=a;b.d=c.d;return b}();function Tg(a){this.pb=a;this.q=0;this.i=2153775104}
Tg.prototype.B=function(){for(var a=Cg.d(J([this],0)),b=0,c=0;c<a.length;++c)b=31*b+a.charCodeAt(c),b%=4294967296;return b};Tg.prototype.w=function(a,b){return ub(b,'#uuid "'+A.b(this.pb)+'"')};Tg.prototype.v=function(a,b){return b instanceof Tg&&this.pb===b.pb};Tg.prototype.toString=function(){return this.pb};var Ug=new T(null,"ppath","ppath"),Vg=new T("zip","branch?","zip/branch?"),Wg=new T(null,"r","r"),Xg=new T("zip","children","zip/children"),pa=new T(null,"meta","meta"),qa=new T(null,"dup","dup"),u=new T(null,"else","else"),Gg=new T(null,"validator","validator"),Yb=new T(null,"default","default"),Yg=new T(null,"sequential","sequential"),ma=new T(null,"flush-on-newline","flush-on-newline"),Zg=new T(null,"l","l"),$g=new T("zip","make-node","zip/make-node"),oa=new T(null,"readably","readably"),ra=new T(null,
"print-length","print-length"),ah=new T(null,"pnodes","pnodes"),bh=new T(null,"changed?","changed?"),ch=new T(null,"tag","tag"),dh=new T(null,"set","set"),eh=new T(null,"end","end"),fh=new T(null,"atom","atom"),Rg=new T(null,"keywordize-keys","keywordize-keys"),gh=new T(null,"map","map"),hh=new T("mori","not-found","mori/not-found"),ih=new T("cljs.core","not-found","cljs.core/not-found");var jh,kh;function lh(a){return a.o?a.o():a.call(null)}function mh(a){return a.o?a.o():a.call(null)}var nh=function(){function a(a,b,c){return Gc(c)?hb(c,a,b):null==c?b:c instanceof Array?hc.c(c,a,b):u?gb.c(c,a,b):null}function b(a,b){return c.c(a,a.o?a.o():a.call(null),b)}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}();
function oh(a,b,c,d){if(a?a.Eb:a)return a.Eb(a,b,c,d);var e;e=oh[m(null==a?null:a)];if(!e&&(e=oh._,!e))throw x("CollFold.coll-fold",a);return e.call(null,a,b,c,d)}
var qh=function ph(b,c){"undefined"===typeof jh&&(jh=function(b,c,f,h){this.$=b;this.Qa=c;this.uc=f;this.sc=h;this.q=0;this.i=917504},jh.Db=!0,jh.Bb="clojure.core.reducers/t6322",jh.Tb=function(b,c){return ub(c,"clojure.core.reducers/t6322")},jh.prototype.N=function(b,c){return gb.c(this,c,c.o?c.o():c.call(null))},jh.prototype.M=function(b,c,f){return gb.c(this.Qa,this.$.b?this.$.b(c):this.$.call(null,c),f)},jh.prototype.D=function(){return this.sc},jh.prototype.F=function(b,c){return new jh(this.$,
this.Qa,this.uc,c)});return new jh(c,b,ph,null)},sh=function rh(b,c){"undefined"===typeof kh&&(kh=function(b,c,f,h){this.$=b;this.Qa=c;this.rc=f;this.tc=h;this.q=0;this.i=917504},kh.Db=!0,kh.Bb="clojure.core.reducers/t6328",kh.Tb=function(b,c){return ub(c,"clojure.core.reducers/t6328")},kh.prototype.Eb=function(b,c,f,h){return oh(this.Qa,c,f,this.$.b?this.$.b(h):this.$.call(null,h))},kh.prototype.N=function(b,c){return gb.c(this.Qa,this.$.b?this.$.b(c):this.$.call(null,c),c.o?c.o():c.call(null))},
kh.prototype.M=function(b,c,f){return gb.c(this.Qa,this.$.b?this.$.b(c):this.$.call(null,c),f)},kh.prototype.D=function(){return this.tc},kh.prototype.F=function(b,c){return new kh(this.$,this.Qa,this.rc,c)});return new kh(c,b,rh,null)},th=function(){function a(a,b){return sh(b,function(b){return function(){var c=null;return c=function(c,e,h){switch(arguments.length){case 0:return b.o?b.o():b.call(null);case 2:return b.a?b.a(c,a.b?a.b(e):a.call(null,e)):b.call(null,c,a.b?a.b(e):a.call(null,e));case 3:return b.a?
b.a(c,a.a?a.a(e,h):a.call(null,e,h)):b.call(null,c,a.a?a.a(e,h):a.call(null,e,h))}throw Error("Invalid arity: "+arguments.length);}}()})}function b(a){return function(b){return c.a(a,b)}}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),uh=function(){function a(a,b){return sh(b,function(b){return function(){var c=null;return c=function(c,e,h){switch(arguments.length){case 0:return b.o?
b.o():b.call(null);case 2:return r(a.b?a.b(e):a.call(null,e))?b.a?b.a(c,e):b.call(null,c,e):c;case 3:return r(a.a?a.a(e,h):a.call(null,e,h))?b.c?b.c(c,e,h):b.call(null,c,e,h):c}throw Error("Invalid arity: "+arguments.length);}}()})}function b(a){return function(b){return c.a(a,b)}}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),vh=function(){function a(a){return sh(a,
function(a){return function(){var b=null;return b=function(b,d){switch(arguments.length){case 0:return a.o?a.o():a.call(null);case 2:return Fc(d)?c.b(d).M(null,a,b):a.a?a.a(b,d):a.call(null,b,d)}throw Error("Invalid arity: "+arguments.length);}}()})}function b(){return function(a){return c.b(a)}}var c=null,c=function(c){switch(arguments.length){case 0:return b.call(this);case 1:return a.call(this,c)}throw Error("Invalid arity: "+arguments.length);};c.o=b;c.b=a;return c}(),wh=function(){function a(a,
b){return uh.a(Gd(a),b)}function b(a){return function(b){return c.a(a,b)}}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),xh=function(){function a(a,b){return qh(b,function(b){return function(){var c=null;return c=function(c,e,h){switch(arguments.length){case 0:return b.o?b.o():b.call(null);case 2:return r(a.b?a.b(e):a.call(null,e))?b.a?b.a(c,e):b.call(null,c,e):
new ec(c);case 3:return r(a.a?a.a(e,h):a.call(null,e,h))?b.c?b.c(c,e,h):b.call(null,c,e,h):new ec(c)}throw Error("Invalid arity: "+arguments.length);}}()})}function b(a){return function(b){return c.a(a,b)}}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),yh=function(){function a(a,b){return qh(b,function(b){return function(a){return function(){var c=null;return c=
function(c,d,e){switch(arguments.length){case 0:return b.o?b.o():b.call(null);case 2:return Jg.a(a,Wc),0>ab(a)?new ec(c):b.a?b.a(c,d):b.call(null,c,d);case 3:return Jg.a(a,Wc),0>ab(a)?new ec(c):b.c?b.c(c,d,e):b.call(null,c,d,e)}throw Error("Invalid arity: "+arguments.length);}}()}(Hg.b(a))})}function b(a){return function(b){return c.a(a,b)}}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);
};c.b=b;c.a=a;return c}(),zh=function(){function a(a,b){return qh(b,function(b){return function(a){return function(){var c=null;return c=function(c,d,e){switch(arguments.length){case 0:return b.o?b.o():b.call(null);case 2:return Jg.a(a,Wc),0>ab(a)?b.a?b.a(c,d):b.call(null,c,d):c;case 3:return Jg.a(a,Wc),0>ab(a)?b.c?b.c(c,d,e):b.call(null,c,d,e):c}throw Error("Invalid arity: "+arguments.length);}}()}(Hg.b(a))})}function b(a){return function(b){return c.a(a,b)}}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,
c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),Bh=function Ah(b,c,d,e){if(Bc(b))return d.o?d.o():d.call(null);if(O(b)<=c)return nh.c(e,d.o?d.o():d.call(null),b);if(u){var f=Yc(O(b)),h=ze.c(b,0,f);b=ze.c(b,f,O(b));return lh(function(b,c,e,f){return function(){var b=f(c),h;h=f(e);return d.a?d.a(b.o?b.o():b.call(null),mh(h)):d.call(null,b.o?b.o():b.call(null),mh(h))}}(f,h,b,function(b,f,h){return function(q){return function(){return function(){return Ah(q,
c,d,e)}}(b,f,h)}}(f,h,b)))}return null};W.prototype.Eb=function(a,b,c,d){return Bh(this,b,c,d)};oh.object=function(a,b,c,d){return nh.c(d,c.o?c.o():c.call(null),a)};oh["null"]=function(a,b,c){return c.o?c.o():c.call(null)};function Ch(a,b){var c=S.c(ig,a,b);return M(c,Vd(function(a){return function(b){return a===b}}(c),b))}
var Dh=function(){function a(a,b){return O(a)<O(b)?C.c(pc,b,a):C.c(pc,a,b)}var b=null,c=function(){function a(c,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,d,l)}function b(a,c,d){a=Ch(O,pc.d(d,c,J([a],0)));return C.c(Yd,F(a),G(a))}a.k=2;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=G(a);return b(c,d,a)};a.d=b;return a}(),b=function(b,e,f){switch(arguments.length){case 0:return bg;case 1:return b;case 2:return a.call(this,b,e);default:return c.d(b,
e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;b.o=function(){return bg};b.b=function(a){return a};b.a=a;b.d=c.d;return b}(),Eh=function(){function a(a,b){for(;;)if(O(b)<O(a)){var c=a;a=b;b=c}else return C.c(function(a,b){return function(a,c){return Oc(b,c)?a:Ac.a(a,c)}}(a,b),a,a)}var b=null,c=function(){function a(b,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,b,d,l)}function c(a,d,e){a=Ch(function(a){return-O(a)},
pc.d(e,d,J([a],0)));return C.c(b,F(a),G(a))}a.k=2;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};a.d=c;return a}(),b=function(b,e,f){switch(arguments.length){case 1:return b;case 2:return a.call(this,b,e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;b.b=function(a){return a};b.a=a;b.d=c.d;return b}(),Fh=function(){function a(a,b){return O(a)<O(b)?C.c(function(a,c){return Oc(b,c)?Ac.a(a,c):a},a,a):C.c(Ac,a,b)}var b=null,
c=function(){function a(b,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,b,d,l)}function c(a,d,e){return C.c(b,a,pc.a(e,d))}a.k=2;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};a.d=c;return a}(),b=function(b,e,f){switch(arguments.length){case 1:return b;case 2:return a.call(this,b,e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;b.b=function(a){return a};b.a=a;b.d=
c.d;return b}();function Gh(a,b){return Wb.a(a,b)?new W(null,3,5,X,[null,null,a],null):new W(null,3,5,X,[a,b,null],null)}function Hh(a){return E(a)?C.c(function(a,c){var d=P.c(c,0,null),e=P.c(c,1,null);return R.c(a,d,e)},we(Od.a(S.a(Xc,Ve(a)),null)),a):null}
function Ih(a,b,c){var d=Q.a(a,c),e=Q.a(b,c),f=Jh.a?Jh.a(d,e):Jh.call(null,d,e),h=P.c(f,0,null),k=P.c(f,1,null),f=P.c(f,2,null);a=Oc(a,c);b=Oc(b,c);d=a&&b&&(null!=f||null==d&&null==e);return new W(null,3,5,X,[!a||null==h&&d?null:new af([c,h]),!b||null==k&&d?null:new af([c,k]),d?new af([c,f]):null],null)}
var Kh=function(){function a(a,b,c){return C.c(function(a,b){return rg.b(Kd.c(Zf,a,b))},new W(null,3,5,X,[null,null,null],null),Kd.a(Id.c(Ih,a,b),c))}function b(a,b){return c.c(a,b,Dh.a(Ve(a),Ve(b)))}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}();
function Lh(a,b){return we(Kd.a(Hh,Kh.c(Hc(a)?a:we(a),Hc(b)?b:we(b),pg.b(function(){var c=O(a),d=O(b);return c>d?c:d}()))))}function Mh(a,b){return new W(null,3,5,X,[Cd(Fh.a(a,b)),Cd(Fh.a(b,a)),Cd(Eh.a(a,b))],null)}function Nh(a){if(a?a.qc:a)return a.qc(a);var b;b=Nh[m(null==a?null:a)];if(!b&&(b=Nh._,!b))throw x("EqualityPartition.equality-partition",a);return b.call(null,a)}
function Oh(a,b){if(a?a.pc:a)return a.pc(a,b);var c;c=Oh[m(null==a?null:a)];if(!c&&(c=Oh._,!c))throw x("Diff.diff-similar",a);return c.call(null,a,b)}Nh._=function(a){return(a?a.i&1024||a.cc||(a.i?0:s(Pa,a)):s(Pa,a))?gh:(a?a.i&4096||a.jc||(a.i?0:s(Va,a)):s(Va,a))?dh:(a?a.i&16777216||a.ic||(a.i?0:s(mb,a)):s(mb,a))?Yg:Yb?fh:null};Nh["boolean"]=function(){return fh};Nh["function"]=function(){return fh};Nh.array=function(){return Yg};Nh.number=function(){return fh};Nh.string=function(){return fh};
Nh["null"]=function(){return fh};Oh._=function(a,b){return function(){switch(Nh(a)instanceof T?Nh(a).sa:null){case "map":return Kh;case "sequential":return Lh;case "set":return Mh;case "atom":return Gh;default:throw Error("No matching clause: "+A.b(Nh(a)));}}().call(null,a,b)};Oh["boolean"]=function(a,b){return Gh(a,b)};Oh["function"]=function(a,b){return Gh(a,b)};Oh.array=function(a,b){return Lh(a,b)};Oh.number=function(a,b){return Gh(a,b)};Oh.string=function(a,b){return Gh(a,b)};
Oh["null"]=function(a,b){return Gh(a,b)};function Jh(a,b){return Wb.a(a,b)?new W(null,3,5,X,[null,null,a],null):Wb.a(Nh(a),Nh(b))?Oh(a,b):Gh(a,b)};function Ph(a){if(a?a.Ub:a)return a.Ub();var b;b=Ph[m(null==a?null:a)];if(!b&&(b=Ph._,!b))throw x("PushbackReader.read-char",a);return b.call(null,a)}function Qh(a,b){if(a?a.Vb:a)return a.Vb(0,b);var c;c=Qh[m(null==a?null:a)];if(!c&&(c=Qh._,!c))throw x("PushbackReader.unread",a);return c.call(null,a,b)}function Rh(a,b,c){this.r=a;this.buffer=b;this.Fb=c}Rh.prototype.Ub=function(){return 0===this.buffer.length?(this.Fb+=1,this.r[this.Fb]):this.buffer.pop()};Rh.prototype.Vb=function(a,b){return this.buffer.push(b)};
function Sh(a){var b=!/[^\t\n\r ]/.test(a);return r(b)?b:","===a}var Th=function(){function a(a,d){var e=null;1<arguments.length&&(e=J(Array.prototype.slice.call(arguments,1),0));return b.call(this,0,e)}function b(a,b){throw Error(S.a(A,b));}a.k=1;a.f=function(a){F(a);a=G(a);return b(0,a)};a.d=b;return a}();
function Uh(a,b){for(var c=new ea(b),d=Ph(a);;){var e;if(!(e=null==d||Sh(d))){e=d;var f="#"!==e;e=f?(f="'"!==e)?(f=":"!==e)?Vh.b?Vh.b(e):Vh.call(null,e):f:f:f}if(e)return Qh(a,d),c.toString();c.append(d);d=Ph(a)}}function Wh(a){for(;;){var b=Ph(a);if("\n"===b||"\r"===b||null==b)return a}}var Xh=tg("^([-+]?)(?:(0)|([1-9][0-9]*)|0[xX]([0-9A-Fa-f]+)|0([0-7]+)|([1-9][0-9]?)[rR]([0-9A-Za-z]+))(N)?$"),Yh=tg("^([-+]?[0-9]+)/([0-9]+)$"),Zh=tg("^([-+]?[0-9]+(\\.[0-9]*)?([eE][-+]?[0-9]+)?)(M)?$"),$h=tg("^[:]?([^0-9/].*/)?([^0-9/][^/]*)$");
function ai(a,b){var c=a.exec(b);return null!=c&&c[0]===b?1===c.length?c[0]:c:null}var bi=tg("^[0-9A-Fa-f]{2}$"),ci=tg("^[0-9A-Fa-f]{4}$");function di(a,b,c,d){return r(sg(a,d))?d:Th.d(b,J(["Unexpected unicode escape \\",c,d],0))}function ei(a){return String.fromCharCode(parseInt(a,16))}
function fi(a){var b=Ph(a),c="t"===b?"\t":"r"===b?"\r":"n"===b?"\n":"\\"===b?"\\":'"'===b?'"':"b"===b?"\b":"f"===b?"\f":null;r(c)?a=c:"x"===b?(c=(new ea(Ph(a),Ph(a))).toString(),a=ei(di(bi,a,b,c))):"u"===b?(c=(new ea(Ph(a),Ph(a),Ph(a),Ph(a))).toString(),a=ei(di(ci,a,b,c))):a=/[^0-9]/.test(b)?u?Th.d(a,J(["Unexpected unicode escape \\",b],0)):null:String.fromCharCode(b);return a}
function gi(a,b){for(var c=yb(qe);;){var d;a:{d=Sh;for(var e=b,f=Ph(e);;)if(r(d.b?d.b(f):d.call(null,f)))f=Ph(e);else{d=f;break a}d=void 0}r(d)||Th.d(b,J(["EOF while reading"],0));if(a===d)return Ab(c);e=Vh.b?Vh.b(d):Vh.call(null,d);r(e)?d=e.a?e.a(b,d):e.call(null,b,d):(Qh(b,d),d=hi.n?hi.n(b,!0,null,!0):hi.call(null,b,!0,null));c=d===b?c:wd.a(c,d)}}function ii(a,b){return Th.d(a,J(["Reader for ",b," not implemented yet"],0))}
function ji(a,b){var c=Ph(a),d=ki.b?ki.b(c):ki.call(null,c);if(r(d))return d.a?d.a(a,b):d.call(null,a,b);d=li.a?li.a(a,c):li.call(null,a,c);return r(d)?d:Th.d(a,J(["No dispatch macro for ",c],0))}function mi(a,b){return Th.d(a,J(["Unmached delimiter ",b],0))}function ni(a){return S.a(fd,gi(")",a))}function oi(a){return gi("]",a)}
function pi(a){var b=gi("}",a),c=O(b);if("number"!==typeof c||isNaN(c)||Infinity===c||parseFloat(c)!==parseInt(c,10))throw Error("Argument must be an integer: "+A.b(c));0!==(c&1)&&Th.d(a,J(["Map literal must contain an even number of forms"],0));return S.a(Tf,b)}function qi(a){for(var b=new ea,c=Ph(a);;){if(null==c)return Th.d(a,J(["EOF while reading"],0));if("\\"===c)b.append(fi(a)),c=Ph(a);else{if('"'===c)return b.toString();if(Yb)b.append(c),c=Ph(a);else return null}}}
function ri(a){for(var b=new ea,c=Ph(a);;){if(null==c)return Th.d(a,J(["EOF while reading"],0));if("\\"===c){b.append(c);var d=Ph(a);if(null==d)return Th.d(a,J(["EOF while reading"],0));var e=function(){var a=b;a.append(d);return a}(),f=Ph(a),b=e,c=f}else{if('"'===c)return b.toString();if(u)e=function(){var a=b;a.append(c);return a}(),f=Ph(a),b=e,c=f;else return null}}}
function si(a,b){var c=Uh(a,b);if(r(-1!=c.indexOf("/")))c=$b.a(ad.c(c,0,c.indexOf("/")),ad.c(c,c.indexOf("/")+1,c.length));else var d=$b.b(c),c="nil"===c?null:"true"===c?!0:"false"===c?!1:u?d:null;return c}function ti(a){var b=Uh(a,Ph(a)),c=ai($h,b),b=c[0],d=c[1],c=c[2];return void 0!==d&&":/"===d.substring(d.length-2,d.length)||":"===c[c.length-1]||-1!==b.indexOf("::",1)?Th.d(a,J(["Invalid token: ",b],0)):null!=d&&0<d.length?jd.a(d.substring(0,d.indexOf("/")),c):jd.b(b)}
function ui(a){return function(b){return Da(Da(H,hi.n?hi.n(b,!0,null,!0):hi.call(null,b,!0,null)),a)}}function vi(){return function(a){return Th.d(a,J(["Unreadable form"],0))}}
function wi(a){var b;b=hi.n?hi.n(a,!0,null,!0):hi.call(null,a,!0,null);b=b instanceof Zb?new la(null,1,[ch,b],null):"string"===typeof b?new la(null,1,[ch,b],null):b instanceof T?new af([b,!0]):u?b:null;Gc(b)||Th.d(a,J(["Metadata must be Symbol,Keyword,String or Map"],0));var c=hi.n?hi.n(a,!0,null,!0):hi.call(null,a,!0,null);return(c?c.i&262144||c.oc||(c.i?0:s(db,c)):s(db,c))?N(c,Zf.d(J([xc(c),b],0))):Th.d(a,J(["Metadata can only be applied to IWithMetas"],0))}function xi(a){return eg(gi("}",a))}
function yi(a){return tg(ri(a))}function zi(a){hi.n?hi.n(a,!0,null,!0):hi.call(null,a,!0,null);return a}function Vh(a){return'"'===a?qi:":"===a?ti:";"===a?Wh:"'"===a?ui(new Zb(null,"quote","quote",1377916282,null)):"@"===a?ui(new Zb(null,"deref","deref",1494944732,null)):"^"===a?wi:"`"===a?ii:"~"===a?ii:"("===a?ni:")"===a?mi:"["===a?oi:"]"===a?mi:"{"===a?pi:"}"===a?mi:"\\"===a?Ph:"#"===a?ji:null}function ki(a){return"{"===a?xi:"\x3c"===a?vi():'"'===a?yi:"!"===a?Wh:"_"===a?zi:null}
function hi(a,b,c){for(;;){var d=Ph(a);if(null==d)return r(b)?Th.d(a,J(["EOF while reading"],0)):c;if(!Sh(d))if(";"===d)a=Wh.a?Wh.a(a,d):Wh.call(null,a);else if(u){var e=Vh(d);if(r(e))e=e.a?e.a(a,d):e.call(null,a,d);else{var e=a,f=void 0;!(f=!/[^0-9]/.test(d))&&(f=void 0,f="+"===d||"-"===d)&&(f=Ph(e),Qh(e,f),f=!/[^0-9]/.test(f));if(f)a:{e=a;d=new ea(d);for(f=Ph(e);;){var h;h=null==f;h||(h=(h=Sh(f))?h:Vh.b?Vh.b(f):Vh.call(null,f));if(r(h)){Qh(e,f);f=d=d.toString();h=void 0;if(r(ai(Xh,f)))if(f=ai(Xh,
f),null!=f[2])h=0;else{h=r(f[3])?[f[3],10]:r(f[4])?[f[4],16]:r(f[5])?[f[5],8]:r(f[6])?[f[7],parseInt(f[6],10)]:u?[null,null]:null;var k=h[0];null==k?h=null:(h=parseInt(k,h[1]),h="-"===f[1]?-h:h)}else h=void 0,r(ai(Yh,f))?(f=ai(Yh,f),h=parseInt(f[1],10)/parseInt(f[2],10)):h=r(ai(Zh,f))?parseFloat(f):null;f=h;e=r(f)?f:Th.d(e,J(["Invalid number format [",d,"]"],0));break a}d.append(f);f=Ph(e)}e=void 0}else e=u?si(a,d):null}if(e!==a)return e}else return null}}
function Ai(a){if(Wb.a(3,O(a)))return a;if(3<O(a))return ad.c(a,0,3);if(u)for(a=new ea(a);;)if(3>a.Va.length)a=a.append("0");else return a.toString();else return null}var Bi=function(a,b){return function(c,d){return Q.a(r(d)?b:a,c)}}(new W(null,13,5,X,[null,31,28,31,30,31,30,31,31,30,31,30,31],null),new W(null,13,5,X,[null,31,29,31,30,31,30,31,31,30,31,30,31],null)),Ci=/(\d\d\d\d)(?:-(\d\d)(?:-(\d\d)(?:[T](\d\d)(?::(\d\d)(?::(\d\d)(?:[.](\d+))?)?)?)?)?)?(?:[Z]|([-+])(\d\d):(\d\d))?/;
function Di(a){a=parseInt(a,10);return sa(isNaN(a))?a:null}function Ei(a,b,c,d){a<=b&&b<=c||Th.d(null,J([""+A.b(d)+" Failed:  "+A.b(a)+"\x3c\x3d"+A.b(b)+"\x3c\x3d"+A.b(c)],0));return b}
function Fi(a){var b=sg(Ci,a);P.c(b,0,null);var c=P.c(b,1,null),d=P.c(b,2,null),e=P.c(b,3,null),f=P.c(b,4,null),h=P.c(b,5,null),k=P.c(b,6,null),l=P.c(b,7,null),n=P.c(b,8,null),q=P.c(b,9,null),t=P.c(b,10,null);if(sa(b))return Th.d(null,J(["Unrecognized date/time syntax: "+A.b(a)],0));a=Di(c);var b=function(){var a=Di(d);return r(a)?a:1}(),c=function(){var a=Di(e);return r(a)?a:1}(),v=function(){var a=Di(f);return r(a)?a:0}(),w=function(){var a=Di(h);return r(a)?a:0}(),y=function(){var a=Di(k);return r(a)?
a:0}(),B=function(){var a=Di(Ai(l));return r(a)?a:0}(),n=(Wb.a(n,"-")?-1:1)*(60*function(){var a=Di(q);return r(a)?a:0}()+function(){var a=Di(t);return r(a)?a:0}());return new W(null,8,5,X,[a,Ei(1,b,12,"timestamp month field must be in range 1..12"),Ei(1,c,Bi.a?Bi.a(b,0===(a%4+4)%4&&(0!==(a%100+100)%100||0===(a%400+400)%400)):Bi.call(null,b,0===(a%4+4)%4&&(0!==(a%100+100)%100||0===(a%400+400)%400)),"timestamp day field must be in range 1..last day in month"),Ei(0,v,23,"timestamp hour field must be in range 0..23"),
Ei(0,w,59,"timestamp minute field must be in range 0..59"),Ei(0,y,Wb.a(w,59)?60:59,"timestamp second field must be in range 0..60"),Ei(0,B,999,"timestamp millisecond field must be in range 0..999"),n],null)}
var Gi=Hg.b(new la(null,4,["inst",function(a){var b;if("string"===typeof a)if(b=Fi(a),r(b)){a=P.c(b,0,null);var c=P.c(b,1,null),d=P.c(b,2,null),e=P.c(b,3,null),f=P.c(b,4,null),h=P.c(b,5,null),k=P.c(b,6,null);b=P.c(b,7,null);b=new Date(Date.UTC(a,c-1,d,e,f,h,k)-6E4*b)}else b=Th.d(null,J(["Unrecognized date/time syntax: "+A.b(a)],0));else b=Th.d(null,J(["Instance literal expects a string for its timestamp."],0));return b},"uuid",function(a){return"string"===typeof a?new Tg(a):Th.d(null,J(["UUID literal expects a string as its representation."],
0))},"queue",function(a){return Hc(a)?Yd(Je,a):Th.d(null,J(["Queue literal expects a vector for its elements."],0))},"js",function(a){if(Hc(a)){var b=[];a=E(a);for(var c=null,d=0,e=0;;)if(e<d){var f=c.J(null,e);b.push(f);e+=1}else if(a=E(a))c=a,Ic(c)?(a=Hb(c),e=Ib(c),c=a,d=O(a),a=e):(a=F(c),b.push(a),a=I(c),c=null,d=0),e=0;else break;return b}if(Gc(a)){b={};a=E(a);c=null;for(e=d=0;;)if(e<d){var h=c.J(null,e),f=P.c(h,0,null),h=P.c(h,1,null);b[id(f)]=h;e+=1}else if(a=E(a))Ic(a)?(d=Hb(a),a=Ib(a),c=d,
d=O(d)):(d=F(a),c=P.c(d,0,null),d=P.c(d,1,null),b[id(c)]=d,a=I(a),c=null,d=0),e=0;else break;return b}return u?Th.d(null,J(["JS literal expects a vector or map containing only string or unqualified keyword keys"],0)):null}],null)),Hi=Hg.b(null);
function li(a,b){var c=si(a,b),d=Q.a(ab(Gi),""+A.b(c)),e=ab(Hi);return r(d)?d.b?d.b(hi(a,!0,null)):d.call(null,hi(a,!0,null)):r(e)?e.a?e.a(c,hi(a,!0,null)):e.call(null,c,hi(a,!0,null)):u?Th.d(a,J(["Could not find tag parser for ",""+A.b(c)," in ",Cg.d(J([Ve(ab(Gi))],0))],0)):null};p("mori.apply",S);p("mori.count",O);p("mori.distinct",function(a){return function c(a,e){return new V(null,function(){return function(a,d){for(;;){var e=a,l=P.c(e,0,null);if(e=E(e))if(Oc(d,l))l=G(e),e=d,a=l,d=e;else return M(l,c(G(e),pc.a(d,l)));else return null}}.call(null,a,e)},null,null)}(a,bg)});p("mori.empty",qc);p("mori.first",F);p("mori.rest",G);p("mori.seq",E);p("mori.conj",pc);p("mori.cons",M);
p("mori.find",function(a,b){return null!=a&&Ec(a)&&Oc(a,b)?new W(null,2,5,X,[b,Q.a(a,b)],null):null});p("mori.nth",P);p("mori.last",oc);p("mori.assoc",R);p("mori.dissoc",tc);p("mori.get_in",$d);p("mori.update_in",ae);p("mori.assoc_in",function Ii(b,c,d){var e=P.c(c,0,null);return(c=$c(c))?R.c(b,e,Ii(Q.a(b,e),c,d)):R.c(b,e,d)});p("mori.fnil",Jd);p("mori.disj",Ac);p("mori.pop",zc);p("mori.peek",yc);p("mori.hash",Tb);p("mori.get",Q);p("mori.has_key",Oc);p("mori.is_empty",Bc);p("mori.reverse",ed);
p("mori.take",Md);p("mori.drop",Nd);p("mori.take_nth",function Ji(b,c){return new V(null,function(){var d=E(c);return d?M(F(d),Ji(b,Nd(b,d))):null},null,null)});p("mori.partition",Zd);p("mori.partition_all",jg);p("mori.partition_by",function Ki(b,c){return new V(null,function(){var d=E(c);if(d){var e=F(d),f=b.b?b.b(e):b.call(null,e),e=M(e,lg(function(c,d){return function(c){return Wb.a(d,b.b?b.b(c):b.call(null,c))}}(e,f,d,d),I(d)));return M(e,Ki(b,E(Nd(O(e),d))))}return null},null,null)});
p("mori.iterate",function Li(b,c){return M(c,new V(null,function(){return Li(b,b.b?b.b(c):b.call(null,c))},null,null))});p("mori.into",Yd);p("mori.merge",Zf);p("mori.subvec",ze);p("mori.take_while",lg);p("mori.drop_while",function(a,b){return new V(null,function(c){return function(){return c(a,b)}}(function(a,b){for(;;){var e=E(b),f;f=(f=e)?a.b?a.b(F(e)):a.call(null,F(e)):f;if(r(f))f=a,e=G(e),a=f,b=e;else return e}}),null,null)});
p("mori.group_by",function(a,b){return C.c(function(b,d){var e=a.b?a.b(d):a.call(null,d);return R.c(b,e,pc.a(Q.c(b,e,qe),d))},Ye,b)});p("mori.interpose",function(a,b){return Nd(1,Qd.a(Od.b(a),b))});p("mori.interleave",Qd);p("mori.concat",td);p("mori.conj1",function(a,b){return a.G(null,b)});function Xd(a){return a instanceof Array||Fc(a)}p("mori.flatten",function(a){return Ud(function(a){return!Xd(a)},G(Wd(a)))});p("mori.lazy_seq",function(a){return new V(null,a,null,null)});p("mori.keys",Ve);
p("mori.select_keys",function(a,b){for(var c=Ye,d=E(b);;)if(d)var e=F(d),f=Q.c(a,e,ih),c=Bd.a(f,ih)?R.c(c,e,f):c,d=I(d);else return c});p("mori.vals",We);p("mori.prim_seq",mc);p("mori.map",Kd);p("mori.mapcat",Sd);p("mori.reduce",C);p("mori.reduce_kv",function(a,b,c){return null!=c?hb(c,a,b):b});p("mori.filter",Ud);p("mori.remove",Vd);p("mori.some",Ed);p("mori.every",Dd);p("mori.equals",Wb);p("mori.range",pg);p("mori.repeat",Od);p("mori.repeatedly",Pd);p("mori.sort",Sc);p("mori.sort_by",Tc);
p("mori.into_array",xa);p("mori.subseq",ng);p("mori.rmap",th);p("mori.rfilter",uh);p("mori.rremove",wh);p("mori.rtake",yh);p("mori.rtake_while",xh);p("mori.rdrop",zh);p("mori.rflatten",vh);p("mori.list",fd);p("mori.vector",xe);p("mori.array_map",Uf);p("mori.hash_map",Tf);p("mori.set",eg);p("mori.sorted_set",fg);p("mori.sorted_set_by",gg);p("mori.sorted_map",Vf);p("mori.sorted_map_by",Wf);
p("mori.queue",function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){return Yd.a?Yd.a(Je,a):Yd.call(null,Je,a)}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}());p("mori.keyword",jd);p("mori.symbol",$b);p("mori.zipmap",function(a,b){for(var c=yb(Ye),d=E(a),e=E(b);;)if(d&&e)c=xd.c(c,F(d),F(e)),d=I(d),e=I(e);else return Ab(c)});
p("mori.is_list",function(a){return a?a.i&33554432||a.Ec?!0:a.i?!1:s(nb,a):s(nb,a)});p("mori.is_seq",Mc);p("mori.is_vector",Hc);p("mori.is_map",Gc);p("mori.is_set",Dc);p("mori.is_keyword",function(a){return a instanceof T});p("mori.is_symbol",function(a){return a instanceof Zb});p("mori.is_collection",Cc);p("mori.is_sequential",Fc);p("mori.is_associative",Ec);p("mori.is_counted",ic);p("mori.is_indexed",jc);p("mori.is_reduceable",function(a){return a?a.i&524288||a.Nb?!0:a.i?!1:s(fb,a):s(fb,a)});
p("mori.is_seqable",function(a){return a?a.i&8388608||a.hc?!0:a.i?!1:s(kb,a):s(kb,a)});p("mori.is_reversible",dd);p("mori.union",Dh);p("mori.intersection",Eh);p("mori.difference",Fh);p("mori.is_subset",function(a,b){return O(a)<=O(b)&&Dd(function(a){return Oc(b,a)},a)});p("mori.is_superset",function(a,b){return O(a)>=O(b)&&Dd(function(b){return Oc(a,b)},b)});p("mori.partial",Id);p("mori.comp",Hd);
p("mori.pipeline",function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){return C.a?C.a(function(a,b){return b.b?b.b(a):b.call(null,a)},a):C.call(null,function(a,b){return b.b?b.b(a):b.call(null,a)},a)}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}());
p("mori.curry",function(){function a(a,d){var e=null;1<arguments.length&&(e=J(Array.prototype.slice.call(arguments,1),0));return b.call(this,a,e)}function b(a,b){return function(e){return S.a(a,M.a?M.a(e,b):M.call(null,e,b))}}a.k=1;a.f=function(a){var d=F(a);a=G(a);return b(d,a)};a.d=b;return a}());
p("mori.juxt",function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){return function(){function b(a){var c=null;0<arguments.length&&(c=J(Array.prototype.slice.call(arguments,0),0));return e.call(this,c)}function e(b){return xa.b?xa.b(Kd.a?Kd.a(function(a){return S.a(a,b)},a):Kd.call(null,function(a){return S.a(a,b)},a)):xa.call(null,Kd.a?Kd.a(function(a){return S.a(a,b)},a):Kd.call(null,function(a){return S.a(a,
b)},a))}b.k=0;b.f=function(a){a=E(a);return e(a)};b.d=e;return b}()}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}());
p("mori.knit",function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){return function(b){return xa.b?xa.b(Kd.c?Kd.c(function(a,b){return a.b?a.b(b):a.call(null,b)},a,b):Kd.call(null,function(a,b){return a.b?a.b(b):a.call(null,b)},a,b)):xa.call(null,Kd.c?Kd.c(function(a,b){return a.b?a.b(b):a.call(null,b)},a,b):Kd.call(null,function(a,b){return a.b?a.b(b):a.call(null,b)},a,b))}}a.k=0;a.f=function(a){a=E(a);return b(a)};
a.d=b;return a}());p("mori.diff",Jh);p("mori.sum",function(a,b){return a+b});p("mori.inc",function(a){return a+1});p("mori.dec",function(a){return a-1});p("mori.is_even",function(a){return 0===(a%2+2)%2});p("mori.is_odd",function(a){return 1===(a%2+2)%2});p("mori.each",function(a,b){for(var c=E(a),d=null,e=0,f=0;;)if(f<e){var h=d.J(null,f);b.b?b.b(h):b.call(null,h);f+=1}else if(c=E(c))d=c,Ic(d)?(c=Hb(d),e=Ib(d),d=c,h=O(c),c=e,e=h):(h=F(d),b.b?b.b(h):b.call(null,h),c=I(d),d=null,e=0),f=0;else return null});
p("mori.identity",Fd);p("mori.constantly",function(a){return function(){function b(b){0<arguments.length&&J(Array.prototype.slice.call(arguments,0),0);return a}b.k=0;b.f=function(b){E(b);return a};b.d=function(){return a};return b}()});p("mori.clj_to_js",Ng);
p("mori.js_to_clj",function(){function a(a,b){return Sg.d(a,J([Rg,b],0))}function b(a){return Sg.b(a)}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}());p("mori.parse",function(a){return hi(new Rh(a,[],-1),!1,null)});
p("mori.configure",function(a,b){switch(a){case "print-length":return ia=b;case "print-level":return ja=b;default:throw Error("No matching clause: "+A.b(a));}});
p("mori.proxy",function(a){if("undefined"!==typeof Proxy)return Proxy.create(function(){return{has:function(b){return Oc(a,b)},hasOwn:function(b){return Oc(a,b)},get:function(b,c){var d=Q.c?Q.c(a,c,hh):Q.call(null,a,c,hh);return hd(d,hh)?ic(a)&&"length"===c?O.b?O.b(a):O.call(null,a):null:u?d:null},set:function(){return null},enumerate:function(){return xa.b?xa.b(Ve.b?Ve.b(a):Ve.call(null,a)):xa.call(null,Ve.b?Ve.b(a):Ve.call(null,a))},keys:function(){return Gc(a)?xa.b?xa.b(Ve.b?Ve.b(a):Ve.call(null,
a)):xa.call(null,Ve.b?Ve.b(a):Ve.call(null,a)):Hc(a)?xa.b?xa.b(pg.b?pg.b(O.b?O.b(a):O.call(null,a)):pg.call(null,O.b?O.b(a):O.call(null,a))):xa.call(null,pg.b?pg.b(O.b?O.b(a):O.call(null,a)):pg.call(null,O.b?O.b(a):O.call(null,a))):null}}}());throw Error("ES6 Proxy not supported!");});V.prototype.inspect=function(){return this.toString()};ac.prototype.inspect=function(){return this.toString()};kc.prototype.inspect=function(){return this.toString()};Bf.prototype.inspect=function(){return this.toString()};
vf.prototype.inspect=function(){return this.toString()};wf.prototype.inspect=function(){return this.toString()};bd.prototype.inspect=function(){return this.toString()};gd.prototype.inspect=function(){return this.toString()};cd.prototype.inspect=function(){return this.toString()};W.prototype.inspect=function(){return this.toString()};od.prototype.inspect=function(){return this.toString()};ye.prototype.inspect=function(){return this.toString()};Ae.prototype.inspect=function(){return this.toString()};
$.prototype.inspect=function(){return this.toString()};Y.prototype.inspect=function(){return this.toString()};la.prototype.inspect=function(){return this.toString()};xf.prototype.inspect=function(){return this.toString()};Qf.prototype.inspect=function(){return this.toString()};$f.prototype.inspect=function(){return this.toString()};cg.prototype.inspect=function(){return this.toString()};og.prototype.inspect=function(){return this.toString()};T.prototype.inspect=function(){return this.toString()};
Zb.prototype.inspect=function(){return this.toString()};Ie.prototype.inspect=function(){return this.toString()};He.prototype.inspect=function(){return this.toString()};p("mori._equiv",function(a,b){return a.Hc(b)});p("mori._keys",function(a){return a.keys()});p("mori._values",function(a){return a.values()});p("mori._entries",function(a){return a.entries()});p("mori._has",function(a){return a.has()});p("mori._get",function(a){return a.get()});p("mori._forEach",function(a){return a.forEach()});
p("mori._next",function(a){return a.next()});p("mori.mutable.thaw",function(a){return yb(a)});p("mori.mutable.freeze",vd);p("mori.mutable.conj1",function(a,b){return a.Ka(null,b)});p("mori.mutable.conj",wd);p("mori.mutable.assoc",xd);p("mori.mutable.dissoc",yd);p("mori.mutable.pop",function(a){return Eb(a)});p("mori.mutable.disj",zd);function Mi(a,b,c,d){return N(new W(null,2,5,X,[d,null],null),new la(null,3,[$g,c,Xg,b,Vg,a],null))}function Ni(a){return a.b?a.b(0):a.call(null,0)}function Oi(a){return Vg.b(xc(a)).call(null,Ni(a))}function Pi(a){if(r(Oi(a)))return Xg.b(xc(a)).call(null,Ni(a));throw"called children on a leaf node";}function Qi(a,b,c){return $g.b(xc(a)).call(null,b,c)}
function Ri(a){if(r(Oi(a))){var b=P.c(a,0,null),c=P.c(a,1,null),d=Pi(a),e=P.c(d,0,null),f=$c(d);return r(d)?N(new W(null,2,5,X,[e,new la(null,4,[Zg,qe,ah,r(c)?pc.a(ah.b(c),b):new W(null,1,5,X,[b],null),Ug,c,Wg,f],null)],null),xc(a)):null}return null}
function Si(a){var b=P.c(a,0,null),c=P.c(a,1,null),d=Mc(c)?S.a(Tf,c):c,c=Q.a(d,Zg),e=Q.a(d,Ug),f=Q.a(d,ah),h=Q.a(d,Wg),d=Q.a(d,bh);return r(f)?(f=yc(f),N(r(d)?new W(null,2,5,X,[Qi(a,f,td.a(c,M(b,h))),r(e)?R.c(e,bh,!0):e],null):new W(null,2,5,X,[f,e],null),xc(a))):null}function Ti(a){var b=P.c(a,0,null),c=P.c(a,1,null),c=Mc(c)?S.a(Tf,c):c,d=Q.a(c,Zg),e=Q.a(c,Wg),f=P.c(e,0,null),h=$c(e);return r(r(c)?e:c)?N(new W(null,2,5,X,[f,R.d(c,Zg,pc.a(d,b),J([Wg,h],0))],null),xc(a)):null}
function Ui(a){var b=P.c(a,0,null),c=P.c(a,1,null),c=Mc(c)?S.a(Tf,c):c,d=Q.a(c,Zg),e=Q.a(c,Wg);return r(r(c)?e:c)?N(new W(null,2,5,X,[oc(e),R.d(c,Zg,S.n(pc,d,b,hg(e)),J([Wg,null],0))],null),xc(a)):a}function Vi(a){var b=P.c(a,0,null),c=P.c(a,1,null),c=Mc(c)?S.a(Tf,c):c,d=Q.a(c,Zg),e=Q.a(c,Wg);return r(r(c)?E(d):c)?N(new W(null,2,5,X,[yc(d),R.d(c,Zg,zc(d),J([Wg,M(b,e)],0))],null),xc(a)):null}
function Wi(a,b){P.c(a,0,null);var c=P.c(a,1,null);return N(new W(null,2,5,X,[b,R.c(c,bh,!0)],null),xc(a))}var Xi=function(){function a(a,d,e){var f=null;2<arguments.length&&(f=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,a,d,f)}function b(a,b,e){return Wi(a,S.c(b,Ni(a),e))}a.k=2;a.f=function(a){var d=F(a);a=I(a);var e=F(a);a=G(a);return b(d,e,a)};a.d=b;return a}();p("mori.zip.zipper",Mi);p("mori.zip.seq_zip",function(a){return Mi(Mc,Fd,function(a,c){return N(c,xc(a))},a)});p("mori.zip.vector_zip",function(a){return Mi(Hc,E,function(a,c){return N(we(c),xc(a))},a)});p("mori.zip.node",Ni);p("mori.zip.is_branch",{}.xc);p("mori.zip.children",Pi);p("mori.zip.make_node",Qi);p("mori.zip.path",function(a){return ah.b(a.b?a.b(1):a.call(null,1))});p("mori.zip.lefts",function(a){return E(Zg.b(a.b?a.b(1):a.call(null,1)))});
p("mori.zip.rights",function(a){return Wg.b(a.b?a.b(1):a.call(null,1))});p("mori.zip.down",Ri);p("mori.zip.up",Si);p("mori.zip.root",function(a){for(;;){if(Wb.a(eh,a.b?a.b(1):a.call(null,1)))return Ni(a);var b=Si(a);if(r(b))a=b;else return Ni(a)}});p("mori.zip.right",Ti);p("mori.zip.rightmost",Ui);p("mori.zip.left",Vi);
p("mori.zip.leftmost",function(a){var b=P.c(a,0,null),c=P.c(a,1,null),c=Mc(c)?S.a(Tf,c):c,d=Q.a(c,Zg),e=Q.a(c,Wg);return r(r(c)?E(d):c)?N(new W(null,2,5,X,[F(d),R.d(c,Zg,qe,J([Wg,td.d(G(d),new W(null,1,5,X,[b],null),J([e],0))],0))],null),xc(a)):a});p("mori.zip.insert_left",function(a,b){var c=P.c(a,0,null),d=P.c(a,1,null),d=Mc(d)?S.a(Tf,d):d,e=Q.a(d,Zg);if(null==d)throw"Insert at top";return N(new W(null,2,5,X,[c,R.d(d,Zg,pc.a(e,b),J([bh,!0],0))],null),xc(a))});
p("mori.zip.insert_right",function(a,b){var c=P.c(a,0,null),d=P.c(a,1,null),d=Mc(d)?S.a(Tf,d):d,e=Q.a(d,Wg);if(null==d)throw"Insert at top";return N(new W(null,2,5,X,[c,R.d(d,Wg,M(b,e),J([bh,!0],0))],null),xc(a))});p("mori.zip.replace",Wi);p("mori.zip.edit",Xi);p("mori.zip.insert_child",function(a,b){return Wi(a,Qi(a,Ni(a),M(b,Pi(a))))});p("mori.zip.append_child",function(a,b){return Wi(a,Qi(a,Ni(a),td.a(Pi(a),new W(null,1,5,X,[b],null))))});
p("mori.zip.next",function(a){if(Wb.a(eh,a.b?a.b(1):a.call(null,1)))return a;var b;b=Oi(a);b=r(b)?Ri(a):b;if(r(b))return b;b=Ti(a);if(r(b))return b;for(;;)if(r(Si(a))){b=Ti(Si(a));if(r(b))return b;a=Si(a)}else return new W(null,2,5,X,[Ni(a),eh],null)});p("mori.zip.prev",function(a){var b=Vi(a);if(r(b))for(a=b;;)if(b=Oi(a),b=r(b)?Ri(a):b,r(b))a=Ui(b);else return a;else return Si(a)});p("mori.zip.is_end",function(a){return Wb.a(eh,a.b?a.b(1):a.call(null,1))});
p("mori.zip.remove",function(a){P.c(a,0,null);var b=P.c(a,1,null),b=Mc(b)?S.a(Tf,b):b,c=Q.a(b,Zg),d=Q.a(b,Ug),e=Q.a(b,ah),f=Q.a(b,Wg);if(null==b)throw"Remove at top";if(0<O(c))for(a=N(new W(null,2,5,X,[yc(c),R.d(b,Zg,zc(c),J([bh,!0],0))],null),xc(a));;)if(b=Oi(a),b=r(b)?Ri(a):b,r(b))a=Ui(b);else return a;else return N(new W(null,2,5,X,[Qi(a,yc(e),f),r(d)?R.c(d,bh,!0):d],null),xc(a))});;return this.mori;}.call({});});

},{}],10:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options
) {

  var UnitSequencer = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(UnitSequencer.prototype, {
    initialize: function(opts) {
      opts           = Options.fromObject(opts);
      this._sequence = opts.getOrElse("initialSequence", 0);
    },

    /**
     * Advances its sequence by `by`, or by `1` if `by` is not provided.
     *
     * @param by {number} the amount to advance by. Defaults to `1`.
     * @async
     * @returns {Promise<undefined>}
     */
    advance: Promise.method(function(by) {
      // Wahh wahh - don't use `by || 1`, or you can't advance by 0, which is silly
      // but potentially necessary.
      by             = _.isUndefined(by) ? 1 : by;

      if (by < 0) {
        throw new Error("UnitSequencer#advance() requires positive `by` offset");
      }

      this._sequence = this._sequence + by;
    }),

    /**
     * Returns the current sequence. This value should always be the same
     * or greater than a value returned previously (in time).
     *
     * @returns {number} the current sequence
     */
    value: function() {
      return this._sequence;
    }
  });

  return UnitSequencer;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../options")
);

})()
},{"../options":6,"underscore":56,"bluebird":57}],12:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options
) {

  /**
   * A UnitSequencer which reports its sequence summed with the sequences
   * of its internal collection of sequencers.
   *
   * This device is useful for tracking the state of data comprised from multiple
   * sources. For instance, you might have CachingDataStore(A) storing data
   * from Source(A), tracked by Sequencer(A), and CachingDataStore(B) storing
   * data from Source(B), tracked by Sequencer(B). Meanwhile, you may have
   * CachingDataStore(C), storing data from Source(A + B), and tracked by
   * Sequencer(C) = Sequencer(A + B) - a DelegatingCompositeSequencer.
   *
   * Thus, if Sequencer(A) is advanced, it may invalidate CachingDataStore(A) or
   * CachingDataStore(C) or both.
   *
   * Note this particular usage is generally only useful for Unit sequencers.
   *
   * If you'd like the above functionality, but with Sequencer(A) and
   * Sequencer(B) as ClockSequencers, and Sequencer(C) merely tracking
   * modification, you'd need to use a DelegatingForwardingSequencer for A and B,
   * forwarding them to UnitSequencer(C).
   *
   * DelegatingCompositeSequencer and DelegatingForwardingSequencer are effectivly
   * opposites of each other. DelegatingCompositeSequencer composes the `value`
   * of multiple underlying sequencers (pull), and DelegatingForwardingSequencer
   * forwards the `advance` call to multiple targets (push).
   */
  var DelegatingCompositeSequencer = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(DelegatingCompositeSequencer.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._delegateSequencer = opts.getOrError("delegate");
      this._sequencers = _.clone(opts.getOrElse("sequencers", []));
    },
    addSequencer: function(seq) {
      this._sequencers.push(seq);
    },
    advance: function() {
      var s = this._delegateSequencer;
      return s.advance.apply(s, arguments);
    },
    value: function() {
      return _
        .chain(this._sequencers)
        .invoke("value")
        .reduce(function(sum, n) {
          return sum + n;
        }, 0)
        .value() + this._delegateSequencer.value();
    }
  });

  return DelegatingCompositeSequencer;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../options")
);

})()
},{"../options":6,"bluebird":57,"underscore":56}],11:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options
) {

  /**
   * A Sequencer which advances by reading from a Clock.
   * Note that this ClockSequencer relies on the Clock protocol, which
   * only provides `Clock#getTime()`. It does not modify the clock itself.
   * This means if you're using a LogicalClock, it's still up to the clock's
   * owner to advance the clock for the sequencer to advance.
   */
  var ClockSequencer = function() {
    this.initialize.apply(this, arguments);
  }

  _.extend(ClockSequencer.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);

      this._clock    = opts.getOrError("clock");
      this._sequence = opts.getOrElse("initialSequence", 0);
    },

    /**
     * Advances by setting its sequence to the backing clock's time.
     * Note that if this method is called twice within the same time unit,
     * the sequence will not actually advance, since unique time is not
     * guaranteed by our clocks.
     *
     * @async
     * @returns {Promise<>}
     */
    advance: Promise.method(function() {
      return Promise
        .bind(this)
        .then(function() {
          return this._clock.getTime();
        })
        .then(function(t) {
          this._sequence = t;
        });
    }),

    /**
     * Returns the current sequence. This value should always be the same
     * or greater than a value returned previously (in time).
     *
     * @returns {number} the current sequence
     */
    value: function() {
      return this._sequence;
    }
  });

  return ClockSequencer;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../options")
);

})()
},{"../options":6,"bluebird":57,"underscore":56}],13:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options
) {

  var DelegatingForwardingSequencer = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(DelegatingForwardingSequencer.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._delegateSequencer = opts.getOrError("delegate");
      this._forwardTargets = _.clone(opts.getOrElse("targets", []));
    },
    addTarget: function(seq) {
      this._forwardTargets.push(seq);
    },
    advance: Promise.method(function() {
      var s = this._delegateSequencer;
      return s.advance.apply(s, arguments)
      .bind(this)
      .then(function(val) {
        return Promise
          .all(_.invoke(this._forwardTargets, "advance"))
          .then(function() {
            // Return the value returned by the delegate sequencer's
            // advance call (if any). The advancement of the forward
            // targets should be transparent.
            return val;
          });
      });
    }),
    value: function() {
      var s = this._delegateSequencer;
      return s.value.apply(s, arguments);
    }
  });

  return DelegatingForwardingSequencer;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../options")
);

})()
},{"../options":6,"underscore":56,"bluebird":57}],21:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options
) {
  /**
   * A Clock which allows manually manipulating the underlying time value,
   * irrespective of real time. Useful for testing.
   */
  var LogicalClock = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(LogicalClock.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._currentTime = opts.getOrElse("initialTime", 0);
    },

    /**
     * @async
     * @returns {Promise<number>} Time in milliseconds since epoch
     * @see Clock#getTime()
     */
    getTime: Promise.method(function() {
      return this._currentTime;
    }),

    /**
     * Advances internal time, either `opts.by` a certain offset, or
     * `opts.to` a particular absolute time. If successful, returns the result
     * of calling `LogicalClock#getTime()` as a convenience.
     *
     * @param opts.to {number} absolute time to set clock to. Must be larger
     *                         than the current time
     * @param opts.by {number} offset to add to current time. Must be positive.
     *                         Defaults to `1` if neither `opts.to` or `opts.by`
     *                         are specified.
     * @async
     * @returns {Promise<number>} result of `LogicalClock#getTime()`
     */
    advanceTime: Promise.method(function(opts){
      opts = Options.fromObject(opts);
      var by = opts.getOrElse("by", 1),
          to = opts.getOrElse("to", undefined);
      if (!_.isUndefined(to)) {
        if (to < this._currentTime) {
          throw new Error("LogicalClock#advanceTime() requires forward movement of time")
        }
        this._currentTime = to;
      } else {
        if (by < 0) {
          throw new Error("LogicalClock#advanceTime() requires forward movement of time");
        }
        this._currentTime = this._currentTime + by;
      }
      return this.getTime();
    })
  });

  return LogicalClock;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../../core/options")
);

})()
},{"../../core/options":6,"underscore":56,"bluebird":57}],22:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise
) {

  /**
   * A Clock which delegates to the system clock.
   */
  var SystemClock = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(SystemClock.prototype, {
    initialize: function() {},
    /**
     * @async
     * @returns {Promise<number>} Time in milliseconds since epoch
     * @see Clock#getTime()
     */
    getTime: Promise.method(function() {
      return Date.now();
    })
  });

  return SystemClock;
};

module.exports = mod(
  require("underscore"),
  require("bluebird")
);

})()
},{"underscore":56,"bluebird":57}],24:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  ScopedConfiguration
) {

  /**
   * A device for resolving a set of raw configurations given a set of
   * scopes.
   *
   * This is useful for having things like region- or stage-specific (and/or both)
   * configurations.
   *
   * Given sets of raw configurations of the form:
   *
   *   {
   *     "scope-1" : {
   *       "key1" : "val1"
   *     },
   *     "scope-1+env1": {
   *       "key2" : "val-env-1"
   *     },
   *     "scope-1+env2": {
   *       "key2" : "val-env-2"
   *     }
   *   }
   *
   * `resolve(["scope-1"])` will return:
   *
   *   {
   *     "key1" : "val2"
   *   }
   *
   * `resolve(["scope-1", "env-1"])` will return:
   *
   *   {
   *     "key1" : "val1",
   *     "key2" : "val-env-1"
   *   }
   *
   * `resolve(["scope-1", "env-2"])` will return:
   *
   *   {
   *     "key1" : "val1",
   *     "key2" : "val-env-2"
   *   }
   *
   * Scopes unions are resolved in the following manner:
   *   1. a given scope union's parts are sorted
   *   2. scope unions as a whole are applied in sorted order
   *   3. repeat the process for a given configuration
   *
   * So, given three configs:
   *
   *  {
   *    "aaa": ... // 1
   *    "ccc": ... // 2
   *  }
   *
   *  {
   *    "aaa+ccc": ... // 3
   *    "ccc"    : ... // 4
   *  }
   *
   *  {
   *    "aaa+bbb": ... // 5
   *    "bbb"    : ... // 6
   *  }
   *
   * The resulting order will be:
   *   1, 2, 4, 3, 6, 5
   *
   * Notice 3 comes before 5 even though it's logically "after" in sorted order,
   * because configuration order overrides scope order. That is, scope unions
   * are ordered within a config, and then in config order.
   *
   */
  var ScopedConfigurationResolver = function() {
    this.initialize.apply(this, arguments);
  }

  _.extend(ScopedConfigurationResolver.prototype, {
    initialize: function() {
      this._configs = [];
    },

    /**
     * A rawConfig is a set of configuration scopes and their configuration
     * values, e.g.:
     *
     *   {
     *     "scope-1" : {
     *       "key1" : "val1"
     *     },
     *     "scope-1+env1": {
     *       "key2" : "val-env-1"
     *     },
     *     "scope-1+env2": {
     *       "key2" : "val-env-2"
     *     }
     *   }
     *
     * Note that the plus (+) sign is reserved for specifying scope unions.
     *
     * @param rawConfig {object} (required)
     *
     * @returns this
     */
    add: function(rawConfig) {
      this._configs.push(new ScopedConfiguration(rawConfig));
      return this;
    },

    /**
     * Resolves a computed final configuration given a set of scopes to apply,
     * and a set of configs loaded via `ScopedConfigurationResolver#add()`.
     *
     * @param scopes {Array<string>}
     *
     * @returns {object} the computed configuration
     */
    resolve: function(scopes) {
      scopes = powerset(_.clone(scopes).sort());
      scopes.shift(); // Get rid of the empty set.

      scopes = _.collect(scopes, function(s) {
        return s.join("+");
      });

      var relevantConfigs = _
        .chain(this._configs)
        .collect(function(c) {
          return _.collect(scopes, function(scope) {
            return c.blobForScope(scope);
          })
        }).flatten().value();

      relevantConfigs.unshift({});
      return _.extend.apply(_, relevantConfigs);
    }
  });

  var powerset = function (ary) {
      var ps = [[]];
      for (var i=0; i < ary.length; i++) {
          for (var j = 0, len = ps.length; j < len; j++) {
              ps.push(ps[j].concat(ary[i]));
          }
      }
      return ps;
  }

  return ScopedConfigurationResolver;
};

module.exports = mod(
  require("underscore"),
  require("./scoped-configuration")
);

})()
},{"./scoped-configuration":25,"underscore":56}],25:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _
) {

  /**
   * Given a raw config, ensures blobs can be fetched regardless of
   * scope union scope (i.e., does union canonicalization).
   *
   * For example, a config with scope union `"bbb+aaa"` can later be
   * fetched using either `"aaa+bbb"` or `"bbb+aaa"`. It does this
   * by uniformly ordering the union's composite scopes.
   *
   * This probably isn't a useful class on its own. Instead, defer to
   * `ScopedConfigurationResolver` or `ConfigurationMagic`.
   */
  var ScopedConfiguration = function() {
    this.initialize.apply(this, arguments);
  }

  _.extend(ScopedConfiguration.prototype, {
    initialize: function(rawConfig) {
      rawConfig = rawConfig || {};
      this._scopes = {};
      // Sort the scope strings
      _.each(rawConfig, function(config, scopeString) {
        var scope = scopeString.split("+").sort().join("+");
        this._scopes[scope] = config;
      }, this);
    },

    blobForScope: function(scope) {
      return _.clone(this._scopes[scope.split("+").sort().join("+")] || {});
    }
  });

  return ScopedConfiguration;
};

module.exports = mod(
  require("underscore")
);

})()
},{"underscore":56}],27:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Ref,
  Options
) {

  var Logger = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Logger.prototype, {

    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._name         = opts.getOrElse("name", "Default");
      this._logLevel     = opts.getOrElse("logLevel", LogUtil.Level.Info);
      this._parent       = opts.getOrElseFn("refParent", function() { return Ref(null) });

      this._appenders = [];
    },

    trace: function() {
      this._log(LogUtil.Level.Trace, _.toArray(arguments));
    },

    debug: function() {
      this._log(LogUtil.Level.Debug, _.toArray(arguments));
    },

    info: function() {
      this._log(LogUtil.Level.Info, _.toArray(arguments));
    },

    warn: function() {
      this._log(LogUtil.Level.Warn, _.toArray(arguments));
    },

    error: function() {
      this._log(LogUtil.Level.Error, _.toArray(arguments));
    },

    fatal: function() {
      this._log(LogUtil.Level.Fatal, _.toArray(arguments));
    },

    isTraceEnabled: function() {
      return this.isLogLevelEnabled(LogUtil.Level.Trace);
    },

    isDebugEnabled: function() {
      return this.isLogLevelEnabled(LogUtil.Level.Debug);
    },

    isInfoEnabled: function() {
      return this.isLogLevelEnabled(LogUtil.Level.Info);
    },

    isWarnEnabled: function() {
      return this.isLogLevelEnabled(LogUtil.Level.Warn);
    },

    isErrorEnabled: function() {
      return this.isLogLevelEnabled(LogUtil.Level.Error);
    },

    isFatalEnabled: function() {
      return this.isLogLevelEnabled(LogUtil.Level.Fatal);
    },

    isLogLevelEnabled: function(logLevel) {
      var coercedLogLevel = b(logLevel);
      return (this._logLevel & coercedLogLevel) === coercedLogLevel;
    },

    addAppender: function(appender) {
      this._appenders.push(appender);
    },

    setLogLevel: function(logLevel) {
      // Save a copy for the potential error message
      var originalLogLevel = logLevel;

      // If name is specified, e.g., "Info", convert to
      // int
      if (_.isString(logLevel)) {
        logLevel = LogUtil.Level[logLevel]
      }

      var exists = _.detect(LogUtil.Level, function(level, name) {
        return level === logLevel;
      });

      if (!exists) {
        throw new Error("Invalid logLevel: " + originalLogLevel);
      }

      this._logLevel = logLevel;
    },


    _log: function(logLevel, logArgs) {
      this._logWithMetadata([], logLevel, logArgs);
    },

    _logWithMetadata: function(descendants, logLevel, args) {
      if (this.isLogLevelEnabled(logLevel)) {
        _.each(this._appenders, function(appender) {
          appender.log(this._name, descendants, logLevel, LogUtil._Label[logLevel], args);
        }, this);
      }

      if (this._parent.get()) {
        this._parent.get()._logWithMetadata([this._name].concat(descendants), logLevel, args);
      }
    }
  });

  var LogUtil = function() {
    this.initialize.apply(this, arguments);
  };

  // Coerce (just use rightmost 8 bits)!; because JS is dumb, and everything is
  // actually a float with 53-bit precision
  var b = function(v) {
    return 0xFF & v;
  };

  _.extend(LogUtil, {
    Level: {
      Trace: b(parseInt("111111", 2)),
      Debug: b(parseInt("011111", 2)),
      Info:  b(parseInt("001111", 2)),
      Warn:  b(parseInt("000111", 2)),
      Error: b(parseInt("000011", 2)),
      Fatal: b(parseInt("000001", 2))
    }
  });

  _.extend(LogUtil.prototype, {
    Level: LogUtil.Level,
    initialize: function() {
      this._rootLogger = Ref(new Logger({
        name: "Root"
      }));
    },

    create: function(name, opts) {
      opts = _.clone(opts || {});

      var parent;
      if (opts.parent) {
        parent = Ref(opts.parent);
        delete(opts.parent);
      } else {
        parent = Ref.delegating(this._rootLogger);
      }

      opts.refParent = parent;

      opts.name = name;

      return new Logger(opts);
    },

    root: function() {
      return this._rootLogger.get();
    },

    resetRootLogger: function() {
      this._rootLogger.set(new Logger({
        name: "Root"
      }));
    }
  });


  LogUtil._Label = _.reduce(LogUtil.Level, function(memo, val, key) {
    memo[val] = key;
    return memo;
  }, {});

  return new LogUtil();
};

module.exports = mod(
  require("underscore"),
  require("../ref"),
  require("../options")
);

})()
},{"../options":6,"../ref":41,"underscore":56}],29:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  M,
  UUID,
  Options,
  StateGuard
) {

  var Channel = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Channel.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);

      this._sentinel      = opts.getOrError("sentinel");
      this._stateGuard    = new StateGuard(["disposed"]);
      this._subscriptions = M.hash_map();
    },

    reset: function() {
      M.each(this._subscriptions, function(pair) {
        M.nth(pair, 1).dispose();
      });
      this._subscriptions = M.hash_map();
    },

    publish: function(sentinel, msg) {
      return this._publish.apply(this, arguments);
    },


    subscribe: function(handler) {
      return this._subscribe.apply(this, arguments);
    },


    dispose: function() {
      return this._dispose.apply(this, arguments);
    },


    isDisposed: function() {
      return this._stateGuard.applied("disposed");
    },


    _publish: function(sentinel, msg) {
      this._stateGuard.deny("disposed");

      if (this._sentinel !== sentinel) {
        throw new Error("Invalid sentinel provided; publisher must have same sentinel provided during instantiation.");
      }
      this._dispatch(msg);
      return true;
    },


    _subscribe: function(handler) {
      this._stateGuard.deny("disposed");

      var sub = new Subscription(this, handler),
          id  = sub.id();

      this._subscriptions = M.assoc(this._subscriptions, id, sub);

      return sub;
    },


    _dispose: function() {
      if (this._stateGuard.applied("disposed")) {
        return;
      }

      // Gnarly, as this hops back and forth between the channel and the sub, but
      // easier than splitting the dispose logic into two methods in the sub.
      M.each(this._subscriptions, function(pair) {
        M.nth(pair, 1).dispose();
      });

      this._subscriptions = M.hash_map();

      this._stateGuard.apply("disposed");
    },


    _dispatch: function(msg) {
      M.each(this._subscriptions, function(pair) {
        M.nth(pair, 1).dispatch(msg);
      });
    },


    _disposeHandle: function(id) {
      this._subscriptions = M.dissoc(this._subscriptions, id);
    }
  });

  var Subscription = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Subscription.prototype, {
    initialize: function(channel, handler) {
      this._id         = UUID.v4();
      this._channel    = channel;
      this._handler    = handler;
      this._stateGuard = new StateGuard(["disposed"]);

      _.bindAll(this, "dispose");
    },


    dispose: function() {
      if (this._stateGuard.applied("disposed")) {
        return;
      }

      this._channel._disposeHandle(this._id);

      this._handler = null;
      this._channel = null;

      this._stateGuard.apply("disposed");
    },


    id: function() {
      return this._id;
    },


    dispatch: function(msg) {
      if (this._stateGuard.applied("disposed")) {
        return;
      }

      this._handler(msg);
    }
  });

  return Channel;
};

module.exports = mod(
  require("underscore"),
  require("mori"),
  require("../uuid"),
  require("../options"),
  require("../state-guard")
);

})()
},{"../options":6,"../uuid":36,"../state-guard":8,"underscore":56,"mori":58}],30:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  M,
  Options,
  Channel
) {

  var ChainedChannel = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(ChainedChannel.prototype, Channel.prototype, {
    initialize: function(opts) {
      Channel.prototype.initialize.apply(this, arguments);
      opts = Options.fromObject(opts);

      _.bindAll(this, "_forward");
      this._chainedSubs = M.vector();

      var initiallyChainedTo = opts.getOrElse("chainTo");
      if (initiallyChainedTo) {
        this.chainTo(initiallyChainedTo);
      }
    },

    chainTo: function(otherChannel) {
      this._chainedSubs = M.conj(this._chainedSubs, otherChannel.subscribe(this._forward));
    },

    dispose: function() {
      var subs = this._chainedSubs;

      this._chainedSubs = M.vector();

      M.each(subs, function(sub) {
        sub.dispose();
      });

      return this._dispose.apply(this, arguments);
    },

    _forward: function(msg) {
      this._publish(this._sentinel, msg);
    }
  });

  return ChainedChannel;
};

module.exports = mod(
  require("underscore"),
  require("mori"),
  require("../options"),
  require("./channel")
);

})()
},{"../options":6,"./channel":29,"underscore":56,"mori":58}],31:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  M,
  Options,
  Channel
) {

  var CompositeChannel = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(CompositeChannel.prototype, Channel.prototype, {
    initialize: function(opts) {
      Channel.prototype.initialize.apply(this, arguments);
      opts = Options.fromObject(opts);

      this._forwarding = M.hash_map();

      var listen = opts.getOrElse("listen", []);
      if (!_.isArray(listen)) {
        listen = [listen];
      }

      _.each(listen, _.bind(function(c) {
        this.listen(c);
      }, this));
    },


    dispose: function() {
      Channel.prototype.dispose.apply(this, arguments);
      var forwarding = this._forwarding;
      this._forwarding = M.hash_map();

      M.each(forwarding, _.bind(function(pair) {
        M.nth(pair, 1).dispose();
      }, this));
    },


    listen: function(channel) {
      var sub = channel.subscribe(_.bind(function(msg) {
        this._forward(msg)
      }, this));
      this._forwarding = M.assoc(this._forwarding, channel, sub);

      return {
        dispose: _.bind(function() {
          this._forwarding = M.dissoc(this._forwarding, channel);
          sub.dispose();
        }, this)
      };
    },


    _forward: function(msg) {
      this.publish(this._sentinel, msg);
    }
  });

  return CompositeChannel;
};

module.exports = mod(
  require("underscore"),
  require("mori"),
  require("../options"),
  require("./channel")
);

})()
},{"../options":6,"./channel":29,"underscore":56,"mori":58}],34:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  M,
  Options,
  UUID,
  StateGuard,
  Logger
) {

  var InMemoryFiber = (function() {
    var Klass = function() {
      this.initialize.apply(this, arguments);
    };

    var Log = Logger.create("InMemoryLogger");

    _.extend(Klass.prototype, {
      initialize: function(opts) {
        opts = Options.fromObject(opts);

        this._entities = M.hash_map();
        this._identity = opts.getOrElse("identity", UUID.v4());

        this._stateGuard = new StateGuard(["disposed"]);

        _.bindAll(this, "_receive");
      },


      id: function() {
        return this._identity;
      },


      dispose: function() {
        if (this._stateGuard.applied("disposed")) {
          return;
        }
        this._dispose();
        this._stateGuard.apply("disposed");
      },

      _dispose: function() {

        var entities = this._entities;
        M.each(entities, function(pair) {
          M.nth(pair, 1).dispose();
        });

        this._entities = null;
      },

      registerEntity: function(opts) {
        opts = Options.fromObject(opts);

        var identity = opts.getOrError("identity"),
            entity   = new LocalEntity({
              identity: identity,
              delegate: opts.getOrError("delegate")
            });

        this._entities = M.assoc(this._entities, identity, entity);
        return true;
      },

      /**
       * Returns a promise which is fulfilled when the message is
       * sent, not received by the remote end. This to let the
       * caller know whether or not the message is stuck
       * in a buffer somewhere when calculating its timeouts.
       */
      send: Promise.method(function(opts) {
        this._stateGuard.deny("disposed");

        opts = Options.fromObject(opts);
        var from   = opts.getOrError("from"),
            to     = opts.getOrError("to"),
            body   = opts.getOrError("body"),
            msgId  = opts.getOrError("msgId"),

            mT     = opts.getOrElse("mT"),
            rMsgId = opts.getOrElse("rMsgId");


        //XXX: This is in-memory, so it's as simple
        // as invoking _receive in a future call stack
        return Promise
          .bind(this)
          .then(function() {
            _.defer(this._receive, {
              from:   from,
              to:     to,
              body:   body,
              msgId:  msgId,
              mT:     mT,
              rMsgId: rMsgId,
              oFib:   this._identity
            });
          })
          .then(function() {
            return msgId;
          });
      }),

      _receive: function(env) {
        if (this._stateGuard.applied("disposed")) {
          return;
        }

        env = Options.fromObject(env);
        var to, from, body, msgId, originFiber, mT, rMsgId;

        try {
          to          = env.getOrError("to");
          from        = env.getOrError("from");
          body        = env.getOrError("body");
          msgId       = env.getOrError("msgId");

          // Future-proofing for multi-fiber fabric.
          originFiber = env.getOrError("oFib");

          mT     = env.getOrElse("mT");
          rMsgId = env.getOrElse("rMsgId");
        } catch (e) {
          Log.error("Received malformed message", env);
        }

        var entity = M.get(this._entities, to);

        if (entity) {
          entity.dispatch({
            to:     to,
            from:   from,
            body:   body,
            msgId:  msgId,
            rMsgId: rMsgId,
            oFib:   originFiber,
            hFib:   this._identity,
            mT: mT
          });
        }
      }
    });

    return Klass;
  })();



  var LocalEntity = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(LocalEntity.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);

      this._identity = opts.getOrError("identity");
      this._delegate = opts.getOrError("delegate");
      this._stateGuard = new StateGuard(["disposed"]);
    },
    dispose: function() {
      if (this._stateGuard.applied("disposed")) {
        return;
      }

      this._delegate = null;

      this._stateGuard.apply("disposed");
    },
    dispatch: function(env) {
      this._stateGuard.deny("disposed");

      this._delegate.receiveFiberMessage(env);
    }
  });

  return InMemoryFiber;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("mori"),
  require("../../core/options"),
  require("../../core/uuid"),
  require("../../core/state-guard"),
  require("../../core/logging/logger")
);

})()
},{"../../core/options":6,"../../core/uuid":36,"../../core/state-guard":8,"../../core/logging/logger":27,"underscore":56,"bluebird":57,"mori":58}],35:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  M,
  Options,
  InMemoryFiber,
  Channel,
  CompositeChannel
) {

  /**
   * LinkableFiber is a reference implementation for implementing a multi-fiber "fabric".
   */
  var LinkableFiber = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(LinkableFiber.prototype, InMemoryFiber.prototype, {
    initialize: function(opts) {
      InMemoryFiber.prototype.initialize.apply(this, arguments);
      opts = Options.fromObject(opts);


      this._localDispatch  = new Channel({ sentinel: this });
      this._ingressChannel = new CompositeChannel({
        sentinel: this,
        listen:   this._localDispatch
      });

      this._egressChannel  = new Channel({ sentinel: this });

      // _receive is defined and bound in InMemoryFiber ("protected" method)
      this._ingressChannel.subscribe(this._receive);
    },


    listen: function(channel) {
      this._ingressChannel.listen(channel);
    },


    egressChannel: function() {
      return this._egressChannel;
    },


    _dispose: function() {
      InMemoryFiber.prototype._dispose.apply(this, arguments);
    },

    send: Promise.method(function(opts) {
      this._stateGuard.deny("disposed");

      opts = Options.fromObject(opts);

      var from   = opts.getOrError("from"),
          to     = opts.getOrError("to"),
          body   = opts.getOrError("body"),
          msgId  = opts.getOrError("msgId"),
          mT     = opts.getOrElse("mT"),
          rMsgId = opts.getOrElse("rMsgId"),
          chan   = null;

      var msg = {
        from:   from,
        to:     to,
        body:   body,
        msgId:  msgId,
        mT:     mT,
        rMsgId: rMsgId,
        oFib:   this._identity
      };

      // Local dispatch, skip the round-trip
      if (M.get(this._entities, to)) {
        chan = this._localDispatch;
      } else {
        chan = this._egressChannel;
      }

      _.defer(_.bind(function() {
        chan.publish(this, msg);
      }, this));

      return msgId;
    })


  });

  return LinkableFiber;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("mori"),
  require("../../core/options"),
  require("./in-memory-fiber"),
  require("../../core/channel/channel"),
  require("../../core/channel/composite-channel")
);

})()
},{"../../core/options":6,"./in-memory-fiber":34,"../../core/channel/channel":29,"../../core/channel/composite-channel":31,"underscore":56,"bluebird":57,"mori":58}],37:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _
) {

  var JSONSerde = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(JSONSerde.prototype, {
    initialize: function() {},


    serialize: function(payload, opts) {
      return JSON.stringify(payload);
    },


    deserialize: function(payload, opts) {
      return JSON.parse(payload);
    }
  });

  return JSONSerde;
};

module.exports = mod(
  require("underscore")
);

})()
},{"underscore":56}],41:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Ref,
  DelegatingRef
) {

  var helper = function(val) {
    return new Ref(val);
  };

  helper.delegating = function(ref) {
    return new DelegatingRef(ref);
  };

  return helper;
};

module.exports = mod(
  require("underscore"),
  require("./ref"),
  require("./delegating-ref")
);

})()
},{"./ref":54,"./delegating-ref":53,"underscore":56}],57:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var Promise = require("./promise.js")();
module.exports = Promise;
},{"./promise.js":59}],28:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options
) {

  var ConsoleLogAppender = function() {
    this.initialize.apply(this, arguments);
  };

  var p = function(num) {
    if (("" + num).length === 1) {
      return "0" + num;
    } else {
      return num;
    }
  };

  _.extend(ConsoleLogAppender.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._console = opts.getOrElse("console", console);
      this._timeDelegate = opts.getOrElse("timeDelegate", function(){
        var d = new Date();
        return [d.getUTCFullYear(), p(d.getUTCMonth()), p(d.getUTCDay())].join("/") +
          " " + [p(d.getUTCHours()), p(d.getUTCMinutes()), p(d.getUTCSeconds())].join(":") +
          "." + d.getUTCMilliseconds();
      });
    },

    log: function(loggerName, descendants, logLevel, logLevelName, args) {
      // Use the furthest ancestor as the logged name (since it originated there)
      var furthestAncestor = descendants[descendants.length - 1];
      if (furthestAncestor) {
        loggerName = furthestAncestor;
      }
      this._log(["["+logLevelName+"]["+this._getTime()+"]["+loggerName+"]"].concat(args));
    },

    _getTime: function() {
      return this._timeDelegate();
    },

    _log: function(logItems) {
      // Why does he do this? Is he insane? Well, yes.
      //
      // But mostly, I do this because console.log isn't, in all cases,
      // something you can call .apply on. Last I checked, in IE calling
      // console.log.apply(console, []) will throw an error. So that's why the
      // big ugly switch.
      //
      // If you need more than 7 items, well, I can't help you (but you can - add another
      // switch case).
      switch(logItems.length) {
        case 0:
          this._console.log();
          break;
        case 1:
          this._console.log(logItems[0]);
          break;
        case 2:
          this._console.log(logItems[0], logItems[1]);
          break;
        case 3:
          this._console.log(logItems[0], logItems[1], logItems[2]);
          break;
        case 4:
          this._console.log(logItems[0], logItems[1], logItems[2], logItems[3]);
          break;
        case 5:
          this._console.log(logItems[0], logItems[1], logItems[2], logItems[3], logItems[4]);
          break;
        case 6:
          this._console.log(logItems[0], logItems[1], logItems[2], logItems[3], logItems[4], logItems[5]);
          break;
        case 7:
          this._console.log(logItems[0], logItems[1], logItems[2], logItems[3], logItems[4], logItems[5], logItems[6]);
          break;
        default:
          var label = logItems.shift();
          this._console.log(label, logItems);
      }
    }
  });

  return ConsoleLogAppender;
};

module.exports = mod(
  require("underscore"),
  require("../../options")
);

})()
},{"../../options":6,"underscore":56}],43:[function(require,module,exports){
"use strict";

var mod = function(
  _,
  Promise,
  Options,
  Logger,
  ConfigurationMagic,
  AppContainer
) {
  var Log = Logger.create("Bootstrapper");

  var Bootstrapper = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Bootstrapper.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._configs = opts.getOrError("configurations");
      this._scopes = opts.getOrError("scopes");
      this._appKlass = opts.getOrError("applicationConstructor");
    },
    bootstrap: Promise.method(function() {
      return Promise
        .bind(this)
        .then(function() {
          var config       = ConfigurationMagic.resolveConfig(this._scopes, this._configs),
              AppKlass     = this._appKlass;

          Log.info("Using resolved configuration: ", JSON.stringify(config));

          var app          = new AppKlass({configuration: config}),
              appContainer = new AppContainer({app: app});

          return appContainer;
        });
    })
  });

  return Bootstrapper;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../core/options"),
  require("../core/logging/logger"),
  require("./configuration-magic"),
  require("./web-app-container")
);

},{"../core/options":6,"../core/logging/logger":27,"./configuration-magic":23,"./web-app-container":44,"underscore":56,"bluebird":57}],44:[function(require,module,exports){
(function(){/*global require: false, module: false, process: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options,
  Logger
) {

  var Log = Logger.create("AppContainer");

  var WebAppContainer = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(WebAppContainer.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts)
      this._app = opts.getOrError("app");
    },

    start: Promise.method(function() {
      return Promise
        .bind(this)
        .then(function() {
          return this._app.start();
        });
    }),

    stop: Promise.method(function(reason) {
      return this._app.stop().then(function() {
        if (reason) {
          Log.error("Stopping due to reason:", reason);
        }
      });
    })
  });

  return WebAppContainer;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../core/options"),
  require("../core/logging/logger")
);

})()
},{"../core/options":6,"../core/logging/logger":27,"underscore":56,"bluebird":57}],45:[function(require,module,exports){
"use strict";

var mod = function(
  _
) {

  var WebScheduler = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(WebScheduler.prototype, {
    initialize: function() {},

    runSoon: function(fn) {
      this.schedule(fn);
    },

    schedule: function(fn, delay) {
      delay = delay || 1;
      return setTimeout(fn, delay);
    },

    unschedule: function(id) {
      return clearTimeout(id);
    }
  });

  return WebScheduler;
};

module.exports = mod(
  require("underscore")
);

},{"underscore":56}],47:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options,
  Ref,
  SetTimeoutScheduler
) {

  var DefaultRuntime = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(DefaultRuntime.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);

      this._schedulerRef = Ref(opts.getOrElseFn("scheduler", function() {
        return new SetTimeoutScheduler();
      }));
    },

    /**
     * @returns {Ref<Scheduler>}
     */
    scheduler: function() {
      return Ref.delegating(this._schedulerRef);
    },

    setScheduler: function(scheduler) {
      this._schedulerRef.set(scheduler);
    }
  });

  return DefaultRuntime;
};

module.exports = mod(
  require("underscore"),
  require("../core/options"),
  require("../core/ref"),
  require("../core/scheduler/set-timeout-scheduler")
);

})()
},{"../core/options":6,"../core/scheduler/set-timeout-scheduler":55,"../core/ref":41,"underscore":56}],49:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options
) {

  var StoreEntry = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(StoreEntry.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      // Perfectly acceptable to pass in undefined...
      this._value = opts.getOrElse("value", undefined);
      this._lastSequence = opts.getOrError("initialSequence");

      this._ttl = opts.getOrElse("ttl");
    },

    isExpired: function(sequence, fallbackTtl) {
      var ttl = this._ttl || fallbackTtl;
      if (!ttl) {
        throw new Error("No TTL specified!");
      }
      // E.g., lastSequence = 4, ttl = 1, sequence = 5: expired
      //       lastSequence = 4, ttl = 1, sequence = 4: not expired
      //       lastSequence = 4, ttl = 2, sequence = 5: not expired
      return !(this._lastSequence + ttl > sequence);
    },

    touch: function(sequence) {
      this._lastSequence = sequence;
    },

    update: function(val, sequence, opts) {
      this._value        = val;
      this._lastSequence = sequence;

      opts = Options.fromObject(opts);
      this._ttl = opts.getOrElse("ttl");
    },

    dispose: function() {
      this._value        = null;
      this._lastSequence = null;
    },

    value: function() {
      return this._value;
    }
  });

  return StoreEntry;
};

module.exports = mod(
  require("underscore"),
  require("../../core/options")
);

})()
},{"../../core/options":6,"underscore":56}],48:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Logger,
  Options
) {

  var TEN_MINUTES_IN_MILLISECONDS = 60 * 1000 * 10;

  var Log = Logger.create("ProcessKeepAlive");

  var ProcessKeepAlive = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(ProcessKeepAlive.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._scheduler = opts.getOrError("scheduler");
      this._timeoutId = null;

      _.bindAll(this, "_cycle");
    },
    start: function() {
      Log.debug("Starting ProcessKeepAlive");
      this._cycle();
    },
    stop: function() {
      Log.debug("Stopping ProcessKeepAlive");
      if (this._timeoutId) {
        this._scheduler.get().unschedule(this._timeoutId);
        this._timeoutId = null;
      }
    },
    _cycle: function() {
      this._timeoutId = this._scheduler.get().schedule(
        this._cycle,
        TEN_MINUTES_IN_MILLISECONDS
      );
    }
  });

  return ProcessKeepAlive;
};

module.exports = mod(
  require("underscore"),
  require("../../core/logging/logger"),
  require("../../core/options")
);

})()
},{"../../core/logging/logger":27,"../../core/options":6,"underscore":56}],51:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  M,
  Options,
  UUID,
  ChainedChannel,
  Channel,
  CompositeChannel,
  StateGuard
) {


  var Mailbox = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Mailbox.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._id                    = UUID.v4();
      this._ownerIdentity         = opts.getOrError("ownerIdentity");
      this._exchange              = opts.getOrError("exchange");
      this._oneShotChannel        = new Channel({ sentinel: this });
      this._requestReplyChannel   = new Channel({ sentinel: this });
      this._ingressChannel        = new CompositeChannel({
        sentinel: this,
        listen: [this._oneShotChannel, this._requestReplyChannel]
      });
      this._stateGuard            = new StateGuard(["disposed"]);

      this._outstandingRequestIds = M.set();
    },

    id: function() {
      return this._id;
    },

    ownerIdentity: function() {
      return this._ownerIdentity;
    },

    dispose: function() {
      if (this._stateGuard.applied("disposed")){
        return;
      }

      this._oneShotChannel.dispose();
      this._requestReplyChannel.dispose();
      this._ingressChannel.dispose();

      // Attempt to cancel all outstanding requests.
      // This is an async request, so we just have to fire and
      // forge them.
      //
      // If you're disposing of a mailbox before requests
      // complete, you might have a bad time. The good
      // news is because responses are ferried back from the fiber
      // to the mailbox caller via the Promise interface rather
      // than channels, they should still get CancellationErrors
      var reqs = this._outstandingRequestIds;
      this._outstandingRequestIds = M.set();

      M.each(reqs, _.bind(function(reqId) {
        this._exchange.cancelSendAndReceive(reqId);
      }, this));

      this._oneShotChannel      = null;
      this._requestReplyChannel = null;
      this._ingressChannel      = null;

      this._stateGuard.apply("disposed");
    },

    /**
     * Returns a new ChainedChannel chained to this Mailbox's
     * privately-owned inbound Channel.
     * @returns {ChainedChannel}
     */
    ingressChannel: function() {
      return this._ingressChannel;
    },

    oneShotChannel: function() {
      return this._oneShotChannel;
    },

    requestReplyChannel: function() {
      return this._requestReplyChannel;
    },

    send: Promise.method(function(env) {
      this._stateGuard.deny("disposed");

      env = _.extend({}, env || {}, {
        from: this._ownerIdentity
      });
      return this._exchange.send(env);
    }),

    reply: Promise.method(function(msgId, env) {
      this._stateGuard.deny("disposed");

      env = _.extend({}, env || {}, {
        rMsgId: msgId,
        from: this._ownerIdentity
      });

      return this._exchange.reply(env);
    }),

    sendAndReceive: Promise.method(function(env, opts) {
      this._stateGuard.deny("disposed");

      var reqId = (opts || {}).reqId || UUID.v4();

      env = _.extend({}, env || {}, {
        from: this._ownerIdentity
      });

      opts = _.extend({}, opts || {}, {
        reqId: reqId
      });

      this._outstandingRequestIds = M.conj(this._outstandingRequestIds, reqId);

      return this._exchange
        .sendAndReceive(env, opts)
        .bind(this)
        .then(function(resp) {
          this._outstandingRequestIds = M.disj(this._outstandingRequestIds, reqId);
          return resp;
        })
        .caught(Promise.CancellationError, function(err) {
          this._outstandingRequestIds = M.disj(this._outstandingRequestIds, reqId);
          throw err;
        })
        .caught(Promise.TimeoutError, function(err) {
          this._outstandingRequestIds = M.disj(this._outstandingRequestIds, reqId);
          throw err;
        });
    }),


    outstandingRequestCount: function() {
      return M.count(this._outstandingRequestIds);
    },


    cancelSendAndReceive: Promise.method(function(reqId) {
      return this._exchange
        .cancelSendAndReceive(reqId)
        .bind(this)
        .then(function() {
          this._outstandingRequestIds = M.disj(this._outstandingRequestIds, reqId);
        });
    }),

    _receiveOneShot: function(msg) {
      this._oneShotChannel.publish(this, msg);
    },

    _receiveRequestReply: function(msg) {
      this._requestReplyChannel.publish(this, msg);
    }
  });

  return Mailbox;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("mori"),
  require("../../core/options"),
  require("../../core/uuid"),
  require("../../core/channel/chained-channel"),
  require("../../core/channel/channel"),
  require("../../core/channel/composite-channel"),
  require("../../core/state-guard")
);

})()
},{"../../core/options":6,"../../core/uuid":36,"../../core/channel/chained-channel":30,"../../core/channel/channel":29,"../../core/channel/composite-channel":31,"../../core/state-guard":8,"underscore":56,"bluebird":57,"mori":58}],60:[function(require,module,exports){
// shim for using process in browser

var process = module.exports = {};

process.nextTick = (function () {
    var canSetImmediate = typeof window !== 'undefined'
    && window.setImmediate;
    var canPost = typeof window !== 'undefined'
    && window.postMessage && window.addEventListener
    ;

    if (canSetImmediate) {
        return function (f) { return window.setImmediate(f) };
    }

    if (canPost) {
        var queue = [];
        window.addEventListener('message', function (ev) {
            var source = ev.source;
            if ((source === window || source === null) && ev.data === 'process-tick') {
                ev.stopPropagation();
                if (queue.length > 0) {
                    var fn = queue.shift();
                    fn();
                }
            }
        }, true);

        return function nextTick(fn) {
            queue.push(fn);
            window.postMessage('process-tick', '*');
        };
    }

    return function nextTick(fn) {
        setTimeout(fn, 0);
    };
})();

process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];

process.binding = function (name) {
    throw new Error('process.binding is not supported');
}

// TODO(shtylman)
process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};

},{}],59:[function(require,module,exports){
(function(process){/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var old;
if (typeof Promise !== "undefined") old = Promise;
function noConflict(bluebird) {
    try { if (Promise === bluebird) Promise = old; }
    catch (e) {}
    return bluebird;
}
module.exports = function() {
var util = require("./util.js");
var async = require("./async.js");
var errors = require("./errors.js");

var INTERNAL = function(){};
var APPLY = {};
var NEXT_FILTER = {e: null};

var cast = require("./thenables.js")(Promise, INTERNAL);
var PromiseArray = require("./promise_array.js")(Promise, INTERNAL, cast);
var CapturedTrace = require("./captured_trace.js")();
var CatchFilter = require("./catch_filter.js")(NEXT_FILTER);
var PromiseResolver = require("./promise_resolver.js");

var isArray = util.isArray;

var errorObj = util.errorObj;
var tryCatch1 = util.tryCatch1;
var tryCatch2 = util.tryCatch2;
var tryCatchApply = util.tryCatchApply;
var RangeError = errors.RangeError;
var TypeError = errors.TypeError;
var CancellationError = errors.CancellationError;
var TimeoutError = errors.TimeoutError;
var OperationalError = errors.OperationalError;
var originatesFromRejection = errors.originatesFromRejection;
var markAsOriginatingFromRejection = errors.markAsOriginatingFromRejection;
var canAttach = errors.canAttach;
var thrower = util.thrower;
var apiRejection = require("./errors_api_rejection")(Promise);


var makeSelfResolutionError = function Promise$_makeSelfResolutionError() {
    return new TypeError("circular promise resolution chain");
};

function Promise(resolver) {
    if (typeof resolver !== "function") {
        throw new TypeError("the promise constructor requires a resolver function");
    }
    if (this.constructor !== Promise) {
        throw new TypeError("the promise constructor cannot be invoked directly");
    }
    this._bitField = 0;
    this._fulfillmentHandler0 = void 0;
    this._rejectionHandler0 = void 0;
    this._promise0 = void 0;
    this._receiver0 = void 0;
    this._settledValue = void 0;
    this._boundTo = void 0;
    if (resolver !== INTERNAL) this._resolveFromResolver(resolver);
}

Promise.prototype.bind = function Promise$bind(thisArg) {
    var ret = new Promise(INTERNAL);
    ret._follow(this);
    ret._propagateFrom(this, 2 | 1);
    ret._setBoundTo(thisArg);
    return ret;
};

Promise.prototype.toString = function Promise$toString() {
    return "[object Promise]";
};

Promise.prototype.caught = Promise.prototype["catch"] =
function Promise$catch(fn) {
    var len = arguments.length;
    if (len > 1) {
        var catchInstances = new Array(len - 1),
            j = 0, i;
        for (i = 0; i < len - 1; ++i) {
            var item = arguments[i];
            if (typeof item === "function") {
                catchInstances[j++] = item;
            } else {
                var catchFilterTypeError =
                    new TypeError(
                        "A catch filter must be an error constructor "
                        + "or a filter function");

                this._attachExtraTrace(catchFilterTypeError);
                async.invoke(this._reject, this, catchFilterTypeError);
                return;
            }
        }
        catchInstances.length = j;
        fn = arguments[i];

        this._resetTrace();
        var catchFilter = new CatchFilter(catchInstances, fn, this);
        return this._then(void 0, catchFilter.doFilter, void 0,
            catchFilter, void 0);
    }
    return this._then(void 0, fn, void 0, void 0, void 0);
};

Promise.prototype.then =
function Promise$then(didFulfill, didReject, didProgress) {
    return this._then(didFulfill, didReject, didProgress,
        void 0, void 0);
};


Promise.prototype.done =
function Promise$done(didFulfill, didReject, didProgress) {
    var promise = this._then(didFulfill, didReject, didProgress,
        void 0, void 0);
    promise._setIsFinal();
};

Promise.prototype.spread = function Promise$spread(didFulfill, didReject) {
    return this._then(didFulfill, didReject, void 0,
        APPLY, void 0);
};

Promise.prototype.isCancellable = function Promise$isCancellable() {
    return !this.isResolved() &&
        this._cancellable();
};

Promise.prototype.toJSON = function Promise$toJSON() {
    var ret = {
        isFulfilled: false,
        isRejected: false,
        fulfillmentValue: void 0,
        rejectionReason: void 0
    };
    if (this.isFulfilled()) {
        ret.fulfillmentValue = this._settledValue;
        ret.isFulfilled = true;
    } else if (this.isRejected()) {
        ret.rejectionReason = this._settledValue;
        ret.isRejected = true;
    }
    return ret;
};

Promise.prototype.all = function Promise$all() {
    return new PromiseArray(this).promise();
};


Promise.is = function Promise$Is(val) {
    return val instanceof Promise;
};

Promise.all = function Promise$All(promises) {
    return new PromiseArray(promises).promise();
};

Promise.prototype.error = function Promise$_error(fn) {
    return this.caught(originatesFromRejection, fn);
};

Promise.prototype._resolveFromSyncValue =
function Promise$_resolveFromSyncValue(value) {
    if (value === errorObj) {
        this._cleanValues();
        this._setRejected();
        this._settledValue = value.e;
        this._ensurePossibleRejectionHandled();
    } else {
        var maybePromise = cast(value, void 0);
        if (maybePromise instanceof Promise) {
            this._follow(maybePromise);
        } else {
            this._cleanValues();
            this._setFulfilled();
            this._settledValue = value;
        }
    }
};

Promise.method = function Promise$_Method(fn) {
    if (typeof fn !== "function") {
        throw new TypeError("fn must be a function");
    }
    return function Promise$_method() {
        var value;
        switch(arguments.length) {
        case 0: value = tryCatch1(fn, this, void 0); break;
        case 1: value = tryCatch1(fn, this, arguments[0]); break;
        case 2: value = tryCatch2(fn, this, arguments[0], arguments[1]); break;
        default:
            var $_len = arguments.length;var args = new Array($_len); for(var $_i = 0; $_i < $_len; ++$_i) {args[$_i] = arguments[$_i];}
            value = tryCatchApply(fn, args, this); break;
        }
        var ret = new Promise(INTERNAL);
        ret._setTrace(void 0);
        ret._resolveFromSyncValue(value);
        return ret;
    };
};

Promise.attempt = Promise["try"] = function Promise$_Try(fn, args, ctx) {
    if (typeof fn !== "function") {
        return apiRejection("fn must be a function");
    }
    var value = isArray(args)
        ? tryCatchApply(fn, args, ctx)
        : tryCatch1(fn, ctx, args);

    var ret = new Promise(INTERNAL);
    ret._setTrace(void 0);
    ret._resolveFromSyncValue(value);
    return ret;
};

Promise.defer = Promise.pending = function Promise$Defer() {
    var promise = new Promise(INTERNAL);
    promise._setTrace(void 0);
    return new PromiseResolver(promise);
};

Promise.bind = function Promise$Bind(thisArg) {
    var ret = new Promise(INTERNAL);
    ret._setTrace(void 0);
    ret._setFulfilled();
    ret._setBoundTo(thisArg);
    return ret;
};

Promise.cast = function Promise$_Cast(obj) {
    var ret = cast(obj, void 0);
    if (!(ret instanceof Promise)) {
        var val = ret;
        ret = new Promise(INTERNAL);
        ret._setTrace(void 0);
        ret._setFulfilled();
        ret._cleanValues();
        ret._settledValue = val;
    }
    return ret;
};

Promise.resolve = Promise.fulfilled = Promise.cast;

Promise.reject = Promise.rejected = function Promise$Reject(reason) {
    var ret = new Promise(INTERNAL);
    ret._setTrace(void 0);
    markAsOriginatingFromRejection(reason);
    ret._cleanValues();
    ret._setRejected();
    ret._settledValue = reason;
    if (!canAttach(reason)) {
        var trace = new Error(reason + "");
        ret._setCarriedStackTrace(trace);
    }
    ret._ensurePossibleRejectionHandled();
    return ret;
};

Promise.onPossiblyUnhandledRejection =
function Promise$OnPossiblyUnhandledRejection(fn) {
        CapturedTrace.possiblyUnhandledRejection = typeof fn === "function"
                                                    ? fn : void 0;
};

var unhandledRejectionHandled;
Promise.onUnhandledRejectionHandled =
function Promise$onUnhandledRejectionHandled(fn) {
    unhandledRejectionHandled = typeof fn === "function" ? fn : void 0;
};

var debugging = false || !!(
    typeof process !== "undefined" &&
    typeof process.execPath === "string" &&
    typeof process.env === "object" &&
    (process.env["BLUEBIRD_DEBUG"] ||
        process.env["NODE_ENV"] === "development")
);


Promise.longStackTraces = function Promise$LongStackTraces() {
    if (async.haveItemsQueued() &&
        debugging === false
   ) {
        throw new Error("cannot enable long stack traces after promises have been created");
    }
    debugging = CapturedTrace.isSupported();
};

Promise.hasLongStackTraces = function Promise$HasLongStackTraces() {
    return debugging && CapturedTrace.isSupported();
};

Promise.prototype._then =
function Promise$_then(
    didFulfill,
    didReject,
    didProgress,
    receiver,
    internalData
) {
    var haveInternalData = internalData !== void 0;
    var ret = haveInternalData ? internalData : new Promise(INTERNAL);

    if (!haveInternalData) {
        if (debugging) {
            var haveSameContext = this._peekContext() === this._traceParent;
            ret._traceParent = haveSameContext ? this._traceParent : this;
        }
        ret._propagateFrom(this, 7);
    }

    var callbackIndex =
        this._addCallbacks(didFulfill, didReject, didProgress, ret, receiver);

    if (this.isResolved()) {
        async.invoke(this._queueSettleAt, this, callbackIndex);
    }

    return ret;
};

Promise.prototype._length = function Promise$_length() {
    return this._bitField & 262143;
};

Promise.prototype._isFollowingOrFulfilledOrRejected =
function Promise$_isFollowingOrFulfilledOrRejected() {
    return (this._bitField & 939524096) > 0;
};

Promise.prototype._isFollowing = function Promise$_isFollowing() {
    return (this._bitField & 536870912) === 536870912;
};

Promise.prototype._setLength = function Promise$_setLength(len) {
    this._bitField = (this._bitField & -262144) |
        (len & 262143);
};

Promise.prototype._setFulfilled = function Promise$_setFulfilled() {
    this._bitField = this._bitField | 268435456;
};

Promise.prototype._setRejected = function Promise$_setRejected() {
    this._bitField = this._bitField | 134217728;
};

Promise.prototype._setFollowing = function Promise$_setFollowing() {
    this._bitField = this._bitField | 536870912;
};

Promise.prototype._setIsFinal = function Promise$_setIsFinal() {
    this._bitField = this._bitField | 33554432;
};

Promise.prototype._isFinal = function Promise$_isFinal() {
    return (this._bitField & 33554432) > 0;
};

Promise.prototype._cancellable = function Promise$_cancellable() {
    return (this._bitField & 67108864) > 0;
};

Promise.prototype._setCancellable = function Promise$_setCancellable() {
    this._bitField = this._bitField | 67108864;
};

Promise.prototype._unsetCancellable = function Promise$_unsetCancellable() {
    this._bitField = this._bitField & (~67108864);
};

Promise.prototype._setRejectionIsUnhandled =
function Promise$_setRejectionIsUnhandled() {
    this._bitField = this._bitField | 2097152;
};

Promise.prototype._unsetRejectionIsUnhandled =
function Promise$_unsetRejectionIsUnhandled() {
    this._bitField = this._bitField & (~2097152);
    if (this._isUnhandledRejectionNotified()) {
        this._unsetUnhandledRejectionIsNotified();
        this._notifyUnhandledRejectionIsHandled();
    }
};

Promise.prototype._isRejectionUnhandled =
function Promise$_isRejectionUnhandled() {
    return (this._bitField & 2097152) > 0;
};

Promise.prototype._setUnhandledRejectionIsNotified =
function Promise$_setUnhandledRejectionIsNotified() {
    this._bitField = this._bitField | 524288;
};

Promise.prototype._unsetUnhandledRejectionIsNotified =
function Promise$_unsetUnhandledRejectionIsNotified() {
    this._bitField = this._bitField & (~524288);
};

Promise.prototype._isUnhandledRejectionNotified =
function Promise$_isUnhandledRejectionNotified() {
    return (this._bitField & 524288) > 0;
};

Promise.prototype._setCarriedStackTrace =
function Promise$_setCarriedStackTrace(capturedTrace) {
    this._bitField = this._bitField | 1048576;
    this._fulfillmentHandler0 = capturedTrace;
};

Promise.prototype._unsetCarriedStackTrace =
function Promise$_unsetCarriedStackTrace() {
    this._bitField = this._bitField & (~1048576);
    this._fulfillmentHandler0 = void 0;
};

Promise.prototype._isCarryingStackTrace =
function Promise$_isCarryingStackTrace() {
    return (this._bitField & 1048576) > 0;
};

Promise.prototype._getCarriedStackTrace =
function Promise$_getCarriedStackTrace() {
    return this._isCarryingStackTrace()
        ? this._fulfillmentHandler0
        : void 0;
};

Promise.prototype._receiverAt = function Promise$_receiverAt(index) {
    var ret = index === 0
        ? this._receiver0
        : this[(index << 2) + index - 5 + 4];
    if (this._isBound() && ret === void 0) {
        return this._boundTo;
    }
    return ret;
};

Promise.prototype._promiseAt = function Promise$_promiseAt(index) {
    return index === 0
        ? this._promise0
        : this[(index << 2) + index - 5 + 3];
};

Promise.prototype._fulfillmentHandlerAt =
function Promise$_fulfillmentHandlerAt(index) {
    return index === 0
        ? this._fulfillmentHandler0
        : this[(index << 2) + index - 5 + 0];
};

Promise.prototype._rejectionHandlerAt =
function Promise$_rejectionHandlerAt(index) {
    return index === 0
        ? this._rejectionHandler0
        : this[(index << 2) + index - 5 + 1];
};

Promise.prototype._addCallbacks = function Promise$_addCallbacks(
    fulfill,
    reject,
    progress,
    promise,
    receiver
) {
    var index = this._length();

    if (index >= 262143 - 5) {
        index = 0;
        this._setLength(0);
    }

    if (index === 0) {
        this._promise0 = promise;
        if (receiver !== void 0) this._receiver0 = receiver;
        if (typeof fulfill === "function" && !this._isCarryingStackTrace())
            this._fulfillmentHandler0 = fulfill;
        if (typeof reject === "function") this._rejectionHandler0 = reject;
        if (typeof progress === "function") this._progressHandler0 = progress;
    } else {
        var base = (index << 2) + index - 5;
        this[base + 3] = promise;
        this[base + 4] = receiver;
        this[base + 0] = typeof fulfill === "function"
                                            ? fulfill : void 0;
        this[base + 1] = typeof reject === "function"
                                            ? reject : void 0;
        this[base + 2] = typeof progress === "function"
                                            ? progress : void 0;
    }
    this._setLength(index + 1);
    return index;
};

Promise.prototype._setProxyHandlers =
function Promise$_setProxyHandlers(receiver, promiseSlotValue) {
    var index = this._length();

    if (index >= 262143 - 5) {
        index = 0;
        this._setLength(0);
    }
    if (index === 0) {
        this._promise0 = promiseSlotValue;
        this._receiver0 = receiver;
    } else {
        var base = (index << 2) + index - 5;
        this[base + 3] = promiseSlotValue;
        this[base + 4] = receiver;
        this[base + 0] =
        this[base + 1] =
        this[base + 2] = void 0;
    }
    this._setLength(index + 1);
};

Promise.prototype._proxyPromiseArray =
function Promise$_proxyPromiseArray(promiseArray, index) {
    this._setProxyHandlers(promiseArray, index);
};

Promise.prototype._proxyPromise = function Promise$_proxyPromise(promise) {
    promise._setProxied();
    this._setProxyHandlers(promise, -1);
};

Promise.prototype._setBoundTo = function Promise$_setBoundTo(obj) {
    if (obj !== void 0) {
        this._bitField = this._bitField | 8388608;
        this._boundTo = obj;
    } else {
        this._bitField = this._bitField & (~8388608);
    }
};

Promise.prototype._isBound = function Promise$_isBound() {
    return (this._bitField & 8388608) === 8388608;
};

Promise.prototype._resolveFromResolver =
function Promise$_resolveFromResolver(resolver) {
    var promise = this;
    this._setTrace(void 0);
    this._pushContext();

    function Promise$_resolver(val) {
        if (promise._tryFollow(val)) {
            return;
        }
        promise._fulfill(val);
    }
    function Promise$_rejecter(val) {
        var trace = canAttach(val) ? val : new Error(val + "");
        promise._attachExtraTrace(trace);
        markAsOriginatingFromRejection(val);
        promise._reject(val, trace === val ? void 0 : trace);
    }
    var r = tryCatch2(resolver, void 0, Promise$_resolver, Promise$_rejecter);
    this._popContext();

    if (r !== void 0 && r === errorObj) {
        var e = r.e;
        var trace = canAttach(e) ? e : new Error(e + "");
        promise._reject(e, trace);
    }
};

Promise.prototype._spreadSlowCase =
function Promise$_spreadSlowCase(targetFn, promise, values, boundTo) {
    var promiseForAll = new PromiseArray(values).promise();
    var promise2 = promiseForAll._then(function() {
        return targetFn.apply(boundTo, arguments);
    }, void 0, void 0, APPLY, void 0);
    promise._follow(promise2);
};

Promise.prototype._callSpread =
function Promise$_callSpread(handler, promise, value) {
    var boundTo = this._boundTo;
    if (isArray(value)) {
        for (var i = 0, len = value.length; i < len; ++i) {
            if (cast(value[i], void 0) instanceof Promise) {
                this._spreadSlowCase(handler, promise, value, boundTo);
                return;
            }
        }
    }
    promise._pushContext();
    return tryCatchApply(handler, value, boundTo);
};

Promise.prototype._callHandler =
function Promise$_callHandler(
    handler, receiver, promise, value) {
    var x;
    if (receiver === APPLY && !this.isRejected()) {
        x = this._callSpread(handler, promise, value);
    } else {
        promise._pushContext();
        x = tryCatch1(handler, receiver, value);
    }
    promise._popContext();
    return x;
};

Promise.prototype._settlePromiseFromHandler =
function Promise$_settlePromiseFromHandler(
    handler, receiver, value, promise
) {
    if (!(promise instanceof Promise)) {
        handler.call(receiver, value, promise);
        return;
    }
    var x = this._callHandler(handler, receiver, promise, value);
    if (promise._isFollowing()) return;

    if (x === errorObj || x === promise || x === NEXT_FILTER) {
        var err = x === promise
                    ? makeSelfResolutionError()
                    : x.e;
        var trace = canAttach(err) ? err : new Error(err + "");
        if (x !== NEXT_FILTER) promise._attachExtraTrace(trace);
        promise._rejectUnchecked(err, trace);
    } else {
        var castValue = cast(x, promise);
        if (castValue instanceof Promise) {
            if (castValue.isRejected() &&
                !castValue._isCarryingStackTrace() &&
                !canAttach(castValue._settledValue)) {
                var trace = new Error(castValue._settledValue + "");
                promise._attachExtraTrace(trace);
                castValue._setCarriedStackTrace(trace);
            }
            promise._follow(castValue);
            promise._propagateFrom(castValue, 1);
        } else {
            promise._fulfillUnchecked(x);
        }
    }
};

Promise.prototype._follow =
function Promise$_follow(promise) {
    this._setFollowing();

    if (promise.isPending()) {
        this._propagateFrom(promise, 1);
        promise._proxyPromise(this);
    } else if (promise.isFulfilled()) {
        this._fulfillUnchecked(promise._settledValue);
    } else {
        this._rejectUnchecked(promise._settledValue,
            promise._getCarriedStackTrace());
    }

    if (promise._isRejectionUnhandled()) promise._unsetRejectionIsUnhandled();

    if (debugging &&
        promise._traceParent == null) {
        promise._traceParent = this;
    }
};

Promise.prototype._tryFollow =
function Promise$_tryFollow(value) {
    if (this._isFollowingOrFulfilledOrRejected() ||
        value === this) {
        return false;
    }
    var maybePromise = cast(value, void 0);
    if (!(maybePromise instanceof Promise)) {
        return false;
    }
    this._follow(maybePromise);
    return true;
};

Promise.prototype._resetTrace = function Promise$_resetTrace() {
    if (debugging) {
        this._trace = new CapturedTrace(this._peekContext() === void 0);
    }
};

Promise.prototype._setTrace = function Promise$_setTrace(parent) {
    if (debugging) {
        var context = this._peekContext();
        this._traceParent = context;
        var isTopLevel = context === void 0;
        if (parent !== void 0 &&
            parent._traceParent === context) {
            this._trace = parent._trace;
        } else {
            this._trace = new CapturedTrace(isTopLevel);
        }
    }
    return this;
};

Promise.prototype._attachExtraTrace =
function Promise$_attachExtraTrace(error) {
    if (debugging) {
        var promise = this;
        var stack = error.stack;
        stack = typeof stack === "string" ? stack.split("\n") : [];
        CapturedTrace.protectErrorMessageNewlines(stack);
        var headerLineCount = 1;
        var combinedTraces = 1;
        while(promise != null &&
            promise._trace != null) {
            stack = CapturedTrace.combine(
                stack,
                promise._trace.stack.split("\n")
            );
            promise = promise._traceParent;
            combinedTraces++;
        }

        var stackTraceLimit = Error.stackTraceLimit || 10;
        var max = (stackTraceLimit + headerLineCount) * combinedTraces;
        var len = stack.length;
        if (len > max) {
            stack.length = max;
        }

        if (len > 0)
            stack[0] = stack[0].split("\u0002\u0000\u0001").join("\n");

        if (stack.length <= headerLineCount) {
            error.stack = "(No stack trace)";
        } else {
            error.stack = stack.join("\n");
        }
    }
};

Promise.prototype._cleanValues = function Promise$_cleanValues() {
    if (this._cancellable()) {
        this._cancellationParent = void 0;
    }
};

Promise.prototype._propagateFrom =
function Promise$_propagateFrom(parent, flags) {
    if ((flags & 1) > 0 && parent._cancellable()) {
        this._setCancellable();
        this._cancellationParent = parent;
    }
    if ((flags & 4) > 0) {
        this._setBoundTo(parent._boundTo);
    }
    if ((flags & 2) > 0) {
        this._setTrace(parent);
    }
};

Promise.prototype._fulfill = function Promise$_fulfill(value) {
    if (this._isFollowingOrFulfilledOrRejected()) return;
    this._fulfillUnchecked(value);
};

Promise.prototype._reject =
function Promise$_reject(reason, carriedStackTrace) {
    if (this._isFollowingOrFulfilledOrRejected()) return;
    this._rejectUnchecked(reason, carriedStackTrace);
};

Promise.prototype._settlePromiseAt = function Promise$_settlePromiseAt(index) {
    var handler = this.isFulfilled()
        ? this._fulfillmentHandlerAt(index)
        : this._rejectionHandlerAt(index);

    var value = this._settledValue;
    var receiver = this._receiverAt(index);
    var promise = this._promiseAt(index);

    if (typeof handler === "function") {
        this._settlePromiseFromHandler(handler, receiver, value, promise);
    } else {
        var done = false;
        var isFulfilled = this.isFulfilled();
        if (receiver !== void 0) {
            if (receiver instanceof Promise &&
                receiver._isProxied()) {
                receiver._unsetProxied();

                if (isFulfilled) receiver._fulfillUnchecked(value);
                else receiver._rejectUnchecked(value,
                    this._getCarriedStackTrace());
                done = true;
            } else if (receiver instanceof PromiseArray) {
                if (isFulfilled) receiver._promiseFulfilled(value, promise);
                else receiver._promiseRejected(value, promise);
                done = true;
            }
        }

        if (!done) {
            if (isFulfilled) promise._fulfill(value);
            else promise._reject(value, this._getCarriedStackTrace());
        }
    }

    if (index >= 256) {
        this._queueGC();
    }
};

Promise.prototype._isProxied = function Promise$_isProxied() {
    return (this._bitField & 4194304) === 4194304;
};

Promise.prototype._setProxied = function Promise$_setProxied() {
    this._bitField = this._bitField | 4194304;
};

Promise.prototype._unsetProxied = function Promise$_unsetProxied() {
    this._bitField = this._bitField & (~4194304);
};

Promise.prototype._isGcQueued = function Promise$_isGcQueued() {
    return (this._bitField & -1073741824) === -1073741824;
};

Promise.prototype._setGcQueued = function Promise$_setGcQueued() {
    this._bitField = this._bitField | -1073741824;
};

Promise.prototype._unsetGcQueued = function Promise$_unsetGcQueued() {
    this._bitField = this._bitField & (~-1073741824);
};

Promise.prototype._queueGC = function Promise$_queueGC() {
    if (this._isGcQueued()) return;
    this._setGcQueued();
    async.invokeLater(this._gc, this, void 0);
};

Promise.prototype._gc = function Promise$gc() {
    var len = this._length() * 5;
    for (var i = 0; i < len; i++) {
        delete this[i];
    }
    this._setLength(0);
    this._unsetGcQueued();
};

Promise.prototype._queueSettleAt = function Promise$_queueSettleAt(index) {
    if (this._isRejectionUnhandled()) this._unsetRejectionIsUnhandled();
    async.invoke(this._settlePromiseAt, this, index);
};

Promise.prototype._fulfillUnchecked =
function Promise$_fulfillUnchecked(value) {
    if (!this.isPending()) return;
    if (value === this) {
        var err = makeSelfResolutionError();
        this._attachExtraTrace(err);
        return this._rejectUnchecked(err, void 0);
    }
    this._cleanValues();
    this._setFulfilled();
    this._settledValue = value;
    var len = this._length();

    if (len > 0) {
        async.invoke(this._settlePromises, this, len);
    }
};

Promise.prototype._rejectUncheckedCheckError =
function Promise$_rejectUncheckedCheckError(reason) {
    var trace = canAttach(reason) ? reason : new Error(reason + "");
    this._rejectUnchecked(reason, trace === reason ? void 0 : trace);
};

Promise.prototype._rejectUnchecked =
function Promise$_rejectUnchecked(reason, trace) {
    if (!this.isPending()) return;
    if (reason === this) {
        var err = makeSelfResolutionError();
        this._attachExtraTrace(err);
        return this._rejectUnchecked(err);
    }
    this._cleanValues();
    this._setRejected();
    this._settledValue = reason;

    if (this._isFinal()) {
        async.invokeLater(thrower, void 0, trace === void 0 ? reason : trace);
        return;
    }
    var len = this._length();

    if (trace !== void 0) this._setCarriedStackTrace(trace);

    if (len > 0) {
        async.invoke(this._rejectPromises, this, null);
    } else {
        this._ensurePossibleRejectionHandled();
    }
};

Promise.prototype._rejectPromises = function Promise$_rejectPromises() {
    this._settlePromises();
    this._unsetCarriedStackTrace();
};

Promise.prototype._settlePromises = function Promise$_settlePromises() {
    var len = this._length();
    for (var i = 0; i < len; i++) {
        this._settlePromiseAt(i);
    }
};

Promise.prototype._ensurePossibleRejectionHandled =
function Promise$_ensurePossibleRejectionHandled() {
    this._setRejectionIsUnhandled();
    if (CapturedTrace.possiblyUnhandledRejection !== void 0) {
        async.invokeLater(this._notifyUnhandledRejection, this, void 0);
    }
};

Promise.prototype._notifyUnhandledRejectionIsHandled =
function Promise$_notifyUnhandledRejectionIsHandled() {
    if (typeof unhandledRejectionHandled === "function") {
        async.invokeLater(unhandledRejectionHandled, void 0, this);
    }
};

Promise.prototype._notifyUnhandledRejection =
function Promise$_notifyUnhandledRejection() {
    if (this._isRejectionUnhandled()) {
        var reason = this._settledValue;
        var trace = this._getCarriedStackTrace();

        this._setUnhandledRejectionIsNotified();

        if (trace !== void 0) {
            this._unsetCarriedStackTrace();
            reason = trace;
        }
        if (typeof CapturedTrace.possiblyUnhandledRejection === "function") {
            CapturedTrace.possiblyUnhandledRejection(reason, this);
        }
    }
};

var contextStack = [];
Promise.prototype._peekContext = function Promise$_peekContext() {
    var lastIndex = contextStack.length - 1;
    if (lastIndex >= 0) {
        return contextStack[lastIndex];
    }
    return void 0;

};

Promise.prototype._pushContext = function Promise$_pushContext() {
    if (!debugging) return;
    contextStack.push(this);
};

Promise.prototype._popContext = function Promise$_popContext() {
    if (!debugging) return;
    contextStack.pop();
};

Promise.noConflict = function Promise$NoConflict() {
    return noConflict(Promise);
};

Promise.setScheduler = function(fn) {
    if (typeof fn !== "function") throw new TypeError("fn must be a function");
    async._schedule = fn;
};

if (!CapturedTrace.isSupported()) {
    Promise.longStackTraces = function(){};
    debugging = false;
}

Promise._makeSelfResolutionError = makeSelfResolutionError;
require("./finally.js")(Promise, NEXT_FILTER, cast);
require("./direct_resolve.js")(Promise);
require("./synchronous_inspection.js")(Promise);
require("./join.js")(Promise, PromiseArray, cast, INTERNAL);
Promise.RangeError = RangeError;
Promise.CancellationError = CancellationError;
Promise.TimeoutError = TimeoutError;
Promise.TypeError = TypeError;
Promise.OperationalError = OperationalError;
Promise.RejectionError = OperationalError;
Promise.AggregateError = errors.AggregateError;

util.toFastProperties(Promise);
util.toFastProperties(Promise.prototype);
Promise.Promise = Promise;
require('./timers.js')(Promise,INTERNAL,cast);
require('./race.js')(Promise,INTERNAL,cast);
require('./call_get.js')(Promise);
require('./generators.js')(Promise,apiRejection,INTERNAL,cast);
require('./map.js')(Promise,PromiseArray,apiRejection,cast,INTERNAL);
require('./nodeify.js')(Promise);
require('./promisify.js')(Promise,INTERNAL);
require('./props.js')(Promise,PromiseArray,cast);
require('./reduce.js')(Promise,PromiseArray,apiRejection,cast,INTERNAL);
require('./settle.js')(Promise,PromiseArray);
require('./some.js')(Promise,PromiseArray,apiRejection);
require('./progress.js')(Promise,PromiseArray);
require('./cancel.js')(Promise,INTERNAL);
require('./filter.js')(Promise,INTERNAL);
require('./any.js')(Promise,PromiseArray);
require('./each.js')(Promise,INTERNAL);
require('./using.js')(Promise,apiRejection,cast);

Promise.prototype = Promise.prototype;
return Promise;

};

})(require("__browserify_process"))
},{"./util.js":61,"./async.js":62,"./errors.js":63,"./thenables.js":64,"./promise_array.js":65,"./captured_trace.js":66,"./catch_filter.js":67,"./promise_resolver.js":68,"./finally.js":69,"./direct_resolve.js":70,"./synchronous_inspection.js":71,"./join.js":72,"./timers.js":73,"./race.js":74,"./call_get.js":75,"./generators.js":76,"./map.js":77,"./nodeify.js":78,"./promisify.js":79,"./props.js":80,"./reduce.js":81,"./settle.js":82,"./some.js":83,"./progress.js":84,"./cancel.js":85,"./filter.js":86,"./any.js":87,"./each.js":88,"./using.js":89,"./errors_api_rejection":90,"__browserify_process":60}],54:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _
) {

  /**
   * A basic Ref serves as a means of indirection between references and their
   * values, allowing an outside agent to modify the underlying value.
   */
  var Ref = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Ref.prototype, {
    initialize: function(val) {
      this._val = val;
    },

    /**
     * Return the value boxed by this Ref
     *
     * @returns {dynamic}
     */
    get: function() {
      return this._val;
    },

    /**
     * Set a new boxed value. Note this method is specific to this Ref
     * implementation, and not the Ref protocol, which only defines
     * `Ref#get()`.
     *
     * @param newVal {dynamic} the value to box
     */
    set: function(newVal) {
      if (newVal instanceof Ref) {
        this._val = newVal.get();
      } else {
        this._val = newVal;
      }
    }
  });

  return Ref;
};

module.exports = mod(
  require("underscore")
);

})()
},{"underscore":56}],53:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _
) {

  /**
   * A ref whose boxed value is another ref
   */
  var DelegatingRef = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(DelegatingRef.prototype, {
    initialize: function(ref) {
      this._delegateRef = ref;
    },
    get: function() {
      return this._delegateRef.get();
    }
  });

  return DelegatingRef;
};

module.exports = mod(
  require("underscore")
);

})()
},{"underscore":56}],50:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _
) {

  var MType = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(MType.prototype, {
    initialize: function() {}
  });

  _.extend(MType, {
    make: function(name, obj) {
      return _.extend({}, obj, {
        mT: name
      });
    }
  })

  return MType;
};

module.exports = mod(
  require("underscore")
);

})()
},{"underscore":56}],71:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise) {
function PromiseInspection(promise) {
    if (promise !== void 0) {
        this._bitField = promise._bitField;
        this._settledValue = promise.isResolved()
            ? promise._settledValue
            : void 0;
    }
    else {
        this._bitField = 0;
        this._settledValue = void 0;
    }
}

PromiseInspection.prototype.isFulfilled =
Promise.prototype.isFulfilled = function Promise$isFulfilled() {
    return (this._bitField & 268435456) > 0;
};

PromiseInspection.prototype.isRejected =
Promise.prototype.isRejected = function Promise$isRejected() {
    return (this._bitField & 134217728) > 0;
};

PromiseInspection.prototype.isPending =
Promise.prototype.isPending = function Promise$isPending() {
    return (this._bitField & 402653184) === 0;
};

PromiseInspection.prototype.value =
Promise.prototype.value = function Promise$value() {
    if (!this.isFulfilled()) {
        throw new TypeError("cannot get fulfillment value of a non-fulfilled promise");
    }
    return this._settledValue;
};

PromiseInspection.prototype.error =
PromiseInspection.prototype.reason =
Promise.prototype.reason = function Promise$reason() {
    if (!this.isRejected()) {
        throw new TypeError("cannot get rejection reason of a non-rejected promise");
    }
    return this._settledValue;
};

PromiseInspection.prototype.isResolved =
Promise.prototype.isResolved = function Promise$isResolved() {
    return (this._bitField & 402653184) > 0;
};

Promise.PromiseInspection = PromiseInspection;
};

},{}],86:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, INTERNAL) {
var PromiseMap = Promise.map;

Promise.prototype.filter = function Promise$filter(fn, options) {
    return PromiseMap(this, fn, options, INTERNAL);
};

Promise.filter = function Promise$Filter(promises, fn, options) {
    return PromiseMap(promises, fn, options, INTERNAL);
};
};

},{}],87:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise) {
var SomePromiseArray = Promise._SomePromiseArray;
function Promise$_Any(promises) {
    var ret = new SomePromiseArray(promises);
    var promise = ret.promise();
    if (promise.isRejected()) {
        return promise;
    }
    ret.setHowMany(1);
    ret.setUnwrap();
    ret.init();
    return promise;
}

Promise.any = function Promise$Any(promises) {
    return Promise$_Any(promises);
};

Promise.prototype.any = function Promise$any() {
    return Promise$_Any(this);
};

};

},{}],88:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, INTERNAL) {
var PromiseReduce = Promise.reduce;

Promise.prototype.each = function Promise$each(fn) {
    return PromiseReduce(this, fn, null, INTERNAL);
};

Promise.each = function Promise$Each(promises, fn) {
    return PromiseReduce(promises, fn, null, INTERNAL);
};
};

},{}],55:[function(require,module,exports){
"use strict";

var mod = function(
  _
) {

  var SetTimeoutScheduler = function() {
    this.initialize.apply(this, arguments);
  }

  _.extend(SetTimeoutScheduler.prototype, {
    initialize: function() {},

    runSoon: function(fn) {
      this.schedule(fn);
    },
    schedule: function(fn, delay) {
      delay = delay || 1;
      return setTimeout(fn, delay);
    },

    unschedule: function(id) {
      return clearTimeout(id);
    }
  });

  return SetTimeoutScheduler;
};

module.exports = mod(
  require("underscore")
);

},{"underscore":56}],61:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var es5 = require("./es5.js");
var haveGetters = (function(){
    try {
        var o = {};
        es5.defineProperty(o, "f", {
            get: function () {
                return 3;
            }
        });
        return o.f === 3;
    }
    catch (e) {
        return false;
    }

})();
var canEvaluate = typeof navigator == "undefined";
var errorObj = {e: {}};
function tryCatch1(fn, receiver, arg) {
    try { return fn.call(receiver, arg); }
    catch (e) {
        errorObj.e = e;
        return errorObj;
    }
}

function tryCatch2(fn, receiver, arg, arg2) {
    try { return fn.call(receiver, arg, arg2); }
    catch (e) {
        errorObj.e = e;
        return errorObj;
    }
}

function tryCatch3(fn, receiver, arg, arg2, arg3) {
    try { return fn.call(receiver, arg, arg2, arg3); }
    catch (e) {
        errorObj.e = e;
        return errorObj;
    }
}

function tryCatch4(fn, receiver, arg, arg2, arg3, arg4) {
    try { return fn.call(receiver, arg, arg2, arg3, arg4); }
    catch (e) {
        errorObj.e = e;
        return errorObj;
    }
}

function tryCatchApply(fn, args, receiver) {
    try { return fn.apply(receiver, args); }
    catch (e) {
        errorObj.e = e;
        return errorObj;
    }
}

var inherits = function(Child, Parent) {
    var hasProp = {}.hasOwnProperty;

    function T() {
        this.constructor = Child;
        this.constructor$ = Parent;
        for (var propertyName in Parent.prototype) {
            if (hasProp.call(Parent.prototype, propertyName) &&
                propertyName.charAt(propertyName.length-1) !== "$"
           ) {
                this[propertyName + "$"] = Parent.prototype[propertyName];
            }
        }
    }
    T.prototype = Parent.prototype;
    Child.prototype = new T();
    return Child.prototype;
};

function asString(val) {
    return typeof val === "string" ? val : ("" + val);
}

function isPrimitive(val) {
    return val == null || val === true || val === false ||
        typeof val === "string" || typeof val === "number";

}

function isObject(value) {
    return !isPrimitive(value);
}

function maybeWrapAsError(maybeError) {
    if (!isPrimitive(maybeError)) return maybeError;

    return new Error(asString(maybeError));
}

function withAppended(target, appendee) {
    var len = target.length;
    var ret = new Array(len + 1);
    var i;
    for (i = 0; i < len; ++i) {
        ret[i] = target[i];
    }
    ret[i] = appendee;
    return ret;
}

function getDataPropertyOrDefault(obj, key, defaultValue) {
    if (es5.isES5) {
        var desc = Object.getOwnPropertyDescriptor(obj, key);
        if (desc != null) {
            return desc.get == null && desc.set == null
                    ? desc.value
                    : defaultValue;
        }
    } else {
        return {}.hasOwnProperty.call(obj, key) ? obj[key] : void 0;
    }
}

function notEnumerableProp(obj, name, value) {
    if (isPrimitive(obj)) return obj;
    var descriptor = {
        value: value,
        configurable: true,
        enumerable: false,
        writable: true
    };
    es5.defineProperty(obj, name, descriptor);
    return obj;
}


var wrapsPrimitiveReceiver = (function() {
    return this !== "string";
}).call("string");

function thrower(r) {
    throw r;
}

var inheritedDataKeys = (function() {
    if (es5.isES5) {
        return function(obj, opts) {
            var ret = [];
            var visitedKeys = Object.create(null);
            var getKeys = Object(opts).includeHidden
                ? Object.getOwnPropertyNames
                : Object.keys;
            while (obj != null) {
                var keys;
                try {
                    keys = getKeys(obj);
                } catch (e) {
                    return ret;
                }
                for (var i = 0; i < keys.length; ++i) {
                    var key = keys[i];
                    if (visitedKeys[key]) continue;
                    visitedKeys[key] = true;
                    var desc = Object.getOwnPropertyDescriptor(obj, key);
                    if (desc != null && desc.get == null && desc.set == null) {
                        ret.push(key);
                    }
                }
                obj = es5.getPrototypeOf(obj);
            }
            return ret;
        };
    } else {
        return function(obj) {
            var ret = [];
            /*jshint forin:false */
            for (var key in obj) {
                ret.push(key);
            }
            return ret;
        };
    }

})();

function isClass(fn) {
    try {
        if (typeof fn === "function") {
            var keys = es5.keys(fn.prototype);
            return keys.length > 0 &&
                   !(keys.length === 1 && keys[0] === "constructor");
        }
        return false;
    } catch (e) {
        return false;
    }
}

function toFastProperties(obj) {
    /*jshint -W027*/
    function f() {}
    f.prototype = obj;
    return f;
    eval(obj);
}

var rident = /^[a-z$_][a-z$_0-9]*$/i;
function isIdentifier(str) {
    return rident.test(str);
}

function filledRange(count, prefix, suffix) {
    var ret = new Array(count);
    for(var i = 0; i < count; ++i) {
        ret[i] = prefix + i + suffix;
    }
    return ret;
}

var ret = {
    isClass: isClass,
    isIdentifier: isIdentifier,
    inheritedDataKeys: inheritedDataKeys,
    getDataPropertyOrDefault: getDataPropertyOrDefault,
    thrower: thrower,
    isArray: es5.isArray,
    haveGetters: haveGetters,
    notEnumerableProp: notEnumerableProp,
    isPrimitive: isPrimitive,
    isObject: isObject,
    canEvaluate: canEvaluate,
    errorObj: errorObj,
    tryCatch1: tryCatch1,
    tryCatch2: tryCatch2,
    tryCatch3: tryCatch3,
    tryCatch4: tryCatch4,
    tryCatchApply: tryCatchApply,
    inherits: inherits,
    withAppended: withAppended,
    asString: asString,
    maybeWrapAsError: maybeWrapAsError,
    wrapsPrimitiveReceiver: wrapsPrimitiveReceiver,
    toFastProperties: toFastProperties,
    filledRange: filledRange
};

module.exports = ret;

},{"./es5.js":91}],62:[function(require,module,exports){
(function(process){/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var schedule = require("./schedule.js");
var Queue = require("./queue.js");
var errorObj = require("./util.js").errorObj;
var tryCatch1 = require("./util.js").tryCatch1;
var _process = typeof process !== "undefined" ? process : void 0;

function Async() {
    this._isTickUsed = false;
    this._schedule = schedule;
    this._length = 0;
    this._lateBuffer = new Queue(16);
    this._functionBuffer = new Queue(65536);
    var self = this;
    this.consumeFunctionBuffer = function Async$consumeFunctionBuffer() {
        self._consumeFunctionBuffer();
    };
}

Async.prototype.haveItemsQueued = function Async$haveItemsQueued() {
    return this._length > 0;
};

Async.prototype.invokeLater = function Async$invokeLater(fn, receiver, arg) {
    if (_process !== void 0 &&
        _process.domain != null &&
        !fn.domain) {
        fn = _process.domain.bind(fn);
    }
    this._lateBuffer.push(fn, receiver, arg);
    this._queueTick();
};

Async.prototype.invoke = function Async$invoke(fn, receiver, arg) {
    if (_process !== void 0 &&
        _process.domain != null &&
        !fn.domain) {
        fn = _process.domain.bind(fn);
    }
    var functionBuffer = this._functionBuffer;
    functionBuffer.push(fn, receiver, arg);
    this._length = functionBuffer.length();
    this._queueTick();
};

Async.prototype._consumeFunctionBuffer =
function Async$_consumeFunctionBuffer() {
    var functionBuffer = this._functionBuffer;
    while (functionBuffer.length() > 0) {
        var fn = functionBuffer.shift();
        var receiver = functionBuffer.shift();
        var arg = functionBuffer.shift();
        fn.call(receiver, arg);
    }
    this._reset();
    this._consumeLateBuffer();
};

Async.prototype._consumeLateBuffer = function Async$_consumeLateBuffer() {
    var buffer = this._lateBuffer;
    while(buffer.length() > 0) {
        var fn = buffer.shift();
        var receiver = buffer.shift();
        var arg = buffer.shift();
        var res = tryCatch1(fn, receiver, arg);
        if (res === errorObj) {
            this._queueTick();
            if (fn.domain != null) {
                fn.domain.emit("error", res.e);
            } else {
                throw res.e;
            }
        }
    }
};

Async.prototype._queueTick = function Async$_queue() {
    if (!this._isTickUsed) {
        this._schedule(this.consumeFunctionBuffer);
        this._isTickUsed = true;
    }
};

Async.prototype._reset = function Async$_reset() {
    this._isTickUsed = false;
    this._length = 0;
};

module.exports = new Async();

})(require("__browserify_process"))
},{"./schedule.js":92,"./queue.js":93,"./util.js":61,"__browserify_process":60}],63:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var Objectfreeze = require("./es5.js").freeze;
var util = require("./util.js");
var inherits = util.inherits;
var notEnumerableProp = util.notEnumerableProp;

function markAsOriginatingFromRejection(e) {
    try {
        notEnumerableProp(e, "isOperational", true);
    }
    catch(ignore) {}
}

function originatesFromRejection(e) {
    if (e == null) return false;
    return ((e instanceof OperationalError) ||
        e["isOperational"] === true);
}

function isError(obj) {
    return obj instanceof Error;
}

function canAttach(obj) {
    return isError(obj);
}

function subError(nameProperty, defaultMessage) {
    function SubError(message) {
        if (!(this instanceof SubError)) return new SubError(message);
        this.message = typeof message === "string" ? message : defaultMessage;
        this.name = nameProperty;
        if (Error.captureStackTrace) {
            Error.captureStackTrace(this, this.constructor);
        }
    }
    inherits(SubError, Error);
    return SubError;
}

var _TypeError, _RangeError;
var CancellationError = subError("CancellationError", "cancellation error");
var TimeoutError = subError("TimeoutError", "timeout error");
var AggregateError = subError("AggregateError", "aggregate error");
try {
    _TypeError = TypeError;
    _RangeError = RangeError;
} catch(e) {
    _TypeError = subError("TypeError", "type error");
    _RangeError = subError("RangeError", "range error");
}

var methods = ("join pop push shift unshift slice filter forEach some " +
    "every map indexOf lastIndexOf reduce reduceRight sort reverse").split(" ");

for (var i = 0; i < methods.length; ++i) {
    if (typeof Array.prototype[methods[i]] === "function") {
        AggregateError.prototype[methods[i]] = Array.prototype[methods[i]];
    }
}

AggregateError.prototype.length = 0;
AggregateError.prototype["isOperational"] = true;
var level = 0;
AggregateError.prototype.toString = function() {
    var indent = Array(level * 4 + 1).join(" ");
    var ret = "\n" + indent + "AggregateError of:" + "\n";
    level++;
    indent = Array(level * 4 + 1).join(" ");
    for (var i = 0; i < this.length; ++i) {
        var str = this[i] === this ? "[Circular AggregateError]" : this[i] + "";
        var lines = str.split("\n");
        for (var j = 0; j < lines.length; ++j) {
            lines[j] = indent + lines[j];
        }
        str = lines.join("\n");
        ret += str + "\n";
    }
    level--;
    return ret;
};

function OperationalError(message) {
    this.name = "OperationalError";
    this.message = message;
    this.cause = message;
    this["isOperational"] = true;

    if (message instanceof Error) {
        this.message = message.message;
        this.stack = message.stack;
    } else if (Error.captureStackTrace) {
        Error.captureStackTrace(this, this.constructor);
    }

}
inherits(OperationalError, Error);

var key = "__BluebirdErrorTypes__";
var errorTypes = Error[key];
if (!errorTypes) {
    errorTypes = Objectfreeze({
        CancellationError: CancellationError,
        TimeoutError: TimeoutError,
        OperationalError: OperationalError,
        RejectionError: OperationalError,
        AggregateError: AggregateError
    });
    notEnumerableProp(Error, key, errorTypes);
}

module.exports = {
    Error: Error,
    TypeError: _TypeError,
    RangeError: _RangeError,
    CancellationError: errorTypes.CancellationError,
    OperationalError: errorTypes.OperationalError,
    TimeoutError: errorTypes.TimeoutError,
    AggregateError: errorTypes.AggregateError,
    originatesFromRejection: originatesFromRejection,
    markAsOriginatingFromRejection: markAsOriginatingFromRejection,
    canAttach: canAttach
};

},{"./es5.js":91,"./util.js":61}],64:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, INTERNAL) {
var util = require("./util.js");
var canAttach = require("./errors.js").canAttach;
var errorObj = util.errorObj;
var isObject = util.isObject;

function getThen(obj) {
    try {
        return obj.then;
    }
    catch(e) {
        errorObj.e = e;
        return errorObj;
    }
}

function Promise$_Cast(obj, originalPromise) {
    if (isObject(obj)) {
        if (obj instanceof Promise) {
            return obj;
        }
        else if (isAnyBluebirdPromise(obj)) {
            var ret = new Promise(INTERNAL);
            ret._setTrace(void 0);
            obj._then(
                ret._fulfillUnchecked,
                ret._rejectUncheckedCheckError,
                ret._progressUnchecked,
                ret,
                null
            );
            ret._setFollowing();
            return ret;
        }
        var then = getThen(obj);
        if (then === errorObj) {
            if (originalPromise !== void 0 && canAttach(then.e)) {
                originalPromise._attachExtraTrace(then.e);
            }
            return Promise.reject(then.e);
        } else if (typeof then === "function") {
            return Promise$_doThenable(obj, then, originalPromise);
        }
    }
    return obj;
}

var hasProp = {}.hasOwnProperty;
function isAnyBluebirdPromise(obj) {
    return hasProp.call(obj, "_promise0");
}

function Promise$_doThenable(x, then, originalPromise) {
    var resolver = Promise.defer();
    var called = false;
    try {
        then.call(
            x,
            Promise$_resolveFromThenable,
            Promise$_rejectFromThenable,
            Promise$_progressFromThenable
        );
    } catch(e) {
        if (!called) {
            called = true;
            var trace = canAttach(e) ? e : new Error(e + "");
            if (originalPromise !== void 0) {
                originalPromise._attachExtraTrace(trace);
            }
            resolver.promise._reject(e, trace);
        }
    }
    return resolver.promise;

    function Promise$_resolveFromThenable(y) {
        if (called) return;
        called = true;

        if (x === y) {
            var e = Promise._makeSelfResolutionError();
            if (originalPromise !== void 0) {
                originalPromise._attachExtraTrace(e);
            }
            resolver.promise._reject(e, void 0);
            return;
        }
        resolver.resolve(y);
    }

    function Promise$_rejectFromThenable(r) {
        if (called) return;
        called = true;
        var trace = canAttach(r) ? r : new Error(r + "");
        if (originalPromise !== void 0) {
            originalPromise._attachExtraTrace(trace);
        }
        resolver.promise._reject(r, trace);
    }

    function Promise$_progressFromThenable(v) {
        if (called) return;
        var promise = resolver.promise;
        if (typeof promise._progress === "function") {
            promise._progress(v);
        }
    }
}

return Promise$_Cast;
};

},{"./util.js":61,"./errors.js":63}],65:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, INTERNAL, cast) {
var canAttach = require("./errors.js").canAttach;
var util = require("./util.js");
var isArray = util.isArray;

function toResolutionValue(val) {
    switch(val) {
    case -1: return void 0;
    case -2: return [];
    case -3: return {};
    }
}

function PromiseArray(values) {
    var promise = this._promise = new Promise(INTERNAL);
    var parent = void 0;
    if (values instanceof Promise) {
        parent = values;
        promise._propagateFrom(parent, 1 | 4);
    }
    promise._setTrace(parent);
    this._values = values;
    this._length = 0;
    this._totalResolved = 0;
    this._init(void 0, -2);
}
PromiseArray.prototype.length = function PromiseArray$length() {
    return this._length;
};

PromiseArray.prototype.promise = function PromiseArray$promise() {
    return this._promise;
};

PromiseArray.prototype._init =
function PromiseArray$_init(_, resolveValueIfEmpty) {
    var values = cast(this._values, void 0);
    if (values instanceof Promise) {
        this._values = values;
        values._setBoundTo(this._promise._boundTo);
        if (values.isFulfilled()) {
            values = values._settledValue;
            if (!isArray(values)) {
                var err = new Promise.TypeError("expecting an array, a promise or a thenable");
                this.__hardReject__(err);
                return;
            }
        } else if (values.isPending()) {
            values._then(
                PromiseArray$_init,
                this._reject,
                void 0,
                this,
                resolveValueIfEmpty
           );
            return;
        } else {
            values._unsetRejectionIsUnhandled();
            this._reject(values._settledValue);
            return;
        }
    } else if (!isArray(values)) {
        var err = new Promise.TypeError("expecting an array, a promise or a thenable");
        this.__hardReject__(err);
        return;
    }

    if (values.length === 0) {
        if (resolveValueIfEmpty === -5) {
            this._resolveEmptyArray();
        }
        else {
            this._resolve(toResolutionValue(resolveValueIfEmpty));
        }
        return;
    }
    var len = this.getActualLength(values.length);
    var newLen = len;
    var newValues = this.shouldCopyValues() ? new Array(len) : this._values;
    var isDirectScanNeeded = false;
    for (var i = 0; i < len; ++i) {
        var maybePromise = cast(values[i], void 0);
        if (maybePromise instanceof Promise) {
            if (maybePromise.isPending()) {
                maybePromise._proxyPromiseArray(this, i);
            } else {
                maybePromise._unsetRejectionIsUnhandled();
                isDirectScanNeeded = true;
            }
        } else {
            isDirectScanNeeded = true;
        }
        newValues[i] = maybePromise;
    }
    this._values = newValues;
    this._length = newLen;
    if (isDirectScanNeeded) {
        this._scanDirectValues(len);
    }
};

PromiseArray.prototype._settlePromiseAt =
function PromiseArray$_settlePromiseAt(index) {
    var value = this._values[index];
    if (!(value instanceof Promise)) {
        this._promiseFulfilled(value, index);
    } else if (value.isFulfilled()) {
        this._promiseFulfilled(value._settledValue, index);
    } else if (value.isRejected()) {
        this._promiseRejected(value._settledValue, index);
    }
};

PromiseArray.prototype._scanDirectValues =
function PromiseArray$_scanDirectValues(len) {
    for (var i = 0; i < len; ++i) {
        if (this._isResolved()) {
            break;
        }
        this._settlePromiseAt(i);
    }
};

PromiseArray.prototype._isResolved = function PromiseArray$_isResolved() {
    return this._values === null;
};

PromiseArray.prototype._resolve = function PromiseArray$_resolve(value) {
    this._values = null;
    this._promise._fulfill(value);
};

PromiseArray.prototype.__hardReject__ =
PromiseArray.prototype._reject = function PromiseArray$_reject(reason) {
    this._values = null;
    var trace = canAttach(reason) ? reason : new Error(reason + "");
    this._promise._attachExtraTrace(trace);
    this._promise._reject(reason, trace);
};

PromiseArray.prototype._promiseProgressed =
function PromiseArray$_promiseProgressed(progressValue, index) {
    if (this._isResolved()) return;
    this._promise._progress({
        index: index,
        value: progressValue
    });
};


PromiseArray.prototype._promiseFulfilled =
function PromiseArray$_promiseFulfilled(value, index) {
    if (this._isResolved()) return;
    this._values[index] = value;
    var totalResolved = ++this._totalResolved;
    if (totalResolved >= this._length) {
        this._resolve(this._values);
    }
};

PromiseArray.prototype._promiseRejected =
function PromiseArray$_promiseRejected(reason, index) {
    if (this._isResolved()) return;
    this._totalResolved++;
    this._reject(reason);
};

PromiseArray.prototype.shouldCopyValues =
function PromiseArray$_shouldCopyValues() {
    return true;
};

PromiseArray.prototype.getActualLength =
function PromiseArray$getActualLength(len) {
    return len;
};

return PromiseArray;
};

},{"./errors.js":63,"./util.js":61}],66:[function(require,module,exports){
(function(){/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function() {
var inherits = require("./util.js").inherits;
var defineProperty = require("./es5.js").defineProperty;

var rignore = new RegExp(
    "\\b(?:[a-zA-Z0-9.]+\\$_\\w+|" +
    "tryCatch(?:1|2|3|4|Apply)|new \\w*PromiseArray|" +
    "\\w*PromiseArray\\.\\w*PromiseArray|" +
    "setTimeout|CatchFilter\\$_\\w+|makeNodePromisified|processImmediate|" +
    "process._tickCallback|nextTick|Async\\$\\w+)\\b"
);

var rtraceline = null;
var formatStack = null;

function formatNonError(obj) {
    var str;
    if (typeof obj === "function") {
        str = "[function " +
            (obj.name || "anonymous") +
            "]";
    } else {
        str = obj.toString();
        var ruselessToString = /\[object [a-zA-Z0-9$_]+\]/;
        if (ruselessToString.test(str)) {
            try {
                var newStr = JSON.stringify(obj);
                str = newStr;
            }
            catch(e) {

            }
        }
        if (str.length === 0) {
            str = "(empty array)";
        }
    }
    return ("(<" + snip(str) + ">, no stack trace)");
}

function snip(str) {
    var maxChars = 41;
    if (str.length < maxChars) {
        return str;
    }
    return str.substr(0, maxChars - 3) + "...";
}

function CapturedTrace(ignoreUntil, isTopLevel) {
    this.captureStackTrace(CapturedTrace, isTopLevel);

}
inherits(CapturedTrace, Error);

CapturedTrace.prototype.captureStackTrace =
function CapturedTrace$captureStackTrace(ignoreUntil, isTopLevel) {
    captureStackTrace(this, ignoreUntil, isTopLevel);
};

CapturedTrace.possiblyUnhandledRejection =
function CapturedTrace$PossiblyUnhandledRejection(reason) {
    if (typeof console === "object") {
        var message;
        if (typeof reason === "object" || typeof reason === "function") {
            var stack = reason.stack;
            message = "Possibly unhandled " + formatStack(stack, reason);
        } else {
            message = "Possibly unhandled " + String(reason);
        }
        if (typeof console.error === "function" ||
            typeof console.error === "object") {
            console.error(message);
        } else if (typeof console.log === "function" ||
            typeof console.log === "object") {
            console.log(message);
        }
    }
};

CapturedTrace.combine = function CapturedTrace$Combine(current, prev) {
    var curLast = current.length - 1;
    for (var i = prev.length - 1; i >= 0; --i) {
        var line = prev[i];
        if (current[curLast] === line) {
            current.pop();
            curLast--;
        } else {
            break;
        }
    }

    current.push("From previous event:");
    var lines = current.concat(prev);

    var ret = [];

    for (var i = 0, len = lines.length; i < len; ++i) {

        if ((rignore.test(lines[i]) ||
            (i > 0 && !rtraceline.test(lines[i])) &&
            lines[i] !== "From previous event:")
       ) {
            continue;
        }
        ret.push(lines[i]);
    }
    return ret;
};

CapturedTrace.protectErrorMessageNewlines = function(stack) {
    for (var i = 0; i < stack.length; ++i) {
        if (rtraceline.test(stack[i])) {
            break;
        }
    }

    if (i <= 1) return;

    var errorMessageLines = [];
    for (var j = 0; j < i; ++j) {
        errorMessageLines.push(stack.shift());
    }
    stack.unshift(errorMessageLines.join("\u0002\u0000\u0001"));
};

CapturedTrace.isSupported = function CapturedTrace$IsSupported() {
    return typeof captureStackTrace === "function";
};

var captureStackTrace = (function stackDetection() {
    if (typeof Error.stackTraceLimit === "number" &&
        typeof Error.captureStackTrace === "function") {
        rtraceline = /^\s*at\s*/;
        formatStack = function(stack, error) {
            if (typeof stack === "string") return stack;

            if (error.name !== void 0 &&
                error.message !== void 0) {
                return error.name + ". " + error.message;
            }
            return formatNonError(error);


        };
        var captureStackTrace = Error.captureStackTrace;
        return function CapturedTrace$_captureStackTrace(
            receiver, ignoreUntil) {
            captureStackTrace(receiver, ignoreUntil);
        };
    }
    var err = new Error();

    if (typeof err.stack === "string" &&
        typeof "".startsWith === "function" &&
        (err.stack.startsWith("stackDetection@")) &&
        stackDetection.name === "stackDetection") {

        defineProperty(Error, "stackTraceLimit", {
            writable: true,
            enumerable: false,
            configurable: false,
            value: 25
        });
        rtraceline = /@/;
        var rline = /[@\n]/;

        formatStack = function(stack, error) {
            if (typeof stack === "string") {
                return (error.name + ". " + error.message + "\n" + stack);
            }

            if (error.name !== void 0 &&
                error.message !== void 0) {
                return error.name + ". " + error.message;
            }
            return formatNonError(error);
        };

        return function captureStackTrace(o) {
            var stack = new Error().stack;
            var split = stack.split(rline);
            var len = split.length;
            var ret = "";
            for (var i = 0; i < len; i += 2) {
                ret += split[i];
                ret += "@";
                ret += split[i + 1];
                ret += "\n";
            }
            o.stack = ret;
        };
    } else {
        formatStack = function(stack, error) {
            if (typeof stack === "string") return stack;

            if ((typeof error === "object" ||
                typeof error === "function") &&
                error.name !== void 0 &&
                error.message !== void 0) {
                return error.name + ". " + error.message;
            }
            return formatNonError(error);
        };

        return null;
    }
})();

return CapturedTrace;
};

})()
},{"./util.js":61,"./es5.js":91}],67:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(NEXT_FILTER) {
var util = require("./util.js");
var errors = require("./errors.js");
var tryCatch1 = util.tryCatch1;
var errorObj = util.errorObj;
var keys = require("./es5.js").keys;
var TypeError = errors.TypeError;

function CatchFilter(instances, callback, promise) {
    this._instances = instances;
    this._callback = callback;
    this._promise = promise;
}

function CatchFilter$_safePredicate(predicate, e) {
    var safeObject = {};
    var retfilter = tryCatch1(predicate, safeObject, e);

    if (retfilter === errorObj) return retfilter;

    var safeKeys = keys(safeObject);
    if (safeKeys.length) {
        errorObj.e = new TypeError(
            "Catch filter must inherit from Error "
          + "or be a simple predicate function");
        return errorObj;
    }
    return retfilter;
}

CatchFilter.prototype.doFilter = function CatchFilter$_doFilter(e) {
    var cb = this._callback;
    var promise = this._promise;
    var boundTo = promise._boundTo;
    for (var i = 0, len = this._instances.length; i < len; ++i) {
        var item = this._instances[i];
        var itemIsErrorType = item === Error ||
            (item != null && item.prototype instanceof Error);

        if (itemIsErrorType && e instanceof item) {
            var ret = tryCatch1(cb, boundTo, e);
            if (ret === errorObj) {
                NEXT_FILTER.e = ret.e;
                return NEXT_FILTER;
            }
            return ret;
        } else if (typeof item === "function" && !itemIsErrorType) {
            var shouldHandle = CatchFilter$_safePredicate(item, e);
            if (shouldHandle === errorObj) {
                var trace = errors.canAttach(errorObj.e)
                    ? errorObj.e
                    : new Error(errorObj.e + "");
                this._promise._attachExtraTrace(trace);
                e = errorObj.e;
                break;
            } else if (shouldHandle) {
                var ret = tryCatch1(cb, boundTo, e);
                if (ret === errorObj) {
                    NEXT_FILTER.e = ret.e;
                    return NEXT_FILTER;
                }
                return ret;
            }
        }
    }
    NEXT_FILTER.e = e;
    return NEXT_FILTER;
};

return CatchFilter;
};

},{"./util.js":61,"./errors.js":63,"./es5.js":91}],68:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var util = require("./util.js");
var maybeWrapAsError = util.maybeWrapAsError;
var errors = require("./errors.js");
var TimeoutError = errors.TimeoutError;
var OperationalError = errors.OperationalError;
var async = require("./async.js");
var haveGetters = util.haveGetters;
var es5 = require("./es5.js");

function isUntypedError(obj) {
    return obj instanceof Error &&
        es5.getPrototypeOf(obj) === Error.prototype;
}

function wrapAsOperationalError(obj) {
    var ret;
    if (isUntypedError(obj)) {
        ret = new OperationalError(obj);
    } else {
        ret = obj;
    }
    errors.markAsOriginatingFromRejection(ret);
    return ret;
}

function nodebackForPromise(promise) {
    function PromiseResolver$_callback(err, value) {
        if (promise === null) return;

        if (err) {
            var wrapped = wrapAsOperationalError(maybeWrapAsError(err));
            promise._attachExtraTrace(wrapped);
            promise._reject(wrapped);
        } else if (arguments.length > 2) {
            var $_len = arguments.length;var args = new Array($_len - 1); for(var $_i = 1; $_i < $_len; ++$_i) {args[$_i - 1] = arguments[$_i];}
            promise._fulfill(args);
        } else {
            promise._fulfill(value);
        }

        promise = null;
    }
    return PromiseResolver$_callback;
}


var PromiseResolver;
if (!haveGetters) {
    PromiseResolver = function PromiseResolver(promise) {
        this.promise = promise;
        this.asCallback = nodebackForPromise(promise);
        this.callback = this.asCallback;
    };
}
else {
    PromiseResolver = function PromiseResolver(promise) {
        this.promise = promise;
    };
}
if (haveGetters) {
    var prop = {
        get: function() {
            return nodebackForPromise(this.promise);
        }
    };
    es5.defineProperty(PromiseResolver.prototype, "asCallback", prop);
    es5.defineProperty(PromiseResolver.prototype, "callback", prop);
}

PromiseResolver._nodebackForPromise = nodebackForPromise;

PromiseResolver.prototype.toString = function PromiseResolver$toString() {
    return "[object PromiseResolver]";
};

PromiseResolver.prototype.resolve =
PromiseResolver.prototype.fulfill = function PromiseResolver$resolve(value) {
    if (!(this instanceof PromiseResolver)) {
        throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");
    }

    var promise = this.promise;
    if (promise._tryFollow(value)) {
        return;
    }
    async.invoke(promise._fulfill, promise, value);
};

PromiseResolver.prototype.reject = function PromiseResolver$reject(reason) {
    if (!(this instanceof PromiseResolver)) {
        throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");
    }

    var promise = this.promise;
    errors.markAsOriginatingFromRejection(reason);
    var trace = errors.canAttach(reason) ? reason : new Error(reason + "");
    promise._attachExtraTrace(trace);
    async.invoke(promise._reject, promise, reason);
    if (trace !== reason) {
        async.invoke(this._setCarriedStackTrace, this, trace);
    }
};

PromiseResolver.prototype.progress =
function PromiseResolver$progress(value) {
    if (!(this instanceof PromiseResolver)) {
        throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");
    }
    async.invoke(this.promise._progress, this.promise, value);
};

PromiseResolver.prototype.cancel = function PromiseResolver$cancel() {
    async.invoke(this.promise.cancel, this.promise, void 0);
};

PromiseResolver.prototype.timeout = function PromiseResolver$timeout() {
    this.reject(new TimeoutError("timeout"));
};

PromiseResolver.prototype.isResolved = function PromiseResolver$isResolved() {
    return this.promise.isResolved();
};

PromiseResolver.prototype.toJSON = function PromiseResolver$toJSON() {
    return this.promise.toJSON();
};

PromiseResolver.prototype._setCarriedStackTrace =
function PromiseResolver$_setCarriedStackTrace(trace) {
    if (this.promise.isRejected()) {
        this.promise._setCarriedStackTrace(trace);
    }
};

module.exports = PromiseResolver;

},{"./util.js":61,"./errors.js":63,"./async.js":62,"./es5.js":91}],69:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, NEXT_FILTER, cast) {
var util = require("./util.js");
var wrapsPrimitiveReceiver = util.wrapsPrimitiveReceiver;
var isPrimitive = util.isPrimitive;
var thrower = util.thrower;

function returnThis() {
    return this;
}
function throwThis() {
    throw this;
}
function return$(r) {
    return function Promise$_returner() {
        return r;
    };
}
function throw$(r) {
    return function Promise$_thrower() {
        throw r;
    };
}
function promisedFinally(ret, reasonOrValue, isFulfilled) {
    var then;
    if (wrapsPrimitiveReceiver && isPrimitive(reasonOrValue)) {
        then = isFulfilled ? return$(reasonOrValue) : throw$(reasonOrValue);
    } else {
        then = isFulfilled ? returnThis : throwThis;
    }
    return ret._then(then, thrower, void 0, reasonOrValue, void 0);
}

function finallyHandler(reasonOrValue) {
    var promise = this.promise;
    var handler = this.handler;

    var ret = promise._isBound()
                    ? handler.call(promise._boundTo)
                    : handler();

    if (ret !== void 0) {
        var maybePromise = cast(ret, void 0);
        if (maybePromise instanceof Promise) {
            return promisedFinally(maybePromise, reasonOrValue,
                                    promise.isFulfilled());
        }
    }

    if (promise.isRejected()) {
        NEXT_FILTER.e = reasonOrValue;
        return NEXT_FILTER;
    } else {
        return reasonOrValue;
    }
}

function tapHandler(value) {
    var promise = this.promise;
    var handler = this.handler;

    var ret = promise._isBound()
                    ? handler.call(promise._boundTo, value)
                    : handler(value);

    if (ret !== void 0) {
        var maybePromise = cast(ret, void 0);
        if (maybePromise instanceof Promise) {
            return promisedFinally(maybePromise, value, true);
        }
    }
    return value;
}

Promise.prototype._passThroughHandler =
function Promise$_passThroughHandler(handler, isFinally) {
    if (typeof handler !== "function") return this.then();

    var promiseAndHandler = {
        promise: this,
        handler: handler
    };

    return this._then(
            isFinally ? finallyHandler : tapHandler,
            isFinally ? finallyHandler : void 0, void 0,
            promiseAndHandler, void 0);
};

Promise.prototype.lastly =
Promise.prototype["finally"] = function Promise$finally(handler) {
    return this._passThroughHandler(handler, true);
};

Promise.prototype.tap = function Promise$tap(handler) {
    return this._passThroughHandler(handler, false);
};
};

},{"./util.js":61}],70:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var util = require("./util.js");
var isPrimitive = util.isPrimitive;
var wrapsPrimitiveReceiver = util.wrapsPrimitiveReceiver;

module.exports = function(Promise) {
var returner = function Promise$_returner() {
    return this;
};
var thrower = function Promise$_thrower() {
    throw this;
};

var wrapper = function Promise$_wrapper(value, action) {
    if (action === 1) {
        return function Promise$_thrower() {
            throw value;
        };
    } else if (action === 2) {
        return function Promise$_returner() {
            return value;
        };
    }
};


Promise.prototype["return"] =
Promise.prototype.thenReturn =
function Promise$thenReturn(value) {
    if (wrapsPrimitiveReceiver && isPrimitive(value)) {
        return this._then(
            wrapper(value, 2),
            void 0,
            void 0,
            void 0,
            void 0
       );
    }
    return this._then(returner, void 0, void 0, value, void 0);
};

Promise.prototype["throw"] =
Promise.prototype.thenThrow =
function Promise$thenThrow(reason) {
    if (wrapsPrimitiveReceiver && isPrimitive(reason)) {
        return this._then(
            wrapper(reason, 1),
            void 0,
            void 0,
            void 0,
            void 0
       );
    }
    return this._then(thrower, void 0, void 0, reason, void 0);
};
};

},{"./util.js":61}],72:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports =
function(Promise, PromiseArray, cast, INTERNAL) {
var util = require("./util.js");
var canEvaluate = util.canEvaluate;
var tryCatch1 = util.tryCatch1;
var errorObj = util.errorObj;


if (canEvaluate) {
    var thenCallback = function(i) {
        return new Function("value", "holder", "                             \n\
            'use strict';                                                    \n\
            holder.pIndex = value;                                           \n\
            holder.checkFulfillment(this);                                   \n\
            ".replace(/Index/g, i));
    };

    var caller = function(count) {
        var values = [];
        for (var i = 1; i <= count; ++i) values.push("holder.p" + i);
        return new Function("holder", "                                      \n\
            'use strict';                                                    \n\
            var callback = holder.fn;                                        \n\
            return callback(values);                                         \n\
            ".replace(/values/g, values.join(", ")));
    };
    var thenCallbacks = [];
    var callers = [void 0];
    for (var i = 1; i <= 5; ++i) {
        thenCallbacks.push(thenCallback(i));
        callers.push(caller(i));
    }

    var Holder = function(total, fn) {
        this.p1 = this.p2 = this.p3 = this.p4 = this.p5 = null;
        this.fn = fn;
        this.total = total;
        this.now = 0;
    };

    Holder.prototype.callers = callers;
    Holder.prototype.checkFulfillment = function(promise) {
        var now = this.now;
        now++;
        var total = this.total;
        if (now >= total) {
            var handler = this.callers[total];
            var ret = tryCatch1(handler, void 0, this);
            if (ret === errorObj) {
                promise._rejectUnchecked(ret.e);
            } else if (!promise._tryFollow(ret)) {
                promise._fulfillUnchecked(ret);
            }
        } else {
            this.now = now;
        }
    };
}




Promise.join = function Promise$Join() {
    var last = arguments.length - 1;
    var fn;
    if (last > 0 && typeof arguments[last] === "function") {
        fn = arguments[last];
        if (last < 6 && canEvaluate) {
            var ret = new Promise(INTERNAL);
            ret._setTrace(void 0);
            var holder = new Holder(last, fn);
            var reject = ret._reject;
            var callbacks = thenCallbacks;
            for (var i = 0; i < last; ++i) {
                var maybePromise = cast(arguments[i], void 0);
                if (maybePromise instanceof Promise) {
                    if (maybePromise.isPending()) {
                        maybePromise._then(callbacks[i], reject,
                                           void 0, ret, holder);
                    } else if (maybePromise.isFulfilled()) {
                        callbacks[i].call(ret,
                                          maybePromise._settledValue, holder);
                    } else {
                        ret._reject(maybePromise._settledValue);
                        maybePromise._unsetRejectionIsUnhandled();
                    }
                } else {
                    callbacks[i].call(ret, maybePromise, holder);
                }
            }
            return ret;
        }
    }
    var $_len = arguments.length;var args = new Array($_len); for(var $_i = 0; $_i < $_len; ++$_i) {args[$_i] = arguments[$_i];}
    var ret = new PromiseArray(args).promise();
    return fn !== void 0 ? ret.spread(fn) : ret;
};

};

},{"./util.js":61}],74:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, INTERNAL, cast) {
var apiRejection = require("./errors_api_rejection.js")(Promise);
var isArray = require("./util.js").isArray;

var raceLater = function Promise$_raceLater(promise) {
    return promise.then(function(array) {
        return Promise$_Race(array, promise);
    });
};

var hasOwn = {}.hasOwnProperty;
function Promise$_Race(promises, parent) {
    var maybePromise = cast(promises, void 0);

    if (maybePromise instanceof Promise) {
        return raceLater(maybePromise);
    } else if (!isArray(promises)) {
        return apiRejection("expecting an array, a promise or a thenable");
    }

    var ret = new Promise(INTERNAL);
    if (parent !== void 0) {
        ret._propagateFrom(parent, 7);
    } else {
        ret._setTrace(void 0);
    }
    var fulfill = ret._fulfill;
    var reject = ret._reject;
    for (var i = 0, len = promises.length; i < len; ++i) {
        var val = promises[i];

        if (val === void 0 && !(hasOwn.call(promises, i))) {
            continue;
        }

        Promise.cast(val)._then(fulfill, reject, void 0, ret, null);
    }
    return ret;
}

Promise.race = function Promise$Race(promises) {
    return Promise$_Race(promises, void 0);
};

Promise.prototype.race = function Promise$race() {
    return Promise$_Race(this, void 0);
};

};

},{"./errors_api_rejection.js":90,"./util.js":61}],75:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var cr = Object.create;
if (cr) {
    var callerCache = cr(null);
    var getterCache = cr(null);
    callerCache[" size"] = getterCache[" size"] = 0;
}

module.exports = function(Promise) {
var util = require("./util.js");
var canEvaluate = util.canEvaluate;
var isIdentifier = util.isIdentifier;

function makeMethodCaller (methodName) {
    return new Function("obj", "                                             \n\
        'use strict'                                                         \n\
        var len = this.length;                                               \n\
        switch(len) {                                                        \n\
            case 1: return obj.methodName(this[0]);                          \n\
            case 2: return obj.methodName(this[0], this[1]);                 \n\
            case 3: return obj.methodName(this[0], this[1], this[2]);        \n\
            case 0: return obj.methodName();                                 \n\
            default: return obj.methodName.apply(obj, this);                 \n\
        }                                                                    \n\
        ".replace(/methodName/g, methodName));
}

function makeGetter (propertyName) {
    return new Function("obj", "                                             \n\
        'use strict';                                                        \n\
        return obj.propertyName;                                             \n\
        ".replace("propertyName", propertyName));
}

function getCompiled(name, compiler, cache) {
    var ret = cache[name];
    if (typeof ret !== "function") {
        if (!isIdentifier(name)) {
            return null;
        }
        ret = compiler(name);
        cache[name] = ret;
        cache[" size"]++;
        if (cache[" size"] > 512) {
            var keys = Object.keys(cache);
            for (var i = 0; i < 256; ++i) delete cache[keys[i]];
            cache[" size"] = keys.length - 256;
        }
    }
    return ret;
}

function getMethodCaller(name) {
    return getCompiled(name, makeMethodCaller, callerCache);
}

function getGetter(name) {
    return getCompiled(name, makeGetter, getterCache);
}

function caller(obj) {
    return obj[this.pop()].apply(obj, this);
}
Promise.prototype.call = function Promise$call(methodName) {
    var $_len = arguments.length;var args = new Array($_len - 1); for(var $_i = 1; $_i < $_len; ++$_i) {args[$_i - 1] = arguments[$_i];}
    if (canEvaluate) {
        var maybeCaller = getMethodCaller(methodName);
        if (maybeCaller !== null) {
            return this._then(maybeCaller, void 0, void 0, args, void 0);
        }
    }
    args.push(methodName);
    return this._then(caller, void 0, void 0, args, void 0);
};

function namedGetter(obj) {
    return obj[this];
}
function indexedGetter(obj) {
    return obj[this];
}
Promise.prototype.get = function Promise$get(propertyName) {
    var isIndex = (typeof propertyName === "number");
    var getter;
    if (!isIndex) {
        if (canEvaluate) {
            var maybeGetter = getGetter(propertyName);
            getter = maybeGetter !== null ? maybeGetter : namedGetter;
        } else {
            getter = namedGetter;
        }
    } else {
        getter = indexedGetter;
    }
    return this._then(getter, void 0, void 0, propertyName, void 0);
};
};

},{"./util.js":61}],76:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, apiRejection, INTERNAL, cast) {
var errors = require("./errors.js");
var TypeError = errors.TypeError;
var deprecated = require("./util.js").deprecated;
var util = require("./util.js");
var errorObj = util.errorObj;
var tryCatch1 = util.tryCatch1;
var yieldHandlers = [];

function promiseFromYieldHandler(value, yieldHandlers) {
    var _errorObj = errorObj;
    var _Promise = Promise;
    var len = yieldHandlers.length;
    for (var i = 0; i < len; ++i) {
        var result = tryCatch1(yieldHandlers[i], void 0, value);
        if (result === _errorObj) {
            return _Promise.reject(_errorObj.e);
        }
        var maybePromise = cast(result, promiseFromYieldHandler);
        if (maybePromise instanceof _Promise) return maybePromise;
    }
    return null;
}

function PromiseSpawn(generatorFunction, receiver, yieldHandler) {
    var promise = this._promise = new Promise(INTERNAL);
    promise._setTrace(void 0);
    this._generatorFunction = generatorFunction;
    this._receiver = receiver;
    this._generator = void 0;
    this._yieldHandlers = typeof yieldHandler === "function"
        ? [yieldHandler].concat(yieldHandlers)
        : yieldHandlers;
}

PromiseSpawn.prototype.promise = function PromiseSpawn$promise() {
    return this._promise;
};

PromiseSpawn.prototype._run = function PromiseSpawn$_run() {
    this._generator = this._generatorFunction.call(this._receiver);
    this._receiver =
        this._generatorFunction = void 0;
    this._next(void 0);
};

PromiseSpawn.prototype._continue = function PromiseSpawn$_continue(result) {
    if (result === errorObj) {
        this._generator = void 0;
        var trace = errors.canAttach(result.e)
            ? result.e : new Error(result.e + "");
        this._promise._attachExtraTrace(trace);
        this._promise._reject(result.e, trace);
        return;
    }

    var value = result.value;
    if (result.done === true) {
        this._generator = void 0;
        if (!this._promise._tryFollow(value)) {
            this._promise._fulfill(value);
        }
    } else {
        var maybePromise = cast(value, void 0);
        if (!(maybePromise instanceof Promise)) {
            maybePromise =
                promiseFromYieldHandler(maybePromise, this._yieldHandlers);
            if (maybePromise === null) {
                this._throw(new TypeError("A value was yielded that could not be treated as a promise"));
                return;
            }
        }
        maybePromise._then(
            this._next,
            this._throw,
            void 0,
            this,
            null
       );
    }
};

PromiseSpawn.prototype._throw = function PromiseSpawn$_throw(reason) {
    if (errors.canAttach(reason))
        this._promise._attachExtraTrace(reason);
    this._continue(
        tryCatch1(this._generator["throw"], this._generator, reason)
   );
};

PromiseSpawn.prototype._next = function PromiseSpawn$_next(value) {
    this._continue(
        tryCatch1(this._generator.next, this._generator, value)
   );
};

Promise.coroutine =
function Promise$Coroutine(generatorFunction, options) {
    if (typeof generatorFunction !== "function") {
        throw new TypeError("generatorFunction must be a function");
    }
    var yieldHandler = Object(options).yieldHandler;
    var PromiseSpawn$ = PromiseSpawn;
    return function () {
        var generator = generatorFunction.apply(this, arguments);
        var spawn = new PromiseSpawn$(void 0, void 0, yieldHandler);
        spawn._generator = generator;
        spawn._next(void 0);
        return spawn.promise();
    };
};

Promise.coroutine.addYieldHandler = function(fn) {
    if (typeof fn !== "function") throw new TypeError("fn must be a function");
    yieldHandlers.push(fn);
};

Promise.spawn = function Promise$Spawn(generatorFunction) {
    deprecated("Promise.spawn is deprecated. Use Promise.coroutine instead.");
    if (typeof generatorFunction !== "function") {
        return apiRejection("generatorFunction must be a function");
    }
    var spawn = new PromiseSpawn(generatorFunction, this);
    var ret = spawn.promise();
    spawn._run(Promise.spawn);
    return ret;
};
};

},{"./errors.js":63,"./util.js":61}],77:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, PromiseArray, apiRejection, cast, INTERNAL) {
var util = require("./util.js");
var tryCatch3 = util.tryCatch3;
var errorObj = util.errorObj;
var PENDING = {};
var EMPTY_ARRAY = [];

function MappingPromiseArray(promises, fn, limit, _filter) {
    this.constructor$(promises);
    this._callback = fn;
    this._preservedValues = _filter === INTERNAL
        ? new Array(this.length())
        : null;
    this._limit = limit;
    this._inFlight = 0;
    this._queue = limit >= 1 ? [] : EMPTY_ARRAY;
    this._init$(void 0, -2);
}
util.inherits(MappingPromiseArray, PromiseArray);

MappingPromiseArray.prototype._init = function MappingPromiseArray$_init() {};

MappingPromiseArray.prototype._promiseFulfilled =
function MappingPromiseArray$_promiseFulfilled(value, index) {
    var values = this._values;
    if (values === null) return;

    var length = this.length();
    var preservedValues = this._preservedValues;
    var limit = this._limit;
    if (values[index] === PENDING) {
        values[index] = value;
        if (limit >= 1) {
            this._inFlight--;
            this._drainQueue();
            if (this._isResolved()) return;
        }
    } else {
        if (limit >= 1 && this._inFlight >= limit) {
            values[index] = value;
            this._queue.push(index);
            return;
        }
        if (preservedValues !== null) preservedValues[index] = value;

        var callback = this._callback;
        var receiver = this._promise._boundTo;
        var ret = tryCatch3(callback, receiver, value, index, length);
        if (ret === errorObj) return this._reject(ret.e);

        var maybePromise = cast(ret, void 0);
        if (maybePromise instanceof Promise) {
            if (maybePromise.isPending()) {
                if (limit >= 1) this._inFlight++;
                values[index] = PENDING;
                return maybePromise._proxyPromiseArray(this, index);
            } else if (maybePromise.isFulfilled()) {
                ret = maybePromise.value();
            } else {
                maybePromise._unsetRejectionIsUnhandled();
                return this._reject(maybePromise.reason());
            }
        }
        values[index] = ret;
    }
    var totalResolved = ++this._totalResolved;
    if (totalResolved >= length) {
        if (preservedValues !== null) {
            this._filter(values, preservedValues);
        } else {
            this._resolve(values);
        }

    }
};

MappingPromiseArray.prototype._drainQueue =
function MappingPromiseArray$_drainQueue() {
    var queue = this._queue;
    var limit = this._limit;
    var values = this._values;
    while (queue.length > 0 && this._inFlight < limit) {
        var index = queue.pop();
        this._promiseFulfilled(values[index], index);
    }
};

MappingPromiseArray.prototype._filter =
function MappingPromiseArray$_filter(booleans, values) {
    var len = values.length;
    var ret = new Array(len);
    var j = 0;
    for (var i = 0; i < len; ++i) {
        if (booleans[i]) ret[j++] = values[i];
    }
    ret.length = j;
    this._resolve(ret);
};

MappingPromiseArray.prototype.preservedValues =
function MappingPromiseArray$preserveValues() {
    return this._preservedValues;
};

function map(promises, fn, options, _filter) {
    var limit = typeof options === "object" && options !== null
        ? options.concurrency
        : 0;
    limit = typeof limit === "number" &&
        isFinite(limit) && limit >= 1 ? limit : 0;
    return new MappingPromiseArray(promises, fn, limit, _filter);
}

Promise.prototype.map = function Promise$map(fn, options) {
    if (typeof fn !== "function") return apiRejection("fn must be a function");

    return map(this, fn, options, null).promise();
};

Promise.map = function Promise$Map(promises, fn, options, _filter) {
    if (typeof fn !== "function") return apiRejection("fn must be a function");
    return map(promises, fn, options, _filter).promise();
};


};

},{"./util.js":61}],78:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise) {
var util = require("./util.js");
var async = require("./async.js");
var tryCatch2 = util.tryCatch2;
var tryCatch1 = util.tryCatch1;
var errorObj = util.errorObj;

function thrower(r) {
    throw r;
}

function Promise$_spreadAdapter(val, receiver) {
    if (!util.isArray(val)) return Promise$_successAdapter(val, receiver);
    var ret = util.tryCatchApply(this, [null].concat(val), receiver);
    if (ret === errorObj) {
        async.invokeLater(thrower, void 0, ret.e);
    }
}

function Promise$_successAdapter(val, receiver) {
    var nodeback = this;
    var ret = val === void 0
        ? tryCatch1(nodeback, receiver, null)
        : tryCatch2(nodeback, receiver, null, val);
    if (ret === errorObj) {
        async.invokeLater(thrower, void 0, ret.e);
    }
}
function Promise$_errorAdapter(reason, receiver) {
    var nodeback = this;
    var ret = tryCatch1(nodeback, receiver, reason);
    if (ret === errorObj) {
        async.invokeLater(thrower, void 0, ret.e);
    }
}

Promise.prototype.nodeify = function Promise$nodeify(nodeback, options) {
    if (typeof nodeback == "function") {
        var adapter = Promise$_successAdapter;
        if (options !== void 0 && Object(options).spread) {
            adapter = Promise$_spreadAdapter;
        }
        this._then(
            adapter,
            Promise$_errorAdapter,
            void 0,
            nodeback,
            this._boundTo
        );
    }
    return this;
};
};

},{"./util.js":61,"./async.js":62}],81:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, PromiseArray, apiRejection, cast, INTERNAL) {
var util = require("./util.js");
var tryCatch4 = util.tryCatch4;
var tryCatch3 = util.tryCatch3;
var errorObj = util.errorObj;
function ReductionPromiseArray(promises, fn, accum, _each) {
    this.constructor$(promises);
    this._preservedValues = _each === INTERNAL ? [] : null;
    this._zerothIsAccum = (accum === void 0);
    this._gotAccum = false;
    this._reducingIndex = (this._zerothIsAccum ? 1 : 0);
    this._valuesPhase = undefined;

    var maybePromise = cast(accum, void 0);
    var rejected = false;
    var isPromise = maybePromise instanceof Promise;
    if (isPromise) {
        if (maybePromise.isPending()) {
            maybePromise._proxyPromiseArray(this, -1);
        } else if (maybePromise.isFulfilled()) {
            accum = maybePromise.value();
            this._gotAccum = true;
        } else {
            maybePromise._unsetRejectionIsUnhandled();
            this._reject(maybePromise.reason());
            rejected = true;
        }
    }
    if (!(isPromise || this._zerothIsAccum)) this._gotAccum = true;
    this._callback = fn;
    this._accum = accum;
    if (!rejected) this._init$(void 0, -5);
}
util.inherits(ReductionPromiseArray, PromiseArray);

ReductionPromiseArray.prototype._init =
function ReductionPromiseArray$_init() {};

ReductionPromiseArray.prototype._resolveEmptyArray =
function ReductionPromiseArray$_resolveEmptyArray() {
    if (this._gotAccum || this._zerothIsAccum) {
        this._resolve(this._preservedValues !== null
                        ? [] : this._accum);
    }
};

ReductionPromiseArray.prototype._promiseFulfilled =
function ReductionPromiseArray$_promiseFulfilled(value, index) {
    var values = this._values;
    if (values === null) return;
    var length = this.length();
    var preservedValues = this._preservedValues;
    var isEach = preservedValues !== null;
    var gotAccum = this._gotAccum;
    var valuesPhase = this._valuesPhase;
    var valuesPhaseIndex;
    if (!valuesPhase) {
        valuesPhase = this._valuesPhase = Array(length);
        for (valuesPhaseIndex=0; valuesPhaseIndex<length; ++valuesPhaseIndex) {
            valuesPhase[valuesPhaseIndex] = 0;
        }
    }
    valuesPhaseIndex = valuesPhase[index];

    if (index === 0 && this._zerothIsAccum) {
        if (!gotAccum) {
            this._accum = value;
            this._gotAccum = gotAccum = true;
        }
        valuesPhase[index] = ((valuesPhaseIndex === 0)
            ? 1 : 2);
    } else if (index === -1) {
        if (!gotAccum) {
            this._accum = value;
            this._gotAccum = gotAccum = true;
        }
    } else {
        if (valuesPhaseIndex === 0) {
            valuesPhase[index] = 1;
        }
        else {
            valuesPhase[index] = 2;
            if (gotAccum) {
                this._accum = value;
            }
        }
    }
    if (!gotAccum) return;

    var callback = this._callback;
    var receiver = this._promise._boundTo;
    var ret;

    for (var i = this._reducingIndex; i < length; ++i) {
        valuesPhaseIndex = valuesPhase[i];
        if (valuesPhaseIndex === 2) {
            this._reducingIndex = i + 1;
            continue;
        }
        if (valuesPhaseIndex !== 1) return;

        value = values[i];
        if (value instanceof Promise) {
            if (value.isFulfilled()) {
                value = value._settledValue;
            } else if (value.isPending()) {
                return;
            } else {
                value._unsetRejectionIsUnhandled();
                return this._reject(value.reason());
            }
        }

        if (isEach) {
            preservedValues.push(value);
            ret = tryCatch3(callback, receiver, value, i, length);
        }
        else {
            ret = tryCatch4(callback, receiver, this._accum, value, i, length);
        }

        if (ret === errorObj) return this._reject(ret.e);

        var maybePromise = cast(ret, void 0);
        if (maybePromise instanceof Promise) {
            if (maybePromise.isPending()) {
                valuesPhase[i] = 4;
                return maybePromise._proxyPromiseArray(this, i);
            } else if (maybePromise.isFulfilled()) {
                ret = maybePromise.value();
            } else {
                maybePromise._unsetRejectionIsUnhandled();
                return this._reject(maybePromise.reason());
            }
        }

        this._reducingIndex = i + 1;
        this._accum = ret;
    }

    if (this._reducingIndex < length) return;
    this._resolve(isEach ? preservedValues : this._accum);
};

function reduce(promises, fn, initialValue, _each) {
    if (typeof fn !== "function") return apiRejection("fn must be a function");
    var array = new ReductionPromiseArray(promises, fn, initialValue, _each);
    return array.promise();
}

Promise.prototype.reduce = function Promise$reduce(fn, initialValue) {
    return reduce(this, fn, initialValue, null);
};

Promise.reduce = function Promise$Reduce(promises, fn, initialValue, _each) {
    return reduce(promises, fn, initialValue, _each);
};
};

},{"./util.js":61}],82:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports =
    function(Promise, PromiseArray) {
var PromiseInspection = Promise.PromiseInspection;
var util = require("./util.js");

function SettledPromiseArray(values) {
    this.constructor$(values);
}
util.inherits(SettledPromiseArray, PromiseArray);

SettledPromiseArray.prototype._promiseResolved =
function SettledPromiseArray$_promiseResolved(index, inspection) {
    this._values[index] = inspection;
    var totalResolved = ++this._totalResolved;
    if (totalResolved >= this._length) {
        this._resolve(this._values);
    }
};

SettledPromiseArray.prototype._promiseFulfilled =
function SettledPromiseArray$_promiseFulfilled(value, index) {
    if (this._isResolved()) return;
    var ret = new PromiseInspection();
    ret._bitField = 268435456;
    ret._settledValue = value;
    this._promiseResolved(index, ret);
};
SettledPromiseArray.prototype._promiseRejected =
function SettledPromiseArray$_promiseRejected(reason, index) {
    if (this._isResolved()) return;
    var ret = new PromiseInspection();
    ret._bitField = 134217728;
    ret._settledValue = reason;
    this._promiseResolved(index, ret);
};

Promise.settle = function Promise$Settle(promises) {
    return new SettledPromiseArray(promises).promise();
};

Promise.prototype.settle = function Promise$settle() {
    return new SettledPromiseArray(this).promise();
};
};

},{"./util.js":61}],83:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports =
function(Promise, PromiseArray, apiRejection) {
var util = require("./util.js");
var RangeError = require("./errors.js").RangeError;
var AggregateError = require("./errors.js").AggregateError;
var isArray = util.isArray;


function SomePromiseArray(values) {
    this.constructor$(values);
    this._howMany = 0;
    this._unwrap = false;
    this._initialized = false;
}
util.inherits(SomePromiseArray, PromiseArray);

SomePromiseArray.prototype._init = function SomePromiseArray$_init() {
    if (!this._initialized) {
        return;
    }
    if (this._howMany === 0) {
        this._resolve([]);
        return;
    }
    this._init$(void 0, -5);
    var isArrayResolved = isArray(this._values);
    if (!this._isResolved() &&
        isArrayResolved &&
        this._howMany > this._canPossiblyFulfill()) {
        this._reject(this._getRangeError(this.length()));
    }
};

SomePromiseArray.prototype.init = function SomePromiseArray$init() {
    this._initialized = true;
    this._init();
};

SomePromiseArray.prototype.setUnwrap = function SomePromiseArray$setUnwrap() {
    this._unwrap = true;
};

SomePromiseArray.prototype.howMany = function SomePromiseArray$howMany() {
    return this._howMany;
};

SomePromiseArray.prototype.setHowMany =
function SomePromiseArray$setHowMany(count) {
    if (this._isResolved()) return;
    this._howMany = count;
};

SomePromiseArray.prototype._promiseFulfilled =
function SomePromiseArray$_promiseFulfilled(value) {
    if (this._isResolved()) return;
    this._addFulfilled(value);
    if (this._fulfilled() === this.howMany()) {
        this._values.length = this.howMany();
        if (this.howMany() === 1 && this._unwrap) {
            this._resolve(this._values[0]);
        } else {
            this._resolve(this._values);
        }
    }

};
SomePromiseArray.prototype._promiseRejected =
function SomePromiseArray$_promiseRejected(reason) {
    if (this._isResolved()) return;
    this._addRejected(reason);
    if (this.howMany() > this._canPossiblyFulfill()) {
        var e = new AggregateError();
        for (var i = this.length(); i < this._values.length; ++i) {
            e.push(this._values[i]);
        }
        this._reject(e);
    }
};

SomePromiseArray.prototype._fulfilled = function SomePromiseArray$_fulfilled() {
    return this._totalResolved;
};

SomePromiseArray.prototype._rejected = function SomePromiseArray$_rejected() {
    return this._values.length - this.length();
};

SomePromiseArray.prototype._addRejected =
function SomePromiseArray$_addRejected(reason) {
    this._values.push(reason);
};

SomePromiseArray.prototype._addFulfilled =
function SomePromiseArray$_addFulfilled(value) {
    this._values[this._totalResolved++] = value;
};

SomePromiseArray.prototype._canPossiblyFulfill =
function SomePromiseArray$_canPossiblyFulfill() {
    return this.length() - this._rejected();
};

SomePromiseArray.prototype._getRangeError =
function SomePromiseArray$_getRangeError(count) {
    var message = "Input array must contain at least " +
            this._howMany + " items but contains only " + count + " items";
    return new RangeError(message);
};

SomePromiseArray.prototype._resolveEmptyArray =
function SomePromiseArray$_resolveEmptyArray() {
    this._reject(this._getRangeError(0));
};

function Promise$_Some(promises, howMany) {
    if ((howMany | 0) !== howMany || howMany < 0) {
        return apiRejection("expecting a positive integer");
    }
    var ret = new SomePromiseArray(promises);
    var promise = ret.promise();
    if (promise.isRejected()) {
        return promise;
    }
    ret.setHowMany(howMany);
    ret.init();
    return promise;
}

Promise.some = function Promise$Some(promises, howMany) {
    return Promise$_Some(promises, howMany);
};

Promise.prototype.some = function Promise$some(howMany) {
    return Promise$_Some(this, howMany);
};

Promise._SomePromiseArray = SomePromiseArray;
};

},{"./util.js":61,"./errors.js":63}],84:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, PromiseArray) {
var util = require("./util.js");
var async = require("./async.js");
var errors = require("./errors.js");
var tryCatch1 = util.tryCatch1;
var errorObj = util.errorObj;

Promise.prototype.progressed = function Promise$progressed(handler) {
    return this._then(void 0, void 0, handler, void 0, void 0);
};

Promise.prototype._progress = function Promise$_progress(progressValue) {
    if (this._isFollowingOrFulfilledOrRejected()) return;
    this._progressUnchecked(progressValue);

};

Promise.prototype._progressHandlerAt =
function Promise$_progressHandlerAt(index) {
    return index === 0
        ? this._progressHandler0
        : this[(index << 2) + index - 5 + 2];
};

Promise.prototype._doProgressWith =
function Promise$_doProgressWith(progression) {
    var progressValue = progression.value;
    var handler = progression.handler;
    var promise = progression.promise;
    var receiver = progression.receiver;

    var ret = tryCatch1(handler, receiver, progressValue);
    if (ret === errorObj) {
        if (ret.e != null &&
            ret.e.name !== "StopProgressPropagation") {
            var trace = errors.canAttach(ret.e)
                ? ret.e : new Error(ret.e + "");
            promise._attachExtraTrace(trace);
            promise._progress(ret.e);
        }
    } else if (ret instanceof Promise) {
        ret._then(promise._progress, null, null, promise, void 0);
    } else {
        promise._progress(ret);
    }
};


Promise.prototype._progressUnchecked =
function Promise$_progressUnchecked(progressValue) {
    if (!this.isPending()) return;
    var len = this._length();
    var progress = this._progress;
    for (var i = 0; i < len; i++) {
        var handler = this._progressHandlerAt(i);
        var promise = this._promiseAt(i);
        if (!(promise instanceof Promise)) {
            var receiver = this._receiverAt(i);
            if (typeof handler === "function") {
                handler.call(receiver, progressValue, promise);
            } else if (receiver instanceof Promise && receiver._isProxied()) {
                receiver._progressUnchecked(progressValue);
            } else if (receiver instanceof PromiseArray) {
                receiver._promiseProgressed(progressValue, promise);
            }
            continue;
        }

        if (typeof handler === "function") {
            async.invoke(this._doProgressWith, this, {
                handler: handler,
                promise: promise,
                receiver: this._receiverAt(i),
                value: progressValue
            });
        } else {
            async.invoke(progress, promise, progressValue);
        }
    }
};
};

},{"./util.js":61,"./async.js":62,"./errors.js":63}],85:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, INTERNAL) {
var errors = require("./errors.js");
var canAttach = errors.canAttach;
var async = require("./async.js");
var CancellationError = errors.CancellationError;

Promise.prototype._cancel = function Promise$_cancel(reason) {
    if (!this.isCancellable()) return this;
    var parent;
    var promiseToReject = this;
    while ((parent = promiseToReject._cancellationParent) !== void 0 &&
        parent.isCancellable()) {
        promiseToReject = parent;
    }
    promiseToReject._attachExtraTrace(reason);
    promiseToReject._rejectUnchecked(reason);
};

Promise.prototype.cancel = function Promise$cancel(reason) {
    if (!this.isCancellable()) return this;
    reason = reason !== void 0
        ? (canAttach(reason) ? reason : new Error(reason + ""))
        : new CancellationError();
    async.invokeLater(this._cancel, this, reason);
    return this;
};

Promise.prototype.cancellable = function Promise$cancellable() {
    if (this._cancellable()) return this;
    this._setCancellable();
    this._cancellationParent = void 0;
    return this;
};

Promise.prototype.uncancellable = function Promise$uncancellable() {
    var ret = new Promise(INTERNAL);
    ret._propagateFrom(this, 2 | 4);
    ret._follow(this);
    ret._unsetCancellable();
    return ret;
};

Promise.prototype.fork =
function Promise$fork(didFulfill, didReject, didProgress) {
    var ret = this._then(didFulfill, didReject, didProgress,
                         void 0, void 0);

    ret._setCancellable();
    ret._cancellationParent = void 0;
    return ret;
};
};

},{"./errors.js":63,"./async.js":62}],89:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function (Promise, apiRejection, cast) {
    var TypeError = require("./errors.js").TypeError;
    var inherits = require("./util.js").inherits;
    var PromiseInspection = Promise.PromiseInspection;

    function inspectionMapper(inspections) {
        var len = inspections.length;
        for (var i = 0; i < len; ++i) {
            var inspection = inspections[i];
            if (inspection.isRejected()) {
                return Promise.reject(inspection.error());
            }
            inspections[i] = inspection.value();
        }
        return inspections;
    }

    function thrower(e) {
        setTimeout(function(){throw e;}, 0);
    }

    function dispose(resources, inspection) {
        var i = 0;
        var len = resources.length;
        var ret = Promise.defer();
        function iterator() {
            if (i >= len) return ret.resolve();
            var maybePromise = cast(resources[i++], void 0);
            if (maybePromise instanceof Promise &&
                maybePromise._isDisposable()) {
                try {
                    maybePromise = cast(maybePromise._getDisposer()
                                        .tryDispose(inspection), void 0);
                } catch (e) {
                    return thrower(e);
                }
                if (maybePromise instanceof Promise) {
                    return maybePromise._then(iterator, thrower,
                                              null, null, null);
                }
            }
            iterator();
        }
        iterator();
        return ret.promise;
    }

    function disposerSuccess(value) {
        var inspection = new PromiseInspection();
        inspection._settledValue = value;
        inspection._bitField = 268435456;
        return dispose(this, inspection).thenReturn(value);
    }

    function disposerFail(reason) {
        var inspection = new PromiseInspection();
        inspection._settledValue = reason;
        inspection._bitField = 134217728;
        return dispose(this, inspection).thenThrow(reason);
    }

    function Disposer(data, promise) {
        this._data = data;
        this._promise = promise;
    }

    Disposer.prototype.data = function Disposer$data() {
        return this._data;
    };

    Disposer.prototype.promise = function Disposer$promise() {
        return this._promise;
    };

    Disposer.prototype.resource = function Disposer$resource() {
        if (this.promise().isFulfilled()) {
            return this.promise().value();
        }
        return null;
    };

    Disposer.prototype.tryDispose = function(inspection) {
        var resource = this.resource();
        var ret = resource !== null
            ? this.doDispose(resource, inspection) : null;
        this._promise._unsetDisposable();
        this._data = this._promise = null;
        return ret;
    };

    function FunctionDisposer(fn, promise) {
        this.constructor$(fn, promise);
    }
    inherits(FunctionDisposer, Disposer);

    FunctionDisposer.prototype.doDispose = function (resource, inspection) {
        var fn = this.data();
        return fn.call(resource, resource, inspection);
    };

    Promise.using = function Promise$using() {
        var len = arguments.length;
        if (len < 2) return apiRejection(
                        "you must pass at least 2 arguments to Promise.using");
        var fn = arguments[len - 1];
        if (typeof fn !== "function") return apiRejection("fn must be a function");
        len--;
        var resources = new Array(len);
        for (var i = 0; i < len; ++i) {
            var resource = arguments[i];
            if (resource instanceof Disposer) {
                var disposer = resource;
                resource = resource.promise();
                resource._setDisposable(disposer);
            }
            resources[i] = resource;
        }

        return Promise.settle(resources)
            .then(inspectionMapper)
            .spread(fn)
            ._then(disposerSuccess, disposerFail, void 0, resources, void 0);
    };

    Promise.prototype._setDisposable =
    function Promise$_setDisposable(disposer) {
        this._bitField = this._bitField | 262144;
        this._disposer = disposer;
    };

    Promise.prototype._isDisposable = function Promise$_isDisposable() {
        return (this._bitField & 262144) > 0;
    };

    Promise.prototype._getDisposer = function Promise$_getDisposer() {
        return this._disposer;
    };

    Promise.prototype._unsetDisposable = function Promise$_unsetDisposable() {
        this._bitField = this._bitField & (~262144);
        this._disposer = void 0;
    };

    Promise.prototype.disposer = function Promise$disposer(fn) {
        if (typeof fn === "function") {
            return new FunctionDisposer(fn, this);
        }
        throw new TypeError();
    };

};

},{"./errors.js":63,"./util.js":61}],90:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise) {
var TypeError = require('./errors.js').TypeError;

function apiRejection(msg) {
    var error = new TypeError(msg);
    var ret = Promise.rejected(error);
    var parent = ret._peekContext();
    if (parent != null) {
        parent._attachExtraTrace(error);
    }
    return ret;
}

return apiRejection;
};

},{"./errors.js":63}],73:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var _setTimeout = function(fn, ms) {
    var len = arguments.length;
    var arg0 = arguments[2];
    var arg1 = arguments[3];
    var arg2 = len >= 5 ? arguments[4] : void 0;
    setTimeout(function() {
        fn(arg0, arg1, arg2);
    }, ms);
};

module.exports = function(Promise, INTERNAL, cast) {
var util = require("./util.js");
var errors = require("./errors.js");
var apiRejection = require("./errors_api_rejection")(Promise);
var TimeoutError = Promise.TimeoutError;

var afterTimeout = function Promise$_afterTimeout(promise, message, ms) {
    if (!promise.isPending()) return;
    if (typeof message !== "string") {
        message = "operation timed out after" + " " + ms + " ms"
    }
    var err = new TimeoutError(message);
    errors.markAsOriginatingFromRejection(err);
    promise._attachExtraTrace(err);
    promise._cancel(err);
};

var afterDelay = function Promise$_afterDelay(value, promise) {
    promise._fulfill(value);
};

var delay = Promise.delay = function Promise$Delay(value, ms) {
    if (ms === void 0) {
        ms = value;
        value = void 0;
    }
    ms = +ms;
    var maybePromise = cast(value, void 0);
    var promise = new Promise(INTERNAL);

    if (maybePromise instanceof Promise) {
        promise._propagateFrom(maybePromise, 7);
        promise._follow(maybePromise);
        return promise.then(function(value) {
            return Promise.delay(value, ms);
        });
    } else {
        promise._setTrace(void 0);
        _setTimeout(afterDelay, ms, value, promise);
    }
    return promise;
};

Promise.prototype.delay = function Promise$delay(ms) {
    return delay(this, ms);
};

Promise.prototype.timeout = function Promise$timeout(ms, message) {
    ms = +ms;

    var ret = new Promise(INTERNAL);
    ret._propagateFrom(this, 7);
    ret._follow(this);
    _setTimeout(afterTimeout, ms, ret, message, ms);
    return ret.cancellable();
};

};

},{"./util.js":61,"./errors.js":63,"./errors_api_rejection":90}],79:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, INTERNAL) {
var THIS = {};
var util = require("./util.js");
var nodebackForPromise = require("./promise_resolver.js")
    ._nodebackForPromise;
var withAppended = util.withAppended;
var maybeWrapAsError = util.maybeWrapAsError;
var canEvaluate = util.canEvaluate;
var TypeError = require("./errors").TypeError;
var defaultSuffix = "Async";
var defaultFilter = function(name, func) {
    return util.isIdentifier(name) &&
        name.charAt(0) !== "_" &&
        !util.isClass(func);
};
var defaultPromisified = {__isPromisified__: true};


function escapeIdentRegex(str) {
    return str.replace(/([$])/, "\\$");
}

function isPromisified(fn) {
    try {
        return fn.__isPromisified__ === true;
    }
    catch (e) {
        return false;
    }
}

function hasPromisified(obj, key, suffix) {
    var val = util.getDataPropertyOrDefault(obj, key + suffix,
                                            defaultPromisified);
    return val ? isPromisified(val) : false;
}
function checkValid(ret, suffix, suffixRegexp) {
    for (var i = 0; i < ret.length; i += 2) {
        var key = ret[i];
        if (suffixRegexp.test(key)) {
            var keyWithoutAsyncSuffix = key.replace(suffixRegexp, "");
            for (var j = 0; j < ret.length; j += 2) {
                if (ret[j] === keyWithoutAsyncSuffix) {
                    throw new TypeError("Cannot promisify an API " +
                        "that has normal methods with '"+suffix+"'-suffix");
                }
            }
        }
    }
}

function promisifiableMethods(obj, suffix, suffixRegexp, filter) {
    var keys = util.inheritedDataKeys(obj);
    var ret = [];
    for (var i = 0; i < keys.length; ++i) {
        var key = keys[i];
        var value = obj[key];
        if (typeof value === "function" &&
            !isPromisified(value) &&
            !hasPromisified(obj, key, suffix) &&
            filter(key, value, obj)) {
            ret.push(key, value);
        }
    }
    checkValid(ret, suffix, suffixRegexp);
    return ret;
}

function switchCaseArgumentOrder(likelyArgumentCount) {
    var ret = [likelyArgumentCount];
    var min = Math.max(0, likelyArgumentCount - 1 - 5);
    for(var i = likelyArgumentCount - 1; i >= min; --i) {
        if (i === likelyArgumentCount) continue;
        ret.push(i);
    }
    for(var i = likelyArgumentCount + 1; i <= 5; ++i) {
        ret.push(i);
    }
    return ret;
}

function argumentSequence(argumentCount) {
    return util.filledRange(argumentCount, "arguments[", "]");
}

function parameterDeclaration(parameterCount) {
    return util.filledRange(parameterCount, "_arg", "");
}

function parameterCount(fn) {
    if (typeof fn.length === "number") {
        return Math.max(Math.min(fn.length, 1023 + 1), 0);
    }
    return 0;
}

function generatePropertyAccess(key) {
    if (util.isIdentifier(key)) {
        return "." + key;
    }
    else return "['" + key.replace(/(['\\])/g, "\\$1") + "']";
}

function makeNodePromisifiedEval(callback, receiver, originalName, fn, suffix) {
    var newParameterCount = Math.max(0, parameterCount(fn) - 1);
    var argumentOrder = switchCaseArgumentOrder(newParameterCount);
    var callbackName =
        (typeof originalName === "string" && util.isIdentifier(originalName)
            ? originalName + suffix
            : "promisified");

    function generateCallForArgumentCount(count) {
        var args = argumentSequence(count).join(", ");
        var comma = count > 0 ? ", " : "";
        var ret;
        if (typeof callback === "string") {
            ret = "                                                          \n\
                this.method(args, fn);                                       \n\
                break;                                                       \n\
            ".replace(".method", generatePropertyAccess(callback));
        } else if (receiver === THIS) {
            ret =  "                                                         \n\
                callback.call(this, args, fn);                               \n\
                break;                                                       \n\
            ";
        } else if (receiver !== void 0) {
            ret =  "                                                         \n\
                callback.call(receiver, args, fn);                           \n\
                break;                                                       \n\
            ";
        } else {
            ret =  "                                                         \n\
                callback(args, fn);                                          \n\
                break;                                                       \n\
            ";
        }
        return ret.replace("args", args).replace(", ", comma);
    }

    function generateArgumentSwitchCase() {
        var ret = "";
        for(var i = 0; i < argumentOrder.length; ++i) {
            ret += "case " + argumentOrder[i] +":" +
                generateCallForArgumentCount(argumentOrder[i]);
        }
        var codeForCall;
        if (typeof callback === "string") {
            codeForCall = "                                                  \n\
                this.property.apply(this, args);                             \n\
            "
                .replace(".property", generatePropertyAccess(callback));
        } else if (receiver === THIS) {
            codeForCall = "                                                  \n\
                callback.apply(this, args);                                  \n\
            ";
        } else {
            codeForCall = "                                                  \n\
                callback.apply(receiver, args);                              \n\
            ";
        }

        ret += "                                                             \n\
        default:                                                             \n\
            var args = new Array(len + 1);                                   \n\
            var i = 0;                                                       \n\
            for (var i = 0; i < len; ++i) {                                  \n\
               args[i] = arguments[i];                                       \n\
            }                                                                \n\
            args[i] = fn;                                                    \n\
            [CodeForCall]                                                    \n\
            break;                                                           \n\
        ".replace("[CodeForCall]", codeForCall);
        return ret;
    }

    return new Function("Promise",
                        "callback",
                        "receiver",
                        "withAppended",
                        "maybeWrapAsError",
                        "nodebackForPromise",
                        "INTERNAL","                                         \n\
        var ret = function FunctionName(Parameters) {                        \n\
            'use strict';                                                    \n\
            var len = arguments.length;                                      \n\
            var promise = new Promise(INTERNAL);                             \n\
            promise._setTrace(void 0);                                       \n\
            var fn = nodebackForPromise(promise);                            \n\
            try {                                                            \n\
                switch(len) {                                                \n\
                    [CodeForSwitchCase]                                      \n\
                }                                                            \n\
            } catch (e) {                                                    \n\
                var wrapped = maybeWrapAsError(e);                           \n\
                promise._attachExtraTrace(wrapped);                          \n\
                promise._reject(wrapped);                                    \n\
            }                                                                \n\
            return promise;                                                  \n\
        };                                                                   \n\
        ret.__isPromisified__ = true;                                        \n\
        return ret;                                                          \n\
        "
        .replace("FunctionName", callbackName)
        .replace("Parameters", parameterDeclaration(newParameterCount))
        .replace("[CodeForSwitchCase]", generateArgumentSwitchCase()))(
            Promise,
            callback,
            receiver,
            withAppended,
            maybeWrapAsError,
            nodebackForPromise,
            INTERNAL
        );
}

function makeNodePromisifiedClosure(callback, receiver) {
    function promisified() {
        var _receiver = receiver;
        if (receiver === THIS) _receiver = this;
        if (typeof callback === "string") {
            callback = _receiver[callback];
        }
        var promise = new Promise(INTERNAL);
        promise._setTrace(void 0);
        var fn = nodebackForPromise(promise);
        try {
            callback.apply(_receiver, withAppended(arguments, fn));
        } catch(e) {
            var wrapped = maybeWrapAsError(e);
            promise._attachExtraTrace(wrapped);
            promise._reject(wrapped);
        }
        return promise;
    }
    promisified.__isPromisified__ = true;
    return promisified;
}

var makeNodePromisified = canEvaluate
    ? makeNodePromisifiedEval
    : makeNodePromisifiedClosure;

function promisifyAll(obj, suffix, filter, promisifier) {
    var suffixRegexp = new RegExp(escapeIdentRegex(suffix) + "$");
    var methods =
        promisifiableMethods(obj, suffix, suffixRegexp, filter);

    for (var i = 0, len = methods.length; i < len; i+= 2) {
        var key = methods[i];
        var fn = methods[i+1];
        var promisifiedKey = key + suffix;
        obj[promisifiedKey] = promisifier === makeNodePromisified
                ? makeNodePromisified(key, THIS, key, fn, suffix)
                : promisifier(fn);
    }
    util.toFastProperties(obj);
    return obj;
}

function promisify(callback, receiver) {
    return makeNodePromisified(callback, receiver, void 0, callback);
}

Promise.promisify = function Promise$Promisify(fn, receiver) {
    if (typeof fn !== "function") {
        throw new TypeError("fn must be a function");
    }
    if (isPromisified(fn)) {
        return fn;
    }
    return promisify(fn, arguments.length < 2 ? THIS : receiver);
};

Promise.promisifyAll = function Promise$PromisifyAll(target, options) {
    if (typeof target !== "function" && typeof target !== "object") {
        throw new TypeError("the target of promisifyAll must be an object or a function");
    }
    options = Object(options);
    var suffix = options.suffix;
    if (typeof suffix !== "string") suffix = defaultSuffix;
    var filter = options.filter;
    if (typeof filter !== "function") filter = defaultFilter;
    var promisifier = options.promisifier;
    if (typeof promisifier !== "function") promisifier = makeNodePromisified;

    if (!util.isIdentifier(suffix)) {
        throw new RangeError("suffix must be a valid identifier");
    }

    var keys = util.inheritedDataKeys(target, {includeHidden: true});
    for (var i = 0; i < keys.length; ++i) {
        var value = target[keys[i]];
        if (keys[i] !== "constructor" &&
            util.isClass(value)) {
            promisifyAll(value.prototype, suffix, filter, promisifier);
            promisifyAll(value, suffix, filter, promisifier);
        }
    }

    return promisifyAll(target, suffix, filter, promisifier);
};
};


},{"./util.js":61,"./promise_resolver.js":68,"./errors":63}],80:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, PromiseArray, cast) {
var util = require("./util.js");
var apiRejection = require("./errors_api_rejection")(Promise);
var isObject = util.isObject;
var es5 = require("./es5.js");

function PropertiesPromiseArray(obj) {
    var keys = es5.keys(obj);
    var len = keys.length;
    var values = new Array(len * 2);
    for (var i = 0; i < len; ++i) {
        var key = keys[i];
        values[i] = obj[key];
        values[i + len] = key;
    }
    this.constructor$(values);
}
util.inherits(PropertiesPromiseArray, PromiseArray);

PropertiesPromiseArray.prototype._init =
function PropertiesPromiseArray$_init() {
    this._init$(void 0, -3) ;
};

PropertiesPromiseArray.prototype._promiseFulfilled =
function PropertiesPromiseArray$_promiseFulfilled(value, index) {
    if (this._isResolved()) return;
    this._values[index] = value;
    var totalResolved = ++this._totalResolved;
    if (totalResolved >= this._length) {
        var val = {};
        var keyOffset = this.length();
        for (var i = 0, len = this.length(); i < len; ++i) {
            val[this._values[i + keyOffset]] = this._values[i];
        }
        this._resolve(val);
    }
};

PropertiesPromiseArray.prototype._promiseProgressed =
function PropertiesPromiseArray$_promiseProgressed(value, index) {
    if (this._isResolved()) return;

    this._promise._progress({
        key: this._values[index + this.length()],
        value: value
    });
};

PropertiesPromiseArray.prototype.shouldCopyValues =
function PropertiesPromiseArray$_shouldCopyValues() {
    return false;
};

PropertiesPromiseArray.prototype.getActualLength =
function PropertiesPromiseArray$getActualLength(len) {
    return len >> 1;
};

function Promise$_Props(promises) {
    var ret;
    var castValue = cast(promises, void 0);

    if (!isObject(castValue)) {
        return apiRejection("cannot await properties of a non-object");
    } else if (castValue instanceof Promise) {
        ret = castValue._then(Promise.props, void 0, void 0, void 0, void 0);
    } else {
        ret = new PropertiesPromiseArray(castValue).promise();
    }

    if (castValue instanceof Promise) {
        ret._propagateFrom(castValue, 4);
    }
    return ret;
}

Promise.prototype.props = function Promise$props() {
    return Promise$_Props(this);
};

Promise.props = function Promise$Props(promises) {
    return Promise$_Props(promises);
};
};

},{"./util.js":61,"./es5.js":91,"./errors_api_rejection":90}],91:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
var isES5 = (function(){
    "use strict";
    return this === void 0;
})();

if (isES5) {
    module.exports = {
        freeze: Object.freeze,
        defineProperty: Object.defineProperty,
        keys: Object.keys,
        getPrototypeOf: Object.getPrototypeOf,
        isArray: Array.isArray,
        isES5: isES5
    };
} else {
    var has = {}.hasOwnProperty;
    var str = {}.toString;
    var proto = {}.constructor.prototype;

    var ObjectKeys = function ObjectKeys(o) {
        var ret = [];
        for (var key in o) {
            if (has.call(o, key)) {
                ret.push(key);
            }
        }
        return ret;
    }

    var ObjectDefineProperty = function ObjectDefineProperty(o, key, desc) {
        o[key] = desc.value;
        return o;
    }

    var ObjectFreeze = function ObjectFreeze(obj) {
        return obj;
    }

    var ObjectGetPrototypeOf = function ObjectGetPrototypeOf(obj) {
        try {
            return Object(obj).constructor.prototype;
        }
        catch (e) {
            return proto;
        }
    }

    var ArrayIsArray = function ArrayIsArray(obj) {
        try {
            return str.call(obj) === "[object Array]";
        }
        catch(e) {
            return false;
        }
    }

    module.exports = {
        isArray: ArrayIsArray,
        keys: ObjectKeys,
        defineProperty: ObjectDefineProperty,
        freeze: ObjectFreeze,
        getPrototypeOf: ObjectGetPrototypeOf,
        isES5: isES5
    };
}

},{}],92:[function(require,module,exports){
(function(process){/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var schedule;
var _MutationObserver;
if (typeof process === "object" && typeof process.version === "string") {
    schedule = function Promise$_Scheduler(fn) {
        process.nextTick(fn);
    };
}
else if ((typeof MutationObserver !== "undefined" &&
         (_MutationObserver = MutationObserver)) ||
         (typeof WebKitMutationObserver !== "undefined" &&
         (_MutationObserver = WebKitMutationObserver))) {
    schedule = (function() {
        var div = document.createElement("div");
        var queuedFn = void 0;
        var observer = new _MutationObserver(
            function Promise$_Scheduler() {
                var fn = queuedFn;
                queuedFn = void 0;
                fn();
            }
       );
        observer.observe(div, {
            attributes: true
        });
        return function Promise$_Scheduler(fn) {
            queuedFn = fn;
            div.setAttribute("class", "foo");
        };

    })();
}
else if (typeof setTimeout !== "undefined") {
    schedule = function Promise$_Scheduler(fn) {
        setTimeout(fn, 0);
    };
}
else throw new Error("no async scheduler available");
module.exports = schedule;

})(require("__browserify_process"))
},{"__browserify_process":60}],93:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
function arrayCopy(src, srcIndex, dst, dstIndex, len) {
    for (var j = 0; j < len; ++j) {
        dst[j + dstIndex] = src[j + srcIndex];
    }
}

function Queue(capacity) {
    this._capacity = capacity;
    this._length = 0;
    this._front = 0;
    this._makeCapacity();
}

Queue.prototype._willBeOverCapacity =
function Queue$_willBeOverCapacity(size) {
    return this._capacity < size;
};

Queue.prototype._pushOne = function Queue$_pushOne(arg) {
    var length = this.length();
    this._checkCapacity(length + 1);
    var i = (this._front + length) & (this._capacity - 1);
    this[i] = arg;
    this._length = length + 1;
};

Queue.prototype.push = function Queue$push(fn, receiver, arg) {
    var length = this.length() + 3;
    if (this._willBeOverCapacity(length)) {
        this._pushOne(fn);
        this._pushOne(receiver);
        this._pushOne(arg);
        return;
    }
    var j = this._front + length - 3;
    this._checkCapacity(length);
    var wrapMask = this._capacity - 1;
    this[(j + 0) & wrapMask] = fn;
    this[(j + 1) & wrapMask] = receiver;
    this[(j + 2) & wrapMask] = arg;
    this._length = length;
};

Queue.prototype.shift = function Queue$shift() {
    var front = this._front,
        ret = this[front];

    this[front] = void 0;
    this._front = (front + 1) & (this._capacity - 1);
    this._length--;
    return ret;
};

Queue.prototype.length = function Queue$length() {
    return this._length;
};

Queue.prototype._makeCapacity = function Queue$_makeCapacity() {
    var len = this._capacity;
    for (var i = 0; i < len; ++i) {
        this[i] = void 0;
    }
};

Queue.prototype._checkCapacity = function Queue$_checkCapacity(size) {
    if (this._capacity < size) {
        this._resizeTo(this._capacity << 3);
    }
};

Queue.prototype._resizeTo = function Queue$_resizeTo(capacity) {
    var oldFront = this._front;
    var oldCapacity = this._capacity;
    var oldQueue = new Array(oldCapacity);
    var length = this.length();

    arrayCopy(this, 0, oldQueue, 0, oldCapacity);
    this._capacity = capacity;
    this._makeCapacity();
    this._front = 0;
    if (oldFront + length <= oldCapacity) {
        arrayCopy(oldQueue, oldFront, this, 0, length);
    } else {        var lengthBeforeWrapping =
            length - ((oldFront + length) & (oldCapacity - 1));

        arrayCopy(oldQueue, oldFront, this, 0, lengthBeforeWrapping);
        arrayCopy(oldQueue, 0, this, lengthBeforeWrapping,
                    length - lengthBeforeWrapping);
    }
};

module.exports = Queue;

},{}]},{},[1])
//@ sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL21hc2ViL2Rldi90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9pbmRleC5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9ub2RlLmpzIiwiL2hvbWUvbWFzZWIvZGV2L3RoaWNrZXQvbGliLXdlYi90aGlja2V0L3dlYi5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9ydW50aW1lL2luZGV4LmpzIiwiL2hvbWUvbWFzZWIvZGV2L3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2Jyb3dzZXJpZnkyLWxpc3QuanMiLCIvaG9tZS9tYXNlYi9kZXYvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvdXRpbC9jb21wb25lbnQtbG9hZGVyLmpzIiwiL2hvbWUvbWFzZWIvZGV2L3RoaWNrZXQvbGliLXdlYi90aGlja2V0L3V0aWwvcGVyaW9kaWMuanMiLCIvaG9tZS9tYXNlYi9kZXYvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS9kaXNwYXRjaGVyLmpzIiwiL2hvbWUvbWFzZWIvZGV2L3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2NvcmUvY291bnRkb3duLWxhdGNoLmpzIiwiL2hvbWUvbWFzZWIvZGV2L3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2NvcmUvb3B0aW9ucy5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9jb3JlL2xhbmcuanMiLCIvaG9tZS9tYXNlYi9kZXYvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS9zdGF0ZS1ndWFyZC5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9jb3JlL3B1Yi1zdWIuanMiLCIvaG9tZS9tYXNlYi9kZXYvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29sbGVjdGlvbi9kb3VibHktbGlua2VkLWxpc3QuanMiLCIvaG9tZS9tYXNlYi9kZXYvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29sbGVjdGlvbi9vYmplY3QtaGFzaC1tYXAuanMiLCIvaG9tZS9tYXNlYi9kZXYvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29sbGVjdGlvbi9scnUtaGFzaC1tYXAuanMiLCIvaG9tZS9tYXNlYi9kZXYvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvc3RvcmFnZS9jYWNoaW5nLWRhdGEtc3RvcmUuanMiLCIvaG9tZS9tYXNlYi9kZXYvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvc3RvcmFnZS9pbi1tZW1vcnktZGF0YS1zdG9yZS5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9zdG9yYWdlL2xydS1kYXRhLXN0b3JlLmpzIiwiL2hvbWUvbWFzZWIvZGV2L3RoaWNrZXQvbGliLXdlYi90aGlja2V0L3N0b3JhZ2Uvc2lnbmFsaW5nLWRhdGEtc3RvcmUuanMiLCIvaG9tZS9tYXNlYi9kZXYvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvYXBwa2l0L2NvbmZpZ3VyYXRpb24tbWFnaWMuanMiLCIvaG9tZS9tYXNlYi9kZXYvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvYXBwa2l0L2FwcC5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9tZXNzYWdpbmcvZXhjaGFuZ2UuanMiLCIvaG9tZS9tYXNlYi9kZXYvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvbWVzc2FnaW5nL2NvdXJpZXIuanMiLCIvaG9tZS9tYXNlYi9kZXYvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS91dWlkLmpzIiwiL2hvbWUvbWFzZWIvZGV2L3RoaWNrZXQvbGliLXdlYi90aGlja2V0L3V0aWwvY29tcG9uZW50LXJlZ2lzdHJ5LmpzIiwiL2hvbWUvbWFzZWIvZGV2L3RoaWNrZXQvbGliLXdlYi90aGlja2V0L3NjaGVkdWxlci9pbmRleC5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L25vZGVfbW9kdWxlcy91bmRlcnNjb3JlL3VuZGVyc2NvcmUuanMiLCIvaG9tZS9tYXNlYi9kZXYvdGhpY2tldC9ub2RlX21vZHVsZXMvbW9yaS9tb3JpLmpzIiwiL2hvbWUvbWFzZWIvZGV2L3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2NvcmUvc2VxdWVuY2VyL3VuaXQtc2VxdWVuY2VyLmpzIiwiL2hvbWUvbWFzZWIvZGV2L3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2NvcmUvc2VxdWVuY2VyL2RlbGVnYXRpbmctY29tcG9zaXRlLXNlcXVlbmNlci5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9jb3JlL3NlcXVlbmNlci9jbG9jay1zZXF1ZW5jZXIuanMiLCIvaG9tZS9tYXNlYi9kZXYvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS9zZXF1ZW5jZXIvZGVsZWdhdGluZy1mb3J3YXJkaW5nLXNlcXVlbmNlci5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L2xpYi13ZWIvdGhpY2tldC90aW1lL2Nsb2NrL2xvZ2ljYWwtY2xvY2suanMiLCIvaG9tZS9tYXNlYi9kZXYvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvdGltZS9jbG9jay9zeXN0ZW0tY2xvY2suanMiLCIvaG9tZS9tYXNlYi9kZXYvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvYXBwa2l0L2NvbmZpZy9zY29wZWQtY29uZmlndXJhdGlvbi1yZXNvbHZlci5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9hcHBraXQvY29uZmlnL3Njb3BlZC1jb25maWd1cmF0aW9uLmpzIiwiL2hvbWUvbWFzZWIvZGV2L3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2NvcmUvbG9nZ2luZy9sb2dnZXIuanMiLCIvaG9tZS9tYXNlYi9kZXYvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS9jaGFubmVsL2NoYW5uZWwuanMiLCIvaG9tZS9tYXNlYi9kZXYvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS9jaGFubmVsL2NoYWluZWQtY2hhbm5lbC5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9jb3JlL2NoYW5uZWwvY29tcG9zaXRlLWNoYW5uZWwuanMiLCIvaG9tZS9tYXNlYi9kZXYvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvbWVzc2FnaW5nL2ZpYmVyL2luLW1lbW9yeS1maWJlci5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9tZXNzYWdpbmcvZmliZXIvbGlua2FibGUtZmliZXIuanMiLCIvaG9tZS9tYXNlYi9kZXYvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS9zZXJkZS9qc29uLXNlcmRlLmpzIiwiL2hvbWUvbWFzZWIvZGV2L3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2NvcmUvcmVmL2luZGV4LmpzIiwiL2hvbWUvbWFzZWIvZGV2L3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vYmx1ZWJpcmQuanMiLCIvaG9tZS9tYXNlYi9kZXYvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS9sb2dnaW5nL2FwcGVuZGVycy9jb25zb2xlLWxvZy1hcHBlbmRlci5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9hcHBraXQvYm9vdHN0cmFwcGVyLmpzIiwiL2hvbWUvbWFzZWIvZGV2L3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2FwcGtpdC93ZWItYXBwLWNvbnRhaW5lci5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9zY2hlZHVsZXIvd2ViLXNjaGVkdWxlci5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9ydW50aW1lL2RlZmF1bHQtcnVudGltZS5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9zdG9yYWdlL2ludGVybmFscy9leHBpcmluZy1lbnRyeS5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9hcHBraXQvaW50ZXJuYWwvcHJvY2Vzcy1rZWVwLWFsaXZlLmpzIiwiL2hvbWUvbWFzZWIvZGV2L3RoaWNrZXQvbGliLXdlYi90aGlja2V0L21lc3NhZ2luZy9pbnRlcm5hbHMvbWFpbGJveC5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L25vZGVfbW9kdWxlcy9ncnVudC1icm93c2VyaWZ5Mi9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvaW5zZXJ0LW1vZHVsZS1nbG9iYWxzL25vZGVfbW9kdWxlcy9wcm9jZXNzL2Jyb3dzZXIuanMiLCIvaG9tZS9tYXNlYi9kZXYvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9wcm9taXNlLmpzIiwiL2hvbWUvbWFzZWIvZGV2L3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2NvcmUvcmVmL3JlZi5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9jb3JlL3JlZi9kZWxlZ2F0aW5nLXJlZi5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9tZXNzYWdpbmcvbS10eXBlLmpzIiwiL2hvbWUvbWFzZWIvZGV2L3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vc3luY2hyb25vdXNfaW5zcGVjdGlvbi5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL2ZpbHRlci5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL2FueS5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL2VhY2guanMiLCIvaG9tZS9tYXNlYi9kZXYvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS9zY2hlZHVsZXIvc2V0LXRpbWVvdXQtc2NoZWR1bGVyLmpzIiwiL2hvbWUvbWFzZWIvZGV2L3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vdXRpbC5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL2FzeW5jLmpzIiwiL2hvbWUvbWFzZWIvZGV2L3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vZXJyb3JzLmpzIiwiL2hvbWUvbWFzZWIvZGV2L3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vdGhlbmFibGVzLmpzIiwiL2hvbWUvbWFzZWIvZGV2L3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vcHJvbWlzZV9hcnJheS5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL2NhcHR1cmVkX3RyYWNlLmpzIiwiL2hvbWUvbWFzZWIvZGV2L3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vY2F0Y2hfZmlsdGVyLmpzIiwiL2hvbWUvbWFzZWIvZGV2L3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vcHJvbWlzZV9yZXNvbHZlci5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL2ZpbmFsbHkuanMiLCIvaG9tZS9tYXNlYi9kZXYvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9kaXJlY3RfcmVzb2x2ZS5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL2pvaW4uanMiLCIvaG9tZS9tYXNlYi9kZXYvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9yYWNlLmpzIiwiL2hvbWUvbWFzZWIvZGV2L3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vY2FsbF9nZXQuanMiLCIvaG9tZS9tYXNlYi9kZXYvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9nZW5lcmF0b3JzLmpzIiwiL2hvbWUvbWFzZWIvZGV2L3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vbWFwLmpzIiwiL2hvbWUvbWFzZWIvZGV2L3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vbm9kZWlmeS5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL3JlZHVjZS5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL3NldHRsZS5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL3NvbWUuanMiLCIvaG9tZS9tYXNlYi9kZXYvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9wcm9ncmVzcy5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL2NhbmNlbC5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL3VzaW5nLmpzIiwiL2hvbWUvbWFzZWIvZGV2L3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vZXJyb3JzX2FwaV9yZWplY3Rpb24uanMiLCIvaG9tZS9tYXNlYi9kZXYvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi90aW1lcnMuanMiLCIvaG9tZS9tYXNlYi9kZXYvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9wcm9taXNpZnkuanMiLCIvaG9tZS9tYXNlYi9kZXYvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9wcm9wcy5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL2VzNS5qcyIsIi9ob21lL21hc2ViL2Rldi90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL3NjaGVkdWxlLmpzIiwiL2hvbWUvbWFzZWIvZGV2L3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vcXVldWUuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlOQTtBQUNBOztBQ0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9EQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0dBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqVEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25KQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdk5BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaFBBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN1hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2RUE7QUFDQTtBQUNBO0FBQ0E7O0FDSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaDBDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDalpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3SkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbE1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9GQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekxBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdmhDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1UUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNySUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5SkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNySkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5S0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdFVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2RkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgQ29tcG9uZW50UmVnaXN0cnksXG4gIHdlYkFsaWFzZXMsXG4gIG5vZGVBbGlhc2VzXG4pIHtcbiAgdmFyIGMgPSBuZXcgQ29tcG9uZW50UmVnaXN0cnkoKTtcblxuXG4gIGMucmVnaXN0ZXJNYW55KFtcbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL3V0aWwvY29tcG9uZW50LWxvYWRlclwiKSxcbiAgICAgIGFzOiBcImNvbXBvbmVudC1sb2FkZXJcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL3V0aWwvcGVyaW9kaWNcIiksXG4gICAgICBhczogXCJwZXJpb2RpY1wiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29yZS9kaXNwYXRjaGVyXCIpLFxuICAgICAgYXM6IFwiZGlzcGF0Y2hlclwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29yZS9jb3VudGRvd24tbGF0Y2hcIiksXG4gICAgICBhczogXCJjb3VudGRvd24tbGF0Y2hcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL2NvcmUvb3B0aW9uc1wiKSxcbiAgICAgIGFzOiBcIm9wdGlvbnNcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL2NvcmUvbGFuZ1wiKSxcbiAgICAgIGFzOiBcImxhbmdcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL2NvcmUvcmVmXCIpLFxuICAgICAgYXM6IFwicmVmXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9jb3JlL3N0YXRlLWd1YXJkXCIpLFxuICAgICAgYXM6IFwic3RhdGUtZ3VhcmRcIlxuICAgIH0sXG5cblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29yZS9wdWItc3ViXCIpLFxuICAgICAgYXM6IFwicHViLXN1YlwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29yZS9zZXF1ZW5jZXIvdW5pdC1zZXF1ZW5jZXJcIiksXG4gICAgICBhczogW1widW5pdC1zZXF1ZW5jZXJcIiwgXCJzZXF1ZW5jZXJcIl1cbiAgICB9LFxuXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL2NvcmUvc2VxdWVuY2VyL2Nsb2NrLXNlcXVlbmNlclwiKSxcbiAgICAgIGFzOiBcImNsb2NrLXNlcXVlbmNlclwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29yZS9zZXF1ZW5jZXIvZGVsZWdhdGluZy1jb21wb3NpdGUtc2VxdWVuY2VyXCIpLFxuICAgICAgYXM6IFwiZGVsZWdhdGluZy1jb21wb3NpdGUtc2VxdWVuY2VyXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9jb3JlL3NlcXVlbmNlci9kZWxlZ2F0aW5nLWZvcndhcmRpbmctc2VxdWVuY2VyXCIpLFxuICAgICAgYXM6IFwiZGVsZWdhdGluZy1mb3J3YXJkaW5nLXNlcXVlbmNlclwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29sbGVjdGlvbi9kb3VibHktbGlua2VkLWxpc3RcIiksXG4gICAgICBhczogXCJkb3VibHktbGlua2VkLWxpc3RcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL2NvbGxlY3Rpb24vb2JqZWN0LWhhc2gtbWFwXCIpLFxuICAgICAgYXM6IFtcImhhc2gtbWFwXCIsIFwib2JqZWN0LWhhc2gtbWFwXCJdXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29sbGVjdGlvbi9scnUtaGFzaC1tYXBcIiksXG4gICAgICBhczogXCJscnUtaGFzaC1tYXBcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL3N0b3JhZ2UvY2FjaGluZy1kYXRhLXN0b3JlXCIpLFxuICAgICAgYXM6IFwiY2FjaGluZy1kYXRhLXN0b3JlXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9zdG9yYWdlL2luLW1lbW9yeS1kYXRhLXN0b3JlXCIpLFxuICAgICAgYXM6IFwiaW4tbWVtb3J5LWRhdGEtc3RvcmVcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL3N0b3JhZ2UvbHJ1LWRhdGEtc3RvcmVcIiksXG4gICAgICBhczogXCJscnUtZGF0YS1zdG9yZVwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vc3RvcmFnZS9zaWduYWxpbmctZGF0YS1zdG9yZVwiKSxcbiAgICAgIGFzOiBcInNpZ25hbGluZy1kYXRhLXN0b3JlXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi90aW1lL2Nsb2NrL2xvZ2ljYWwtY2xvY2tcIiksXG4gICAgICBhczogXCJsb2dpY2FsLWNsb2NrXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi90aW1lL2Nsb2NrL3N5c3RlbS1jbG9ja1wiKSxcbiAgICAgIGFzOiBcInN5c3RlbS1jbG9ja1wiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vYXBwa2l0L2NvbmZpZ3VyYXRpb24tbWFnaWNcIiksXG4gICAgICBhczogXCJjb25maWd1cmF0aW9uLW1hZ2ljXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9hcHBraXQvY29uZmlnL3Njb3BlZC1jb25maWd1cmF0aW9uLXJlc29sdmVyXCIpLFxuICAgICAgYXM6IFwic2NvcGVkLWNvbmZpZ3VyYXRpb24tcmVzb2x2ZXJcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL2FwcGtpdC9jb25maWcvc2NvcGVkLWNvbmZpZ3VyYXRpb25cIiksXG4gICAgICBhczogW1wic2NvcGVkLWNvbmZpZ3VyYXRpb25cIiwgXCJjb25maWcvc2NvcGVkLWNvbmZpZ3VyYXRpb25cIl1cbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9hcHBraXQvYXBwXCIpLFxuICAgICAgYXM6IFwiYXBwXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9ydW50aW1lXCIpLFxuICAgICAgYXM6IFwicnVudGltZVwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29yZS9sb2dnaW5nL2xvZ2dlclwiKSxcbiAgICAgIGFzOiBcImxvZ2dlclwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29yZS9sb2dnaW5nL2FwcGVuZGVycy9jb25zb2xlLWxvZy1hcHBlbmRlclwiKSxcbiAgICAgIGFzOiBbXCJhcHBlbmRlcnMvY29uc29sZS1sb2dcIiwgXCJjb25zb2xlLWxvZy1hcHBlbmRlclwiXVxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL2NvcmUvY2hhbm5lbC9jaGFubmVsXCIpLFxuICAgICAgYXM6IFwiY2hhbm5lbFwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29yZS9jaGFubmVsL2NoYWluZWQtY2hhbm5lbFwiKSxcbiAgICAgIGFzOiBcImNoYWluZWQtY2hhbm5lbFwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29yZS9jaGFubmVsL2NvbXBvc2l0ZS1jaGFubmVsXCIpLFxuICAgICAgYXM6IFwiY29tcG9zaXRlLWNoYW5uZWxcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL21lc3NhZ2luZy9leGNoYW5nZVwiKSxcbiAgICAgIGFzOiBcIm1lc3NhZ2luZy9leGNoYW5nZVwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vbWVzc2FnaW5nL2NvdXJpZXJcIiksXG4gICAgICBhczogXCJtZXNzYWdpbmcvY291cmllclwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vbWVzc2FnaW5nL2ZpYmVyL2luLW1lbW9yeS1maWJlclwiKSxcbiAgICAgIGFzOiBcIm1lc3NhZ2luZy9maWJlcnMvaW4tbWVtb3J5XCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9tZXNzYWdpbmcvZmliZXIvbGlua2FibGUtZmliZXJcIiksXG4gICAgICBhczogXCJtZXNzYWdpbmcvZmliZXJzL2xpbmthYmxlXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9jb3JlL3V1aWRcIiksXG4gICAgICBhczogXCJ1dWlkXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9jb3JlL3NlcmRlL2pzb24tc2VyZGVcIiksXG4gICAgICBhczogW1wic2VyZGUvanNvblwiLCBcImpzb24tc2VyZGVcIl1cbiAgICB9XG4gIF0pO1xuXG4gIGMuc2VsZlJlZ2lzdGVyKHtcbiAgICBhczogXCJjb21wb25lbnQtcmVnaXN0cnlcIlxuICB9KTtcblxuICB3ZWJBbGlhc2VzKGMpO1xuICBub2RlQWxpYXNlcyhjKTtcblxuICByZXR1cm4gYztcbn07XG5cbnZhciBnID0gKHR5cGVvZiB3aW5kb3cgPT09IFwidW5kZWZpbmVkXCIgPyB7fSA6IHdpbmRvdyk7XG5nLnRoaWNrZXQgPSBtb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcIi4vdXRpbC9jb21wb25lbnQtcmVnaXN0cnlcIiksXG4gIHJlcXVpcmUoXCIuL3dlYlwiKSxcbiAgcmVxdWlyZShcIi4vbm9kZVwiKVxuKTtcblxufSkoKSIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYykge307XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGMpIHtcbiAgYy5yZWdpc3Rlck1hbnkoW1xuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vYXBwa2l0L2Jvb3RzdHJhcHBlclwiKSxcbiAgICAgIGFzOiBcImJvb3RzdHJhcHBlclwiXG4gICAgfSxcbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL2FwcGtpdC93ZWItYXBwLWNvbnRhaW5lclwiKSxcbiAgICAgIGFzOiBcImFwcC1jb250YWluZXJcIlxuICAgIH0sXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9zY2hlZHVsZXIvd2ViLXNjaGVkdWxlclwiKSxcbiAgICAgIGFzOiBcInNjaGVkdWxlclwiXG4gICAgfVxuICBdKTtcblxuICByZXF1aXJlKFwiLi9icm93c2VyaWZ5Mi1saXN0XCIpO1xufTtcbiIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxubW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiLi9kZWZhdWx0LXJ1bnRpbWVcIik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXtyZXF1aXJlKFwiLi9ub2RlLmpzXCIpO1xucmVxdWlyZShcIi4vYXBwa2l0L2NvbmZpZy9zY29wZWQtY29uZmlndXJhdGlvbi1yZXNvbHZlci5qc1wiKTtcbnJlcXVpcmUoXCIuL2FwcGtpdC9jb25maWcvc2NvcGVkLWNvbmZpZ3VyYXRpb24uanNcIik7XG5yZXF1aXJlKFwiLi9hcHBraXQvYm9vdHN0cmFwcGVyLmpzXCIpO1xucmVxdWlyZShcIi4vYXBwa2l0L2NvbmZpZ3VyYXRpb24tbWFnaWMuanNcIik7XG5yZXF1aXJlKFwiLi9hcHBraXQvaW50ZXJuYWwvcHJvY2Vzcy1rZWVwLWFsaXZlLmpzXCIpO1xucmVxdWlyZShcIi4vYXBwa2l0L2FwcC5qc1wiKTtcbnJlcXVpcmUoXCIuL2FwcGtpdC93ZWItYXBwLWNvbnRhaW5lci5qc1wiKTtcbnJlcXVpcmUoXCIuL3dlYi5qc1wiKTtcbnJlcXVpcmUoXCIuL3N0b3JhZ2UvaW4tbWVtb3J5LWRhdGEtc3RvcmUuanNcIik7XG5yZXF1aXJlKFwiLi9zdG9yYWdlL2xydS1kYXRhLXN0b3JlLmpzXCIpO1xucmVxdWlyZShcIi4vc3RvcmFnZS9pbnRlcm5hbHMvZXhwaXJpbmctZW50cnkuanNcIik7XG5yZXF1aXJlKFwiLi9zdG9yYWdlL3NpZ25hbGluZy1kYXRhLXN0b3JlLmpzXCIpO1xucmVxdWlyZShcIi4vc3RvcmFnZS9jYWNoaW5nLWRhdGEtc3RvcmUuanNcIik7XG5yZXF1aXJlKFwiLi91dGlsL3BlcmlvZGljLmpzXCIpO1xucmVxdWlyZShcIi4vdXRpbC9jb21wb25lbnQtbG9hZGVyLmpzXCIpO1xucmVxdWlyZShcIi4vdXRpbC9jb21wb25lbnQtcmVnaXN0cnkuanNcIik7XG5yZXF1aXJlKFwiLi90aW1lL2Nsb2NrL3N5c3RlbS1jbG9jay5qc1wiKTtcbnJlcXVpcmUoXCIuL3RpbWUvY2xvY2svbG9naWNhbC1jbG9jay5qc1wiKTtcbnJlcXVpcmUoXCIuL21lc3NhZ2luZy9tLXR5cGUuanNcIik7XG5yZXF1aXJlKFwiLi9tZXNzYWdpbmcvZmliZXIvaW4tbWVtb3J5LWZpYmVyLmpzXCIpO1xucmVxdWlyZShcIi4vbWVzc2FnaW5nL2ZpYmVyL2xpbmthYmxlLWZpYmVyLmpzXCIpO1xucmVxdWlyZShcIi4vbWVzc2FnaW5nL2ludGVybmFscy9tYWlsYm94LmpzXCIpO1xucmVxdWlyZShcIi4vbWVzc2FnaW5nL2NvdXJpZXIuanNcIik7XG5yZXF1aXJlKFwiLi9tZXNzYWdpbmcvZXhjaGFuZ2UuanNcIik7XG5yZXF1aXJlKFwiLi9zY2hlZHVsZXIvd2ViLXNjaGVkdWxlci5qc1wiKTtcbnJlcXVpcmUoXCIuL3NjaGVkdWxlci9pbmRleC5qc1wiKTtcbnJlcXVpcmUoXCIuL2luZGV4LmpzXCIpO1xucmVxdWlyZShcIi4vcnVudGltZS9pbmRleC5qc1wiKTtcbnJlcXVpcmUoXCIuL3J1bnRpbWUvZGVmYXVsdC1ydW50aW1lLmpzXCIpO1xucmVxdWlyZShcIi4vY29sbGVjdGlvbi9vYmplY3QtaGFzaC1tYXAuanNcIik7XG5yZXF1aXJlKFwiLi9jb2xsZWN0aW9uL2xydS1oYXNoLW1hcC5qc1wiKTtcbnJlcXVpcmUoXCIuL2NvbGxlY3Rpb24vZG91Ymx5LWxpbmtlZC1saXN0LmpzXCIpO1xucmVxdWlyZShcIi4vY29yZS9zZXF1ZW5jZXIvZGVsZWdhdGluZy1mb3J3YXJkaW5nLXNlcXVlbmNlci5qc1wiKTtcbnJlcXVpcmUoXCIuL2NvcmUvc2VxdWVuY2VyL3VuaXQtc2VxdWVuY2VyLmpzXCIpO1xucmVxdWlyZShcIi4vY29yZS9zZXF1ZW5jZXIvY2xvY2stc2VxdWVuY2VyLmpzXCIpO1xucmVxdWlyZShcIi4vY29yZS9zZXF1ZW5jZXIvZGVsZWdhdGluZy1jb21wb3NpdGUtc2VxdWVuY2VyLmpzXCIpO1xucmVxdWlyZShcIi4vY29yZS9yZWYvaW5kZXguanNcIik7XG5yZXF1aXJlKFwiLi9jb3JlL3JlZi9kZWxlZ2F0aW5nLXJlZi5qc1wiKTtcbnJlcXVpcmUoXCIuL2NvcmUvcmVmL3JlZi5qc1wiKTtcbnJlcXVpcmUoXCIuL2NvcmUvY291bnRkb3duLWxhdGNoLmpzXCIpO1xucmVxdWlyZShcIi4vY29yZS91dWlkLmpzXCIpO1xucmVxdWlyZShcIi4vY29yZS9sb2dnaW5nL2FwcGVuZGVycy9jb25zb2xlLWxvZy1hcHBlbmRlci5qc1wiKTtcbnJlcXVpcmUoXCIuL2NvcmUvbG9nZ2luZy9sb2dnZXIuanNcIik7XG5yZXF1aXJlKFwiLi9jb3JlL2xhbmcuanNcIik7XG5yZXF1aXJlKFwiLi9jb3JlL3NjaGVkdWxlci9zZXQtdGltZW91dC1zY2hlZHVsZXIuanNcIik7XG5yZXF1aXJlKFwiLi9jb3JlL3N0YXRlLWd1YXJkLmpzXCIpO1xucmVxdWlyZShcIi4vY29yZS9kaXNwYXRjaGVyLmpzXCIpO1xucmVxdWlyZShcIi4vY29yZS9zZXJkZS9qc29uLXNlcmRlLmpzXCIpO1xucmVxdWlyZShcIi4vY29yZS9vcHRpb25zLmpzXCIpO1xucmVxdWlyZShcIi4vY29yZS9wdWItc3ViLmpzXCIpO1xucmVxdWlyZShcIi4vY29yZS9jaGFubmVsL2NoYW5uZWwuanNcIik7XG5yZXF1aXJlKFwiLi9jb3JlL2NoYW5uZWwvY2hhaW5lZC1jaGFubmVsLmpzXCIpO1xucmVxdWlyZShcIi4vY29yZS9jaGFubmVsL2NvbXBvc2l0ZS1jaGFubmVsLmpzXCIpO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgZmFjdG9yeSA9IGZ1bmN0aW9uKFxuICBfLFxuICBPcHRpb25zXG4pIHtcbiAgdmFyIENvbXBvbmVudExvYWRlciA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKENvbXBvbmVudExvYWRlci5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihyZXF1aXJlRnVuKSB7XG4gICAgICB0aGlzLl9yZXF1aXJlRnVuID0gcmVxdWlyZUZ1bjtcbiAgICAgIHRoaXMuX2FsaWFzZXMgPSB7fTtcbiAgICAgIHRoaXMuX3BhdGhUcmFuc2Zvcm0gPSBmdW5jdGlvbihpZCkgeyByZXR1cm4gaWQ7fTtcbiAgICB9LFxuXG4gICAgc2V0UGF0aFRyYW5zZm9ybTogZnVuY3Rpb24ocGF0aFRyYW5zZm9ybSkge1xuICAgICAgdGhpcy5fcGF0aFRyYW5zZm9ybSA9IHBhdGhUcmFuc2Zvcm07XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gICAgYWxpYXM6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB2YXIgYWxpYXNOYW1lICA9IG9wdHMuZ2V0T3JFcnJvcihcImFzXCIpO1xuICAgICAgdGhpcy5fYWxpYXNlc1thbGlhc05hbWVdID0gb3B0cy5nZXRPckVycm9yKFwibW9kdWxlXCIpO1xuICAgIH0sXG5cbiAgICBidWxrQWxpYXM6IGZ1bmN0aW9uKGFsaWFzZXMpIHtcbiAgICAgIF8uZWFjaChhbGlhc2VzLCBmdW5jdGlvbihhbGlhc05hbWVzLCBtb2R1bGVOYW1lKSB7XG4gICAgICAgIGlmICghXy5pc0FycmF5KGFsaWFzTmFtZXMpKSB7XG4gICAgICAgICAgYWxpYXNOYW1lcyA9IFthbGlhc05hbWVzXVxuICAgICAgICB9XG4gICAgICAgIF8uZWFjaChhbGlhc05hbWVzLCBmdW5jdGlvbihhbGlhc05hbWUpIHtcbiAgICAgICAgICB0aGlzLmFsaWFzKHttb2R1bGU6IG1vZHVsZU5hbWUsIGFzOiBhbGlhc05hbWV9KTtcbiAgICAgICAgfSwgdGhpcyk7XG4gICAgICB9LCB0aGlzKTtcbiAgICB9LFxuXG4gICAgY29tcG9uZW50OiBmdW5jdGlvbihhbGlhcykge1xuICAgICAgdmFyIG1vZCA9IHRoaXMuX2FsaWFzZXNbYWxpYXNdO1xuICAgICAgaWYgKCFtb2QpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBhbGlhcyBwcm92aWRlZCAobm8gc3VjaCBtb2R1bGUpOiBgXCIrYWxpYXMrXCInXCIpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMuX3JlcXVpcmVGdW4odGhpcy5fcGF0aFRyYW5zZm9ybShtb2QpKTtcbiAgICB9LFxuXG4gICAgYzogZnVuY3Rpb24oYWxpYXMpIHtcbiAgICAgIHJldHVybiB0aGlzLmNvbXBvbmVudC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIENvbXBvbmVudExvYWRlcjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL29wdGlvbnNcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgUHJvbWlzZSxcbiAgT3B0aW9ucyxcbiAgU3RhdGVHdWFyZCxcbiAgQ2hhbm5lbCxcbiAgQ2hhaW5lZENoYW5uZWwsXG4gIExvZ2dlclxuKSB7XG5cbiAgdmFyIFBlcmlvZGljID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgdmFyIExvZyA9IExvZ2dlci5jcmVhdGUoXCJQZXJpb2RpY1wiKTtcblxuICBfLmV4dGVuZChQZXJpb2RpYy5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdGhpcy5fc2NoZWR1bGVyUmVmID0gb3B0cy5nZXRPckVycm9yKFwic2NoZWR1bGVyXCIpO1xuICAgICAgdGhpcy5fdGFzayAgICAgICAgID0gb3B0cy5nZXRPckVsc2UoXCJ0YXNrXCIpO1xuICAgICAgdGhpcy5faW50ZXJ2YWwgICAgID0gb3B0cy5nZXRPckVycm9yKFwiaW50ZXJ2YWxcIik7XG5cbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQgICA9IG5ldyBTdGF0ZUd1YXJkKFtcImRpc3Bvc2VkXCIsIFwic3RhcnRlZFwiXSk7XG4gICAgICB0aGlzLl9jaGFubmVsICAgICAgPSBuZXcgQ2hhbm5lbCh7IHNlbnRpbmVsOiB0aGlzIH0pO1xuICAgICAgdGhpcy5fdGFza0lkICAgICAgID0gbnVsbDtcblxuICAgICAgXy5iaW5kQWxsKHRoaXMsIFwiX3J1blRhc2tcIik7XG4gICAgfSxcblxuXG4gICAgc3RhcnQ6IGZ1bmN0aW9uKCl7XG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkXG4gICAgICAgIC5kZW55KFwiZGlzcG9zZWRcIiwgXCJzdGFydGVkXCIpXG4gICAgICAgIC5hcHBseShcInN0YXJ0ZWRcIik7XG5cbiAgICAgIHRoaXMuX3NjaGVkdWxlTmV4dCh0cnVlKTtcbiAgICB9LFxuXG5cbiAgICBzdG9wOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX2NhbmNlbFBlbmRpbmcoKTtcbiAgICAgIHRoaXMuX2NhbmNlbE91dHN0YW5kaW5nKCk7XG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkLnVuYXBwbHkoXCJzdGFydGVkXCIpO1xuICAgIH0sXG5cbiAgICBlZ3Jlc3NDaGFubmVsOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBuZXcgQ2hhaW5lZENoYW5uZWwoe1xuICAgICAgICBzZW50aW5lbDogdGhpcyxcbiAgICAgICAgY2hhaW5UbzogdGhpcy5fY2hhbm5lbFxuICAgICAgfSk7XG4gICAgfSxcblxuICAgIF9ydW5UYXNrOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciByZXN1bHRzID0ge1xuICAgICAgICBtVDogXCJyZXN1bHRzXCIsXG4gICAgICAgIHJlc3VsdDogbnVsbCxcbiAgICAgICAgZXJyOiBudWxsXG4gICAgICB9O1xuXG4gICAgICB0aGlzLl90YXNrSWQgPSBudWxsO1xuICAgICAgdGhpcy5fY3VycmVudFJ1biA9IFByb21pc2VcbiAgICAgICAgLmJpbmQodGhpcylcbiAgICAgICAgLmNhbmNlbGxhYmxlKClcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX3Rhc2soKTtcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgcmVzdWx0cy5yZXN1bHQgPSByZXN1bHQ7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXVnaHQoUHJvbWlzZS5DYW5jZWxsYXRpb25FcnJvciwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgLy8gTGV0IGl0IGJlLiBEb24ndCB3YW50IGl0IHRvIHRyaWNrbGUgaW50byB0aGUgcmVzdWx0cy5cbiAgICAgICAgfSlcbiAgICAgICAgLmNhdWdodChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICByZXN1bHRzLmVyciA9IGVycjtcbiAgICAgICAgfSlcbiAgICAgICAgLmxhc3RseShmdW5jdGlvbigpIHtcbiAgICAgICAgICB0aGlzLl9jdXJyZW50UnVuID0gbnVsbDtcbiAgICAgICAgICB0aGlzLl9ub3RpZnlSZXN1bHRzKHJlc3VsdHMpO1xuICAgICAgICAgIHRoaXMuX3NjaGVkdWxlTmV4dCgpO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG5cbiAgICBfbm90aWZ5UmVzdWx0czogZnVuY3Rpb24ocmVzdWx0cykge1xuICAgICAgdGhpcy5fc2NoZWR1bGVyUmVmLmdldCgpLnJ1blNvb24oXy5iaW5kKGZ1bmN0aW9uKCkge1xuXG4gICAgICAgIGlmICh0aGlzLl9zdGF0ZUd1YXJkLmFwcGxpZWQoXCJkaXNwb3NlZFwiKSB8fCAhdGhpcy5fc3RhdGVHdWFyZC5hcHBsaWVkKFwic3RhcnRlZFwiKSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChMb2cuaXNUcmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgIExvZy50cmFjZShcIk5vdGlmeWluZyByZXN1bHRzXCIsIHJlc3VsdHMpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fY2hhbm5lbC5wdWJsaXNoKHRoaXMsIHJlc3VsdHMpO1xuICAgICAgfSwgdGhpcykpO1xuICAgIH0sXG5cblxuICAgIF9zY2hlZHVsZU5leHQ6IGZ1bmN0aW9uKG5vdykge1xuICAgICAgaWYgKHRoaXMuX3N0YXRlR3VhcmQuYXBwbGllZChcImRpc3Bvc2VkXCIpIHx8ICF0aGlzLl9zdGF0ZUd1YXJkLmFwcGxpZWQoXCJzdGFydGVkXCIpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRoaXMuX3Rhc2tJZCA9IHRoaXMuX3NjaGVkdWxlclJlZi5nZXQoKS5zY2hlZHVsZSh0aGlzLl9ydW5UYXNrLCBub3cgPyAwIDogdGhpcy5faW50ZXJ2YWwpO1xuICAgICAgTG9nLnRyYWNlKFwiU2NoZWR1bGVkIHRhc2tcIiwgdGhpcy5fdGFza0lkKTtcbiAgICB9LFxuXG5cbiAgICBfY2FuY2VsUGVuZGluZzogZnVuY3Rpb24oKSB7XG4gICAgICBMb2cudHJhY2UoXCJjYW5jZWxQZW5kaW5nIHJlcXVlc3RlZCwgbG9va2luZyBmb3IgcGVuZGluZyB0YXNrLlwiKTtcbiAgICAgIGlmICh0aGlzLl90YXNrSWQpIHtcbiAgICAgICAgTG9nLnRyYWNlKFwiRm91bmQgcGVuZGluZyB0YXNrOyBjYW5jZWxsaW5nXCIsIHRoaXMuX3Rhc2tJZCk7XG4gICAgICAgIHRoaXMuX3NjaGVkdWxlclJlZi5nZXQoKS51bnNjaGVkdWxlKHRoaXMuX3Rhc2tJZCk7XG4gICAgICAgIHRoaXMuX3Rhc2tJZCA9IG51bGw7XG4gICAgICB9XG4gICAgfSxcblxuICAgIF9jYW5jZWxPdXRzdGFuZGluZzogZnVuY3Rpb24oKSB7XG4gICAgICBMb2cudHJhY2UoXCJjYW5jZWxPdXRzdGFuZGluZyByZXF1ZXN0ZWQsIGxvb2tpbmcgZm9yIG91dHN0YW5kaW5nIHdvcmsuXCIpO1xuICAgICAgaWYgKHRoaXMuX2N1cnJlbnRSdW4pIHtcbiAgICAgICAgTG9nLnRyYWNlKFwiT3V0c3RhbmRpbmcgd29yayBmb3VuZDsgY2FuY2VsbGluZ1wiKTtcbiAgICAgICAgdGhpcy5fY3VycmVudFJ1bi5jYW5jZWwoKTtcbiAgICAgICAgdGhpcy5fY3VycmVudFJ1biA9IG51bGw7XG4gICAgICB9XG4gICAgfSxcblxuICAgIGRpc3Bvc2U6IGZ1bmN0aW9uKCl7XG4gICAgICBpZiAodGhpcy5fc3RhdGVHdWFyZC5hcHBsaWVkKFwiZGlzcG9zZWRcIikpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9jYW5jZWxQZW5kaW5nKCk7XG4gICAgICB0aGlzLl9jYW5jZWxPdXRzdGFuZGluZygpO1xuXG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkLmFwcGx5KFwiZGlzcG9zZWRcIik7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gUGVyaW9kaWM7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJibHVlYmlyZFwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvc3RhdGUtZ3VhcmRcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL2NoYW5uZWwvY2hhbm5lbFwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvY2hhbm5lbC9jaGFpbmVkLWNoYW5uZWxcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL2xvZ2dpbmcvbG9nZ2VyXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIE0sXG4gIE9wdGlvbnMsXG4gIFN0YXRlR3VhcmRcbikge1xuXG4gIC8qKlxuICAgKiBBdHRlbXB0cyB0byBpbnRlbGxpZ2VudGx5IGRpc3BhdGNoIGFuIG9iamVjdCB3aXRoIGFuIG1UIGF0dHJpYnV0ZSwgdXNpbmdcbiAgICogdGhlIHJ1bGVzIHByb3ZpZGVkIGF0IGluc3RhbnRpYXRpb24uXG4gICAqXG4gICAqIEZvciBhIGdpdmVuIG1UeXBlZCBvYmplY3QsIHNlYXJjaGVzIHRoZSBwcm92aWRlZCBgZGVsZWdhdGVgIGZvciBhIG1ldGhvZFxuICAgKiBuYW1lZCBbcHJlZml4XVtjYW1lbC1jYXNlZCBtVF0sIGFuZCBpZiBwcmVzZW50LCBjYWxscyBpdC4gSWYgbm90IGZvdW5kLFxuICAgKiBsb29rcyBmb3IgW3ByZWZpeF1FbHNlLiBJZiB0aGUgbVQgYXR0cmlidXRlIGlzbid0IGZvdW5kLCBkaXNwYXRjaGVzIHRvXG4gICAqIFtwcmVmaXhdTWFsZm9ybWVkLlxuICAgKi9cbiAgdmFyIERpc3BhdGNoZXIgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICB2YXIgREVGQVVMVF9DT05URVhUX0RFTEVHQVRFID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHt9O1xuICB9O1xuXG4gIF8uZXh0ZW5kKERpc3BhdGNoZXIucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIHRoaXMuX2RlbGVnYXRlICAgICAgICA9IG9wdHMuZ2V0T3JFcnJvcihcImRlbGVnYXRlXCIpLFxuICAgICAgdGhpcy5fcHJlZml4ICAgICAgICAgID0gb3B0cy5nZXRPckVsc2UoXCJwcmVmaXhcIiwgXCJvbk1zZ1wiKTtcbiAgICAgIHRoaXMuX2Vsc2VTdWZmaXggICAgICA9IG9wdHMuZ2V0T3JFbHNlKFwiZWxzZVN1ZmZpeFwiLCBcImVsc2VcIik7XG4gICAgICB0aGlzLl9tYWxmb3JtZWRTdWZmaXggPSBvcHRzLmdldE9yRWxzZShcIm1hbGZvcm1lZFN1ZmZpeFwiLCBcIm1hbGZvcm1lZFwiKTtcbiAgICAgIHRoaXMuX2NvbnRleHREZWxlZ2F0ZSA9IG9wdHMuZ2V0T3JFbHNlKFwiY29udGV4dERlbGVnYXRlXCIsIERFRkFVTFRfQ09OVEVYVF9ERUxFR0FURSk7XG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkICAgICAgPSBuZXcgU3RhdGVHdWFyZChbXCJkaXNwb3NlZFwiXSk7XG4gICAgICB0aGlzLl9zdWJzICAgICAgICAgICAgPSBNLmhhc2hfbWFwKCk7XG5cbiAgICAgIHZhciBjaGFubmVscyA9IG9wdHMuZ2V0T3JFbHNlKFwibGlzdGVuXCIsIFtdKTtcblxuICAgICAgaWYgKCFfLmlzQXJyYXkoY2hhbm5lbHMpKSB7XG4gICAgICAgIGNoYW5uZWxzID0gW2NoYW5uZWxzXTtcbiAgICAgIH1cblxuICAgICAgXy5lYWNoKGNoYW5uZWxzLCBfLmJpbmQoZnVuY3Rpb24oYykge1xuICAgICAgICB0aGlzLmxpc3RlbihjKVxuICAgICAgfSwgdGhpcykpO1xuICAgIH0sXG5cbiAgICBsaXN0ZW46IGZ1bmN0aW9uKGNoYW5uZWwpIHtcbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQuZGVueShcImRpc3Bvc2VkXCIpO1xuXG4gICAgICB2YXIgc3ViID0gY2hhbm5lbC5zdWJzY3JpYmUoXy5iaW5kKGZ1bmN0aW9uKG1zZykge1xuICAgICAgICB0aGlzLmRpc3BhdGNoKG1zZyk7XG4gICAgICB9LCB0aGlzKSk7XG5cbiAgICAgIHRoaXMuX3N1YnMgPSBNLmFzc29jKHRoaXMuX3N1YnMsIHN1Yi5pZCgpLCBzdWIpO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBkaXNwb3NlOiBfLmJpbmQoZnVuY3Rpb24oKXtcbiAgICAgICAgICB2YXIgblN1YiA9IE0uZ2V0KHRoaXMuX3N1YnMsIHN1Yi5pZCgpKTtcbiAgICAgICAgICBpZiAoblN1Yikge1xuICAgICAgICAgICAgdGhpcy5fc3VicyA9IE0uZGlzc29jKHRoaXMuX3N1YnMsIHN1Yi5pZCgpKTtcbiAgICAgICAgICAgIG5TdWIuZGlzcG9zZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSwgdGhpcylcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgZGlzcGF0Y2g6IGZ1bmN0aW9uKG1UeXBlZCwgY3R4KSB7XG4gICAgICBpZiAodGhpcy5fc3RhdGVHdWFyZC5hcHBsaWVkKFwiZGlzcG9zZWRcIikpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB2YXIgaGFuZGxlciA9IHRoaXMuX2dldFZldHRlZEhhbmRsZXJOYW1lKG1UeXBlZCk7XG5cbiAgICAgIGlmIChoYW5kbGVyKSB7XG4gICAgICAgIHRoaXMuX2RlbGVnYXRlW2hhbmRsZXJdKG1UeXBlZCwgdGhpcy5fY29udGV4dERlbGVnYXRlKG1UeXBlZCwgY3R4KSk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIExpa2UgYGRpc3BhdGNoYCwgYnV0IGV4cGVjdHMgZGVsZWdhdGUgdG8gcmV0dXJuIGEgUHJvbWlzZTxvYmplY3Q+XG4gICAgICovXG4gICAgZGlzcGF0Y2hBc3luYzogZnVuY3Rpb24obVR5cGVkLCBjdHgpIHtcbiAgICAgIGlmICh0aGlzLl9zdGF0ZUd1YXJkLmFwcGxpZWQoXCJkaXNwb3NlZFwiKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciBoYW5kbGVyID0gdGhpcy5fZ2V0VmV0dGVkSGFuZGxlck5hbWUobVR5cGVkKTtcbiAgICAgIGlmIChoYW5kbGVyKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9kZWxlZ2F0ZVtoYW5kbGVyXShtVHlwZWQsIHRoaXMuX2NvbnRleHREZWxlZ2F0ZShtVHlwZWQsIGN0eCkpO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBkaXNwb3NlOiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICh0aGlzLl9zdGF0ZUd1YXJkLmFwcGxpZWQoXCJkaXNwb3NlZFwiKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciBzdWJzID0gdGhpcy5fc3VicztcbiAgICAgIHRoaXMuX3N1YnMgPSBNLmhhc2hfbWFwKCk7XG5cbiAgICAgIE0uZWFjaChzdWJzLCBmdW5jdGlvbihwYWlyKSB7XG4gICAgICAgIE0ubnRoKHBhaXIsIDEpLmRpc3Bvc2UoKTtcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLl9kZWxlZ2F0ZSA9IG51bGw7XG5cbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQuYXBwbHkoXCJkaXNwb3NlZFwiKTtcbiAgICB9LFxuXG4gICAgX2dldEhhbmRsZXJOYW1lOiBmdW5jdGlvbihwcmVmaXgsIHN1ZmZpeCkge1xuICAgICAgcmV0dXJuIHByZWZpeCArIHN1ZmZpeC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHN1ZmZpeC5zdWJzdHIoMSk7XG4gICAgfSxcblxuICAgIF9nZXRWZXR0ZWRIYW5kbGVyTmFtZTogZnVuY3Rpb24obVR5cGVkKSB7XG4gICAgICB2YXIgbVQgPSBtVHlwZWQubVQsXG4gICAgICAgICAgcHJlZml4ID0gdGhpcy5fcHJlZml4LFxuICAgICAgICAgIHBvdGVudGlhbEhhbmRsZXJOYW1lLFxuICAgICAgICAgIGZpbmFsSGFuZGxlck5hbWU7XG5cbiAgICAgIGlmICghbVQpIHtcbiAgICAgICAgZmluYWxIYW5kbGVyTmFtZSA9IHRoaXMuX2dldEhhbmRsZXJOYW1lKHByZWZpeCwgdGhpcy5fbWFsZm9ybWVkU3VmZml4KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHBvdGVudGlhbEhhbmRsZXJOYW1lID0gdGhpcy5fZ2V0SGFuZGxlck5hbWUocHJlZml4LCBtVCk7XG4gICAgICAgIGlmIChfLmlzRnVuY3Rpb24odGhpcy5fZGVsZWdhdGVbcG90ZW50aWFsSGFuZGxlck5hbWVdKSkge1xuICAgICAgICAgIGZpbmFsSGFuZGxlck5hbWUgPSBwb3RlbnRpYWxIYW5kbGVyTmFtZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBmaW5hbEhhbmRsZXJOYW1lID0gdGhpcy5fZ2V0SGFuZGxlck5hbWUocHJlZml4LCB0aGlzLl9lbHNlU3VmZml4KTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoXy5pc0Z1bmN0aW9uKHRoaXMuX2RlbGVnYXRlW2ZpbmFsSGFuZGxlck5hbWVdKSkge1xuICAgICAgICByZXR1cm4gZmluYWxIYW5kbGVyTmFtZTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBEaXNwYXRjaGVyO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwibW9yaVwiKSxcbiAgcmVxdWlyZShcIi4vb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4vc3RhdGUtZ3VhcmRcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXG52YXIgbW9kID0gZnVuY3Rpb24gKFxuICBfXG4gICkge1xuXG4gIHZhciBDb3VudGRvd25MYXRjaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB9LFxuICAgICAgbm9vcCA9IGZ1bmN0aW9uKCkge307XG5cbiAgXy5leHRlbmQoQ291bnRkb3duTGF0Y2gucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24gKHN0ZXBzLCBjb21wbGV0aW9uQ2FsbGJhY2spIHtcbiAgICAgIHRoaXMuX3N0ZXBzID0gc3RlcHMgfHwgMDtcbiAgICAgIHRoaXMuX2NvbXBsZXRpb25DYWxsYmFjayA9IGNvbXBsZXRpb25DYWxsYmFjayB8fCBub29wO1xuICAgICAgXy5iaW5kQWxsKHRoaXMsIFwiX2NvbXBsZXRpb25DYWxsYmFja1wiLCBcIl90cmlnZ2VyQ29tcGxldGlvblwiKTtcbiAgICAgIGlmKGlzTmFOKHRoaXMuX3N0ZXBzKSB8fCB0aGlzLl9zdGVwcyA8IDApIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ291bnRkb3duTGF0Y2g6IE51bWJlciBvZiBzdGVwcyBhcmUgaW52YWxpZC5cIik7XG4gICAgICB9XG4gICAgICB0aGlzLl9jdXJyZW50ID0gMDtcbiAgICAgIHRoaXMuX2NvbXBsZXRlID0gZmFsc2U7XG4gICAgICB0aGlzLl9lcnJvciA9IG51bGw7XG4gICAgICBpZih0aGlzLl9zdGVwcyA9PT0gMCkge1xuICAgICAgICBfLmRlZmVyKHRoaXMuX3RyaWdnZXJDb21wbGV0aW9uKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH0sXG4gICAgc3RlcDogZnVuY3Rpb24gKHN0ZXBzKSB7XG4gICAgICBpZiAodGhpcy5fY29tcGxldGUgfHwgdGhpcy5fc3RlcHMgPT09IDApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy5fY3VycmVudCArPSBzdGVwcyB8fCAxO1xuICAgICAgaWYgKHRoaXMuX2N1cnJlbnQgPj0gdGhpcy5fc3RlcHMpIHtcbiAgICAgICAgdGhpcy5fdHJpZ2dlckNvbXBsZXRpb24oKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGVycm9yOiBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICBpZiAodGhpcy5fY29tcGxldGUgfHwgdGhpcy5fc3RlcHMgPT09IDApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy5fZXJyb3IgPSBlcnI7XG4gICAgICB0aGlzLl90cmlnZ2VyQ29tcGxldGlvbigpO1xuICAgIH0sXG4gICAgX3RyaWdnZXJDb21wbGV0aW9uOiBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAodGhpcy5fY29tcGxldGUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy5fY29tcGxldGUgPSB0cnVlO1xuICAgICAgaWYgKHRoaXMuX2Vycm9yKSB7XG4gICAgICAgIF8uZGVmZXIoXy5iaW5kKHRoaXMuX2NvbXBsZXRpb25DYWxsYmFjaywgbnVsbCwgdGhpcy5fZXJyb3IpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIF8uZGVmZXIodGhpcy5fY29tcGxldGlvbkNhbGxiYWNrKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBDb3VudGRvd25MYXRjaDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGZhY3RvcnkgPSBmdW5jdGlvbihcbiAgX1xuKSB7XG5cbiAgLyoqXG4gICAqXG4gICAqIEhlbHBlciBmb3IgZGVhbGluZyB3aXRoIGhhc2gtc3R5bGUgZnVuY3Rpb24gYXJndW1lbnRzLCB3aGljaCBjYW4gYmUgdXNlZnVsXG4gICAqIGluIG1ldGhvZHMgd2l0aCBvcHRpb25hbC9kZWZhdWx0IHZhbHVlcy5cbiAgICpcbiAgICogVXNhZ2U6XG4gICAqXG4gICAqICAgdmFyIGZvbyA9IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICogICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICpcbiAgICogICAgICAgdmFyIG9uZSA9IG9wdHMuZ2V0T3JFcnJvcihcIm9uZVwiKSxcbiAgICogICAgICAgICAgIHR3byA9IG9wdHMuZ2V0T3JFbHNlKFwidHdvXCIsIDIpLFxuICAgKiAgICAgICAgICAgdGhyZWUgPSBvcHRzLmdldE9yRWxzZUZuKFwidGhyZWVcIiwgZnVuY3Rpb24oKSB7XG4gICAqICAgICAgICAgICAgIHJldHVybiAzO1xuICAgKiAgICAgICAgICAgfSk7XG4gICAqXG4gICAqICAgICBjb25zb2xlLmxvZyhvbmUsIHR3bywgdGhyZWUpO1xuICAgKiAgIH07XG4gICAqXG4gICAqICAgZm9vKHsgb25lOiAxIH0pOyAvLyBsb2dzIFwiMSwgMiwgM1wiXG4gICAqICAgZm9vKCk7IC8vIHRocm93cyBFcnJvclxuICAgKiAgIGZvbyh7b25lOiAxLCB0d286IGZhbHNlLCB0aHJlZTogNH0pOyAvLyBsb2dzIFwiMSwgZmFsc2UsIDRcIlxuICAgKlxuICAgKi9cbiAgdmFyIE9wdGlvbnMgPSBmdW5jdGlvbihvcHRzKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH1cblxuICBfLmV4dGVuZChPcHRpb25zLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIHRoaXMuX3Byb3ZpZGVkT3B0cyA9IG9wdHMgfHwge307XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEF0dGVtcHRzIHRvIHJldHVybiB0aGUgdmFsdWUgZm9yIHRoZSByZXF1ZXN0ZWQgYGtleWAuIElmIHRoZSB2YWx1ZVxuICAgICAqIGlzIHVuZGVmaW5lZCBvciBudWxsLCBpbnN0ZWFkIHJldHVybnMgdGhlIHByb3ZpZGVkIGBmYWxsYmFja1ZhbHVlYC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBrZXkgKHJlcXVpcmVkKSBhdHRyaWJ1dGUgdG8gYmUgcmVhZFxuICAgICAqIEBwYXJhbSBmYWxsYmFja1ZhbHVlICByZXR1cm5lZCBpZiBga2V5YCBhdHRyaWJ1dGUgaXMgbnVsbCBvciB1bmRlZmluZWRcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHJlcXVlc3RlZCB2YWx1ZSBmb3IgYGtleWAsIG9yIGZhbGxiYWNrVmFsdWVgXG4gICAgICovXG4gICAgZ2V0T3JFbHNlOiBmdW5jdGlvbihrZXksIGRlZmF1bHRWYWx1ZSkge1xuICAgICAgaWYgKHRoaXMuX2lzVW5kZWZPck51bGwoa2V5KSkge1xuICAgICAgICByZXR1cm4gZGVmYXVsdFZhbHVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Byb3ZpZGVkT3B0c1trZXldO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBBdHRlbXB0cyB0byByZXR1cm4gdGhlIHZhbHVlIGZvciB0aGUgcmVxdWVzdGVkIGBrZXlgLiBJZiB0aGUgdmFsdWVcbiAgICAgKiBpcyB1bmRlZmluZWQgb3IgbnVsbCwgdGhyb3dzIGFuIGVycm9yLlxuICAgICAqXG4gICAgICogQHBhcmFtIGtleSAocmVxdWlyZWQpIGF0dHJpYnV0ZSB0byBiZSByZWFkXG4gICAgICogQHBhcmFtIGVyciAgICAgICAgICAgIG1lc3NhZ2UgcHJvdmlkZWQgdG8gRXJyb3IgY29uc3RydWN0b3IgaWYgYGtleWBcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgaXMgbnVsbCBvciBub3QgZGVmaW5lZFxuICAgICAqXG4gICAgICogQHJldHVybnMgdGhlIHZhbHVlIGZvciB0aGUgcmVxdWVzdGVkIGtleVxuICAgICAqL1xuICAgIGdldE9yRXJyb3I6IGZ1bmN0aW9uKGtleSwgZXJyb3JNc2cpIHtcbiAgICAgIGlmICh0aGlzLl9pc1VuZGVmT3JOdWxsKGtleSkpIHtcbiAgICAgICAgZXJyb3JNc2cgPSBlcnJvck1zZyB8fCBcIk9wdGlvbiByZXF1ZXN0ZWQgYnV0IG5vdCBmb3VuZDogYFwiK2tleStcImBcIjtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yTXNnKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMuX3Byb3ZpZGVkT3B0c1trZXldO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBBdHRlbXB0cyB0byByZXR1cm4gdGhlIHZhbHVlIGZvciB0aGUgcmVxdWVzdGVkIGBrZXlgLiBJZiB0aGUgdmFsdWVcbiAgICAgKiBpcyB1bmRlZmluZWQgb3IgbnVsbCwgaW5zdGVhZCBldmFsdWF0ZXMgYGZhbGxiYWNrVmFsdWVGbmAgYW5kIHJldHVybnNcbiAgICAgKiBpdHMgdmFsdWUuXG4gICAgICpcbiAgICAgKiBUaGlzIGlzIHVzZWZ1bCBmb3Igc2ltdWxhdGluZyBub24tc3RyaWN0IGV2YWx1YXRpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ga2V5IChyZXF1aXJlZCkgIGF0dHJpYnV0ZSB0byBiZSByZWFkXG4gICAgICogQHBhcmFtIGZhbGxiYWNrVmFsdWVGbiBldmFsdWF0ZWQgYW5kIHJldHVybiB2YWx1ZSByZXR1cm5lZCBpZiBga2V5YFxuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlIGlzIG51bGwgb3IgdW5kZWZpbmVkXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyByZXF1ZXN0ZWQgdmFsdWUgZm9yIGBrZXlgIG9yIHRoZSByZXR1cm4gdmFsdWUgb2YgZXZhbHVhdGVkXG4gICAgICogICAgICAgICAgYGZhbGxiYWNrVmFsdWVGbmBcbiAgICAgKi9cbiAgICBnZXRPckVsc2VGbjogZnVuY3Rpb24oa2V5LCBkZWZhdWx0VmFsdWVGbikge1xuICAgICAgaWYgKHR5cGVvZiBkZWZhdWx0VmFsdWVGbiAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIk9wdGlvbnMjZ2V0T3JFbHNlRm4gcmVxdWlyZXMgYSBkZWZhdWx0VmFsdWVGblwiKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuX2lzVW5kZWZPck51bGwoa2V5KSkge1xuICAgICAgICByZXR1cm4gZGVmYXVsdFZhbHVlRm4oKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wcm92aWRlZE9wdHNba2V5XTtcbiAgICAgIH1cbiAgICB9LFxuXG5cbiAgICB0b09iamVjdDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gXy5jbG9uZSh0aGlzLl9wcm92aWRlZE9wdHMpO1xuICAgIH0sXG5cbiAgICBzY29wZTogZnVuY3Rpb24ocHJlZml4KSB7XG4gICAgICByZXR1cm4gT3B0aW9ucy5mcm9tT2JqZWN0V2l0aFByZWZpeCh0aGlzLnRvT2JqZWN0KCksIHByZWZpeCk7XG4gICAgfSxcblxuICAgIF9pc1VuZGVmT3JOdWxsOiBmdW5jdGlvbihrZXkpIHtcbiAgICAgIHJldHVybiB0eXBlb2YgdGhpcy5fcHJvdmlkZWRPcHRzW2tleV0gPT09IFwidW5kZWZpbmVkXCIgfHwgdGhpcy5fcHJvdmlkZWRPcHRzW2tleV0gPT09IG51bGw7XG4gICAgfVxuICB9KTtcblxuICBfLmV4dGVuZChPcHRpb25zLCB7XG4gICAgZnJvbU9iamVjdDogZnVuY3Rpb24ob3B0cykge1xuICAgICAgcmV0dXJuIG5ldyBPcHRpb25zKG9wdHMpO1xuICAgIH0sXG5cblxuICAgIGZyb21PYmplY3RXaXRoUHJlZml4OiBmdW5jdGlvbihvcHRzLCBwcmVmaXgpIHtcbiAgICAgIG9wdHMgPSBfLnJlZHVjZShvcHRzLCBmdW5jdGlvbihtZW1vLCB2YWwsIGtleSkge1xuICAgICAgICB2YXIgcmVzdCwgbmV3S2V5O1xuICAgICAgICBpZiAoa2V5LmluZGV4T2YocHJlZml4KSA9PT0gMCkge1xuICAgICAgICAgIHJlc3QgPSBrZXkuc3Vic3RyKHByZWZpeC5sZW5ndGgpO1xuICAgICAgICAgIGlmIChyZXN0Lmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIG5ld0tleSA9IHJlc3QuY2hhckF0KDApLnRvTG93ZXJDYXNlKCkgKyByZXN0LnN1YnN0cigxKTtcbiAgICAgICAgICAgIG1lbW9bbmV3S2V5XSA9IHZhbDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG1lbW87XG4gICAgICB9LCB7fSk7XG5cbiAgICAgIHJldHVybiBuZXcgT3B0aW9ucyhvcHRzKTtcbiAgICB9XG4gIH0pXG5cbiAgcmV0dXJuIE9wdGlvbnM7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgZmFjdG9yeSA9IGZ1bmN0aW9uKFxuICBfLFxuICBQcm9taXNlLFxuICBPcHRpb25zXG4pIHtcblxuICB2YXIgTGFuZyA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKExhbmcucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oKXt9XG4gIH0pO1xuXG4gIF8uZXh0ZW5kKExhbmcsIHtcbiAgICBub29wOiBmdW5jdGlvbigpIHt9LFxuXG4gICAgcGFydGlhbGx5QXBwbHk6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGFyZ3MgPSBfLnRvQXJyYXkoYXJndW1lbnRzKSxcbiAgICAgICAgICBmdW4gID0gYXJncy5zaGlmdCgpO1xuXG4gICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBmdW4uYXBwbHkobnVsbCwgYXJncy5jb25jYXQoYXJndW1lbnRzKSk7XG4gICAgICB9O1xuICAgIH0sXG5cbiAgICBtYWtlRXJyb3JDbGFzczogZnVuY3Rpb24obmFtZSwgZGVmYXVsdE1lc3NhZ2UpIHtcbiAgICAgIGlmICghbmFtZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJtYWtlRXJyb3JDbGFzcyByZXF1aXJlcyBgbmFtZWBcIik7XG4gICAgICB9XG5cbiAgICAgIHZhciBrbGFzcyA9IGZ1bmN0aW9uKG1lc3NhZ2UpIHtcbiAgICAgICAgdGhpcy5uYW1lICAgID0gbmFtZTtcbiAgICAgICAgdGhpcy5tZXNzYWdlID0gdGhpcy5uYW1lICsgXCI6IFwiICsgKG1lc3NhZ2UgfHwgZGVmYXVsdE1lc3NhZ2UgfHwgXCJBbiB1bmV4cGVjdGVkIGVycm9yIG9jY3VycmVkXCIpO1xuXG4gICAgICAgIGlmIChFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSkge1xuICAgICAgICAgIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKHRoaXMsIGtsYXNzKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAga2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpO1xuICAgICAga2xhc3MucHJvdG90eXBlLmNvbnN0cnVjdG9yID0ga2xhc3M7XG4gICAgICByZXR1cm4ga2xhc3M7XG4gICAgfSxcblxuICAgIHBvam9DbGFzczogZnVuY3Rpb24oYXR0cmlidXRlcywgb3B0aW9ucykge1xuICAgICAgaWYgKCFfLmlzQXJyYXkoYXR0cmlidXRlcykpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTGFuZyNwb2pvQ2xhc3MgcmVxdWlyZXMgYXR0cmlidXRlcyBhcnJheVwiKTtcbiAgICAgIH1cblxuICAgICAgdmFyIG9wdGlvbnMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0aW9ucyksXG4gICAgICAgICAgLy8gb3B0aW9uYWwgc3BlY2lmaWVzIGtleXMgdGhhdCBhcmUgb3B0aW9uYWwsIHdpdGggdmFsdWVzIHRoYXQgYXJlIGRlZmF1bHQgaWYgbm90IHByb3ZpZGVkXG4gICAgICAgICAgZGVmYXVsdHMgPSBvcHRpb25zLmdldE9yRWxzZShcImRlZmF1bHRzXCIsIHt9KSxcbiAgICAgICAgICBvcHRpb25hbEF0dHJpYnV0ZXMgPSBfLmtleXMoZGVmYXVsdHMpO1xuXG4gICAgICB2YXIgdG9BdHRyaWJ1dGVOYW1lID0gZnVuY3Rpb24oYXR0cikge1xuICAgICAgICAgICAgcmV0dXJuIFwiX1wiICsgYXR0cjtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHRvR2V0dGVyID0gZnVuY3Rpb24oYXR0cikge1xuICAgICAgICAgICAgcmV0dXJuIGF0dHI7XG4gICAgICAgICAgfSxcbiAgICAgICAgICB0b1NldHRlciA9IGZ1bmN0aW9uKGF0dHIpIHtcbiAgICAgICAgICAgIHJldHVybiBcInNldFwiICsgYXR0ci5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGF0dHIuc3Vic3RyKDEpO1xuICAgICAgICAgIH07XG5cbiAgICAgIHZhciBrbGFzcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIH07XG5cbiAgICAgIF8uZXh0ZW5kKGtsYXNzLnByb3RvdHlwZSwge1xuICAgICAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgICAgICBfLmVhY2goYXR0cmlidXRlcywgZnVuY3Rpb24oYXR0cikge1xuICAgICAgICAgICAgaWYgKF8uY29udGFpbnMob3B0aW9uYWxBdHRyaWJ1dGVzLCBhdHRyKSkge1xuICAgICAgICAgICAgICB0aGlzW3RvQXR0cmlidXRlTmFtZShhdHRyKV0gPSBvcHRzLmdldE9yRWxzZShhdHRyLCBkZWZhdWx0c1thdHRyXSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB0aGlzW3RvQXR0cmlidXRlTmFtZShhdHRyKV0gPSBvcHRzLmdldE9yRXJyb3IoYXR0cik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSwgdGhpcyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBfLmVhY2goYXR0cmlidXRlcywgZnVuY3Rpb24oYXR0cikge1xuICAgICAgICBrbGFzcy5wcm90b3R5cGVbdG9HZXR0ZXIoYXR0cildID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXNbdG9BdHRyaWJ1dGVOYW1lKGF0dHIpXTtcbiAgICAgICAgfTtcbiAgICAgICAga2xhc3MucHJvdG90eXBlW3RvU2V0dGVyKGF0dHIpXSA9IGZ1bmN0aW9uKHYpIHtcbiAgICAgICAgICB0aGlzW3RvQXR0cmlidXRlTmFtZShhdHRyKV0gPSB2O1xuICAgICAgICB9O1xuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBrbGFzcztcbiAgICB9LFxuXG4gICAgZGVmZXJyZWQ6IGZ1bmN0aW9uKHByb21pc2VDbGFzcykge1xuICAgICAgcHJvbWlzZUNsYXNzID0gcHJvbWlzZUNsYXNzIHx8IFByb21pc2U7XG4gICAgICB2YXIgcmVzID0gbnVsbCwgcmVqID0gbnVsbDtcbiAgICAgIHZhciBwID0gbmV3IHByb21pc2VDbGFzcyhmdW5jdGlvbigpIHtcbiAgICAgICAgcmVzID0gYXJndW1lbnRzWzBdO1xuICAgICAgICByZWogPSBhcmd1bWVudHNbMV07XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcHJvbWlzZTogcCxcbiAgICAgICAgcmVzb2x2ZTogcmVzLFxuICAgICAgICByZWplY3Q6IHJlalxuICAgICAgfTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBMYW5nO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcImJsdWViaXJkXCIpLFxuICByZXF1aXJlKFwiLi9vcHRpb25zXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFByb21pc2Vcbikge1xuXG4gIC8qKlxuICAgKiBBIFN0YXRlR3VhcmQgZG9lcyB3aGF0IGl0cyBuYW1lIGltcGxpZXMuIFZhbGlkIHN0YXRlcyBhcmUgcHJvdmlkZWQgZHVyaW5nIGluc3RhbnRpYXRpb24sIGFuZCBhcmUgYXBwbGllZCwgZW5zdXJlZCxcbiAgICogZGVuaWVkLCBldGMsIHRocm91Z2ggdGhlIGNvdXJzZSBvZiB0aGUgb3duZXIncyBsaWZldGltZS5cbiAgICpcbiAgICogRm9yIGV4YW1wbGUsIGlmIHlvdSdkIGxpa2UgdG8gZW5zdXJlIHRoYXQgRm9vI2JhciByYWlzZXMgYW4gZXJyb3IgYWZ0ZXIgRm9vI2Rpc3Bvc2UgaXMgY2FsbGVkLCB5b3UgbWlnaHQgZG8gdGhlXG4gICAqIGZvbGxvd2luZzpcbiAgICpcbiAgICogICB2YXIgRm9vID0gZnVuY3Rpb24oKSB7XG4gICAqICAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICogICB9O1xuICAgKlxuICAgKiAgIF8uZXh0ZW5kKEZvby5wcm90b3R5cGUsIHtcbiAgICogICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKCkge1xuICAgKiAgICAgICB0aGlzLl9leHBlbnNpdmVSZXNvdXJjZSA9IG5ldyBFeHBlbnNpdmVSZXNvdXJjZSgpO1xuICAgKiAgICAgICB0aGlzLl9zdGF0ZUd1YXJkID0gbmV3IFN0YXRlR3VhcmQoW1wiZGlzcG9zZWRcIl0pO1xuICAgKiAgICAgfSxcbiAgICogICAgIGRpc3Bvc2U6IGZ1bmN0aW9uKCkge1xuICAgKiAgICAgICAvLyAjZGlzcG9zZSBzaG91bGQgYmUgaWRlbXBvdGVudCwgc28gaGVyZSB3ZSBqdXN0IGNoZWNrIHRvIHNlZSBpZiB3ZSd2ZSBhbHJlYWR5IGRpc3Bvc2VkLCBhbmQgcmV0dXJuLlxuICAgKiAgICAgICAvLyBOb3RlIHRoYXQgaWYgZGlzcG9zZSB3ZXJlIGFzeW5jLCB3ZSdkIG5lZWQgdG8gYWRkIGEgXCJkaXNwb3NpbmdcIiBzdGF0ZS5cbiAgICogICAgICAgaWYgKHRoaXMuX3N0YXRlR3VhcmQuYXBwbGllZChcImRpc3Bvc2VkXCIpKSB7XG4gICAqICAgICAgICAgcmV0dXJuO1xuICAgKiAgICAgICB9XG4gICAqXG4gICAqICAgICAgIGlmICh0aGlzLl9leHBlbnNpdmVSZXNvdXJjZSkge1xuICAgKiAgICAgICAgIHRoaXMuX2V4cGVuc2l2ZVJlc291cmNlLmRpc3Bvc2UoKTtcbiAgICogICAgICAgICB0aGlzLl9leHBlbnNpdmVSZXNvdXJjZSA9IG51bGw7XG4gICAqICAgICAgIH1cbiAgICogICAgICAgdGhpcy5fc3RhdGVHdWFyZC5hcHBseShcImRpc3Bvc2VkXCIpO1xuICAgKiAgICAgfSxcbiAgICogICAgIGJhcjogZnVuY3Rpb24oKSB7XG4gICAqICAgICAgIHRoaXMuX3N0YXRlR3VhcmQuZGVueShcImRpc3Bvc2VkXCIpOyAvLyBUaHJvd3MgZXhjZXB0aW9uIGlmICNkaXNwb3NlIHdhcyBjYWxsZWRcbiAgICpcbiAgICogICAgICAgcmV0dXJuIHRoaXMuX2V4cGVuc2l2ZVJlc291cmNlLnNvbWVNZXRob2QoKTtcbiAgICogICAgIH1cbiAgICogICB9KTtcbiAgICpcbiAgICogSW4gdGhpcyBjYXNlLCB3aGVyZSB3ZSBoYXZlIG9ubHkgb25lIHN0YXRlLCBpdCdzIHVzZWZ1bCB0byBzaW1wbHkgY3JlYXRlIGEgc2NvcGVkIFN0YXRlR3VhcmQsIHdoaWNoIGJlaGF2ZXNcbiAgICogaWRlbnRpY2FsbHkgdG8gYSByZWd1bGFyIG9uZSwgZXhjZXB0IGV2ZXJ5IGVuZm9yY2VtZW50L3F1ZXJ5IG1ldGhvZCBoYXMgdGhlIHNjb3BlIHByb3ZpZGVkIGR1cmluZyBpbnN0YW50aWF0aW9uXG4gICAqIGFzIGEgZmlyc3QsIGltcGxpY2l0IGFyZ3VtZW50OlxuICAgKlxuICAgKiAgIC8vIElkZW50aWNhbCB0byBwcmV2aW91cyB2ZXJzaW9uLlxuICAgKlxuICAgKiAgIHZhciBGb28gPSBmdW5jdGlvbigpIHtcbiAgICogICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgKiAgIH07XG4gICAqXG4gICAqICAgXy5leHRlbmQoRm9vLnByb3RvdHlwZSwge1xuICAgKiAgICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7XG4gICAqICAgICAgIHRoaXMuX2V4cGVuc2l2ZVJlc291cmNlID0gbmV3IEV4cGVuc2l2ZVJlc291cmNlKCk7XG4gICAqICAgICAgIHRoaXMuX3N0YXRlR3VhcmQgPSBTdGF0ZUd1YXJkLnNjb3BlZChcImRpc3Bvc2VkXCIpO1xuICAgKiAgICAgfSxcbiAgICogICAgIGRpc3Bvc2U6IGZ1bmN0aW9uKCkge1xuICAgKiAgICAgICAvLyAjZGlzcG9zZSBzaG91bGQgYmUgaWRlbXBvdGVudCwgc28gaGVyZSB3ZSBqdXN0IGNoZWNrIHRvIHNlZSBpZiB3ZSd2ZSBhbHJlYWR5IGRpc3Bvc2VkLCBhbmQgcmV0dXJuLlxuICAgKiAgICAgICAvLyBOb3RlIHRoYXQgaWYgZGlzcG9zZSB3ZXJlIGFzeW5jLCB3ZSdkIG5lZWQgdG8gYWRkIGEgXCJkaXNwb3NpbmdcIiBzdGF0ZS5cbiAgICogICAgICAgaWYgKHRoaXMuX3N0YXRlR3VhcmQuYXBwbGllZCgpKSB7XG4gICAqICAgICAgICAgcmV0dXJuO1xuICAgKiAgICAgICB9XG4gICAqXG4gICAqICAgICAgIGlmICh0aGlzLl9leHBlbnNpdmVSZXNvdXJjZSkge1xuICAgKiAgICAgICAgIHRoaXMuX2V4cGVuc2l2ZVJlc291cmNlLmRpc3Bvc2UoKTtcbiAgICogICAgICAgICB0aGlzLl9leHBlbnNpdmVSZXNvdXJjZSA9IG51bGw7XG4gICAqICAgICAgIH1cbiAgICogICAgICAgdGhpcy5fc3RhdGVHdWFyZC5hcHBseSgpO1xuICAgKiAgICAgfSxcbiAgICogICAgIGJhcjogZnVuY3Rpb24oKSB7XG4gICAqICAgICAgIHRoaXMuX3N0YXRlR3VhcmQuZGVueSgpOyAvLyBUaHJvd3MgZXhjZXB0aW9uIGlmICNkaXNwb3NlIHdhcyBjYWxsZWRcbiAgICpcbiAgICogICAgICAgcmV0dXJuIHRoaXMuX2V4cGVuc2l2ZVJlc291cmNlLnNvbWVNZXRob2QoKTtcbiAgICogICAgIH1cbiAgICogICB9KTtcbiAgICpcbiAgICovXG4gIHZhciBTdGF0ZUd1YXJkID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoU3RhdGVHdWFyZC5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihzdGF0ZXMpIHtcbiAgICAgIHRoaXMuX3ZhbGlkU3RhdGVzID0gXy5yZWR1Y2Uoc3RhdGVzLCBmdW5jdGlvbihtZW1vLCBzdGF0ZSkge1xuICAgICAgICBtZW1vW3N0YXRlXSA9IHRydWU7XG4gICAgICAgIHJldHVybiBtZW1vO1xuICAgICAgfSwge30pO1xuXG4gICAgICB0aGlzLl9hcHBsaWVkU3RhdGVzID0ge307XG4gICAgfSxcblxuICAgIHNjb3BlOiBmdW5jdGlvbihzdGF0ZSkge1xuICAgICAgdmFyIHNraXAgPSBbXCJzY29wZVwiLCBcImluaXRpYWxpemVcIl0sXG4gICAgICAgICAgc2VsZiA9IHRoaXMsXG4gICAgICAgICAgc2NvcGVkID0ge307XG5cbiAgICAgIF8uZWFjaChTdGF0ZUd1YXJkLnByb3RvdHlwZSwgZnVuY3Rpb24oZnVuLCBtZXRob2ROYW1lKSB7XG4gICAgICAgIGlmIChfLmNvbnRhaW5zKHNraXAsIG1ldGhvZE5hbWUpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgc2NvcGVkW21ldGhvZE5hbWVdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyIGFyZ3MgPSBfLnRvQXJyYXkoYXJndW1lbnRzKTtcbiAgICAgICAgICBhcmdzLnVuc2hpZnQoc3RhdGUpO1xuICAgICAgICAgIHJldHVybiBmdW4uYXBwbHkoc2VsZiwgYXJncyk7XG4gICAgICAgIH07XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIHNjb3BlZDtcbiAgICB9LFxuXG4gICAgYXBwbHk6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHN0YXRlcyA9IGFyeU9yVmFyaWFkaWNUb0FycmF5KGFyZ3VtZW50cyk7XG4gICAgICBjaGVja1ZhbGlkU3RhdGVzT3JUaHJvdyh0aGlzLl92YWxpZFN0YXRlcywgc3RhdGVzKTtcblxuICAgICAgXy5lYWNoKHN0YXRlcywgZnVuY3Rpb24oc3RhdGUpIHtcbiAgICAgICAgdGhpcy5fYXBwbGllZFN0YXRlc1tzdGF0ZV0gPSB0cnVlO1xuICAgICAgfSwgdGhpcyk7XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbiAgICBhcHBseUFzeW5jOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLmFwcGx5LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfSksXG5cbiAgICBhcHBseUFzeW5jRm46IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICByZXR1cm4gXy5iaW5kKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBseUFzeW5jLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgICAgfSwgdGhpcyk7XG4gICAgfSxcblxuICAgIHVuYXBwbHk6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHN0YXRlcyA9IGFyeU9yVmFyaWFkaWNUb0FycmF5KGFyZ3VtZW50cyk7XG4gICAgICBjaGVja1ZhbGlkU3RhdGVzT3JUaHJvdyh0aGlzLl92YWxpZFN0YXRlcywgc3RhdGVzKTtcblxuICAgICAgXy5lYWNoKHN0YXRlcywgZnVuY3Rpb24oc3RhdGUpIHtcbiAgICAgICAgaWYgKHRoaXMuX2FwcGxpZWRTdGF0ZXNbc3RhdGVdKSB7XG4gICAgICAgICAgZGVsZXRlIHRoaXMuX2FwcGxpZWRTdGF0ZXNbc3RhdGVdO1xuICAgICAgICB9XG4gICAgICB9LCB0aGlzKTtcblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcblxuICAgIHVuYXBwbHlBc3luYzogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy51bmFwcGx5LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfSksXG5cbiAgICB1bmFwcGx5QXN5bmNGbjogZnVuY3Rpb24oc3RhdGVzKSB7XG4gICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgIHJldHVybiBfLmJpbmQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnVuYXBwbHlBc3luYy5hcHBseSh0aGlzLCBhcmdzKVxuICAgICAgfSwgdGhpcyk7XG4gICAgfSxcblxuICAgIGRlbnk6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHN0YXRlcyA9IGFyeU9yVmFyaWFkaWNUb0FycmF5KGFyZ3VtZW50cyk7XG4gICAgICBjaGVja1ZhbGlkU3RhdGVzT3JUaHJvdyh0aGlzLl92YWxpZFN0YXRlcywgc3RhdGVzKTtcblxuICAgICAgdmFyIGFwcGxpZWQgPSBfLmZpbHRlcihzdGF0ZXMsIGZ1bmN0aW9uKHN0YXRlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hcHBsaWVkU3RhdGVzW3N0YXRlXTtcbiAgICAgIH0sIHRoaXMpO1xuXG4gICAgICBpZiAoYXBwbGllZC5sZW5ndGggPiAwKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlN0YXRlIGRlbmlhbCByZXF1ZXN0ZWQsIGJ1dCBhcHBsaWVkOiBcIiArIHByZXR0eShhcHBsaWVkKSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbiAgICBkZW55QXN5bmM6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuZGVueS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH0pLFxuXG4gICAgZGVueUFzeW5jRm46IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICByZXR1cm4gXy5iaW5kKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kZW55QXN5bmMuYXBwbHkodGhpcywgYXJncylcbiAgICAgIH0sIHRoaXMpO1xuICAgIH0sXG5cbiAgICBlbnN1cmU6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHN0YXRlcyA9IGFyeU9yVmFyaWFkaWNUb0FycmF5KGFyZ3VtZW50cyk7XG4gICAgICBjaGVja1ZhbGlkU3RhdGVzT3JUaHJvdyh0aGlzLl92YWxpZFN0YXRlcywgc3RhdGVzKTtcbiAgICAgIHZhciBtaXNzaW5nID0gXy5yZWplY3Qoc3RhdGVzLCBmdW5jdGlvbihzdGF0ZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYXBwbGllZFN0YXRlc1tzdGF0ZV07XG4gICAgICB9LCB0aGlzKTtcblxuICAgICAgaWYgKG1pc3NpbmcubGVuZ3RoID4gMCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJTdGF0ZSBlbnN1cmFuY2UgcmVxdWVzdGVkLCBidXQgbm90IGFwcGxpZWQ6IFwiICsgcHJldHR5KG1pc3NpbmcpKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbiAgICBlbnN1cmVBc3luYzogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5lbnN1cmUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9KSxcblxuICAgIGVuc3VyZUFzeW5jRm46IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICByZXR1cm4gXy5iaW5kKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5lbnN1cmVBc3luYy5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICAgIH0sIHRoaXMpO1xuICAgIH0sXG5cbiAgICBhcHBsaWVkOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBzdGF0ZXMgPSBhcnlPclZhcmlhZGljVG9BcnJheShhcmd1bWVudHMpO1xuICAgICAgY2hlY2tWYWxpZFN0YXRlc09yVGhyb3codGhpcy5fdmFsaWRTdGF0ZXMsIHN0YXRlcyk7XG5cbiAgICAgIHJldHVybiBfLmV2ZXJ5KHN0YXRlcywgZnVuY3Rpb24oc3RhdGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FwcGxpZWRTdGF0ZXNbc3RhdGVdO1xuICAgICAgfSwgdGhpcyk7XG4gICAgfSxcblxuICAgIGFwcGxpZWRBc3luYzogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5hcHBsaWVkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfSksXG5cbiAgICBhcHBsaWVkQXN5bmNGbjogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgIHJldHVybiBfLmJpbmQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcGxpZWRBc3luYy5hcHBseSh0aGlzLCBhcmdzKVxuICAgICAgfSwgdGhpcyk7XG4gICAgfVxuICB9KTtcblxuICB2YXIgYXJ5T3JWYXJpYWRpY1RvQXJyYXkgPSBmdW5jdGlvbihhcmdzKSB7XG4gICAgcmV0dXJuIF8uY2hhaW4oYXJncykudG9BcnJheSgpLmZsYXR0ZW4oKS52YWx1ZSgpO1xuICB9O1xuXG4gIHZhciBjaGVja1ZhbGlkU3RhdGVzT3JUaHJvdyA9IGZ1bmN0aW9uKHZhbGlkU3RhdGVzTWFwLCBzdGF0ZXMpIHtcbiAgICB2YXIgaW52YWxpZFN0YXRlcyA9IF8ucmVqZWN0KHN0YXRlcywgZnVuY3Rpb24oc3RhdGUpIHtcbiAgICAgIHJldHVybiAhIXZhbGlkU3RhdGVzTWFwW3N0YXRlXTtcbiAgICB9KTtcblxuICAgIGlmIChpbnZhbGlkU3RhdGVzLmxlbmd0aCA+IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgc3RhdGVzIHByb3ZpZGVkOiBcIiArIHByZXR0eShpbnZhbGlkU3RhdGVzKSk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBwcmV0dHkgPSBmdW5jdGlvbihzdGF0ZXMpIHtcbiAgICByZXR1cm4gXCJbXCIrc3RhdGVzLmpvaW4oXCIsXCIpK1wiXVwiO1xuICB9O1xuXG4gIF8uZXh0ZW5kKFN0YXRlR3VhcmQsIHtcbiAgICBzY29wZWQ6IGZ1bmN0aW9uKHNjb3BlKSB7XG4gICAgICByZXR1cm4gKG5ldyBTdGF0ZUd1YXJkKFtzY29wZV0pKS5zY29wZShzY29wZSk7XG4gICAgfVxuICB9KVxuXG4gIHJldHVybiBTdGF0ZUd1YXJkO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiYmx1ZWJpcmRcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgX1xuKSB7XG5cbiAgdmFyIFB1YlN1YiA9IHtcbiAgICBvbjogZnVuY3Rpb24oZXZlbnROYW1lLCBoYW5kbGVyLCBjb250ZXh0KSB7XG4gICAgICB2YXIgYnVja2V0ID0gdGhpcy5fX3B1YlN1YkJ1Y2tldChldmVudE5hbWUpO1xuICAgICAgYnVja2V0LnN1YnNjcmliZShoYW5kbGVyLCBjb250ZXh0KTtcbiAgICB9LFxuICAgIG9mZjogZnVuY3Rpb24oZXZlbnROYW1lLCBoYW5kbGVyLCBjb250ZXh0KSB7XG4gICAgICB2YXIgYnVja2V0ID0gdGhpcy5fX3B1YlN1YkJ1Y2tldChldmVudE5hbWUpO1xuICAgICAgYnVja2V0LnVuc3Vic2NyaWJlKGhhbmRsZXIsIGNvbnRleHQpO1xuICAgIH0sXG4gICAgbm90aWZ5OiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBhcmdzICAgICAgPSBfLnRvQXJyYXkoYXJndW1lbnRzKSxcbiAgICAgICAgICBldmVudE5hbWUgPSBhcmdzLnNoaWZ0KCk7XG5cbiAgICAgIHZhciBidWNrZXQgPSB0aGlzLl9fcHViU3ViQnVja2V0KGV2ZW50TmFtZSk7XG4gICAgICBidWNrZXQubm90aWZ5KGFyZ3MpO1xuICAgIH0sXG4gICAgX19wdWJTdWJCdWNrZXQ6IGZ1bmN0aW9uKGV2ZW50TmFtZSkge1xuICAgICAgdGhpcy5fX3B1YlN1YkV2ZW50cyA9IHRoaXMuX19wdWJTdWJFdmVudHMgfHwge307XG4gICAgICB0aGlzLl9fcHViU3ViRXZlbnRzW2V2ZW50TmFtZV0gPSB0aGlzLl9fcHViU3ViRXZlbnRzW2V2ZW50TmFtZV0gfHwgbmV3IEV2ZW50QnVja2V0KGV2ZW50TmFtZSk7XG4gICAgICByZXR1cm4gdGhpcy5fX3B1YlN1YkV2ZW50c1tldmVudE5hbWVdO1xuICAgIH1cbiAgfTtcblxuICB2YXIgRXZlbnRCdWNrZXQgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChFdmVudEJ1Y2tldC5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihldmVudE5hbWUpIHtcbiAgICAgIHRoaXMuX2V2ZW50TmFtZSA9IGV2ZW50TmFtZTtcbiAgICAgIHRoaXMuX3N1YnNjcmlwdGlvbnMgPSBbXTtcbiAgICB9LFxuICAgIHN1YnNjcmliZTogZnVuY3Rpb24oaGFuZGxlciwgY29udGV4dCkge1xuICAgICAgaWYgKGhhbmRsZXIpIHtcbiAgICAgICAgdGhpcy5fc3Vic2NyaXB0aW9ucy5wdXNoKG5ldyBTdWJzY3JpcHRpb24oaGFuZGxlciwgY29udGV4dCkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiU3Vic2NyaXB0aW9uIHJlcXVpcmVzIGhhbmRsZXI6IFwiICsgdGhpcy5fZXZlbnROYW1lKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIHVuc3Vic2NyaWJlOiBmdW5jdGlvbihoYW5kbGVyLCBjb250ZXh0KSB7XG4gICAgICB2YXIgc3VicztcbiAgICAgIGlmIChoYW5kbGVyKSB7XG4gICAgICAgIHN1YnMgPSBfLmZpbHRlcih0aGlzLl9zdWJzY3JpcHRpb25zLCBmdW5jdGlvbihzdWIpIHtcbiAgICAgICAgICByZXR1cm4gc3ViLm1hdGNoZXMoaGFuZGxlciwgY29udGV4dCk7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc3VicyA9IHRoaXMuX3N1YnNjcmlwdGlvbnM7XG4gICAgICB9XG5cbiAgICAgIF8uZWFjaChzdWJzLCBmdW5jdGlvbihzdWIpIHtcbiAgICAgICAgc3ViLmRpc3Bvc2UoKTtcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLl9zdWJzY3JpcHRpb25zID0gXy5kaWZmZXJlbmNlKHRoaXMuX3N1YnNjcmlwdGlvbnMsIHN1YnMpO1xuICAgIH0sXG4gICAgbm90aWZ5OiBmdW5jdGlvbihhcmdzKSB7XG4gICAgICBfLmludm9rZSh0aGlzLl9zdWJzY3JpcHRpb25zLCBcIm5vdGlmeVwiLCBhcmdzKTtcbiAgICB9XG4gIH0pO1xuXG4gIHZhciBTdWJzY3JpcHRpb24gPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChTdWJzY3JpcHRpb24ucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oaGFuZGxlciwgY29udGV4dCkge1xuICAgICAgdGhpcy5faGFuZGxlciA9IGhhbmRsZXI7XG4gICAgICB0aGlzLl9jb250ZXh0ID0gY29udGV4dDtcbiAgICB9LFxuICAgIG1hdGNoZXM6IGZ1bmN0aW9uKGhhbmRsZXIsIGNvbnRleHQpIHtcbiAgICAgIGlmICh0aGlzLl9jb250ZXh0KSB7XG4gICAgICAgIC8vIENvbXBhcmUgY29udGV4dCByZWZzIGFzIHJlZnMgaWZmIHdlIGhhdmUgYSBjb250ZXh0IG9iamVjdFxuICAgICAgICByZXR1cm4gKGhhbmRsZXIgPT09IHRoaXMuX2hhbmRsZXIgJiYgY29udGV4dCA9PT0gdGhpcy5fY29udGV4dCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBPdGhlcndpc2UsIGp1c3QgbWFrZSBzdXJlIHdlIGRvbid0IGhhdmUgYSBjb250ZXh0IChudWxsIG9yIHVuZGVmaW5lZCBhcmUgZmluZSlcbiAgICAgICAgcmV0dXJuIChoYW5kbGVyID09PSB0aGlzLl9oYW5kbGVyICYmICFjb250ZXh0KTtcbiAgICAgIH1cbiAgICB9LFxuICAgIG5vdGlmeTogZnVuY3Rpb24oYXJncykge1xuICAgICAgLy8gV2Ugc2hvdWxkbid0IGJlIGNhbGxlZCBhZnRlciBkaXNwb3NlLCBidXRcbiAgICAgIC8vIGp1c3QgaW4gY2FzZS4uLlxuICAgICAgaWYgKHRoaXMuX2hhbmRsZXIpIHtcbiAgICAgICAgdGhpcy5faGFuZGxlci5hcHBseSh0aGlzLl9jb250ZXh0LCBhcmdzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiV1RGXCIpO1xuICAgICAgfVxuICAgIH0sXG4gICAgZGlzcG9zZTogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9oYW5kbGVyID0gbnVsbDtcbiAgICAgIHRoaXMuX2NvbnRleHQgPSBudWxsO1xuICAgIH1cbiAgfSlcblxuICByZXR1cm4gUHViU3ViO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIE9wdGlvbnNcbikge1xuXG4gIHZhciBEb3VibHlMaW5rZWRMaXN0ID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoRG91Ymx5TGlua2VkTGlzdC5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX2Zyb250ID0gbnVsbDtcbiAgICAgIHRoaXMuX2JhY2sgPSBudWxsO1xuICAgICAgdGhpcy5fc2l6ZSA9IDA7XG4gICAgfSxcblxuICAgIGdldDogZnVuY3Rpb24oaWR4KSB7XG4gICAgICB0aGlzLl9jaGVja0VsZW1lbnRJZHhPclRocm93KGlkeCk7XG4gICAgICB2YXIgbm9kZSA9IHRoaXMuX3dhbGtUb0lkeChpZHgpO1xuICAgICAgcmV0dXJuIG5vZGUudmFsdWUoKTtcbiAgICB9LFxuXG4gICAgZXhpc3RzOiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgdmFyIG5vZGUgPSB0aGlzLl93YWxrVG9WYWx1ZSh2YWx1ZSk7XG4gICAgICByZXR1cm4gISFub2RlO1xuICAgIH0sXG5cbiAgICBzaXplOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zaXplO1xuICAgIH0sXG5cbiAgICBhZGQ6IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICByZXR1cm4gdGhpcy5hZGRCYWNrLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfSxcblxuICAgIGFkZEZyb250OiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgdGhpcy5fbGlua0Zyb250KHZhbHVlKTtcbiAgICB9LFxuXG4gICAgYWRkQmFjazogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHRoaXMuX2xpbmtCYWNrKHZhbHVlKTtcbiAgICB9LFxuXG4gICAgcmVtb3ZlOiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgdmFyIG5vZGUgPSB0aGlzLl93YWxrVG9WYWx1ZSh2YWx1ZSk7XG4gICAgICByZXR1cm4gdGhpcy5fdW5saW5rKG5vZGUpO1xuICAgIH0sXG5cbiAgICByZW1vdmVGcm9udDogZnVuY3Rpb24oKSB7XG4gICAgICBpZiAodGhpcy5fZnJvbnQgPT09IG51bGwpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gc3VjaCBlbGVtZW50XCIpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMuX3VubGlua0Zyb250KHRoaXMuX2Zyb250KTtcbiAgICB9LFxuXG4gICAgcmVtb3ZlQmFjazogZnVuY3Rpb24oKSB7XG4gICAgICBpZiAodGhpcy5fYmFjayA9PT0gbnVsbCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyBzdWNoIGVsZW1lbnRcIik7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcy5fdW5saW5rQmFjayh0aGlzLl9iYWNrKTtcbiAgICB9LFxuXG4gICAgaW5zZXJ0QXRJbmRleDogZnVuY3Rpb24oaWR4LCB2YWx1ZSkge1xuICAgICAgdGhpcy5fY2hlY2tJc0VsZW1lbnRQb3NpdGlvbk9yVGhyb3coaWR4KTtcblxuICAgICAgaWYgKGlkeCA9PT0gdGhpcy5fc2l6ZSkge1xuICAgICAgICB0aGlzLmFkZEJhY2sodmFsdWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIG5vZGUgPSB0aGlzLl93YWxrVG9JZHgoaWR4KTtcbiAgICAgICAgdGhpcy5fbGlua0JlZm9yZSh2YWx1ZSwgbm9kZSk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIHJlbW92ZUF0SW5kZXg6IGZ1bmN0aW9uKGlkeCkge1xuICAgICAgdGhpcy5fY2hlY2tFbGVtZW50SWR4T3JUaHJvdyhpZHgpO1xuICAgICAgaWYgKGlkeCA9PT0gMCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdW5saW5rRnJvbnQodGhpcy5fZnJvbnQpO1xuICAgICAgfSBlbHNlIGlmICggaWR4ID09PSAodGhpcy5fc2l6ZSAtIDEpICkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdW5saW5rQmFjayh0aGlzLl9iYWNrKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBub2RlID0gdGhpcy5fd2Fsa1RvSWR4KGlkeCk7XG4gICAgICAgIHJldHVybiB0aGlzLl91bmxpbmsobm9kZSk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIGNsZWFyOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBub2RlID0gdGhpcy5fZnJvbnQsXG4gICAgICAgICAgbmV4dDtcblxuICAgICAgd2hpbGUgKG5vZGUgIT09IG51bGwpIHtcbiAgICAgICAgbmV4dCA9IG5vZGUubmV4dCgpO1xuICAgICAgICBub2RlLmRpc3Bvc2UoKTtcbiAgICAgICAgbm9kZSA9IG5leHQ7XG4gICAgICB9XG4gICAgICB0aGlzLl9mcm9udCA9IG51bGw7XG4gICAgICB0aGlzLl9iYWNrICA9IG51bGw7XG4gICAgICB0aGlzLl9zaXplID0gMDtcbiAgICB9LFxuXG4gICAgX2xpbmtGcm9udDogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHZhciBvbGRGcm9udCA9IHRoaXMuX2Zyb250LFxuICAgICAgICAgIG5ld05vZGUgPSBuZXcgTm9kZSh7dmFsdWU6IHZhbHVlfSk7XG4gICAgICB0aGlzLl9mcm9udCA9IG5ld05vZGU7XG5cbiAgICAgIGlmIChvbGRGcm9udCA9PT0gbnVsbCkge1xuICAgICAgICB0aGlzLl9iYWNrID0gbmV3Tm9kZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG9sZEZyb250LnNldFByZXYobmV3Tm9kZSk7XG4gICAgICAgIG5ld05vZGUuc2V0TmV4dChvbGRGcm9udCk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuX3NpemUrKztcbiAgICAgIHJldHVybiBuZXdOb2RlO1xuICAgIH0sXG5cbiAgICBfbGlua0JhY2s6IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICB2YXIgb2xkQmFjayA9IHRoaXMuX2JhY2ssXG4gICAgICAgICAgbmV3Tm9kZSA9IG5ldyBOb2RlKHt2YWx1ZTogdmFsdWV9KTtcblxuICAgICAgdGhpcy5fYmFjayA9IG5ld05vZGU7XG4gICAgICBpZiAob2xkQmFjayA9PT0gbnVsbCkge1xuICAgICAgICB0aGlzLl9mcm9udCA9IG5ld05vZGU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBvbGRCYWNrLnNldE5leHQobmV3Tm9kZSk7XG4gICAgICAgIG5ld05vZGUuc2V0UHJldihvbGRCYWNrKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5fc2l6ZSsrO1xuICAgICAgcmV0dXJuIG5ld05vZGU7XG4gICAgfSxcblxuICAgIF9saW5rQmVmb3JlOiBmdW5jdGlvbih2YWx1ZSwgbm9kZSkge1xuICAgICAgdmFyIHByZWQgICAgPSBub2RlLnByZXYoKSxcbiAgICAgICAgICBuZXdOb2RlID0gbmV3IE5vZGUoe3ZhbHVlOiB2YWx1ZSwgcHJldjogcHJlZCwgbmV4dDogbm9kZX0pO1xuXG4gICAgICBub2RlLnNldFByZXYobmV3Tm9kZSk7XG4gICAgICBpZiAocHJlZCA9PT0gbnVsbCkge1xuICAgICAgICB0aGlzLl9mcm9udCA9IG5ld05vZGU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwcmVkLnNldE5leHQobmV3Tm9kZSk7XG4gICAgICB9XG4gICAgICB0aGlzLl9zaXplKys7XG4gICAgICByZXR1cm4gbmV3Tm9kZTtcbiAgICB9LFxuXG4gICAgX3VubGlua0Zyb250OiBmdW5jdGlvbihub2RlKSB7XG4gICAgICB2YXIgdmFsdWUgICAgPSBub2RlLnZhbHVlKCksXG4gICAgICAgICAgbmV3RnJvbnQgPSBub2RlLm5leHQoKTtcblxuICAgICAgbm9kZS5kaXNwb3NlKCk7XG4gICAgICB0aGlzLl9mcm9udCA9IG5ld0Zyb250O1xuICAgICAgaWYgKG5ld0Zyb250ID09PSBudWxsKSB7XG4gICAgICAgIHRoaXMuX2JhY2sgPSBudWxsO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbmV3RnJvbnQuc2V0UHJldihudWxsKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuX3NpemUtLTtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuXG4gICAgX3VubGlua0JhY2s6IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgIHZhciB2YWx1ZSAgID0gbm9kZS52YWx1ZSgpLFxuICAgICAgICAgIG5ld0JhY2sgPSBub2RlLnByZXYoKTtcblxuICAgICAgbm9kZS5kaXNwb3NlKCk7XG4gICAgICB0aGlzLl9iYWNrID0gbmV3QmFjaztcbiAgICAgIGlmIChuZXdCYWNrID09IG51bGwpIHtcbiAgICAgICAgdGhpcy5fZnJvbnQgPSBudWxsO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbmV3QmFjay5zZXROZXh0KG51bGwpO1xuICAgICAgfVxuICAgICAgdGhpcy5fc2l6ZS0tO1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG5cbiAgICBfdW5saW5rOiBmdW5jdGlvbihub2RlKSB7XG4gICAgICB2YXIgcHJldiAgPSBub2RlLnByZXYoKSxcbiAgICAgICAgICBuZXh0ICA9IG5vZGUubmV4dCgpLFxuICAgICAgICAgIHZhbHVlID0gbm9kZS52YWx1ZSgpO1xuXG4gICAgICBpZiAocHJldiA9PT0gbnVsbCkge1xuICAgICAgICB0aGlzLl9mcm9udCA9IG5leHQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwcmV2LnNldE5leHQobmV4dCk7XG4gICAgICB9XG5cbiAgICAgIGlmIChuZXh0ID09PSBudWxsKSB7XG4gICAgICAgIHRoaXMuX2JhY2sgPSBwcmV2O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbmV4dC5zZXRQcmV2KHByZXYpO1xuICAgICAgfVxuXG4gICAgICBub2RlLmRpc3Bvc2UoKTtcbiAgICAgIHRoaXMuX3NpemUtLTtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuXG4gICAgX3dhbGtUb0lkeDogZnVuY3Rpb24oaWR4KSB7XG4gICAgICB2YXIgbm9kZSwgY3VycmVudDtcbiAgICAgIGlmIChpZHggPCB0aGlzLl9zaXplIC8gMikge1xuICAgICAgICBub2RlID0gdGhpcy5fZnJvbnQ7XG4gICAgICAgIGN1cnJlbnQgPSAwO1xuICAgICAgICB3aGlsZShjdXJyZW50ICE9PSBpZHgpIHtcbiAgICAgICAgICBub2RlID0gbm9kZS5uZXh0KCk7XG4gICAgICAgICAgY3VycmVudCsrO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBub2RlID0gdGhpcy5fYmFjaztcbiAgICAgICAgY3VycmVudCA9IHRoaXMuX3NpemUgLSAxO1xuXG4gICAgICAgIHdoaWxlKGN1cnJlbnQgIT09IGlkeCkge1xuICAgICAgICAgIG5vZGUgPSBub2RlLnByZXYoKTtcbiAgICAgICAgICBjdXJyZW50LS07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBub2RlO1xuICAgIH0sXG5cbiAgICBfd2Fsa1RvVmFsdWU6IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICB2YXIgbiA9IHRoaXMuX2Zyb250O1xuICAgICAgd2hpbGUgKG4gIT09bnVsbCApIHtcbiAgICAgICAgaWYgKG4ubWF0Y2godmFsdWUpKSB7XG4gICAgICAgICAgcmV0dXJuIG47XG4gICAgICAgIH1cbiAgICAgICAgbiA9IG4ubmV4dCgpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSxcblxuICAgIF9pc0VsZW1lbnRJZHg6IGZ1bmN0aW9uKGlkeCkge1xuICAgICAgcmV0dXJuIChpZHggPj0gMCAmJiBpZHggPCB0aGlzLl9zaXplKTtcbiAgICB9LFxuXG4gICAgX2lzRWxlbWVudFBvc2l0aW9uOiBmdW5jdGlvbihpZHgpIHtcbiAgICAgIHJldHVybiAoaWR4ID49IDAgJiYgaWR4IDw9IHRoaXMuX3NpemUpO1xuICAgIH0sXG5cbiAgICBfY2hlY2tFbGVtZW50SWR4T3JUaHJvdzogZnVuY3Rpb24oaWR4KSB7XG4gICAgICBpZiAoIXRoaXMuX2lzRWxlbWVudElkeChpZHgpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkluZGV4IG91dCBvZiBib3VuZHM7IHNpemU6IFwiICsgdGhpcy5fc2l6ZSArIFwiOyBpZHg6IFwiICsgaWR4KTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgX2NoZWNrSXNFbGVtZW50UG9zaXRpb25PclRocm93OiBmdW5jdGlvbihpZHgpIHtcbiAgICAgIGlmICghdGhpcy5faXNFbGVtZW50UG9zaXRpb24oaWR4KSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbmRleCBvdXQgb2YgYm91bmRzOyBzaXplOiBcIiArIHRoaXMuX3NpemUgKyBcIjsgaWR4OiBcIiArIGlkeCk7XG4gICAgICB9XG4gICAgfVxuXG4gIH0pO1xuXG4gIHZhciBOb2RlID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoTm9kZS5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzICAgICAgICA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIHRoaXMuX25leHQgID0gb3B0cy5nZXRPckVsc2UoXCJuZXh0XCIsIG51bGwpO1xuICAgICAgdGhpcy5fcHJldiAgPSBvcHRzLmdldE9yRWxzZShcInByZXZcIiwgbnVsbCk7XG4gICAgICB0aGlzLl92YWx1ZSA9IG9wdHMuZ2V0T3JFbHNlKFwidmFsdWVcIiwgbnVsbCk7XG4gICAgfSxcblxuICAgIG5leHQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX25leHQ7XG4gICAgfSxcblxuICAgIHByZXY6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3ByZXY7XG4gICAgfSxcblxuICAgIHNldE5leHQ6IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgIHRoaXMuX25leHQgPSBub2RlO1xuICAgIH0sXG5cbiAgICBzZXRQcmV2OiBmdW5jdGlvbihub2RlKSB7XG4gICAgICB0aGlzLl9wcmV2ID0gbm9kZTtcbiAgICB9LFxuXG4gICAgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlO1xuICAgIH0sXG5cbiAgICBkaXNwb3NlOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX25leHQgID0gbnVsbDtcbiAgICAgIHRoaXMuX3ByZXYgID0gbnVsbDtcbiAgICAgIHRoaXMuX3ZhbHVlID0gbnVsbDtcbiAgICB9LFxuXG4gICAgbWF0Y2g6IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICByZXR1cm4gdGhpcy5fdmFsdWUgPT09IHZhbHVlO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIERvdWJseUxpbmtlZExpc3Q7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL29wdGlvbnNcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgT3B0aW9uc1xuKSB7XG5cbiAgLyoqXG4gICAqIERlbGVnYXRlcyBzdG9yYWdlIHRvIGEgSlMgb2JqZWN0LlxuICAgKi9cbiAgdmFyIE9iamVjdEhhc2hNYXAgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuXG4gIF8uZXh0ZW5kKE9iamVjdEhhc2hNYXAucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIHRoaXMuX3N0b3JlID0ge307XG4gICAgICB0aGlzLl9rZXlQcmVmaXggPSBvcHRzLmdldE9yRWxzZShcImtleVByZWZpeFwiLCBcIm9obS1cIik7XG4gICAgfSxcbiAgICBnZXQ6IGZ1bmN0aW9uKGtleSl7XG4gICAgICByZXR1cm4gdGhpcy5fc3RvcmVbdGhpcy5fbWFrZUtleShrZXkpXTtcbiAgICB9LFxuICAgIHB1dDogZnVuY3Rpb24oa2V5LCB2YWwpIHtcbiAgICAgIHRoaXMuX3N0b3JlW3RoaXMuX21ha2VLZXkoa2V5KV0gPSB2YWw7XG4gICAgfSxcbiAgICByZW1vdmU6IGZ1bmN0aW9uKGtleSkge1xuICAgICAgdmFyIHZhbDtcbiAgICAgIGtleSA9IHRoaXMuX21ha2VLZXkoa2V5KTtcbiAgICAgIGlmIChfLmhhcyh0aGlzLl9zdG9yZSwga2V5KSkge1xuICAgICAgICB2YWwgPSB0aGlzLl9zdG9yZVtrZXldO1xuICAgICAgICBkZWxldGUgdGhpcy5fc3RvcmVba2V5XTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB2YWw7XG4gICAgfSxcbiAgICBleGlzdHM6IGZ1bmN0aW9uKGtleSkge1xuICAgICAgcmV0dXJuIF8uaGFzKHRoaXMuX3N0b3JlLCB0aGlzLl9tYWtlS2V5KGtleSkpO1xuICAgIH0sXG4gICAgc2l6ZTogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gXy5zaXplKHRoaXMuX3N0b3JlKTtcbiAgICB9LFxuICAgIGNsZWFyOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX3N0b3JlID0ge307XG4gICAgfSxcbiAgICBfbWFrZUtleTogZnVuY3Rpb24oa2V5KSB7XG4gICAgICByZXR1cm4gdGhpcy5fa2V5UHJlZml4ICsga2V5O1xuICAgIH1cbiAgfSk7XG5cblxuICByZXR1cm4gT2JqZWN0SGFzaE1hcDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvb3B0aW9uc1wiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBPcHRpb25zLFxuICBPYmplY3RIYXNoTWFwLFxuICBEb3VibHlMaW5rZWRMaXN0XG4pIHtcblxuICB2YXIgTFJVSGFzaE1hcCA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKExSVUhhc2hNYXAucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIHRoaXMuX2NhcGFjaXR5ID0gb3B0cy5nZXRPckVycm9yKFwiY2FwYWNpdHlcIik7XG4gICAgICB0aGlzLl9rZXlBY2Nlc3NMaXN0ID0gbmV3IERvdWJseUxpbmtlZExpc3QoKTtcbiAgICAgIC8vIFRPRE86IFJlYWxseSBuZWVkIGEgcHJvcGVyIEhhc2hNYXAgYXQgc29tZSBwb2ludC4uLlxuICAgICAgdGhpcy5fc3RvcmUgPSBuZXcgT2JqZWN0SGFzaE1hcCgpO1xuICAgIH0sXG4gICAgZ2V0OiBmdW5jdGlvbihrZXkpIHtcbiAgICAgIHZhciBlbnRyeSA9IHRoaXMuX3N0b3JlLmdldChrZXkpO1xuICAgICAgaWYgKCFlbnRyeSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIEFzIGEgcGVyZiBvcHRpbWl6YXRpb24sIHdlIGtlZXAgYSByZWZcbiAgICAgIC8vIHRvIHRoZSBub2RlIGluIHRoZSBlbnRyeS5cbiAgICAgIHZhciBub2RlID0gZW50cnkubm9kZSgpO1xuICAgICAgdGhpcy5fa2V5QWNjZXNzTGlzdC5fdW5saW5rKG5vZGUpO1xuXG4gICAgICAvLyBHZXQgdGhlIG5ldyBub2RlXG4gICAgICBub2RlID0gdGhpcy5fa2V5QWNjZXNzTGlzdC5fbGlua0Zyb250KGVudHJ5LmtleSgpKTtcblxuICAgICAgLy8gU2F2ZSBpdFxuICAgICAgZW50cnkuc2V0Tm9kZShub2RlKTtcbiAgICAgIC8vIFJldHVybiB0aGUgdmFsdWVcbiAgICAgIHJldHVybiBlbnRyeS52YWx1ZSgpO1xuICAgIH0sXG5cbiAgICBwdXQ6IGZ1bmN0aW9uKGtleSwgdmFsKSB7XG4gICAgICB2YXIgZW50cnkgPSB0aGlzLl9zdG9yZS5nZXQoa2V5KSxcbiAgICAgICAgICBub2RlO1xuICAgICAgaWYgKCFlbnRyeSkge1xuICAgICAgICAvLyBJZiBubyBlbnRyeSwgbWFrZSBhIG5ldyBlbnRyeVxuICAgICAgICBpZiAodGhpcy5fa2V5QWNjZXNzTGlzdC5zaXplKCkgPj0gdGhpcy5fY2FwYWNpdHkpIHtcbiAgICAgICAgICAvLyBIYXZlIHRvIG1ha2Ugcm9vbSBmb3IgaXRcbiAgICAgICAgICB2YXIgZXZpY3RlZEtleSA9IHRoaXMuX2tleUFjY2Vzc0xpc3QucmVtb3ZlQmFjaygpLFxuICAgICAgICAgICAgICBldmljdGVkRW50cnkgPSB0aGlzLl9zdG9yZS5nZXQoZXZpY3RlZEtleSk7XG5cbiAgICAgICAgICBldmljdGVkRW50cnkuZGlzcG9zZSgpO1xuICAgICAgICAgIHRoaXMuX3N0b3JlLnJlbW92ZShldmljdGVkS2V5KTtcbiAgICAgICAgfVxuXG4gICAgICAgIG5vZGUgPSB0aGlzLl9rZXlBY2Nlc3NMaXN0Ll9saW5rRnJvbnQoa2V5KTtcbiAgICAgICAgZW50cnkgPSBuZXcgRW50cnkoe1xuICAgICAgICAgIGtleToga2V5LFxuICAgICAgICAgIHZhbHVlOiB2YWwsXG4gICAgICAgICAgbm9kZTogbm9kZVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fc3RvcmUucHV0KGtleSwgZW50cnkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gXCJUb3VjaFwiIHRoZSBlbnRyeSwgc2V0IG5ldyB2YWx1ZVxuICAgICAgICBub2RlID0gZW50cnkubm9kZSgpO1xuICAgICAgICB0aGlzLl9rZXlBY2Nlc3NMaXN0Ll91bmxpbmsobm9kZSk7XG4gICAgICAgIG5vZGUgPSB0aGlzLl9rZXlBY2Nlc3NMaXN0Ll9saW5rRnJvbnQoZW50cnkua2V5KCkpO1xuICAgICAgICAvLyBVcGRhdGUgd2l0aCB0aGUgbmV3IG5vZGUgYW5kIHZhbHVlXG4gICAgICAgIGVudHJ5LnNldE5vZGUobm9kZSk7XG4gICAgICAgIGVudHJ5LnNldFZhbHVlKHZhbCk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIHJlbW92ZTogZnVuY3Rpb24oa2V5KSB7XG4gICAgICB2YXIgZW50cnkgPSB0aGlzLl9zdG9yZS5nZXQoa2V5KSxcbiAgICAgICAgICB2YWx1ZSxcbiAgICAgICAgICBub2RlO1xuICAgICAgaWYgKGVudHJ5KSB7XG4gICAgICAgIHZhbHVlID0gZW50cnkudmFsdWUoKTtcbiAgICAgICAgbm9kZSA9IGVudHJ5Lm5vZGUoKTtcbiAgICAgICAgdGhpcy5fa2V5QWNjZXNzTGlzdC5fdW5saW5rKG5vZGUpO1xuICAgICAgICBlbnRyeS5kaXNwb3NlKCk7XG4gICAgICAgIHRoaXMuX3N0b3JlLnJlbW92ZShrZXkpO1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9XG4gICAgfSxcblxuICAgIGV4aXN0czogZnVuY3Rpb24oa2V5KSB7XG4gICAgICByZXR1cm4gdGhpcy5fc3RvcmUuZXhpc3RzKGtleSk7XG4gICAgfSxcblxuICAgIHNpemU6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3N0b3JlLnNpemUoKTtcbiAgICB9LFxuXG4gICAgY2xlYXI6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fc3RvcmUuY2xlYXIoKTtcbiAgICAgIHRoaXMuX2tleUFjY2Vzc0xpc3QuY2xlYXIoKTtcbiAgICB9XG4gIH0pO1xuXG4gIHZhciBFbnRyeSA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKEVudHJ5LnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICAvLyBUaG91Z2ggdGhlIE5vZGUgc2hvdWxkIGhhdmUgdGhlIGtleSwgaWYgdGhlIG5vZGVcbiAgICAgIC8vIGlzIHVubGlua2VkIGZyb20gdGhlIGxpc3QsIGl0cyBib3hlZCB2YWx1ZSB3aWxsIGRpc2FwcGVhclxuICAgICAgdGhpcy5fa2V5ICAgPSBvcHRzLmdldE9yRXJyb3IoXCJrZXlcIik7XG4gICAgICB0aGlzLl92YWx1ZSA9IG9wdHMuZ2V0T3JFcnJvcihcInZhbHVlXCIpO1xuICAgICAgdGhpcy5fbm9kZSAgPSBvcHRzLmdldE9yRXJyb3IoXCJub2RlXCIpO1xuICAgIH0sXG4gICAgbm9kZTogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fbm9kZTtcbiAgICB9LFxuICAgIHNldE5vZGU6IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgIHRoaXMuX25vZGUgPSBub2RlO1xuICAgIH0sXG4gICAgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlO1xuICAgIH0sXG4gICAgc2V0VmFsdWU6IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICB0aGlzLl92YWx1ZSA9IHZhbHVlO1xuICAgIH0sXG4gICAga2V5OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9rZXk7XG4gICAgfSxcbiAgICBkaXNwb3NlOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX2tleSA9IG51bGw7XG4gICAgICB0aGlzLl92YWx1ZSA9IG51bGw7XG4gICAgICB0aGlzLl9ub2RlID0gbnVsbDtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBMUlVIYXNoTWFwO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9vcHRpb25zXCIpLFxuICByZXF1aXJlKFwiLi9vYmplY3QtaGFzaC1tYXBcIiksXG4gIHJlcXVpcmUoXCIuL2RvdWJseS1saW5rZWQtbGlzdFwiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBQcm9taXNlLFxuICBPcHRpb25zLFxuICBJbk1lbW9yeURhdGFTdG9yZSxcbiAgVW5pdFNlcXVlbmNlcixcbiAgRW50cnlcbikge1xuXG4gIC8vIEFwcHJvcHJpYXRlIGZvciB0aGUgZGVmYXVsdCBzZXF1ZW5jZXIgKG5vbi10ZW1wb3JhbClcbiAgdmFyIERFRkFVTFRfVFRMID0gMTtcblxuXG4gIC8qKlxuICAgKiBBIGxvb2stYXNpZGUgY2FjaGluZyBkYXRhIHN0b3JlLiBOb3RlOiBpdCdzIGdlbmVyYWxseSBub3QgdXNlZnVsIHRvIGFsbG93XG4gICAqIG51bGwvdW5kZWZpbmVkIHN0b3JlZCB2YWx1ZXMuIFdoZW4gYW4gaXRlbSBpcyBldmljdGVkIGZyb20gdGhlIGNhY2hlLCBhXG4gICAqIHN1YnNlcXVlbnQgYGdldGAgY2FsbCB3aWxsIHJldHVybiBgdW5kZWZpbmVkYCwgc28gaXQgY2FuIGJlIGRpZmZpY3VsdCB0b1xuICAgKiBkZXRlcm1pbmUgaWYgdGhlcmUgd2FzIGEgY2FjaGUgbWlzcyBpZiB0aGUgdmFsdWUgeW91J3JlIHN0b3JpbmcgaXMsIGluIGZhY3QsXG4gICAqIGB1bmRlZmluZWRgLCB1bmxlc3MgeW91IHByZWZpeCBldmVyeSBjaGVjayB3aXRoIGBleGlzdHNgLCB3aGljaCBhbHNvIGRvZXNcbiAgICogY2FjaGUgZXZpY3Rpb24gb24gY2hlY2suXG4gICAqL1xuICB2YXIgQ2FjaGluZ0RhdGFTdG9yZSA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKENhY2hpbmdEYXRhU3RvcmUucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIHRoaXMuX3R0bCA9IG9wdHMuZ2V0T3JFbHNlKFwidHRsXCIsIERFRkFVTFRfVFRMKTtcblxuICAgICAgLy8gRGVmYXVsdCBzZXF1ZW5jZXIgaXMgYSBsaW5lYXIvdW5pdCBzZXF1ZW5jZXIuIFRoZSBkZWZhdWx0IFRUTCBpc1xuICAgICAgLy8gMS4gVGhlcmVmb3JlLCBhbGwgdmFsdWVzIHdpbGwgZXhwaXJlIHdpdGggc2luZ2xlIGFkdmFuY2Ugb2YgdGhlXG4gICAgICAvLyBzZXF1ZW5jZXIuIE5vdGUgdGhhdCB0aGUgZGF0YSBzdG9yZSBkb2Vzbid0IGFkdmFuY2UgdGhlXG4gICAgICAvLyBzZXF1ZW5jZXIgaXRzZWxmLiBUaGUgc3RvcmUgb3duZXIgaXMgcmVzcG9uc2libGUgZm9yIGRvaW5nXG4gICAgICAvLyB0aGlzLlxuICAgICAgLy9cbiAgICAgIC8vIFRoaXMgaXMgZXNwZWNpYWxseSBpbXBvcnRhbnQgdG8gbm90ZSBmb3IgdGltZS1iYXNlZCBzZXF1ZW5jZXJzLlxuICAgICAgLy8gVGltZSB3aWxsIG5vdCBhZHZhbmNlIGF1dG9tYXRpY2FsbHkuIFRoZSBzdG9yZSBvd25lciBpcyByZXNwb25zaWJsZVxuICAgICAgLy8gZm9yIHNjaGVkdWxpbmcgdGhlIHNlcXVlbmNlciB0byBhZHZhbmNlIHdpdGggdGltZS4gVGhpcyBrZWVwcyB0aGVcbiAgICAgIC8vIENhY2hpbmdEYXRhU3RvcmUncyBsaWZlY3ljbGUgc2ltcGxlIHdpdGggcmVzcGVjdCB0byB0aW1lLlxuICAgICAgdGhpcy5fc2VxdWVuY2VyID0gb3B0cy5nZXRPckVsc2VGbihcInNlcXVlbmNlclwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBVbml0U2VxdWVuY2VyKCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gQnkgZGVmYXVsdCwgd2UgZGVsZWdhdGUgdG8gYW4gaW4tbWVtb3J5IHN0b3JlLiBGaW5lIGZvciBzaW1wbGVcbiAgICAgIC8vIGNhc2VzLCBidXQgbm90IG9wdGltYWwuXG4gICAgICB0aGlzLl9iYWNraW5nU3RvcmUgPSBvcHRzLmdldE9yRWxzZUZuKFwiYmFja2luZ1N0b3JlXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gbmV3IEluTWVtb3J5RGF0YVN0b3JlKCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gVXBkYXRlcyB0aGUgbGFzdFVwZGF0ZWQgdGltZSB0byBcIm5vd1wiIG9uIHJlYWQgLSBrZWVwcyBlbnRyaWVzXG4gICAgICAvLyBmcm9tIGV4cGlyaW5nIHdoZW4gdGhleSdyZSBiZWluZyBhY2Nlc3NlZCwgYnV0IGNhbiBjYXVzZVxuICAgICAgLy8gc3RhbGVuZXNzIGlzc3Vlcy5cbiAgICAgIHRoaXMuX3Nob3VsZFRvdWNoT25SZWFkID0gb3B0cy5nZXRPckVsc2UoXCJ0b3VjaE9uUmVhZFwiLCBmYWxzZSk7XG4gICAgfSxcblxuICAgIHNlcXVlbmNlcjogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc2VxdWVuY2VyO1xuICAgIH0sXG5cblxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIHZhbHVlIGFzc29jaWF0ZWQgd2l0aCB0aGUgcHJvdmlkZWQga2V5LiBJZiB0aGUgb2JqZWN0IGhhc1xuICAgICAqIGV4cGlyZWQsIGl0IHdpbGwgYmUgZXZpY3RlZCBmcm9tIHRoZSBjYWNoZSwgYW5kIGB1bmRlZmluZWRgIHdpbGxcbiAgICAgKiBiZSByZXR1cm5lZCBpbnN0ZWFkLlxuICAgICAqXG4gICAgICogQHBhcmFtIGtleSB7c3RyaW5nfSAocmVxdWlyZWQpXG4gICAgICogQGFzeW5jXG4gICAgICogQHJldHVybnMge1Byb21pc2U8T2JqZWN0Pn0gcmVxdWVzdGVkIHZhbHVlXG4gICAgICovXG4gICAgZ2V0OiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbihrZXkpIHtcbiAgICAgIHJldHVybiBQcm9taXNlXG4gICAgICAgIC5iaW5kKHRoaXMpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLl9iYWNraW5nU3RvcmUuZ2V0KGtleSk7XG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKGVudHJ5KXtcbiAgICAgICAgICBpZiAoIWVudHJ5KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKCFlbnRyeS5pc0V4cGlyZWQodGhpcy5fc2VxdWVuY2VyLnZhbHVlKCksIHRoaXMuX3R0bCkpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9zaG91bGRUb3VjaE9uUmVhZCkge1xuICAgICAgICAgICAgICBlbnRyeS50b3VjaCh0aGlzLl9zZXF1ZW5jZXIudmFsdWUoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZVxuICAgICAgICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYmFja2luZ1N0b3JlLnB1dChrZXksIGVudHJ5KTtcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgLnJldHVybihlbnRyeS52YWx1ZSgpKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2VcbiAgICAgICAgICAgICAgLmJpbmQodGhpcylcbiAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVtb3ZlKGtleSlcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgLy8gLnRoZW5SZXR1cm4gaXMgYSBsaWUuXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pLFxuXG4gICAgLyoqXG4gICAgICogU3RvcmVzIHRoZSBwcm92aWRlZCBgdmFsYCwgaWRlbnRpZmllZCBieSBga2V5YFxuICAgICAqXG4gICAgICogQHBhcmFtIGBrZXlgIHtzdHJpbmd9ICAocmVxdWlyZWQpIGlkZW50aWZpZXIgZm9yIHZhbHVlIHRvIGJlIHN0b3JlZFxuICAgICAqIEBwYXJhbSBgdmFsYCB7ZHluYW1pY30gKHJlcXVpcmVkKSB2YWx1ZSB0byBiZSBzdG9yZWRcbiAgICAgKiBAYXN5bmNcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTw+fVxuICAgICAqL1xuICAgIHB1dDogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oa2V5LCB2YWwpIHtcbiAgICAgIHJldHVybiBQcm9taXNlXG4gICAgICAgIC5iaW5kKHRoaXMpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLl9iYWNraW5nU3RvcmUuZ2V0KGtleSk7XG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKGVudHJ5KSB7XG4gICAgICAgICAgLy8gSWYgd2UgaGF2ZSBhbiBlbnRyeSwgd2Ugc2hvdWxkIGp1c3QgdXBkYXRlXG4gICAgICAgICAgLy8gRWxzZSwgd2UgbWFrZSBuZXcgb25lLlxuICAgICAgICAgIC8vIFBlc2lzdCwgdGhlbiByZXR1cm4gbm90aGluZy5cbiAgICAgICAgICBpZiAoZW50cnkpIHtcbiAgICAgICAgICAgIGVudHJ5LnVwZGF0ZSh2YWwsIHRoaXMuX3NlcXVlbmNlci52YWx1ZSgpKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZW50cnkgPSBuZXcgRW50cnkoe1xuICAgICAgICAgICAgICB2YWx1ZTogdmFsLFxuICAgICAgICAgICAgICBpbml0aWFsU2VxdWVuY2U6IHRoaXMuX3NlcXVlbmNlci52YWx1ZSgpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4gUHJvbWlzZVxuICAgICAgICAgICAgLmJpbmQodGhpcylcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYmFja2luZ1N0b3JlLnB1dChrZXksIGVudHJ5KVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfSksXG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIHRoZSB2YWx1ZSBhc3NvY2lhdGVkIHdpdGggdGhlIHByb3ZpZGVkIGBrZXlgXG4gICAgICpcbiAgICAgKiBAcGFyYW0gYGtleWAge3N0cmluZ30gKHJlcXVpcmVkKSBpZGVudGlmaWVyIGZvciB2YWx1ZSB0byBiZSByZW1vdmVkXG4gICAgICogQGFzeW5jXG4gICAgICogQHJldHVybnMge1Byb21pc2U8ZHluYW1pYz59IFJlbW92ZWQgdmFsdWUsIGlmIHByZXNlbnQgaW4gc3RvcmUuXG4gICAgICovXG4gICAgcmVtb3ZlOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbihrZXkpIHtcbiAgICAgIHZhciB2YWw7XG4gICAgICByZXR1cm4gdGhpcy5fYmFja2luZ1N0b3JlXG4gICAgICAgIC5yZW1vdmUoa2V5KVxuICAgICAgICAudGhlbihmdW5jdGlvbihlbnRyeSkge1xuICAgICAgICAgIGlmIChlbnRyeSkge1xuICAgICAgICAgICAgdmFsID0gZW50cnkudmFsdWUoKTtcbiAgICAgICAgICAgIGVudHJ5LmRpc3Bvc2UoKTtcbiAgICAgICAgICAgIHJldHVybiB2YWw7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KSxcblxuICAgIGV4aXN0czogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oa2V5KXtcbiAgICAgIC8vIEl0J3Mgbm90IHN1ZmZpY2llbnQgdG8gZGVsZWdhdGUgdGhpcyBjYWxsIHRvIHRoZSB1bmRlcmx5aW5nXG4gICAgICAvLyBiYWNraW5nIHN0b3JlLiBXZSBuZWVkIHRvIHBlcmZvcm0gZXZpY3Rpb24sIGFzIGEgc3Vic2VxdWVudCBjYWxsXG4gICAgICAvLyB0byBnZXQgd291bGQgZG8gdGhlIHNhbWUuIElmIHRoZSBgZXhpc3RzYCBjaGVjayBzYXlzIGl0IGV4aXN0cyxcbiAgICAgIC8vIGJldCBpdCBkb2Vzbid0IHdoZW4gd2UgYGdldGAsIHRoZW4gYGV4aXN0c2AgaXMgYSB3b3J0aGxlc3Mgb3BlcmF0aW9uLlxuICAgICAgLy9cbiAgICAgIC8vIE5vdGUgdGhhdCBpZiB5b3UncmUgdXNpbmcgYSBDYWNoaW5nRGF0YVN0b3JlIGJhY2tlZCBieSBhbiBJbk1lbW9yeURhdGFTdG9yZVxuICAgICAgLy8gYmFja2VkIGJ5IGFuIExSVUhhc2hNYXAsIHRoaXMgd2lsbCBjYXVzZSB0aGUgZW50cnkgdG8gYmUgXCJ0b3VjaGVkXCIsIHdoZXJlYXNcbiAgICAgIC8vIGEgbm9ybWFsIFwiZXhpc3RzXCIgY2hlY2sgd291bGQgbm90LlxuICAgICAgcmV0dXJuIFByb21pc2VcbiAgICAgICAgLmJpbmQodGhpcylcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX2JhY2tpbmdTdG9yZS5nZXQoa2V5KTtcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oZW50cnkpIHtcbiAgICAgICAgICAgIGlmICghZW50cnkpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgaWYgKCFlbnRyeS5pc0V4cGlyZWQodGhpcy5fc2VxdWVuY2VyLnZhbHVlKCksIHRoaXMuX3R0bCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYmFja2luZ1N0b3JlLnJlbW92ZShrZXkpXG4gICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgZW50cnkuZGlzcG9zZSgpO1xuICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgIC50aGVuUmV0dXJuKGZhbHNlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KSxcblxuICAgIGNsZWFyOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9iYWNraW5nU3RvcmUuY2xlYXIoKTtcbiAgICB9KVxuICB9KTtcblxuICByZXR1cm4gQ2FjaGluZ0RhdGFTdG9yZTtcblxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiYmx1ZWJpcmRcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL29wdGlvbnNcIiksXG4gIHJlcXVpcmUoXCIuL2luLW1lbW9yeS1kYXRhLXN0b3JlXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9zZXF1ZW5jZXIvdW5pdC1zZXF1ZW5jZXJcIiksXG4gIHJlcXVpcmUoXCIuL2ludGVybmFscy9leHBpcmluZy1lbnRyeVwiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBQcm9taXNlLFxuICBPcHRpb25zLFxuICBPYmplY3RIYXNoTWFwXG4pIHtcblxuICAvKipcbiAgICogSW5NZW1vcnlEYXRhU3RvcmUgZGVsZWdhdGVzIHRvIGEgYmFja2luZyBIYXNoTWFwLiBCeSBkZWZhdWx0LCB0aGlzXG4gICAqIHdpbGwgYmUgYSBcInBvb3IgbWFuJ3MgSGFzaE1hcFwiLCBhLmsuYS4sIHRoZSBPYmplY3RIYXNoTWFwLlxuICAgKi9cbiAgdmFyIEluTWVtb3J5RGF0YVN0b3JlID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoSW5NZW1vcnlEYXRhU3RvcmUucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIHRoaXMuX21hcCA9IG9wdHMuZ2V0T3JFbHNlRm4oXCJiYWNraW5nSGFzaE1hcFwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBPYmplY3RIYXNoTWFwKCk7XG4gICAgICB9KTtcbiAgICB9LFxuXG4gICAgZ2V0OiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbihrZXkpIHtcbiAgICAgIHJldHVybiB0aGlzLl9tYXAuZ2V0KGtleSk7XG4gICAgfSksXG5cbiAgICBwdXQ6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKGtleSwgdmFsKSB7XG4gICAgICByZXR1cm4gdGhpcy5fbWFwLnB1dChrZXksIHZhbCk7XG4gICAgfSksXG5cbiAgICByZW1vdmU6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKGtleSkge1xuICAgICAgcmV0dXJuIHRoaXMuX21hcC5yZW1vdmUoa2V5KTtcbiAgICB9KSxcblxuICAgIGV4aXN0czogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oa2V5KXtcbiAgICAgIHJldHVybiB0aGlzLl9tYXAuZXhpc3RzKGtleSk7XG4gICAgfSksXG5cbiAgICBjbGVhcjogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fbWFwLmNsZWFyKCk7XG4gICAgfSlcbiAgfSk7XG5cbiAgcmV0dXJuIEluTWVtb3J5RGF0YVN0b3JlO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiYmx1ZWJpcmRcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL29wdGlvbnNcIiksXG4gIHJlcXVpcmUoXCIuLi9jb2xsZWN0aW9uL29iamVjdC1oYXNoLW1hcFwiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBPcHRpb25zLFxuICBJbk1lbW9yeURhdGFTdG9yZSxcbiAgTFJVSGFzaE1hcFxuKSB7XG5cbiAgdmFyIExSVURhdGFTdG9yZSA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKExSVURhdGFTdG9yZS5wcm90b3R5cGUsIEluTWVtb3J5RGF0YVN0b3JlLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB2YXIgbWFwID0gbmV3IExSVUhhc2hNYXAoe1xuICAgICAgICBjYXBhY2l0eTogb3B0cy5nZXRPckVycm9yKFwiY2FwYWNpdHlcIilcbiAgICAgIH0pO1xuICAgICAgSW5NZW1vcnlEYXRhU3RvcmUucHJvdG90eXBlLmluaXRpYWxpemUuY2FsbCh0aGlzLCB7XG4gICAgICAgIGJhY2tpbmdIYXNoTWFwOiBtYXBcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIExSVURhdGFTdG9yZTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4vaW4tbWVtb3J5LWRhdGEtc3RvcmVcIiksXG4gIHJlcXVpcmUoXCIuLi9jb2xsZWN0aW9uL2xydS1oYXNoLW1hcFwiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBQcm9taXNlLFxuICBNLFxuICBPcHRpb25zLFxuICBDaGFubmVsLFxuICBDaGFpbmVkQ2hhbm5lbCxcbiAgVW5pdFNlcXVlbmNlcixcbiAgRGVsZWdhdGluZ0ZvcndhcmRpbmdTZXF1ZW5jZXIsXG4gIEluTWVtb3J5RGF0YVN0b3JlLFxuICBFbnRyeVxuKSB7XG5cbiAgLyoqXG4gICAqIFNlbWFudGljYWxseSBzaW1pbGFyIHRvIGEgQ2FjaGluZ0RhdGFTdG9yZSwgZXhjZXB0OlxuICAgKiAgIDEpIEV4cGlyeSBpcyBjaGVjayBib3RoIG9uIGFjY2VzcywgYW5kIHdoZW5ldmVyIGBhZHZhbmNlYCBpc1xuICAgKiAgICAgIGNhbGxlZCBvbiB0aGUgYHNlbnRyeVNlcXVlbmNlcmAuXG4gICAqICAgMikgUmVjb3JkcyBhcmUgbm90IGF1dG9tYXRpY2FsbHkgcmVtb3ZlZDsgaW5zdGVhZCwgYSBzaWduYWwgaXMgc2VudFxuICAgKiAgICAgIGFsb25nIHRoZSBgc2lnbmFsQ2hhbm5lbGAuIFRoZSBzaWduYWwgZGlzcGF0Y2ggaXMgZGVmZXJyZWQsIHNvXG4gICAqICAgICAgYW4gYWNjZXNzLXRyaWdnZXJlZCBldm9jYXRpb24gc2lnbmFsIHdvbid0IGJlIHJlY2VpdmVkIHVudGlsIGFcbiAgICogICAgICBzdWJzZXF1ZW50IHRpY2suIFNpbmNlIHByb21pc2VzIGFyZSBhc3luY2hyb25vdXMsIHRoaXMgbWVhbnNcbiAgICogICAgICB0aGUgY2FsbGVyIG1heSByZWNlaXZlIGEgdmFsdWUgZnJvbSB0aGUgc3RvcmUsIGFuZCBtYXkgYWxzb1xuICAgKiAgICAgIHJlY2VpdmUgYW4gZXZlbnQgZnJvbSB0aGUgU3RvcmUgaW5kaWNhdGluZyBleHBpcnkgLSBpbiBub24tZGV0ZXJtaW5pc3RpY1xuICAgKiAgICAgIG9yZGVyLiBJdCdzIHVwIHRvIHRoZSBjYWxsZXIgdG8gY2hvb3NlIGEgcmVzb2x1dGlvbi5cbiAgICogICAgICBBZGRpdGlvbmFsbHksIHRoZXJlIGlzIG5vIGd1YXJhbnRlZSB0aGF0IGEgc2luZ2xlIGV4cGlyeSBldmVudFxuICAgKiAgICAgIHdpbGwgYmUgc2VudCBmb3IgYSBnaXZlbiBrZXk7IGluc3RlYWQsIHRoZSBldmVudCB3aWxsIGNvbnRpbnVlXG4gICAqICAgICAgdG8gYmUgZGlzcGF0Y2hlZCBmb3IgYXMgbG9uZyBhcyB0aGUga2V5IHJlbWFpbnMgaW4gdGhlIHN0b3JlLlxuICAgKiBAY29uc3RydWN0b3JcbiAgICovXG4gIHZhciBTaWduYWxpbmdEYXRhU3RvcmUgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICB2YXIgREVGQVVMVF9UVEwgPSAxO1xuXG4gIF8uZXh0ZW5kKFNpZ25hbGluZ0RhdGFTdG9yZS5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdGhpcy5fdHRsID0gb3B0cy5nZXRPckVsc2UoXCJ0dGxcIiwgREVGQVVMVF9UVEwpO1xuXG4gICAgICB0aGlzLl9zZXF1ZW5jZXIgPSBvcHRzLmdldE9yRWxzZUZuKFwic2VxdWVuY2VyXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gbmV3IFVuaXRTZXF1ZW5jZXIoKTtcbiAgICAgIH0pO1xuXG4gICAgICBfLmJpbmRBbGwodGhpcywgXCJfZG9DaGVja1wiKTtcblxuICAgICAgdGhpcy5fc2VudHJ5U2VxdWVuY2VyID0gbmV3IERlbGVnYXRpbmdGb3J3YXJkaW5nU2VxdWVuY2VyKHtcbiAgICAgICAgZGVsZWdhdGU6IG5ldyBVbml0U2VxdWVuY2VyKCksXG4gICAgICAgIHRhcmdldHM6IFt7XG4gICAgICAgICAgYWR2YW5jZTogdGhpcy5fZG9DaGVja1xuICAgICAgICB9XVxuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuX2JhY2tpbmdTdG9yZSA9IG9wdHMuZ2V0T3JFbHNlRm4oXCJiYWNraW5nU3RvcmVcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBuZXcgSW5NZW1vcnlEYXRhU3RvcmUoKTtcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLl9zaG91bGRUb3VjaE9uUmVhZCA9IG9wdHMuZ2V0T3JFbHNlKFwidG91Y2hPblJlYWRcIiwgZmFsc2UpO1xuXG4gICAgICB0aGlzLl9zaWduYWxDaGFubmVsID0gbmV3IENoYW5uZWwoeyBzZW50aW5lbDogdGhpcyB9KTtcblxuICAgICAgdGhpcy5fa2V5cyA9IE0uc2V0KCk7XG4gICAgfSxcblxuICAgIHNlcXVlbmNlcjogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc2VxdWVuY2VyO1xuICAgIH0sXG5cbiAgICBzZW50cnlTZXF1ZW5jZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3NlbnRyeVNlcXVlbmNlcjtcbiAgICB9LFxuXG4gICAgc2lnbmFsQ2hhbm5lbDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gbmV3IENoYWluZWRDaGFubmVsKHtcbiAgICAgICAgc2VudGluZWw6IHRoaXMsXG4gICAgICAgIGNoYWluVG86IHRoaXMuX3NpZ25hbENoYW5uZWxcbiAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBfZG9DaGVjazogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgd29yayA9IE0ubWFwKF8uYmluZChmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2VcbiAgICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JhY2tpbmdTdG9yZS5nZXQoa2V5KTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGVudHJ5KSB7XG4gICAgICAgICAgICBpZiAoZW50cnkgJiYgZW50cnkuaXNFeHBpcmVkKHRoaXMuX3NlcXVlbmNlci52YWx1ZSgpLCB0aGlzLl90dGwpKSB7XG4gICAgICAgICAgICAgIHRoaXMuX3NpZ25hbEV4cGlyeVNvb24oa2V5LCB0aGlzLl9zZXF1ZW5jZXIudmFsdWUoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0sIHRoaXMpLCB0aGlzLl9rZXlzKTtcblxuICAgICAgcmV0dXJuIFByb21pc2UuYWxsKE0uaW50b19hcnJheSh3b3JrKSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIHZhbHVlIGFzc29jaWF0ZWQgd2l0aCB0aGUgcHJvdmlkZWQgYGtleWAuIElmIHRoZSBvYmplY3RcbiAgICAgKiBoYXMgZXhwaXJlZCwgaXQgd2lsbCBzdGlsbCBiZSByZXR1cm5lZCBmcm9tIHRoZSBTdG9yZSwgYnV0IGFuIG1UOmV4cGlyZWRcbiAgICAgKiBtZXNzYWdlIHdpbGwgYmUgc2VudCBhbG9uZyB0aGUgYHNpZ25hbENoYW5uZWxgLlxuICAgICAqXG4gICAgICogQHBhcmFtIGtleSB7c3RyaW5nfVxuICAgICAqIEBhc3luY1xuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPG9iamVjdD59IHJlcXVlc3RlZCB2YWx1ZVxuICAgICAqL1xuICAgIGdldDogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oa2V5KXtcbiAgICAgIHJldHVybiBQcm9taXNlXG4gICAgICAgIC5iaW5kKHRoaXMpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLl9iYWNraW5nU3RvcmUuZ2V0KGtleSk7XG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKGVudHJ5KSB7XG4gICAgICAgICAgaWYgKCFlbnRyeSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBpc0V4cGlyZWQgPSBlbnRyeS5pc0V4cGlyZWQodGhpcy5fc2VxdWVuY2VyLnZhbHVlKCksIHRoaXMuX3R0bCk7XG5cbiAgICAgICAgICBpZiAoaXNFeHBpcmVkKSB7XG4gICAgICAgICAgICB0aGlzLl9zaWduYWxFeHBpcnlTb29uKGtleSwgdGhpcy5fc2VxdWVuY2VyLnZhbHVlKCkpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICghaXNFeHBpcmVkICYmIHRoaXMuX3Nob3VsZFRvdWNoT25SZWFkKSB7XG4gICAgICAgICAgICBlbnRyeS50b3VjaCh0aGlzLl9zZXF1ZW5jZXIudmFsdWUoKSk7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZVxuICAgICAgICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYmFja2luZ1N0b3JlLnB1dChrZXksIGVudHJ5KTtcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgLnRoZW5SZXR1cm4oZW50cnkudmFsdWUoKSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBlbnRyeS52YWx1ZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSksXG5cbiAgICAvKipcbiAgICAgKiBTdG9yZXMgdGhlIHByb3ZpZGVkIGB2YWxgLCBpZGVudGlmaWVkIGJ5IGBrZXlgLCB3aXRoIGEgVFRMIG9wdGlvbmFsbHlcbiAgICAgKiBzdXBwbGllZCBieSBgb3B0cy50dGxgIChvdmVycmlkZXMgcHJlLWNvbmZpZ3VyZWQgU3RvcmUgVFRMLlxuICAgICAqXG4gICAgICogQHBhcmFtIGtleSB7U3RyaW5nfVxuICAgICAqIEBwYXJhbSB2YWwge29iamVjdH0gdmFsdWUgdG8gYmUgc3RvcmVkXG4gICAgICogQGFzeW5jXG4gICAgICogQHJldHVybnMge1Byb21pc2U8Pn1cbiAgICAgKi9cbiAgICBwdXQ6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKGtleSwgdmFsLCBvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuXG4gICAgICByZXR1cm4gUHJvbWlzZVxuICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fYmFja2luZ1N0b3JlLmdldChrZXkpO1xuICAgICAgICB9KVxuICAgICAgICAudGhlbihmdW5jdGlvbihlbnRyeSkge1xuICAgICAgICAgIGlmIChlbnRyeSkge1xuICAgICAgICAgICAgZW50cnkudXBkYXRlKHZhbCwgdGhpcy5fc2VxdWVuY2VyLnZhbHVlKCksIHtcbiAgICAgICAgICAgICAgdHRsOiBvcHRzLmdldE9yRWxzZShcInR0bFwiKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGVudHJ5ID0gbmV3IEVudHJ5KHtcbiAgICAgICAgICAgICAgdmFsdWU6IHZhbCxcbiAgICAgICAgICAgICAgaW5pdGlhbFNlcXVlbmNlOiB0aGlzLl9zZXF1ZW5jZXIudmFsdWUoKSxcbiAgICAgICAgICAgICAgdHRsOiBvcHRzLmdldE9yRWxzZShcInR0bFwiKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBQcm9taXNlXG4gICAgICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYmFja2luZ1N0b3JlLnB1dChrZXksIGVudHJ5KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgdGhpcy5fa2V5cyA9IE0uY29uaih0aGlzLl9rZXlzLCBrZXkpO1xuICAgICAgICAgICAgICByZXR1cm47IC8vIEJlY2F1c2UgdGhlblJldHVybiBkb2Vzbid0IHdvcmsgd2l0aCBhbiBlbXB0eSB2YWx1ZS5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9KSxcblxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyB0aGUgdmFsdWUgYXNzb2NpYXRlZCB3aXRoIHRoZSBwcm92aWRlZCBga2V5YFxuICAgICAqL1xuICAgIHJlbW92ZTogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oa2V5KXtcbiAgICAgIHZhciB2YWw7XG4gICAgICByZXR1cm4gdGhpcy5fYmFja2luZ1N0b3JlXG4gICAgICAgIC5yZW1vdmUoa2V5KVxuICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAudGhlbihmdW5jdGlvbihlbnRyeSkge1xuICAgICAgICAgIGlmIChlbnRyeSkge1xuICAgICAgICAgICAgdGhpcy5fa2V5cyA9IE0uZGlzaih0aGlzLl9rZXlzLCBrZXkpO1xuXG4gICAgICAgICAgICB2YWwgPSBlbnRyeS52YWx1ZSgpO1xuICAgICAgICAgICAgZW50cnkuZGlzcG9zZSgpO1xuICAgICAgICAgICAgcmV0dXJuIHZhbDtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pLFxuXG5cbiAgICBleGlzdHM6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKGtleSl7XG4gICAgICAvLyBVbmxpa2UgaW4gdGhlIENhY2hpbmdEYXRhU3RvcmUsIHdoZXJlIHdlIGhhdmUgdG8gcGVyZm9ybSBldmljdGlvbiBydWxlcyBiZWZvcmVcbiAgICAgIC8vIHJldHVybmluZyB0aGUgYW5zd2VyLCBoZXJlIHdlIGNhbiBqdXN0IGRlbGVnYXRlIHN0cmFpZ2h0IHRvIHRoZSBiYWNraW5nIHN0b3JlLlxuICAgICAgcmV0dXJuIHRoaXMuX2JhY2tpbmdTdG9yZS5leGlzdHMoa2V5KTtcbiAgICB9KSxcblxuXG4gICAgY2xlYXI6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKCl7XG4gICAgICByZXR1cm4gdGhpcy5fYmFja2luZ1N0b3JlLmNsZWFyKCk7XG4gICAgfSksXG5cblxuICAgIF9zaWduYWxFeHBpcnlTb29uOiBmdW5jdGlvbihrZXksIHNlcXVlbmNlKSB7XG4gICAgICBfLmRlZmVyKF8uYmluZChmdW5jdGlvbigpe1xuICAgICAgICB0aGlzLl9zaWduYWxDaGFubmVsLnB1Ymxpc2godGhpcywge1xuICAgICAgICAgIG1UOiBcImV4cGlyZWRcIixcbiAgICAgICAgICBrZXk6IGtleSxcbiAgICAgICAgICBzZXF1ZW5jZTogc2VxdWVuY2VcbiAgICAgICAgfSk7XG4gICAgICB9LCB0aGlzKSk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gU2lnbmFsaW5nRGF0YVN0b3JlO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiYmx1ZWJpcmRcIiksXG4gIHJlcXVpcmUoXCJtb3JpXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9vcHRpb25zXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9jaGFubmVsL2NoYW5uZWxcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL2NoYW5uZWwvY2hhaW5lZC1jaGFubmVsXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9zZXF1ZW5jZXIvdW5pdC1zZXF1ZW5jZXJcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL3NlcXVlbmNlci9kZWxlZ2F0aW5nLWZvcndhcmRpbmctc2VxdWVuY2VyXCIpLFxuICByZXF1aXJlKFwiLi9pbi1tZW1vcnktZGF0YS1zdG9yZVwiKSxcbiAgcmVxdWlyZShcIi4vaW50ZXJuYWxzL2V4cGlyaW5nLWVudHJ5XCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFNjb3BlZENvbmZpZ3VyYXRpb25SZXNvbHZlclxuKSB7XG5cbiAgdmFyIENvbmZpZ3VyYXRpb25NYWdpYyA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKENvbmZpZ3VyYXRpb25NYWdpYy5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbigpIHt9XG4gIH0pO1xuXG4gIF8uZXh0ZW5kKENvbmZpZ3VyYXRpb25NYWdpYywge1xuICAgIHJlc29sdmVDb25maWc6IGZ1bmN0aW9uKHNjb3BlcywgY29uZmlnT2JqZWN0cykge1xuICAgICAgdmFyIHIgPSBuZXcgU2NvcGVkQ29uZmlndXJhdGlvblJlc29sdmVyKCk7XG4gICAgICBfLmVhY2goY29uZmlnT2JqZWN0cywgZnVuY3Rpb24oYykge1xuICAgICAgICByLmFkZChjKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHIucmVzb2x2ZShzY29wZXMpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIENvbmZpZ3VyYXRpb25NYWdpYztcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcIi4vY29uZmlnL3Njb3BlZC1jb25maWd1cmF0aW9uLXJlc29sdmVyXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFByb21pc2UsXG4gIExvZ2dlcixcbiAgT3B0aW9ucyxcbiAgU3RhdGVHdWFyZCxcbiAgUnVudGltZSxcbiAgUHJvY2Vzc0tlZXBBbGl2ZVxuKSB7XG4gIHZhciBMb2cgPSBMb2dnZXIuY3JlYXRlKFwiQXBwXCIpO1xuXG4gIHZhciBBcHAgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChBcHAucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIHRoaXMuX2d1YXJkID0gbmV3IFN0YXRlR3VhcmQoW1wic3RhcnRpbmdcIiwgXCJzdGFydGVkXCIsIFwic3RvcHBpbmdcIiwgXCJzdG9wcGVkXCJdKTtcbiAgICAgIHRoaXMuX3Jhd0NvbmZpZyA9IG9wdHMuZ2V0T3JFcnJvcihcImNvbmZpZ3VyYXRpb25cIik7XG4gICAgICB0aGlzLl9jb25maWcgPSBPcHRpb25zLmZyb21PYmplY3QodGhpcy5fcmF3Q29uZmlnKTtcblxuICAgICAgLy8gVGhlIGRlZmF1bHQgUnVudGltZSBoYXMgc2Vuc2libGUgZGVmYXVsdHMuXG4gICAgICB0aGlzLl9ydW50aW1lID0gb3B0cy5nZXRPckVsc2VGbihcInJ1bnRpbWVcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBuZXcgUnVudGltZSgpO1xuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuX2tlZXBBbGl2ZSA9IG5ldyBQcm9jZXNzS2VlcEFsaXZlKHtcbiAgICAgICAgc2NoZWR1bGVyOiB0aGlzLl9ydW50aW1lLnNjaGVkdWxlcigpXG4gICAgICB9KTtcblxuICAgICAgdmFyIHVwICAgPSBvcHRzLmdldE9yRWxzZShcInVwXCIpLFxuICAgICAgICAgIGRvd24gPSBvcHRzLmdldE9yRWxzZShcImRvd25cIik7XG5cbiAgICAgIGlmICh1cCkge1xuICAgICAgICB0aGlzLnVwID0gUHJvbWlzZS5tZXRob2QoXy5iaW5kKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB1cC5jYWxsKHRoaXMsIHRoaXMuX2NvbmZpZyk7XG4gICAgICAgIH0sIHRoaXMpKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGRvd24pIHtcbiAgICAgICAgdGhpcy5kb3duID0gUHJvbWlzZS5tZXRob2QoXy5iaW5kKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBkb3duLmNhbGwodGhpcywgdGhpcy5fY29uZmlnKTtcbiAgICAgICAgfSwgdGhpcykpO1xuICAgICAgfVxuXG4gICAgfSxcblxuICAgIHN0YXJ0OiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbigpIHtcbiAgICAgIExvZy5kZWJ1ZyhcIlN0YXJ0aW5nIEFwcFwiKTtcbiAgICAgIHRoaXMuX2d1YXJkXG4gICAgICAgIC5kZW55KFwic3RhcnRpbmdcIilcbiAgICAgICAgLmFwcGx5KFwic3RhcnRpbmdcIik7XG5cbiAgICAgIHRoaXMuX2tlZXBBbGl2ZS5zdGFydCgpO1xuICAgICAgTG9nLmRlYnVnKFwiQ2FsbGluZyBBcHAjdXAoKVwiKTtcblxuICAgICAgcmV0dXJuIHRoaXMudXAoKVxuICAgICAgICAudGhlbih0aGlzLl9ndWFyZC5hcHBseUFzeW5jRm4oXCJzdGFydGVkXCIpKTtcbiAgICB9KSxcblxuICAgIHN0b3A6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKCkge1xuICAgICAgTG9nLmRlYnVnKFwiU3RvcHBpbmcgQXBwXCIpO1xuICAgICAgdGhpcy5fZ3VhcmRcbiAgICAgICAgLmRlbnkoXCJzdG9wcGluZ1wiKVxuICAgICAgICAuYXBwbHkoXCJzdG9wcGluZ1wiKTtcblxuICAgICAgdGhpcy5fa2VlcEFsaXZlLnN0b3AoKTtcbiAgICAgIExvZy5kZWJ1ZyhcIkNhbGxpbmcgQXBwI2Rvd24oKVwiKTtcblxuICAgICAgcmV0dXJuIHRoaXMuZG93bigpXG4gICAgICAgIC50aGVuKHRoaXMuX2d1YXJkLmFwcGx5QXN5bmNGbihcInN0b3BwZWRcIikpO1xuICAgIH0pLFxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgcmVxdWVzdGVkIGNvbmZpZ3VyYXRpb24gdmFsdWUsIG9yIHRocm93cyBhbiBlcnJvci5cbiAgICAgKiBAcGFyYW0ga2V5IHRoZSBjb25maWd1cmF0aW9uIGtleSByZXF1ZXN0IGZyb20gdGhlIENvbmZpZ3VyYXRpb24uXG4gICAgICogQHJldHVybnMge09iamVjdH1cbiAgICAgKi9cbiAgICBjb25maWc6IGZ1bmN0aW9uKGtleSkge1xuICAgICAgcmV0dXJuIHRoaXMuX2NvbmZpZy5nZXRPckVycm9yKGtleSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFRPRE86IERvYy4gU3ViY2xhc3Mgc2hvdWxkIG92ZXJyaWRlLlxuICAgICAqL1xuICAgIHVwOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbigpIHt9KSxcblxuICAgIC8qKlxuICAgICAqIFRPRE86IERvYy4gU3ViY2xhc3Mgc2hvdWxkIG92ZXJyaWRlLlxuICAgICAqL1xuICAgIGRvd246IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKCkge30pXG4gIH0pO1xuXG4gIHJldHVybiBBcHA7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJibHVlYmlyZFwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvbG9nZ2luZy9sb2dnZXJcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL29wdGlvbnNcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL3N0YXRlLWd1YXJkXCIpLFxuICByZXF1aXJlKFwiLi4vcnVudGltZVwiKSxcbiAgcmVxdWlyZShcIi4vaW50ZXJuYWwvcHJvY2Vzcy1rZWVwLWFsaXZlXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFByb21pc2UsXG4gIE0sXG4gIExvZ2dlcixcbiAgT3B0aW9ucyxcbiAgVVVJRCxcbiAgRGVsZWdhdGluZ0ZvcndhcmRpbmdTZXF1ZW5jZXIsXG4gIFVuaXRTZXF1ZW5jZXIsXG4gIEluTWVtb3J5RmliZXIsXG4gIE1haWxib3gsXG4gIERpc3BhdGNoZXIsXG4gIFNpZ25hbGluZ0RhdGFTdG9yZSxcbiAgUGVyaW9kaWMsXG4gIENsb2NrU2VxdWVuY2VyLFxuICBTeXN0ZW1DbG9jayxcbiAgUnVudGltZVxuICApIHtcblxuICB2YXIgRXhjaGFuZ2UgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICB2YXIgTVNHX1NFTkQgICAgICAgICAgICAgPSBFeGNoYW5nZS5NU0dfU0VORCAgICAgICAgICAgICA9IFwic2VuZFwiLFxuICAgICAgTVNHX1NFTkRfQU5EX1JFQ0VJVkUgPSBFeGNoYW5nZS5NU0dfU0VORF9BTkRfUkVDRUlWRSA9IFwic2VuZEFuZFJlY2VpdmVcIixcbiAgICAgIE1TR19SRVBMWSAgICAgICAgICAgID0gRXhjaGFuZ2UuTVNHX1JFUExZICAgICAgICAgICAgPSBcInJlcGx5XCI7XG5cbiAgLy8gNy41IHNlY29uZHMgaXMgcmVhc29uYWJsZSwgeWVzP1xuICB2YXIgREVGQVVMVF9SRVBMWV9USU1FT1VUID0gNzUwMDtcblxuICB2YXIgTG9nID0gTG9nZ2VyLmNyZWF0ZShcIkV4Y2hhbmdlXCIpO1xuXG5cbiAgXy5leHRlbmQoRXhjaGFuZ2UucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcblxuICAgICAgdGhpcy5faWRlbnRpdHkgPSBvcHRzLmdldE9yRWxzZShcImlkZW50aXR5XCIsIFVVSUQudjQoKSk7XG5cbiAgICAgIHRoaXMuX3J1bnRpbWUgPSBvcHRzLmdldE9yRWxzZUZuKFwicnVudGltZVwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSdW50aW1lKCk7XG4gICAgICB9KTtcblxuICAgICAgdGhpcy5fbWFpbGJveEZpYmVyRGVsZWdhdGUgPSB7XG4gICAgICAgIHJlY2VpdmVGaWJlck1lc3NhZ2U6IHRoaXMuX3JlY2VpdmVNYWlsYm94RmliZXJNZXNzYWdlLmJpbmQodGhpcylcbiAgICAgIH07XG5cbiAgICAgIHRoaXMuX21haWxib3hlcyA9IE0uaGFzaF9tYXAoKTtcblxuICAgICAgdGhpcy5fZmliZXIgICAgID0gb3B0cy5nZXRPckVsc2VGbihcImZpYmVyXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gbmV3IEluTWVtb3J5RmliZXIoKTtcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLl9maWJlci5yZWdpc3RlckVudGl0eSh7XG4gICAgICAgIGlkZW50aXR5OiB0aGlzLl9pZGVudGl0eSxcbiAgICAgICAgZGVsZWdhdGU6IHRoaXNcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLl9tYWlsYm94RGlzcGF0Y2hlciA9IG5ldyBEaXNwYXRjaGVyKHtcbiAgICAgICAgZGVsZWdhdGU6IHRoaXMsXG4gICAgICAgIHByZWZpeDogXCJfb25NYnhcIlxuICAgICAgfSk7XG5cbiAgICAgIHZhciB1c2VkRGVmYXVsdENsb2NrID0gZmFsc2U7XG5cbiAgICAgIC8vIEZvciByZXF1ZXN0ZXItcHJvdmlkZWQgcmVxdWVzdElkIHRvIG1lc3NhZ2VJZCBtYXBwaW5nLlxuICAgICAgLy8gVXNlZCBmb3IgY2FuY2VsbGluZyBvdXRzdGFuZGluZyBzZW5kQW5kUmVjZWl2ZSByZXF1ZXN0cy5cbiAgICAgIHRoaXMuX3JlcVRvTXNnID0gTS5oYXNoX21hcCgpO1xuXG4gICAgICAvLyBEYXRhIHN0b3JlIGZvciBwZW5kaW5nIHJlcXVlc3RzXG4gICAgICB0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RzID0gbmV3IFNpZ25hbGluZ0RhdGFTdG9yZSh7XG4gICAgICAgIHR0bDogb3B0cy5nZXRPckVsc2UoXCJyZXBseVRpbWVvdXRcIiwgREVGQVVMVF9SRVBMWV9USU1FT1VUKSxcbiAgICAgICAgc2VxdWVuY2VyOiBuZXcgQ2xvY2tTZXF1ZW5jZXIoe1xuICAgICAgICAgIGNsb2NrOiBvcHRzLmdldE9yRWxzZUZuKFwiY2xvY2tcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB1c2VkRGVmYXVsdENsb2NrID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybiBuZXcgU3lzdGVtQ2xvY2soKTtcbiAgICAgICAgICB9KSxcbiAgICAgICAgICAvLyBIYXggLSBTaW5jZSB3ZSB3YW50IHRpbWUgdG8gYmUgYXN5bmMsIGJ1dCBwcm92aWRlIGEgZGVmYXVsdCBzeXN0ZW0gY2xvY2tcbiAgICAgICAgICAvLyB3ZSBuZWVkIHRvIGdldCB0aGUgaW5pdGlhbCBjbG9jayBzZXF1ZW5jZSBzeW5jLCBieSBieXBhc3NpbmcgdGhlIGNsb2NrIGNhbGwuXG4gICAgICAgICAgLy8gSWYgeW91IHByb3ZpZGUgYW4gYXN5bmMgY2xvY2ssIHlvdSBzaG91bGQgZWl0aGVyIHByb3ZpZGUgYW4gaW5pdGlhbCB0aW1lLCBvclxuICAgICAgICAgIC8vIGVuc3VyZSB0aGF0IHRoZSBmaXJzdCBnZXRUaW1lIGhhcyByZXNvbHZlZCBiZWZvcmUgaW5zdGFudGlhdGluZyB0aGUgZXhjaGFuZ2UuXG4gICAgICAgICAgLy8gT1IsIGluIHRoZSBmdXR1cmUsIHdlIGhhdmUgdG8gYWRkIGEgc3RhcnQoKS9zdG9wKCkgdG8gRXhjaGFuZ2UuXG4gICAgICAgICAgaW5pdGlhbFNlcXVlbmNlOiBvcHRzLmdldE9yRWxzZShcImluaXRpYWxTZXF1ZW5jZVwiLCAodXNlZERlZmF1bHRDbG9jayA/ICtuZXcgRGF0ZSgpIDogdW5kZWZpbmVkKSlcbiAgICAgICAgfSlcbiAgICAgIH0pO1xuXG4gICAgICAvLyBEaXNwYXRjaGVzIHN0b3JlIHNpZ25hbHMgKGUuZy4sIGV4cGlyeSlcbiAgICAgIHRoaXMuX2V4cGlyeURpc3BhdGNoZXIgPSBuZXcgRGlzcGF0Y2hlcih7XG4gICAgICAgIGRlbGVnYXRlOiB0aGlzLFxuICAgICAgICBwcmVmaXg6IFwiX29uU3RvcmVTaWduYWxcIixcbiAgICAgICAgbGlzdGVuOiB0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RzLnNpZ25hbENoYW5uZWwoKVxuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuX2NvbXBvc2l0ZVNlcSA9IG5ldyBEZWxlZ2F0aW5nRm9yd2FyZGluZ1NlcXVlbmNlcih7XG4gICAgICAgIGRlbGVnYXRlOiBuZXcgVW5pdFNlcXVlbmNlcigpLFxuICAgICAgICB0YXJnZXRzOiBbdGhpcy5fb3V0c3RhbmRpbmdSZXF1ZXN0cy5zZXF1ZW5jZXIoKSwgdGhpcy5fb3V0c3RhbmRpbmdSZXF1ZXN0cy5zZW50cnlTZXF1ZW5jZXIoKV1cbiAgICAgIH0pXG5cbiAgICAgIC8vIFRoaXMgZ3V5IHRyaWdnZXJzIHBlcmlvZGljIGV4cGlyeSBjaGVja3MgaW4gdGhlIHN0b3JlXG4gICAgICB0aGlzLl9jaGVja0V4cGlyeSA9IG5ldyBQZXJpb2RpYyh7XG4gICAgICAgIHNjaGVkdWxlcjogdGhpcy5fcnVudGltZS5zY2hlZHVsZXIoKSxcbiAgICAgICAgdGFzazogXy5iaW5kKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLl9jb21wb3NpdGVTZXEuYWR2YW5jZSgpO1xuICAgICAgICB9LCB0aGlzKSxcbiAgICAgICAgaW50ZXJ2YWw6IG9wdHMuZ2V0T3JFbHNlKFwiZXhwaXJ5SW50ZXJ2YWxcIiwgMTAwMClcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLl9jaGVja0V4cGlyeS5zdGFydCgpO1xuICAgIH0sXG5cblxuICAgIGRpc3Bvc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgLy8gVE9ETzogQ2FuY2VsIG91dHN0YW5kaW5nIHJlcXVlc3RzXG5cbiAgICAgIHRoaXMuX2V4cGlyeURpc3BhdGNoZXIuZGlzcG9zZSgpO1xuXG4gICAgICB0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RzLmNsZWFyKCk7XG5cbiAgICAgIC8vIFRPRE86IERpc3Bvc2UgYWxsIHRoZSB0aGluZ3NcbiAgICAgIHRoaXMuX2NoZWNrRXhwaXJ5LmRpc3Bvc2UoKTtcbiAgICB9LFxuXG5cbiAgICAvKipcbiAgICAgKiBCdWlsZHMgYSBNYWlsYm94IGZvciB0aGUgcHJvdmlkZWQgYHJlcXVlc3RlcklkZW50aXR5YC4gVGhlXG4gICAgICogYFJlcXVlc3RlcklkZW50aXR5YCBtdXN0IG5ldmVyIGhhdmUgYmVlbiB1c2VkIGZvciByZXF1ZXN0aW5nXG4gICAgICogYSBtYWlsYm94IHByZXZpb3VzbHkuXG4gICAgICpcbiAgICAgKiBXZSBhdHRlbXB0IHRvIHZhbGlkYXRlIHVuaXF1ZSBtYWlsYm94IG5hbWVzLCBidXQgYmVjYXVzZSBtYWlsYm94IG5hbWVzXG4gICAgICogYXJlIGdsb2JhbCBhbmQgdGhlcmUgaXMgbm8gY2hlY2tpbmcgYmV0d2VlbiBmaWJlcnMsIGl0J3Mgb25seSBhIGJlc3QtZWZmb3J0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHJlcXVlc3RlcklkZW50aXR5XG4gICAgICogQHJldHVybnMge01haWxib3h9XG4gICAgICovXG4gICAgbWFpbGJveDogZnVuY3Rpb24ocmVxdWVzdGVySWRlbnRpdHkpIHtcbiAgICAgIHRoaXMuX2Fzc2VydFVuaXF1ZU93bmVyKHJlcXVlc3RlcklkZW50aXR5KTtcblxuICAgICAgdmFyIG1haWxib3ggPSBuZXcgTWFpbGJveCh7XG4gICAgICAgIGV4Y2hhbmdlOiAgICAgIHRoaXMsXG4gICAgICAgIG93bmVySWRlbnRpdHk6IHJlcXVlc3RlcklkZW50aXR5XG4gICAgICB9KTtcblxuICAgICAgdGhpcy5fbWFpbGJveGVzID0gTS5hc3NvYyh0aGlzLl9tYWlsYm94ZXMsIHJlcXVlc3RlcklkZW50aXR5LCBtYWlsYm94KTtcblxuICAgICAgdGhpcy5fZmliZXIucmVnaXN0ZXJFbnRpdHkoe1xuICAgICAgICBpZGVudGl0eTogcmVxdWVzdGVySWRlbnRpdHksXG4gICAgICAgIGRlbGVnYXRlOiB0aGlzLl9tYWlsYm94RmliZXJEZWxlZ2F0ZVxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBtYWlsYm94O1xuICAgIH0sXG5cblxuICAgIHNlbmQ6IGZ1bmN0aW9uKGVudikge1xuICAgICAgZW52ID0gT3B0aW9ucy5mcm9tT2JqZWN0KGVudik7XG5cbiAgICAgIHJldHVybiB0aGlzLl9maWJlci5zZW5kKHtcbiAgICAgICAgZnJvbTogIGVudi5nZXRPckVycm9yKFwiZnJvbVwiKSxcbiAgICAgICAgdG86ICAgIGVudi5nZXRPckVycm9yKFwidG9cIiksXG4gICAgICAgIGJvZHk6ICBlbnYuZ2V0T3JFcnJvcihcImJvZHlcIiksXG4gICAgICAgIG1UOiAgICBNU0dfU0VORCxcbiAgICAgICAgbXNnSWQ6IFVVSUQudjQoKVxuICAgICAgfSk7XG4gICAgfSxcblxuXG4gICAgcmVwbHk6IGZ1bmN0aW9uKGVudikge1xuICAgICAgZW52ID0gT3B0aW9ucy5mcm9tT2JqZWN0KGVudik7XG4gICAgICByZXR1cm4gdGhpcy5fZmliZXIuc2VuZCh7XG4gICAgICAgIGZyb206ICAgZW52LmdldE9yRXJyb3IoXCJmcm9tXCIpLFxuICAgICAgICB0bzogICAgIGVudi5nZXRPckVycm9yKFwidG9cIiksXG4gICAgICAgIGJvZHk6ICAgZW52LmdldE9yRXJyb3IoXCJib2R5XCIpLFxuICAgICAgICBtVDogICAgIE1TR19SRVBMWSxcbiAgICAgICAgbXNnSWQ6ICBVVUlELnY0KCksXG4gICAgICAgIHJNc2dJZDogZW52LmdldE9yRXJyb3IoXCJyTXNnSWRcIilcbiAgICAgIH0pO1xuICAgIH0sXG5cblxuICAgIHNlbmRBbmRSZWNlaXZlOiBmdW5jdGlvbihlbnYsIG9wdHMpIHtcbiAgICAgIGVudiAgPSBPcHRpb25zLmZyb21PYmplY3QoZW52KTtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG5cbiAgICAgIHZhciBtc2dJZCA9IFVVSUQudjQoKSxcbiAgICAgICAgICByZXFJZCAgICA9IG9wdHMuZ2V0T3JFcnJvcihcInJlcUlkXCIpLFxuICAgICAgICAgIGRlZmVycmVkID0gZGVmZXIoKSxcbiAgICAgICAgICBmaWJFbnYgICA9IHtcbiAgICAgICAgICAgIGZyb206ICBlbnYuZ2V0T3JFcnJvcihcImZyb21cIiksXG4gICAgICAgICAgICB0bzogICAgZW52LmdldE9yRXJyb3IoXCJ0b1wiKSxcbiAgICAgICAgICAgIGJvZHk6ICBlbnYuZ2V0T3JFcnJvcihcImJvZHlcIiksXG4gICAgICAgICAgICBtVDogICAgTVNHX1NFTkRfQU5EX1JFQ0VJVkUsXG4gICAgICAgICAgICBtc2dJZDogbXNnSWRcbiAgICAgICAgICB9LFxuICAgICAgICAgIHJlcSAgICAgID0ge1xuICAgICAgICAgICAgcmVxSWQ6ICAgIHJlcUlkLFxuICAgICAgICAgICAgZGVmZXJyZWQ6IGRlZmVycmVkLFxuICAgICAgICAgICAgZmliRW52OiAgIGZpYkVudlxuICAgICAgICAgIH07XG5cbiAgICAgIHRoaXMuX3JlcVRvTXNnID0gTS5hc3NvYyh0aGlzLl9yZXFUb01zZywgcmVxSWQsIG1zZ0lkKTtcblxuICAgICAgcmV0dXJuIHRoaXNcbiAgICAgICAgLl9vdXRzdGFuZGluZ1JlcXVlc3RzXG4gICAgICAgIC5wdXQobXNnSWQsIHJlcSwge3R0bDogb3B0cy5nZXRPckVsc2UoXCJyZXBseVRpbWVvdXRcIil9KVxuICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fZmliZXIuc2VuZChmaWJFbnYpO1xuICAgICAgICB9KVxuICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gcmVxLmRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBjYW5jZWxTZW5kQW5kUmVjZWl2ZTogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24ocmVxSWQpIHtcbiAgICAgIHZhciBtc2dJZCA9IE0uZ2V0KHRoaXMuX3JlcVRvTXNnLCByZXFJZCk7XG5cbiAgICAgIGlmIChtc2dJZCkge1xuICAgICAgICBMb2cuZGVidWcoXCJDYW5jZWxpbmcgcmVxdWVzdFwiLCByZXFJZCwgXCJ3aXRoIG1zZ0lkXCIsIG1zZ0lkKTtcbiAgICAgICAgdGhpcy5fcmVxVG9Nc2cgPSBNLmRpc3NvYyh0aGlzLl9yZXFUb01zZywgcmVxSWQpO1xuXG4gICAgICAgIHJldHVybiBQcm9taXNlXG4gICAgICAgICAgLmJpbmQodGhpcylcbiAgICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RzLnJlbW92ZShtc2dJZCk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXEpIHtcbiAgICAgICAgICAgIGlmIChyZXEpIHtcbiAgICAgICAgICAgICAgcmVxLmRlZmVycmVkLnJlamVjdChuZXcgUHJvbWlzZS5DYW5jZWxsYXRpb25FcnJvcigpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgTG9nLndhcm4oXCJUcmllZCB0byBjYW5jZWwgcmVxdWVzdCwgYnV0IG5vIG91c3RhbmRpbmcgcmVxdWVzdCB3aXRoIHRoYXQgSUQgZm91bmQ7XCIsIHJlcUlkKTtcbiAgICAgIH1cbiAgICB9KSxcblxuXG4gICAgX2Fzc2VydFVuaXF1ZU93bmVyOiBmdW5jdGlvbihpZGVudGl0eSkge1xuICAgICAgaWYgKE0uZ2V0KHRoaXMuX21haWxib3hlcywgaWRlbnRpdHkpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIk1haWxib3ggcmVnaXN0cmF0aW9uIHJlcXVpcmVzIGEgdW5pcXVlIGlkZW50aXR5XCIpO1xuICAgICAgfVxuICAgIH0sXG5cblxuICAgIC8qKlxuICAgICAqIEZpYmVyIGRlbGVnYXRlIHByb3RvY29sIG1ldGhvZCBmb3IgYSBtZXNzYWdlIGJvdW5kIGZvciBhIE1haWxib3ggb3duZWQgYnlcbiAgICAgKiB0aGlzIGV4Y2hhbmdlLlxuICAgICAqXG4gICAgICogQHBhcmFtIGVudlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3JlY2VpdmVNYWlsYm94RmliZXJNZXNzYWdlOiBmdW5jdGlvbihlbnYpIHtcbiAgICAgIHRoaXMuX21haWxib3hEaXNwYXRjaGVyLmRpc3BhdGNoKGVudik7XG4gICAgfSxcblxuXG4gICAgX29uTWJ4U2VuZDogZnVuY3Rpb24oZW52KSB7XG4gICAgICB2YXIgb0VudiAgICAgPSBPcHRpb25zLmZyb21PYmplY3QoZW52KSxcbiAgICAgICAgICBpZGVudGl0eSA9IG9FbnYuZ2V0T3JFbHNlKFwidG9cIiksXG4gICAgICAgICAgYm9keSAgICAgPSBvRW52LmdldE9yRWxzZShcImJvZHlcIik7XG5cbiAgICAgIGlmICghKGlkZW50aXR5IHx8IGJvZHkpKSB7XG4gICAgICAgIExvZy5pbmZvKFwiRXhjaGFuZ2UgcmVjZWl2ZWQgYSBtZXNzYWdlIHdpdGggbWlzc2luZyBlbnZlbG9wZSBpbmZvcm1hdGlvblwiLCBlbnYpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciBtYm94ID0gTS5nZXQodGhpcy5fbWFpbGJveGVzLCBpZGVudGl0eSk7XG4gICAgICBpZiAobWJveCkge1xuICAgICAgICBtYm94Ll9yZWNlaXZlT25lU2hvdChlbnYpO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyBUT0RPOiBTaG91bGQgdGhpcyBnbyBhbG9uZyB0aGUgbWFpbGJveCBpbmdyZXNzIGNoYW5uZWw/XG4gICAgLy8gT3Igc2hvdWxkIGl0IGJlIGNiLWJhc2VkP1xuICAgIF9vbk1ieFNlbmRBbmRSZWNlaXZlOiBmdW5jdGlvbihlbnYpIHtcbiAgICAgIHZhciBvRW52ID0gT3B0aW9ucy5mcm9tT2JqZWN0KGVudiksXG4gICAgICAgICAgaWRlbnRpdHkgPSBvRW52LmdldE9yRWxzZShcInRvXCIpLFxuICAgICAgICAgIGJvZHkgPSBvRW52LmdldE9yRWxzZShcImJvZHlcIik7XG5cbiAgICAgIGlmICghKGlkZW50aXR5IHx8IGJvZHkpKSB7XG4gICAgICAgIExvZy5pbmZvKFwiRXhjaGFuZ2UgcmVjZWl2ZWQgYSBtZXNzYWdlIHdpdGggbWlzc2luZyBlbnZlbG9wZSBpbmZvcm1hdGlvblwiLCBlbnYpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciBtYm94ID0gTS5nZXQodGhpcy5fbWFpbGJveGVzLCBpZGVudGl0eSk7XG4gICAgICBpZiAobWJveCkge1xuICAgICAgICBtYm94Ll9yZWNlaXZlUmVxdWVzdFJlcGx5KGVudik7XG4gICAgICB9XG4gICAgfSxcblxuXG4gICAgX29uTWJ4UmVwbHk6IGZ1bmN0aW9uKGVudikge1xuICAgICAgdmFyIG9FbnYgICAgID0gT3B0aW9ucy5mcm9tT2JqZWN0KGVudiksXG4gICAgICAgICAgck1zZ0lkICAgPSBvRW52LmdldE9yRWxzZShcInJNc2dJZFwiKTtcblxuXG5cbiAgICAgIC8vIERvbid0IGRpc3BhdGNoIHZldHRlZCByZXBsaWVzLiBKdXN0IGZ1bGZpbGwgdGhlIHByb21pc2VcbiAgICAgIFByb21pc2VcbiAgICAgICAgLmJpbmQodGhpcylcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oKXtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fb3V0c3RhbmRpbmdSZXF1ZXN0cy5yZW1vdmUock1zZ0lkKTtcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVxdWVzdCkge1xuICAgICAgICAgIGlmIChyZXF1ZXN0KSB7XG4gICAgICAgICAgICB0aGlzLl9yZXFUb01zZyA9IE0uZGlzc29jKHRoaXMuX3JlcVRvTXNnLCByZXF1ZXN0LnJlcUlkKTtcbiAgICAgICAgICAgIHJlcXVlc3QuZGVmZXJyZWQucmVzb2x2ZShlbnYpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSxcblxuXG4gICAgLyoqXG4gICAgICogRmlyZWQgd2hlbiBhIHJlcXVlc3QgaW4gdGhlIG91dHN0YW5kaW5nIHJlcXVlc3RzIHN0b3JlIGlzIHBhc3QgZHVlLlxuICAgICAqL1xuICAgIF9vblN0b3JlU2lnbmFsRXhwaXJlZDogZnVuY3Rpb24oc2lnKSB7XG4gICAgICBMb2cuZGVidWcoXCJFeHBpcmVkIGVudHJ5IGluIHN0b3JlXCIsIHNpZyk7XG4gICAgICBQcm9taXNlXG4gICAgICAgIC5iaW5kKHRoaXMpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RzLnJlbW92ZShzaWcua2V5KTtcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVxdWVzdCkge1xuICAgICAgICAgIGlmIChyZXF1ZXN0KSB7XG4gICAgICAgICAgICB0aGlzLl9yZXFUb01zZyA9IE0uZGlzc29jKHRoaXMuX3JlcVRvTXNnLCByZXF1ZXN0LnJlcUlkKTtcbiAgICAgICAgICAgIHJlcXVlc3QuZGVmZXJyZWQucmVqZWN0KG5ldyBQcm9taXNlLlRpbWVvdXRFcnJvcigpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0sXG5cblxuICAgIC8qKlxuICAgICAqIEZpYmVyIGRlbGVnYXRlIHByb3RvY29sIG1ldGhvZCBmb3IgYSBtZXNzYWdlIGJvdW5kIGZvciB0aGlzIEV4Y2hhbmdlIGRpcmVjdGx5LlxuICAgICAqXG4gICAgICogQHBhcmFtIGVudlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgcmVjZWl2ZUZpYmVyTWVzc2FnZTogZnVuY3Rpb24oZW52KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJOb3QgaW1wbGVtZW50ZWRcIik7XG4gICAgfVxuICB9KTtcblxuXG4gIHZhciBkZWZlciA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIHJlcywgcmVqO1xuICAgIHZhciBwID0gbmV3IFByb21pc2UoZnVuY3Rpb24oKSB7XG4gICAgICByZXMgPSBhcmd1bWVudHNbMF07XG4gICAgICByZWogPSBhcmd1bWVudHNbMV07XG4gICAgfSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgcHJvbWlzZTogcCxcbiAgICAgIHJlc29sdmU6IHJlcyxcbiAgICAgIHJlamVjdDogcmVqXG4gICAgfTtcbiAgfTtcblxuICByZXR1cm4gRXhjaGFuZ2U7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJibHVlYmlyZFwiKSxcbiAgcmVxdWlyZShcIm1vcmlcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL2xvZ2dpbmcvbG9nZ2VyXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9vcHRpb25zXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS91dWlkXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9zZXF1ZW5jZXIvZGVsZWdhdGluZy1mb3J3YXJkaW5nLXNlcXVlbmNlclwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvc2VxdWVuY2VyL3VuaXQtc2VxdWVuY2VyXCIpLFxuICByZXF1aXJlKFwiLi9maWJlci9pbi1tZW1vcnktZmliZXJcIiksXG4gIHJlcXVpcmUoXCIuL2ludGVybmFscy9tYWlsYm94XCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9kaXNwYXRjaGVyXCIpLFxuICByZXF1aXJlKFwiLi4vc3RvcmFnZS9zaWduYWxpbmctZGF0YS1zdG9yZVwiKSxcbiAgcmVxdWlyZShcIi4uL3V0aWwvcGVyaW9kaWNcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL3NlcXVlbmNlci9jbG9jay1zZXF1ZW5jZXJcIiksXG4gIHJlcXVpcmUoXCIuLi90aW1lL2Nsb2NrL3N5c3RlbS1jbG9ja1wiKSxcbiAgcmVxdWlyZShcIi4uL3J1bnRpbWVcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgUHJvbWlzZSxcbiAgTSxcbiAgT3B0aW9ucyxcbiAgVVVJRCxcbiAgU3RhdGVHdWFyZCxcbiAgTG9nZ2VyLFxuICBEaXNwYXRjaGVyXG4pIHtcblxuICB2YXIgQ291cmllciA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIHZhciBNU0dfUkVQTFkgPSBDb3VyaWVyLk1TR19SRVBMWSA9IFwiY1JlcGx5XCI7XG5cbiAgdmFyIExvZyA9IExvZ2dlci5jcmVhdGUoXCJDb3VyaWVyXCIpO1xuXG4gIF8uZXh0ZW5kKENvdXJpZXIucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcblxuICAgICAgdGhpcy5faWQgICAgICAgICA9IFVVSUQudjQoKTtcbiAgICAgIHRoaXMuX2RlbGVnYXRlICAgPSBvcHRzLmdldE9yRXJyb3IoXCJkZWxlZ2F0ZVwiKTtcbiAgICAgIHRoaXMuX21haWxib3ggICAgPSBvcHRzLmdldE9yRXJyb3IoXCJtYWlsYm94XCIpO1xuICAgICAgdGhpcy5fc3RhdGVHdWFyZCA9IG5ldyBTdGF0ZUd1YXJkKFtcImRpc3Bvc2VkXCJdKTtcblxuICAgICAgXy5iaW5kQWxsKHRoaXMsIFwiX29uT25lU2hvdE1lc3NhZ2VcIiwgXCJfb25SZXF1ZXN0UmVwbHlNZXNzYWdlXCIsIFwiX2RlZmF1bHRDb250ZXh0RGVsZWdhdGVcIik7XG5cbiAgICAgIHRoaXMuX2NvbnRleHREZWxlZ2F0ZSA9IG9wdHMuZ2V0T3JFbHNlKFwiY29udGV4dERlbGVnYXRlXCIsIHRoaXMuX2RlZmF1bHRDb250ZXh0RGVsZWdhdGUpO1xuXG4gICAgICB0aGlzLl9vbmVTaG90RGlzcGF0Y2hlciA9IG5ldyBEaXNwYXRjaGVyKHtcbiAgICAgICAgZGVsZWdhdGU6IHRoaXMuX2RlbGVnYXRlLFxuICAgICAgICBwcmVmaXg6IG9wdHMuZ2V0T3JFbHNlKFwib25lU2hvdFByZWZpeFwiLCBcIm9uTXNnXCIpLFxuICAgICAgICBjb250ZXh0RGVsZWdhdGU6IHRoaXMuX2NvbnRleHREZWxlZ2F0ZVxuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuX3JlcXVlc3RSZXBseURpc3BhdGNoZXIgPSBuZXcgRGlzcGF0Y2hlcih7XG4gICAgICAgIGRlbGVnYXRlOiB0aGlzLl9kZWxlZ2F0ZSxcbiAgICAgICAgcHJlZml4OiBvcHRzLmdldE9yRWxzZShcInJlcXVlc3RSZXBseVByZWZpeFwiLCBcIm9uUmVxXCIpLFxuICAgICAgICBjb250ZXh0RGVsZWdhdGU6IHRoaXMuX2NvbnRleHREZWxlZ2F0ZVxuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuX3N1YnMgPSBNLnZlY3RvcihcbiAgICAgICAgdGhpcy5fbWFpbGJveC5vbmVTaG90Q2hhbm5lbCgpLnN1YnNjcmliZSh0aGlzLl9vbk9uZVNob3RNZXNzYWdlKSxcbiAgICAgICAgdGhpcy5fbWFpbGJveC5yZXF1ZXN0UmVwbHlDaGFubmVsKCkuc3Vic2NyaWJlKHRoaXMuX29uUmVxdWVzdFJlcGx5TWVzc2FnZSlcbiAgICAgICk7XG4gICAgfSxcblxuXG4gICAgaWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2lkO1xuICAgIH0sXG5cbiAgICBzZW5kOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbih0bywgbXNnKSB7XG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkLmRlbnkoXCJkaXNwb3NlZFwiKTtcblxuICAgICAgcmV0dXJuIHRoaXMuX21haWxib3guc2VuZCh7XG4gICAgICAgIHRvOiB0byxcbiAgICAgICAgYm9keTogbXNnXG4gICAgICB9KTtcbiAgICB9KSxcblxuICAgIHNlbmRBbmRSZWNlaXZlOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbih0bywgbXNnLCBvcHRzKSB7XG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkLmRlbnkoXCJkaXNwb3NlZFwiKTtcblxuICAgICAgcmV0dXJuIHRoaXMuX21haWxib3hcbiAgICAgICAgLnNlbmRBbmRSZWNlaXZlKHtcbiAgICAgICAgICB0bzogdG8sXG4gICAgICAgICAgYm9keTogbXNnXG4gICAgICAgIH0sIG9wdHMpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlcykge1xuXG4gICAgICAgICAgaWYgKHJlcy5ib2R5ICYmIHJlcy5ib2R5Lm1UID09PSBNU0dfUkVQTFkgJiYgcmVzLmJvZHkuYm9keSkge1xuICAgICAgICAgICAgLy8gVW53cmFwIHRoZSByZW1vdGUgbWVzc2FnZVxuICAgICAgICAgICAgaWYgKHJlcy5ib2R5LmJvZHkuZXJyKSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihyZXMuYm9keS5ib2R5LmVycik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzLmJvZHkuYm9keS5yZXM7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIFNvbWVvbmUgaXMgbWlzYmVoYXZpbmdcbiAgICAgICAgICAgIExvZy53YXJuKFwiUmVjZWl2ZWQgc2VuZEFuZFJlY2VpdmUgcmVwbHksIGJ1dCBpdCBpc24ndCBDb3VyaWVyLWNvbXBhdGlibGVcIiwgdGhpcy5fbWFpbGJveC5vd25lcklkZW50aXR5KCksIHJlcyk7XG4gICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9KSxcblxuICAgIGRpc3Bvc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHRoaXMuX3N0YXRlR3VhcmQuYXBwbGllZChcImRpc3Bvc2VkXCIpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuXG4gICAgICBNLmVhY2godGhpcy5fc3VicywgZnVuY3Rpb24oc3ViKSB7XG4gICAgICAgIHN1Yi5kaXNwb3NlKCk7XG4gICAgICB9KTtcblxuICAgICAgdGhpcy5fc3VicyAgICAgPSBudWxsO1xuICAgICAgdGhpcy5fbWFpbGJveCAgPSBudWxsO1xuICAgICAgdGhpcy5fZGVsZWdhdGUgPSBudWxsO1xuXG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkLmFwcGx5KFwiZGlzcG9zZWRcIik7XG4gICAgfSxcblxuICAgIF9kZWZhdWx0Q29udGV4dERlbGVnYXRlOiBmdW5jdGlvbihtVHlwZWQpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG1haWxib3g6IHRoaXMuX21haWxib3hcbiAgICAgIH07XG4gICAgfSxcblxuICAgIF9vbk9uZVNob3RNZXNzYWdlOiBmdW5jdGlvbihtc2cpIHtcbiAgICAgIHRoaXMuX29uZVNob3REaXNwYXRjaGVyLmRpc3BhdGNoKG1zZy5ib2R5LCBtc2cpO1xuICAgIH0sXG5cblxuICAgIF9vblJlcXVlc3RSZXBseU1lc3NhZ2U6IGZ1bmN0aW9uKG1zZykge1xuICAgICAgdGhpcy5fcmVxdWVzdFJlcGx5RGlzcGF0Y2hlclxuICAgICAgICAuZGlzcGF0Y2hBc3luYyhtc2cuYm9keSwgbXNnKVxuICAgICAgICAuYmluZCh7XG4gICAgICAgICAgbWJveDogdGhpcy5fbWFpbGJveCxcbiAgICAgICAgICBlcnI6IG51bGwsXG4gICAgICAgICAgcmVzdWx0OiBudWxsXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XG4gICAgICAgICAgdGhpcy5yZXN1bHQgPSByZXN1bHQ7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXVnaHQoZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgdGhpcy5lcnIgPSBlcnIubWVzc2FnZTtcbiAgICAgICAgfSlcbiAgICAgICAgLmxhc3RseShmdW5jdGlvbigpIHtcbiAgICAgICAgICB0aGlzLm1ib3gucmVwbHkobXNnLm1zZ0lkLCB7XG4gICAgICAgICAgICB0bzogbXNnLmZyb20sXG4gICAgICAgICAgICBib2R5OiB7XG4gICAgICAgICAgICAgIG1UOiBNU0dfUkVQTFksXG4gICAgICAgICAgICAgIGJvZHk6IHtcbiAgICAgICAgICAgICAgICBlcnI6IHRoaXMuZXJyLFxuICAgICAgICAgICAgICAgIHJlczogdGhpcy5yZXN1bHRcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBDb3VyaWVyO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiYmx1ZWJpcmRcIiksXG4gIHJlcXVpcmUoXCJtb3JpXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9vcHRpb25zXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS91dWlkXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9zdGF0ZS1ndWFyZFwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvbG9nZ2luZy9sb2dnZXJcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL2Rpc3BhdGNoZXJcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qKlxuICogRXhwb3J0cyBhIHNpbmdsZXRvblxuICovXG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgX1xuKSB7XG5cbiAgdmFyIFVVSUQgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChVVUlELnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKCkge30sXG4gICAgLy8gU2VlOiBodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL1VuaXZlcnNhbGx5X3VuaXF1ZV9pZGVudGlmaWVyI1ZlcnNpb25fNF8uMjhyYW5kb20uMjlcbiAgICB2NDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gJ3h4eHh4eHh4LXh4eHgtNHh4eC15eHh4LXh4eHh4eHh4eHh4eCcucmVwbGFjZSgvW3h5XS9nLCBmdW5jdGlvbihjKSB7XG4gICAgICAgIHZhciByID0gTWF0aC5yYW5kb20oKSAqIDE2IHwgMDtcbiAgICAgICAgLy8gMHgzICAgICAgID0gMGIwMDAxMVxuICAgICAgICAvLyAweDggICAgICAgPSAwYjAxMDAwXG4gICAgICAgIC8vIDB4MyB8IDB4OCA9IDBiMDEwMTFcbiAgICAgICAgLy8gciAmIDB4MyAgID0gKDBiMDAwMDAgfCAwYjAwMDAxIHwgMGIwMDAxMCB8IDBiMDAwMTEpXG4gICAgICAgIHZhciB2ID0gKGMgPT0gJ3gnID8gciA6IChyICYgMHgzIHwgMHg4KSk7XG4gICAgICAgIHJldHVybiB2LnRvU3RyaW5nKDE2KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIG5ldyBVVUlEKCk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgT3B0aW9uc1xuKSB7XG5cbiAgdmFyIENvbXBvbmVudFJlZ2lzdHJ5ID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoQ29tcG9uZW50UmVnaXN0cnkucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9tb2R1bGVzID0ge307XG4gICAgfSxcblxuXG4gICAgcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB2YXIgYWxpYXNlcyAgID0gb3B0cy5nZXRPckVycm9yKFwiYXNcIiksXG4gICAgICAgICAgbW9kT2JqZWN0ID0gb3B0cy5nZXRPckVycm9yKFwibW9kdWxlXCIpO1xuXG4gICAgICBpZiAoIV8uaXNBcnJheShhbGlhc2VzKSkge1xuICAgICAgICBhbGlhc2VzID0gWyBhbGlhc2VzIF07XG4gICAgICB9XG5cbiAgICAgIF8uZWFjaChhbGlhc2VzLCBfLmJpbmQoZnVuY3Rpb24oYWxpYXMpIHtcbiAgICAgICAgdGhpcy5fbW9kdWxlc1thbGlhc10gPSBtb2RPYmplY3Q7XG4gICAgICB9LCB0aGlzKSk7XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbiAgICBzZWxmUmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG5cbiAgICAgIHJldHVybiB0aGlzLnJlZ2lzdGVyKHtcbiAgICAgICAgYXM6IG9wdHMuZ2V0T3JFcnJvcihcImFzXCIpLFxuICAgICAgICBtb2R1bGU6IENvbXBvbmVudFJlZ2lzdHJ5XG4gICAgICB9KTtcbiAgICB9LFxuXG5cbiAgICByZWdpc3Rlck1hbnk6IGZ1bmN0aW9uKGFsaWFzZXNBcnkpIHtcbiAgICAgIF8uZWFjaChhbGlhc2VzQXJ5LCBfLmJpbmQoZnVuY3Rpb24oYWxpYXMpIHtcbiAgICAgICAgdGhpcy5yZWdpc3RlcihhbGlhcyk7XG4gICAgICB9LCB0aGlzKSk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gICAgY29tcG9uZW50OiBmdW5jdGlvbihhbGlhcykge1xuICAgICAgdmFyIG0gPSB0aGlzLl9tb2R1bGVzW2FsaWFzXTtcbiAgICAgIGlmICghbSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGFsaWFzIHByb3ZpZGVkIChubyBzdWNoIG1vZHVsZSk6IGBcIithbGlhcytcIidcIik7XG4gICAgICB9XG4gICAgICByZXR1cm4gbTtcbiAgICB9XG5cbiAgfSk7XG5cbiAgQ29tcG9uZW50UmVnaXN0cnkucHJvdG90eXBlLmMgPSBDb21wb25lbnRSZWdpc3RyeS5wcm90b3R5cGUuY29tcG9uZW50O1xuXG4gIHJldHVybiBDb21wb25lbnRSZWdpc3RyeTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvb3B0aW9uc1wiKVxuKTtcblxufSkoKSIsIlwidXNlIHN0cmljdFwiO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCIuL3dlYi1zY2hlZHVsZXJcIik7XG4iLCIoZnVuY3Rpb24oKXsvLyAgICAgVW5kZXJzY29yZS5qcyAxLjYuMFxuLy8gICAgIGh0dHA6Ly91bmRlcnNjb3JlanMub3JnXG4vLyAgICAgKGMpIDIwMDktMjAxNCBKZXJlbXkgQXNoa2VuYXMsIERvY3VtZW50Q2xvdWQgYW5kIEludmVzdGlnYXRpdmUgUmVwb3J0ZXJzICYgRWRpdG9yc1xuLy8gICAgIFVuZGVyc2NvcmUgbWF5IGJlIGZyZWVseSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5cbihmdW5jdGlvbigpIHtcblxuICAvLyBCYXNlbGluZSBzZXR1cFxuICAvLyAtLS0tLS0tLS0tLS0tLVxuXG4gIC8vIEVzdGFibGlzaCB0aGUgcm9vdCBvYmplY3QsIGB3aW5kb3dgIGluIHRoZSBicm93c2VyLCBvciBgZXhwb3J0c2Agb24gdGhlIHNlcnZlci5cbiAgdmFyIHJvb3QgPSB0aGlzO1xuXG4gIC8vIFNhdmUgdGhlIHByZXZpb3VzIHZhbHVlIG9mIHRoZSBgX2AgdmFyaWFibGUuXG4gIHZhciBwcmV2aW91c1VuZGVyc2NvcmUgPSByb290Ll87XG5cbiAgLy8gRXN0YWJsaXNoIHRoZSBvYmplY3QgdGhhdCBnZXRzIHJldHVybmVkIHRvIGJyZWFrIG91dCBvZiBhIGxvb3AgaXRlcmF0aW9uLlxuICB2YXIgYnJlYWtlciA9IHt9O1xuXG4gIC8vIFNhdmUgYnl0ZXMgaW4gdGhlIG1pbmlmaWVkIChidXQgbm90IGd6aXBwZWQpIHZlcnNpb246XG4gIHZhciBBcnJheVByb3RvID0gQXJyYXkucHJvdG90eXBlLCBPYmpQcm90byA9IE9iamVjdC5wcm90b3R5cGUsIEZ1bmNQcm90byA9IEZ1bmN0aW9uLnByb3RvdHlwZTtcblxuICAvLyBDcmVhdGUgcXVpY2sgcmVmZXJlbmNlIHZhcmlhYmxlcyBmb3Igc3BlZWQgYWNjZXNzIHRvIGNvcmUgcHJvdG90eXBlcy5cbiAgdmFyXG4gICAgcHVzaCAgICAgICAgICAgICA9IEFycmF5UHJvdG8ucHVzaCxcbiAgICBzbGljZSAgICAgICAgICAgID0gQXJyYXlQcm90by5zbGljZSxcbiAgICBjb25jYXQgICAgICAgICAgID0gQXJyYXlQcm90by5jb25jYXQsXG4gICAgdG9TdHJpbmcgICAgICAgICA9IE9ialByb3RvLnRvU3RyaW5nLFxuICAgIGhhc093blByb3BlcnR5ICAgPSBPYmpQcm90by5oYXNPd25Qcm9wZXJ0eTtcblxuICAvLyBBbGwgKipFQ01BU2NyaXB0IDUqKiBuYXRpdmUgZnVuY3Rpb24gaW1wbGVtZW50YXRpb25zIHRoYXQgd2UgaG9wZSB0byB1c2VcbiAgLy8gYXJlIGRlY2xhcmVkIGhlcmUuXG4gIHZhclxuICAgIG5hdGl2ZUZvckVhY2ggICAgICA9IEFycmF5UHJvdG8uZm9yRWFjaCxcbiAgICBuYXRpdmVNYXAgICAgICAgICAgPSBBcnJheVByb3RvLm1hcCxcbiAgICBuYXRpdmVSZWR1Y2UgICAgICAgPSBBcnJheVByb3RvLnJlZHVjZSxcbiAgICBuYXRpdmVSZWR1Y2VSaWdodCAgPSBBcnJheVByb3RvLnJlZHVjZVJpZ2h0LFxuICAgIG5hdGl2ZUZpbHRlciAgICAgICA9IEFycmF5UHJvdG8uZmlsdGVyLFxuICAgIG5hdGl2ZUV2ZXJ5ICAgICAgICA9IEFycmF5UHJvdG8uZXZlcnksXG4gICAgbmF0aXZlU29tZSAgICAgICAgID0gQXJyYXlQcm90by5zb21lLFxuICAgIG5hdGl2ZUluZGV4T2YgICAgICA9IEFycmF5UHJvdG8uaW5kZXhPZixcbiAgICBuYXRpdmVMYXN0SW5kZXhPZiAgPSBBcnJheVByb3RvLmxhc3RJbmRleE9mLFxuICAgIG5hdGl2ZUlzQXJyYXkgICAgICA9IEFycmF5LmlzQXJyYXksXG4gICAgbmF0aXZlS2V5cyAgICAgICAgID0gT2JqZWN0LmtleXMsXG4gICAgbmF0aXZlQmluZCAgICAgICAgID0gRnVuY1Byb3RvLmJpbmQ7XG5cbiAgLy8gQ3JlYXRlIGEgc2FmZSByZWZlcmVuY2UgdG8gdGhlIFVuZGVyc2NvcmUgb2JqZWN0IGZvciB1c2UgYmVsb3cuXG4gIHZhciBfID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgaWYgKG9iaiBpbnN0YW5jZW9mIF8pIHJldHVybiBvYmo7XG4gICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIF8pKSByZXR1cm4gbmV3IF8ob2JqKTtcbiAgICB0aGlzLl93cmFwcGVkID0gb2JqO1xuICB9O1xuXG4gIC8vIEV4cG9ydCB0aGUgVW5kZXJzY29yZSBvYmplY3QgZm9yICoqTm9kZS5qcyoqLCB3aXRoXG4gIC8vIGJhY2t3YXJkcy1jb21wYXRpYmlsaXR5IGZvciB0aGUgb2xkIGByZXF1aXJlKClgIEFQSS4gSWYgd2UncmUgaW5cbiAgLy8gdGhlIGJyb3dzZXIsIGFkZCBgX2AgYXMgYSBnbG9iYWwgb2JqZWN0IHZpYSBhIHN0cmluZyBpZGVudGlmaWVyLFxuICAvLyBmb3IgQ2xvc3VyZSBDb21waWxlciBcImFkdmFuY2VkXCIgbW9kZS5cbiAgaWYgKHR5cGVvZiBleHBvcnRzICE9PSAndW5kZWZpbmVkJykge1xuICAgIGlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyAmJiBtb2R1bGUuZXhwb3J0cykge1xuICAgICAgZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gXztcbiAgICB9XG4gICAgZXhwb3J0cy5fID0gXztcbiAgfSBlbHNlIHtcbiAgICByb290Ll8gPSBfO1xuICB9XG5cbiAgLy8gQ3VycmVudCB2ZXJzaW9uLlxuICBfLlZFUlNJT04gPSAnMS42LjAnO1xuXG4gIC8vIENvbGxlY3Rpb24gRnVuY3Rpb25zXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgLy8gVGhlIGNvcm5lcnN0b25lLCBhbiBgZWFjaGAgaW1wbGVtZW50YXRpb24sIGFrYSBgZm9yRWFjaGAuXG4gIC8vIEhhbmRsZXMgb2JqZWN0cyB3aXRoIHRoZSBidWlsdC1pbiBgZm9yRWFjaGAsIGFycmF5cywgYW5kIHJhdyBvYmplY3RzLlxuICAvLyBEZWxlZ2F0ZXMgdG8gKipFQ01BU2NyaXB0IDUqKidzIG5hdGl2ZSBgZm9yRWFjaGAgaWYgYXZhaWxhYmxlLlxuICB2YXIgZWFjaCA9IF8uZWFjaCA9IF8uZm9yRWFjaCA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0b3IsIGNvbnRleHQpIHtcbiAgICBpZiAob2JqID09IG51bGwpIHJldHVybiBvYmo7XG4gICAgaWYgKG5hdGl2ZUZvckVhY2ggJiYgb2JqLmZvckVhY2ggPT09IG5hdGl2ZUZvckVhY2gpIHtcbiAgICAgIG9iai5mb3JFYWNoKGl0ZXJhdG9yLCBjb250ZXh0KTtcbiAgICB9IGVsc2UgaWYgKG9iai5sZW5ndGggPT09ICtvYmoubGVuZ3RoKSB7XG4gICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gb2JqLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChpdGVyYXRvci5jYWxsKGNvbnRleHQsIG9ialtpXSwgaSwgb2JqKSA9PT0gYnJlYWtlcikgcmV0dXJuO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB2YXIga2V5cyA9IF8ua2V5cyhvYmopO1xuICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IGtleXMubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGl0ZXJhdG9yLmNhbGwoY29udGV4dCwgb2JqW2tleXNbaV1dLCBrZXlzW2ldLCBvYmopID09PSBicmVha2VyKSByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvYmo7XG4gIH07XG5cbiAgLy8gUmV0dXJuIHRoZSByZXN1bHRzIG9mIGFwcGx5aW5nIHRoZSBpdGVyYXRvciB0byBlYWNoIGVsZW1lbnQuXG4gIC8vIERlbGVnYXRlcyB0byAqKkVDTUFTY3JpcHQgNSoqJ3MgbmF0aXZlIGBtYXBgIGlmIGF2YWlsYWJsZS5cbiAgXy5tYXAgPSBfLmNvbGxlY3QgPSBmdW5jdGlvbihvYmosIGl0ZXJhdG9yLCBjb250ZXh0KSB7XG4gICAgdmFyIHJlc3VsdHMgPSBbXTtcbiAgICBpZiAob2JqID09IG51bGwpIHJldHVybiByZXN1bHRzO1xuICAgIGlmIChuYXRpdmVNYXAgJiYgb2JqLm1hcCA9PT0gbmF0aXZlTWFwKSByZXR1cm4gb2JqLm1hcChpdGVyYXRvciwgY29udGV4dCk7XG4gICAgZWFjaChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgbGlzdCkge1xuICAgICAgcmVzdWx0cy5wdXNoKGl0ZXJhdG9yLmNhbGwoY29udGV4dCwgdmFsdWUsIGluZGV4LCBsaXN0KSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdHM7XG4gIH07XG5cbiAgdmFyIHJlZHVjZUVycm9yID0gJ1JlZHVjZSBvZiBlbXB0eSBhcnJheSB3aXRoIG5vIGluaXRpYWwgdmFsdWUnO1xuXG4gIC8vICoqUmVkdWNlKiogYnVpbGRzIHVwIGEgc2luZ2xlIHJlc3VsdCBmcm9tIGEgbGlzdCBvZiB2YWx1ZXMsIGFrYSBgaW5qZWN0YCxcbiAgLy8gb3IgYGZvbGRsYC4gRGVsZWdhdGVzIHRvICoqRUNNQVNjcmlwdCA1KioncyBuYXRpdmUgYHJlZHVjZWAgaWYgYXZhaWxhYmxlLlxuICBfLnJlZHVjZSA9IF8uZm9sZGwgPSBfLmluamVjdCA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0b3IsIG1lbW8sIGNvbnRleHQpIHtcbiAgICB2YXIgaW5pdGlhbCA9IGFyZ3VtZW50cy5sZW5ndGggPiAyO1xuICAgIGlmIChvYmogPT0gbnVsbCkgb2JqID0gW107XG4gICAgaWYgKG5hdGl2ZVJlZHVjZSAmJiBvYmoucmVkdWNlID09PSBuYXRpdmVSZWR1Y2UpIHtcbiAgICAgIGlmIChjb250ZXh0KSBpdGVyYXRvciA9IF8uYmluZChpdGVyYXRvciwgY29udGV4dCk7XG4gICAgICByZXR1cm4gaW5pdGlhbCA/IG9iai5yZWR1Y2UoaXRlcmF0b3IsIG1lbW8pIDogb2JqLnJlZHVjZShpdGVyYXRvcik7XG4gICAgfVxuICAgIGVhY2gob2JqLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGxpc3QpIHtcbiAgICAgIGlmICghaW5pdGlhbCkge1xuICAgICAgICBtZW1vID0gdmFsdWU7XG4gICAgICAgIGluaXRpYWwgPSB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbWVtbyA9IGl0ZXJhdG9yLmNhbGwoY29udGV4dCwgbWVtbywgdmFsdWUsIGluZGV4LCBsaXN0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAoIWluaXRpYWwpIHRocm93IG5ldyBUeXBlRXJyb3IocmVkdWNlRXJyb3IpO1xuICAgIHJldHVybiBtZW1vO1xuICB9O1xuXG4gIC8vIFRoZSByaWdodC1hc3NvY2lhdGl2ZSB2ZXJzaW9uIG9mIHJlZHVjZSwgYWxzbyBrbm93biBhcyBgZm9sZHJgLlxuICAvLyBEZWxlZ2F0ZXMgdG8gKipFQ01BU2NyaXB0IDUqKidzIG5hdGl2ZSBgcmVkdWNlUmlnaHRgIGlmIGF2YWlsYWJsZS5cbiAgXy5yZWR1Y2VSaWdodCA9IF8uZm9sZHIgPSBmdW5jdGlvbihvYmosIGl0ZXJhdG9yLCBtZW1vLCBjb250ZXh0KSB7XG4gICAgdmFyIGluaXRpYWwgPSBhcmd1bWVudHMubGVuZ3RoID4gMjtcbiAgICBpZiAob2JqID09IG51bGwpIG9iaiA9IFtdO1xuICAgIGlmIChuYXRpdmVSZWR1Y2VSaWdodCAmJiBvYmoucmVkdWNlUmlnaHQgPT09IG5hdGl2ZVJlZHVjZVJpZ2h0KSB7XG4gICAgICBpZiAoY29udGV4dCkgaXRlcmF0b3IgPSBfLmJpbmQoaXRlcmF0b3IsIGNvbnRleHQpO1xuICAgICAgcmV0dXJuIGluaXRpYWwgPyBvYmoucmVkdWNlUmlnaHQoaXRlcmF0b3IsIG1lbW8pIDogb2JqLnJlZHVjZVJpZ2h0KGl0ZXJhdG9yKTtcbiAgICB9XG4gICAgdmFyIGxlbmd0aCA9IG9iai5sZW5ndGg7XG4gICAgaWYgKGxlbmd0aCAhPT0gK2xlbmd0aCkge1xuICAgICAgdmFyIGtleXMgPSBfLmtleXMob2JqKTtcbiAgICAgIGxlbmd0aCA9IGtleXMubGVuZ3RoO1xuICAgIH1cbiAgICBlYWNoKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7XG4gICAgICBpbmRleCA9IGtleXMgPyBrZXlzWy0tbGVuZ3RoXSA6IC0tbGVuZ3RoO1xuICAgICAgaWYgKCFpbml0aWFsKSB7XG4gICAgICAgIG1lbW8gPSBvYmpbaW5kZXhdO1xuICAgICAgICBpbml0aWFsID0gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1lbW8gPSBpdGVyYXRvci5jYWxsKGNvbnRleHQsIG1lbW8sIG9ialtpbmRleF0sIGluZGV4LCBsaXN0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAoIWluaXRpYWwpIHRocm93IG5ldyBUeXBlRXJyb3IocmVkdWNlRXJyb3IpO1xuICAgIHJldHVybiBtZW1vO1xuICB9O1xuXG4gIC8vIFJldHVybiB0aGUgZmlyc3QgdmFsdWUgd2hpY2ggcGFzc2VzIGEgdHJ1dGggdGVzdC4gQWxpYXNlZCBhcyBgZGV0ZWN0YC5cbiAgXy5maW5kID0gXy5kZXRlY3QgPSBmdW5jdGlvbihvYmosIHByZWRpY2F0ZSwgY29udGV4dCkge1xuICAgIHZhciByZXN1bHQ7XG4gICAgYW55KG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7XG4gICAgICBpZiAocHJlZGljYXRlLmNhbGwoY29udGV4dCwgdmFsdWUsIGluZGV4LCBsaXN0KSkge1xuICAgICAgICByZXN1bHQgPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICAvLyBSZXR1cm4gYWxsIHRoZSBlbGVtZW50cyB0aGF0IHBhc3MgYSB0cnV0aCB0ZXN0LlxuICAvLyBEZWxlZ2F0ZXMgdG8gKipFQ01BU2NyaXB0IDUqKidzIG5hdGl2ZSBgZmlsdGVyYCBpZiBhdmFpbGFibGUuXG4gIC8vIEFsaWFzZWQgYXMgYHNlbGVjdGAuXG4gIF8uZmlsdGVyID0gXy5zZWxlY3QgPSBmdW5jdGlvbihvYmosIHByZWRpY2F0ZSwgY29udGV4dCkge1xuICAgIHZhciByZXN1bHRzID0gW107XG4gICAgaWYgKG9iaiA9PSBudWxsKSByZXR1cm4gcmVzdWx0cztcbiAgICBpZiAobmF0aXZlRmlsdGVyICYmIG9iai5maWx0ZXIgPT09IG5hdGl2ZUZpbHRlcikgcmV0dXJuIG9iai5maWx0ZXIocHJlZGljYXRlLCBjb250ZXh0KTtcbiAgICBlYWNoKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7XG4gICAgICBpZiAocHJlZGljYXRlLmNhbGwoY29udGV4dCwgdmFsdWUsIGluZGV4LCBsaXN0KSkgcmVzdWx0cy5wdXNoKHZhbHVlKTtcbiAgICB9KTtcbiAgICByZXR1cm4gcmVzdWx0cztcbiAgfTtcblxuICAvLyBSZXR1cm4gYWxsIHRoZSBlbGVtZW50cyBmb3Igd2hpY2ggYSB0cnV0aCB0ZXN0IGZhaWxzLlxuICBfLnJlamVjdCA9IGZ1bmN0aW9uKG9iaiwgcHJlZGljYXRlLCBjb250ZXh0KSB7XG4gICAgcmV0dXJuIF8uZmlsdGVyKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7XG4gICAgICByZXR1cm4gIXByZWRpY2F0ZS5jYWxsKGNvbnRleHQsIHZhbHVlLCBpbmRleCwgbGlzdCk7XG4gICAgfSwgY29udGV4dCk7XG4gIH07XG5cbiAgLy8gRGV0ZXJtaW5lIHdoZXRoZXIgYWxsIG9mIHRoZSBlbGVtZW50cyBtYXRjaCBhIHRydXRoIHRlc3QuXG4gIC8vIERlbGVnYXRlcyB0byAqKkVDTUFTY3JpcHQgNSoqJ3MgbmF0aXZlIGBldmVyeWAgaWYgYXZhaWxhYmxlLlxuICAvLyBBbGlhc2VkIGFzIGBhbGxgLlxuICBfLmV2ZXJ5ID0gXy5hbGwgPSBmdW5jdGlvbihvYmosIHByZWRpY2F0ZSwgY29udGV4dCkge1xuICAgIHByZWRpY2F0ZSB8fCAocHJlZGljYXRlID0gXy5pZGVudGl0eSk7XG4gICAgdmFyIHJlc3VsdCA9IHRydWU7XG4gICAgaWYgKG9iaiA9PSBudWxsKSByZXR1cm4gcmVzdWx0O1xuICAgIGlmIChuYXRpdmVFdmVyeSAmJiBvYmouZXZlcnkgPT09IG5hdGl2ZUV2ZXJ5KSByZXR1cm4gb2JqLmV2ZXJ5KHByZWRpY2F0ZSwgY29udGV4dCk7XG4gICAgZWFjaChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgbGlzdCkge1xuICAgICAgaWYgKCEocmVzdWx0ID0gcmVzdWx0ICYmIHByZWRpY2F0ZS5jYWxsKGNvbnRleHQsIHZhbHVlLCBpbmRleCwgbGlzdCkpKSByZXR1cm4gYnJlYWtlcjtcbiAgICB9KTtcbiAgICByZXR1cm4gISFyZXN1bHQ7XG4gIH07XG5cbiAgLy8gRGV0ZXJtaW5lIGlmIGF0IGxlYXN0IG9uZSBlbGVtZW50IGluIHRoZSBvYmplY3QgbWF0Y2hlcyBhIHRydXRoIHRlc3QuXG4gIC8vIERlbGVnYXRlcyB0byAqKkVDTUFTY3JpcHQgNSoqJ3MgbmF0aXZlIGBzb21lYCBpZiBhdmFpbGFibGUuXG4gIC8vIEFsaWFzZWQgYXMgYGFueWAuXG4gIHZhciBhbnkgPSBfLnNvbWUgPSBfLmFueSA9IGZ1bmN0aW9uKG9iaiwgcHJlZGljYXRlLCBjb250ZXh0KSB7XG4gICAgcHJlZGljYXRlIHx8IChwcmVkaWNhdGUgPSBfLmlkZW50aXR5KTtcbiAgICB2YXIgcmVzdWx0ID0gZmFsc2U7XG4gICAgaWYgKG9iaiA9PSBudWxsKSByZXR1cm4gcmVzdWx0O1xuICAgIGlmIChuYXRpdmVTb21lICYmIG9iai5zb21lID09PSBuYXRpdmVTb21lKSByZXR1cm4gb2JqLnNvbWUocHJlZGljYXRlLCBjb250ZXh0KTtcbiAgICBlYWNoKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7XG4gICAgICBpZiAocmVzdWx0IHx8IChyZXN1bHQgPSBwcmVkaWNhdGUuY2FsbChjb250ZXh0LCB2YWx1ZSwgaW5kZXgsIGxpc3QpKSkgcmV0dXJuIGJyZWFrZXI7XG4gICAgfSk7XG4gICAgcmV0dXJuICEhcmVzdWx0O1xuICB9O1xuXG4gIC8vIERldGVybWluZSBpZiB0aGUgYXJyYXkgb3Igb2JqZWN0IGNvbnRhaW5zIGEgZ2l2ZW4gdmFsdWUgKHVzaW5nIGA9PT1gKS5cbiAgLy8gQWxpYXNlZCBhcyBgaW5jbHVkZWAuXG4gIF8uY29udGFpbnMgPSBfLmluY2x1ZGUgPSBmdW5jdGlvbihvYmosIHRhcmdldCkge1xuICAgIGlmIChvYmogPT0gbnVsbCkgcmV0dXJuIGZhbHNlO1xuICAgIGlmIChuYXRpdmVJbmRleE9mICYmIG9iai5pbmRleE9mID09PSBuYXRpdmVJbmRleE9mKSByZXR1cm4gb2JqLmluZGV4T2YodGFyZ2V0KSAhPSAtMTtcbiAgICByZXR1cm4gYW55KG9iaiwgZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHJldHVybiB2YWx1ZSA9PT0gdGFyZ2V0O1xuICAgIH0pO1xuICB9O1xuXG4gIC8vIEludm9rZSBhIG1ldGhvZCAod2l0aCBhcmd1bWVudHMpIG9uIGV2ZXJ5IGl0ZW0gaW4gYSBjb2xsZWN0aW9uLlxuICBfLmludm9rZSA9IGZ1bmN0aW9uKG9iaiwgbWV0aG9kKSB7XG4gICAgdmFyIGFyZ3MgPSBzbGljZS5jYWxsKGFyZ3VtZW50cywgMik7XG4gICAgdmFyIGlzRnVuYyA9IF8uaXNGdW5jdGlvbihtZXRob2QpO1xuICAgIHJldHVybiBfLm1hcChvYmosIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICByZXR1cm4gKGlzRnVuYyA/IG1ldGhvZCA6IHZhbHVlW21ldGhvZF0pLmFwcGx5KHZhbHVlLCBhcmdzKTtcbiAgICB9KTtcbiAgfTtcblxuICAvLyBDb252ZW5pZW5jZSB2ZXJzaW9uIG9mIGEgY29tbW9uIHVzZSBjYXNlIG9mIGBtYXBgOiBmZXRjaGluZyBhIHByb3BlcnR5LlxuICBfLnBsdWNrID0gZnVuY3Rpb24ob2JqLCBrZXkpIHtcbiAgICByZXR1cm4gXy5tYXAob2JqLCBfLnByb3BlcnR5KGtleSkpO1xuICB9O1xuXG4gIC8vIENvbnZlbmllbmNlIHZlcnNpb24gb2YgYSBjb21tb24gdXNlIGNhc2Ugb2YgYGZpbHRlcmA6IHNlbGVjdGluZyBvbmx5IG9iamVjdHNcbiAgLy8gY29udGFpbmluZyBzcGVjaWZpYyBga2V5OnZhbHVlYCBwYWlycy5cbiAgXy53aGVyZSA9IGZ1bmN0aW9uKG9iaiwgYXR0cnMpIHtcbiAgICByZXR1cm4gXy5maWx0ZXIob2JqLCBfLm1hdGNoZXMoYXR0cnMpKTtcbiAgfTtcblxuICAvLyBDb252ZW5pZW5jZSB2ZXJzaW9uIG9mIGEgY29tbW9uIHVzZSBjYXNlIG9mIGBmaW5kYDogZ2V0dGluZyB0aGUgZmlyc3Qgb2JqZWN0XG4gIC8vIGNvbnRhaW5pbmcgc3BlY2lmaWMgYGtleTp2YWx1ZWAgcGFpcnMuXG4gIF8uZmluZFdoZXJlID0gZnVuY3Rpb24ob2JqLCBhdHRycykge1xuICAgIHJldHVybiBfLmZpbmQob2JqLCBfLm1hdGNoZXMoYXR0cnMpKTtcbiAgfTtcblxuICAvLyBSZXR1cm4gdGhlIG1heGltdW0gZWxlbWVudCBvciAoZWxlbWVudC1iYXNlZCBjb21wdXRhdGlvbikuXG4gIC8vIENhbid0IG9wdGltaXplIGFycmF5cyBvZiBpbnRlZ2VycyBsb25nZXIgdGhhbiA2NSw1MzUgZWxlbWVudHMuXG4gIC8vIFNlZSBbV2ViS2l0IEJ1ZyA4MDc5N10oaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTgwNzk3KVxuICBfLm1heCA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0b3IsIGNvbnRleHQpIHtcbiAgICBpZiAoIWl0ZXJhdG9yICYmIF8uaXNBcnJheShvYmopICYmIG9ialswXSA9PT0gK29ialswXSAmJiBvYmoubGVuZ3RoIDwgNjU1MzUpIHtcbiAgICAgIHJldHVybiBNYXRoLm1heC5hcHBseShNYXRoLCBvYmopO1xuICAgIH1cbiAgICB2YXIgcmVzdWx0ID0gLUluZmluaXR5LCBsYXN0Q29tcHV0ZWQgPSAtSW5maW5pdHk7XG4gICAgZWFjaChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgbGlzdCkge1xuICAgICAgdmFyIGNvbXB1dGVkID0gaXRlcmF0b3IgPyBpdGVyYXRvci5jYWxsKGNvbnRleHQsIHZhbHVlLCBpbmRleCwgbGlzdCkgOiB2YWx1ZTtcbiAgICAgIGlmIChjb21wdXRlZCA+IGxhc3RDb21wdXRlZCkge1xuICAgICAgICByZXN1bHQgPSB2YWx1ZTtcbiAgICAgICAgbGFzdENvbXB1dGVkID0gY29tcHV0ZWQ7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICAvLyBSZXR1cm4gdGhlIG1pbmltdW0gZWxlbWVudCAob3IgZWxlbWVudC1iYXNlZCBjb21wdXRhdGlvbikuXG4gIF8ubWluID0gZnVuY3Rpb24ob2JqLCBpdGVyYXRvciwgY29udGV4dCkge1xuICAgIGlmICghaXRlcmF0b3IgJiYgXy5pc0FycmF5KG9iaikgJiYgb2JqWzBdID09PSArb2JqWzBdICYmIG9iai5sZW5ndGggPCA2NTUzNSkge1xuICAgICAgcmV0dXJuIE1hdGgubWluLmFwcGx5KE1hdGgsIG9iaik7XG4gICAgfVxuICAgIHZhciByZXN1bHQgPSBJbmZpbml0eSwgbGFzdENvbXB1dGVkID0gSW5maW5pdHk7XG4gICAgZWFjaChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgbGlzdCkge1xuICAgICAgdmFyIGNvbXB1dGVkID0gaXRlcmF0b3IgPyBpdGVyYXRvci5jYWxsKGNvbnRleHQsIHZhbHVlLCBpbmRleCwgbGlzdCkgOiB2YWx1ZTtcbiAgICAgIGlmIChjb21wdXRlZCA8IGxhc3RDb21wdXRlZCkge1xuICAgICAgICByZXN1bHQgPSB2YWx1ZTtcbiAgICAgICAgbGFzdENvbXB1dGVkID0gY29tcHV0ZWQ7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICAvLyBTaHVmZmxlIGFuIGFycmF5LCB1c2luZyB0aGUgbW9kZXJuIHZlcnNpb24gb2YgdGhlXG4gIC8vIFtGaXNoZXItWWF0ZXMgc2h1ZmZsZV0oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9GaXNoZXLigJNZYXRlc19zaHVmZmxlKS5cbiAgXy5zaHVmZmxlID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgdmFyIHJhbmQ7XG4gICAgdmFyIGluZGV4ID0gMDtcbiAgICB2YXIgc2h1ZmZsZWQgPSBbXTtcbiAgICBlYWNoKG9iaiwgZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHJhbmQgPSBfLnJhbmRvbShpbmRleCsrKTtcbiAgICAgIHNodWZmbGVkW2luZGV4IC0gMV0gPSBzaHVmZmxlZFtyYW5kXTtcbiAgICAgIHNodWZmbGVkW3JhbmRdID0gdmFsdWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIHNodWZmbGVkO1xuICB9O1xuXG4gIC8vIFNhbXBsZSAqKm4qKiByYW5kb20gdmFsdWVzIGZyb20gYSBjb2xsZWN0aW9uLlxuICAvLyBJZiAqKm4qKiBpcyBub3Qgc3BlY2lmaWVkLCByZXR1cm5zIGEgc2luZ2xlIHJhbmRvbSBlbGVtZW50LlxuICAvLyBUaGUgaW50ZXJuYWwgYGd1YXJkYCBhcmd1bWVudCBhbGxvd3MgaXQgdG8gd29yayB3aXRoIGBtYXBgLlxuICBfLnNhbXBsZSA9IGZ1bmN0aW9uKG9iaiwgbiwgZ3VhcmQpIHtcbiAgICBpZiAobiA9PSBudWxsIHx8IGd1YXJkKSB7XG4gICAgICBpZiAob2JqLmxlbmd0aCAhPT0gK29iai5sZW5ndGgpIG9iaiA9IF8udmFsdWVzKG9iaik7XG4gICAgICByZXR1cm4gb2JqW18ucmFuZG9tKG9iai5sZW5ndGggLSAxKV07XG4gICAgfVxuICAgIHJldHVybiBfLnNodWZmbGUob2JqKS5zbGljZSgwLCBNYXRoLm1heCgwLCBuKSk7XG4gIH07XG5cbiAgLy8gQW4gaW50ZXJuYWwgZnVuY3Rpb24gdG8gZ2VuZXJhdGUgbG9va3VwIGl0ZXJhdG9ycy5cbiAgdmFyIGxvb2t1cEl0ZXJhdG9yID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICBpZiAodmFsdWUgPT0gbnVsbCkgcmV0dXJuIF8uaWRlbnRpdHk7XG4gICAgaWYgKF8uaXNGdW5jdGlvbih2YWx1ZSkpIHJldHVybiB2YWx1ZTtcbiAgICByZXR1cm4gXy5wcm9wZXJ0eSh2YWx1ZSk7XG4gIH07XG5cbiAgLy8gU29ydCB0aGUgb2JqZWN0J3MgdmFsdWVzIGJ5IGEgY3JpdGVyaW9uIHByb2R1Y2VkIGJ5IGFuIGl0ZXJhdG9yLlxuICBfLnNvcnRCeSA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0b3IsIGNvbnRleHQpIHtcbiAgICBpdGVyYXRvciA9IGxvb2t1cEl0ZXJhdG9yKGl0ZXJhdG9yKTtcbiAgICByZXR1cm4gXy5wbHVjayhfLm1hcChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgbGlzdCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsdWU6IHZhbHVlLFxuICAgICAgICBpbmRleDogaW5kZXgsXG4gICAgICAgIGNyaXRlcmlhOiBpdGVyYXRvci5jYWxsKGNvbnRleHQsIHZhbHVlLCBpbmRleCwgbGlzdClcbiAgICAgIH07XG4gICAgfSkuc29ydChmdW5jdGlvbihsZWZ0LCByaWdodCkge1xuICAgICAgdmFyIGEgPSBsZWZ0LmNyaXRlcmlhO1xuICAgICAgdmFyIGIgPSByaWdodC5jcml0ZXJpYTtcbiAgICAgIGlmIChhICE9PSBiKSB7XG4gICAgICAgIGlmIChhID4gYiB8fCBhID09PSB2b2lkIDApIHJldHVybiAxO1xuICAgICAgICBpZiAoYSA8IGIgfHwgYiA9PT0gdm9pZCAwKSByZXR1cm4gLTE7XG4gICAgICB9XG4gICAgICByZXR1cm4gbGVmdC5pbmRleCAtIHJpZ2h0LmluZGV4O1xuICAgIH0pLCAndmFsdWUnKTtcbiAgfTtcblxuICAvLyBBbiBpbnRlcm5hbCBmdW5jdGlvbiB1c2VkIGZvciBhZ2dyZWdhdGUgXCJncm91cCBieVwiIG9wZXJhdGlvbnMuXG4gIHZhciBncm91cCA9IGZ1bmN0aW9uKGJlaGF2aW9yKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKG9iaiwgaXRlcmF0b3IsIGNvbnRleHQpIHtcbiAgICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICAgIGl0ZXJhdG9yID0gbG9va3VwSXRlcmF0b3IoaXRlcmF0b3IpO1xuICAgICAgZWFjaChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCkge1xuICAgICAgICB2YXIga2V5ID0gaXRlcmF0b3IuY2FsbChjb250ZXh0LCB2YWx1ZSwgaW5kZXgsIG9iaik7XG4gICAgICAgIGJlaGF2aW9yKHJlc3VsdCwga2V5LCB2YWx1ZSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgfTtcblxuICAvLyBHcm91cHMgdGhlIG9iamVjdCdzIHZhbHVlcyBieSBhIGNyaXRlcmlvbi4gUGFzcyBlaXRoZXIgYSBzdHJpbmcgYXR0cmlidXRlXG4gIC8vIHRvIGdyb3VwIGJ5LCBvciBhIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyB0aGUgY3JpdGVyaW9uLlxuICBfLmdyb3VwQnkgPSBncm91cChmdW5jdGlvbihyZXN1bHQsIGtleSwgdmFsdWUpIHtcbiAgICBfLmhhcyhyZXN1bHQsIGtleSkgPyByZXN1bHRba2V5XS5wdXNoKHZhbHVlKSA6IHJlc3VsdFtrZXldID0gW3ZhbHVlXTtcbiAgfSk7XG5cbiAgLy8gSW5kZXhlcyB0aGUgb2JqZWN0J3MgdmFsdWVzIGJ5IGEgY3JpdGVyaW9uLCBzaW1pbGFyIHRvIGBncm91cEJ5YCwgYnV0IGZvclxuICAvLyB3aGVuIHlvdSBrbm93IHRoYXQgeW91ciBpbmRleCB2YWx1ZXMgd2lsbCBiZSB1bmlxdWUuXG4gIF8uaW5kZXhCeSA9IGdyb3VwKGZ1bmN0aW9uKHJlc3VsdCwga2V5LCB2YWx1ZSkge1xuICAgIHJlc3VsdFtrZXldID0gdmFsdWU7XG4gIH0pO1xuXG4gIC8vIENvdW50cyBpbnN0YW5jZXMgb2YgYW4gb2JqZWN0IHRoYXQgZ3JvdXAgYnkgYSBjZXJ0YWluIGNyaXRlcmlvbi4gUGFzc1xuICAvLyBlaXRoZXIgYSBzdHJpbmcgYXR0cmlidXRlIHRvIGNvdW50IGJ5LCBvciBhIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyB0aGVcbiAgLy8gY3JpdGVyaW9uLlxuICBfLmNvdW50QnkgPSBncm91cChmdW5jdGlvbihyZXN1bHQsIGtleSkge1xuICAgIF8uaGFzKHJlc3VsdCwga2V5KSA/IHJlc3VsdFtrZXldKysgOiByZXN1bHRba2V5XSA9IDE7XG4gIH0pO1xuXG4gIC8vIFVzZSBhIGNvbXBhcmF0b3IgZnVuY3Rpb24gdG8gZmlndXJlIG91dCB0aGUgc21hbGxlc3QgaW5kZXggYXQgd2hpY2hcbiAgLy8gYW4gb2JqZWN0IHNob3VsZCBiZSBpbnNlcnRlZCBzbyBhcyB0byBtYWludGFpbiBvcmRlci4gVXNlcyBiaW5hcnkgc2VhcmNoLlxuICBfLnNvcnRlZEluZGV4ID0gZnVuY3Rpb24oYXJyYXksIG9iaiwgaXRlcmF0b3IsIGNvbnRleHQpIHtcbiAgICBpdGVyYXRvciA9IGxvb2t1cEl0ZXJhdG9yKGl0ZXJhdG9yKTtcbiAgICB2YXIgdmFsdWUgPSBpdGVyYXRvci5jYWxsKGNvbnRleHQsIG9iaik7XG4gICAgdmFyIGxvdyA9IDAsIGhpZ2ggPSBhcnJheS5sZW5ndGg7XG4gICAgd2hpbGUgKGxvdyA8IGhpZ2gpIHtcbiAgICAgIHZhciBtaWQgPSAobG93ICsgaGlnaCkgPj4+IDE7XG4gICAgICBpdGVyYXRvci5jYWxsKGNvbnRleHQsIGFycmF5W21pZF0pIDwgdmFsdWUgPyBsb3cgPSBtaWQgKyAxIDogaGlnaCA9IG1pZDtcbiAgICB9XG4gICAgcmV0dXJuIGxvdztcbiAgfTtcblxuICAvLyBTYWZlbHkgY3JlYXRlIGEgcmVhbCwgbGl2ZSBhcnJheSBmcm9tIGFueXRoaW5nIGl0ZXJhYmxlLlxuICBfLnRvQXJyYXkgPSBmdW5jdGlvbihvYmopIHtcbiAgICBpZiAoIW9iaikgcmV0dXJuIFtdO1xuICAgIGlmIChfLmlzQXJyYXkob2JqKSkgcmV0dXJuIHNsaWNlLmNhbGwob2JqKTtcbiAgICBpZiAob2JqLmxlbmd0aCA9PT0gK29iai5sZW5ndGgpIHJldHVybiBfLm1hcChvYmosIF8uaWRlbnRpdHkpO1xuICAgIHJldHVybiBfLnZhbHVlcyhvYmopO1xuICB9O1xuXG4gIC8vIFJldHVybiB0aGUgbnVtYmVyIG9mIGVsZW1lbnRzIGluIGFuIG9iamVjdC5cbiAgXy5zaXplID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgaWYgKG9iaiA9PSBudWxsKSByZXR1cm4gMDtcbiAgICByZXR1cm4gKG9iai5sZW5ndGggPT09ICtvYmoubGVuZ3RoKSA/IG9iai5sZW5ndGggOiBfLmtleXMob2JqKS5sZW5ndGg7XG4gIH07XG5cbiAgLy8gQXJyYXkgRnVuY3Rpb25zXG4gIC8vIC0tLS0tLS0tLS0tLS0tLVxuXG4gIC8vIEdldCB0aGUgZmlyc3QgZWxlbWVudCBvZiBhbiBhcnJheS4gUGFzc2luZyAqKm4qKiB3aWxsIHJldHVybiB0aGUgZmlyc3QgTlxuICAvLyB2YWx1ZXMgaW4gdGhlIGFycmF5LiBBbGlhc2VkIGFzIGBoZWFkYCBhbmQgYHRha2VgLiBUaGUgKipndWFyZCoqIGNoZWNrXG4gIC8vIGFsbG93cyBpdCB0byB3b3JrIHdpdGggYF8ubWFwYC5cbiAgXy5maXJzdCA9IF8uaGVhZCA9IF8udGFrZSA9IGZ1bmN0aW9uKGFycmF5LCBuLCBndWFyZCkge1xuICAgIGlmIChhcnJheSA9PSBudWxsKSByZXR1cm4gdm9pZCAwO1xuICAgIGlmICgobiA9PSBudWxsKSB8fCBndWFyZCkgcmV0dXJuIGFycmF5WzBdO1xuICAgIGlmIChuIDwgMCkgcmV0dXJuIFtdO1xuICAgIHJldHVybiBzbGljZS5jYWxsKGFycmF5LCAwLCBuKTtcbiAgfTtcblxuICAvLyBSZXR1cm5zIGV2ZXJ5dGhpbmcgYnV0IHRoZSBsYXN0IGVudHJ5IG9mIHRoZSBhcnJheS4gRXNwZWNpYWxseSB1c2VmdWwgb25cbiAgLy8gdGhlIGFyZ3VtZW50cyBvYmplY3QuIFBhc3NpbmcgKipuKiogd2lsbCByZXR1cm4gYWxsIHRoZSB2YWx1ZXMgaW5cbiAgLy8gdGhlIGFycmF5LCBleGNsdWRpbmcgdGhlIGxhc3QgTi4gVGhlICoqZ3VhcmQqKiBjaGVjayBhbGxvd3MgaXQgdG8gd29yayB3aXRoXG4gIC8vIGBfLm1hcGAuXG4gIF8uaW5pdGlhbCA9IGZ1bmN0aW9uKGFycmF5LCBuLCBndWFyZCkge1xuICAgIHJldHVybiBzbGljZS5jYWxsKGFycmF5LCAwLCBhcnJheS5sZW5ndGggLSAoKG4gPT0gbnVsbCkgfHwgZ3VhcmQgPyAxIDogbikpO1xuICB9O1xuXG4gIC8vIEdldCB0aGUgbGFzdCBlbGVtZW50IG9mIGFuIGFycmF5LiBQYXNzaW5nICoqbioqIHdpbGwgcmV0dXJuIHRoZSBsYXN0IE5cbiAgLy8gdmFsdWVzIGluIHRoZSBhcnJheS4gVGhlICoqZ3VhcmQqKiBjaGVjayBhbGxvd3MgaXQgdG8gd29yayB3aXRoIGBfLm1hcGAuXG4gIF8ubGFzdCA9IGZ1bmN0aW9uKGFycmF5LCBuLCBndWFyZCkge1xuICAgIGlmIChhcnJheSA9PSBudWxsKSByZXR1cm4gdm9pZCAwO1xuICAgIGlmICgobiA9PSBudWxsKSB8fCBndWFyZCkgcmV0dXJuIGFycmF5W2FycmF5Lmxlbmd0aCAtIDFdO1xuICAgIHJldHVybiBzbGljZS5jYWxsKGFycmF5LCBNYXRoLm1heChhcnJheS5sZW5ndGggLSBuLCAwKSk7XG4gIH07XG5cbiAgLy8gUmV0dXJucyBldmVyeXRoaW5nIGJ1dCB0aGUgZmlyc3QgZW50cnkgb2YgdGhlIGFycmF5LiBBbGlhc2VkIGFzIGB0YWlsYCBhbmQgYGRyb3BgLlxuICAvLyBFc3BlY2lhbGx5IHVzZWZ1bCBvbiB0aGUgYXJndW1lbnRzIG9iamVjdC4gUGFzc2luZyBhbiAqKm4qKiB3aWxsIHJldHVyblxuICAvLyB0aGUgcmVzdCBOIHZhbHVlcyBpbiB0aGUgYXJyYXkuIFRoZSAqKmd1YXJkKipcbiAgLy8gY2hlY2sgYWxsb3dzIGl0IHRvIHdvcmsgd2l0aCBgXy5tYXBgLlxuICBfLnJlc3QgPSBfLnRhaWwgPSBfLmRyb3AgPSBmdW5jdGlvbihhcnJheSwgbiwgZ3VhcmQpIHtcbiAgICByZXR1cm4gc2xpY2UuY2FsbChhcnJheSwgKG4gPT0gbnVsbCkgfHwgZ3VhcmQgPyAxIDogbik7XG4gIH07XG5cbiAgLy8gVHJpbSBvdXQgYWxsIGZhbHN5IHZhbHVlcyBmcm9tIGFuIGFycmF5LlxuICBfLmNvbXBhY3QgPSBmdW5jdGlvbihhcnJheSkge1xuICAgIHJldHVybiBfLmZpbHRlcihhcnJheSwgXy5pZGVudGl0eSk7XG4gIH07XG5cbiAgLy8gSW50ZXJuYWwgaW1wbGVtZW50YXRpb24gb2YgYSByZWN1cnNpdmUgYGZsYXR0ZW5gIGZ1bmN0aW9uLlxuICB2YXIgZmxhdHRlbiA9IGZ1bmN0aW9uKGlucHV0LCBzaGFsbG93LCBvdXRwdXQpIHtcbiAgICBpZiAoc2hhbGxvdyAmJiBfLmV2ZXJ5KGlucHV0LCBfLmlzQXJyYXkpKSB7XG4gICAgICByZXR1cm4gY29uY2F0LmFwcGx5KG91dHB1dCwgaW5wdXQpO1xuICAgIH1cbiAgICBlYWNoKGlucHV0LCBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgaWYgKF8uaXNBcnJheSh2YWx1ZSkgfHwgXy5pc0FyZ3VtZW50cyh2YWx1ZSkpIHtcbiAgICAgICAgc2hhbGxvdyA/IHB1c2guYXBwbHkob3V0cHV0LCB2YWx1ZSkgOiBmbGF0dGVuKHZhbHVlLCBzaGFsbG93LCBvdXRwdXQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgb3V0cHV0LnB1c2godmFsdWUpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBvdXRwdXQ7XG4gIH07XG5cbiAgLy8gRmxhdHRlbiBvdXQgYW4gYXJyYXksIGVpdGhlciByZWN1cnNpdmVseSAoYnkgZGVmYXVsdCksIG9yIGp1c3Qgb25lIGxldmVsLlxuICBfLmZsYXR0ZW4gPSBmdW5jdGlvbihhcnJheSwgc2hhbGxvdykge1xuICAgIHJldHVybiBmbGF0dGVuKGFycmF5LCBzaGFsbG93LCBbXSk7XG4gIH07XG5cbiAgLy8gUmV0dXJuIGEgdmVyc2lvbiBvZiB0aGUgYXJyYXkgdGhhdCBkb2VzIG5vdCBjb250YWluIHRoZSBzcGVjaWZpZWQgdmFsdWUocykuXG4gIF8ud2l0aG91dCA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgcmV0dXJuIF8uZGlmZmVyZW5jZShhcnJheSwgc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKTtcbiAgfTtcblxuICAvLyBTcGxpdCBhbiBhcnJheSBpbnRvIHR3byBhcnJheXM6IG9uZSB3aG9zZSBlbGVtZW50cyBhbGwgc2F0aXNmeSB0aGUgZ2l2ZW5cbiAgLy8gcHJlZGljYXRlLCBhbmQgb25lIHdob3NlIGVsZW1lbnRzIGFsbCBkbyBub3Qgc2F0aXNmeSB0aGUgcHJlZGljYXRlLlxuICBfLnBhcnRpdGlvbiA9IGZ1bmN0aW9uKGFycmF5LCBwcmVkaWNhdGUpIHtcbiAgICB2YXIgcGFzcyA9IFtdLCBmYWlsID0gW107XG4gICAgZWFjaChhcnJheSwgZnVuY3Rpb24oZWxlbSkge1xuICAgICAgKHByZWRpY2F0ZShlbGVtKSA/IHBhc3MgOiBmYWlsKS5wdXNoKGVsZW0pO1xuICAgIH0pO1xuICAgIHJldHVybiBbcGFzcywgZmFpbF07XG4gIH07XG5cbiAgLy8gUHJvZHVjZSBhIGR1cGxpY2F0ZS1mcmVlIHZlcnNpb24gb2YgdGhlIGFycmF5LiBJZiB0aGUgYXJyYXkgaGFzIGFscmVhZHlcbiAgLy8gYmVlbiBzb3J0ZWQsIHlvdSBoYXZlIHRoZSBvcHRpb24gb2YgdXNpbmcgYSBmYXN0ZXIgYWxnb3JpdGhtLlxuICAvLyBBbGlhc2VkIGFzIGB1bmlxdWVgLlxuICBfLnVuaXEgPSBfLnVuaXF1ZSA9IGZ1bmN0aW9uKGFycmF5LCBpc1NvcnRlZCwgaXRlcmF0b3IsIGNvbnRleHQpIHtcbiAgICBpZiAoXy5pc0Z1bmN0aW9uKGlzU29ydGVkKSkge1xuICAgICAgY29udGV4dCA9IGl0ZXJhdG9yO1xuICAgICAgaXRlcmF0b3IgPSBpc1NvcnRlZDtcbiAgICAgIGlzU29ydGVkID0gZmFsc2U7XG4gICAgfVxuICAgIHZhciBpbml0aWFsID0gaXRlcmF0b3IgPyBfLm1hcChhcnJheSwgaXRlcmF0b3IsIGNvbnRleHQpIDogYXJyYXk7XG4gICAgdmFyIHJlc3VsdHMgPSBbXTtcbiAgICB2YXIgc2VlbiA9IFtdO1xuICAgIGVhY2goaW5pdGlhbCwgZnVuY3Rpb24odmFsdWUsIGluZGV4KSB7XG4gICAgICBpZiAoaXNTb3J0ZWQgPyAoIWluZGV4IHx8IHNlZW5bc2Vlbi5sZW5ndGggLSAxXSAhPT0gdmFsdWUpIDogIV8uY29udGFpbnMoc2VlbiwgdmFsdWUpKSB7XG4gICAgICAgIHNlZW4ucHVzaCh2YWx1ZSk7XG4gICAgICAgIHJlc3VsdHMucHVzaChhcnJheVtpbmRleF0pO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiByZXN1bHRzO1xuICB9O1xuXG4gIC8vIFByb2R1Y2UgYW4gYXJyYXkgdGhhdCBjb250YWlucyB0aGUgdW5pb246IGVhY2ggZGlzdGluY3QgZWxlbWVudCBmcm9tIGFsbCBvZlxuICAvLyB0aGUgcGFzc2VkLWluIGFycmF5cy5cbiAgXy51bmlvbiA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfLnVuaXEoXy5mbGF0dGVuKGFyZ3VtZW50cywgdHJ1ZSkpO1xuICB9O1xuXG4gIC8vIFByb2R1Y2UgYW4gYXJyYXkgdGhhdCBjb250YWlucyBldmVyeSBpdGVtIHNoYXJlZCBiZXR3ZWVuIGFsbCB0aGVcbiAgLy8gcGFzc2VkLWluIGFycmF5cy5cbiAgXy5pbnRlcnNlY3Rpb24gPSBmdW5jdGlvbihhcnJheSkge1xuICAgIHZhciByZXN0ID0gc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpO1xuICAgIHJldHVybiBfLmZpbHRlcihfLnVuaXEoYXJyYXkpLCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICByZXR1cm4gXy5ldmVyeShyZXN0LCBmdW5jdGlvbihvdGhlcikge1xuICAgICAgICByZXR1cm4gXy5jb250YWlucyhvdGhlciwgaXRlbSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICAvLyBUYWtlIHRoZSBkaWZmZXJlbmNlIGJldHdlZW4gb25lIGFycmF5IGFuZCBhIG51bWJlciBvZiBvdGhlciBhcnJheXMuXG4gIC8vIE9ubHkgdGhlIGVsZW1lbnRzIHByZXNlbnQgaW4ganVzdCB0aGUgZmlyc3QgYXJyYXkgd2lsbCByZW1haW4uXG4gIF8uZGlmZmVyZW5jZSA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgdmFyIHJlc3QgPSBjb25jYXQuYXBwbHkoQXJyYXlQcm90bywgc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKTtcbiAgICByZXR1cm4gXy5maWx0ZXIoYXJyYXksIGZ1bmN0aW9uKHZhbHVlKXsgcmV0dXJuICFfLmNvbnRhaW5zKHJlc3QsIHZhbHVlKTsgfSk7XG4gIH07XG5cbiAgLy8gWmlwIHRvZ2V0aGVyIG11bHRpcGxlIGxpc3RzIGludG8gYSBzaW5nbGUgYXJyYXkgLS0gZWxlbWVudHMgdGhhdCBzaGFyZVxuICAvLyBhbiBpbmRleCBnbyB0b2dldGhlci5cbiAgXy56aXAgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgbGVuZ3RoID0gXy5tYXgoXy5wbHVjayhhcmd1bWVudHMsICdsZW5ndGgnKS5jb25jYXQoMCkpO1xuICAgIHZhciByZXN1bHRzID0gbmV3IEFycmF5KGxlbmd0aCk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgcmVzdWx0c1tpXSA9IF8ucGx1Y2soYXJndW1lbnRzLCAnJyArIGkpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0cztcbiAgfTtcblxuICAvLyBDb252ZXJ0cyBsaXN0cyBpbnRvIG9iamVjdHMuIFBhc3MgZWl0aGVyIGEgc2luZ2xlIGFycmF5IG9mIGBba2V5LCB2YWx1ZV1gXG4gIC8vIHBhaXJzLCBvciB0d28gcGFyYWxsZWwgYXJyYXlzIG9mIHRoZSBzYW1lIGxlbmd0aCAtLSBvbmUgb2Yga2V5cywgYW5kIG9uZSBvZlxuICAvLyB0aGUgY29ycmVzcG9uZGluZyB2YWx1ZXMuXG4gIF8ub2JqZWN0ID0gZnVuY3Rpb24obGlzdCwgdmFsdWVzKSB7XG4gICAgaWYgKGxpc3QgPT0gbnVsbCkgcmV0dXJuIHt9O1xuICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gbGlzdC5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHZhbHVlcykge1xuICAgICAgICByZXN1bHRbbGlzdFtpXV0gPSB2YWx1ZXNbaV07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHRbbGlzdFtpXVswXV0gPSBsaXN0W2ldWzFdO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIC8vIElmIHRoZSBicm93c2VyIGRvZXNuJ3Qgc3VwcGx5IHVzIHdpdGggaW5kZXhPZiAoSSdtIGxvb2tpbmcgYXQgeW91LCAqKk1TSUUqKiksXG4gIC8vIHdlIG5lZWQgdGhpcyBmdW5jdGlvbi4gUmV0dXJuIHRoZSBwb3NpdGlvbiBvZiB0aGUgZmlyc3Qgb2NjdXJyZW5jZSBvZiBhblxuICAvLyBpdGVtIGluIGFuIGFycmF5LCBvciAtMSBpZiB0aGUgaXRlbSBpcyBub3QgaW5jbHVkZWQgaW4gdGhlIGFycmF5LlxuICAvLyBEZWxlZ2F0ZXMgdG8gKipFQ01BU2NyaXB0IDUqKidzIG5hdGl2ZSBgaW5kZXhPZmAgaWYgYXZhaWxhYmxlLlxuICAvLyBJZiB0aGUgYXJyYXkgaXMgbGFyZ2UgYW5kIGFscmVhZHkgaW4gc29ydCBvcmRlciwgcGFzcyBgdHJ1ZWBcbiAgLy8gZm9yICoqaXNTb3J0ZWQqKiB0byB1c2UgYmluYXJ5IHNlYXJjaC5cbiAgXy5pbmRleE9mID0gZnVuY3Rpb24oYXJyYXksIGl0ZW0sIGlzU29ydGVkKSB7XG4gICAgaWYgKGFycmF5ID09IG51bGwpIHJldHVybiAtMTtcbiAgICB2YXIgaSA9IDAsIGxlbmd0aCA9IGFycmF5Lmxlbmd0aDtcbiAgICBpZiAoaXNTb3J0ZWQpIHtcbiAgICAgIGlmICh0eXBlb2YgaXNTb3J0ZWQgPT0gJ251bWJlcicpIHtcbiAgICAgICAgaSA9IChpc1NvcnRlZCA8IDAgPyBNYXRoLm1heCgwLCBsZW5ndGggKyBpc1NvcnRlZCkgOiBpc1NvcnRlZCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpID0gXy5zb3J0ZWRJbmRleChhcnJheSwgaXRlbSk7XG4gICAgICAgIHJldHVybiBhcnJheVtpXSA9PT0gaXRlbSA/IGkgOiAtMTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKG5hdGl2ZUluZGV4T2YgJiYgYXJyYXkuaW5kZXhPZiA9PT0gbmF0aXZlSW5kZXhPZikgcmV0dXJuIGFycmF5LmluZGV4T2YoaXRlbSwgaXNTb3J0ZWQpO1xuICAgIGZvciAoOyBpIDwgbGVuZ3RoOyBpKyspIGlmIChhcnJheVtpXSA9PT0gaXRlbSkgcmV0dXJuIGk7XG4gICAgcmV0dXJuIC0xO1xuICB9O1xuXG4gIC8vIERlbGVnYXRlcyB0byAqKkVDTUFTY3JpcHQgNSoqJ3MgbmF0aXZlIGBsYXN0SW5kZXhPZmAgaWYgYXZhaWxhYmxlLlxuICBfLmxhc3RJbmRleE9mID0gZnVuY3Rpb24oYXJyYXksIGl0ZW0sIGZyb20pIHtcbiAgICBpZiAoYXJyYXkgPT0gbnVsbCkgcmV0dXJuIC0xO1xuICAgIHZhciBoYXNJbmRleCA9IGZyb20gIT0gbnVsbDtcbiAgICBpZiAobmF0aXZlTGFzdEluZGV4T2YgJiYgYXJyYXkubGFzdEluZGV4T2YgPT09IG5hdGl2ZUxhc3RJbmRleE9mKSB7XG4gICAgICByZXR1cm4gaGFzSW5kZXggPyBhcnJheS5sYXN0SW5kZXhPZihpdGVtLCBmcm9tKSA6IGFycmF5Lmxhc3RJbmRleE9mKGl0ZW0pO1xuICAgIH1cbiAgICB2YXIgaSA9IChoYXNJbmRleCA/IGZyb20gOiBhcnJheS5sZW5ndGgpO1xuICAgIHdoaWxlIChpLS0pIGlmIChhcnJheVtpXSA9PT0gaXRlbSkgcmV0dXJuIGk7XG4gICAgcmV0dXJuIC0xO1xuICB9O1xuXG4gIC8vIEdlbmVyYXRlIGFuIGludGVnZXIgQXJyYXkgY29udGFpbmluZyBhbiBhcml0aG1ldGljIHByb2dyZXNzaW9uLiBBIHBvcnQgb2ZcbiAgLy8gdGhlIG5hdGl2ZSBQeXRob24gYHJhbmdlKClgIGZ1bmN0aW9uLiBTZWVcbiAgLy8gW3RoZSBQeXRob24gZG9jdW1lbnRhdGlvbl0oaHR0cDovL2RvY3MucHl0aG9uLm9yZy9saWJyYXJ5L2Z1bmN0aW9ucy5odG1sI3JhbmdlKS5cbiAgXy5yYW5nZSA9IGZ1bmN0aW9uKHN0YXJ0LCBzdG9wLCBzdGVwKSB7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPD0gMSkge1xuICAgICAgc3RvcCA9IHN0YXJ0IHx8IDA7XG4gICAgICBzdGFydCA9IDA7XG4gICAgfVxuICAgIHN0ZXAgPSBhcmd1bWVudHNbMl0gfHwgMTtcblxuICAgIHZhciBsZW5ndGggPSBNYXRoLm1heChNYXRoLmNlaWwoKHN0b3AgLSBzdGFydCkgLyBzdGVwKSwgMCk7XG4gICAgdmFyIGlkeCA9IDA7XG4gICAgdmFyIHJhbmdlID0gbmV3IEFycmF5KGxlbmd0aCk7XG5cbiAgICB3aGlsZShpZHggPCBsZW5ndGgpIHtcbiAgICAgIHJhbmdlW2lkeCsrXSA9IHN0YXJ0O1xuICAgICAgc3RhcnQgKz0gc3RlcDtcbiAgICB9XG5cbiAgICByZXR1cm4gcmFuZ2U7XG4gIH07XG5cbiAgLy8gRnVuY3Rpb24gKGFoZW0pIEZ1bmN0aW9uc1xuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS1cblxuICAvLyBSZXVzYWJsZSBjb25zdHJ1Y3RvciBmdW5jdGlvbiBmb3IgcHJvdG90eXBlIHNldHRpbmcuXG4gIHZhciBjdG9yID0gZnVuY3Rpb24oKXt9O1xuXG4gIC8vIENyZWF0ZSBhIGZ1bmN0aW9uIGJvdW5kIHRvIGEgZ2l2ZW4gb2JqZWN0IChhc3NpZ25pbmcgYHRoaXNgLCBhbmQgYXJndW1lbnRzLFxuICAvLyBvcHRpb25hbGx5KS4gRGVsZWdhdGVzIHRvICoqRUNNQVNjcmlwdCA1KioncyBuYXRpdmUgYEZ1bmN0aW9uLmJpbmRgIGlmXG4gIC8vIGF2YWlsYWJsZS5cbiAgXy5iaW5kID0gZnVuY3Rpb24oZnVuYywgY29udGV4dCkge1xuICAgIHZhciBhcmdzLCBib3VuZDtcbiAgICBpZiAobmF0aXZlQmluZCAmJiBmdW5jLmJpbmQgPT09IG5hdGl2ZUJpbmQpIHJldHVybiBuYXRpdmVCaW5kLmFwcGx5KGZ1bmMsIHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7XG4gICAgaWYgKCFfLmlzRnVuY3Rpb24oZnVuYykpIHRocm93IG5ldyBUeXBlRXJyb3I7XG4gICAgYXJncyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKTtcbiAgICByZXR1cm4gYm91bmQgPSBmdW5jdGlvbigpIHtcbiAgICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBib3VuZCkpIHJldHVybiBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MuY29uY2F0KHNsaWNlLmNhbGwoYXJndW1lbnRzKSkpO1xuICAgICAgY3Rvci5wcm90b3R5cGUgPSBmdW5jLnByb3RvdHlwZTtcbiAgICAgIHZhciBzZWxmID0gbmV3IGN0b3I7XG4gICAgICBjdG9yLnByb3RvdHlwZSA9IG51bGw7XG4gICAgICB2YXIgcmVzdWx0ID0gZnVuYy5hcHBseShzZWxmLCBhcmdzLmNvbmNhdChzbGljZS5jYWxsKGFyZ3VtZW50cykpKTtcbiAgICAgIGlmIChPYmplY3QocmVzdWx0KSA9PT0gcmVzdWx0KSByZXR1cm4gcmVzdWx0O1xuICAgICAgcmV0dXJuIHNlbGY7XG4gICAgfTtcbiAgfTtcblxuICAvLyBQYXJ0aWFsbHkgYXBwbHkgYSBmdW5jdGlvbiBieSBjcmVhdGluZyBhIHZlcnNpb24gdGhhdCBoYXMgaGFkIHNvbWUgb2YgaXRzXG4gIC8vIGFyZ3VtZW50cyBwcmUtZmlsbGVkLCB3aXRob3V0IGNoYW5naW5nIGl0cyBkeW5hbWljIGB0aGlzYCBjb250ZXh0LiBfIGFjdHNcbiAgLy8gYXMgYSBwbGFjZWhvbGRlciwgYWxsb3dpbmcgYW55IGNvbWJpbmF0aW9uIG9mIGFyZ3VtZW50cyB0byBiZSBwcmUtZmlsbGVkLlxuICBfLnBhcnRpYWwgPSBmdW5jdGlvbihmdW5jKSB7XG4gICAgdmFyIGJvdW5kQXJncyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTtcbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcG9zaXRpb24gPSAwO1xuICAgICAgdmFyIGFyZ3MgPSBib3VuZEFyZ3Muc2xpY2UoKTtcbiAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBhcmdzLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChhcmdzW2ldID09PSBfKSBhcmdzW2ldID0gYXJndW1lbnRzW3Bvc2l0aW9uKytdO1xuICAgICAgfVxuICAgICAgd2hpbGUgKHBvc2l0aW9uIDwgYXJndW1lbnRzLmxlbmd0aCkgYXJncy5wdXNoKGFyZ3VtZW50c1twb3NpdGlvbisrXSk7XG4gICAgICByZXR1cm4gZnVuYy5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICB9O1xuICB9O1xuXG4gIC8vIEJpbmQgYSBudW1iZXIgb2YgYW4gb2JqZWN0J3MgbWV0aG9kcyB0byB0aGF0IG9iamVjdC4gUmVtYWluaW5nIGFyZ3VtZW50c1xuICAvLyBhcmUgdGhlIG1ldGhvZCBuYW1lcyB0byBiZSBib3VuZC4gVXNlZnVsIGZvciBlbnN1cmluZyB0aGF0IGFsbCBjYWxsYmFja3NcbiAgLy8gZGVmaW5lZCBvbiBhbiBvYmplY3QgYmVsb25nIHRvIGl0LlxuICBfLmJpbmRBbGwgPSBmdW5jdGlvbihvYmopIHtcbiAgICB2YXIgZnVuY3MgPSBzbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XG4gICAgaWYgKGZ1bmNzLmxlbmd0aCA9PT0gMCkgdGhyb3cgbmV3IEVycm9yKCdiaW5kQWxsIG11c3QgYmUgcGFzc2VkIGZ1bmN0aW9uIG5hbWVzJyk7XG4gICAgZWFjaChmdW5jcywgZnVuY3Rpb24oZikgeyBvYmpbZl0gPSBfLmJpbmQob2JqW2ZdLCBvYmopOyB9KTtcbiAgICByZXR1cm4gb2JqO1xuICB9O1xuXG4gIC8vIE1lbW9pemUgYW4gZXhwZW5zaXZlIGZ1bmN0aW9uIGJ5IHN0b3JpbmcgaXRzIHJlc3VsdHMuXG4gIF8ubWVtb2l6ZSA9IGZ1bmN0aW9uKGZ1bmMsIGhhc2hlcikge1xuICAgIHZhciBtZW1vID0ge307XG4gICAgaGFzaGVyIHx8IChoYXNoZXIgPSBfLmlkZW50aXR5KTtcbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIga2V5ID0gaGFzaGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICByZXR1cm4gXy5oYXMobWVtbywga2V5KSA/IG1lbW9ba2V5XSA6IChtZW1vW2tleV0gPSBmdW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpO1xuICAgIH07XG4gIH07XG5cbiAgLy8gRGVsYXlzIGEgZnVuY3Rpb24gZm9yIHRoZSBnaXZlbiBudW1iZXIgb2YgbWlsbGlzZWNvbmRzLCBhbmQgdGhlbiBjYWxsc1xuICAvLyBpdCB3aXRoIHRoZSBhcmd1bWVudHMgc3VwcGxpZWQuXG4gIF8uZGVsYXkgPSBmdW5jdGlvbihmdW5jLCB3YWl0KSB7XG4gICAgdmFyIGFyZ3MgPSBzbGljZS5jYWxsKGFyZ3VtZW50cywgMik7XG4gICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuY3Rpb24oKXsgcmV0dXJuIGZ1bmMuYXBwbHkobnVsbCwgYXJncyk7IH0sIHdhaXQpO1xuICB9O1xuXG4gIC8vIERlZmVycyBhIGZ1bmN0aW9uLCBzY2hlZHVsaW5nIGl0IHRvIHJ1biBhZnRlciB0aGUgY3VycmVudCBjYWxsIHN0YWNrIGhhc1xuICAvLyBjbGVhcmVkLlxuICBfLmRlZmVyID0gZnVuY3Rpb24oZnVuYykge1xuICAgIHJldHVybiBfLmRlbGF5LmFwcGx5KF8sIFtmdW5jLCAxXS5jb25jYXQoc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKSk7XG4gIH07XG5cbiAgLy8gUmV0dXJucyBhIGZ1bmN0aW9uLCB0aGF0LCB3aGVuIGludm9rZWQsIHdpbGwgb25seSBiZSB0cmlnZ2VyZWQgYXQgbW9zdCBvbmNlXG4gIC8vIGR1cmluZyBhIGdpdmVuIHdpbmRvdyBvZiB0aW1lLiBOb3JtYWxseSwgdGhlIHRocm90dGxlZCBmdW5jdGlvbiB3aWxsIHJ1blxuICAvLyBhcyBtdWNoIGFzIGl0IGNhbiwgd2l0aG91dCBldmVyIGdvaW5nIG1vcmUgdGhhbiBvbmNlIHBlciBgd2FpdGAgZHVyYXRpb247XG4gIC8vIGJ1dCBpZiB5b3UnZCBsaWtlIHRvIGRpc2FibGUgdGhlIGV4ZWN1dGlvbiBvbiB0aGUgbGVhZGluZyBlZGdlLCBwYXNzXG4gIC8vIGB7bGVhZGluZzogZmFsc2V9YC4gVG8gZGlzYWJsZSBleGVjdXRpb24gb24gdGhlIHRyYWlsaW5nIGVkZ2UsIGRpdHRvLlxuICBfLnRocm90dGxlID0gZnVuY3Rpb24oZnVuYywgd2FpdCwgb3B0aW9ucykge1xuICAgIHZhciBjb250ZXh0LCBhcmdzLCByZXN1bHQ7XG4gICAgdmFyIHRpbWVvdXQgPSBudWxsO1xuICAgIHZhciBwcmV2aW91cyA9IDA7XG4gICAgb3B0aW9ucyB8fCAob3B0aW9ucyA9IHt9KTtcbiAgICB2YXIgbGF0ZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgIHByZXZpb3VzID0gb3B0aW9ucy5sZWFkaW5nID09PSBmYWxzZSA/IDAgOiBfLm5vdygpO1xuICAgICAgdGltZW91dCA9IG51bGw7XG4gICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xuICAgICAgY29udGV4dCA9IGFyZ3MgPSBudWxsO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIG5vdyA9IF8ubm93KCk7XG4gICAgICBpZiAoIXByZXZpb3VzICYmIG9wdGlvbnMubGVhZGluZyA9PT0gZmFsc2UpIHByZXZpb3VzID0gbm93O1xuICAgICAgdmFyIHJlbWFpbmluZyA9IHdhaXQgLSAobm93IC0gcHJldmlvdXMpO1xuICAgICAgY29udGV4dCA9IHRoaXM7XG4gICAgICBhcmdzID0gYXJndW1lbnRzO1xuICAgICAgaWYgKHJlbWFpbmluZyA8PSAwKSB7XG4gICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcbiAgICAgICAgdGltZW91dCA9IG51bGw7XG4gICAgICAgIHByZXZpb3VzID0gbm93O1xuICAgICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xuICAgICAgICBjb250ZXh0ID0gYXJncyA9IG51bGw7XG4gICAgICB9IGVsc2UgaWYgKCF0aW1lb3V0ICYmIG9wdGlvbnMudHJhaWxpbmcgIT09IGZhbHNlKSB7XG4gICAgICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGxhdGVyLCByZW1haW5pbmcpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICB9O1xuXG4gIC8vIFJldHVybnMgYSBmdW5jdGlvbiwgdGhhdCwgYXMgbG9uZyBhcyBpdCBjb250aW51ZXMgdG8gYmUgaW52b2tlZCwgd2lsbCBub3RcbiAgLy8gYmUgdHJpZ2dlcmVkLiBUaGUgZnVuY3Rpb24gd2lsbCBiZSBjYWxsZWQgYWZ0ZXIgaXQgc3RvcHMgYmVpbmcgY2FsbGVkIGZvclxuICAvLyBOIG1pbGxpc2Vjb25kcy4gSWYgYGltbWVkaWF0ZWAgaXMgcGFzc2VkLCB0cmlnZ2VyIHRoZSBmdW5jdGlvbiBvbiB0aGVcbiAgLy8gbGVhZGluZyBlZGdlLCBpbnN0ZWFkIG9mIHRoZSB0cmFpbGluZy5cbiAgXy5kZWJvdW5jZSA9IGZ1bmN0aW9uKGZ1bmMsIHdhaXQsIGltbWVkaWF0ZSkge1xuICAgIHZhciB0aW1lb3V0LCBhcmdzLCBjb250ZXh0LCB0aW1lc3RhbXAsIHJlc3VsdDtcblxuICAgIHZhciBsYXRlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGxhc3QgPSBfLm5vdygpIC0gdGltZXN0YW1wO1xuICAgICAgaWYgKGxhc3QgPCB3YWl0KSB7XG4gICAgICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGxhdGVyLCB3YWl0IC0gbGFzdCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aW1lb3V0ID0gbnVsbDtcbiAgICAgICAgaWYgKCFpbW1lZGlhdGUpIHtcbiAgICAgICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xuICAgICAgICAgIGNvbnRleHQgPSBhcmdzID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICBjb250ZXh0ID0gdGhpcztcbiAgICAgIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICB0aW1lc3RhbXAgPSBfLm5vdygpO1xuICAgICAgdmFyIGNhbGxOb3cgPSBpbW1lZGlhdGUgJiYgIXRpbWVvdXQ7XG4gICAgICBpZiAoIXRpbWVvdXQpIHtcbiAgICAgICAgdGltZW91dCA9IHNldFRpbWVvdXQobGF0ZXIsIHdhaXQpO1xuICAgICAgfVxuICAgICAgaWYgKGNhbGxOb3cpIHtcbiAgICAgICAgcmVzdWx0ID0gZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcbiAgICAgICAgY29udGV4dCA9IGFyZ3MgPSBudWxsO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gIH07XG5cbiAgLy8gUmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBleGVjdXRlZCBhdCBtb3N0IG9uZSB0aW1lLCBubyBtYXR0ZXIgaG93XG4gIC8vIG9mdGVuIHlvdSBjYWxsIGl0LiBVc2VmdWwgZm9yIGxhenkgaW5pdGlhbGl6YXRpb24uXG4gIF8ub25jZSA9IGZ1bmN0aW9uKGZ1bmMpIHtcbiAgICB2YXIgcmFuID0gZmFsc2UsIG1lbW87XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHJhbikgcmV0dXJuIG1lbW87XG4gICAgICByYW4gPSB0cnVlO1xuICAgICAgbWVtbyA9IGZ1bmMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIGZ1bmMgPSBudWxsO1xuICAgICAgcmV0dXJuIG1lbW87XG4gICAgfTtcbiAgfTtcblxuICAvLyBSZXR1cm5zIHRoZSBmaXJzdCBmdW5jdGlvbiBwYXNzZWQgYXMgYW4gYXJndW1lbnQgdG8gdGhlIHNlY29uZCxcbiAgLy8gYWxsb3dpbmcgeW91IHRvIGFkanVzdCBhcmd1bWVudHMsIHJ1biBjb2RlIGJlZm9yZSBhbmQgYWZ0ZXIsIGFuZFxuICAvLyBjb25kaXRpb25hbGx5IGV4ZWN1dGUgdGhlIG9yaWdpbmFsIGZ1bmN0aW9uLlxuICBfLndyYXAgPSBmdW5jdGlvbihmdW5jLCB3cmFwcGVyKSB7XG4gICAgcmV0dXJuIF8ucGFydGlhbCh3cmFwcGVyLCBmdW5jKTtcbiAgfTtcblxuICAvLyBSZXR1cm5zIGEgZnVuY3Rpb24gdGhhdCBpcyB0aGUgY29tcG9zaXRpb24gb2YgYSBsaXN0IG9mIGZ1bmN0aW9ucywgZWFjaFxuICAvLyBjb25zdW1pbmcgdGhlIHJldHVybiB2YWx1ZSBvZiB0aGUgZnVuY3Rpb24gdGhhdCBmb2xsb3dzLlxuICBfLmNvbXBvc2UgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgZnVuY3MgPSBhcmd1bWVudHM7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICBmb3IgKHZhciBpID0gZnVuY3MubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgYXJncyA9IFtmdW5jc1tpXS5hcHBseSh0aGlzLCBhcmdzKV07XG4gICAgICB9XG4gICAgICByZXR1cm4gYXJnc1swXTtcbiAgICB9O1xuICB9O1xuXG4gIC8vIFJldHVybnMgYSBmdW5jdGlvbiB0aGF0IHdpbGwgb25seSBiZSBleGVjdXRlZCBhZnRlciBiZWluZyBjYWxsZWQgTiB0aW1lcy5cbiAgXy5hZnRlciA9IGZ1bmN0aW9uKHRpbWVzLCBmdW5jKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKC0tdGltZXMgPCAxKSB7XG4gICAgICAgIHJldHVybiBmdW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB9XG4gICAgfTtcbiAgfTtcblxuICAvLyBPYmplY3QgRnVuY3Rpb25zXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS1cblxuICAvLyBSZXRyaWV2ZSB0aGUgbmFtZXMgb2YgYW4gb2JqZWN0J3MgcHJvcGVydGllcy5cbiAgLy8gRGVsZWdhdGVzIHRvICoqRUNNQVNjcmlwdCA1KioncyBuYXRpdmUgYE9iamVjdC5rZXlzYFxuICBfLmtleXMgPSBmdW5jdGlvbihvYmopIHtcbiAgICBpZiAoIV8uaXNPYmplY3Qob2JqKSkgcmV0dXJuIFtdO1xuICAgIGlmIChuYXRpdmVLZXlzKSByZXR1cm4gbmF0aXZlS2V5cyhvYmopO1xuICAgIHZhciBrZXlzID0gW107XG4gICAgZm9yICh2YXIga2V5IGluIG9iaikgaWYgKF8uaGFzKG9iaiwga2V5KSkga2V5cy5wdXNoKGtleSk7XG4gICAgcmV0dXJuIGtleXM7XG4gIH07XG5cbiAgLy8gUmV0cmlldmUgdGhlIHZhbHVlcyBvZiBhbiBvYmplY3QncyBwcm9wZXJ0aWVzLlxuICBfLnZhbHVlcyA9IGZ1bmN0aW9uKG9iaikge1xuICAgIHZhciBrZXlzID0gXy5rZXlzKG9iaik7XG4gICAgdmFyIGxlbmd0aCA9IGtleXMubGVuZ3RoO1xuICAgIHZhciB2YWx1ZXMgPSBuZXcgQXJyYXkobGVuZ3RoKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICB2YWx1ZXNbaV0gPSBvYmpba2V5c1tpXV07XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZXM7XG4gIH07XG5cbiAgLy8gQ29udmVydCBhbiBvYmplY3QgaW50byBhIGxpc3Qgb2YgYFtrZXksIHZhbHVlXWAgcGFpcnMuXG4gIF8ucGFpcnMgPSBmdW5jdGlvbihvYmopIHtcbiAgICB2YXIga2V5cyA9IF8ua2V5cyhvYmopO1xuICAgIHZhciBsZW5ndGggPSBrZXlzLmxlbmd0aDtcbiAgICB2YXIgcGFpcnMgPSBuZXcgQXJyYXkobGVuZ3RoKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICBwYWlyc1tpXSA9IFtrZXlzW2ldLCBvYmpba2V5c1tpXV1dO1xuICAgIH1cbiAgICByZXR1cm4gcGFpcnM7XG4gIH07XG5cbiAgLy8gSW52ZXJ0IHRoZSBrZXlzIGFuZCB2YWx1ZXMgb2YgYW4gb2JqZWN0LiBUaGUgdmFsdWVzIG11c3QgYmUgc2VyaWFsaXphYmxlLlxuICBfLmludmVydCA9IGZ1bmN0aW9uKG9iaikge1xuICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICB2YXIga2V5cyA9IF8ua2V5cyhvYmopO1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBrZXlzLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICByZXN1bHRbb2JqW2tleXNbaV1dXSA9IGtleXNbaV07XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH07XG5cbiAgLy8gUmV0dXJuIGEgc29ydGVkIGxpc3Qgb2YgdGhlIGZ1bmN0aW9uIG5hbWVzIGF2YWlsYWJsZSBvbiB0aGUgb2JqZWN0LlxuICAvLyBBbGlhc2VkIGFzIGBtZXRob2RzYFxuICBfLmZ1bmN0aW9ucyA9IF8ubWV0aG9kcyA9IGZ1bmN0aW9uKG9iaikge1xuICAgIHZhciBuYW1lcyA9IFtdO1xuICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcbiAgICAgIGlmIChfLmlzRnVuY3Rpb24ob2JqW2tleV0pKSBuYW1lcy5wdXNoKGtleSk7XG4gICAgfVxuICAgIHJldHVybiBuYW1lcy5zb3J0KCk7XG4gIH07XG5cbiAgLy8gRXh0ZW5kIGEgZ2l2ZW4gb2JqZWN0IHdpdGggYWxsIHRoZSBwcm9wZXJ0aWVzIGluIHBhc3NlZC1pbiBvYmplY3QocykuXG4gIF8uZXh0ZW5kID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgZWFjaChzbGljZS5jYWxsKGFyZ3VtZW50cywgMSksIGZ1bmN0aW9uKHNvdXJjZSkge1xuICAgICAgaWYgKHNvdXJjZSkge1xuICAgICAgICBmb3IgKHZhciBwcm9wIGluIHNvdXJjZSkge1xuICAgICAgICAgIG9ialtwcm9wXSA9IHNvdXJjZVtwcm9wXTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBvYmo7XG4gIH07XG5cbiAgLy8gUmV0dXJuIGEgY29weSBvZiB0aGUgb2JqZWN0IG9ubHkgY29udGFpbmluZyB0aGUgd2hpdGVsaXN0ZWQgcHJvcGVydGllcy5cbiAgXy5waWNrID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgdmFyIGNvcHkgPSB7fTtcbiAgICB2YXIga2V5cyA9IGNvbmNhdC5hcHBseShBcnJheVByb3RvLCBzbGljZS5jYWxsKGFyZ3VtZW50cywgMSkpO1xuICAgIGVhY2goa2V5cywgZnVuY3Rpb24oa2V5KSB7XG4gICAgICBpZiAoa2V5IGluIG9iaikgY29weVtrZXldID0gb2JqW2tleV07XG4gICAgfSk7XG4gICAgcmV0dXJuIGNvcHk7XG4gIH07XG5cbiAgIC8vIFJldHVybiBhIGNvcHkgb2YgdGhlIG9iamVjdCB3aXRob3V0IHRoZSBibGFja2xpc3RlZCBwcm9wZXJ0aWVzLlxuICBfLm9taXQgPSBmdW5jdGlvbihvYmopIHtcbiAgICB2YXIgY29weSA9IHt9O1xuICAgIHZhciBrZXlzID0gY29uY2F0LmFwcGx5KEFycmF5UHJvdG8sIHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7XG4gICAgZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgICAgaWYgKCFfLmNvbnRhaW5zKGtleXMsIGtleSkpIGNvcHlba2V5XSA9IG9ialtrZXldO1xuICAgIH1cbiAgICByZXR1cm4gY29weTtcbiAgfTtcblxuICAvLyBGaWxsIGluIGEgZ2l2ZW4gb2JqZWN0IHdpdGggZGVmYXVsdCBwcm9wZXJ0aWVzLlxuICBfLmRlZmF1bHRzID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgZWFjaChzbGljZS5jYWxsKGFyZ3VtZW50cywgMSksIGZ1bmN0aW9uKHNvdXJjZSkge1xuICAgICAgaWYgKHNvdXJjZSkge1xuICAgICAgICBmb3IgKHZhciBwcm9wIGluIHNvdXJjZSkge1xuICAgICAgICAgIGlmIChvYmpbcHJvcF0gPT09IHZvaWQgMCkgb2JqW3Byb3BdID0gc291cmNlW3Byb3BdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIG9iajtcbiAgfTtcblxuICAvLyBDcmVhdGUgYSAoc2hhbGxvdy1jbG9uZWQpIGR1cGxpY2F0ZSBvZiBhbiBvYmplY3QuXG4gIF8uY2xvbmUgPSBmdW5jdGlvbihvYmopIHtcbiAgICBpZiAoIV8uaXNPYmplY3Qob2JqKSkgcmV0dXJuIG9iajtcbiAgICByZXR1cm4gXy5pc0FycmF5KG9iaikgPyBvYmouc2xpY2UoKSA6IF8uZXh0ZW5kKHt9LCBvYmopO1xuICB9O1xuXG4gIC8vIEludm9rZXMgaW50ZXJjZXB0b3Igd2l0aCB0aGUgb2JqLCBhbmQgdGhlbiByZXR1cm5zIG9iai5cbiAgLy8gVGhlIHByaW1hcnkgcHVycG9zZSBvZiB0aGlzIG1ldGhvZCBpcyB0byBcInRhcCBpbnRvXCIgYSBtZXRob2QgY2hhaW4sIGluXG4gIC8vIG9yZGVyIHRvIHBlcmZvcm0gb3BlcmF0aW9ucyBvbiBpbnRlcm1lZGlhdGUgcmVzdWx0cyB3aXRoaW4gdGhlIGNoYWluLlxuICBfLnRhcCA9IGZ1bmN0aW9uKG9iaiwgaW50ZXJjZXB0b3IpIHtcbiAgICBpbnRlcmNlcHRvcihvYmopO1xuICAgIHJldHVybiBvYmo7XG4gIH07XG5cbiAgLy8gSW50ZXJuYWwgcmVjdXJzaXZlIGNvbXBhcmlzb24gZnVuY3Rpb24gZm9yIGBpc0VxdWFsYC5cbiAgdmFyIGVxID0gZnVuY3Rpb24oYSwgYiwgYVN0YWNrLCBiU3RhY2spIHtcbiAgICAvLyBJZGVudGljYWwgb2JqZWN0cyBhcmUgZXF1YWwuIGAwID09PSAtMGAsIGJ1dCB0aGV5IGFyZW4ndCBpZGVudGljYWwuXG4gICAgLy8gU2VlIHRoZSBbSGFybW9ueSBgZWdhbGAgcHJvcG9zYWxdKGh0dHA6Ly93aWtpLmVjbWFzY3JpcHQub3JnL2Rva3UucGhwP2lkPWhhcm1vbnk6ZWdhbCkuXG4gICAgaWYgKGEgPT09IGIpIHJldHVybiBhICE9PSAwIHx8IDEgLyBhID09IDEgLyBiO1xuICAgIC8vIEEgc3RyaWN0IGNvbXBhcmlzb24gaXMgbmVjZXNzYXJ5IGJlY2F1c2UgYG51bGwgPT0gdW5kZWZpbmVkYC5cbiAgICBpZiAoYSA9PSBudWxsIHx8IGIgPT0gbnVsbCkgcmV0dXJuIGEgPT09IGI7XG4gICAgLy8gVW53cmFwIGFueSB3cmFwcGVkIG9iamVjdHMuXG4gICAgaWYgKGEgaW5zdGFuY2VvZiBfKSBhID0gYS5fd3JhcHBlZDtcbiAgICBpZiAoYiBpbnN0YW5jZW9mIF8pIGIgPSBiLl93cmFwcGVkO1xuICAgIC8vIENvbXBhcmUgYFtbQ2xhc3NdXWAgbmFtZXMuXG4gICAgdmFyIGNsYXNzTmFtZSA9IHRvU3RyaW5nLmNhbGwoYSk7XG4gICAgaWYgKGNsYXNzTmFtZSAhPSB0b1N0cmluZy5jYWxsKGIpKSByZXR1cm4gZmFsc2U7XG4gICAgc3dpdGNoIChjbGFzc05hbWUpIHtcbiAgICAgIC8vIFN0cmluZ3MsIG51bWJlcnMsIGRhdGVzLCBhbmQgYm9vbGVhbnMgYXJlIGNvbXBhcmVkIGJ5IHZhbHVlLlxuICAgICAgY2FzZSAnW29iamVjdCBTdHJpbmddJzpcbiAgICAgICAgLy8gUHJpbWl0aXZlcyBhbmQgdGhlaXIgY29ycmVzcG9uZGluZyBvYmplY3Qgd3JhcHBlcnMgYXJlIGVxdWl2YWxlbnQ7IHRodXMsIGBcIjVcImAgaXNcbiAgICAgICAgLy8gZXF1aXZhbGVudCB0byBgbmV3IFN0cmluZyhcIjVcIilgLlxuICAgICAgICByZXR1cm4gYSA9PSBTdHJpbmcoYik7XG4gICAgICBjYXNlICdbb2JqZWN0IE51bWJlcl0nOlxuICAgICAgICAvLyBgTmFOYHMgYXJlIGVxdWl2YWxlbnQsIGJ1dCBub24tcmVmbGV4aXZlLiBBbiBgZWdhbGAgY29tcGFyaXNvbiBpcyBwZXJmb3JtZWQgZm9yXG4gICAgICAgIC8vIG90aGVyIG51bWVyaWMgdmFsdWVzLlxuICAgICAgICByZXR1cm4gYSAhPSArYSA/IGIgIT0gK2IgOiAoYSA9PSAwID8gMSAvIGEgPT0gMSAvIGIgOiBhID09ICtiKTtcbiAgICAgIGNhc2UgJ1tvYmplY3QgRGF0ZV0nOlxuICAgICAgY2FzZSAnW29iamVjdCBCb29sZWFuXSc6XG4gICAgICAgIC8vIENvZXJjZSBkYXRlcyBhbmQgYm9vbGVhbnMgdG8gbnVtZXJpYyBwcmltaXRpdmUgdmFsdWVzLiBEYXRlcyBhcmUgY29tcGFyZWQgYnkgdGhlaXJcbiAgICAgICAgLy8gbWlsbGlzZWNvbmQgcmVwcmVzZW50YXRpb25zLiBOb3RlIHRoYXQgaW52YWxpZCBkYXRlcyB3aXRoIG1pbGxpc2Vjb25kIHJlcHJlc2VudGF0aW9uc1xuICAgICAgICAvLyBvZiBgTmFOYCBhcmUgbm90IGVxdWl2YWxlbnQuXG4gICAgICAgIHJldHVybiArYSA9PSArYjtcbiAgICAgIC8vIFJlZ0V4cHMgYXJlIGNvbXBhcmVkIGJ5IHRoZWlyIHNvdXJjZSBwYXR0ZXJucyBhbmQgZmxhZ3MuXG4gICAgICBjYXNlICdbb2JqZWN0IFJlZ0V4cF0nOlxuICAgICAgICByZXR1cm4gYS5zb3VyY2UgPT0gYi5zb3VyY2UgJiZcbiAgICAgICAgICAgICAgIGEuZ2xvYmFsID09IGIuZ2xvYmFsICYmXG4gICAgICAgICAgICAgICBhLm11bHRpbGluZSA9PSBiLm11bHRpbGluZSAmJlxuICAgICAgICAgICAgICAgYS5pZ25vcmVDYXNlID09IGIuaWdub3JlQ2FzZTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBhICE9ICdvYmplY3QnIHx8IHR5cGVvZiBiICE9ICdvYmplY3QnKSByZXR1cm4gZmFsc2U7XG4gICAgLy8gQXNzdW1lIGVxdWFsaXR5IGZvciBjeWNsaWMgc3RydWN0dXJlcy4gVGhlIGFsZ29yaXRobSBmb3IgZGV0ZWN0aW5nIGN5Y2xpY1xuICAgIC8vIHN0cnVjdHVyZXMgaXMgYWRhcHRlZCBmcm9tIEVTIDUuMSBzZWN0aW9uIDE1LjEyLjMsIGFic3RyYWN0IG9wZXJhdGlvbiBgSk9gLlxuICAgIHZhciBsZW5ndGggPSBhU3RhY2subGVuZ3RoO1xuICAgIHdoaWxlIChsZW5ndGgtLSkge1xuICAgICAgLy8gTGluZWFyIHNlYXJjaC4gUGVyZm9ybWFuY2UgaXMgaW52ZXJzZWx5IHByb3BvcnRpb25hbCB0byB0aGUgbnVtYmVyIG9mXG4gICAgICAvLyB1bmlxdWUgbmVzdGVkIHN0cnVjdHVyZXMuXG4gICAgICBpZiAoYVN0YWNrW2xlbmd0aF0gPT0gYSkgcmV0dXJuIGJTdGFja1tsZW5ndGhdID09IGI7XG4gICAgfVxuICAgIC8vIE9iamVjdHMgd2l0aCBkaWZmZXJlbnQgY29uc3RydWN0b3JzIGFyZSBub3QgZXF1aXZhbGVudCwgYnV0IGBPYmplY3Rgc1xuICAgIC8vIGZyb20gZGlmZmVyZW50IGZyYW1lcyBhcmUuXG4gICAgdmFyIGFDdG9yID0gYS5jb25zdHJ1Y3RvciwgYkN0b3IgPSBiLmNvbnN0cnVjdG9yO1xuICAgIGlmIChhQ3RvciAhPT0gYkN0b3IgJiYgIShfLmlzRnVuY3Rpb24oYUN0b3IpICYmIChhQ3RvciBpbnN0YW5jZW9mIGFDdG9yKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfLmlzRnVuY3Rpb24oYkN0b3IpICYmIChiQ3RvciBpbnN0YW5jZW9mIGJDdG9yKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICYmICgnY29uc3RydWN0b3InIGluIGEgJiYgJ2NvbnN0cnVjdG9yJyBpbiBiKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICAvLyBBZGQgdGhlIGZpcnN0IG9iamVjdCB0byB0aGUgc3RhY2sgb2YgdHJhdmVyc2VkIG9iamVjdHMuXG4gICAgYVN0YWNrLnB1c2goYSk7XG4gICAgYlN0YWNrLnB1c2goYik7XG4gICAgdmFyIHNpemUgPSAwLCByZXN1bHQgPSB0cnVlO1xuICAgIC8vIFJlY3Vyc2l2ZWx5IGNvbXBhcmUgb2JqZWN0cyBhbmQgYXJyYXlzLlxuICAgIGlmIChjbGFzc05hbWUgPT0gJ1tvYmplY3QgQXJyYXldJykge1xuICAgICAgLy8gQ29tcGFyZSBhcnJheSBsZW5ndGhzIHRvIGRldGVybWluZSBpZiBhIGRlZXAgY29tcGFyaXNvbiBpcyBuZWNlc3NhcnkuXG4gICAgICBzaXplID0gYS5sZW5ndGg7XG4gICAgICByZXN1bHQgPSBzaXplID09IGIubGVuZ3RoO1xuICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAvLyBEZWVwIGNvbXBhcmUgdGhlIGNvbnRlbnRzLCBpZ25vcmluZyBub24tbnVtZXJpYyBwcm9wZXJ0aWVzLlxuICAgICAgICB3aGlsZSAoc2l6ZS0tKSB7XG4gICAgICAgICAgaWYgKCEocmVzdWx0ID0gZXEoYVtzaXplXSwgYltzaXplXSwgYVN0YWNrLCBiU3RhY2spKSkgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gRGVlcCBjb21wYXJlIG9iamVjdHMuXG4gICAgICBmb3IgKHZhciBrZXkgaW4gYSkge1xuICAgICAgICBpZiAoXy5oYXMoYSwga2V5KSkge1xuICAgICAgICAgIC8vIENvdW50IHRoZSBleHBlY3RlZCBudW1iZXIgb2YgcHJvcGVydGllcy5cbiAgICAgICAgICBzaXplKys7XG4gICAgICAgICAgLy8gRGVlcCBjb21wYXJlIGVhY2ggbWVtYmVyLlxuICAgICAgICAgIGlmICghKHJlc3VsdCA9IF8uaGFzKGIsIGtleSkgJiYgZXEoYVtrZXldLCBiW2tleV0sIGFTdGFjaywgYlN0YWNrKSkpIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICAvLyBFbnN1cmUgdGhhdCBib3RoIG9iamVjdHMgY29udGFpbiB0aGUgc2FtZSBudW1iZXIgb2YgcHJvcGVydGllcy5cbiAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgZm9yIChrZXkgaW4gYikge1xuICAgICAgICAgIGlmIChfLmhhcyhiLCBrZXkpICYmICEoc2l6ZS0tKSkgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0ID0gIXNpemU7XG4gICAgICB9XG4gICAgfVxuICAgIC8vIFJlbW92ZSB0aGUgZmlyc3Qgb2JqZWN0IGZyb20gdGhlIHN0YWNrIG9mIHRyYXZlcnNlZCBvYmplY3RzLlxuICAgIGFTdGFjay5wb3AoKTtcbiAgICBiU3RhY2sucG9wKCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICAvLyBQZXJmb3JtIGEgZGVlcCBjb21wYXJpc29uIHRvIGNoZWNrIGlmIHR3byBvYmplY3RzIGFyZSBlcXVhbC5cbiAgXy5pc0VxdWFsID0gZnVuY3Rpb24oYSwgYikge1xuICAgIHJldHVybiBlcShhLCBiLCBbXSwgW10pO1xuICB9O1xuXG4gIC8vIElzIGEgZ2l2ZW4gYXJyYXksIHN0cmluZywgb3Igb2JqZWN0IGVtcHR5P1xuICAvLyBBbiBcImVtcHR5XCIgb2JqZWN0IGhhcyBubyBlbnVtZXJhYmxlIG93bi1wcm9wZXJ0aWVzLlxuICBfLmlzRW1wdHkgPSBmdW5jdGlvbihvYmopIHtcbiAgICBpZiAob2JqID09IG51bGwpIHJldHVybiB0cnVlO1xuICAgIGlmIChfLmlzQXJyYXkob2JqKSB8fCBfLmlzU3RyaW5nKG9iaikpIHJldHVybiBvYmoubGVuZ3RoID09PSAwO1xuICAgIGZvciAodmFyIGtleSBpbiBvYmopIGlmIChfLmhhcyhvYmosIGtleSkpIHJldHVybiBmYWxzZTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfTtcblxuICAvLyBJcyBhIGdpdmVuIHZhbHVlIGEgRE9NIGVsZW1lbnQ/XG4gIF8uaXNFbGVtZW50ID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgcmV0dXJuICEhKG9iaiAmJiBvYmoubm9kZVR5cGUgPT09IDEpO1xuICB9O1xuXG4gIC8vIElzIGEgZ2l2ZW4gdmFsdWUgYW4gYXJyYXk/XG4gIC8vIERlbGVnYXRlcyB0byBFQ01BNSdzIG5hdGl2ZSBBcnJheS5pc0FycmF5XG4gIF8uaXNBcnJheSA9IG5hdGl2ZUlzQXJyYXkgfHwgZnVuY3Rpb24ob2JqKSB7XG4gICAgcmV0dXJuIHRvU3RyaW5nLmNhbGwob2JqKSA9PSAnW29iamVjdCBBcnJheV0nO1xuICB9O1xuXG4gIC8vIElzIGEgZ2l2ZW4gdmFyaWFibGUgYW4gb2JqZWN0P1xuICBfLmlzT2JqZWN0ID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgcmV0dXJuIG9iaiA9PT0gT2JqZWN0KG9iaik7XG4gIH07XG5cbiAgLy8gQWRkIHNvbWUgaXNUeXBlIG1ldGhvZHM6IGlzQXJndW1lbnRzLCBpc0Z1bmN0aW9uLCBpc1N0cmluZywgaXNOdW1iZXIsIGlzRGF0ZSwgaXNSZWdFeHAuXG4gIGVhY2goWydBcmd1bWVudHMnLCAnRnVuY3Rpb24nLCAnU3RyaW5nJywgJ051bWJlcicsICdEYXRlJywgJ1JlZ0V4cCddLCBmdW5jdGlvbihuYW1lKSB7XG4gICAgX1snaXMnICsgbmFtZV0gPSBmdW5jdGlvbihvYmopIHtcbiAgICAgIHJldHVybiB0b1N0cmluZy5jYWxsKG9iaikgPT0gJ1tvYmplY3QgJyArIG5hbWUgKyAnXSc7XG4gICAgfTtcbiAgfSk7XG5cbiAgLy8gRGVmaW5lIGEgZmFsbGJhY2sgdmVyc2lvbiBvZiB0aGUgbWV0aG9kIGluIGJyb3dzZXJzIChhaGVtLCBJRSksIHdoZXJlXG4gIC8vIHRoZXJlIGlzbid0IGFueSBpbnNwZWN0YWJsZSBcIkFyZ3VtZW50c1wiIHR5cGUuXG4gIGlmICghXy5pc0FyZ3VtZW50cyhhcmd1bWVudHMpKSB7XG4gICAgXy5pc0FyZ3VtZW50cyA9IGZ1bmN0aW9uKG9iaikge1xuICAgICAgcmV0dXJuICEhKG9iaiAmJiBfLmhhcyhvYmosICdjYWxsZWUnKSk7XG4gICAgfTtcbiAgfVxuXG4gIC8vIE9wdGltaXplIGBpc0Z1bmN0aW9uYCBpZiBhcHByb3ByaWF0ZS5cbiAgaWYgKHR5cGVvZiAoLy4vKSAhPT0gJ2Z1bmN0aW9uJykge1xuICAgIF8uaXNGdW5jdGlvbiA9IGZ1bmN0aW9uKG9iaikge1xuICAgICAgcmV0dXJuIHR5cGVvZiBvYmogPT09ICdmdW5jdGlvbic7XG4gICAgfTtcbiAgfVxuXG4gIC8vIElzIGEgZ2l2ZW4gb2JqZWN0IGEgZmluaXRlIG51bWJlcj9cbiAgXy5pc0Zpbml0ZSA9IGZ1bmN0aW9uKG9iaikge1xuICAgIHJldHVybiBpc0Zpbml0ZShvYmopICYmICFpc05hTihwYXJzZUZsb2F0KG9iaikpO1xuICB9O1xuXG4gIC8vIElzIHRoZSBnaXZlbiB2YWx1ZSBgTmFOYD8gKE5hTiBpcyB0aGUgb25seSBudW1iZXIgd2hpY2ggZG9lcyBub3QgZXF1YWwgaXRzZWxmKS5cbiAgXy5pc05hTiA9IGZ1bmN0aW9uKG9iaikge1xuICAgIHJldHVybiBfLmlzTnVtYmVyKG9iaikgJiYgb2JqICE9ICtvYmo7XG4gIH07XG5cbiAgLy8gSXMgYSBnaXZlbiB2YWx1ZSBhIGJvb2xlYW4/XG4gIF8uaXNCb29sZWFuID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgcmV0dXJuIG9iaiA9PT0gdHJ1ZSB8fCBvYmogPT09IGZhbHNlIHx8IHRvU3RyaW5nLmNhbGwob2JqKSA9PSAnW29iamVjdCBCb29sZWFuXSc7XG4gIH07XG5cbiAgLy8gSXMgYSBnaXZlbiB2YWx1ZSBlcXVhbCB0byBudWxsP1xuICBfLmlzTnVsbCA9IGZ1bmN0aW9uKG9iaikge1xuICAgIHJldHVybiBvYmogPT09IG51bGw7XG4gIH07XG5cbiAgLy8gSXMgYSBnaXZlbiB2YXJpYWJsZSB1bmRlZmluZWQ/XG4gIF8uaXNVbmRlZmluZWQgPSBmdW5jdGlvbihvYmopIHtcbiAgICByZXR1cm4gb2JqID09PSB2b2lkIDA7XG4gIH07XG5cbiAgLy8gU2hvcnRjdXQgZnVuY3Rpb24gZm9yIGNoZWNraW5nIGlmIGFuIG9iamVjdCBoYXMgYSBnaXZlbiBwcm9wZXJ0eSBkaXJlY3RseVxuICAvLyBvbiBpdHNlbGYgKGluIG90aGVyIHdvcmRzLCBub3Qgb24gYSBwcm90b3R5cGUpLlxuICBfLmhhcyA9IGZ1bmN0aW9uKG9iaiwga2V5KSB7XG4gICAgcmV0dXJuIGhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpO1xuICB9O1xuXG4gIC8vIFV0aWxpdHkgRnVuY3Rpb25zXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgLy8gUnVuIFVuZGVyc2NvcmUuanMgaW4gKm5vQ29uZmxpY3QqIG1vZGUsIHJldHVybmluZyB0aGUgYF9gIHZhcmlhYmxlIHRvIGl0c1xuICAvLyBwcmV2aW91cyBvd25lci4gUmV0dXJucyBhIHJlZmVyZW5jZSB0byB0aGUgVW5kZXJzY29yZSBvYmplY3QuXG4gIF8ubm9Db25mbGljdCA9IGZ1bmN0aW9uKCkge1xuICAgIHJvb3QuXyA9IHByZXZpb3VzVW5kZXJzY29yZTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvLyBLZWVwIHRoZSBpZGVudGl0eSBmdW5jdGlvbiBhcm91bmQgZm9yIGRlZmF1bHQgaXRlcmF0b3JzLlxuICBfLmlkZW50aXR5ID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWU7XG4gIH07XG5cbiAgXy5jb25zdGFudCA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9O1xuICB9O1xuXG4gIF8ucHJvcGVydHkgPSBmdW5jdGlvbihrZXkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24ob2JqKSB7XG4gICAgICByZXR1cm4gb2JqW2tleV07XG4gICAgfTtcbiAgfTtcblxuICAvLyBSZXR1cm5zIGEgcHJlZGljYXRlIGZvciBjaGVja2luZyB3aGV0aGVyIGFuIG9iamVjdCBoYXMgYSBnaXZlbiBzZXQgb2YgYGtleTp2YWx1ZWAgcGFpcnMuXG4gIF8ubWF0Y2hlcyA9IGZ1bmN0aW9uKGF0dHJzKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKG9iaikge1xuICAgICAgaWYgKG9iaiA9PT0gYXR0cnMpIHJldHVybiB0cnVlOyAvL2F2b2lkIGNvbXBhcmluZyBhbiBvYmplY3QgdG8gaXRzZWxmLlxuICAgICAgZm9yICh2YXIga2V5IGluIGF0dHJzKSB7XG4gICAgICAgIGlmIChhdHRyc1trZXldICE9PSBvYmpba2V5XSlcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH07XG5cbiAgLy8gUnVuIGEgZnVuY3Rpb24gKipuKiogdGltZXMuXG4gIF8udGltZXMgPSBmdW5jdGlvbihuLCBpdGVyYXRvciwgY29udGV4dCkge1xuICAgIHZhciBhY2N1bSA9IEFycmF5KE1hdGgubWF4KDAsIG4pKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG47IGkrKykgYWNjdW1baV0gPSBpdGVyYXRvci5jYWxsKGNvbnRleHQsIGkpO1xuICAgIHJldHVybiBhY2N1bTtcbiAgfTtcblxuICAvLyBSZXR1cm4gYSByYW5kb20gaW50ZWdlciBiZXR3ZWVuIG1pbiBhbmQgbWF4IChpbmNsdXNpdmUpLlxuICBfLnJhbmRvbSA9IGZ1bmN0aW9uKG1pbiwgbWF4KSB7XG4gICAgaWYgKG1heCA9PSBudWxsKSB7XG4gICAgICBtYXggPSBtaW47XG4gICAgICBtaW4gPSAwO1xuICAgIH1cbiAgICByZXR1cm4gbWluICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKG1heCAtIG1pbiArIDEpKTtcbiAgfTtcblxuICAvLyBBIChwb3NzaWJseSBmYXN0ZXIpIHdheSB0byBnZXQgdGhlIGN1cnJlbnQgdGltZXN0YW1wIGFzIGFuIGludGVnZXIuXG4gIF8ubm93ID0gRGF0ZS5ub3cgfHwgZnVuY3Rpb24oKSB7IHJldHVybiBuZXcgRGF0ZSgpLmdldFRpbWUoKTsgfTtcblxuICAvLyBMaXN0IG9mIEhUTUwgZW50aXRpZXMgZm9yIGVzY2FwaW5nLlxuICB2YXIgZW50aXR5TWFwID0ge1xuICAgIGVzY2FwZToge1xuICAgICAgJyYnOiAnJmFtcDsnLFxuICAgICAgJzwnOiAnJmx0OycsXG4gICAgICAnPic6ICcmZ3Q7JyxcbiAgICAgICdcIic6ICcmcXVvdDsnLFxuICAgICAgXCInXCI6ICcmI3gyNzsnXG4gICAgfVxuICB9O1xuICBlbnRpdHlNYXAudW5lc2NhcGUgPSBfLmludmVydChlbnRpdHlNYXAuZXNjYXBlKTtcblxuICAvLyBSZWdleGVzIGNvbnRhaW5pbmcgdGhlIGtleXMgYW5kIHZhbHVlcyBsaXN0ZWQgaW1tZWRpYXRlbHkgYWJvdmUuXG4gIHZhciBlbnRpdHlSZWdleGVzID0ge1xuICAgIGVzY2FwZTogICBuZXcgUmVnRXhwKCdbJyArIF8ua2V5cyhlbnRpdHlNYXAuZXNjYXBlKS5qb2luKCcnKSArICddJywgJ2cnKSxcbiAgICB1bmVzY2FwZTogbmV3IFJlZ0V4cCgnKCcgKyBfLmtleXMoZW50aXR5TWFwLnVuZXNjYXBlKS5qb2luKCd8JykgKyAnKScsICdnJylcbiAgfTtcblxuICAvLyBGdW5jdGlvbnMgZm9yIGVzY2FwaW5nIGFuZCB1bmVzY2FwaW5nIHN0cmluZ3MgdG8vZnJvbSBIVE1MIGludGVycG9sYXRpb24uXG4gIF8uZWFjaChbJ2VzY2FwZScsICd1bmVzY2FwZSddLCBmdW5jdGlvbihtZXRob2QpIHtcbiAgICBfW21ldGhvZF0gPSBmdW5jdGlvbihzdHJpbmcpIHtcbiAgICAgIGlmIChzdHJpbmcgPT0gbnVsbCkgcmV0dXJuICcnO1xuICAgICAgcmV0dXJuICgnJyArIHN0cmluZykucmVwbGFjZShlbnRpdHlSZWdleGVzW21ldGhvZF0sIGZ1bmN0aW9uKG1hdGNoKSB7XG4gICAgICAgIHJldHVybiBlbnRpdHlNYXBbbWV0aG9kXVttYXRjaF07XG4gICAgICB9KTtcbiAgICB9O1xuICB9KTtcblxuICAvLyBJZiB0aGUgdmFsdWUgb2YgdGhlIG5hbWVkIGBwcm9wZXJ0eWAgaXMgYSBmdW5jdGlvbiB0aGVuIGludm9rZSBpdCB3aXRoIHRoZVxuICAvLyBgb2JqZWN0YCBhcyBjb250ZXh0OyBvdGhlcndpc2UsIHJldHVybiBpdC5cbiAgXy5yZXN1bHQgPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7XG4gICAgaWYgKG9iamVjdCA9PSBudWxsKSByZXR1cm4gdm9pZCAwO1xuICAgIHZhciB2YWx1ZSA9IG9iamVjdFtwcm9wZXJ0eV07XG4gICAgcmV0dXJuIF8uaXNGdW5jdGlvbih2YWx1ZSkgPyB2YWx1ZS5jYWxsKG9iamVjdCkgOiB2YWx1ZTtcbiAgfTtcblxuICAvLyBBZGQgeW91ciBvd24gY3VzdG9tIGZ1bmN0aW9ucyB0byB0aGUgVW5kZXJzY29yZSBvYmplY3QuXG4gIF8ubWl4aW4gPSBmdW5jdGlvbihvYmopIHtcbiAgICBlYWNoKF8uZnVuY3Rpb25zKG9iaiksIGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgIHZhciBmdW5jID0gX1tuYW1lXSA9IG9ialtuYW1lXTtcbiAgICAgIF8ucHJvdG90eXBlW25hbWVdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBhcmdzID0gW3RoaXMuX3dyYXBwZWRdO1xuICAgICAgICBwdXNoLmFwcGx5KGFyZ3MsIGFyZ3VtZW50cyk7XG4gICAgICAgIHJldHVybiByZXN1bHQuY2FsbCh0aGlzLCBmdW5jLmFwcGx5KF8sIGFyZ3MpKTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH07XG5cbiAgLy8gR2VuZXJhdGUgYSB1bmlxdWUgaW50ZWdlciBpZCAodW5pcXVlIHdpdGhpbiB0aGUgZW50aXJlIGNsaWVudCBzZXNzaW9uKS5cbiAgLy8gVXNlZnVsIGZvciB0ZW1wb3JhcnkgRE9NIGlkcy5cbiAgdmFyIGlkQ291bnRlciA9IDA7XG4gIF8udW5pcXVlSWQgPSBmdW5jdGlvbihwcmVmaXgpIHtcbiAgICB2YXIgaWQgPSArK2lkQ291bnRlciArICcnO1xuICAgIHJldHVybiBwcmVmaXggPyBwcmVmaXggKyBpZCA6IGlkO1xuICB9O1xuXG4gIC8vIEJ5IGRlZmF1bHQsIFVuZGVyc2NvcmUgdXNlcyBFUkItc3R5bGUgdGVtcGxhdGUgZGVsaW1pdGVycywgY2hhbmdlIHRoZVxuICAvLyBmb2xsb3dpbmcgdGVtcGxhdGUgc2V0dGluZ3MgdG8gdXNlIGFsdGVybmF0aXZlIGRlbGltaXRlcnMuXG4gIF8udGVtcGxhdGVTZXR0aW5ncyA9IHtcbiAgICBldmFsdWF0ZSAgICA6IC88JShbXFxzXFxTXSs/KSU+L2csXG4gICAgaW50ZXJwb2xhdGUgOiAvPCU9KFtcXHNcXFNdKz8pJT4vZyxcbiAgICBlc2NhcGUgICAgICA6IC88JS0oW1xcc1xcU10rPyklPi9nXG4gIH07XG5cbiAgLy8gV2hlbiBjdXN0b21pemluZyBgdGVtcGxhdGVTZXR0aW5nc2AsIGlmIHlvdSBkb24ndCB3YW50IHRvIGRlZmluZSBhblxuICAvLyBpbnRlcnBvbGF0aW9uLCBldmFsdWF0aW9uIG9yIGVzY2FwaW5nIHJlZ2V4LCB3ZSBuZWVkIG9uZSB0aGF0IGlzXG4gIC8vIGd1YXJhbnRlZWQgbm90IHRvIG1hdGNoLlxuICB2YXIgbm9NYXRjaCA9IC8oLileLztcblxuICAvLyBDZXJ0YWluIGNoYXJhY3RlcnMgbmVlZCB0byBiZSBlc2NhcGVkIHNvIHRoYXQgdGhleSBjYW4gYmUgcHV0IGludG8gYVxuICAvLyBzdHJpbmcgbGl0ZXJhbC5cbiAgdmFyIGVzY2FwZXMgPSB7XG4gICAgXCInXCI6ICAgICAgXCInXCIsXG4gICAgJ1xcXFwnOiAgICAgJ1xcXFwnLFxuICAgICdcXHInOiAgICAgJ3InLFxuICAgICdcXG4nOiAgICAgJ24nLFxuICAgICdcXHQnOiAgICAgJ3QnLFxuICAgICdcXHUyMDI4JzogJ3UyMDI4JyxcbiAgICAnXFx1MjAyOSc6ICd1MjAyOSdcbiAgfTtcblxuICB2YXIgZXNjYXBlciA9IC9cXFxcfCd8XFxyfFxcbnxcXHR8XFx1MjAyOHxcXHUyMDI5L2c7XG5cbiAgLy8gSmF2YVNjcmlwdCBtaWNyby10ZW1wbGF0aW5nLCBzaW1pbGFyIHRvIEpvaG4gUmVzaWcncyBpbXBsZW1lbnRhdGlvbi5cbiAgLy8gVW5kZXJzY29yZSB0ZW1wbGF0aW5nIGhhbmRsZXMgYXJiaXRyYXJ5IGRlbGltaXRlcnMsIHByZXNlcnZlcyB3aGl0ZXNwYWNlLFxuICAvLyBhbmQgY29ycmVjdGx5IGVzY2FwZXMgcXVvdGVzIHdpdGhpbiBpbnRlcnBvbGF0ZWQgY29kZS5cbiAgXy50ZW1wbGF0ZSA9IGZ1bmN0aW9uKHRleHQsIGRhdGEsIHNldHRpbmdzKSB7XG4gICAgdmFyIHJlbmRlcjtcbiAgICBzZXR0aW5ncyA9IF8uZGVmYXVsdHMoe30sIHNldHRpbmdzLCBfLnRlbXBsYXRlU2V0dGluZ3MpO1xuXG4gICAgLy8gQ29tYmluZSBkZWxpbWl0ZXJzIGludG8gb25lIHJlZ3VsYXIgZXhwcmVzc2lvbiB2aWEgYWx0ZXJuYXRpb24uXG4gICAgdmFyIG1hdGNoZXIgPSBuZXcgUmVnRXhwKFtcbiAgICAgIChzZXR0aW5ncy5lc2NhcGUgfHwgbm9NYXRjaCkuc291cmNlLFxuICAgICAgKHNldHRpbmdzLmludGVycG9sYXRlIHx8IG5vTWF0Y2gpLnNvdXJjZSxcbiAgICAgIChzZXR0aW5ncy5ldmFsdWF0ZSB8fCBub01hdGNoKS5zb3VyY2VcbiAgICBdLmpvaW4oJ3wnKSArICd8JCcsICdnJyk7XG5cbiAgICAvLyBDb21waWxlIHRoZSB0ZW1wbGF0ZSBzb3VyY2UsIGVzY2FwaW5nIHN0cmluZyBsaXRlcmFscyBhcHByb3ByaWF0ZWx5LlxuICAgIHZhciBpbmRleCA9IDA7XG4gICAgdmFyIHNvdXJjZSA9IFwiX19wKz0nXCI7XG4gICAgdGV4dC5yZXBsYWNlKG1hdGNoZXIsIGZ1bmN0aW9uKG1hdGNoLCBlc2NhcGUsIGludGVycG9sYXRlLCBldmFsdWF0ZSwgb2Zmc2V0KSB7XG4gICAgICBzb3VyY2UgKz0gdGV4dC5zbGljZShpbmRleCwgb2Zmc2V0KVxuICAgICAgICAucmVwbGFjZShlc2NhcGVyLCBmdW5jdGlvbihtYXRjaCkgeyByZXR1cm4gJ1xcXFwnICsgZXNjYXBlc1ttYXRjaF07IH0pO1xuXG4gICAgICBpZiAoZXNjYXBlKSB7XG4gICAgICAgIHNvdXJjZSArPSBcIicrXFxuKChfX3Q9KFwiICsgZXNjYXBlICsgXCIpKT09bnVsbD8nJzpfLmVzY2FwZShfX3QpKStcXG4nXCI7XG4gICAgICB9XG4gICAgICBpZiAoaW50ZXJwb2xhdGUpIHtcbiAgICAgICAgc291cmNlICs9IFwiJytcXG4oKF9fdD0oXCIgKyBpbnRlcnBvbGF0ZSArIFwiKSk9PW51bGw/Jyc6X190KStcXG4nXCI7XG4gICAgICB9XG4gICAgICBpZiAoZXZhbHVhdGUpIHtcbiAgICAgICAgc291cmNlICs9IFwiJztcXG5cIiArIGV2YWx1YXRlICsgXCJcXG5fX3ArPSdcIjtcbiAgICAgIH1cbiAgICAgIGluZGV4ID0gb2Zmc2V0ICsgbWF0Y2gubGVuZ3RoO1xuICAgICAgcmV0dXJuIG1hdGNoO1xuICAgIH0pO1xuICAgIHNvdXJjZSArPSBcIic7XFxuXCI7XG5cbiAgICAvLyBJZiBhIHZhcmlhYmxlIGlzIG5vdCBzcGVjaWZpZWQsIHBsYWNlIGRhdGEgdmFsdWVzIGluIGxvY2FsIHNjb3BlLlxuICAgIGlmICghc2V0dGluZ3MudmFyaWFibGUpIHNvdXJjZSA9ICd3aXRoKG9ianx8e30pe1xcbicgKyBzb3VyY2UgKyAnfVxcbic7XG5cbiAgICBzb3VyY2UgPSBcInZhciBfX3QsX19wPScnLF9faj1BcnJheS5wcm90b3R5cGUuam9pbixcIiArXG4gICAgICBcInByaW50PWZ1bmN0aW9uKCl7X19wKz1fX2ouY2FsbChhcmd1bWVudHMsJycpO307XFxuXCIgK1xuICAgICAgc291cmNlICsgXCJyZXR1cm4gX19wO1xcblwiO1xuXG4gICAgdHJ5IHtcbiAgICAgIHJlbmRlciA9IG5ldyBGdW5jdGlvbihzZXR0aW5ncy52YXJpYWJsZSB8fCAnb2JqJywgJ18nLCBzb3VyY2UpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGUuc291cmNlID0gc291cmNlO1xuICAgICAgdGhyb3cgZTtcbiAgICB9XG5cbiAgICBpZiAoZGF0YSkgcmV0dXJuIHJlbmRlcihkYXRhLCBfKTtcbiAgICB2YXIgdGVtcGxhdGUgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgICByZXR1cm4gcmVuZGVyLmNhbGwodGhpcywgZGF0YSwgXyk7XG4gICAgfTtcblxuICAgIC8vIFByb3ZpZGUgdGhlIGNvbXBpbGVkIGZ1bmN0aW9uIHNvdXJjZSBhcyBhIGNvbnZlbmllbmNlIGZvciBwcmVjb21waWxhdGlvbi5cbiAgICB0ZW1wbGF0ZS5zb3VyY2UgPSAnZnVuY3Rpb24oJyArIChzZXR0aW5ncy52YXJpYWJsZSB8fCAnb2JqJykgKyAnKXtcXG4nICsgc291cmNlICsgJ30nO1xuXG4gICAgcmV0dXJuIHRlbXBsYXRlO1xuICB9O1xuXG4gIC8vIEFkZCBhIFwiY2hhaW5cIiBmdW5jdGlvbiwgd2hpY2ggd2lsbCBkZWxlZ2F0ZSB0byB0aGUgd3JhcHBlci5cbiAgXy5jaGFpbiA9IGZ1bmN0aW9uKG9iaikge1xuICAgIHJldHVybiBfKG9iaikuY2hhaW4oKTtcbiAgfTtcblxuICAvLyBPT1BcbiAgLy8gLS0tLS0tLS0tLS0tLS0tXG4gIC8vIElmIFVuZGVyc2NvcmUgaXMgY2FsbGVkIGFzIGEgZnVuY3Rpb24sIGl0IHJldHVybnMgYSB3cmFwcGVkIG9iamVjdCB0aGF0XG4gIC8vIGNhbiBiZSB1c2VkIE9PLXN0eWxlLiBUaGlzIHdyYXBwZXIgaG9sZHMgYWx0ZXJlZCB2ZXJzaW9ucyBvZiBhbGwgdGhlXG4gIC8vIHVuZGVyc2NvcmUgZnVuY3Rpb25zLiBXcmFwcGVkIG9iamVjdHMgbWF5IGJlIGNoYWluZWQuXG5cbiAgLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGNvbnRpbnVlIGNoYWluaW5nIGludGVybWVkaWF0ZSByZXN1bHRzLlxuICB2YXIgcmVzdWx0ID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgcmV0dXJuIHRoaXMuX2NoYWluID8gXyhvYmopLmNoYWluKCkgOiBvYmo7XG4gIH07XG5cbiAgLy8gQWRkIGFsbCBvZiB0aGUgVW5kZXJzY29yZSBmdW5jdGlvbnMgdG8gdGhlIHdyYXBwZXIgb2JqZWN0LlxuICBfLm1peGluKF8pO1xuXG4gIC8vIEFkZCBhbGwgbXV0YXRvciBBcnJheSBmdW5jdGlvbnMgdG8gdGhlIHdyYXBwZXIuXG4gIGVhY2goWydwb3AnLCAncHVzaCcsICdyZXZlcnNlJywgJ3NoaWZ0JywgJ3NvcnQnLCAnc3BsaWNlJywgJ3Vuc2hpZnQnXSwgZnVuY3Rpb24obmFtZSkge1xuICAgIHZhciBtZXRob2QgPSBBcnJheVByb3RvW25hbWVdO1xuICAgIF8ucHJvdG90eXBlW25hbWVdID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgb2JqID0gdGhpcy5fd3JhcHBlZDtcbiAgICAgIG1ldGhvZC5hcHBseShvYmosIGFyZ3VtZW50cyk7XG4gICAgICBpZiAoKG5hbWUgPT0gJ3NoaWZ0JyB8fCBuYW1lID09ICdzcGxpY2UnKSAmJiBvYmoubGVuZ3RoID09PSAwKSBkZWxldGUgb2JqWzBdO1xuICAgICAgcmV0dXJuIHJlc3VsdC5jYWxsKHRoaXMsIG9iaik7XG4gICAgfTtcbiAgfSk7XG5cbiAgLy8gQWRkIGFsbCBhY2Nlc3NvciBBcnJheSBmdW5jdGlvbnMgdG8gdGhlIHdyYXBwZXIuXG4gIGVhY2goWydjb25jYXQnLCAnam9pbicsICdzbGljZSddLCBmdW5jdGlvbihuYW1lKSB7XG4gICAgdmFyIG1ldGhvZCA9IEFycmF5UHJvdG9bbmFtZV07XG4gICAgXy5wcm90b3R5cGVbbmFtZV0gPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiByZXN1bHQuY2FsbCh0aGlzLCBtZXRob2QuYXBwbHkodGhpcy5fd3JhcHBlZCwgYXJndW1lbnRzKSk7XG4gICAgfTtcbiAgfSk7XG5cbiAgXy5leHRlbmQoXy5wcm90b3R5cGUsIHtcblxuICAgIC8vIFN0YXJ0IGNoYWluaW5nIGEgd3JhcHBlZCBVbmRlcnNjb3JlIG9iamVjdC5cbiAgICBjaGFpbjogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9jaGFpbiA9IHRydWU7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gICAgLy8gRXh0cmFjdHMgdGhlIHJlc3VsdCBmcm9tIGEgd3JhcHBlZCBhbmQgY2hhaW5lZCBvYmplY3QuXG4gICAgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3dyYXBwZWQ7XG4gICAgfVxuXG4gIH0pO1xuXG4gIC8vIEFNRCByZWdpc3RyYXRpb24gaGFwcGVucyBhdCB0aGUgZW5kIGZvciBjb21wYXRpYmlsaXR5IHdpdGggQU1EIGxvYWRlcnNcbiAgLy8gdGhhdCBtYXkgbm90IGVuZm9yY2UgbmV4dC10dXJuIHNlbWFudGljcyBvbiBtb2R1bGVzLiBFdmVuIHRob3VnaCBnZW5lcmFsXG4gIC8vIHByYWN0aWNlIGZvciBBTUQgcmVnaXN0cmF0aW9uIGlzIHRvIGJlIGFub255bW91cywgdW5kZXJzY29yZSByZWdpc3RlcnNcbiAgLy8gYXMgYSBuYW1lZCBtb2R1bGUgYmVjYXVzZSwgbGlrZSBqUXVlcnksIGl0IGlzIGEgYmFzZSBsaWJyYXJ5IHRoYXQgaXNcbiAgLy8gcG9wdWxhciBlbm91Z2ggdG8gYmUgYnVuZGxlZCBpbiBhIHRoaXJkIHBhcnR5IGxpYiwgYnV0IG5vdCBiZSBwYXJ0IG9mXG4gIC8vIGFuIEFNRCBsb2FkIHJlcXVlc3QuIFRob3NlIGNhc2VzIGNvdWxkIGdlbmVyYXRlIGFuIGVycm9yIHdoZW4gYW5cbiAgLy8gYW5vbnltb3VzIGRlZmluZSgpIGlzIGNhbGxlZCBvdXRzaWRlIG9mIGEgbG9hZGVyIHJlcXVlc3QuXG4gIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcbiAgICBkZWZpbmUoJ3VuZGVyc2NvcmUnLCBbXSwgZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gXztcbiAgICB9KTtcbiAgfVxufSkuY2FsbCh0aGlzKTtcblxufSkoKSIsIihmdW5jdGlvbihkZWZpbml0aW9uKXtpZih0eXBlb2YgZXhwb3J0cz09PVwib2JqZWN0XCIpe21vZHVsZS5leHBvcnRzPWRlZmluaXRpb24oKTt9ZWxzZSBpZih0eXBlb2YgZGVmaW5lPT09XCJmdW5jdGlvblwiJiZkZWZpbmUuYW1kKXtkZWZpbmUoZGVmaW5pdGlvbik7fWVsc2V7bW9yaT1kZWZpbml0aW9uKCk7fX0pKGZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKCl7XG52YXIgZyxhYT10aGlzO1xuZnVuY3Rpb24gbShhKXt2YXIgYj10eXBlb2YgYTtpZihcIm9iamVjdFwiPT1iKWlmKGEpe2lmKGEgaW5zdGFuY2VvZiBBcnJheSlyZXR1cm5cImFycmF5XCI7aWYoYSBpbnN0YW5jZW9mIE9iamVjdClyZXR1cm4gYjt2YXIgYz1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoYSk7aWYoXCJbb2JqZWN0IFdpbmRvd11cIj09YylyZXR1cm5cIm9iamVjdFwiO2lmKFwiW29iamVjdCBBcnJheV1cIj09Y3x8XCJudW1iZXJcIj09dHlwZW9mIGEubGVuZ3RoJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgYS5zcGxpY2UmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiBhLnByb3BlcnR5SXNFbnVtZXJhYmxlJiYhYS5wcm9wZXJ0eUlzRW51bWVyYWJsZShcInNwbGljZVwiKSlyZXR1cm5cImFycmF5XCI7aWYoXCJbb2JqZWN0IEZ1bmN0aW9uXVwiPT1jfHxcInVuZGVmaW5lZFwiIT10eXBlb2YgYS5jYWxsJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgYS5wcm9wZXJ0eUlzRW51bWVyYWJsZSYmIWEucHJvcGVydHlJc0VudW1lcmFibGUoXCJjYWxsXCIpKXJldHVyblwiZnVuY3Rpb25cIn1lbHNlIHJldHVyblwibnVsbFwiO2Vsc2UgaWYoXCJmdW5jdGlvblwiPT1cbmImJlwidW5kZWZpbmVkXCI9PXR5cGVvZiBhLmNhbGwpcmV0dXJuXCJvYmplY3RcIjtyZXR1cm4gYn12YXIgYmE9XCJjbG9zdXJlX3VpZF9cIisoMUU5Kk1hdGgucmFuZG9tKCk+Pj4wKSxjYT0wO2Z1bmN0aW9uIHAoYSxiKXt2YXIgYz1hLnNwbGl0KFwiLlwiKSxkPWFhO2NbMF1pbiBkfHwhZC5leGVjU2NyaXB0fHxkLmV4ZWNTY3JpcHQoXCJ2YXIgXCIrY1swXSk7Zm9yKHZhciBlO2MubGVuZ3RoJiYoZT1jLnNoaWZ0KCkpOyljLmxlbmd0aHx8dm9pZCAwPT09Yj9kPWRbZV0/ZFtlXTpkW2VdPXt9OmRbZV09Yn07ZnVuY3Rpb24gZGEoYSxiKXtmb3IodmFyIGMgaW4gYSliLmNhbGwodm9pZCAwLGFbY10sYyxhKX07ZnVuY3Rpb24gZWEoYSxiKXtudWxsIT1hJiZ0aGlzLmFwcGVuZC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9ZWEucHJvdG90eXBlLlZhPVwiXCI7ZWEucHJvdG90eXBlLmFwcGVuZD1mdW5jdGlvbihhLGIsYyl7dGhpcy5WYSs9YTtpZihudWxsIT1iKWZvcih2YXIgZD0xO2Q8YXJndW1lbnRzLmxlbmd0aDtkKyspdGhpcy5WYSs9YXJndW1lbnRzW2RdO3JldHVybiB0aGlzfTtlYS5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5WYX07ZnVuY3Rpb24gZmEoYSxiKXthLnNvcnQoYnx8Z2EpfWZ1bmN0aW9uIGhhKGEsYil7Zm9yKHZhciBjPTA7YzxhLmxlbmd0aDtjKyspYVtjXT17aW5kZXg6Yyx2YWx1ZTphW2NdfTt2YXIgZD1ifHxnYTtmYShhLGZ1bmN0aW9uKGEsYil7cmV0dXJuIGQoYS52YWx1ZSxiLnZhbHVlKXx8YS5pbmRleC1iLmluZGV4fSk7Zm9yKGM9MDtjPGEubGVuZ3RoO2MrKylhW2NdPWFbY10udmFsdWV9ZnVuY3Rpb24gZ2EoYSxiKXtyZXR1cm4gYT5iPzE6YTxiPy0xOjB9O3ZhciBpYT1udWxsLGphPW51bGw7ZnVuY3Rpb24ga2EoKXtyZXR1cm4gbmV3IGxhKG51bGwsNSxbbWEsITAsb2EsITAscGEsITEscWEsITEscmEsaWFdLG51bGwpfWZ1bmN0aW9uIHIoYSl7cmV0dXJuIG51bGwhPWEmJiExIT09YX1mdW5jdGlvbiBzYShhKXtyZXR1cm4gcihhKT8hMTohMH1mdW5jdGlvbiBzKGEsYil7cmV0dXJuIGFbbShudWxsPT1iP251bGw6YildPyEwOmEuXz8hMDp1PyExOm51bGx9ZnVuY3Rpb24gdGEoYSl7cmV0dXJuIG51bGw9PWE/bnVsbDphLmNvbnN0cnVjdG9yfWZ1bmN0aW9uIHgoYSxiKXt2YXIgYz10YShiKSxjPXIocihjKT9jLkRiOmMpP2MuQmI6bShiKTtyZXR1cm4gRXJyb3IoW1wiTm8gcHJvdG9jb2wgbWV0aG9kIFwiLGEsXCIgZGVmaW5lZCBmb3IgdHlwZSBcIixjLFwiOiBcIixiXS5qb2luKFwiXCIpKX1mdW5jdGlvbiB1YShhKXt2YXIgYj1hLkJiO3JldHVybiByKGIpP2I6XCJcIitBLmIoYSl9XG5mdW5jdGlvbiB2YShhKXtmb3IodmFyIGI9YS5sZW5ndGgsYz1BcnJheShiKSxkPTA7OylpZihkPGIpY1tkXT1hW2RdLGQrPTE7ZWxzZSBicmVhaztyZXR1cm4gY31mdW5jdGlvbiB3YShhKXtyZXR1cm4gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKX1cbnZhciB4YT1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4gQy5jP0MuYyhmdW5jdGlvbihhLGIpe2EucHVzaChiKTtyZXR1cm4gYX0sW10sYik6Qy5jYWxsKG51bGwsZnVuY3Rpb24oYSxiKXthLnB1c2goYik7cmV0dXJuIGF9LFtdLGIpfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIGMuYShudWxsLGEpfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGIuY2FsbCh0aGlzLGMpO2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsMCxlKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5iPWI7Yy5hPWE7cmV0dXJuIGN9KCkseWE9e30semE9e307XG5mdW5jdGlvbiBBYShhKXtpZihhP2EuTDphKXJldHVybiBhLkwoYSk7dmFyIGI7Yj1BYVttKG51bGw9PWE/bnVsbDphKV07aWYoIWImJihiPUFhLl8sIWIpKXRocm93IHgoXCJJQ291bnRlZC4tY291bnRcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9ZnVuY3Rpb24gQmEoYSl7aWYoYT9hLkk6YSlyZXR1cm4gYS5JKGEpO3ZhciBiO2I9QmFbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj1CYS5fLCFiKSl0aHJvdyB4KFwiSUVtcHR5YWJsZUNvbGxlY3Rpb24uLWVtcHR5XCIsYSk7cmV0dXJuIGIuY2FsbChudWxsLGEpfXZhciBDYT17fTtmdW5jdGlvbiBEYShhLGIpe2lmKGE/YS5HOmEpcmV0dXJuIGEuRyhhLGIpO3ZhciBjO2M9RGFbbShudWxsPT1hP251bGw6YSldO2lmKCFjJiYoYz1EYS5fLCFjKSl0aHJvdyB4KFwiSUNvbGxlY3Rpb24uLWNvbmpcIixhKTtyZXR1cm4gYy5jYWxsKG51bGwsYSxiKX1cbnZhciBFYT17fSxEPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyl7aWYoYT9hLmFhOmEpcmV0dXJuIGEuYWEoYSxiLGMpO3ZhciBoO2g9RFttKG51bGw9PWE/bnVsbDphKV07aWYoIWgmJihoPUQuXywhaCkpdGhyb3cgeChcIklJbmRleGVkLi1udGhcIixhKTtyZXR1cm4gaC5jYWxsKG51bGwsYSxiLGMpfWZ1bmN0aW9uIGIoYSxiKXtpZihhP2EuSjphKXJldHVybiBhLkooYSxiKTt2YXIgYztjPURbbShudWxsPT1hP251bGw6YSldO2lmKCFjJiYoYz1ELl8sIWMpKXRocm93IHgoXCJJSW5kZXhlZC4tbnRoXCIsYSk7cmV0dXJuIGMuY2FsbChudWxsLGEsYil9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBiLmNhbGwodGhpcyxjLGUpO2Nhc2UgMzpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlLGYpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmE9YjtjLmM9YTtyZXR1cm4gY30oKSxcbkZhPXt9O2Z1bmN0aW9uIEhhKGEpe2lmKGE/YS5ROmEpcmV0dXJuIGEuUShhKTt2YXIgYjtiPUhhW20obnVsbD09YT9udWxsOmEpXTtpZighYiYmKGI9SGEuXywhYikpdGhyb3cgeChcIklTZXEuLWZpcnN0XCIsYSk7cmV0dXJuIGIuY2FsbChudWxsLGEpfWZ1bmN0aW9uIElhKGEpe2lmKGE/YS5TOmEpcmV0dXJuIGEuUyhhKTt2YXIgYjtiPUlhW20obnVsbD09YT9udWxsOmEpXTtpZighYiYmKGI9SWEuXywhYikpdGhyb3cgeChcIklTZXEuLXJlc3RcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9XG52YXIgSmE9e30sS2E9e30sTGE9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjKXtpZihhP2EuQzphKXJldHVybiBhLkMoYSxiLGMpO3ZhciBoO2g9TGFbbShudWxsPT1hP251bGw6YSldO2lmKCFoJiYoaD1MYS5fLCFoKSl0aHJvdyB4KFwiSUxvb2t1cC4tbG9va3VwXCIsYSk7cmV0dXJuIGguY2FsbChudWxsLGEsYixjKX1mdW5jdGlvbiBiKGEsYil7aWYoYT9hLnU6YSlyZXR1cm4gYS51KGEsYik7dmFyIGM7Yz1MYVttKG51bGw9PWE/bnVsbDphKV07aWYoIWMmJihjPUxhLl8sIWMpKXRocm93IHgoXCJJTG9va3VwLi1sb29rdXBcIixhKTtyZXR1cm4gYy5jYWxsKG51bGwsYSxiKX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGIuY2FsbCh0aGlzLGMsZSk7Y2FzZSAzOnJldHVybiBhLmNhbGwodGhpcyxjLGUsZil9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYT1iO2MuYz1cbmE7cmV0dXJuIGN9KCksTWE9e307ZnVuY3Rpb24gTmEoYSxiKXtpZihhP2Eua2I6YSlyZXR1cm4gYS5rYihhLGIpO3ZhciBjO2M9TmFbbShudWxsPT1hP251bGw6YSldO2lmKCFjJiYoYz1OYS5fLCFjKSl0aHJvdyB4KFwiSUFzc29jaWF0aXZlLi1jb250YWlucy1rZXk/XCIsYSk7cmV0dXJuIGMuY2FsbChudWxsLGEsYil9ZnVuY3Rpb24gT2EoYSxiLGMpe2lmKGE/YS51YTphKXJldHVybiBhLnVhKGEsYixjKTt2YXIgZDtkPU9hW20obnVsbD09YT9udWxsOmEpXTtpZighZCYmKGQ9T2EuXywhZCkpdGhyb3cgeChcIklBc3NvY2lhdGl2ZS4tYXNzb2NcIixhKTtyZXR1cm4gZC5jYWxsKG51bGwsYSxiLGMpfXZhciBQYT17fTtmdW5jdGlvbiBRYShhLGIpe2lmKGE/YS5uYjphKXJldHVybiBhLm5iKGEsYik7dmFyIGM7Yz1RYVttKG51bGw9PWE/bnVsbDphKV07aWYoIWMmJihjPVFhLl8sIWMpKXRocm93IHgoXCJJTWFwLi1kaXNzb2NcIixhKTtyZXR1cm4gYy5jYWxsKG51bGwsYSxiKX12YXIgU2E9e307XG5mdW5jdGlvbiBUYShhKXtpZihhP2EuJGE6YSlyZXR1cm4gYS4kYShhKTt2YXIgYjtiPVRhW20obnVsbD09YT9udWxsOmEpXTtpZighYiYmKGI9VGEuXywhYikpdGhyb3cgeChcIklNYXBFbnRyeS4ta2V5XCIsYSk7cmV0dXJuIGIuY2FsbChudWxsLGEpfWZ1bmN0aW9uIFVhKGEpe2lmKGE/YS5hYjphKXJldHVybiBhLmFiKGEpO3ZhciBiO2I9VWFbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj1VYS5fLCFiKSl0aHJvdyB4KFwiSU1hcEVudHJ5Li12YWxcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9dmFyIFZhPXt9O2Z1bmN0aW9uIFdhKGEsYil7aWYoYT9hLnZiOmEpcmV0dXJuIGEudmIoYSxiKTt2YXIgYztjPVdhW20obnVsbD09YT9udWxsOmEpXTtpZighYyYmKGM9V2EuXywhYykpdGhyb3cgeChcIklTZXQuLWRpc2pvaW5cIixhKTtyZXR1cm4gYy5jYWxsKG51bGwsYSxiKX1cbmZ1bmN0aW9uIFhhKGEpe2lmKGE/YS5JYTphKXJldHVybiBhLklhKGEpO3ZhciBiO2I9WGFbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj1YYS5fLCFiKSl0aHJvdyB4KFwiSVN0YWNrLi1wZWVrXCIsYSk7cmV0dXJuIGIuY2FsbChudWxsLGEpfWZ1bmN0aW9uIFlhKGEpe2lmKGE/YS5KYTphKXJldHVybiBhLkphKGEpO3ZhciBiO2I9WWFbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj1ZYS5fLCFiKSl0aHJvdyB4KFwiSVN0YWNrLi1wb3BcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9dmFyIFphPXt9O2Z1bmN0aW9uICRhKGEsYixjKXtpZihhP2EuUGE6YSlyZXR1cm4gYS5QYShhLGIsYyk7dmFyIGQ7ZD0kYVttKG51bGw9PWE/bnVsbDphKV07aWYoIWQmJihkPSRhLl8sIWQpKXRocm93IHgoXCJJVmVjdG9yLi1hc3NvYy1uXCIsYSk7cmV0dXJuIGQuY2FsbChudWxsLGEsYixjKX1cbmZ1bmN0aW9uIGFiKGEpe2lmKGE/YS51YjphKXJldHVybiBhLnViKGEpO3ZhciBiO2I9YWJbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj1hYi5fLCFiKSl0aHJvdyB4KFwiSURlcmVmLi1kZXJlZlwiLGEpO3JldHVybiBiLmNhbGwobnVsbCxhKX12YXIgYmI9e307ZnVuY3Rpb24gY2IoYSl7aWYoYT9hLkQ6YSlyZXR1cm4gYS5EKGEpO3ZhciBiO2I9Y2JbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj1jYi5fLCFiKSl0aHJvdyB4KFwiSU1ldGEuLW1ldGFcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9dmFyIGRiPXt9O2Z1bmN0aW9uIGViKGEsYil7aWYoYT9hLkY6YSlyZXR1cm4gYS5GKGEsYik7dmFyIGM7Yz1lYlttKG51bGw9PWE/bnVsbDphKV07aWYoIWMmJihjPWViLl8sIWMpKXRocm93IHgoXCJJV2l0aE1ldGEuLXdpdGgtbWV0YVwiLGEpO3JldHVybiBjLmNhbGwobnVsbCxhLGIpfVxudmFyIGZiPXt9LGdiPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyl7aWYoYT9hLk06YSlyZXR1cm4gYS5NKGEsYixjKTt2YXIgaDtoPWdiW20obnVsbD09YT9udWxsOmEpXTtpZighaCYmKGg9Z2IuXywhaCkpdGhyb3cgeChcIklSZWR1Y2UuLXJlZHVjZVwiLGEpO3JldHVybiBoLmNhbGwobnVsbCxhLGIsYyl9ZnVuY3Rpb24gYihhLGIpe2lmKGE/YS5OOmEpcmV0dXJuIGEuTihhLGIpO3ZhciBjO2M9Z2JbbShudWxsPT1hP251bGw6YSldO2lmKCFjJiYoYz1nYi5fLCFjKSl0aHJvdyB4KFwiSVJlZHVjZS4tcmVkdWNlXCIsYSk7cmV0dXJuIGMuY2FsbChudWxsLGEsYil9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBiLmNhbGwodGhpcyxjLGUpO2Nhc2UgMzpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlLGYpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmE9YjtjLmM9YTtyZXR1cm4gY30oKTtcbmZ1bmN0aW9uIGhiKGEsYixjKXtpZihhP2EuWmE6YSlyZXR1cm4gYS5aYShhLGIsYyk7dmFyIGQ7ZD1oYlttKG51bGw9PWE/bnVsbDphKV07aWYoIWQmJihkPWhiLl8sIWQpKXRocm93IHgoXCJJS1ZSZWR1Y2UuLWt2LXJlZHVjZVwiLGEpO3JldHVybiBkLmNhbGwobnVsbCxhLGIsYyl9ZnVuY3Rpb24gaWIoYSxiKXtpZihhP2EudjphKXJldHVybiBhLnYoYSxiKTt2YXIgYztjPWliW20obnVsbD09YT9udWxsOmEpXTtpZighYyYmKGM9aWIuXywhYykpdGhyb3cgeChcIklFcXVpdi4tZXF1aXZcIixhKTtyZXR1cm4gYy5jYWxsKG51bGwsYSxiKX1mdW5jdGlvbiBqYihhKXtpZihhP2EuQjphKXJldHVybiBhLkIoYSk7dmFyIGI7Yj1qYlttKG51bGw9PWE/bnVsbDphKV07aWYoIWImJihiPWpiLl8sIWIpKXRocm93IHgoXCJJSGFzaC4taGFzaFwiLGEpO3JldHVybiBiLmNhbGwobnVsbCxhKX12YXIga2I9e307XG5mdW5jdGlvbiBsYihhKXtpZihhP2EuSDphKXJldHVybiBhLkgoYSk7dmFyIGI7Yj1sYlttKG51bGw9PWE/bnVsbDphKV07aWYoIWImJihiPWxiLl8sIWIpKXRocm93IHgoXCJJU2VxYWJsZS4tc2VxXCIsYSk7cmV0dXJuIGIuY2FsbChudWxsLGEpfXZhciBtYj17fSxuYj17fSxvYj17fTtmdW5jdGlvbiBwYihhKXtpZihhP2EuWGE6YSlyZXR1cm4gYS5YYShhKTt2YXIgYjtiPXBiW20obnVsbD09YT9udWxsOmEpXTtpZighYiYmKGI9cGIuXywhYikpdGhyb3cgeChcIklSZXZlcnNpYmxlLi1yc2VxXCIsYSk7cmV0dXJuIGIuY2FsbChudWxsLGEpfWZ1bmN0aW9uIHFiKGEsYil7aWYoYT9hLnliOmEpcmV0dXJuIGEueWIoYSxiKTt2YXIgYztjPXFiW20obnVsbD09YT9udWxsOmEpXTtpZighYyYmKGM9cWIuXywhYykpdGhyb3cgeChcIklTb3J0ZWQuLXNvcnRlZC1zZXFcIixhKTtyZXR1cm4gYy5jYWxsKG51bGwsYSxiKX1cbmZ1bmN0aW9uIHJiKGEsYixjKXtpZihhP2EuemI6YSlyZXR1cm4gYS56YihhLGIsYyk7dmFyIGQ7ZD1yYlttKG51bGw9PWE/bnVsbDphKV07aWYoIWQmJihkPXJiLl8sIWQpKXRocm93IHgoXCJJU29ydGVkLi1zb3J0ZWQtc2VxLWZyb21cIixhKTtyZXR1cm4gZC5jYWxsKG51bGwsYSxiLGMpfWZ1bmN0aW9uIHNiKGEsYil7aWYoYT9hLnhiOmEpcmV0dXJuIGEueGIoYSxiKTt2YXIgYztjPXNiW20obnVsbD09YT9udWxsOmEpXTtpZighYyYmKGM9c2IuXywhYykpdGhyb3cgeChcIklTb3J0ZWQuLWVudHJ5LWtleVwiLGEpO3JldHVybiBjLmNhbGwobnVsbCxhLGIpfWZ1bmN0aW9uIHRiKGEpe2lmKGE/YS53YjphKXJldHVybiBhLndiKGEpO3ZhciBiO2I9dGJbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj10Yi5fLCFiKSl0aHJvdyB4KFwiSVNvcnRlZC4tY29tcGFyYXRvclwiLGEpO3JldHVybiBiLmNhbGwobnVsbCxhKX1cbmZ1bmN0aW9uIHViKGEsYil7aWYoYT9hLlNiOmEpcmV0dXJuIGEuU2IoMCxiKTt2YXIgYztjPXViW20obnVsbD09YT9udWxsOmEpXTtpZighYyYmKGM9dWIuXywhYykpdGhyb3cgeChcIklXcml0ZXIuLXdyaXRlXCIsYSk7cmV0dXJuIGMuY2FsbChudWxsLGEsYil9dmFyIHZiPXt9O2Z1bmN0aW9uIHdiKGEsYixjKXtpZihhP2EudzphKXJldHVybiBhLncoYSxiLGMpO3ZhciBkO2Q9d2JbbShudWxsPT1hP251bGw6YSldO2lmKCFkJiYoZD13Yi5fLCFkKSl0aHJvdyB4KFwiSVByaW50V2l0aFdyaXRlci4tcHItd3JpdGVyXCIsYSk7cmV0dXJuIGQuY2FsbChudWxsLGEsYixjKX1mdW5jdGlvbiB4YihhLGIsYyl7aWYoYT9hLlJiOmEpcmV0dXJuIGEuUmIoMCxiLGMpO3ZhciBkO2Q9eGJbbShudWxsPT1hP251bGw6YSldO2lmKCFkJiYoZD14Yi5fLCFkKSl0aHJvdyB4KFwiSVdhdGNoYWJsZS4tbm90aWZ5LXdhdGNoZXNcIixhKTtyZXR1cm4gZC5jYWxsKG51bGwsYSxiLGMpfVxuZnVuY3Rpb24geWIoYSl7aWYoYT9hLldhOmEpcmV0dXJuIGEuV2EoYSk7dmFyIGI7Yj15YlttKG51bGw9PWE/bnVsbDphKV07aWYoIWImJihiPXliLl8sIWIpKXRocm93IHgoXCJJRWRpdGFibGVDb2xsZWN0aW9uLi1hcy10cmFuc2llbnRcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9ZnVuY3Rpb24gemIoYSxiKXtpZihhP2EuS2E6YSlyZXR1cm4gYS5LYShhLGIpO3ZhciBjO2M9emJbbShudWxsPT1hP251bGw6YSldO2lmKCFjJiYoYz16Yi5fLCFjKSl0aHJvdyB4KFwiSVRyYW5zaWVudENvbGxlY3Rpb24uLWNvbmohXCIsYSk7cmV0dXJuIGMuY2FsbChudWxsLGEsYil9ZnVuY3Rpb24gQWIoYSl7aWYoYT9hLk9hOmEpcmV0dXJuIGEuT2EoYSk7dmFyIGI7Yj1BYlttKG51bGw9PWE/bnVsbDphKV07aWYoIWImJihiPUFiLl8sIWIpKXRocm93IHgoXCJJVHJhbnNpZW50Q29sbGVjdGlvbi4tcGVyc2lzdGVudCFcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9XG5mdW5jdGlvbiBCYihhLGIsYyl7aWYoYT9hLmNiOmEpcmV0dXJuIGEuY2IoYSxiLGMpO3ZhciBkO2Q9QmJbbShudWxsPT1hP251bGw6YSldO2lmKCFkJiYoZD1CYi5fLCFkKSl0aHJvdyB4KFwiSVRyYW5zaWVudEFzc29jaWF0aXZlLi1hc3NvYyFcIixhKTtyZXR1cm4gZC5jYWxsKG51bGwsYSxiLGMpfWZ1bmN0aW9uIENiKGEsYil7aWYoYT9hLkFiOmEpcmV0dXJuIGEuQWIoYSxiKTt2YXIgYztjPUNiW20obnVsbD09YT9udWxsOmEpXTtpZighYyYmKGM9Q2IuXywhYykpdGhyb3cgeChcIklUcmFuc2llbnRNYXAuLWRpc3NvYyFcIixhKTtyZXR1cm4gYy5jYWxsKG51bGwsYSxiKX1mdW5jdGlvbiBEYihhLGIsYyl7aWYoYT9hLlBiOmEpcmV0dXJuIGEuUGIoMCxiLGMpO3ZhciBkO2Q9RGJbbShudWxsPT1hP251bGw6YSldO2lmKCFkJiYoZD1EYi5fLCFkKSl0aHJvdyB4KFwiSVRyYW5zaWVudFZlY3Rvci4tYXNzb2MtbiFcIixhKTtyZXR1cm4gZC5jYWxsKG51bGwsYSxiLGMpfVxuZnVuY3Rpb24gRWIoYSl7aWYoYT9hLlFiOmEpcmV0dXJuIGEuUWIoKTt2YXIgYjtiPUViW20obnVsbD09YT9udWxsOmEpXTtpZighYiYmKGI9RWIuXywhYikpdGhyb3cgeChcIklUcmFuc2llbnRWZWN0b3IuLXBvcCFcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9ZnVuY3Rpb24gRmIoYSxiKXtpZihhP2EuT2I6YSlyZXR1cm4gYS5PYigwLGIpO3ZhciBjO2M9RmJbbShudWxsPT1hP251bGw6YSldO2lmKCFjJiYoYz1GYi5fLCFjKSl0aHJvdyB4KFwiSVRyYW5zaWVudFNldC4tZGlzam9pbiFcIixhKTtyZXR1cm4gYy5jYWxsKG51bGwsYSxiKX1mdW5jdGlvbiBHYihhKXtpZihhP2EuS2I6YSlyZXR1cm4gYS5LYigpO3ZhciBiO2I9R2JbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj1HYi5fLCFiKSl0aHJvdyB4KFwiSUNodW5rLi1kcm9wLWZpcnN0XCIsYSk7cmV0dXJuIGIuY2FsbChudWxsLGEpfVxuZnVuY3Rpb24gSGIoYSl7aWYoYT9hLnNiOmEpcmV0dXJuIGEuc2IoYSk7dmFyIGI7Yj1IYlttKG51bGw9PWE/bnVsbDphKV07aWYoIWImJihiPUhiLl8sIWIpKXRocm93IHgoXCJJQ2h1bmtlZFNlcS4tY2h1bmtlZC1maXJzdFwiLGEpO3JldHVybiBiLmNhbGwobnVsbCxhKX1mdW5jdGlvbiBJYihhKXtpZihhP2EudGI6YSlyZXR1cm4gYS50YihhKTt2YXIgYjtiPUliW20obnVsbD09YT9udWxsOmEpXTtpZighYiYmKGI9SWIuXywhYikpdGhyb3cgeChcIklDaHVua2VkU2VxLi1jaHVua2VkLXJlc3RcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9ZnVuY3Rpb24gSmIoYSl7aWYoYT9hLnJiOmEpcmV0dXJuIGEucmIoYSk7dmFyIGI7Yj1KYlttKG51bGw9PWE/bnVsbDphKV07aWYoIWImJihiPUpiLl8sIWIpKXRocm93IHgoXCJJQ2h1bmtlZE5leHQuLWNodW5rZWQtbmV4dFwiLGEpO3JldHVybiBiLmNhbGwobnVsbCxhKX1cbmZ1bmN0aW9uIEtiKGEpe3RoaXMudmM9YTt0aGlzLnE9MDt0aGlzLmk9MTA3Mzc0MTgyNH1LYi5wcm90b3R5cGUuU2I9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy52Yy5hcHBlbmQoYil9O2Z1bmN0aW9uIExiKGEpe3ZhciBiPW5ldyBlYTthLncobnVsbCxuZXcgS2IoYiksa2EoKSk7cmV0dXJuXCJcIitBLmIoYil9dmFyIE1iPVwidW5kZWZpbmVkXCIhPT10eXBlb2YgTWF0aC5pbXVsJiYwIT09KE1hdGguaW11bC5hP01hdGguaW11bC5hKDQyOTQ5NjcyOTUsNSk6TWF0aC5pbXVsLmNhbGwobnVsbCw0Mjk0OTY3Mjk1LDUpKT9mdW5jdGlvbihhLGIpe3JldHVybiBNYXRoLmltdWwoYSxiKX06ZnVuY3Rpb24oYSxiKXt2YXIgYz1hJjY1NTM1LGQ9YiY2NTUzNTtyZXR1cm4gYypkKygoYT4+PjE2JjY1NTM1KSpkK2MqKGI+Pj4xNiY2NTUzNSk8PDE2Pj4+MCl8MH07ZnVuY3Rpb24gTmIoYSl7YT1NYihhLDM0MzI5MTgzNTMpO3JldHVybiBNYihhPDwxNXxhPj4+LTE1LDQ2MTg0NTkwNyl9XG5mdW5jdGlvbiBPYihhLGIpe3ZhciBjPWFeYjtyZXR1cm4gTWIoYzw8MTN8Yz4+Pi0xMyw1KSszODY0MjkyMTk2fWZ1bmN0aW9uIFBiKGEsYil7dmFyIGM9YV5iLGM9TWIoY15jPj4+MTYsMjI0NjgyMjUwNyksYz1NYihjXmM+Pj4xMywzMjY2NDg5OTA5KTtyZXR1cm4gY15jPj4+MTZ9dmFyIFFiPXt9LFJiPTA7ZnVuY3Rpb24gU2IoYSl7MjU1PFJiJiYoUWI9e30sUmI9MCk7dmFyIGI9UWJbYV07aWYoXCJudW1iZXJcIiE9PXR5cGVvZiBiKXthOmlmKG51bGwhPWEpaWYoYj1hLmxlbmd0aCwwPGIpe2Zvcih2YXIgYz0wLGQ9MDs7KWlmKGM8Yil2YXIgZT1jKzEsZD1NYigzMSxkKSthLmNoYXJDb2RlQXQoYyksYz1lO2Vsc2V7Yj1kO2JyZWFrIGF9Yj12b2lkIDB9ZWxzZSBiPTA7ZWxzZSBiPTA7UWJbYV09YjtSYis9MX1yZXR1cm4gYT1ifVxuZnVuY3Rpb24gVGIoYSl7YSYmKGEuaSY0MTk0MzA0fHxhLkRjKT9hPWEuQihudWxsKTpcIm51bWJlclwiPT09dHlwZW9mIGE/YT1NYXRoLmZsb29yKGEpJTIxNDc0ODM2NDc6ITA9PT1hP2E9MTohMT09PWE/YT0wOlwic3RyaW5nXCI9PT10eXBlb2YgYT8oYT1TYihhKSwwIT09YSYmKGE9TmIoYSksYT1PYigwLGEpLGE9UGIoYSw0KSkpOmE9bnVsbD09YT8wOnU/amIoYSk6bnVsbDtyZXR1cm4gYX1cbmZ1bmN0aW9uIFViKGEpe3ZhciBiO2I9YS5uYW1lO3ZhciBjO2E6e2M9MTtmb3IodmFyIGQ9MDs7KWlmKGM8Yi5sZW5ndGgpe3ZhciBlPWMrMixkPU9iKGQsTmIoYi5jaGFyQ29kZUF0KGMtMSl8Yi5jaGFyQ29kZUF0KGMpPDwxNikpO2M9ZX1lbHNle2M9ZDticmVhayBhfWM9dm9pZCAwfWM9MT09PShiLmxlbmd0aCYxKT9jXk5iKGIuY2hhckNvZGVBdChiLmxlbmd0aC0xKSk6YztiPVBiKGMsTWIoMixiLmxlbmd0aCkpO2E9U2IoYS5mYSk7cmV0dXJuIGJeYSsyNjU0NDM1NzY5KyhiPDw2KSsoYj4+Mil9XG5mdW5jdGlvbiBWYihhLGIpe2lmKHIoV2IuYT9XYi5hKGEsYik6V2IuY2FsbChudWxsLGEsYikpKXJldHVybiAwO3ZhciBjPXNhKGEuZmEpO2lmKHIoYz9iLmZhOmMpKXJldHVybi0xO2lmKHIoYS5mYSkpe2lmKHNhKGIuZmEpKXJldHVybiAxO2M9WGIuYT9YYi5hKGEuZmEsYi5mYSk6WGIuY2FsbChudWxsLGEuZmEsYi5mYSk7cmV0dXJuIDA9PT1jP1hiLmE/WGIuYShhLm5hbWUsYi5uYW1lKTpYYi5jYWxsKG51bGwsYS5uYW1lLGIubmFtZSk6Y31yZXR1cm4gWWI/WGIuYT9YYi5hKGEubmFtZSxiLm5hbWUpOlhiLmNhbGwobnVsbCxhLm5hbWUsYi5uYW1lKTpudWxsfWZ1bmN0aW9uIFpiKGEsYixjLGQsZSl7dGhpcy5mYT1hO3RoaXMubmFtZT1iO3RoaXMuTmE9Yzt0aGlzLlVhPWQ7dGhpcy5XPWU7dGhpcy5pPTIxNTQxNjgzMjE7dGhpcy5xPTQwOTZ9Zz1aYi5wcm90b3R5cGU7Zy53PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHViKGIsdGhpcy5OYSl9O1xuZy5CPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5VYTtyZXR1cm4gbnVsbCE9YT9hOnRoaXMuVWE9YT1VYih0aGlzKX07Zy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBaYih0aGlzLmZhLHRoaXMubmFtZSx0aGlzLk5hLHRoaXMuVWEsYil9O2cuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLld9O2cuY2FsbD1mdW5jdGlvbigpe3ZhciBhPW51bGw7cmV0dXJuIGE9ZnVuY3Rpb24oYSxjLGQpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIExhLmMoYyx0aGlzLG51bGwpO2Nhc2UgMzpyZXR1cm4gTGEuYyhjLHRoaXMsZCl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9fSgpO2cuYXBwbHk9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5jYWxsLmFwcGx5KHRoaXMsW3RoaXNdLmNvbmNhdCh2YShiKSkpfTtnLmI9ZnVuY3Rpb24oYSl7cmV0dXJuIExhLmMoYSx0aGlzLG51bGwpfTtcbmcuYT1mdW5jdGlvbihhLGIpe3JldHVybiBMYS5jKGEsdGhpcyxiKX07Zy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGIgaW5zdGFuY2VvZiBaYj90aGlzLk5hPT09Yi5OYTohMX07Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLk5hfTt2YXIgJGI9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7dmFyIGM9bnVsbCE9YT9cIlwiK0EuYihhKStcIi9cIitBLmIoYik6YjtyZXR1cm4gbmV3IFpiKGEsYixjLG51bGwsbnVsbCl9ZnVuY3Rpb24gYihhKXtyZXR1cm4gYSBpbnN0YW5jZW9mIFpiP2E6Yy5hKG51bGwsYSl9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYi5jYWxsKHRoaXMsYyk7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxjLGUpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmI9YjtjLmE9YTtyZXR1cm4gY30oKTtcbmZ1bmN0aW9uIEUoYSl7aWYobnVsbD09YSlyZXR1cm4gbnVsbDtpZihhJiYoYS5pJjgzODg2MDh8fGEuaGMpKXJldHVybiBhLkgobnVsbCk7aWYoYSBpbnN0YW5jZW9mIEFycmF5fHxcInN0cmluZ1wiPT09dHlwZW9mIGEpcmV0dXJuIDA9PT1hLmxlbmd0aD9udWxsOm5ldyBhYyhhLDApO2lmKHMoa2IsYSkpcmV0dXJuIGxiKGEpO2lmKHUpdGhyb3cgRXJyb3IoXCJcIitBLmIoYSkrXCIgaXMgbm90IElTZXFhYmxlXCIpO3JldHVybiBudWxsfWZ1bmN0aW9uIEYoYSl7aWYobnVsbD09YSlyZXR1cm4gbnVsbDtpZihhJiYoYS5pJjY0fHxhLmJiKSlyZXR1cm4gYS5RKG51bGwpO2E9RShhKTtyZXR1cm4gbnVsbD09YT9udWxsOkhhKGEpfWZ1bmN0aW9uIEcoYSl7cmV0dXJuIG51bGwhPWE/YSYmKGEuaSY2NHx8YS5iYik/YS5TKG51bGwpOihhPUUoYSkpP0lhKGEpOkg6SH1mdW5jdGlvbiBJKGEpe3JldHVybiBudWxsPT1hP251bGw6YSYmKGEuaSYxMjh8fGEub2IpP2EuVShudWxsKTpFKEcoYSkpfVxudmFyIFdiPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3JldHVybiBudWxsPT1hP251bGw9PWI6YT09PWJ8fGliKGEsYil9dmFyIGI9bnVsbCxjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShiLGQsayl7dmFyIGw9bnVsbDsyPGFyZ3VtZW50cy5sZW5ndGgmJihsPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpLDApKTtyZXR1cm4gYy5jYWxsKHRoaXMsYixkLGwpfWZ1bmN0aW9uIGMoYSxkLGUpe2Zvcig7OylpZihiLmEoYSxkKSlpZihJKGUpKWE9ZCxkPUYoZSksZT1JKGUpO2Vsc2UgcmV0dXJuIGIuYShkLEYoZSkpO2Vsc2UgcmV0dXJuITF9YS5rPTI7YS5mPWZ1bmN0aW9uKGEpe3ZhciBiPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1HKGEpO3JldHVybiBjKGIsZCxhKX07YS5kPWM7cmV0dXJuIGF9KCksYj1mdW5jdGlvbihiLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4hMDtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGIsXG5lKTtkZWZhdWx0OnJldHVybiBjLmQoYixlLEooYXJndW1lbnRzLDIpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yi5rPTI7Yi5mPWMuZjtiLmI9ZnVuY3Rpb24oKXtyZXR1cm4hMH07Yi5hPWE7Yi5kPWMuZDtyZXR1cm4gYn0oKTtmdW5jdGlvbiBiYyhhLGIpe3ZhciBjPU5iKGEpLGM9T2IoMCxjKTtyZXR1cm4gUGIoYyxiKX1mdW5jdGlvbiBjYyhhKXt2YXIgYj0wLGM9MTtmb3IoYT1FKGEpOzspaWYobnVsbCE9YSliKz0xLGM9TWIoMzEsYykrVGIoRihhKSl8MCxhPUkoYSk7ZWxzZSByZXR1cm4gYmMoYyxiKX1mdW5jdGlvbiBkYyhhKXt2YXIgYj0wLGM9MDtmb3IoYT1FKGEpOzspaWYobnVsbCE9YSliKz0xLGM9YytUYihGKGEpKXwwLGE9SShhKTtlbHNlIHJldHVybiBiYyhjLGIpfXphW1wibnVsbFwiXT0hMDtBYVtcIm51bGxcIl09ZnVuY3Rpb24oKXtyZXR1cm4gMH07XG5EYXRlLnByb3RvdHlwZS52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGIgaW5zdGFuY2VvZiBEYXRlJiZ0aGlzLnRvU3RyaW5nKCk9PT1iLnRvU3RyaW5nKCl9O2liLm51bWJlcj1mdW5jdGlvbihhLGIpe3JldHVybiBhPT09Yn07YmJbXCJmdW5jdGlvblwiXT0hMDtjYltcImZ1bmN0aW9uXCJdPWZ1bmN0aW9uKCl7cmV0dXJuIG51bGx9O3lhW1wiZnVuY3Rpb25cIl09ITA7amIuXz1mdW5jdGlvbihhKXtyZXR1cm4gYVtiYV18fChhW2JhXT0rK2NhKX07ZnVuY3Rpb24gZWMoYSl7dGhpcy5sPWE7dGhpcy5xPTA7dGhpcy5pPTMyNzY4fWVjLnByb3RvdHlwZS51Yj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmx9O2Z1bmN0aW9uIGZjKGEpe3JldHVybiBhIGluc3RhbmNlb2YgZWN9XG52YXIgZ2M9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjLGQpe2Zvcih2YXIgbD1BYShhKTs7KWlmKGQ8bCl7Yz1iLmE/Yi5hKGMsRC5hKGEsZCkpOmIuY2FsbChudWxsLGMsRC5hKGEsZCkpO2lmKGZjKGMpKXJldHVybiBLLmI/Sy5iKGMpOksuY2FsbChudWxsLGMpO2QrPTF9ZWxzZSByZXR1cm4gY31mdW5jdGlvbiBiKGEsYixjKXtmb3IodmFyIGQ9QWEoYSksbD0wOzspaWYobDxkKXtjPWIuYT9iLmEoYyxELmEoYSxsKSk6Yi5jYWxsKG51bGwsYyxELmEoYSxsKSk7aWYoZmMoYykpcmV0dXJuIEsuYj9LLmIoYyk6Sy5jYWxsKG51bGwsYyk7bCs9MX1lbHNlIHJldHVybiBjfWZ1bmN0aW9uIGMoYSxiKXt2YXIgYz1BYShhKTtpZigwPT09YylyZXR1cm4gYi5vP2IubygpOmIuY2FsbChudWxsKTtmb3IodmFyIGQ9RC5hKGEsMCksbD0xOzspaWYobDxjKXtkPWIuYT9iLmEoZCxELmEoYSxsKSk6Yi5jYWxsKG51bGwsZCxELmEoYSxsKSk7aWYoZmMoZCkpcmV0dXJuIEsuYj9LLmIoZCk6Sy5jYWxsKG51bGwsXG5kKTtsKz0xfWVsc2UgcmV0dXJuIGR9dmFyIGQ9bnVsbCxkPWZ1bmN0aW9uKGQsZixoLGspe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGMuY2FsbCh0aGlzLGQsZik7Y2FzZSAzOnJldHVybiBiLmNhbGwodGhpcyxkLGYsaCk7Y2FzZSA0OnJldHVybiBhLmNhbGwodGhpcyxkLGYsaCxrKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307ZC5hPWM7ZC5jPWI7ZC5uPWE7cmV0dXJuIGR9KCksaGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjLGQpe2Zvcih2YXIgbD1hLmxlbmd0aDs7KWlmKGQ8bCl7Yz1iLmE/Yi5hKGMsYVtkXSk6Yi5jYWxsKG51bGwsYyxhW2RdKTtpZihmYyhjKSlyZXR1cm4gSy5iP0suYihjKTpLLmNhbGwobnVsbCxjKTtkKz0xfWVsc2UgcmV0dXJuIGN9ZnVuY3Rpb24gYihhLGIsYyl7Zm9yKHZhciBkPWEubGVuZ3RoLGw9MDs7KWlmKGw8ZCl7Yz1iLmE/Yi5hKGMsYVtsXSk6Yi5jYWxsKG51bGwsYyxcbmFbbF0pO2lmKGZjKGMpKXJldHVybiBLLmI/Sy5iKGMpOksuY2FsbChudWxsLGMpO2wrPTF9ZWxzZSByZXR1cm4gY31mdW5jdGlvbiBjKGEsYil7dmFyIGM9YS5sZW5ndGg7aWYoMD09PWEubGVuZ3RoKXJldHVybiBiLm8/Yi5vKCk6Yi5jYWxsKG51bGwpO2Zvcih2YXIgZD1hWzBdLGw9MTs7KWlmKGw8Yyl7ZD1iLmE/Yi5hKGQsYVtsXSk6Yi5jYWxsKG51bGwsZCxhW2xdKTtpZihmYyhkKSlyZXR1cm4gSy5iP0suYihkKTpLLmNhbGwobnVsbCxkKTtsKz0xfWVsc2UgcmV0dXJuIGR9dmFyIGQ9bnVsbCxkPWZ1bmN0aW9uKGQsZixoLGspe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGMuY2FsbCh0aGlzLGQsZik7Y2FzZSAzOnJldHVybiBiLmNhbGwodGhpcyxkLGYsaCk7Y2FzZSA0OnJldHVybiBhLmNhbGwodGhpcyxkLGYsaCxrKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307ZC5hPWM7ZC5jPWI7ZC5uPWE7cmV0dXJuIGR9KCk7XG5mdW5jdGlvbiBpYyhhKXtyZXR1cm4gYT9hLmkmMnx8YS5ZYj8hMDphLmk/ITE6cyh6YSxhKTpzKHphLGEpfWZ1bmN0aW9uIGpjKGEpe3JldHVybiBhP2EuaSYxNnx8YS5MYj8hMDphLmk/ITE6cyhFYSxhKTpzKEVhLGEpfWZ1bmN0aW9uIGFjKGEsYil7dGhpcy5lPWE7dGhpcy5wPWI7dGhpcy5pPTE2NjE5OTU1MDt0aGlzLnE9ODE5Mn1nPWFjLnByb3RvdHlwZTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIExiKHRoaXMpfTtnLko9ZnVuY3Rpb24oYSxiKXt2YXIgYz1iK3RoaXMucDtyZXR1cm4gYzx0aGlzLmUubGVuZ3RoP3RoaXMuZVtjXTpudWxsfTtnLmFhPWZ1bmN0aW9uKGEsYixjKXthPWIrdGhpcy5wO3JldHVybiBhPHRoaXMuZS5sZW5ndGg/dGhpcy5lW2FdOmN9O2cuVT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnArMTx0aGlzLmUubGVuZ3RoP25ldyBhYyh0aGlzLmUsdGhpcy5wKzEpOm51bGx9O2cuTD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmUubGVuZ3RoLXRoaXMucH07XG5nLlhhPWZ1bmN0aW9uKCl7dmFyIGE9QWEodGhpcyk7cmV0dXJuIDA8YT9uZXcga2ModGhpcyxhLTEsbnVsbCk6bnVsbH07Zy5CPWZ1bmN0aW9uKCl7cmV0dXJuIGNjKHRoaXMpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbGMuYT9sYy5hKHRoaXMsYik6bGMuY2FsbChudWxsLHRoaXMsYil9O2cuST1mdW5jdGlvbigpe3JldHVybiBIfTtnLk49ZnVuY3Rpb24oYSxiKXtyZXR1cm4gaGMubih0aGlzLmUsYix0aGlzLmVbdGhpcy5wXSx0aGlzLnArMSl9O2cuTT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIGhjLm4odGhpcy5lLGIsYyx0aGlzLnApfTtnLlE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lW3RoaXMucF19O2cuUz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnArMTx0aGlzLmUubGVuZ3RoP25ldyBhYyh0aGlzLmUsdGhpcy5wKzEpOkh9O2cuSD1mdW5jdGlvbigpe3JldHVybiB0aGlzfTtcbmcuRz1mdW5jdGlvbihhLGIpe3JldHVybiBNLmE/TS5hKGIsdGhpcyk6TS5jYWxsKG51bGwsYix0aGlzKX07XG52YXIgbWM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7cmV0dXJuIGI8YS5sZW5ndGg/bmV3IGFjKGEsYik6bnVsbH1mdW5jdGlvbiBiKGEpe3JldHVybiBjLmEoYSwwKX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBiLmNhbGwodGhpcyxjKTtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYj1iO2MuYT1hO3JldHVybiBjfSgpLEo9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7cmV0dXJuIG1jLmEoYSxiKX1mdW5jdGlvbiBiKGEpe3JldHVybiBtYy5hKGEsMCl9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYi5jYWxsKHRoaXMsYyk7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxjLGUpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrXG5hcmd1bWVudHMubGVuZ3RoKTt9O2MuYj1iO2MuYT1hO3JldHVybiBjfSgpO2Z1bmN0aW9uIGtjKGEsYixjKXt0aGlzLmpiPWE7dGhpcy5wPWI7dGhpcy5qPWM7dGhpcy5pPTMyMzc0OTkwO3RoaXMucT04MTkyfWc9a2MucHJvdG90eXBlO2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O2cuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmp9O2cuVT1mdW5jdGlvbigpe3JldHVybiAwPHRoaXMucD9uZXcga2ModGhpcy5qYix0aGlzLnAtMSxudWxsKTpudWxsfTtnLkw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wKzF9O2cuQj1mdW5jdGlvbigpe3JldHVybiBjYyh0aGlzKX07Zy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGxjLmE/bGMuYSh0aGlzLGIpOmxjLmNhbGwobnVsbCx0aGlzLGIpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gTi5hP04uYShILHRoaXMuaik6Ti5jYWxsKG51bGwsSCx0aGlzLmopfTtcbmcuTj1mdW5jdGlvbihhLGIpe3JldHVybiBuYy5hP25jLmEoYix0aGlzKTpuYy5jYWxsKG51bGwsYix0aGlzKX07Zy5NPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gbmMuYz9uYy5jKGIsYyx0aGlzKTpuYy5jYWxsKG51bGwsYixjLHRoaXMpfTtnLlE9ZnVuY3Rpb24oKXtyZXR1cm4gRC5hKHRoaXMuamIsdGhpcy5wKX07Zy5TPWZ1bmN0aW9uKCl7cmV0dXJuIDA8dGhpcy5wP25ldyBrYyh0aGlzLmpiLHRoaXMucC0xLG51bGwpOkh9O2cuSD1mdW5jdGlvbigpe3JldHVybiB0aGlzfTtnLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IGtjKHRoaXMuamIsdGhpcy5wLGIpfTtnLkc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTS5hP00uYShiLHRoaXMpOk0uY2FsbChudWxsLGIsdGhpcyl9O2Z1bmN0aW9uIG9jKGEpe2Zvcig7Oyl7dmFyIGI9SShhKTtpZihudWxsIT1iKWE9YjtlbHNlIHJldHVybiBGKGEpfX1pYi5fPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGE9PT1ifTtcbnZhciBwYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4gbnVsbCE9YT9EYShhLGIpOkRhKEgsYil9dmFyIGI9bnVsbCxjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShiLGQsayl7dmFyIGw9bnVsbDsyPGFyZ3VtZW50cy5sZW5ndGgmJihsPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpLDApKTtyZXR1cm4gYy5jYWxsKHRoaXMsYixkLGwpfWZ1bmN0aW9uIGMoYSxkLGUpe2Zvcig7OylpZihyKGUpKWE9Yi5hKGEsZCksZD1GKGUpLGU9SShlKTtlbHNlIHJldHVybiBiLmEoYSxkKX1hLms9MjthLmY9ZnVuY3Rpb24oYSl7dmFyIGI9RihhKTthPUkoYSk7dmFyIGQ9RihhKTthPUcoYSk7cmV0dXJuIGMoYixkLGEpfTthLmQ9YztyZXR1cm4gYX0oKSxiPWZ1bmN0aW9uKGIsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxiLGUpO2RlZmF1bHQ6cmV0dXJuIGMuZChiLGUsSihhcmd1bWVudHMsMikpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrXG5hcmd1bWVudHMubGVuZ3RoKTt9O2Iuaz0yO2IuZj1jLmY7Yi5hPWE7Yi5kPWMuZDtyZXR1cm4gYn0oKTtmdW5jdGlvbiBxYyhhKXtyZXR1cm4gbnVsbD09YT9udWxsOkJhKGEpfWZ1bmN0aW9uIE8oYSl7aWYobnVsbCE9YSlpZihhJiYoYS5pJjJ8fGEuWWIpKWE9YS5MKG51bGwpO2Vsc2UgaWYoYSBpbnN0YW5jZW9mIEFycmF5KWE9YS5sZW5ndGg7ZWxzZSBpZihcInN0cmluZ1wiPT09dHlwZW9mIGEpYT1hLmxlbmd0aDtlbHNlIGlmKHMoemEsYSkpYT1BYShhKTtlbHNlIGlmKHUpYTp7YT1FKGEpO2Zvcih2YXIgYj0wOzspe2lmKGljKGEpKXthPWIrQWEoYSk7YnJlYWsgYX1hPUkoYSk7Yis9MX1hPXZvaWQgMH1lbHNlIGE9bnVsbDtlbHNlIGE9MDtyZXR1cm4gYX1cbnZhciByYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMpe2Zvcig7Oyl7aWYobnVsbD09YSlyZXR1cm4gYztpZigwPT09YilyZXR1cm4gRShhKT9GKGEpOmM7aWYoamMoYSkpcmV0dXJuIEQuYyhhLGIsYyk7aWYoRShhKSlhPUkoYSksYi09MTtlbHNlIHJldHVybiB1P2M6bnVsbH19ZnVuY3Rpb24gYihhLGIpe2Zvcig7Oyl7aWYobnVsbD09YSl0aHJvdyBFcnJvcihcIkluZGV4IG91dCBvZiBib3VuZHNcIik7aWYoMD09PWIpe2lmKEUoYSkpcmV0dXJuIEYoYSk7dGhyb3cgRXJyb3IoXCJJbmRleCBvdXQgb2YgYm91bmRzXCIpO31pZihqYyhhKSlyZXR1cm4gRC5hKGEsYik7aWYoRShhKSl7dmFyIGM9SShhKSxoPWItMTthPWM7Yj1ofWVsc2V7aWYodSl0aHJvdyBFcnJvcihcIkluZGV4IG91dCBvZiBib3VuZHNcIik7cmV0dXJuIG51bGx9fX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGIuY2FsbCh0aGlzLGMsZSk7Y2FzZSAzOnJldHVybiBhLmNhbGwodGhpcyxcbmMsZSxmKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5hPWI7Yy5jPWE7cmV0dXJuIGN9KCksUD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMpe2lmKFwibnVtYmVyXCIhPT10eXBlb2YgYil0aHJvdyBFcnJvcihcImluZGV4IGFyZ3VtZW50IHRvIG50aCBtdXN0IGJlIGEgbnVtYmVyLlwiKTtpZihudWxsPT1hKXJldHVybiBjO2lmKGEmJihhLmkmMTZ8fGEuTGIpKXJldHVybiBhLmFhKG51bGwsYixjKTtpZihhIGluc3RhbmNlb2YgQXJyYXl8fFwic3RyaW5nXCI9PT10eXBlb2YgYSlyZXR1cm4gYjxhLmxlbmd0aD9hW2JdOmM7aWYocyhFYSxhKSlyZXR1cm4gRC5hKGEsYik7aWYoYT9hLmkmNjR8fGEuYmJ8fChhLmk/MDpzKEZhLGEpKTpzKEZhLGEpKXJldHVybiByYy5jKGEsYixjKTtpZih1KXRocm93IEVycm9yKFwibnRoIG5vdCBzdXBwb3J0ZWQgb24gdGhpcyB0eXBlIFwiK0EuYih1YSh0YShhKSkpKTtyZXR1cm4gbnVsbH1mdW5jdGlvbiBiKGEsXG5iKXtpZihcIm51bWJlclwiIT09dHlwZW9mIGIpdGhyb3cgRXJyb3IoXCJpbmRleCBhcmd1bWVudCB0byBudGggbXVzdCBiZSBhIG51bWJlclwiKTtpZihudWxsPT1hKXJldHVybiBhO2lmKGEmJihhLmkmMTZ8fGEuTGIpKXJldHVybiBhLkoobnVsbCxiKTtpZihhIGluc3RhbmNlb2YgQXJyYXl8fFwic3RyaW5nXCI9PT10eXBlb2YgYSlyZXR1cm4gYjxhLmxlbmd0aD9hW2JdOm51bGw7aWYocyhFYSxhKSlyZXR1cm4gRC5hKGEsYik7aWYoYT9hLmkmNjR8fGEuYmJ8fChhLmk/MDpzKEZhLGEpKTpzKEZhLGEpKXJldHVybiByYy5hKGEsYik7aWYodSl0aHJvdyBFcnJvcihcIm50aCBub3Qgc3VwcG9ydGVkIG9uIHRoaXMgdHlwZSBcIitBLmIodWEodGEoYSkpKSk7cmV0dXJuIG51bGx9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBiLmNhbGwodGhpcyxjLGUpO2Nhc2UgMzpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlLGYpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrXG5hcmd1bWVudHMubGVuZ3RoKTt9O2MuYT1iO2MuYz1hO3JldHVybiBjfSgpLFE9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjKXtyZXR1cm4gbnVsbCE9YT9hJiYoYS5pJjI1Nnx8YS5NYik/YS5DKG51bGwsYixjKTphIGluc3RhbmNlb2YgQXJyYXk/YjxhLmxlbmd0aD9hW2JdOmM6XCJzdHJpbmdcIj09PXR5cGVvZiBhP2I8YS5sZW5ndGg/YVtiXTpjOnMoS2EsYSk/TGEuYyhhLGIsYyk6dT9jOm51bGw6Y31mdW5jdGlvbiBiKGEsYil7cmV0dXJuIG51bGw9PWE/bnVsbDphJiYoYS5pJjI1Nnx8YS5NYik/YS51KG51bGwsYik6YSBpbnN0YW5jZW9mIEFycmF5P2I8YS5sZW5ndGg/YVtiXTpudWxsOlwic3RyaW5nXCI9PT10eXBlb2YgYT9iPGEubGVuZ3RoP2FbYl06bnVsbDpzKEthLGEpP0xhLmEoYSxiKTpudWxsfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gYi5jYWxsKHRoaXMsYyxlKTtjYXNlIDM6cmV0dXJuIGEuY2FsbCh0aGlzLFxuYyxlLGYpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmE9YjtjLmM9YTtyZXR1cm4gY30oKSxSPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyl7cmV0dXJuIG51bGwhPWE/T2EoYSxiLGMpOnNjLmE/c2MuYShbYl0sW2NdKTpzYy5jYWxsKG51bGwsW2JdLFtjXSl9dmFyIGI9bnVsbCxjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShiLGQsayxsKXt2YXIgbj1udWxsOzM8YXJndW1lbnRzLmxlbmd0aCYmKG49SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMyksMCkpO3JldHVybiBjLmNhbGwodGhpcyxiLGQsayxuKX1mdW5jdGlvbiBjKGEsZCxlLGwpe2Zvcig7OylpZihhPWIuYyhhLGQsZSkscihsKSlkPUYobCksZT1GKEkobCkpLGw9SShJKGwpKTtlbHNlIHJldHVybiBhfWEuaz0zO2EuZj1mdW5jdGlvbihhKXt2YXIgYj1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9SShhKTt2YXIgbD1GKGEpO2E9RyhhKTtyZXR1cm4gYyhiLFxuZCxsLGEpfTthLmQ9YztyZXR1cm4gYX0oKSxiPWZ1bmN0aW9uKGIsZSxmLGgpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDM6cmV0dXJuIGEuY2FsbCh0aGlzLGIsZSxmKTtkZWZhdWx0OnJldHVybiBjLmQoYixlLGYsSihhcmd1bWVudHMsMykpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtiLms9MztiLmY9Yy5mO2IuYz1hO2IuZD1jLmQ7cmV0dXJuIGJ9KCksdGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7cmV0dXJuIG51bGw9PWE/bnVsbDpRYShhLGIpfXZhciBiPW51bGwsYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYixkLGspe3ZhciBsPW51bGw7Mjxhcmd1bWVudHMubGVuZ3RoJiYobD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKSwwKSk7cmV0dXJuIGMuY2FsbCh0aGlzLGIsZCxsKX1mdW5jdGlvbiBjKGEsZCxlKXtmb3IoOzspe2lmKG51bGw9PWEpcmV0dXJuIG51bGw7YT1iLmEoYSxkKTtcbmlmKHIoZSkpZD1GKGUpLGU9SShlKTtlbHNlIHJldHVybiBhfX1hLms9MjthLmY9ZnVuY3Rpb24oYSl7dmFyIGI9RihhKTthPUkoYSk7dmFyIGQ9RihhKTthPUcoYSk7cmV0dXJuIGMoYixkLGEpfTthLmQ9YztyZXR1cm4gYX0oKSxiPWZ1bmN0aW9uKGIsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBiO2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsYixlKTtkZWZhdWx0OnJldHVybiBjLmQoYixlLEooYXJndW1lbnRzLDIpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yi5rPTI7Yi5mPWMuZjtiLmI9ZnVuY3Rpb24oYSl7cmV0dXJuIGF9O2IuYT1hO2IuZD1jLmQ7cmV0dXJuIGJ9KCk7ZnVuY3Rpb24gdWMoYSl7dmFyIGI9XCJmdW5jdGlvblwiPT1tKGEpO3JldHVybiBiP2I6YT9yKHIobnVsbCk/bnVsbDphLlhiKT8hMDphLkNiPyExOnMoeWEsYSk6cyh5YSxhKX1cbmZ1bmN0aW9uIHZjKGEsYil7dGhpcy5oPWE7dGhpcy5qPWI7dGhpcy5xPTA7dGhpcy5pPTM5MzIxN31nPXZjLnByb3RvdHlwZTtcbmcuY2FsbD1mdW5jdGlvbigpe3ZhciBhPW51bGw7cmV0dXJuIGE9ZnVuY3Rpb24oYSxjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFosbmEsR2EsUmEsd2Mpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6dmFyIHo9YSx6PXRoaXM7cmV0dXJuIHouaC5vP3ouaC5vKCk6ei5oLmNhbGwobnVsbCk7Y2FzZSAyOnJldHVybiB6PWEsej10aGlzLHouaC5iP3ouaC5iKGMpOnouaC5jYWxsKG51bGwsYyk7Y2FzZSAzOnJldHVybiB6PWEsej10aGlzLHouaC5hP3ouaC5hKGMsZCk6ei5oLmNhbGwobnVsbCxjLGQpO2Nhc2UgNDpyZXR1cm4gej1hLHo9dGhpcyx6LmguYz96LmguYyhjLGQsZSk6ei5oLmNhbGwobnVsbCxjLGQsZSk7Y2FzZSA1OnJldHVybiB6PWEsej10aGlzLHouaC5uP3ouaC5uKGMsZCxlLGYpOnouaC5jYWxsKG51bGwsYyxkLGUsZik7Y2FzZSA2OnJldHVybiB6PWEsej10aGlzLHouaC5zP3ouaC5zKGMsZCxlLGYsaCk6ei5oLmNhbGwobnVsbCxjLGQsZSxmLFxuaCk7Y2FzZSA3OnJldHVybiB6PWEsej10aGlzLHouaC5YP3ouaC5YKGMsZCxlLGYsaCxrKTp6LmguY2FsbChudWxsLGMsZCxlLGYsaCxrKTtjYXNlIDg6cmV0dXJuIHo9YSx6PXRoaXMsei5oLmdhP3ouaC5nYShjLGQsZSxmLGgsayxsKTp6LmguY2FsbChudWxsLGMsZCxlLGYsaCxrLGwpO2Nhc2UgOTpyZXR1cm4gej1hLHo9dGhpcyx6LmguR2E/ei5oLkdhKGMsZCxlLGYsaCxrLGwsbik6ei5oLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4pO2Nhc2UgMTA6cmV0dXJuIHo9YSx6PXRoaXMsei5oLkhhP3ouaC5IYShjLGQsZSxmLGgsayxsLG4scSk6ei5oLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4scSk7Y2FzZSAxMTpyZXR1cm4gej1hLHo9dGhpcyx6LmgudmE/ei5oLnZhKGMsZCxlLGYsaCxrLGwsbixxLHQpOnouaC5jYWxsKG51bGwsYyxkLGUsZixoLGssbCxuLHEsdCk7Y2FzZSAxMjpyZXR1cm4gej1hLHo9dGhpcyx6Lmgud2E/ei5oLndhKGMsZCxlLGYsaCxrLGwsbixxLHQsdik6XG56LmguY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxLHQsdik7Y2FzZSAxMzpyZXR1cm4gej1hLHo9dGhpcyx6LmgueGE/ei5oLnhhKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3KTp6LmguY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3KTtjYXNlIDE0OnJldHVybiB6PWEsej10aGlzLHouaC55YT96LmgueWEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSk6ei5oLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5KTtjYXNlIDE1OnJldHVybiB6PWEsej10aGlzLHouaC56YT96LmguemEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCKTp6LmguY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQik7Y2FzZSAxNjpyZXR1cm4gej1hLHo9dGhpcyx6LmguQWE/ei5oLkFhKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMKTp6LmguY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMKTtjYXNlIDE3OnJldHVybiB6PWEsej10aGlzLFxuei5oLkJhP3ouaC5CYShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVKTp6LmguY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUpO2Nhc2UgMTg6cmV0dXJuIHo9YSx6PXRoaXMsei5oLkNhP3ouaC5DYShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFopOnouaC5jYWxsKG51bGwsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaKTtjYXNlIDE5OnJldHVybiB6PWEsej10aGlzLHouaC5EYT96LmguRGEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaLG5hKTp6LmguY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWixuYSk7Y2FzZSAyMDpyZXR1cm4gej1hLHo9dGhpcyx6LmguRWE/ei5oLkVhKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWixuYSxHYSk6ei5oLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFosbmEsR2EpO2Nhc2UgMjE6cmV0dXJuIHo9XG5hLHo9dGhpcyx6LmguRmE/ei5oLkZhKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWixuYSxHYSxSYSk6ei5oLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFosbmEsR2EsUmEpO2Nhc2UgMjI6cmV0dXJuIHo9YSx6PXRoaXMsUy5iYz9TLmJjKHouaCxjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFosbmEsR2EsUmEsd2MpOlMuY2FsbChudWxsLHouaCxjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFosbmEsR2EsUmEsd2MpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fX0oKTtnLmFwcGx5PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuY2FsbC5hcHBseSh0aGlzLFt0aGlzXS5jb25jYXQodmEoYikpKX07Zy5vPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaC5vP3RoaXMuaC5vKCk6dGhpcy5oLmNhbGwobnVsbCl9O1xuZy5iPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmguYj90aGlzLmguYihhKTp0aGlzLmguY2FsbChudWxsLGEpfTtnLmE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5oLmE/dGhpcy5oLmEoYSxiKTp0aGlzLmguY2FsbChudWxsLGEsYil9O2cuYz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHRoaXMuaC5jP3RoaXMuaC5jKGEsYixjKTp0aGlzLmguY2FsbChudWxsLGEsYixjKX07Zy5uPWZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiB0aGlzLmgubj90aGlzLmgubihhLGIsYyxkKTp0aGlzLmguY2FsbChudWxsLGEsYixjLGQpfTtnLnM9ZnVuY3Rpb24oYSxiLGMsZCxlKXtyZXR1cm4gdGhpcy5oLnM/dGhpcy5oLnMoYSxiLGMsZCxlKTp0aGlzLmguY2FsbChudWxsLGEsYixjLGQsZSl9O2cuWD1mdW5jdGlvbihhLGIsYyxkLGUsZil7cmV0dXJuIHRoaXMuaC5YP3RoaXMuaC5YKGEsYixjLGQsZSxmKTp0aGlzLmguY2FsbChudWxsLGEsYixjLGQsZSxmKX07XG5nLmdhPWZ1bmN0aW9uKGEsYixjLGQsZSxmLGgpe3JldHVybiB0aGlzLmguZ2E/dGhpcy5oLmdhKGEsYixjLGQsZSxmLGgpOnRoaXMuaC5jYWxsKG51bGwsYSxiLGMsZCxlLGYsaCl9O2cuR2E9ZnVuY3Rpb24oYSxiLGMsZCxlLGYsaCxrKXtyZXR1cm4gdGhpcy5oLkdhP3RoaXMuaC5HYShhLGIsYyxkLGUsZixoLGspOnRoaXMuaC5jYWxsKG51bGwsYSxiLGMsZCxlLGYsaCxrKX07Zy5IYT1mdW5jdGlvbihhLGIsYyxkLGUsZixoLGssbCl7cmV0dXJuIHRoaXMuaC5IYT90aGlzLmguSGEoYSxiLGMsZCxlLGYsaCxrLGwpOnRoaXMuaC5jYWxsKG51bGwsYSxiLGMsZCxlLGYsaCxrLGwpfTtnLnZhPWZ1bmN0aW9uKGEsYixjLGQsZSxmLGgsayxsLG4pe3JldHVybiB0aGlzLmgudmE/dGhpcy5oLnZhKGEsYixjLGQsZSxmLGgsayxsLG4pOnRoaXMuaC5jYWxsKG51bGwsYSxiLGMsZCxlLGYsaCxrLGwsbil9O1xuZy53YT1mdW5jdGlvbihhLGIsYyxkLGUsZixoLGssbCxuLHEpe3JldHVybiB0aGlzLmgud2E/dGhpcy5oLndhKGEsYixjLGQsZSxmLGgsayxsLG4scSk6dGhpcy5oLmNhbGwobnVsbCxhLGIsYyxkLGUsZixoLGssbCxuLHEpfTtnLnhhPWZ1bmN0aW9uKGEsYixjLGQsZSxmLGgsayxsLG4scSx0KXtyZXR1cm4gdGhpcy5oLnhhP3RoaXMuaC54YShhLGIsYyxkLGUsZixoLGssbCxuLHEsdCk6dGhpcy5oLmNhbGwobnVsbCxhLGIsYyxkLGUsZixoLGssbCxuLHEsdCl9O2cueWE9ZnVuY3Rpb24oYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdil7cmV0dXJuIHRoaXMuaC55YT90aGlzLmgueWEoYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdik6dGhpcy5oLmNhbGwobnVsbCxhLGIsYyxkLGUsZixoLGssbCxuLHEsdCx2KX07XG5nLnphPWZ1bmN0aW9uKGEsYixjLGQsZSxmLGgsayxsLG4scSx0LHYsdyl7cmV0dXJuIHRoaXMuaC56YT90aGlzLmguemEoYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3KTp0aGlzLmguY2FsbChudWxsLGEsYixjLGQsZSxmLGgsayxsLG4scSx0LHYsdyl9O2cuQWE9ZnVuY3Rpb24oYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHkpe3JldHVybiB0aGlzLmguQWE/dGhpcy5oLkFhKGEsYixjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5KTp0aGlzLmguY2FsbChudWxsLGEsYixjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5KX07Zy5CYT1mdW5jdGlvbihhLGIsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCKXtyZXR1cm4gdGhpcy5oLkJhP3RoaXMuaC5CYShhLGIsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCKTp0aGlzLmguY2FsbChudWxsLGEsYixjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIpfTtcbmcuQ2E9ZnVuY3Rpb24oYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMKXtyZXR1cm4gdGhpcy5oLkNhP3RoaXMuaC5DYShhLGIsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwpOnRoaXMuaC5jYWxsKG51bGwsYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMKX07Zy5EYT1mdW5jdGlvbihhLGIsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSl7cmV0dXJuIHRoaXMuaC5EYT90aGlzLmguRGEoYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUpOnRoaXMuaC5jYWxsKG51bGwsYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUpfTtcbmcuRWE9ZnVuY3Rpb24oYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWil7cmV0dXJuIHRoaXMuaC5FYT90aGlzLmguRWEoYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWik6dGhpcy5oLmNhbGwobnVsbCxhLGIsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaKX07Zy5GYT1mdW5jdGlvbihhLGIsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaLG5hKXtyZXR1cm4gdGhpcy5oLkZhP3RoaXMuaC5GYShhLGIsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaLG5hKTp0aGlzLmguY2FsbChudWxsLGEsYixjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFosbmEpfTtnLlhiPSEwO2cuRj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgdmModGhpcy5oLGIpfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5qfTtcbmZ1bmN0aW9uIE4oYSxiKXtyZXR1cm4gdWMoYSkmJiEoYT9hLmkmMjYyMTQ0fHxhLm9jfHwoYS5pPzA6cyhkYixhKSk6cyhkYixhKSk/bmV3IHZjKGEsYik6bnVsbD09YT9udWxsOmViKGEsYil9ZnVuY3Rpb24geGMoYSl7dmFyIGI9bnVsbCE9YTtyZXR1cm4oYj9hP2EuaSYxMzEwNzJ8fGEuZWN8fChhLmk/MDpzKGJiLGEpKTpzKGJiLGEpOmIpP2NiKGEpOm51bGx9ZnVuY3Rpb24geWMoYSl7cmV0dXJuIG51bGw9PWE/bnVsbDpYYShhKX1mdW5jdGlvbiB6YyhhKXtyZXR1cm4gbnVsbD09YT9udWxsOllhKGEpfVxudmFyIEFjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3JldHVybiBudWxsPT1hP251bGw6V2EoYSxiKX12YXIgYj1udWxsLGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGIsZCxrKXt2YXIgbD1udWxsOzI8YXJndW1lbnRzLmxlbmd0aCYmKGw9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMiksMCkpO3JldHVybiBjLmNhbGwodGhpcyxiLGQsbCl9ZnVuY3Rpb24gYyhhLGQsZSl7Zm9yKDs7KXtpZihudWxsPT1hKXJldHVybiBudWxsO2E9Yi5hKGEsZCk7aWYocihlKSlkPUYoZSksZT1JKGUpO2Vsc2UgcmV0dXJuIGF9fWEuaz0yO2EuZj1mdW5jdGlvbihhKXt2YXIgYj1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9RyhhKTtyZXR1cm4gYyhiLGQsYSl9O2EuZD1jO3JldHVybiBhfSgpLGI9ZnVuY3Rpb24oYixlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGI7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxiLGUpO2RlZmF1bHQ6cmV0dXJuIGMuZChiLFxuZSxKKGFyZ3VtZW50cywyKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Iuaz0yO2IuZj1jLmY7Yi5iPWZ1bmN0aW9uKGEpe3JldHVybiBhfTtiLmE9YTtiLmQ9Yy5kO3JldHVybiBifSgpO2Z1bmN0aW9uIEJjKGEpe3JldHVybiBudWxsPT1hfHxzYShFKGEpKX1mdW5jdGlvbiBDYyhhKXtyZXR1cm4gbnVsbD09YT8hMTphP2EuaSY4fHxhLkFjPyEwOmEuaT8hMTpzKENhLGEpOnMoQ2EsYSl9ZnVuY3Rpb24gRGMoYSl7cmV0dXJuIG51bGw9PWE/ITE6YT9hLmkmNDA5Nnx8YS5qYz8hMDphLmk/ITE6cyhWYSxhKTpzKFZhLGEpfWZ1bmN0aW9uIEVjKGEpe3JldHVybiBhP2EuaSY1MTJ8fGEueWM/ITA6YS5pPyExOnMoTWEsYSk6cyhNYSxhKX1mdW5jdGlvbiBGYyhhKXtyZXR1cm4gYT9hLmkmMTY3NzcyMTZ8fGEuaWM/ITA6YS5pPyExOnMobWIsYSk6cyhtYixhKX1cbmZ1bmN0aW9uIEdjKGEpe3JldHVybiBudWxsPT1hPyExOmE/YS5pJjEwMjR8fGEuY2M/ITA6YS5pPyExOnMoUGEsYSk6cyhQYSxhKX1mdW5jdGlvbiBIYyhhKXtyZXR1cm4gYT9hLmkmMTYzODR8fGEuR2M/ITA6YS5pPyExOnMoWmEsYSk6cyhaYSxhKX1mdW5jdGlvbiBJYyhhKXtyZXR1cm4gYT9hLnEmNTEyfHxhLnpjPyEwOiExOiExfWZ1bmN0aW9uIEpjKGEpe3ZhciBiPVtdO2RhKGEsZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKGIsZSl7cmV0dXJuIGEucHVzaChlKX19KGIpKTtyZXR1cm4gYn1mdW5jdGlvbiBLYyhhLGIsYyxkLGUpe2Zvcig7MCE9PWU7KWNbZF09YVtiXSxkKz0xLGUtPTEsYis9MX12YXIgTGM9e307ZnVuY3Rpb24gTWMoYSl7cmV0dXJuIG51bGw9PWE/ITE6YT9hLmkmNjR8fGEuYmI/ITA6YS5pPyExOnMoRmEsYSk6cyhGYSxhKX1mdW5jdGlvbiBOYyhhKXtyZXR1cm4gcihhKT8hMDohMX1cbmZ1bmN0aW9uIE9jKGEsYil7cmV0dXJuIFEuYyhhLGIsTGMpPT09TGM/ITE6ITB9ZnVuY3Rpb24gWGIoYSxiKXtpZihhPT09YilyZXR1cm4gMDtpZihudWxsPT1hKXJldHVybi0xO2lmKG51bGw9PWIpcmV0dXJuIDE7aWYodGEoYSk9PT10YShiKSlyZXR1cm4gYSYmKGEucSYyMDQ4fHxhLmxiKT9hLm1iKG51bGwsYik6Z2EoYSxiKTtpZih1KXRocm93IEVycm9yKFwiY29tcGFyZSBvbiBub24tbmlsIG9iamVjdHMgb2YgZGlmZmVyZW50IHR5cGVzXCIpO3JldHVybiBudWxsfVxudmFyIFBjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyxoKXtmb3IoOzspe3ZhciBrPVhiKFAuYShhLGgpLFAuYShiLGgpKTtpZigwPT09ayYmaCsxPGMpaCs9MTtlbHNlIHJldHVybiBrfX1mdW5jdGlvbiBiKGEsYil7dmFyIGY9TyhhKSxoPU8oYik7cmV0dXJuIGY8aD8tMTpmPmg/MTp1P2MubihhLGIsZiwwKTpudWxsfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUsZixoKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBiLmNhbGwodGhpcyxjLGUpO2Nhc2UgNDpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlLGYsaCl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYT1iO2Mubj1hO3JldHVybiBjfSgpO1xuZnVuY3Rpb24gUWMoYSl7cmV0dXJuIFdiLmEoYSxYYik/WGI6ZnVuY3Rpb24oYixjKXt2YXIgZD1hLmE/YS5hKGIsYyk6YS5jYWxsKG51bGwsYixjKTtyZXR1cm5cIm51bWJlclwiPT09dHlwZW9mIGQ/ZDpyKGQpPy0xOnIoYS5hP2EuYShjLGIpOmEuY2FsbChudWxsLGMsYikpPzE6MH19XG52YXIgU2M9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7aWYoRShiKSl7dmFyIGM9UmMuYj9SYy5iKGIpOlJjLmNhbGwobnVsbCxiKTtoYShjLFFjKGEpKTtyZXR1cm4gRShjKX1yZXR1cm4gSH1mdW5jdGlvbiBiKGEpe3JldHVybiBjLmEoWGIsYSl9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYi5jYWxsKHRoaXMsYyk7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxjLGUpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmI9YjtjLmE9YTtyZXR1cm4gY30oKSxUYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMpe3JldHVybiBTYy5hKGZ1bmN0aW9uKGMsZil7cmV0dXJuIFFjKGIpLmNhbGwobnVsbCxhLmI/YS5iKGMpOmEuY2FsbChudWxsLGMpLGEuYj9hLmIoZik6YS5jYWxsKG51bGwsZikpfSxjKX1mdW5jdGlvbiBiKGEsYil7cmV0dXJuIGMuYyhhLFhiLGIpfVxudmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBiLmNhbGwodGhpcyxjLGUpO2Nhc2UgMzpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlLGYpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmE9YjtjLmM9YTtyZXR1cm4gY30oKSxuYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMpe2ZvcihjPUUoYyk7OylpZihjKXtiPWEuYT9hLmEoYixGKGMpKTphLmNhbGwobnVsbCxiLEYoYykpO2lmKGZjKGIpKXJldHVybiBLLmI/Sy5iKGIpOksuY2FsbChudWxsLGIpO2M9SShjKX1lbHNlIHJldHVybiBifWZ1bmN0aW9uIGIoYSxiKXt2YXIgYz1FKGIpO3JldHVybiBjP0MuYz9DLmMoYSxGKGMpLEkoYykpOkMuY2FsbChudWxsLGEsRihjKSxJKGMpKTphLm8/YS5vKCk6YS5jYWxsKG51bGwpfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gYi5jYWxsKHRoaXMsXG5jLGUpO2Nhc2UgMzpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlLGYpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmE9YjtjLmM9YTtyZXR1cm4gY30oKSxDPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyl7cmV0dXJuIGMmJihjLmkmNTI0Mjg4fHxjLk5iKT9jLk0obnVsbCxhLGIpOmMgaW5zdGFuY2VvZiBBcnJheT9oYy5jKGMsYSxiKTpcInN0cmluZ1wiPT09dHlwZW9mIGM/aGMuYyhjLGEsYik6cyhmYixjKT9nYi5jKGMsYSxiKTp1P25jLmMoYSxiLGMpOm51bGx9ZnVuY3Rpb24gYihhLGIpe3JldHVybiBiJiYoYi5pJjUyNDI4OHx8Yi5OYik/Yi5OKG51bGwsYSk6YiBpbnN0YW5jZW9mIEFycmF5P2hjLmEoYixhKTpcInN0cmluZ1wiPT09dHlwZW9mIGI/aGMuYShiLGEpOnMoZmIsYik/Z2IuYShiLGEpOnU/bmMuYShhLGIpOm51bGx9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBiLmNhbGwodGhpcyxcbmMsZSk7Y2FzZSAzOnJldHVybiBhLmNhbGwodGhpcyxjLGUsZil9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYT1iO2MuYz1hO3JldHVybiBjfSgpLFVjPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbCxiPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShjLGYsaCl7dmFyIGs9bnVsbDsyPGFyZ3VtZW50cy5sZW5ndGgmJihrPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYyxmLGspfWZ1bmN0aW9uIGIoYSxjLGQpe2Zvcig7OylpZihhPmMpaWYoSShkKSlhPWMsYz1GKGQpLGQ9SShkKTtlbHNlIHJldHVybiBjPkYoZCk7ZWxzZSByZXR1cm4hMX1hLms9MjthLmY9ZnVuY3Rpb24oYSl7dmFyIGM9RihhKTthPUkoYSk7dmFyIGg9RihhKTthPUcoYSk7cmV0dXJuIGIoYyxoLGEpfTthLmQ9YjtyZXR1cm4gYX0oKSxhPWZ1bmN0aW9uKGEsZCxlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiEwO1xuY2FzZSAyOnJldHVybiBhPmQ7ZGVmYXVsdDpyZXR1cm4gYi5kKGEsZCxKKGFyZ3VtZW50cywyKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Euaz0yO2EuZj1iLmY7YS5iPWZ1bmN0aW9uKCl7cmV0dXJuITB9O2EuYT1mdW5jdGlvbihhLGIpe3JldHVybiBhPmJ9O2EuZD1iLmQ7cmV0dXJuIGF9KCksVmM9ZnVuY3Rpb24oKXt2YXIgYT1udWxsLGI9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGMsZixoKXt2YXIgaz1udWxsOzI8YXJndW1lbnRzLmxlbmd0aCYmKGs9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMiksMCkpO3JldHVybiBiLmNhbGwodGhpcyxjLGYsayl9ZnVuY3Rpb24gYihhLGMsZCl7Zm9yKDs7KWlmKGE+PWMpaWYoSShkKSlhPWMsYz1GKGQpLGQ9SShkKTtlbHNlIHJldHVybiBjPj1GKGQpO2Vsc2UgcmV0dXJuITF9YS5rPTI7YS5mPWZ1bmN0aW9uKGEpe3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBoPUYoYSk7XG5hPUcoYSk7cmV0dXJuIGIoYyxoLGEpfTthLmQ9YjtyZXR1cm4gYX0oKSxhPWZ1bmN0aW9uKGEsZCxlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiEwO2Nhc2UgMjpyZXR1cm4gYT49ZDtkZWZhdWx0OnJldHVybiBiLmQoYSxkLEooYXJndW1lbnRzLDIpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307YS5rPTI7YS5mPWIuZjthLmI9ZnVuY3Rpb24oKXtyZXR1cm4hMH07YS5hPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGE+PWJ9O2EuZD1iLmQ7cmV0dXJuIGF9KCk7ZnVuY3Rpb24gV2MoYSl7cmV0dXJuIGEtMX1cbnZhciBYYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4gYT5iP2E6Yn12YXIgYj1udWxsLGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGIsZCxrKXt2YXIgbD1udWxsOzI8YXJndW1lbnRzLmxlbmd0aCYmKGw9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMiksMCkpO3JldHVybiBjLmNhbGwodGhpcyxiLGQsbCl9ZnVuY3Rpb24gYyhhLGQsZSl7cmV0dXJuIEMuYyhiLGE+ZD9hOmQsZSl9YS5rPTI7YS5mPWZ1bmN0aW9uKGEpe3ZhciBiPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1HKGEpO3JldHVybiBjKGIsZCxhKX07YS5kPWM7cmV0dXJuIGF9KCksYj1mdW5jdGlvbihiLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYjtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGIsZSk7ZGVmYXVsdDpyZXR1cm4gYy5kKGIsZSxKKGFyZ3VtZW50cywyKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTtcbn07Yi5rPTI7Yi5mPWMuZjtiLmI9ZnVuY3Rpb24oYSl7cmV0dXJuIGF9O2IuYT1hO2IuZD1jLmQ7cmV0dXJuIGJ9KCk7ZnVuY3Rpb24gWWMoYSl7YT0oYS1hJTIpLzI7cmV0dXJuIDA8PWE/TWF0aC5mbG9vci5iP01hdGguZmxvb3IuYihhKTpNYXRoLmZsb29yLmNhbGwobnVsbCxhKTpNYXRoLmNlaWwuYj9NYXRoLmNlaWwuYihhKTpNYXRoLmNlaWwuY2FsbChudWxsLGEpfWZ1bmN0aW9uIFpjKGEpe2EtPWE+PjEmMTQzMTY1NTc2NTthPShhJjg1ODk5MzQ1OSkrKGE+PjImODU4OTkzNDU5KTtyZXR1cm4gMTY4NDMwMDkqKGErKGE+PjQpJjI1MjY0NTEzNSk+PjI0fWZ1bmN0aW9uICRjKGEpe3ZhciBiPTE7Zm9yKGE9RShhKTs7KWlmKGEmJjA8YiliLT0xLGE9SShhKTtlbHNlIHJldHVybiBhfVxudmFyIEE9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEpe3JldHVybiBudWxsPT1hP1wiXCI6YS50b1N0cmluZygpfXZhciBiPW51bGwsYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYixkKXt2YXIgaz1udWxsOzE8YXJndW1lbnRzLmxlbmd0aCYmKGs9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSksMCkpO3JldHVybiBjLmNhbGwodGhpcyxiLGspfWZ1bmN0aW9uIGMoYSxkKXtmb3IodmFyIGU9bmV3IGVhKGIuYihhKSksbD1kOzspaWYocihsKSllPWUuYXBwZW5kKGIuYihGKGwpKSksbD1JKGwpO2Vsc2UgcmV0dXJuIGUudG9TdHJpbmcoKX1hLms9MTthLmY9ZnVuY3Rpb24oYSl7dmFyIGI9RihhKTthPUcoYSk7cmV0dXJuIGMoYixhKX07YS5kPWM7cmV0dXJuIGF9KCksYj1mdW5jdGlvbihiLGUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDA6cmV0dXJuXCJcIjtjYXNlIDE6cmV0dXJuIGEuY2FsbCh0aGlzLGIpO2RlZmF1bHQ6cmV0dXJuIGMuZChiLEooYXJndW1lbnRzLFxuMSkpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtiLms9MTtiLmY9Yy5mO2Iubz1mdW5jdGlvbigpe3JldHVyblwiXCJ9O2IuYj1hO2IuZD1jLmQ7cmV0dXJuIGJ9KCksYWQ9ZnVuY3Rpb24oKXt2YXIgYT1udWxsLGE9ZnVuY3Rpb24oYSxjLGQpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGEuc3Vic3RyaW5nKGMpO2Nhc2UgMzpyZXR1cm4gYS5zdWJzdHJpbmcoYyxkKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307YS5hPWZ1bmN0aW9uKGEsYyl7cmV0dXJuIGEuc3Vic3RyaW5nKGMpfTthLmM9ZnVuY3Rpb24oYSxjLGQpe3JldHVybiBhLnN1YnN0cmluZyhjLGQpfTtyZXR1cm4gYX0oKTtcbmZ1bmN0aW9uIGxjKGEsYil7cmV0dXJuIE5jKEZjKGIpP2Z1bmN0aW9uKCl7Zm9yKHZhciBjPUUoYSksZD1FKGIpOzspe2lmKG51bGw9PWMpcmV0dXJuIG51bGw9PWQ7aWYobnVsbD09ZClyZXR1cm4hMTtpZihXYi5hKEYoYyksRihkKSkpYz1JKGMpLGQ9SShkKTtlbHNlIHJldHVybiB1PyExOm51bGx9fSgpOm51bGwpfWZ1bmN0aW9uIGJkKGEsYixjLGQsZSl7dGhpcy5qPWE7dGhpcy5maXJzdD1iO3RoaXMudGE9Yzt0aGlzLmNvdW50PWQ7dGhpcy5tPWU7dGhpcy5pPTY1OTM3NjQ2O3RoaXMucT04MTkyfWc9YmQucHJvdG90eXBlO2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O2cuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmp9O2cuVT1mdW5jdGlvbigpe3JldHVybiAxPT09dGhpcy5jb3VudD9udWxsOnRoaXMudGF9O2cuTD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvdW50fTtnLklhPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZmlyc3R9O2cuSmE9ZnVuY3Rpb24oKXtyZXR1cm4gSWEodGhpcyl9O1xuZy5CPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tO3JldHVybiBudWxsIT1hP2E6dGhpcy5tPWE9Y2ModGhpcyl9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBsYyh0aGlzLGIpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gSH07Zy5OPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5jLmEoYix0aGlzKX07Zy5NPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gbmMuYyhiLGMsdGhpcyl9O2cuUT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmZpcnN0fTtnLlM9ZnVuY3Rpb24oKXtyZXR1cm4gMT09PXRoaXMuY291bnQ/SDp0aGlzLnRhfTtnLkg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc307Zy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBiZChiLHRoaXMuZmlyc3QsdGhpcy50YSx0aGlzLmNvdW50LHRoaXMubSl9O2cuRz1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgYmQodGhpcy5qLGIsdGhpcyx0aGlzLmNvdW50KzEsbnVsbCl9O1xuZnVuY3Rpb24gY2QoYSl7dGhpcy5qPWE7dGhpcy5pPTY1OTM3NjE0O3RoaXMucT04MTkyfWc9Y2QucHJvdG90eXBlO2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O2cuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmp9O2cuVT1mdW5jdGlvbigpe3JldHVybiBudWxsfTtnLkw9ZnVuY3Rpb24oKXtyZXR1cm4gMH07Zy5JYT1mdW5jdGlvbigpe3JldHVybiBudWxsfTtnLkphPWZ1bmN0aW9uKCl7dGhyb3cgRXJyb3IoXCJDYW4ndCBwb3AgZW1wdHkgbGlzdFwiKTt9O2cuQj1mdW5jdGlvbigpe3JldHVybiAwfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbGModGhpcyxiKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9O2cuTj1mdW5jdGlvbihhLGIpe3JldHVybiBuYy5hKGIsdGhpcyl9O2cuTT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIG5jLmMoYixjLHRoaXMpfTtnLlE9ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbH07Zy5TPWZ1bmN0aW9uKCl7cmV0dXJuIEh9O1xuZy5IPWZ1bmN0aW9uKCl7cmV0dXJuIG51bGx9O2cuRj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgY2QoYil9O2cuRz1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgYmQodGhpcy5qLGIsbnVsbCwxLG51bGwpfTt2YXIgSD1uZXcgY2QobnVsbCk7ZnVuY3Rpb24gZGQoYSl7cmV0dXJuIGE/YS5pJjEzNDIxNzcyOHx8YS5GYz8hMDphLmk/ITE6cyhvYixhKTpzKG9iLGEpfWZ1bmN0aW9uIGVkKGEpe3JldHVybiBkZChhKT9wYihhKTpDLmMocGMsSCxhKX1cbnZhciBmZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSl7dmFyIGQ9bnVsbDswPGFyZ3VtZW50cy5sZW5ndGgmJihkPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsZCl9ZnVuY3Rpb24gYihhKXt2YXIgYjtpZihhIGluc3RhbmNlb2YgYWMmJjA9PT1hLnApYj1hLmU7ZWxzZSBhOntmb3IoYj1bXTs7KWlmKG51bGwhPWEpYi5wdXNoKGEuUShudWxsKSksYT1hLlUobnVsbCk7ZWxzZSBicmVhayBhO2I9dm9pZCAwfWE9Yi5sZW5ndGg7Zm9yKHZhciBlPUg7OylpZigwPGEpe3ZhciBmPWEtMSxlPWUuRyhudWxsLGJbYS0xXSk7YT1mfWVsc2UgcmV0dXJuIGV9YS5rPTA7YS5mPWZ1bmN0aW9uKGEpe2E9RShhKTtyZXR1cm4gYihhKX07YS5kPWI7cmV0dXJuIGF9KCk7ZnVuY3Rpb24gZ2QoYSxiLGMsZCl7dGhpcy5qPWE7dGhpcy5maXJzdD1iO3RoaXMudGE9Yzt0aGlzLm09ZDt0aGlzLmk9NjU5Mjk0NTI7dGhpcy5xPTgxOTJ9XG5nPWdkLnByb3RvdHlwZTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIExiKHRoaXMpfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5qfTtnLlU9ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbD09dGhpcy50YT9udWxsOkUodGhpcy50YSl9O2cuQj1mdW5jdGlvbigpe3ZhciBhPXRoaXMubTtyZXR1cm4gbnVsbCE9YT9hOnRoaXMubT1hPWNjKHRoaXMpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbGModGhpcyxiKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIE4oSCx0aGlzLmopfTtnLk49ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmMuYShiLHRoaXMpfTtnLk09ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBuYy5jKGIsYyx0aGlzKX07Zy5RPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZmlyc3R9O2cuUz1mdW5jdGlvbigpe3JldHVybiBudWxsPT10aGlzLnRhP0g6dGhpcy50YX07Zy5IPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9O1xuZy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBnZChiLHRoaXMuZmlyc3QsdGhpcy50YSx0aGlzLm0pfTtnLkc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IGdkKG51bGwsYix0aGlzLHRoaXMubSl9O2Z1bmN0aW9uIE0oYSxiKXt2YXIgYz1udWxsPT1iO3JldHVybihjP2M6YiYmKGIuaSY2NHx8Yi5iYikpP25ldyBnZChudWxsLGEsYixudWxsKTpuZXcgZ2QobnVsbCxhLEUoYiksbnVsbCl9ZnVuY3Rpb24gVChhLGIsYyxkKXt0aGlzLmZhPWE7dGhpcy5uYW1lPWI7dGhpcy5zYT1jO3RoaXMuVWE9ZDt0aGlzLmk9MjE1Mzc3NTEwNTt0aGlzLnE9NDA5Nn1nPVQucHJvdG90eXBlO2cudz1mdW5jdGlvbihhLGIpe3JldHVybiB1YihiLFwiOlwiK0EuYih0aGlzLnNhKSl9O2cuQj1mdW5jdGlvbigpe3ZhciBhPXRoaXMuVWE7cmV0dXJuIG51bGwhPWE/YTp0aGlzLlVhPWE9VWIodGhpcykrMjY1NDQzNTc2OX07XG5nLmNhbGw9ZnVuY3Rpb24oKXt2YXIgYT1udWxsO3JldHVybiBhPWZ1bmN0aW9uKGEsYyxkKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBRLmEoYyx0aGlzKTtjYXNlIDM6cmV0dXJuIFEuYyhjLHRoaXMsZCl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9fSgpO2cuYXBwbHk9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5jYWxsLmFwcGx5KHRoaXMsW3RoaXNdLmNvbmNhdCh2YShiKSkpfTtnLmI9ZnVuY3Rpb24oYSl7cmV0dXJuIFEuYShhLHRoaXMpfTtnLmE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gUS5jKGEsdGhpcyxiKX07Zy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGIgaW5zdGFuY2VvZiBUP3RoaXMuc2E9PT1iLnNhOiExfTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuXCI6XCIrQS5iKHRoaXMuc2EpfTtcbmZ1bmN0aW9uIGhkKGEsYil7cmV0dXJuIGE9PT1iPyEwOmEgaW5zdGFuY2VvZiBUJiZiIGluc3RhbmNlb2YgVD9hLnNhPT09Yi5zYTohMX1cbnZhciBqZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4gbmV3IFQoYSxiLFwiXCIrQS5iKHIoYSk/XCJcIitBLmIoYSkrXCIvXCI6bnVsbCkrQS5iKGIpLG51bGwpfWZ1bmN0aW9uIGIoYSl7aWYoYSBpbnN0YW5jZW9mIFQpcmV0dXJuIGE7aWYoYSBpbnN0YW5jZW9mIFpiKXt2YXIgYjtpZihhJiYoYS5xJjQwOTZ8fGEuZmMpKWI9YS5mYTtlbHNlIHRocm93IEVycm9yKFwiRG9lc24ndCBzdXBwb3J0IG5hbWVzcGFjZTogXCIrQS5iKGEpKTtyZXR1cm4gbmV3IFQoYixpZC5iP2lkLmIoYSk6aWQuY2FsbChudWxsLGEpLGEuTmEsbnVsbCl9cmV0dXJuXCJzdHJpbmdcIj09PXR5cGVvZiBhPyhiPWEuc3BsaXQoXCIvXCIpLDI9PT1iLmxlbmd0aD9uZXcgVChiWzBdLGJbMV0sYSxudWxsKTpuZXcgVChudWxsLGJbMF0sYSxudWxsKSk6bnVsbH12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBiLmNhbGwodGhpcyxjKTtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLFxuYyxlKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5iPWI7Yy5hPWE7cmV0dXJuIGN9KCk7ZnVuY3Rpb24gVihhLGIsYyxkKXt0aGlzLmo9YTt0aGlzLllhPWI7dGhpcy5yPWM7dGhpcy5tPWQ7dGhpcy5xPTA7dGhpcy5pPTMyMzc0OTg4fWc9Vi5wcm90b3R5cGU7Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07ZnVuY3Rpb24ga2QoYSl7bnVsbCE9YS5ZYSYmKGEucj1hLllhLm8/YS5ZYS5vKCk6YS5ZYS5jYWxsKG51bGwpLGEuWWE9bnVsbCk7cmV0dXJuIGEucn1nLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5qfTtnLlU9ZnVuY3Rpb24oKXtsYih0aGlzKTtyZXR1cm4gbnVsbD09dGhpcy5yP251bGw6SSh0aGlzLnIpfTtnLkI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm07cmV0dXJuIG51bGwhPWE/YTp0aGlzLm09YT1jYyh0aGlzKX07Zy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGxjKHRoaXMsYil9O1xuZy5JPWZ1bmN0aW9uKCl7cmV0dXJuIE4oSCx0aGlzLmopfTtnLk49ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmMuYShiLHRoaXMpfTtnLk09ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBuYy5jKGIsYyx0aGlzKX07Zy5RPWZ1bmN0aW9uKCl7bGIodGhpcyk7cmV0dXJuIG51bGw9PXRoaXMucj9udWxsOkYodGhpcy5yKX07Zy5TPWZ1bmN0aW9uKCl7bGIodGhpcyk7cmV0dXJuIG51bGwhPXRoaXMucj9HKHRoaXMucik6SH07Zy5IPWZ1bmN0aW9uKCl7a2QodGhpcyk7aWYobnVsbD09dGhpcy5yKXJldHVybiBudWxsO2Zvcih2YXIgYT10aGlzLnI7OylpZihhIGluc3RhbmNlb2YgVilhPWtkKGEpO2Vsc2UgcmV0dXJuIHRoaXMucj1hLEUodGhpcy5yKX07Zy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBWKGIsdGhpcy5ZYSx0aGlzLnIsdGhpcy5tKX07Zy5HPWZ1bmN0aW9uKGEsYil7cmV0dXJuIE0oYix0aGlzKX07XG5mdW5jdGlvbiBsZChhLGIpe3RoaXMucWI9YTt0aGlzLmVuZD1iO3RoaXMucT0wO3RoaXMuaT0yfWxkLnByb3RvdHlwZS5MPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZW5kfTtsZC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGEpe3RoaXMucWJbdGhpcy5lbmRdPWE7cmV0dXJuIHRoaXMuZW5kKz0xfTtsZC5wcm90b3R5cGUuZGE9ZnVuY3Rpb24oKXt2YXIgYT1uZXcgbWQodGhpcy5xYiwwLHRoaXMuZW5kKTt0aGlzLnFiPW51bGw7cmV0dXJuIGF9O2Z1bmN0aW9uIG1kKGEsYixjKXt0aGlzLmU9YTt0aGlzLk89Yjt0aGlzLmVuZD1jO3RoaXMucT0wO3RoaXMuaT01MjQzMDZ9Zz1tZC5wcm90b3R5cGU7Zy5OPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGhjLm4odGhpcy5lLGIsdGhpcy5lW3RoaXMuT10sdGhpcy5PKzEpfTtnLk09ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBoYy5uKHRoaXMuZSxiLGMsdGhpcy5PKX07XG5nLktiPWZ1bmN0aW9uKCl7aWYodGhpcy5PPT09dGhpcy5lbmQpdGhyb3cgRXJyb3IoXCItZHJvcC1maXJzdCBvZiBlbXB0eSBjaHVua1wiKTtyZXR1cm4gbmV3IG1kKHRoaXMuZSx0aGlzLk8rMSx0aGlzLmVuZCl9O2cuSj1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmVbdGhpcy5PK2JdfTtnLmFhPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gMDw9YiYmYjx0aGlzLmVuZC10aGlzLk8/dGhpcy5lW3RoaXMuTytiXTpjfTtnLkw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lbmQtdGhpcy5PfTtcbnZhciBuZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMpe3JldHVybiBuZXcgbWQoYSxiLGMpfWZ1bmN0aW9uIGIoYSxiKXtyZXR1cm4gbmV3IG1kKGEsYixhLmxlbmd0aCl9ZnVuY3Rpb24gYyhhKXtyZXR1cm4gbmV3IG1kKGEsMCxhLmxlbmd0aCl9dmFyIGQ9bnVsbCxkPWZ1bmN0aW9uKGQsZixoKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBjLmNhbGwodGhpcyxkKTtjYXNlIDI6cmV0dXJuIGIuY2FsbCh0aGlzLGQsZik7Y2FzZSAzOnJldHVybiBhLmNhbGwodGhpcyxkLGYsaCl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2QuYj1jO2QuYT1iO2QuYz1hO3JldHVybiBkfSgpO2Z1bmN0aW9uIG9kKGEsYixjLGQpe3RoaXMuZGE9YTt0aGlzLm9hPWI7dGhpcy5qPWM7dGhpcy5tPWQ7dGhpcy5pPTMxODUwNzMyO3RoaXMucT0xNTM2fWc9b2QucHJvdG90eXBlO2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O1xuZy5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuan07Zy5VPWZ1bmN0aW9uKCl7aWYoMTxBYSh0aGlzLmRhKSlyZXR1cm4gbmV3IG9kKEdiKHRoaXMuZGEpLHRoaXMub2EsdGhpcy5qLG51bGwpO3ZhciBhPWxiKHRoaXMub2EpO3JldHVybiBudWxsPT1hP251bGw6YX07Zy5CPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tO3JldHVybiBudWxsIT1hP2E6dGhpcy5tPWE9Y2ModGhpcyl9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBsYyh0aGlzLGIpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gTihILHRoaXMuail9O2cuUT1mdW5jdGlvbigpe3JldHVybiBELmEodGhpcy5kYSwwKX07Zy5TPWZ1bmN0aW9uKCl7cmV0dXJuIDE8QWEodGhpcy5kYSk/bmV3IG9kKEdiKHRoaXMuZGEpLHRoaXMub2EsdGhpcy5qLG51bGwpOm51bGw9PXRoaXMub2E/SDp0aGlzLm9hfTtnLkg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc307Zy5zYj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmRhfTtcbmcudGI9ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbD09dGhpcy5vYT9IOnRoaXMub2F9O2cuRj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgb2QodGhpcy5kYSx0aGlzLm9hLGIsdGhpcy5tKX07Zy5HPWZ1bmN0aW9uKGEsYil7cmV0dXJuIE0oYix0aGlzKX07Zy5yYj1mdW5jdGlvbigpe3JldHVybiBudWxsPT10aGlzLm9hP251bGw6dGhpcy5vYX07ZnVuY3Rpb24gcGQoYSxiKXtyZXR1cm4gMD09PUFhKGEpP2I6bmV3IG9kKGEsYixudWxsLG51bGwpfWZ1bmN0aW9uIFJjKGEpe2Zvcih2YXIgYj1bXTs7KWlmKEUoYSkpYi5wdXNoKEYoYSkpLGE9SShhKTtlbHNlIHJldHVybiBifWZ1bmN0aW9uIHFkKGEsYil7aWYoaWMoYSkpcmV0dXJuIE8oYSk7Zm9yKHZhciBjPWEsZD1iLGU9MDs7KWlmKDA8ZCYmRShjKSljPUkoYyksZC09MSxlKz0xO2Vsc2UgcmV0dXJuIGV9XG52YXIgc2Q9ZnVuY3Rpb24gcmQoYil7cmV0dXJuIG51bGw9PWI/bnVsbDpudWxsPT1JKGIpP0UoRihiKSk6dT9NKEYoYikscmQoSShiKSkpOm51bGx9LHRkPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7dmFyIGM9RShhKTtyZXR1cm4gYz9JYyhjKT9wZChIYihjKSxkLmEoSWIoYyksYikpOk0oRihjKSxkLmEoRyhjKSxiKSk6Yn0sbnVsbCxudWxsKX1mdW5jdGlvbiBiKGEpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7cmV0dXJuIGF9LG51bGwsbnVsbCl9ZnVuY3Rpb24gYygpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7cmV0dXJuIG51bGx9LG51bGwsbnVsbCl9dmFyIGQ9bnVsbCxlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShjLGQsZSl7dmFyIGY9bnVsbDsyPGFyZ3VtZW50cy5sZW5ndGgmJihmPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYyxcbmQsZil9ZnVuY3Rpb24gYihhLGMsZSl7cmV0dXJuIGZ1bmN0aW9uIHQoYSxiKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbigpe3ZhciBjPUUoYSk7cmV0dXJuIGM/SWMoYyk/cGQoSGIoYyksdChJYihjKSxiKSk6TShGKGMpLHQoRyhjKSxiKSk6cihiKT90KEYoYiksSShiKSk6bnVsbH0sbnVsbCxudWxsKX0oZC5hKGEsYyksZSl9YS5rPTI7YS5mPWZ1bmN0aW9uKGEpe3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1HKGEpO3JldHVybiBiKGMsZCxhKX07YS5kPWI7cmV0dXJuIGF9KCksZD1mdW5jdGlvbihkLGgsayl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMDpyZXR1cm4gYy5jYWxsKHRoaXMpO2Nhc2UgMTpyZXR1cm4gYi5jYWxsKHRoaXMsZCk7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxkLGgpO2RlZmF1bHQ6cmV0dXJuIGUuZChkLGgsSihhcmd1bWVudHMsMikpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtkLms9XG4yO2QuZj1lLmY7ZC5vPWM7ZC5iPWI7ZC5hPWE7ZC5kPWUuZDtyZXR1cm4gZH0oKSx1ZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMsZCl7cmV0dXJuIE0oYSxNKGIsTShjLGQpKSl9ZnVuY3Rpb24gYihhLGIsYyl7cmV0dXJuIE0oYSxNKGIsYykpfXZhciBjPW51bGwsZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYyxkLGUsbixxKXt2YXIgdD1udWxsOzQ8YXJndW1lbnRzLmxlbmd0aCYmKHQ9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsNCksMCkpO3JldHVybiBiLmNhbGwodGhpcyxjLGQsZSxuLHQpfWZ1bmN0aW9uIGIoYSxjLGQsZSxmKXtyZXR1cm4gTShhLE0oYyxNKGQsTShlLHNkKGYpKSkpKX1hLms9NDthLmY9ZnVuY3Rpb24oYSl7dmFyIGM9RihhKTthPUkoYSk7dmFyIGQ9RihhKTthPUkoYSk7dmFyIGU9RihhKTthPUkoYSk7dmFyIHE9RihhKTthPUcoYSk7cmV0dXJuIGIoYyxkLGUscSxhKX07YS5kPWI7cmV0dXJuIGF9KCksYz1mdW5jdGlvbihjLGYsXG5oLGssbCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gRShjKTtjYXNlIDI6cmV0dXJuIE0oYyxmKTtjYXNlIDM6cmV0dXJuIGIuY2FsbCh0aGlzLGMsZixoKTtjYXNlIDQ6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZixoLGspO2RlZmF1bHQ6cmV0dXJuIGQuZChjLGYsaCxrLEooYXJndW1lbnRzLDQpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5rPTQ7Yy5mPWQuZjtjLmI9ZnVuY3Rpb24oYSl7cmV0dXJuIEUoYSl9O2MuYT1mdW5jdGlvbihhLGIpe3JldHVybiBNKGEsYil9O2MuYz1iO2Mubj1hO2MuZD1kLmQ7cmV0dXJuIGN9KCk7ZnVuY3Rpb24gdmQoYSl7cmV0dXJuIEFiKGEpfVxudmFyIHdkPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbCxiPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShjLGYsaCl7dmFyIGs9bnVsbDsyPGFyZ3VtZW50cy5sZW5ndGgmJihrPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYyxmLGspfWZ1bmN0aW9uIGIoYSxjLGQpe2Zvcig7OylpZihhPXpiKGEsYykscihkKSljPUYoZCksZD1JKGQpO2Vsc2UgcmV0dXJuIGF9YS5rPTI7YS5mPWZ1bmN0aW9uKGEpe3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBoPUYoYSk7YT1HKGEpO3JldHVybiBiKGMsaCxhKX07YS5kPWI7cmV0dXJuIGF9KCksYT1mdW5jdGlvbihhLGQsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gemIoYSxkKTtkZWZhdWx0OnJldHVybiBiLmQoYSxkLEooYXJndW1lbnRzLDIpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307YS5rPTI7YS5mPWIuZjthLmE9XG5mdW5jdGlvbihhLGIpe3JldHVybiB6YihhLGIpfTthLmQ9Yi5kO3JldHVybiBhfSgpLHhkPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbCxiPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShjLGYsaCxrKXt2YXIgbD1udWxsOzM8YXJndW1lbnRzLmxlbmd0aCYmKGw9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMyksMCkpO3JldHVybiBiLmNhbGwodGhpcyxjLGYsaCxsKX1mdW5jdGlvbiBiKGEsYyxkLGspe2Zvcig7OylpZihhPUJiKGEsYyxkKSxyKGspKWM9RihrKSxkPUYoSShrKSksaz1JKEkoaykpO2Vsc2UgcmV0dXJuIGF9YS5rPTM7YS5mPWZ1bmN0aW9uKGEpe3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBoPUYoYSk7YT1JKGEpO3ZhciBrPUYoYSk7YT1HKGEpO3JldHVybiBiKGMsaCxrLGEpfTthLmQ9YjtyZXR1cm4gYX0oKSxhPWZ1bmN0aW9uKGEsZCxlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDM6cmV0dXJuIEJiKGEsZCxlKTtkZWZhdWx0OnJldHVybiBiLmQoYSxcbmQsZSxKKGFyZ3VtZW50cywzKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Euaz0zO2EuZj1iLmY7YS5jPWZ1bmN0aW9uKGEsYixlKXtyZXR1cm4gQmIoYSxiLGUpfTthLmQ9Yi5kO3JldHVybiBhfSgpLHlkPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbCxiPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShjLGYsaCl7dmFyIGs9bnVsbDsyPGFyZ3VtZW50cy5sZW5ndGgmJihrPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYyxmLGspfWZ1bmN0aW9uIGIoYSxjLGQpe2Zvcig7OylpZihhPUNiKGEsYykscihkKSljPUYoZCksZD1JKGQpO2Vsc2UgcmV0dXJuIGF9YS5rPTI7YS5mPWZ1bmN0aW9uKGEpe3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBoPUYoYSk7YT1HKGEpO3JldHVybiBiKGMsaCxhKX07YS5kPWI7cmV0dXJuIGF9KCksYT1mdW5jdGlvbihhLGQsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gQ2IoYSxcbmQpO2RlZmF1bHQ6cmV0dXJuIGIuZChhLGQsSihhcmd1bWVudHMsMikpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTthLms9MjthLmY9Yi5mO2EuYT1mdW5jdGlvbihhLGIpe3JldHVybiBDYihhLGIpfTthLmQ9Yi5kO3JldHVybiBhfSgpLHpkPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbCxiPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShjLGYsaCl7dmFyIGs9bnVsbDsyPGFyZ3VtZW50cy5sZW5ndGgmJihrPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYyxmLGspfWZ1bmN0aW9uIGIoYSxjLGQpe2Zvcig7OylpZihhPUZiKGEsYykscihkKSljPUYoZCksZD1JKGQpO2Vsc2UgcmV0dXJuIGF9YS5rPTI7YS5mPWZ1bmN0aW9uKGEpe3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBoPUYoYSk7YT1HKGEpO3JldHVybiBiKGMsaCxhKX07YS5kPWI7cmV0dXJuIGF9KCksYT1mdW5jdGlvbihhLGQsXG5lKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBGYihhLGQpO2RlZmF1bHQ6cmV0dXJuIGIuZChhLGQsSihhcmd1bWVudHMsMikpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTthLms9MjthLmY9Yi5mO2EuYT1mdW5jdGlvbihhLGIpe3JldHVybiBGYihhLGIpfTthLmQ9Yi5kO3JldHVybiBhfSgpO1xuZnVuY3Rpb24gQWQoYSxiLGMpe3ZhciBkPUUoYyk7aWYoMD09PWIpcmV0dXJuIGEubz9hLm8oKTphLmNhbGwobnVsbCk7Yz1IYShkKTt2YXIgZT1JYShkKTtpZigxPT09YilyZXR1cm4gYS5iP2EuYihjKTphLmI/YS5iKGMpOmEuY2FsbChudWxsLGMpO3ZhciBkPUhhKGUpLGY9SWEoZSk7aWYoMj09PWIpcmV0dXJuIGEuYT9hLmEoYyxkKTphLmE/YS5hKGMsZCk6YS5jYWxsKG51bGwsYyxkKTt2YXIgZT1IYShmKSxoPUlhKGYpO2lmKDM9PT1iKXJldHVybiBhLmM/YS5jKGMsZCxlKTphLmM/YS5jKGMsZCxlKTphLmNhbGwobnVsbCxjLGQsZSk7dmFyIGY9SGEoaCksaz1JYShoKTtpZig0PT09YilyZXR1cm4gYS5uP2EubihjLGQsZSxmKTphLm4/YS5uKGMsZCxlLGYpOmEuY2FsbChudWxsLGMsZCxlLGYpO3ZhciBoPUhhKGspLGw9SWEoayk7aWYoNT09PWIpcmV0dXJuIGEucz9hLnMoYyxkLGUsZixoKTphLnM/YS5zKGMsZCxlLGYsaCk6YS5jYWxsKG51bGwsYyxkLGUsZixoKTt2YXIgaz1IYShsKSxcbm49SWEobCk7aWYoNj09PWIpcmV0dXJuIGEuWD9hLlgoYyxkLGUsZixoLGspOmEuWD9hLlgoYyxkLGUsZixoLGspOmEuY2FsbChudWxsLGMsZCxlLGYsaCxrKTt2YXIgbD1IYShuKSxxPUlhKG4pO2lmKDc9PT1iKXJldHVybiBhLmdhP2EuZ2EoYyxkLGUsZixoLGssbCk6YS5nYT9hLmdhKGMsZCxlLGYsaCxrLGwpOmEuY2FsbChudWxsLGMsZCxlLGYsaCxrLGwpO3ZhciBuPUhhKHEpLHQ9SWEocSk7aWYoOD09PWIpcmV0dXJuIGEuR2E/YS5HYShjLGQsZSxmLGgsayxsLG4pOmEuR2E/YS5HYShjLGQsZSxmLGgsayxsLG4pOmEuY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbik7dmFyIHE9SGEodCksdj1JYSh0KTtpZig5PT09YilyZXR1cm4gYS5IYT9hLkhhKGMsZCxlLGYsaCxrLGwsbixxKTphLkhhP2EuSGEoYyxkLGUsZixoLGssbCxuLHEpOmEuY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxKTt2YXIgdD1IYSh2KSx3PUlhKHYpO2lmKDEwPT09YilyZXR1cm4gYS52YT9hLnZhKGMsZCxlLFxuZixoLGssbCxuLHEsdCk6YS52YT9hLnZhKGMsZCxlLGYsaCxrLGwsbixxLHQpOmEuY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxLHQpO3ZhciB2PUhhKHcpLHk9SWEodyk7aWYoMTE9PT1iKXJldHVybiBhLndhP2Eud2EoYyxkLGUsZixoLGssbCxuLHEsdCx2KTphLndhP2Eud2EoYyxkLGUsZixoLGssbCxuLHEsdCx2KTphLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4scSx0LHYpO3ZhciB3PUhhKHkpLEI9SWEoeSk7aWYoMTI9PT1iKXJldHVybiBhLnhhP2EueGEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcpOmEueGE/YS54YShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyk6YS5jYWxsKG51bGwsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcpO3ZhciB5PUhhKEIpLEw9SWEoQik7aWYoMTM9PT1iKXJldHVybiBhLnlhP2EueWEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSk6YS55YT9hLnlhKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHkpOmEuY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxLFxudCx2LHcseSk7dmFyIEI9SGEoTCksVT1JYShMKTtpZigxND09PWIpcmV0dXJuIGEuemE/YS56YShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIpOmEuemE/YS56YShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIpOmEuY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQik7dmFyIEw9SGEoVSksWj1JYShVKTtpZigxNT09PWIpcmV0dXJuIGEuQWE/YS5BYShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCk6YS5BYT9hLkFhKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMKTphLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCk7dmFyIFU9SGEoWiksbmE9SWEoWik7aWYoMTY9PT1iKXJldHVybiBhLkJhP2EuQmEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSk6YS5CYT9hLkJhKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUpOmEuY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUpO3ZhciBaPVxuSGEobmEpLEdhPUlhKG5hKTtpZigxNz09PWIpcmV0dXJuIGEuQ2E/YS5DYShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFopOmEuQ2E/YS5DYShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFopOmEuY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWik7dmFyIG5hPUhhKEdhKSxSYT1JYShHYSk7aWYoMTg9PT1iKXJldHVybiBhLkRhP2EuRGEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaLG5hKTphLkRhP2EuRGEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaLG5hKTphLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFosbmEpO0dhPUhhKFJhKTtSYT1JYShSYSk7aWYoMTk9PT1iKXJldHVybiBhLkVhP2EuRWEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaLG5hLEdhKTphLkVhP2EuRWEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaLG5hLEdhKTphLmNhbGwobnVsbCxcbmMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWixuYSxHYSk7dmFyIHdjPUhhKFJhKTtJYShSYSk7aWYoMjA9PT1iKXJldHVybiBhLkZhP2EuRmEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaLG5hLEdhLHdjKTphLkZhP2EuRmEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaLG5hLEdhLHdjKTphLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFosbmEsR2Esd2MpO3Rocm93IEVycm9yKFwiT25seSB1cCB0byAyMCBhcmd1bWVudHMgc3VwcG9ydGVkIG9uIGZ1bmN0aW9uc1wiKTt9XG52YXIgUz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMsZCxlKXtiPXVkLm4oYixjLGQsZSk7Yz1hLms7cmV0dXJuIGEuZj8oZD1xZChiLGMrMSksZDw9Yz9BZChhLGQsYik6YS5mKGIpKTphLmFwcGx5KGEsUmMoYikpfWZ1bmN0aW9uIGIoYSxiLGMsZCl7Yj11ZC5jKGIsYyxkKTtjPWEuaztyZXR1cm4gYS5mPyhkPXFkKGIsYysxKSxkPD1jP0FkKGEsZCxiKTphLmYoYikpOmEuYXBwbHkoYSxSYyhiKSl9ZnVuY3Rpb24gYyhhLGIsYyl7Yj11ZC5hKGIsYyk7Yz1hLms7aWYoYS5mKXt2YXIgZD1xZChiLGMrMSk7cmV0dXJuIGQ8PWM/QWQoYSxkLGIpOmEuZihiKX1yZXR1cm4gYS5hcHBseShhLFJjKGIpKX1mdW5jdGlvbiBkKGEsYil7dmFyIGM9YS5rO2lmKGEuZil7dmFyIGQ9cWQoYixjKzEpO3JldHVybiBkPD1jP0FkKGEsZCxiKTphLmYoYil9cmV0dXJuIGEuYXBwbHkoYSxSYyhiKSl9dmFyIGU9bnVsbCxmPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShjLGQsZSxmLGgsdyl7dmFyIHk9bnVsbDtcbjU8YXJndW1lbnRzLmxlbmd0aCYmKHk9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsNSksMCkpO3JldHVybiBiLmNhbGwodGhpcyxjLGQsZSxmLGgseSl9ZnVuY3Rpb24gYihhLGMsZCxlLGYsaCl7Yz1NKGMsTShkLE0oZSxNKGYsc2QoaCkpKSkpO2Q9YS5rO3JldHVybiBhLmY/KGU9cWQoYyxkKzEpLGU8PWQ/QWQoYSxlLGMpOmEuZihjKSk6YS5hcHBseShhLFJjKGMpKX1hLms9NTthLmY9ZnVuY3Rpb24oYSl7dmFyIGM9RihhKTthPUkoYSk7dmFyIGQ9RihhKTthPUkoYSk7dmFyIGU9RihhKTthPUkoYSk7dmFyIGY9RihhKTthPUkoYSk7dmFyIGg9RihhKTthPUcoYSk7cmV0dXJuIGIoYyxkLGUsZixoLGEpfTthLmQ9YjtyZXR1cm4gYX0oKSxlPWZ1bmN0aW9uKGUsayxsLG4scSx0KXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBkLmNhbGwodGhpcyxlLGspO2Nhc2UgMzpyZXR1cm4gYy5jYWxsKHRoaXMsZSxrLGwpO2Nhc2UgNDpyZXR1cm4gYi5jYWxsKHRoaXMsXG5lLGssbCxuKTtjYXNlIDU6cmV0dXJuIGEuY2FsbCh0aGlzLGUsayxsLG4scSk7ZGVmYXVsdDpyZXR1cm4gZi5kKGUsayxsLG4scSxKKGFyZ3VtZW50cyw1KSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Uuaz01O2UuZj1mLmY7ZS5hPWQ7ZS5jPWM7ZS5uPWI7ZS5zPWE7ZS5kPWYuZDtyZXR1cm4gZX0oKSxCZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4hV2IuYShhLGIpfXZhciBiPW51bGwsYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYyxkLGspe3ZhciBsPW51bGw7Mjxhcmd1bWVudHMubGVuZ3RoJiYobD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGMsZCxsKX1mdW5jdGlvbiBiKGEsYyxkKXtyZXR1cm4gc2EoUy5uKFdiLGEsYyxkKSl9YS5rPTI7YS5mPWZ1bmN0aW9uKGEpe3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1HKGEpO3JldHVybiBiKGMsXG5kLGEpfTthLmQ9YjtyZXR1cm4gYX0oKSxiPWZ1bmN0aW9uKGIsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiExO2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsYixlKTtkZWZhdWx0OnJldHVybiBjLmQoYixlLEooYXJndW1lbnRzLDIpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yi5rPTI7Yi5mPWMuZjtiLmI9ZnVuY3Rpb24oKXtyZXR1cm4hMX07Yi5hPWE7Yi5kPWMuZDtyZXR1cm4gYn0oKTtmdW5jdGlvbiBDZChhKXtyZXR1cm4gRShhKT9hOm51bGx9ZnVuY3Rpb24gRGQoYSxiKXtmb3IoOzspe2lmKG51bGw9PUUoYikpcmV0dXJuITA7aWYocihhLmI/YS5iKEYoYikpOmEuY2FsbChudWxsLEYoYikpKSl7dmFyIGM9YSxkPUkoYik7YT1jO2I9ZH1lbHNlIHJldHVybiB1PyExOm51bGx9fVxuZnVuY3Rpb24gRWQoYSxiKXtmb3IoOzspaWYoRShiKSl7dmFyIGM9YS5iP2EuYihGKGIpKTphLmNhbGwobnVsbCxGKGIpKTtpZihyKGMpKXJldHVybiBjO3ZhciBjPWEsZD1JKGIpO2E9YztiPWR9ZWxzZSByZXR1cm4gbnVsbH1mdW5jdGlvbiBGZChhKXtyZXR1cm4gYX1cbmZ1bmN0aW9uIEdkKGEpe3JldHVybiBmdW5jdGlvbigpe3ZhciBiPW51bGwsYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGIoYSxkLGspe3ZhciBsPW51bGw7Mjxhcmd1bWVudHMubGVuZ3RoJiYobD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKSwwKSk7cmV0dXJuIGMuY2FsbCh0aGlzLGEsZCxsKX1mdW5jdGlvbiBjKGIsZCxlKXtyZXR1cm4gc2EoUy5uKGEsYixkLGUpKX1iLms9MjtiLmY9ZnVuY3Rpb24oYSl7dmFyIGI9RihhKTthPUkoYSk7dmFyIGQ9RihhKTthPUcoYSk7cmV0dXJuIGMoYixkLGEpfTtiLmQ9YztyZXR1cm4gYn0oKSxiPWZ1bmN0aW9uKGIsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAwOnJldHVybiBzYShhLm8/YS5vKCk6YS5jYWxsKG51bGwpKTtjYXNlIDE6dmFyIGg9YjtyZXR1cm4gc2EoYS5iP2EuYihoKTphLmNhbGwobnVsbCxoKSk7Y2FzZSAyOnZhciBoPWIsaz1lO3JldHVybiBzYShhLmE/YS5hKGgsayk6YS5jYWxsKG51bGwsXG5oLGspKTtkZWZhdWx0OnJldHVybiBjLmQoYixlLEooYXJndW1lbnRzLDIpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yi5rPTI7Yi5mPWMuZjtyZXR1cm4gYn0oKX1cbnZhciBIZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMpe3JldHVybiBmdW5jdGlvbigpe3ZhciBkPW51bGwsbD1mdW5jdGlvbigpe2Z1bmN0aW9uIGQoYSxiLGMsZSl7dmFyIGY9bnVsbDszPGFyZ3VtZW50cy5sZW5ndGgmJihmPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDMpLDApKTtyZXR1cm4gay5jYWxsKHRoaXMsYSxiLGMsZil9ZnVuY3Rpb24gayhkLGwsbixxKXtyZXR1cm4gYS5iP2EuYihiLmI/Yi5iKFMucyhjLGQsbCxuLHEpKTpiLmNhbGwobnVsbCxTLnMoYyxkLGwsbixxKSkpOmEuY2FsbChudWxsLGIuYj9iLmIoUy5zKGMsZCxsLG4scSkpOmIuY2FsbChudWxsLFMucyhjLGQsbCxuLHEpKSl9ZC5rPTM7ZC5mPWZ1bmN0aW9uKGEpe3ZhciBiPUYoYSk7YT1JKGEpO3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1HKGEpO3JldHVybiBrKGIsYyxkLGEpfTtkLmQ9aztyZXR1cm4gZH0oKSxkPWZ1bmN0aW9uKGQsayx0LHYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDA6cmV0dXJuIGEuYj9cbmEuYihiLmI/Yi5iKGMubz9jLm8oKTpjLmNhbGwobnVsbCkpOmIuY2FsbChudWxsLGMubz9jLm8oKTpjLmNhbGwobnVsbCkpKTphLmNhbGwobnVsbCxiLmI/Yi5iKGMubz9jLm8oKTpjLmNhbGwobnVsbCkpOmIuY2FsbChudWxsLGMubz9jLm8oKTpjLmNhbGwobnVsbCkpKTtjYXNlIDE6dmFyIHc9ZDtyZXR1cm4gYS5iP2EuYihiLmI/Yi5iKGMuYj9jLmIodyk6Yy5jYWxsKG51bGwsdykpOmIuY2FsbChudWxsLGMuYj9jLmIodyk6Yy5jYWxsKG51bGwsdykpKTphLmNhbGwobnVsbCxiLmI/Yi5iKGMuYj9jLmIodyk6Yy5jYWxsKG51bGwsdykpOmIuY2FsbChudWxsLGMuYj9jLmIodyk6Yy5jYWxsKG51bGwsdykpKTtjYXNlIDI6dmFyIHc9ZCx5PWs7cmV0dXJuIGEuYj9hLmIoYi5iP2IuYihjLmE/Yy5hKHcseSk6Yy5jYWxsKG51bGwsdyx5KSk6Yi5jYWxsKG51bGwsYy5hP2MuYSh3LHkpOmMuY2FsbChudWxsLHcseSkpKTphLmNhbGwobnVsbCxiLmI/Yi5iKGMuYT9jLmEodyx5KTpjLmNhbGwobnVsbCxcbncseSkpOmIuY2FsbChudWxsLGMuYT9jLmEodyx5KTpjLmNhbGwobnVsbCx3LHkpKSk7Y2FzZSAzOnZhciB3PWQseT1rLEI9dDtyZXR1cm4gYS5iP2EuYihiLmI/Yi5iKGMuYz9jLmModyx5LEIpOmMuY2FsbChudWxsLHcseSxCKSk6Yi5jYWxsKG51bGwsYy5jP2MuYyh3LHksQik6Yy5jYWxsKG51bGwsdyx5LEIpKSk6YS5jYWxsKG51bGwsYi5iP2IuYihjLmM/Yy5jKHcseSxCKTpjLmNhbGwobnVsbCx3LHksQikpOmIuY2FsbChudWxsLGMuYz9jLmModyx5LEIpOmMuY2FsbChudWxsLHcseSxCKSkpO2RlZmF1bHQ6cmV0dXJuIGwuZChkLGssdCxKKGFyZ3VtZW50cywzKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Quaz0zO2QuZj1sLmY7cmV0dXJuIGR9KCl9ZnVuY3Rpb24gYihhLGIpe3JldHVybiBmdW5jdGlvbigpe3ZhciBjPW51bGwsZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGMoYSxiLGUsZil7dmFyIGg9bnVsbDszPGFyZ3VtZW50cy5sZW5ndGgmJlxuKGg9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMyksMCkpO3JldHVybiBkLmNhbGwodGhpcyxhLGIsZSxoKX1mdW5jdGlvbiBkKGMsaCxrLGwpe3JldHVybiBhLmI/YS5iKFMucyhiLGMsaCxrLGwpKTphLmNhbGwobnVsbCxTLnMoYixjLGgsayxsKSl9Yy5rPTM7Yy5mPWZ1bmN0aW9uKGEpe3ZhciBiPUYoYSk7YT1JKGEpO3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBlPUYoYSk7YT1HKGEpO3JldHVybiBkKGIsYyxlLGEpfTtjLmQ9ZDtyZXR1cm4gY30oKSxjPWZ1bmN0aW9uKGMsaCxxLHQpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDA6cmV0dXJuIGEuYj9hLmIoYi5vP2IubygpOmIuY2FsbChudWxsKSk6YS5jYWxsKG51bGwsYi5vP2IubygpOmIuY2FsbChudWxsKSk7Y2FzZSAxOnZhciB2PWM7cmV0dXJuIGEuYj9hLmIoYi5iP2IuYih2KTpiLmNhbGwobnVsbCx2KSk6YS5jYWxsKG51bGwsYi5iP2IuYih2KTpiLmNhbGwobnVsbCx2KSk7Y2FzZSAyOnZhciB2PVxuYyx3PWg7cmV0dXJuIGEuYj9hLmIoYi5hP2IuYSh2LHcpOmIuY2FsbChudWxsLHYsdykpOmEuY2FsbChudWxsLGIuYT9iLmEodix3KTpiLmNhbGwobnVsbCx2LHcpKTtjYXNlIDM6dmFyIHY9Yyx3PWgseT1xO3JldHVybiBhLmI/YS5iKGIuYz9iLmModix3LHkpOmIuY2FsbChudWxsLHYsdyx5KSk6YS5jYWxsKG51bGwsYi5jP2IuYyh2LHcseSk6Yi5jYWxsKG51bGwsdix3LHkpKTtkZWZhdWx0OnJldHVybiBkLmQoYyxoLHEsSihhcmd1bWVudHMsMykpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLms9MztjLmY9ZC5mO3JldHVybiBjfSgpfXZhciBjPW51bGwsZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYyxkLGUsbil7dmFyIHE9bnVsbDszPGFyZ3VtZW50cy5sZW5ndGgmJihxPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDMpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYyxkLGUscSl9ZnVuY3Rpb24gYihhLGMsZCxcbmUpe3JldHVybiBmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oKXtmdW5jdGlvbiBiKGEpe3ZhciBkPW51bGw7MDxhcmd1bWVudHMubGVuZ3RoJiYoZD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywwKSwwKSk7cmV0dXJuIGMuY2FsbCh0aGlzLGQpfWZ1bmN0aW9uIGMoYil7Yj1TLmEoRihhKSxiKTtmb3IodmFyIGQ9SShhKTs7KWlmKGQpYj1GKGQpLmNhbGwobnVsbCxiKSxkPUkoZCk7ZWxzZSByZXR1cm4gYn1iLms9MDtiLmY9ZnVuY3Rpb24oYSl7YT1FKGEpO3JldHVybiBjKGEpfTtiLmQ9YztyZXR1cm4gYn0oKX0oZWQodWQubihhLGMsZCxlKSkpfWEuaz0zO2EuZj1mdW5jdGlvbihhKXt2YXIgYz1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9SShhKTt2YXIgZT1GKGEpO2E9RyhhKTtyZXR1cm4gYihjLGQsZSxhKX07YS5kPWI7cmV0dXJuIGF9KCksYz1mdW5jdGlvbihjLGYsaCxrKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAwOnJldHVybiBGZDtcbmNhc2UgMTpyZXR1cm4gYztjYXNlIDI6cmV0dXJuIGIuY2FsbCh0aGlzLGMsZik7Y2FzZSAzOnJldHVybiBhLmNhbGwodGhpcyxjLGYsaCk7ZGVmYXVsdDpyZXR1cm4gZC5kKGMsZixoLEooYXJndW1lbnRzLDMpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5rPTM7Yy5mPWQuZjtjLm89ZnVuY3Rpb24oKXtyZXR1cm4gRmR9O2MuYj1mdW5jdGlvbihhKXtyZXR1cm4gYX07Yy5hPWI7Yy5jPWE7Yy5kPWQuZDtyZXR1cm4gY30oKSxJZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMsZCl7cmV0dXJuIGZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShhKXt2YXIgYj1udWxsOzA8YXJndW1lbnRzLmxlbmd0aCYmKGI9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCksMCkpO3JldHVybiBxLmNhbGwodGhpcyxiKX1mdW5jdGlvbiBxKGUpe3JldHVybiBTLnMoYSxiLGMsZCxlKX1lLms9MDtlLmY9ZnVuY3Rpb24oYSl7YT1FKGEpO1xucmV0dXJuIHEoYSl9O2UuZD1xO3JldHVybiBlfSgpfWZ1bmN0aW9uIGIoYSxiLGMpe3JldHVybiBmdW5jdGlvbigpe2Z1bmN0aW9uIGQoYSl7dmFyIGI9bnVsbDswPGFyZ3VtZW50cy5sZW5ndGgmJihiPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApLDApKTtyZXR1cm4gZS5jYWxsKHRoaXMsYil9ZnVuY3Rpb24gZShkKXtyZXR1cm4gUy5uKGEsYixjLGQpfWQuaz0wO2QuZj1mdW5jdGlvbihhKXthPUUoYSk7cmV0dXJuIGUoYSl9O2QuZD1lO3JldHVybiBkfSgpfWZ1bmN0aW9uIGMoYSxiKXtyZXR1cm4gZnVuY3Rpb24oKXtmdW5jdGlvbiBjKGEpe3ZhciBiPW51bGw7MDxhcmd1bWVudHMubGVuZ3RoJiYoYj1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywwKSwwKSk7cmV0dXJuIGQuY2FsbCh0aGlzLGIpfWZ1bmN0aW9uIGQoYyl7cmV0dXJuIFMuYyhhLGIsYyl9Yy5rPTA7Yy5mPWZ1bmN0aW9uKGEpe2E9RShhKTtyZXR1cm4gZChhKX07XG5jLmQ9ZDtyZXR1cm4gY30oKX12YXIgZD1udWxsLGU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGMsZCxlLGYsdCl7dmFyIHY9bnVsbDs0PGFyZ3VtZW50cy5sZW5ndGgmJih2PUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDQpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYyxkLGUsZix2KX1mdW5jdGlvbiBiKGEsYyxkLGUsZil7cmV0dXJuIGZ1bmN0aW9uKCl7ZnVuY3Rpb24gYihhKXt2YXIgYz1udWxsOzA8YXJndW1lbnRzLmxlbmd0aCYmKGM9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCksMCkpO3JldHVybiBoLmNhbGwodGhpcyxjKX1mdW5jdGlvbiBoKGIpe3JldHVybiBTLnMoYSxjLGQsZSx0ZC5hKGYsYikpfWIuaz0wO2IuZj1mdW5jdGlvbihhKXthPUUoYSk7cmV0dXJuIGgoYSl9O2IuZD1oO3JldHVybiBifSgpfWEuaz00O2EuZj1mdW5jdGlvbihhKXt2YXIgYz1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9SShhKTt2YXIgZT1GKGEpO1xuYT1JKGEpO3ZhciBmPUYoYSk7YT1HKGEpO3JldHVybiBiKGMsZCxlLGYsYSl9O2EuZD1iO3JldHVybiBhfSgpLGQ9ZnVuY3Rpb24oZCxoLGssbCxuKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBkO2Nhc2UgMjpyZXR1cm4gYy5jYWxsKHRoaXMsZCxoKTtjYXNlIDM6cmV0dXJuIGIuY2FsbCh0aGlzLGQsaCxrKTtjYXNlIDQ6cmV0dXJuIGEuY2FsbCh0aGlzLGQsaCxrLGwpO2RlZmF1bHQ6cmV0dXJuIGUuZChkLGgsayxsLEooYXJndW1lbnRzLDQpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307ZC5rPTQ7ZC5mPWUuZjtkLmI9ZnVuY3Rpb24oYSl7cmV0dXJuIGF9O2QuYT1jO2QuYz1iO2Qubj1hO2QuZD1lLmQ7cmV0dXJuIGR9KCksSmQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjLGQpe3JldHVybiBmdW5jdGlvbigpe3ZhciBsPW51bGwsbj1mdW5jdGlvbigpe2Z1bmN0aW9uIGwoYSxiLGMsZCl7dmFyIGU9bnVsbDtcbjM8YXJndW1lbnRzLmxlbmd0aCYmKGU9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMyksMCkpO3JldHVybiBuLmNhbGwodGhpcyxhLGIsYyxlKX1mdW5jdGlvbiBuKGwscSx0LEIpe3JldHVybiBTLnMoYSxudWxsPT1sP2I6bCxudWxsPT1xP2M6cSxudWxsPT10P2Q6dCxCKX1sLms9MztsLmY9ZnVuY3Rpb24oYSl7dmFyIGI9RihhKTthPUkoYSk7dmFyIGM9RihhKTthPUkoYSk7dmFyIGQ9RihhKTthPUcoYSk7cmV0dXJuIG4oYixjLGQsYSl9O2wuZD1uO3JldHVybiBsfSgpLGw9ZnVuY3Rpb24obCx0LHYsdyl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjp2YXIgeT1sLEI9dDtyZXR1cm4gYS5hP2EuYShudWxsPT15P2I6eSxudWxsPT1CP2M6Qik6YS5jYWxsKG51bGwsbnVsbD09eT9iOnksbnVsbD09Qj9jOkIpO2Nhc2UgMzp2YXIgeT1sLEI9dCxMPXY7cmV0dXJuIGEuYz9hLmMobnVsbD09eT9iOnksbnVsbD09Qj9jOkIsbnVsbD09TD9kOkwpOmEuY2FsbChudWxsLFxubnVsbD09eT9iOnksbnVsbD09Qj9jOkIsbnVsbD09TD9kOkwpO2RlZmF1bHQ6cmV0dXJuIG4uZChsLHQsdixKKGFyZ3VtZW50cywzKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2wuaz0zO2wuZj1uLmY7cmV0dXJuIGx9KCl9ZnVuY3Rpb24gYihhLGIsYyl7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGQ9bnVsbCxsPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZChhLGIsYyxlKXt2YXIgZj1udWxsOzM8YXJndW1lbnRzLmxlbmd0aCYmKGY9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMyksMCkpO3JldHVybiBrLmNhbGwodGhpcyxhLGIsYyxmKX1mdW5jdGlvbiBrKGQsbCxuLHEpe3JldHVybiBTLnMoYSxudWxsPT1kP2I6ZCxudWxsPT1sP2M6bCxuLHEpfWQuaz0zO2QuZj1mdW5jdGlvbihhKXt2YXIgYj1GKGEpO2E9SShhKTt2YXIgYz1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9RyhhKTtyZXR1cm4gayhiLGMsZCxhKX07ZC5kPVxuaztyZXR1cm4gZH0oKSxkPWZ1bmN0aW9uKGQsayx0LHYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6dmFyIHc9ZCx5PWs7cmV0dXJuIGEuYT9hLmEobnVsbD09dz9iOncsbnVsbD09eT9jOnkpOmEuY2FsbChudWxsLG51bGw9PXc/Yjp3LG51bGw9PXk/Yzp5KTtjYXNlIDM6dmFyIHc9ZCx5PWssQj10O3JldHVybiBhLmM/YS5jKG51bGw9PXc/Yjp3LG51bGw9PXk/Yzp5LEIpOmEuY2FsbChudWxsLG51bGw9PXc/Yjp3LG51bGw9PXk/Yzp5LEIpO2RlZmF1bHQ6cmV0dXJuIGwuZChkLGssdCxKKGFyZ3VtZW50cywzKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Quaz0zO2QuZj1sLmY7cmV0dXJuIGR9KCl9ZnVuY3Rpb24gYyhhLGIpe3JldHVybiBmdW5jdGlvbigpe3ZhciBjPW51bGwsZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGMoYSxiLGUsZil7dmFyIGg9bnVsbDszPGFyZ3VtZW50cy5sZW5ndGgmJihoPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLFxuMyksMCkpO3JldHVybiBkLmNhbGwodGhpcyxhLGIsZSxoKX1mdW5jdGlvbiBkKGMsaCxrLGwpe3JldHVybiBTLnMoYSxudWxsPT1jP2I6YyxoLGssbCl9Yy5rPTM7Yy5mPWZ1bmN0aW9uKGEpe3ZhciBiPUYoYSk7YT1JKGEpO3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBlPUYoYSk7YT1HKGEpO3JldHVybiBkKGIsYyxlLGEpfTtjLmQ9ZDtyZXR1cm4gY30oKSxjPWZ1bmN0aW9uKGMsaCxxLHQpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6dmFyIHY9YztyZXR1cm4gYS5iP2EuYihudWxsPT12P2I6dik6YS5jYWxsKG51bGwsbnVsbD09dj9iOnYpO2Nhc2UgMjp2YXIgdj1jLHc9aDtyZXR1cm4gYS5hP2EuYShudWxsPT12P2I6dix3KTphLmNhbGwobnVsbCxudWxsPT12P2I6dix3KTtjYXNlIDM6dmFyIHY9Yyx3PWgseT1xO3JldHVybiBhLmM/YS5jKG51bGw9PXY/Yjp2LHcseSk6YS5jYWxsKG51bGwsbnVsbD09dj9iOnYsdyx5KTtkZWZhdWx0OnJldHVybiBkLmQoYyxoLHEsSihhcmd1bWVudHMsXG4zKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Muaz0zO2MuZj1kLmY7cmV0dXJuIGN9KCl9dmFyIGQ9bnVsbCxkPWZ1bmN0aW9uKGQsZixoLGspe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGMuY2FsbCh0aGlzLGQsZik7Y2FzZSAzOnJldHVybiBiLmNhbGwodGhpcyxkLGYsaCk7Y2FzZSA0OnJldHVybiBhLmNhbGwodGhpcyxkLGYsaCxrKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307ZC5hPWM7ZC5jPWI7ZC5uPWE7cmV0dXJuIGR9KCksS2Q9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjLGUpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7dmFyIG49RShiKSxxPUUoYyksdD1FKGUpO3JldHVybiBuJiZxJiZ0P00oYS5jP2EuYyhGKG4pLEYocSksRih0KSk6YS5jYWxsKG51bGwsRihuKSxGKHEpLEYodCkpLGQubihhLEcobiksRyhxKSxHKHQpKSk6bnVsbH0sXG5udWxsLG51bGwpfWZ1bmN0aW9uIGIoYSxiLGMpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7dmFyIGU9RShiKSxuPUUoYyk7cmV0dXJuIGUmJm4/TShhLmE/YS5hKEYoZSksRihuKSk6YS5jYWxsKG51bGwsRihlKSxGKG4pKSxkLmMoYSxHKGUpLEcobikpKTpudWxsfSxudWxsLG51bGwpfWZ1bmN0aW9uIGMoYSxiKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbigpe3ZhciBjPUUoYik7aWYoYyl7aWYoSWMoYykpe2Zvcih2YXIgZT1IYihjKSxuPU8oZSkscT1uZXcgbGQoQXJyYXkobiksMCksdD0wOzspaWYodDxuKXt2YXIgdj1hLmI/YS5iKEQuYShlLHQpKTphLmNhbGwobnVsbCxELmEoZSx0KSk7cS5hZGQodik7dCs9MX1lbHNlIGJyZWFrO3JldHVybiBwZChxLmRhKCksZC5hKGEsSWIoYykpKX1yZXR1cm4gTShhLmI/YS5iKEYoYykpOmEuY2FsbChudWxsLEYoYykpLGQuYShhLEcoYykpKX1yZXR1cm4gbnVsbH0sbnVsbCxudWxsKX12YXIgZD1udWxsLGU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGMsXG5kLGUsZix0KXt2YXIgdj1udWxsOzQ8YXJndW1lbnRzLmxlbmd0aCYmKHY9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsNCksMCkpO3JldHVybiBiLmNhbGwodGhpcyxjLGQsZSxmLHYpfWZ1bmN0aW9uIGIoYSxjLGUsZixoKXt2YXIgdj1mdW5jdGlvbiB5KGEpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7dmFyIGI9ZC5hKEUsYSk7cmV0dXJuIERkKEZkLGIpP00oZC5hKEYsYikseShkLmEoRyxiKSkpOm51bGx9LG51bGwsbnVsbCl9O3JldHVybiBkLmEoZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oYil7cmV0dXJuIFMuYShhLGIpfX0odiksdihwYy5kKGgsZixKKFtlLGNdLDApKSkpfWEuaz00O2EuZj1mdW5jdGlvbihhKXt2YXIgYz1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9SShhKTt2YXIgZT1GKGEpO2E9SShhKTt2YXIgZj1GKGEpO2E9RyhhKTtyZXR1cm4gYihjLGQsZSxmLGEpfTthLmQ9YjtyZXR1cm4gYX0oKSxkPWZ1bmN0aW9uKGQsaCxrLGwsXG5uKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBjLmNhbGwodGhpcyxkLGgpO2Nhc2UgMzpyZXR1cm4gYi5jYWxsKHRoaXMsZCxoLGspO2Nhc2UgNDpyZXR1cm4gYS5jYWxsKHRoaXMsZCxoLGssbCk7ZGVmYXVsdDpyZXR1cm4gZS5kKGQsaCxrLGwsSihhcmd1bWVudHMsNCkpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtkLms9NDtkLmY9ZS5mO2QuYT1jO2QuYz1iO2Qubj1hO2QuZD1lLmQ7cmV0dXJuIGR9KCksTWQ9ZnVuY3Rpb24gTGQoYixjKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbigpe2lmKDA8Yil7dmFyIGQ9RShjKTtyZXR1cm4gZD9NKEYoZCksTGQoYi0xLEcoZCkpKTpudWxsfXJldHVybiBudWxsfSxudWxsLG51bGwpfTtcbmZ1bmN0aW9uIE5kKGEsYil7cmV0dXJuIG5ldyBWKG51bGwsZnVuY3Rpb24oYyl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGMoYSxiKX19KGZ1bmN0aW9uKGEsYil7Zm9yKDs7KXt2YXIgZT1FKGIpO2lmKDA8YSYmZSl7dmFyIGY9YS0xLGU9RyhlKTthPWY7Yj1lfWVsc2UgcmV0dXJuIGV9fSksbnVsbCxudWxsKX1cbnZhciBPZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4gTWQoYSxjLmIoYikpfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIG5ldyBWKG51bGwsZnVuY3Rpb24oKXtyZXR1cm4gTShhLGMuYihhKSl9LG51bGwsbnVsbCl9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYi5jYWxsKHRoaXMsYyk7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxjLGUpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmI9YjtjLmE9YTtyZXR1cm4gY30oKSxQZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4gTWQoYSxjLmIoYikpfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIG5ldyBWKG51bGwsZnVuY3Rpb24oKXtyZXR1cm4gTShhLm8/YS5vKCk6YS5jYWxsKG51bGwpLGMuYihhKSl9LG51bGwsbnVsbCl9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYi5jYWxsKHRoaXMsXG5jKTtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYj1iO2MuYT1hO3JldHVybiBjfSgpLFFkPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGMpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7dmFyIGY9RShhKSxoPUUoYyk7cmV0dXJuIGYmJmg/TShGKGYpLE0oRihoKSxiLmEoRyhmKSxHKGgpKSkpOm51bGx9LG51bGwsbnVsbCl9dmFyIGI9bnVsbCxjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShiLGQsayl7dmFyIGw9bnVsbDsyPGFyZ3VtZW50cy5sZW5ndGgmJihsPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpLDApKTtyZXR1cm4gYy5jYWxsKHRoaXMsYixkLGwpfWZ1bmN0aW9uIGMoYSxkLGUpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7dmFyIGM9S2QuYShFLHBjLmQoZSxkLEooW2FdLDApKSk7cmV0dXJuIERkKEZkLGMpP3RkLmEoS2QuYShGLFxuYyksUy5hKGIsS2QuYShHLGMpKSk6bnVsbH0sbnVsbCxudWxsKX1hLms9MjthLmY9ZnVuY3Rpb24oYSl7dmFyIGI9RihhKTthPUkoYSk7dmFyIGQ9RihhKTthPUcoYSk7cmV0dXJuIGMoYixkLGEpfTthLmQ9YztyZXR1cm4gYX0oKSxiPWZ1bmN0aW9uKGIsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxiLGUpO2RlZmF1bHQ6cmV0dXJuIGMuZChiLGUsSihhcmd1bWVudHMsMikpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtiLms9MjtiLmY9Yy5mO2IuYT1hO2IuZD1jLmQ7cmV0dXJuIGJ9KCk7ZnVuY3Rpb24gUmQoYSl7cmV0dXJuIGZ1bmN0aW9uIGMoYSxlKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbigpe3ZhciBmPUUoYSk7cmV0dXJuIGY/TShGKGYpLGMoRyhmKSxlKSk6RShlKT9jKEYoZSksRyhlKSk6bnVsbH0sbnVsbCxudWxsKX0obnVsbCxhKX1cbnZhciBTZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4gUmQoS2QuYShhLGIpKX12YXIgYj1udWxsLGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGMsZCxrKXt2YXIgbD1udWxsOzI8YXJndW1lbnRzLmxlbmd0aCYmKGw9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMiksMCkpO3JldHVybiBiLmNhbGwodGhpcyxjLGQsbCl9ZnVuY3Rpb24gYihhLGMsZCl7cmV0dXJuIFJkKFMubihLZCxhLGMsZCkpfWEuaz0yO2EuZj1mdW5jdGlvbihhKXt2YXIgYz1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9RyhhKTtyZXR1cm4gYihjLGQsYSl9O2EuZD1iO3JldHVybiBhfSgpLGI9ZnVuY3Rpb24oYixlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGIsZSk7ZGVmYXVsdDpyZXR1cm4gYy5kKGIsZSxKKGFyZ3VtZW50cywyKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O1xuYi5rPTI7Yi5mPWMuZjtiLmE9YTtiLmQ9Yy5kO3JldHVybiBifSgpLFVkPWZ1bmN0aW9uIFRkKGIsYyl7cmV0dXJuIG5ldyBWKG51bGwsZnVuY3Rpb24oKXt2YXIgZD1FKGMpO2lmKGQpe2lmKEljKGQpKXtmb3IodmFyIGU9SGIoZCksZj1PKGUpLGg9bmV3IGxkKEFycmF5KGYpLDApLGs9MDs7KWlmKGs8Zil7aWYocihiLmI/Yi5iKEQuYShlLGspKTpiLmNhbGwobnVsbCxELmEoZSxrKSkpKXt2YXIgbD1ELmEoZSxrKTtoLmFkZChsKX1rKz0xfWVsc2UgYnJlYWs7cmV0dXJuIHBkKGguZGEoKSxUZChiLEliKGQpKSl9ZT1GKGQpO2Q9RyhkKTtyZXR1cm4gcihiLmI/Yi5iKGUpOmIuY2FsbChudWxsLGUpKT9NKGUsVGQoYixkKSk6VGQoYixkKX1yZXR1cm4gbnVsbH0sbnVsbCxudWxsKX07ZnVuY3Rpb24gVmQoYSxiKXtyZXR1cm4gVWQoR2QoYSksYil9XG5mdW5jdGlvbiBXZChhKXt2YXIgYj1YZDtyZXR1cm4gZnVuY3Rpb24gZChhKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbigpe3JldHVybiBNKGEscihiLmI/Yi5iKGEpOmIuY2FsbChudWxsLGEpKT9TZC5hKGQsRS5iP0UuYihhKTpFLmNhbGwobnVsbCxhKSk6bnVsbCl9LG51bGwsbnVsbCl9KGEpfWZ1bmN0aW9uIFlkKGEsYil7cmV0dXJuIG51bGwhPWE/YSYmKGEucSY0fHxhLkJjKT92ZChDLmMoemIseWIoYSksYikpOkMuYyhEYSxhLGIpOkMuYyhwYyxILGIpfVxudmFyIFpkPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyxrKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbigpe3ZhciBsPUUoayk7aWYobCl7dmFyIG49TWQoYSxsKTtyZXR1cm4gYT09PU8obik/TShuLGQubihhLGIsYyxOZChiLGwpKSk6RGEoSCxNZChhLHRkLmEobixjKSkpfXJldHVybiBudWxsfSxudWxsLG51bGwpfWZ1bmN0aW9uIGIoYSxiLGMpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7dmFyIGs9RShjKTtpZihrKXt2YXIgbD1NZChhLGspO3JldHVybiBhPT09TyhsKT9NKGwsZC5jKGEsYixOZChiLGspKSk6bnVsbH1yZXR1cm4gbnVsbH0sbnVsbCxudWxsKX1mdW5jdGlvbiBjKGEsYil7cmV0dXJuIGQuYyhhLGEsYil9dmFyIGQ9bnVsbCxkPWZ1bmN0aW9uKGQsZixoLGspe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGMuY2FsbCh0aGlzLGQsZik7Y2FzZSAzOnJldHVybiBiLmNhbGwodGhpcyxkLGYsaCk7Y2FzZSA0OnJldHVybiBhLmNhbGwodGhpcyxcbmQsZixoLGspfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtkLmE9YztkLmM9YjtkLm49YTtyZXR1cm4gZH0oKSwkZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMpe3ZhciBoPUxjO2ZvcihiPUUoYik7OylpZihiKXt2YXIgaz1hO2lmKGs/ay5pJjI1Nnx8ay5NYnx8KGsuaT8wOnMoS2EsaykpOnMoS2Esaykpe2E9US5jKGEsRihiKSxoKTtpZihoPT09YSlyZXR1cm4gYztiPUkoYil9ZWxzZSByZXR1cm4gY31lbHNlIHJldHVybiBhfWZ1bmN0aW9uIGIoYSxiKXtyZXR1cm4gYy5jKGEsYixudWxsKX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGIuY2FsbCh0aGlzLGMsZSk7Y2FzZSAzOnJldHVybiBhLmNhbGwodGhpcyxjLGUsZil9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYT1iO2MuYz1hO3JldHVybiBjfSgpLGFlPVxuZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjLGQsZix0KXt2YXIgdj1QLmMoYiwwLG51bGwpO3JldHVybihiPSRjKGIpKT9SLmMoYSx2LGUuWChRLmEoYSx2KSxiLGMsZCxmLHQpKTpSLmMoYSx2LGMubj9jLm4oUS5hKGEsdiksZCxmLHQpOmMuY2FsbChudWxsLFEuYShhLHYpLGQsZix0KSl9ZnVuY3Rpb24gYihhLGIsYyxkLGYpe3ZhciB0PVAuYyhiLDAsbnVsbCk7cmV0dXJuKGI9JGMoYikpP1IuYyhhLHQsZS5zKFEuYShhLHQpLGIsYyxkLGYpKTpSLmMoYSx0LGMuYz9jLmMoUS5hKGEsdCksZCxmKTpjLmNhbGwobnVsbCxRLmEoYSx0KSxkLGYpKX1mdW5jdGlvbiBjKGEsYixjLGQpe3ZhciBmPVAuYyhiLDAsbnVsbCk7cmV0dXJuKGI9JGMoYikpP1IuYyhhLGYsZS5uKFEuYShhLGYpLGIsYyxkKSk6Ui5jKGEsZixjLmE/Yy5hKFEuYShhLGYpLGQpOmMuY2FsbChudWxsLFEuYShhLGYpLGQpKX1mdW5jdGlvbiBkKGEsYixjKXt2YXIgZD1QLmMoYiwwLG51bGwpO3JldHVybihiPSRjKGIpKT9cblIuYyhhLGQsZS5jKFEuYShhLGQpLGIsYykpOlIuYyhhLGQsYy5iP2MuYihRLmEoYSxkKSk6Yy5jYWxsKG51bGwsUS5hKGEsZCkpKX12YXIgZT1udWxsLGY9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGMsZCxlLGYsaCx3LHkpe3ZhciBCPW51bGw7Njxhcmd1bWVudHMubGVuZ3RoJiYoQj1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyw2KSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGMsZCxlLGYsaCx3LEIpfWZ1bmN0aW9uIGIoYSxjLGQsZixoLGsseSl7dmFyIEI9UC5jKGMsMCxudWxsKTtyZXR1cm4oYz0kYyhjKSk/Ui5jKGEsQixTLmQoZSxRLmEoYSxCKSxjLGQsZixKKFtoLGsseV0sMCkpKTpSLmMoYSxCLFMuZChkLFEuYShhLEIpLGYsaCxrLEooW3ldLDApKSl9YS5rPTY7YS5mPWZ1bmN0aW9uKGEpe3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1JKGEpO3ZhciBlPUYoYSk7YT1JKGEpO3ZhciBmPUYoYSk7YT1JKGEpO3ZhciBoPUYoYSk7YT1JKGEpO3ZhciB5PVxuRihhKTthPUcoYSk7cmV0dXJuIGIoYyxkLGUsZixoLHksYSl9O2EuZD1iO3JldHVybiBhfSgpLGU9ZnVuY3Rpb24oZSxrLGwsbixxLHQsdil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMzpyZXR1cm4gZC5jYWxsKHRoaXMsZSxrLGwpO2Nhc2UgNDpyZXR1cm4gYy5jYWxsKHRoaXMsZSxrLGwsbik7Y2FzZSA1OnJldHVybiBiLmNhbGwodGhpcyxlLGssbCxuLHEpO2Nhc2UgNjpyZXR1cm4gYS5jYWxsKHRoaXMsZSxrLGwsbixxLHQpO2RlZmF1bHQ6cmV0dXJuIGYuZChlLGssbCxuLHEsdCxKKGFyZ3VtZW50cyw2KSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Uuaz02O2UuZj1mLmY7ZS5jPWQ7ZS5uPWM7ZS5zPWI7ZS5YPWE7ZS5kPWYuZDtyZXR1cm4gZX0oKTtmdW5jdGlvbiBiZShhLGIpe3RoaXMudD1hO3RoaXMuZT1ifVxuZnVuY3Rpb24gY2UoYSl7cmV0dXJuIG5ldyBiZShhLFtudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGxdKX1mdW5jdGlvbiBkZShhKXtyZXR1cm4gbmV3IGJlKGEudCx2YShhLmUpKX1mdW5jdGlvbiBlZShhKXthPWEuZztyZXR1cm4gMzI+YT8wOmEtMT4+PjU8PDV9ZnVuY3Rpb24gZmUoYSxiLGMpe2Zvcig7Oyl7aWYoMD09PWIpcmV0dXJuIGM7dmFyIGQ9Y2UoYSk7ZC5lWzBdPWM7Yz1kO2ItPTV9fXZhciBoZT1mdW5jdGlvbiBnZShiLGMsZCxlKXt2YXIgZj1kZShkKSxoPWIuZy0xPj4+YyYzMTs1PT09Yz9mLmVbaF09ZTooZD1kLmVbaF0sYj1udWxsIT1kP2dlKGIsYy01LGQsZSk6ZmUobnVsbCxjLTUsZSksZi5lW2hdPWIpO3JldHVybiBmfTtcbmZ1bmN0aW9uIGllKGEsYil7dGhyb3cgRXJyb3IoXCJObyBpdGVtIFwiK0EuYihhKStcIiBpbiB2ZWN0b3Igb2YgbGVuZ3RoIFwiK0EuYihiKSk7fWZ1bmN0aW9uIGplKGEpe3ZhciBiPWEucm9vdDtmb3IoYT1hLnNoaWZ0OzspaWYoMDxhKWEtPTUsYj1iLmVbMF07ZWxzZSByZXR1cm4gYi5lfWZ1bmN0aW9uIGtlKGEsYil7aWYoYj49ZWUoYSkpcmV0dXJuIGEuUjtmb3IodmFyIGM9YS5yb290LGQ9YS5zaGlmdDs7KWlmKDA8ZCl2YXIgZT1kLTUsYz1jLmVbYj4+PmQmMzFdLGQ9ZTtlbHNlIHJldHVybiBjLmV9ZnVuY3Rpb24gbGUoYSxiKXtyZXR1cm4gMDw9YiYmYjxhLmc/a2UoYSxiKTppZShiLGEuZyl9XG52YXIgbmU9ZnVuY3Rpb24gbWUoYixjLGQsZSxmKXt2YXIgaD1kZShkKTtpZigwPT09YyloLmVbZSYzMV09ZjtlbHNle3ZhciBrPWU+Pj5jJjMxO2I9bWUoYixjLTUsZC5lW2tdLGUsZik7aC5lW2tdPWJ9cmV0dXJuIGh9LHBlPWZ1bmN0aW9uIG9lKGIsYyxkKXt2YXIgZT1iLmctMj4+PmMmMzE7aWYoNTxjKXtiPW9lKGIsYy01LGQuZVtlXSk7aWYobnVsbD09YiYmMD09PWUpcmV0dXJuIG51bGw7ZD1kZShkKTtkLmVbZV09YjtyZXR1cm4gZH1yZXR1cm4gMD09PWU/bnVsbDp1PyhkPWRlKGQpLGQuZVtlXT1udWxsLGQpOm51bGx9O2Z1bmN0aW9uIFcoYSxiLGMsZCxlLGYpe3RoaXMuaj1hO3RoaXMuZz1iO3RoaXMuc2hpZnQ9Yzt0aGlzLnJvb3Q9ZDt0aGlzLlI9ZTt0aGlzLm09Zjt0aGlzLmk9MTY3NjY4NTExO3RoaXMucT04MTk2fWc9Vy5wcm90b3R5cGU7Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07XG5nLnU9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTGEuYyh0aGlzLGIsbnVsbCl9O2cuQz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuXCJudW1iZXJcIj09PXR5cGVvZiBiP0QuYyh0aGlzLGIsYyk6Y307Zy5aYT1mdW5jdGlvbihhLGIsYyl7YT1bMCxjXTtmb3IoYz0wOzspaWYoYzx0aGlzLmcpe3ZhciBkPWtlKHRoaXMsYyksZT1kLmxlbmd0aDthOntmb3IodmFyIGY9MCxoPWFbMV07OylpZihmPGUpe2g9Yi5jP2IuYyhoLGYrYyxkW2ZdKTpiLmNhbGwobnVsbCxoLGYrYyxkW2ZdKTtpZihmYyhoKSl7ZD1oO2JyZWFrIGF9Zis9MX1lbHNle2FbMF09ZTtkPWFbMV09aDticmVhayBhfWQ9dm9pZCAwfWlmKGZjKGQpKXJldHVybiBLLmI/Sy5iKGQpOksuY2FsbChudWxsLGQpO2MrPWFbMF19ZWxzZSByZXR1cm4gYVsxXX07Zy5KPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGxlKHRoaXMsYilbYiYzMV19O1xuZy5hYT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIDA8PWImJmI8dGhpcy5nP2tlKHRoaXMsYilbYiYzMV06Y307Zy5QYT1mdW5jdGlvbihhLGIsYyl7aWYoMDw9YiYmYjx0aGlzLmcpcmV0dXJuIGVlKHRoaXMpPD1iPyhhPXZhKHRoaXMuUiksYVtiJjMxXT1jLG5ldyBXKHRoaXMuaix0aGlzLmcsdGhpcy5zaGlmdCx0aGlzLnJvb3QsYSxudWxsKSk6bmV3IFcodGhpcy5qLHRoaXMuZyx0aGlzLnNoaWZ0LG5lKHRoaXMsdGhpcy5zaGlmdCx0aGlzLnJvb3QsYixjKSx0aGlzLlIsbnVsbCk7aWYoYj09PXRoaXMuZylyZXR1cm4gRGEodGhpcyxjKTtpZih1KXRocm93IEVycm9yKFwiSW5kZXggXCIrQS5iKGIpK1wiIG91dCBvZiBib3VuZHMgIFswLFwiK0EuYih0aGlzLmcpK1wiXVwiKTtyZXR1cm4gbnVsbH07Zy5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuan07Zy5MPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ307Zy4kYT1mdW5jdGlvbigpe3JldHVybiBELmEodGhpcywwKX07XG5nLmFiPWZ1bmN0aW9uKCl7cmV0dXJuIEQuYSh0aGlzLDEpfTtnLklhPWZ1bmN0aW9uKCl7cmV0dXJuIDA8dGhpcy5nP0QuYSh0aGlzLHRoaXMuZy0xKTpudWxsfTtnLkphPWZ1bmN0aW9uKCl7aWYoMD09PXRoaXMuZyl0aHJvdyBFcnJvcihcIkNhbid0IHBvcCBlbXB0eSB2ZWN0b3JcIik7aWYoMT09PXRoaXMuZylyZXR1cm4gZWIocWUsdGhpcy5qKTtpZigxPHRoaXMuZy1lZSh0aGlzKSlyZXR1cm4gbmV3IFcodGhpcy5qLHRoaXMuZy0xLHRoaXMuc2hpZnQsdGhpcy5yb290LHRoaXMuUi5zbGljZSgwLC0xKSxudWxsKTtpZih1KXt2YXIgYT1rZSh0aGlzLHRoaXMuZy0yKSxiPXBlKHRoaXMsdGhpcy5zaGlmdCx0aGlzLnJvb3QpLGI9bnVsbD09Yj9YOmIsYz10aGlzLmctMTtyZXR1cm4gNTx0aGlzLnNoaWZ0JiZudWxsPT1iLmVbMV0/bmV3IFcodGhpcy5qLGMsdGhpcy5zaGlmdC01LGIuZVswXSxhLG51bGwpOm5ldyBXKHRoaXMuaixjLHRoaXMuc2hpZnQsYixhLG51bGwpfXJldHVybiBudWxsfTtcbmcuWGE9ZnVuY3Rpb24oKXtyZXR1cm4gMDx0aGlzLmc/bmV3IGtjKHRoaXMsdGhpcy5nLTEsbnVsbCk6bnVsbH07Zy5CPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tO3JldHVybiBudWxsIT1hP2E6dGhpcy5tPWE9Y2ModGhpcyl9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBsYyh0aGlzLGIpfTtnLldhPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyByZSh0aGlzLmcsdGhpcy5zaGlmdCxzZS5iP3NlLmIodGhpcy5yb290KTpzZS5jYWxsKG51bGwsdGhpcy5yb290KSx0ZS5iP3RlLmIodGhpcy5SKTp0ZS5jYWxsKG51bGwsdGhpcy5SKSl9O2cuST1mdW5jdGlvbigpe3JldHVybiBOKHFlLHRoaXMuail9O2cuTj1mdW5jdGlvbihhLGIpe3JldHVybiBnYy5hKHRoaXMsYil9O2cuTT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIGdjLmModGhpcyxiLGMpfTtcbmcudWE9ZnVuY3Rpb24oYSxiLGMpe2lmKFwibnVtYmVyXCI9PT10eXBlb2YgYilyZXR1cm4gJGEodGhpcyxiLGMpO3Rocm93IEVycm9yKFwiVmVjdG9yJ3Mga2V5IGZvciBhc3NvYyBtdXN0IGJlIGEgbnVtYmVyLlwiKTt9O2cuSD1mdW5jdGlvbigpe3JldHVybiAwPT09dGhpcy5nP251bGw6MzI+PXRoaXMuZz9uZXcgYWModGhpcy5SLDApOnU/dWUubj91ZS5uKHRoaXMsamUodGhpcyksMCwwKTp1ZS5jYWxsKG51bGwsdGhpcyxqZSh0aGlzKSwwLDApOm51bGx9O2cuRj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgVyhiLHRoaXMuZyx0aGlzLnNoaWZ0LHRoaXMucm9vdCx0aGlzLlIsdGhpcy5tKX07XG5nLkc9ZnVuY3Rpb24oYSxiKXtpZigzMj50aGlzLmctZWUodGhpcykpe2Zvcih2YXIgYz10aGlzLlIubGVuZ3RoLGQ9QXJyYXkoYysxKSxlPTA7OylpZihlPGMpZFtlXT10aGlzLlJbZV0sZSs9MTtlbHNlIGJyZWFrO2RbY109YjtyZXR1cm4gbmV3IFcodGhpcy5qLHRoaXMuZysxLHRoaXMuc2hpZnQsdGhpcy5yb290LGQsbnVsbCl9Yz0oZD10aGlzLmc+Pj41PjE8PHRoaXMuc2hpZnQpP3RoaXMuc2hpZnQrNTp0aGlzLnNoaWZ0O2Q/KGQ9Y2UobnVsbCksZC5lWzBdPXRoaXMucm9vdCxlPWZlKG51bGwsdGhpcy5zaGlmdCxuZXcgYmUobnVsbCx0aGlzLlIpKSxkLmVbMV09ZSk6ZD1oZSh0aGlzLHRoaXMuc2hpZnQsdGhpcy5yb290LG5ldyBiZShudWxsLHRoaXMuUikpO3JldHVybiBuZXcgVyh0aGlzLmosdGhpcy5nKzEsYyxkLFtiXSxudWxsKX07XG5nLmNhbGw9ZnVuY3Rpb24oKXt2YXIgYT1udWxsO3JldHVybiBhPWZ1bmN0aW9uKGEsYyxkKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiB0aGlzLkoobnVsbCxjKTtjYXNlIDM6cmV0dXJuIHRoaXMuYWEobnVsbCxjLGQpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fX0oKTtnLmFwcGx5PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuY2FsbC5hcHBseSh0aGlzLFt0aGlzXS5jb25jYXQodmEoYikpKX07Zy5iPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLkoobnVsbCxhKX07Zy5hPWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuYWEobnVsbCxhLGIpfTtcbnZhciBYPW5ldyBiZShudWxsLFtudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGxdKSxxZT1uZXcgVyhudWxsLDAsNSxYLFtdLDApO2Z1bmN0aW9uIHZlKGEsYil7dmFyIGM9YS5sZW5ndGgsZD1iP2E6dmEoYSk7aWYoMzI+YylyZXR1cm4gbmV3IFcobnVsbCxjLDUsWCxkLG51bGwpO2Zvcih2YXIgZT0zMixmPShuZXcgVyhudWxsLDMyLDUsWCxkLnNsaWNlKDAsMzIpLG51bGwpKS5XYShudWxsKTs7KWlmKGU8Yyl2YXIgaD1lKzEsZj13ZC5hKGYsZFtlXSksZT1oO2Vsc2UgcmV0dXJuIEFiKGYpfWZ1bmN0aW9uIHdlKGEpe3JldHVybiBBYihDLmMoemIseWIocWUpLGEpKX1cbnZhciB4ZT1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSl7dmFyIGQ9bnVsbDswPGFyZ3VtZW50cy5sZW5ndGgmJihkPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsZCl9ZnVuY3Rpb24gYihhKXtyZXR1cm4gYSBpbnN0YW5jZW9mIGFjJiYwPT09YS5wP3ZlLmE/dmUuYShhLmUsITApOnZlLmNhbGwobnVsbCxhLmUsITApOndlKGEpfWEuaz0wO2EuZj1mdW5jdGlvbihhKXthPUUoYSk7cmV0dXJuIGIoYSl9O2EuZD1iO3JldHVybiBhfSgpO2Z1bmN0aW9uIHllKGEsYixjLGQsZSxmKXt0aGlzLlA9YTt0aGlzLmVhPWI7dGhpcy5wPWM7dGhpcy5PPWQ7dGhpcy5qPWU7dGhpcy5tPWY7dGhpcy5pPTMyMjQzOTQ4O3RoaXMucT0xNTM2fWc9eWUucHJvdG90eXBlO2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O1xuZy5VPWZ1bmN0aW9uKCl7aWYodGhpcy5PKzE8dGhpcy5lYS5sZW5ndGgpe3ZhciBhPXVlLm4/dWUubih0aGlzLlAsdGhpcy5lYSx0aGlzLnAsdGhpcy5PKzEpOnVlLmNhbGwobnVsbCx0aGlzLlAsdGhpcy5lYSx0aGlzLnAsdGhpcy5PKzEpO3JldHVybiBudWxsPT1hP251bGw6YX1yZXR1cm4gSmIodGhpcyl9O2cuQj1mdW5jdGlvbigpe3ZhciBhPXRoaXMubTtyZXR1cm4gbnVsbCE9YT9hOnRoaXMubT1hPWNjKHRoaXMpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbGModGhpcyxiKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIE4ocWUsdGhpcy5qKX07Zy5OPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGdjLmEoemUuYz96ZS5jKHRoaXMuUCx0aGlzLnArdGhpcy5PLE8odGhpcy5QKSk6emUuY2FsbChudWxsLHRoaXMuUCx0aGlzLnArdGhpcy5PLE8odGhpcy5QKSksYil9O1xuZy5NPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gZ2MuYyh6ZS5jP3plLmModGhpcy5QLHRoaXMucCt0aGlzLk8sTyh0aGlzLlApKTp6ZS5jYWxsKG51bGwsdGhpcy5QLHRoaXMucCt0aGlzLk8sTyh0aGlzLlApKSxiLGMpfTtnLlE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lYVt0aGlzLk9dfTtnLlM9ZnVuY3Rpb24oKXtpZih0aGlzLk8rMTx0aGlzLmVhLmxlbmd0aCl7dmFyIGE9dWUubj91ZS5uKHRoaXMuUCx0aGlzLmVhLHRoaXMucCx0aGlzLk8rMSk6dWUuY2FsbChudWxsLHRoaXMuUCx0aGlzLmVhLHRoaXMucCx0aGlzLk8rMSk7cmV0dXJuIG51bGw9PWE/SDphfXJldHVybiBJYih0aGlzKX07Zy5IPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9O2cuc2I9ZnVuY3Rpb24oKXtyZXR1cm4gbmQuYSh0aGlzLmVhLHRoaXMuTyl9O1xuZy50Yj1mdW5jdGlvbigpe3ZhciBhPXRoaXMucCt0aGlzLmVhLmxlbmd0aDtyZXR1cm4gYTxBYSh0aGlzLlApP3VlLm4/dWUubih0aGlzLlAsa2UodGhpcy5QLGEpLGEsMCk6dWUuY2FsbChudWxsLHRoaXMuUCxrZSh0aGlzLlAsYSksYSwwKTpIfTtnLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdWUucz91ZS5zKHRoaXMuUCx0aGlzLmVhLHRoaXMucCx0aGlzLk8sYik6dWUuY2FsbChudWxsLHRoaXMuUCx0aGlzLmVhLHRoaXMucCx0aGlzLk8sYil9O2cuRz1mdW5jdGlvbihhLGIpe3JldHVybiBNKGIsdGhpcyl9O2cucmI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnArdGhpcy5lYS5sZW5ndGg7cmV0dXJuIGE8QWEodGhpcy5QKT91ZS5uP3VlLm4odGhpcy5QLGtlKHRoaXMuUCxhKSxhLDApOnVlLmNhbGwobnVsbCx0aGlzLlAsa2UodGhpcy5QLGEpLGEsMCk6bnVsbH07XG52YXIgdWU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjLGQsbCl7cmV0dXJuIG5ldyB5ZShhLGIsYyxkLGwsbnVsbCl9ZnVuY3Rpb24gYihhLGIsYyxkKXtyZXR1cm4gbmV3IHllKGEsYixjLGQsbnVsbCxudWxsKX1mdW5jdGlvbiBjKGEsYixjKXtyZXR1cm4gbmV3IHllKGEsbGUoYSxiKSxiLGMsbnVsbCxudWxsKX12YXIgZD1udWxsLGQ9ZnVuY3Rpb24oZCxmLGgsayxsKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAzOnJldHVybiBjLmNhbGwodGhpcyxkLGYsaCk7Y2FzZSA0OnJldHVybiBiLmNhbGwodGhpcyxkLGYsaCxrKTtjYXNlIDU6cmV0dXJuIGEuY2FsbCh0aGlzLGQsZixoLGssbCl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2QuYz1jO2Qubj1iO2Qucz1hO3JldHVybiBkfSgpO1xuZnVuY3Rpb24gQWUoYSxiLGMsZCxlKXt0aGlzLmo9YTt0aGlzLmNhPWI7dGhpcy5zdGFydD1jO3RoaXMuZW5kPWQ7dGhpcy5tPWU7dGhpcy5pPTE2NjYxNzg4Nzt0aGlzLnE9ODE5Mn1nPUFlLnByb3RvdHlwZTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIExiKHRoaXMpfTtnLnU9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTGEuYyh0aGlzLGIsbnVsbCl9O2cuQz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuXCJudW1iZXJcIj09PXR5cGVvZiBiP0QuYyh0aGlzLGIsYyk6Y307Zy5KPWZ1bmN0aW9uKGEsYil7cmV0dXJuIDA+Ynx8dGhpcy5lbmQ8PXRoaXMuc3RhcnQrYj9pZShiLHRoaXMuZW5kLXRoaXMuc3RhcnQpOkQuYSh0aGlzLmNhLHRoaXMuc3RhcnQrYil9O2cuYWE9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiAwPmJ8fHRoaXMuZW5kPD10aGlzLnN0YXJ0K2I/YzpELmModGhpcy5jYSx0aGlzLnN0YXJ0K2IsYyl9O1xuZy5QYT1mdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcyxlPWQuc3RhcnQrYjtyZXR1cm4gQmUucz9CZS5zKGQuaixSLmMoZC5jYSxlLGMpLGQuc3RhcnQsZnVuY3Rpb24oKXt2YXIgYT1kLmVuZCxiPWUrMTtyZXR1cm4gYT5iP2E6Yn0oKSxudWxsKTpCZS5jYWxsKG51bGwsZC5qLFIuYyhkLmNhLGUsYyksZC5zdGFydCxmdW5jdGlvbigpe3ZhciBhPWQuZW5kLGI9ZSsxO3JldHVybiBhPmI/YTpifSgpLG51bGwpfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5qfTtnLkw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lbmQtdGhpcy5zdGFydH07Zy5JYT1mdW5jdGlvbigpe3JldHVybiBELmEodGhpcy5jYSx0aGlzLmVuZC0xKX07XG5nLkphPWZ1bmN0aW9uKCl7aWYodGhpcy5zdGFydD09PXRoaXMuZW5kKXRocm93IEVycm9yKFwiQ2FuJ3QgcG9wIGVtcHR5IHZlY3RvclwiKTtyZXR1cm4gQmUucz9CZS5zKHRoaXMuaix0aGlzLmNhLHRoaXMuc3RhcnQsdGhpcy5lbmQtMSxudWxsKTpCZS5jYWxsKG51bGwsdGhpcy5qLHRoaXMuY2EsdGhpcy5zdGFydCx0aGlzLmVuZC0xLG51bGwpfTtnLlhhPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3RhcnQhPT10aGlzLmVuZD9uZXcga2ModGhpcyx0aGlzLmVuZC10aGlzLnN0YXJ0LTEsbnVsbCk6bnVsbH07Zy5CPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tO3JldHVybiBudWxsIT1hP2E6dGhpcy5tPWE9Y2ModGhpcyl9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBsYyh0aGlzLGIpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gTihxZSx0aGlzLmopfTtnLk49ZnVuY3Rpb24oYSxiKXtyZXR1cm4gZ2MuYSh0aGlzLGIpfTtcbmcuTT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIGdjLmModGhpcyxiLGMpfTtnLnVhPWZ1bmN0aW9uKGEsYixjKXtpZihcIm51bWJlclwiPT09dHlwZW9mIGIpcmV0dXJuICRhKHRoaXMsYixjKTt0aHJvdyBFcnJvcihcIlN1YnZlYydzIGtleSBmb3IgYXNzb2MgbXVzdCBiZSBhIG51bWJlci5cIik7fTtnLkg9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO3JldHVybiBmdW5jdGlvbihiKXtyZXR1cm4gZnVuY3Rpb24gZChlKXtyZXR1cm4gZT09PWEuZW5kP251bGw6TShELmEoYS5jYSxlKSxuZXcgVihudWxsLGZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGQoZSsxKX19KGIpLG51bGwsbnVsbCkpfX0odGhpcykoYS5zdGFydCl9O2cuRj1mdW5jdGlvbihhLGIpe3JldHVybiBCZS5zP0JlLnMoYix0aGlzLmNhLHRoaXMuc3RhcnQsdGhpcy5lbmQsdGhpcy5tKTpCZS5jYWxsKG51bGwsYix0aGlzLmNhLHRoaXMuc3RhcnQsdGhpcy5lbmQsdGhpcy5tKX07XG5nLkc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gQmUucz9CZS5zKHRoaXMuaiwkYSh0aGlzLmNhLHRoaXMuZW5kLGIpLHRoaXMuc3RhcnQsdGhpcy5lbmQrMSxudWxsKTpCZS5jYWxsKG51bGwsdGhpcy5qLCRhKHRoaXMuY2EsdGhpcy5lbmQsYiksdGhpcy5zdGFydCx0aGlzLmVuZCsxLG51bGwpfTtnLmNhbGw9ZnVuY3Rpb24oKXt2YXIgYT1udWxsO3JldHVybiBhPWZ1bmN0aW9uKGEsYyxkKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiB0aGlzLkoobnVsbCxjKTtjYXNlIDM6cmV0dXJuIHRoaXMuYWEobnVsbCxjLGQpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fX0oKTtnLmFwcGx5PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuY2FsbC5hcHBseSh0aGlzLFt0aGlzXS5jb25jYXQodmEoYikpKX07Zy5iPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLkoobnVsbCxhKX07XG5nLmE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5hYShudWxsLGEsYil9O2Z1bmN0aW9uIEJlKGEsYixjLGQsZSl7Zm9yKDs7KWlmKGIgaW5zdGFuY2VvZiBBZSljPWIuc3RhcnQrYyxkPWIuc3RhcnQrZCxiPWIuY2E7ZWxzZXt2YXIgZj1PKGIpO2lmKDA+Y3x8MD5kfHxjPmZ8fGQ+Zil0aHJvdyBFcnJvcihcIkluZGV4IG91dCBvZiBib3VuZHNcIik7cmV0dXJuIG5ldyBBZShhLGIsYyxkLGUpfX1cbnZhciB6ZT1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMpe3JldHVybiBCZShudWxsLGEsYixjLG51bGwpfWZ1bmN0aW9uIGIoYSxiKXtyZXR1cm4gYy5jKGEsYixPKGEpKX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGIuY2FsbCh0aGlzLGMsZSk7Y2FzZSAzOnJldHVybiBhLmNhbGwodGhpcyxjLGUsZil9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYT1iO2MuYz1hO3JldHVybiBjfSgpO2Z1bmN0aW9uIENlKGEsYil7cmV0dXJuIGE9PT1iLnQ/YjpuZXcgYmUoYSx2YShiLmUpKX1mdW5jdGlvbiBzZShhKXtyZXR1cm4gbmV3IGJlKHt9LHZhKGEuZSkpfVxuZnVuY3Rpb24gdGUoYSl7dmFyIGI9W251bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbF07S2MoYSwwLGIsMCxhLmxlbmd0aCk7cmV0dXJuIGJ9XG52YXIgRWU9ZnVuY3Rpb24gRGUoYixjLGQsZSl7ZD1DZShiLnJvb3QudCxkKTt2YXIgZj1iLmctMT4+PmMmMzE7aWYoNT09PWMpYj1lO2Vsc2V7dmFyIGg9ZC5lW2ZdO2I9bnVsbCE9aD9EZShiLGMtNSxoLGUpOmZlKGIucm9vdC50LGMtNSxlKX1kLmVbZl09YjtyZXR1cm4gZH0sR2U9ZnVuY3Rpb24gRmUoYixjLGQpe2Q9Q2UoYi5yb290LnQsZCk7dmFyIGU9Yi5nLTI+Pj5jJjMxO2lmKDU8Yyl7Yj1GZShiLGMtNSxkLmVbZV0pO2lmKG51bGw9PWImJjA9PT1lKXJldHVybiBudWxsO2QuZVtlXT1iO3JldHVybiBkfXJldHVybiAwPT09ZT9udWxsOnU/KGQuZVtlXT1udWxsLGQpOm51bGx9O2Z1bmN0aW9uIHJlKGEsYixjLGQpe3RoaXMuZz1hO3RoaXMuc2hpZnQ9Yjt0aGlzLnJvb3Q9Yzt0aGlzLlI9ZDt0aGlzLmk9Mjc1O3RoaXMucT04OH1nPXJlLnByb3RvdHlwZTtcbmcuY2FsbD1mdW5jdGlvbigpe3ZhciBhPW51bGw7cmV0dXJuIGE9ZnVuY3Rpb24oYSxjLGQpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIHRoaXMudShudWxsLGMpO2Nhc2UgMzpyZXR1cm4gdGhpcy5DKG51bGwsYyxkKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO319KCk7Zy5hcHBseT1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmNhbGwuYXBwbHkodGhpcyxbdGhpc10uY29uY2F0KHZhKGIpKSl9O2cuYj1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy51KG51bGwsYSl9O2cuYT1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLkMobnVsbCxhLGIpfTtnLnU9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTGEuYyh0aGlzLGIsbnVsbCl9O2cuQz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuXCJudW1iZXJcIj09PXR5cGVvZiBiP0QuYyh0aGlzLGIsYyk6Y307XG5nLko9ZnVuY3Rpb24oYSxiKXtpZih0aGlzLnJvb3QudClyZXR1cm4gbGUodGhpcyxiKVtiJjMxXTt0aHJvdyBFcnJvcihcIm50aCBhZnRlciBwZXJzaXN0ZW50IVwiKTt9O2cuYWE9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiAwPD1iJiZiPHRoaXMuZz9ELmEodGhpcyxiKTpjfTtnLkw9ZnVuY3Rpb24oKXtpZih0aGlzLnJvb3QudClyZXR1cm4gdGhpcy5nO3Rocm93IEVycm9yKFwiY291bnQgYWZ0ZXIgcGVyc2lzdGVudCFcIik7fTtcbmcuUGI9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXM7aWYoZC5yb290LnQpe2lmKDA8PWImJmI8ZC5nKXJldHVybiBlZSh0aGlzKTw9Yj9kLlJbYiYzMV09YzooYT1mdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbiBmKGEsayl7dmFyIGw9Q2UoZC5yb290LnQsayk7aWYoMD09PWEpbC5lW2ImMzFdPWM7ZWxzZXt2YXIgbj1iPj4+YSYzMSxxPWYoYS01LGwuZVtuXSk7bC5lW25dPXF9cmV0dXJuIGx9fSh0aGlzKS5jYWxsKG51bGwsZC5zaGlmdCxkLnJvb3QpLGQucm9vdD1hKSx0aGlzO2lmKGI9PT1kLmcpcmV0dXJuIHpiKHRoaXMsYyk7aWYodSl0aHJvdyBFcnJvcihcIkluZGV4IFwiK0EuYihiKStcIiBvdXQgb2YgYm91bmRzIGZvciBUcmFuc2llbnRWZWN0b3Igb2YgbGVuZ3RoXCIrQS5iKGQuZykpO3JldHVybiBudWxsfXRocm93IEVycm9yKFwiYXNzb2MhIGFmdGVyIHBlcnNpc3RlbnQhXCIpO307XG5nLlFiPWZ1bmN0aW9uKCl7aWYodGhpcy5yb290LnQpe2lmKDA9PT10aGlzLmcpdGhyb3cgRXJyb3IoXCJDYW4ndCBwb3AgZW1wdHkgdmVjdG9yXCIpO2lmKDE9PT10aGlzLmcpcmV0dXJuIHRoaXMuZz0wLHRoaXM7aWYoMDwodGhpcy5nLTEmMzEpKXJldHVybiB0aGlzLmctPTEsdGhpcztpZih1KXt2YXIgYTthOmlmKGE9dGhpcy5nLTIsYT49ZWUodGhpcykpYT10aGlzLlI7ZWxzZXtmb3IodmFyIGI9dGhpcy5yb290LGM9YixkPXRoaXMuc2hpZnQ7OylpZigwPGQpYz1DZShiLnQsYy5lW2E+Pj5kJjMxXSksZC09NTtlbHNle2E9Yy5lO2JyZWFrIGF9YT12b2lkIDB9Yj1HZSh0aGlzLHRoaXMuc2hpZnQsdGhpcy5yb290KTtiPW51bGwhPWI/YjpuZXcgYmUodGhpcy5yb290LnQsW251bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLFxubnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsXSk7NTx0aGlzLnNoaWZ0JiZudWxsPT1iLmVbMV0/KHRoaXMucm9vdD1DZSh0aGlzLnJvb3QudCxiLmVbMF0pLHRoaXMuc2hpZnQtPTUpOnRoaXMucm9vdD1iO3RoaXMuZy09MTt0aGlzLlI9YTtyZXR1cm4gdGhpc31yZXR1cm4gbnVsbH10aHJvdyBFcnJvcihcInBvcCEgYWZ0ZXIgcGVyc2lzdGVudCFcIik7fTtnLmNiPWZ1bmN0aW9uKGEsYixjKXtpZihcIm51bWJlclwiPT09dHlwZW9mIGIpcmV0dXJuIERiKHRoaXMsYixjKTt0aHJvdyBFcnJvcihcIlRyYW5zaWVudFZlY3RvcidzIGtleSBmb3IgYXNzb2MhIG11c3QgYmUgYSBudW1iZXIuXCIpO307XG5nLkthPWZ1bmN0aW9uKGEsYil7aWYodGhpcy5yb290LnQpe2lmKDMyPnRoaXMuZy1lZSh0aGlzKSl0aGlzLlJbdGhpcy5nJjMxXT1iO2Vsc2V7dmFyIGM9bmV3IGJlKHRoaXMucm9vdC50LHRoaXMuUiksZD1bbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsXTtkWzBdPWI7dGhpcy5SPWQ7aWYodGhpcy5nPj4+NT4xPDx0aGlzLnNoaWZ0KXt2YXIgZD1bbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsXSxlPXRoaXMuc2hpZnQrXG41O2RbMF09dGhpcy5yb290O2RbMV09ZmUodGhpcy5yb290LnQsdGhpcy5zaGlmdCxjKTt0aGlzLnJvb3Q9bmV3IGJlKHRoaXMucm9vdC50LGQpO3RoaXMuc2hpZnQ9ZX1lbHNlIHRoaXMucm9vdD1FZSh0aGlzLHRoaXMuc2hpZnQsdGhpcy5yb290LGMpfXRoaXMuZys9MTtyZXR1cm4gdGhpc310aHJvdyBFcnJvcihcImNvbmohIGFmdGVyIHBlcnNpc3RlbnQhXCIpO307Zy5PYT1mdW5jdGlvbigpe2lmKHRoaXMucm9vdC50KXt0aGlzLnJvb3QudD1udWxsO3ZhciBhPXRoaXMuZy1lZSh0aGlzKSxiPUFycmF5KGEpO0tjKHRoaXMuUiwwLGIsMCxhKTtyZXR1cm4gbmV3IFcobnVsbCx0aGlzLmcsdGhpcy5zaGlmdCx0aGlzLnJvb3QsYixudWxsKX10aHJvdyBFcnJvcihcInBlcnNpc3RlbnQhIGNhbGxlZCB0d2ljZVwiKTt9O2Z1bmN0aW9uIEhlKGEsYixjLGQpe3RoaXMuaj1hO3RoaXMuYmE9Yjt0aGlzLnBhPWM7dGhpcy5tPWQ7dGhpcy5xPTA7dGhpcy5pPTMxODUwNTcyfWc9SGUucHJvdG90eXBlO1xuZy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07Zy5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuan07Zy5CPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tO3JldHVybiBudWxsIT1hP2E6dGhpcy5tPWE9Y2ModGhpcyl9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBsYyh0aGlzLGIpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gTihILHRoaXMuail9O2cuUT1mdW5jdGlvbigpe3JldHVybiBGKHRoaXMuYmEpfTtnLlM9ZnVuY3Rpb24oKXt2YXIgYT1JKHRoaXMuYmEpO3JldHVybiBhP25ldyBIZSh0aGlzLmosYSx0aGlzLnBhLG51bGwpOm51bGw9PXRoaXMucGE/QmEodGhpcyk6bmV3IEhlKHRoaXMuaix0aGlzLnBhLG51bGwsbnVsbCl9O2cuSD1mdW5jdGlvbigpe3JldHVybiB0aGlzfTtnLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IEhlKGIsdGhpcy5iYSx0aGlzLnBhLHRoaXMubSl9O2cuRz1mdW5jdGlvbihhLGIpe3JldHVybiBNKGIsdGhpcyl9O1xuZnVuY3Rpb24gSWUoYSxiLGMsZCxlKXt0aGlzLmo9YTt0aGlzLmNvdW50PWI7dGhpcy5iYT1jO3RoaXMucGE9ZDt0aGlzLm09ZTt0aGlzLmk9MzE4NTg3NjY7dGhpcy5xPTgxOTJ9Zz1JZS5wcm90b3R5cGU7Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07Zy5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuan07Zy5MPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY291bnR9O2cuSWE9ZnVuY3Rpb24oKXtyZXR1cm4gRih0aGlzLmJhKX07Zy5KYT1mdW5jdGlvbigpe2lmKHIodGhpcy5iYSkpe3ZhciBhPUkodGhpcy5iYSk7cmV0dXJuIGE/bmV3IEllKHRoaXMuaix0aGlzLmNvdW50LTEsYSx0aGlzLnBhLG51bGwpOm5ldyBJZSh0aGlzLmosdGhpcy5jb3VudC0xLEUodGhpcy5wYSkscWUsbnVsbCl9cmV0dXJuIHRoaXN9O2cuQj1mdW5jdGlvbigpe3ZhciBhPXRoaXMubTtyZXR1cm4gbnVsbCE9YT9hOnRoaXMubT1hPWNjKHRoaXMpfTtcbmcudj1mdW5jdGlvbihhLGIpe3JldHVybiBsYyh0aGlzLGIpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gSmV9O2cuUT1mdW5jdGlvbigpe3JldHVybiBGKHRoaXMuYmEpfTtnLlM9ZnVuY3Rpb24oKXtyZXR1cm4gRyhFKHRoaXMpKX07Zy5IPWZ1bmN0aW9uKCl7dmFyIGE9RSh0aGlzLnBhKSxiPXRoaXMuYmE7cmV0dXJuIHIocihiKT9iOmEpP25ldyBIZShudWxsLHRoaXMuYmEsRShhKSxudWxsKTpudWxsfTtnLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IEllKGIsdGhpcy5jb3VudCx0aGlzLmJhLHRoaXMucGEsdGhpcy5tKX07Zy5HPWZ1bmN0aW9uKGEsYil7dmFyIGM7cih0aGlzLmJhKT8oYz10aGlzLnBhLGM9bmV3IEllKHRoaXMuaix0aGlzLmNvdW50KzEsdGhpcy5iYSxwYy5hKHIoYyk/YzpxZSxiKSxudWxsKSk6Yz1uZXcgSWUodGhpcy5qLHRoaXMuY291bnQrMSxwYy5hKHRoaXMuYmEsYikscWUsbnVsbCk7cmV0dXJuIGN9O3ZhciBKZT1uZXcgSWUobnVsbCwwLG51bGwscWUsMCk7XG5mdW5jdGlvbiBLZSgpe3RoaXMucT0wO3RoaXMuaT0yMDk3MTUyfUtlLnByb3RvdHlwZS52PWZ1bmN0aW9uKCl7cmV0dXJuITF9O3ZhciBMZT1uZXcgS2U7ZnVuY3Rpb24gTWUoYSxiKXtyZXR1cm4gTmMoR2MoYik/TyhhKT09PU8oYik/RGQoRmQsS2QuYShmdW5jdGlvbihhKXtyZXR1cm4gV2IuYShRLmMoYixGKGEpLExlKSxGKEkoYSkpKX0sYSkpOm51bGw6bnVsbCl9ZnVuY3Rpb24gTmUoYSl7dGhpcy5yPWF9TmUucHJvdG90eXBlLm5leHQ9ZnVuY3Rpb24oKXtpZihudWxsIT10aGlzLnIpe3ZhciBhPUYodGhpcy5yKTt0aGlzLnI9SSh0aGlzLnIpO3JldHVybntkb25lOiExLHZhbHVlOmF9fXJldHVybntkb25lOiEwLHZhbHVlOm51bGx9fTtmdW5jdGlvbiBPZShhKXtyZXR1cm4gbmV3IE5lKEUoYSkpfWZ1bmN0aW9uIFBlKGEpe3RoaXMucj1hfVxuUGUucHJvdG90eXBlLm5leHQ9ZnVuY3Rpb24oKXtpZihudWxsIT10aGlzLnIpe3ZhciBhPUYodGhpcy5yKSxiPVAuYyhhLDAsbnVsbCksYT1QLmMoYSwxLG51bGwpO3RoaXMucj1JKHRoaXMucik7cmV0dXJue2RvbmU6ITEsdmFsdWU6W2IsYV19fXJldHVybntkb25lOiEwLHZhbHVlOm51bGx9fTtmdW5jdGlvbiBRZShhKXtyZXR1cm4gbmV3IFBlKEUoYSkpfWZ1bmN0aW9uIFJlKGEpe3RoaXMucj1hfVJlLnByb3RvdHlwZS5uZXh0PWZ1bmN0aW9uKCl7aWYobnVsbCE9dGhpcy5yKXt2YXIgYT1GKHRoaXMucik7dGhpcy5yPUkodGhpcy5yKTtyZXR1cm57ZG9uZTohMSx2YWx1ZTpbYSxhXX19cmV0dXJue2RvbmU6ITAsdmFsdWU6bnVsbH19O2Z1bmN0aW9uIFNlKGEpe3JldHVybiBuZXcgUmUoRShhKSl9XG5mdW5jdGlvbiBUZShhLGIpe3ZhciBjPWEuZTtpZihiIGluc3RhbmNlb2YgVClhOntmb3IodmFyIGQ9Yy5sZW5ndGgsZT1iLnNhLGY9MDs7KXtpZihkPD1mKXtjPS0xO2JyZWFrIGF9dmFyIGg9Y1tmXTtpZihoIGluc3RhbmNlb2YgVCYmZT09PWguc2Epe2M9ZjticmVhayBhfWlmKHUpZis9MjtlbHNle2M9bnVsbDticmVhayBhfX1jPXZvaWQgMH1lbHNlIGlmKFwic3RyaW5nXCI9PXR5cGVvZiBifHxcIm51bWJlclwiPT09dHlwZW9mIGIpYTp7ZD1jLmxlbmd0aDtmb3IoZT0wOzspe2lmKGQ8PWUpe2M9LTE7YnJlYWsgYX1pZihiPT09Y1tlXSl7Yz1lO2JyZWFrIGF9aWYodSllKz0yO2Vsc2V7Yz1udWxsO2JyZWFrIGF9fWM9dm9pZCAwfWVsc2UgaWYoYiBpbnN0YW5jZW9mIFpiKWE6e2Q9Yy5sZW5ndGg7ZT1iLk5hO2ZvcihmPTA7Oyl7aWYoZDw9Zil7Yz0tMTticmVhayBhfWg9Y1tmXTtpZihoIGluc3RhbmNlb2YgWmImJmU9PT1oLk5hKXtjPWY7YnJlYWsgYX1pZih1KWYrPTI7ZWxzZXtjPW51bGw7XG5icmVhayBhfX1jPXZvaWQgMH1lbHNlIGlmKG51bGw9PWIpYTp7ZD1jLmxlbmd0aDtmb3IoZT0wOzspe2lmKGQ8PWUpe2M9LTE7YnJlYWsgYX1pZihudWxsPT1jW2VdKXtjPWU7YnJlYWsgYX1pZih1KWUrPTI7ZWxzZXtjPW51bGw7YnJlYWsgYX19Yz12b2lkIDB9ZWxzZSBpZih1KWE6e2Q9Yy5sZW5ndGg7Zm9yKGU9MDs7KXtpZihkPD1lKXtjPS0xO2JyZWFrIGF9aWYoV2IuYShiLGNbZV0pKXtjPWU7YnJlYWsgYX1pZih1KWUrPTI7ZWxzZXtjPW51bGw7YnJlYWsgYX19Yz12b2lkIDB9ZWxzZSBjPW51bGw7cmV0dXJuIGN9ZnVuY3Rpb24gVWUoYSxiLGMpe3RoaXMuZT1hO3RoaXMucD1iO3RoaXMuVz1jO3RoaXMucT0wO3RoaXMuaT0zMjM3NDk5MH1nPVVlLnByb3RvdHlwZTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIExiKHRoaXMpfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5XfTtcbmcuVT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnA8dGhpcy5lLmxlbmd0aC0yP25ldyBVZSh0aGlzLmUsdGhpcy5wKzIsdGhpcy5XKTpudWxsfTtnLkw9ZnVuY3Rpb24oKXtyZXR1cm4odGhpcy5lLmxlbmd0aC10aGlzLnApLzJ9O2cuQj1mdW5jdGlvbigpe3JldHVybiBjYyh0aGlzKX07Zy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGxjKHRoaXMsYil9O2cuST1mdW5jdGlvbigpe3JldHVybiBOKEgsdGhpcy5XKX07Zy5OPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5jLmEoYix0aGlzKX07Zy5NPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gbmMuYyhiLGMsdGhpcyl9O2cuUT1mdW5jdGlvbigpe3JldHVybiBuZXcgVyhudWxsLDIsNSxYLFt0aGlzLmVbdGhpcy5wXSx0aGlzLmVbdGhpcy5wKzFdXSxudWxsKX07Zy5TPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucDx0aGlzLmUubGVuZ3RoLTI/bmV3IFVlKHRoaXMuZSx0aGlzLnArMix0aGlzLlcpOkh9O2cuSD1mdW5jdGlvbigpe3JldHVybiB0aGlzfTtcbmcuRj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgVWUodGhpcy5lLHRoaXMucCxiKX07Zy5HPWZ1bmN0aW9uKGEsYil7cmV0dXJuIE0oYix0aGlzKX07ZnVuY3Rpb24gbGEoYSxiLGMsZCl7dGhpcy5qPWE7dGhpcy5nPWI7dGhpcy5lPWM7dGhpcy5tPWQ7dGhpcy5pPTE2NjQ3OTUxO3RoaXMucT04MTk2fWc9bGEucHJvdG90eXBlO2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O2cua2V5cz1mdW5jdGlvbigpe3JldHVybiBPZShWZS5iP1ZlLmIodGhpcyk6VmUuY2FsbChudWxsLHRoaXMpKX07Zy5lbnRyaWVzPWZ1bmN0aW9uKCl7cmV0dXJuIFFlKEUodGhpcykpfTtnLnZhbHVlcz1mdW5jdGlvbigpe3JldHVybiBPZShXZS5iP1dlLmIodGhpcyk6V2UuY2FsbChudWxsLHRoaXMpKX07Zy5oYXM9ZnVuY3Rpb24oYSl7cmV0dXJuIE9jKHRoaXMsYSl9O2cuZ2V0PWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnUobnVsbCxhKX07XG5nLmZvckVhY2g9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPUUodGhpcyksYz1udWxsLGQ9MCxlPTA7OylpZihlPGQpe3ZhciBmPWMuSihudWxsLGUpLGg9UC5jKGYsMCxudWxsKSxmPVAuYyhmLDEsbnVsbCk7YS5hP2EuYShmLGgpOmEuY2FsbChudWxsLGYsaCk7ZSs9MX1lbHNlIGlmKGI9RShiKSlJYyhiKT8oYz1IYihiKSxiPUliKGIpLGg9YyxkPU8oYyksYz1oKTooYz1GKGIpLGg9UC5jKGMsMCxudWxsKSxmPVAuYyhjLDEsbnVsbCksYS5hP2EuYShmLGgpOmEuY2FsbChudWxsLGYsaCksYj1JKGIpLGM9bnVsbCxkPTApLGU9MDtlbHNlIHJldHVybiBudWxsfTtnLnU9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTGEuYyh0aGlzLGIsbnVsbCl9O2cuQz1mdW5jdGlvbihhLGIsYyl7YT1UZSh0aGlzLGIpO3JldHVybi0xPT09YT9jOnRoaXMuZVthKzFdfTtcbmcuWmE9ZnVuY3Rpb24oYSxiLGMpe2E9dGhpcy5lLmxlbmd0aDtmb3IodmFyIGQ9MDs7KWlmKGQ8YSl7Yz1iLmM/Yi5jKGMsdGhpcy5lW2RdLHRoaXMuZVtkKzFdKTpiLmNhbGwobnVsbCxjLHRoaXMuZVtkXSx0aGlzLmVbZCsxXSk7aWYoZmMoYykpcmV0dXJuIEsuYj9LLmIoYyk6Sy5jYWxsKG51bGwsYyk7ZCs9Mn1lbHNlIHJldHVybiBjfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5qfTtnLkw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nfTtnLkI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm07cmV0dXJuIG51bGwhPWE/YTp0aGlzLm09YT1kYyh0aGlzKX07Zy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIE1lKHRoaXMsYil9O2cuV2E9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IFhlKHt9LHRoaXMuZS5sZW5ndGgsdmEodGhpcy5lKSl9O2cuST1mdW5jdGlvbigpe3JldHVybiBlYihZZSx0aGlzLmopfTtnLk49ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmMuYShiLHRoaXMpfTtcbmcuTT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIG5jLmMoYixjLHRoaXMpfTtnLm5iPWZ1bmN0aW9uKGEsYil7aWYoMDw9VGUodGhpcyxiKSl7dmFyIGM9dGhpcy5lLmxlbmd0aCxkPWMtMjtpZigwPT09ZClyZXR1cm4gQmEodGhpcyk7Zm9yKHZhciBkPUFycmF5KGQpLGU9MCxmPTA7Oyl7aWYoZT49YylyZXR1cm4gbmV3IGxhKHRoaXMuaix0aGlzLmctMSxkLG51bGwpO2lmKFdiLmEoYix0aGlzLmVbZV0pKWUrPTI7ZWxzZSBpZih1KWRbZl09dGhpcy5lW2VdLGRbZisxXT10aGlzLmVbZSsxXSxmKz0yLGUrPTI7ZWxzZSByZXR1cm4gbnVsbH19ZWxzZSByZXR1cm4gdGhpc307XG5nLnVhPWZ1bmN0aW9uKGEsYixjKXthPVRlKHRoaXMsYik7aWYoLTE9PT1hKXtpZih0aGlzLmc8WmUpe2E9dGhpcy5lO2Zvcih2YXIgZD1hLmxlbmd0aCxlPUFycmF5KGQrMiksZj0wOzspaWYoZjxkKWVbZl09YVtmXSxmKz0xO2Vsc2UgYnJlYWs7ZVtkXT1iO2VbZCsxXT1jO3JldHVybiBuZXcgbGEodGhpcy5qLHRoaXMuZysxLGUsbnVsbCl9cmV0dXJuIGViKE9hKFlkKCRlLHRoaXMpLGIsYyksdGhpcy5qKX1yZXR1cm4gYz09PXRoaXMuZVthKzFdP3RoaXM6dT8oYj12YSh0aGlzLmUpLGJbYSsxXT1jLG5ldyBsYSh0aGlzLmosdGhpcy5nLGIsbnVsbCkpOm51bGx9O2cua2I9ZnVuY3Rpb24oYSxiKXtyZXR1cm4tMSE9PVRlKHRoaXMsYil9O2cuSD1mdW5jdGlvbigpe3ZhciBhPXRoaXMuZTtyZXR1cm4gMDw9YS5sZW5ndGgtMj9uZXcgVWUoYSwwLG51bGwpOm51bGx9O2cuRj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgbGEoYix0aGlzLmcsdGhpcy5lLHRoaXMubSl9O1xuZy5HPWZ1bmN0aW9uKGEsYil7aWYoSGMoYikpcmV0dXJuIE9hKHRoaXMsRC5hKGIsMCksRC5hKGIsMSkpO2Zvcih2YXIgYz10aGlzLGQ9RShiKTs7KXtpZihudWxsPT1kKXJldHVybiBjO3ZhciBlPUYoZCk7aWYoSGMoZSkpYz1PYShjLEQuYShlLDApLEQuYShlLDEpKSxkPUkoZCk7ZWxzZSB0aHJvdyBFcnJvcihcImNvbmogb24gYSBtYXAgdGFrZXMgbWFwIGVudHJpZXMgb3Igc2VxYWJsZXMgb2YgbWFwIGVudHJpZXNcIik7fX07Zy5jYWxsPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbDtyZXR1cm4gYT1mdW5jdGlvbihhLGMsZCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gdGhpcy51KG51bGwsYyk7Y2FzZSAzOnJldHVybiB0aGlzLkMobnVsbCxjLGQpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fX0oKTtnLmFwcGx5PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuY2FsbC5hcHBseSh0aGlzLFt0aGlzXS5jb25jYXQodmEoYikpKX07XG5nLmI9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMudShudWxsLGEpfTtnLmE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5DKG51bGwsYSxiKX07dmFyIFllPW5ldyBsYShudWxsLDAsW10sbnVsbCksWmU9ODtmdW5jdGlvbiBhZihhKXtmb3IodmFyIGI9YS5sZW5ndGgsYz0wLGQ9eWIoWWUpOzspaWYoYzxiKXZhciBlPWMrMixkPUJiKGQsYVtjXSxhW2MrMV0pLGM9ZTtlbHNlIHJldHVybiBBYihkKX1mdW5jdGlvbiBYZShhLGIsYyl7dGhpcy5SYT1hO3RoaXMuamE9Yjt0aGlzLmU9Yzt0aGlzLnE9NTY7dGhpcy5pPTI1OH1nPVhlLnByb3RvdHlwZTtcbmcuQWI9ZnVuY3Rpb24oYSxiKXtpZihyKHRoaXMuUmEpKXt2YXIgYz1UZSh0aGlzLGIpOzA8PWMmJih0aGlzLmVbY109dGhpcy5lW3RoaXMuamEtMl0sdGhpcy5lW2MrMV09dGhpcy5lW3RoaXMuamEtMV0sYz10aGlzLmUsYy5wb3AoKSxjLnBvcCgpLHRoaXMuamEtPTIpO3JldHVybiB0aGlzfXRocm93IEVycm9yKFwiZGlzc29jISBhZnRlciBwZXJzaXN0ZW50IVwiKTt9O2cuY2I9ZnVuY3Rpb24oYSxiLGMpe2lmKHIodGhpcy5SYSkpe2E9VGUodGhpcyxiKTtpZigtMT09PWEpcmV0dXJuIHRoaXMuamErMjw9MipaZT8odGhpcy5qYSs9Mix0aGlzLmUucHVzaChiKSx0aGlzLmUucHVzaChjKSx0aGlzKTp4ZC5jKGJmLmE/YmYuYSh0aGlzLmphLHRoaXMuZSk6YmYuY2FsbChudWxsLHRoaXMuamEsdGhpcy5lKSxiLGMpO2MhPT10aGlzLmVbYSsxXSYmKHRoaXMuZVthKzFdPWMpO3JldHVybiB0aGlzfXRocm93IEVycm9yKFwiYXNzb2MhIGFmdGVyIHBlcnNpc3RlbnQhXCIpO307XG5nLkthPWZ1bmN0aW9uKGEsYil7aWYocih0aGlzLlJhKSl7aWYoYj9iLmkmMjA0OHx8Yi5kY3x8KGIuaT8wOnMoU2EsYikpOnMoU2EsYikpcmV0dXJuIEJiKHRoaXMsY2YuYj9jZi5iKGIpOmNmLmNhbGwobnVsbCxiKSxkZi5iP2RmLmIoYik6ZGYuY2FsbChudWxsLGIpKTtmb3IodmFyIGM9RShiKSxkPXRoaXM7Oyl7dmFyIGU9RihjKTtpZihyKGUpKWM9SShjKSxkPUJiKGQsY2YuYj9jZi5iKGUpOmNmLmNhbGwobnVsbCxlKSxkZi5iP2RmLmIoZSk6ZGYuY2FsbChudWxsLGUpKTtlbHNlIHJldHVybiBkfX1lbHNlIHRocm93IEVycm9yKFwiY29uaiEgYWZ0ZXIgcGVyc2lzdGVudCFcIik7fTtnLk9hPWZ1bmN0aW9uKCl7aWYocih0aGlzLlJhKSlyZXR1cm4gdGhpcy5SYT0hMSxuZXcgbGEobnVsbCxZYyh0aGlzLmphKSx0aGlzLmUsbnVsbCk7dGhyb3cgRXJyb3IoXCJwZXJzaXN0ZW50ISBjYWxsZWQgdHdpY2VcIik7fTtnLnU9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTGEuYyh0aGlzLGIsbnVsbCl9O1xuZy5DPWZ1bmN0aW9uKGEsYixjKXtpZihyKHRoaXMuUmEpKXJldHVybiBhPVRlKHRoaXMsYiksLTE9PT1hP2M6dGhpcy5lW2ErMV07dGhyb3cgRXJyb3IoXCJsb29rdXAgYWZ0ZXIgcGVyc2lzdGVudCFcIik7fTtnLkw9ZnVuY3Rpb24oKXtpZihyKHRoaXMuUmEpKXJldHVybiBZYyh0aGlzLmphKTt0aHJvdyBFcnJvcihcImNvdW50IGFmdGVyIHBlcnNpc3RlbnQhXCIpO307ZnVuY3Rpb24gYmYoYSxiKXtmb3IodmFyIGM9eWIoJGUpLGQ9MDs7KWlmKGQ8YSljPXhkLmMoYyxiW2RdLGJbZCsxXSksZCs9MjtlbHNlIHJldHVybiBjfWZ1bmN0aW9uIGVmKCl7dGhpcy5sPSExfWZ1bmN0aW9uIGZmKGEsYil7cmV0dXJuIGE9PT1iPyEwOmhkKGEsYik/ITA6dT9XYi5hKGEsYik6bnVsbH1cbnZhciBnZj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMsaCxrKXthPXZhKGEpO2FbYl09YzthW2hdPWs7cmV0dXJuIGF9ZnVuY3Rpb24gYihhLGIsYyl7YT12YShhKTthW2JdPWM7cmV0dXJuIGF9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSxmLGgsayl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMzpyZXR1cm4gYi5jYWxsKHRoaXMsYyxlLGYpO2Nhc2UgNTpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlLGYsaCxrKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5jPWI7Yy5zPWE7cmV0dXJuIGN9KCk7ZnVuY3Rpb24gaGYoYSxiKXt2YXIgYz1BcnJheShhLmxlbmd0aC0yKTtLYyhhLDAsYywwLDIqYik7S2MoYSwyKihiKzEpLGMsMipiLGMubGVuZ3RoLTIqYik7cmV0dXJuIGN9XG52YXIgamY9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjLGgsayxsKXthPWEuTGEoYik7YS5lW2NdPWg7YS5lW2tdPWw7cmV0dXJuIGF9ZnVuY3Rpb24gYihhLGIsYyxoKXthPWEuTGEoYik7YS5lW2NdPWg7cmV0dXJuIGF9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSxmLGgsayxsKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSA0OnJldHVybiBiLmNhbGwodGhpcyxjLGUsZixoKTtjYXNlIDY6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSxmLGgsayxsKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5uPWI7Yy5YPWE7cmV0dXJuIGN9KCk7XG5mdW5jdGlvbiBrZihhLGIsYyl7Zm9yKHZhciBkPWEubGVuZ3RoLGU9MDs7KWlmKGU8ZCl7dmFyIGY9YVtlXTtudWxsIT1mP2M9Yi5jP2IuYyhjLGYsYVtlKzFdKTpiLmNhbGwobnVsbCxjLGYsYVtlKzFdKTooZj1hW2UrMV0sYz1udWxsIT1mP2YuVGEoYixjKTpjKTtpZihmYyhjKSlyZXR1cm4gSy5iP0suYihjKTpLLmNhbGwobnVsbCxjKTtlKz0yfWVsc2UgcmV0dXJuIGN9ZnVuY3Rpb24gbGYoYSxiLGMpe3RoaXMudD1hO3RoaXMuQT1iO3RoaXMuZT1jfWc9bGYucHJvdG90eXBlO2cuTGE9ZnVuY3Rpb24oYSl7aWYoYT09PXRoaXMudClyZXR1cm4gdGhpczt2YXIgYj1aYyh0aGlzLkEpLGM9QXJyYXkoMD5iPzQ6MiooYisxKSk7S2ModGhpcy5lLDAsYywwLDIqYik7cmV0dXJuIG5ldyBsZihhLHRoaXMuQSxjKX07XG5nLmdiPWZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGY9MTw8KGM+Pj5iJjMxKTtpZigwPT09KHRoaXMuQSZmKSlyZXR1cm4gdGhpczt2YXIgaD1aYyh0aGlzLkEmZi0xKSxrPXRoaXMuZVsyKmhdLGw9dGhpcy5lWzIqaCsxXTtyZXR1cm4gbnVsbD09az8oYj1sLmdiKGEsYis1LGMsZCxlKSxiPT09bD90aGlzOm51bGwhPWI/amYubih0aGlzLGEsMipoKzEsYik6dGhpcy5BPT09Zj9udWxsOnU/bWYodGhpcyxhLGYsaCk6bnVsbCk6ZmYoZCxrKT8oZVswXT0hMCxtZih0aGlzLGEsZixoKSk6dT90aGlzOm51bGx9O2Z1bmN0aW9uIG1mKGEsYixjLGQpe2lmKGEuQT09PWMpcmV0dXJuIG51bGw7YT1hLkxhKGIpO2I9YS5lO3ZhciBlPWIubGVuZ3RoO2EuQV49YztLYyhiLDIqKGQrMSksYiwyKmQsZS0yKihkKzEpKTtiW2UtMl09bnVsbDtiW2UtMV09bnVsbDtyZXR1cm4gYX1nLmViPWZ1bmN0aW9uKCl7cmV0dXJuIG5mLmI/bmYuYih0aGlzLmUpOm5mLmNhbGwobnVsbCx0aGlzLmUpfTtcbmcuVGE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4ga2YodGhpcy5lLGEsYil9O2cuTWE9ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9MTw8KGI+Pj5hJjMxKTtpZigwPT09KHRoaXMuQSZlKSlyZXR1cm4gZDt2YXIgZj1aYyh0aGlzLkEmZS0xKSxlPXRoaXMuZVsyKmZdLGY9dGhpcy5lWzIqZisxXTtyZXR1cm4gbnVsbD09ZT9mLk1hKGErNSxiLGMsZCk6ZmYoYyxlKT9mOnU/ZDpudWxsfTtcbmcuaWE9ZnVuY3Rpb24oYSxiLGMsZCxlLGYpe3ZhciBoPTE8PChjPj4+YiYzMSksaz1aYyh0aGlzLkEmaC0xKTtpZigwPT09KHRoaXMuQSZoKSl7dmFyIGw9WmModGhpcy5BKTtpZigyKmw8dGhpcy5lLmxlbmd0aCl7YT10aGlzLkxhKGEpO2I9YS5lO2YubD0hMDthOmZvcihjPTIqKGwtayksZj0yKmsrKGMtMSksbD0yKihrKzEpKyhjLTEpOzspe2lmKDA9PT1jKWJyZWFrIGE7YltsXT1iW2ZdO2wtPTE7Yy09MTtmLT0xfWJbMiprXT1kO2JbMiprKzFdPWU7YS5BfD1oO3JldHVybiBhfWlmKDE2PD1sKXtrPVtudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGxdO2tbYz4+PmImMzFdPW9mLmlhKGEsYis1LGMsZCxlLGYpO2ZvcihlPWQ9MDs7KWlmKDMyPmQpMCE9PVxuKHRoaXMuQT4+PmQmMSkmJihrW2RdPW51bGwhPXRoaXMuZVtlXT9vZi5pYShhLGIrNSxUYih0aGlzLmVbZV0pLHRoaXMuZVtlXSx0aGlzLmVbZSsxXSxmKTp0aGlzLmVbZSsxXSxlKz0yKSxkKz0xO2Vsc2UgYnJlYWs7cmV0dXJuIG5ldyBwZihhLGwrMSxrKX1yZXR1cm4gdT8oYj1BcnJheSgyKihsKzQpKSxLYyh0aGlzLmUsMCxiLDAsMiprKSxiWzIqa109ZCxiWzIqaysxXT1lLEtjKHRoaXMuZSwyKmssYiwyKihrKzEpLDIqKGwtaykpLGYubD0hMCxhPXRoaXMuTGEoYSksYS5lPWIsYS5BfD1oLGEpOm51bGx9bD10aGlzLmVbMiprXTtoPXRoaXMuZVsyKmsrMV07cmV0dXJuIG51bGw9PWw/KGw9aC5pYShhLGIrNSxjLGQsZSxmKSxsPT09aD90aGlzOmpmLm4odGhpcyxhLDIqaysxLGwpKTpmZihkLGwpP2U9PT1oP3RoaXM6amYubih0aGlzLGEsMiprKzEsZSk6dT8oZi5sPSEwLGpmLlgodGhpcyxhLDIqayxudWxsLDIqaysxLHFmLmdhP3FmLmdhKGEsYis1LGwsaCxjLGQsZSk6cWYuY2FsbChudWxsLFxuYSxiKzUsbCxoLGMsZCxlKSkpOm51bGx9O1xuZy5oYT1mdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmPTE8PChiPj4+YSYzMSksaD1aYyh0aGlzLkEmZi0xKTtpZigwPT09KHRoaXMuQSZmKSl7dmFyIGs9WmModGhpcy5BKTtpZigxNjw9ayl7aD1bbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsXTtoW2I+Pj5hJjMxXT1vZi5oYShhKzUsYixjLGQsZSk7Zm9yKGQ9Yz0wOzspaWYoMzI+YykwIT09KHRoaXMuQT4+PmMmMSkmJihoW2NdPW51bGwhPXRoaXMuZVtkXT9vZi5oYShhKzUsVGIodGhpcy5lW2RdKSx0aGlzLmVbZF0sdGhpcy5lW2QrMV0sZSk6dGhpcy5lW2QrMV0sZCs9MiksYys9MTtlbHNlIGJyZWFrO3JldHVybiBuZXcgcGYobnVsbCxrKzEsaCl9YT1BcnJheSgyKihrKzEpKTtLYyh0aGlzLmUsXG4wLGEsMCwyKmgpO2FbMipoXT1jO2FbMipoKzFdPWQ7S2ModGhpcy5lLDIqaCxhLDIqKGgrMSksMiooay1oKSk7ZS5sPSEwO3JldHVybiBuZXcgbGYobnVsbCx0aGlzLkF8ZixhKX1rPXRoaXMuZVsyKmhdO2Y9dGhpcy5lWzIqaCsxXTtyZXR1cm4gbnVsbD09az8oaz1mLmhhKGErNSxiLGMsZCxlKSxrPT09Zj90aGlzOm5ldyBsZihudWxsLHRoaXMuQSxnZi5jKHRoaXMuZSwyKmgrMSxrKSkpOmZmKGMsayk/ZD09PWY/dGhpczpuZXcgbGYobnVsbCx0aGlzLkEsZ2YuYyh0aGlzLmUsMipoKzEsZCkpOnU/KGUubD0hMCxuZXcgbGYobnVsbCx0aGlzLkEsZ2Yucyh0aGlzLmUsMipoLG51bGwsMipoKzEscWYuWD9xZi5YKGErNSxrLGYsYixjLGQpOnFmLmNhbGwobnVsbCxhKzUsayxmLGIsYyxkKSkpKTpudWxsfTtcbmcuZmI9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPTE8PChiPj4+YSYzMSk7aWYoMD09PSh0aGlzLkEmZCkpcmV0dXJuIHRoaXM7dmFyIGU9WmModGhpcy5BJmQtMSksZj10aGlzLmVbMiplXSxoPXRoaXMuZVsyKmUrMV07cmV0dXJuIG51bGw9PWY/KGE9aC5mYihhKzUsYixjKSxhPT09aD90aGlzOm51bGwhPWE/bmV3IGxmKG51bGwsdGhpcy5BLGdmLmModGhpcy5lLDIqZSsxLGEpKTp0aGlzLkE9PT1kP251bGw6dT9uZXcgbGYobnVsbCx0aGlzLkFeZCxoZih0aGlzLmUsZSkpOm51bGwpOmZmKGMsZik/bmV3IGxmKG51bGwsdGhpcy5BXmQsaGYodGhpcy5lLGUpKTp1P3RoaXM6bnVsbH07dmFyIG9mPW5ldyBsZihudWxsLDAsW10pO1xuZnVuY3Rpb24gcmYoYSxiLGMpe3ZhciBkPWEuZTthPTIqKGEuZy0xKTtmb3IodmFyIGU9QXJyYXkoYSksZj0wLGg9MSxrPTA7OylpZihmPGEpZiE9PWMmJm51bGwhPWRbZl0mJihlW2hdPWRbZl0saCs9MixrfD0xPDxmKSxmKz0xO2Vsc2UgcmV0dXJuIG5ldyBsZihiLGssZSl9ZnVuY3Rpb24gcGYoYSxiLGMpe3RoaXMudD1hO3RoaXMuZz1iO3RoaXMuZT1jfWc9cGYucHJvdG90eXBlO2cuTGE9ZnVuY3Rpb24oYSl7cmV0dXJuIGE9PT10aGlzLnQ/dGhpczpuZXcgcGYoYSx0aGlzLmcsdmEodGhpcy5lKSl9O1xuZy5nYj1mdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmPWM+Pj5iJjMxLGg9dGhpcy5lW2ZdO2lmKG51bGw9PWgpcmV0dXJuIHRoaXM7Yj1oLmdiKGEsYis1LGMsZCxlKTtpZihiPT09aClyZXR1cm4gdGhpcztpZihudWxsPT1iKXtpZig4Pj10aGlzLmcpcmV0dXJuIHJmKHRoaXMsYSxmKTthPWpmLm4odGhpcyxhLGYsYik7YS5nLT0xO3JldHVybiBhfXJldHVybiB1P2pmLm4odGhpcyxhLGYsYik6bnVsbH07Zy5lYj1mdW5jdGlvbigpe3JldHVybiBzZi5iP3NmLmIodGhpcy5lKTpzZi5jYWxsKG51bGwsdGhpcy5lKX07Zy5UYT1mdW5jdGlvbihhLGIpe2Zvcih2YXIgYz10aGlzLmUubGVuZ3RoLGQ9MCxlPWI7OylpZihkPGMpe3ZhciBmPXRoaXMuZVtkXTtpZihudWxsIT1mJiYoZT1mLlRhKGEsZSksZmMoZSkpKXJldHVybiBLLmI/Sy5iKGUpOksuY2FsbChudWxsLGUpO2QrPTF9ZWxzZSByZXR1cm4gZX07XG5nLk1hPWZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPXRoaXMuZVtiPj4+YSYzMV07cmV0dXJuIG51bGwhPWU/ZS5NYShhKzUsYixjLGQpOmR9O2cuaWE9ZnVuY3Rpb24oYSxiLGMsZCxlLGYpe3ZhciBoPWM+Pj5iJjMxLGs9dGhpcy5lW2hdO2lmKG51bGw9PWspcmV0dXJuIGE9amYubih0aGlzLGEsaCxvZi5pYShhLGIrNSxjLGQsZSxmKSksYS5nKz0xLGE7Yj1rLmlhKGEsYis1LGMsZCxlLGYpO3JldHVybiBiPT09az90aGlzOmpmLm4odGhpcyxhLGgsYil9O2cuaGE9ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZj1iPj4+YSYzMSxoPXRoaXMuZVtmXTtpZihudWxsPT1oKXJldHVybiBuZXcgcGYobnVsbCx0aGlzLmcrMSxnZi5jKHRoaXMuZSxmLG9mLmhhKGErNSxiLGMsZCxlKSkpO2E9aC5oYShhKzUsYixjLGQsZSk7cmV0dXJuIGE9PT1oP3RoaXM6bmV3IHBmKG51bGwsdGhpcy5nLGdmLmModGhpcy5lLGYsYSkpfTtcbmcuZmI9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWI+Pj5hJjMxLGU9dGhpcy5lW2RdO3JldHVybiBudWxsIT1lPyhhPWUuZmIoYSs1LGIsYyksYT09PWU/dGhpczpudWxsPT1hPzg+PXRoaXMuZz9yZih0aGlzLG51bGwsZCk6bmV3IHBmKG51bGwsdGhpcy5nLTEsZ2YuYyh0aGlzLmUsZCxhKSk6dT9uZXcgcGYobnVsbCx0aGlzLmcsZ2YuYyh0aGlzLmUsZCxhKSk6bnVsbCk6dGhpc307ZnVuY3Rpb24gdGYoYSxiLGMpe2IqPTI7Zm9yKHZhciBkPTA7OylpZihkPGIpe2lmKGZmKGMsYVtkXSkpcmV0dXJuIGQ7ZCs9Mn1lbHNlIHJldHVybi0xfWZ1bmN0aW9uIHVmKGEsYixjLGQpe3RoaXMudD1hO3RoaXMucmE9Yjt0aGlzLmc9Yzt0aGlzLmU9ZH1nPXVmLnByb3RvdHlwZTtcbmcuTGE9ZnVuY3Rpb24oYSl7aWYoYT09PXRoaXMudClyZXR1cm4gdGhpczt2YXIgYj1BcnJheSgyKih0aGlzLmcrMSkpO0tjKHRoaXMuZSwwLGIsMCwyKnRoaXMuZyk7cmV0dXJuIG5ldyB1ZihhLHRoaXMucmEsdGhpcy5nLGIpfTtnLmdiPWZ1bmN0aW9uKGEsYixjLGQsZSl7Yj10Zih0aGlzLmUsdGhpcy5nLGQpO2lmKC0xPT09YilyZXR1cm4gdGhpcztlWzBdPSEwO2lmKDE9PT10aGlzLmcpcmV0dXJuIG51bGw7YT10aGlzLkxhKGEpO2U9YS5lO2VbYl09ZVsyKnRoaXMuZy0yXTtlW2IrMV09ZVsyKnRoaXMuZy0xXTtlWzIqdGhpcy5nLTFdPW51bGw7ZVsyKnRoaXMuZy0yXT1udWxsO2EuZy09MTtyZXR1cm4gYX07Zy5lYj1mdW5jdGlvbigpe3JldHVybiBuZi5iP25mLmIodGhpcy5lKTpuZi5jYWxsKG51bGwsdGhpcy5lKX07Zy5UYT1mdW5jdGlvbihhLGIpe3JldHVybiBrZih0aGlzLmUsYSxiKX07XG5nLk1hPWZ1bmN0aW9uKGEsYixjLGQpe2E9dGYodGhpcy5lLHRoaXMuZyxjKTtyZXR1cm4gMD5hP2Q6ZmYoYyx0aGlzLmVbYV0pP3RoaXMuZVthKzFdOnU/ZDpudWxsfTtcbmcuaWE9ZnVuY3Rpb24oYSxiLGMsZCxlLGYpe2lmKGM9PT10aGlzLnJhKXtiPXRmKHRoaXMuZSx0aGlzLmcsZCk7aWYoLTE9PT1iKXtpZih0aGlzLmUubGVuZ3RoPjIqdGhpcy5nKXJldHVybiBhPWpmLlgodGhpcyxhLDIqdGhpcy5nLGQsMip0aGlzLmcrMSxlKSxmLmw9ITAsYS5nKz0xLGE7Yz10aGlzLmUubGVuZ3RoO2I9QXJyYXkoYysyKTtLYyh0aGlzLmUsMCxiLDAsYyk7YltjXT1kO2JbYysxXT1lO2YubD0hMDtmPXRoaXMuZysxO2E9PT10aGlzLnQ/KHRoaXMuZT1iLHRoaXMuZz1mLGE9dGhpcyk6YT1uZXcgdWYodGhpcy50LHRoaXMucmEsZixiKTtyZXR1cm4gYX1yZXR1cm4gdGhpcy5lW2IrMV09PT1lP3RoaXM6amYubih0aGlzLGEsYisxLGUpfXJldHVybihuZXcgbGYoYSwxPDwodGhpcy5yYT4+PmImMzEpLFtudWxsLHRoaXMsbnVsbCxudWxsXSkpLmlhKGEsYixjLGQsZSxmKX07XG5nLmhhPWZ1bmN0aW9uKGEsYixjLGQsZSl7cmV0dXJuIGI9PT10aGlzLnJhPyhhPXRmKHRoaXMuZSx0aGlzLmcsYyksLTE9PT1hPyhhPTIqdGhpcy5nLGI9QXJyYXkoYSsyKSxLYyh0aGlzLmUsMCxiLDAsYSksYlthXT1jLGJbYSsxXT1kLGUubD0hMCxuZXcgdWYobnVsbCx0aGlzLnJhLHRoaXMuZysxLGIpKTpXYi5hKHRoaXMuZVthXSxkKT90aGlzOm5ldyB1ZihudWxsLHRoaXMucmEsdGhpcy5nLGdmLmModGhpcy5lLGErMSxkKSkpOihuZXcgbGYobnVsbCwxPDwodGhpcy5yYT4+PmEmMzEpLFtudWxsLHRoaXNdKSkuaGEoYSxiLGMsZCxlKX07Zy5mYj1mdW5jdGlvbihhLGIsYyl7YT10Zih0aGlzLmUsdGhpcy5nLGMpO3JldHVybi0xPT09YT90aGlzOjE9PT10aGlzLmc/bnVsbDp1P25ldyB1ZihudWxsLHRoaXMucmEsdGhpcy5nLTEsaGYodGhpcy5lLFljKGEpKSk6bnVsbH07XG52YXIgcWY9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjLGgsayxsLG4pe3ZhciBxPVRiKGMpO2lmKHE9PT1rKXJldHVybiBuZXcgdWYobnVsbCxxLDIsW2MsaCxsLG5dKTt2YXIgdD1uZXcgZWY7cmV0dXJuIG9mLmlhKGEsYixxLGMsaCx0KS5pYShhLGIsayxsLG4sdCl9ZnVuY3Rpb24gYihhLGIsYyxoLGssbCl7dmFyIG49VGIoYik7aWYobj09PWgpcmV0dXJuIG5ldyB1ZihudWxsLG4sMixbYixjLGssbF0pO3ZhciBxPW5ldyBlZjtyZXR1cm4gb2YuaGEoYSxuLGIsYyxxKS5oYShhLGgsayxsLHEpfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUsZixoLGssbCxuKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSA2OnJldHVybiBiLmNhbGwodGhpcyxjLGUsZixoLGssbCk7Y2FzZSA3OnJldHVybiBhLmNhbGwodGhpcyxjLGUsZixoLGssbCxuKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5YPWI7Yy5nYT1hO3JldHVybiBjfSgpO1xuZnVuY3Rpb24gdmYoYSxiLGMsZCxlKXt0aGlzLmo9YTt0aGlzLmthPWI7dGhpcy5wPWM7dGhpcy5yPWQ7dGhpcy5tPWU7dGhpcy5xPTA7dGhpcy5pPTMyMzc0ODYwfWc9dmYucHJvdG90eXBlO2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O2cuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmp9O2cuQj1mdW5jdGlvbigpe3ZhciBhPXRoaXMubTtyZXR1cm4gbnVsbCE9YT9hOnRoaXMubT1hPWNjKHRoaXMpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbGModGhpcyxiKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIE4oSCx0aGlzLmopfTtnLk49ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmMuYShiLHRoaXMpfTtnLk09ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBuYy5jKGIsYyx0aGlzKX07Zy5RPWZ1bmN0aW9uKCl7cmV0dXJuIG51bGw9PXRoaXMucj9uZXcgVyhudWxsLDIsNSxYLFt0aGlzLmthW3RoaXMucF0sdGhpcy5rYVt0aGlzLnArMV1dLG51bGwpOkYodGhpcy5yKX07XG5nLlM9ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbD09dGhpcy5yP25mLmM/bmYuYyh0aGlzLmthLHRoaXMucCsyLG51bGwpOm5mLmNhbGwobnVsbCx0aGlzLmthLHRoaXMucCsyLG51bGwpOm5mLmM/bmYuYyh0aGlzLmthLHRoaXMucCxJKHRoaXMucikpOm5mLmNhbGwobnVsbCx0aGlzLmthLHRoaXMucCxJKHRoaXMucikpfTtnLkg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc307Zy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyB2ZihiLHRoaXMua2EsdGhpcy5wLHRoaXMucix0aGlzLm0pfTtnLkc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTShiLHRoaXMpfTtcbnZhciBuZj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMpe2lmKG51bGw9PWMpZm9yKGM9YS5sZW5ndGg7OylpZihiPGMpe2lmKG51bGwhPWFbYl0pcmV0dXJuIG5ldyB2ZihudWxsLGEsYixudWxsLG51bGwpO3ZhciBoPWFbYisxXTtpZihyKGgpJiYoaD1oLmViKCkscihoKSkpcmV0dXJuIG5ldyB2ZihudWxsLGEsYisyLGgsbnVsbCk7Yis9Mn1lbHNlIHJldHVybiBudWxsO2Vsc2UgcmV0dXJuIG5ldyB2ZihudWxsLGEsYixjLG51bGwpfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIGMuYyhhLDAsbnVsbCl9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBiLmNhbGwodGhpcyxjKTtjYXNlIDM6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSxmKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5iPWI7Yy5jPWE7cmV0dXJuIGN9KCk7XG5mdW5jdGlvbiB3ZihhLGIsYyxkLGUpe3RoaXMuaj1hO3RoaXMua2E9Yjt0aGlzLnA9Yzt0aGlzLnI9ZDt0aGlzLm09ZTt0aGlzLnE9MDt0aGlzLmk9MzIzNzQ4NjB9Zz13Zi5wcm90b3R5cGU7Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07Zy5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuan07Zy5CPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tO3JldHVybiBudWxsIT1hP2E6dGhpcy5tPWE9Y2ModGhpcyl9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBsYyh0aGlzLGIpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gTihILHRoaXMuail9O2cuTj1mdW5jdGlvbihhLGIpe3JldHVybiBuYy5hKGIsdGhpcyl9O2cuTT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIG5jLmMoYixjLHRoaXMpfTtnLlE9ZnVuY3Rpb24oKXtyZXR1cm4gRih0aGlzLnIpfTtcbmcuUz1mdW5jdGlvbigpe3JldHVybiBzZi5uP3NmLm4obnVsbCx0aGlzLmthLHRoaXMucCxJKHRoaXMucikpOnNmLmNhbGwobnVsbCxudWxsLHRoaXMua2EsdGhpcy5wLEkodGhpcy5yKSl9O2cuSD1mdW5jdGlvbigpe3JldHVybiB0aGlzfTtnLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IHdmKGIsdGhpcy5rYSx0aGlzLnAsdGhpcy5yLHRoaXMubSl9O2cuRz1mdW5jdGlvbihhLGIpe3JldHVybiBNKGIsdGhpcyl9O1xudmFyIHNmPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyxoKXtpZihudWxsPT1oKWZvcihoPWIubGVuZ3RoOzspaWYoYzxoKXt2YXIgaz1iW2NdO2lmKHIoaykmJihrPWsuZWIoKSxyKGspKSlyZXR1cm4gbmV3IHdmKGEsYixjKzEsayxudWxsKTtjKz0xfWVsc2UgcmV0dXJuIG51bGw7ZWxzZSByZXR1cm4gbmV3IHdmKGEsYixjLGgsbnVsbCl9ZnVuY3Rpb24gYihhKXtyZXR1cm4gYy5uKG51bGwsYSwwLG51bGwpfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUsZixoKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBiLmNhbGwodGhpcyxjKTtjYXNlIDQ6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSxmLGgpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmI9YjtjLm49YTtyZXR1cm4gY30oKTtcbmZ1bmN0aW9uIHhmKGEsYixjLGQsZSxmKXt0aGlzLmo9YTt0aGlzLmc9Yjt0aGlzLnJvb3Q9Yzt0aGlzLlQ9ZDt0aGlzLlk9ZTt0aGlzLm09Zjt0aGlzLmk9MTYxMjM2NjM7dGhpcy5xPTgxOTZ9Zz14Zi5wcm90b3R5cGU7Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07Zy5rZXlzPWZ1bmN0aW9uKCl7cmV0dXJuIE9lKFZlLmI/VmUuYih0aGlzKTpWZS5jYWxsKG51bGwsdGhpcykpfTtnLmVudHJpZXM9ZnVuY3Rpb24oKXtyZXR1cm4gUWUoRSh0aGlzKSl9O2cudmFsdWVzPWZ1bmN0aW9uKCl7cmV0dXJuIE9lKFdlLmI/V2UuYih0aGlzKTpXZS5jYWxsKG51bGwsdGhpcykpfTtnLmhhcz1mdW5jdGlvbihhKXtyZXR1cm4gT2ModGhpcyxhKX07Zy5nZXQ9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMudShudWxsLGEpfTtcbmcuZm9yRWFjaD1mdW5jdGlvbihhKXtmb3IodmFyIGI9RSh0aGlzKSxjPW51bGwsZD0wLGU9MDs7KWlmKGU8ZCl7dmFyIGY9Yy5KKG51bGwsZSksaD1QLmMoZiwwLG51bGwpLGY9UC5jKGYsMSxudWxsKTthLmE/YS5hKGYsaCk6YS5jYWxsKG51bGwsZixoKTtlKz0xfWVsc2UgaWYoYj1FKGIpKUljKGIpPyhjPUhiKGIpLGI9SWIoYiksaD1jLGQ9TyhjKSxjPWgpOihjPUYoYiksaD1QLmMoYywwLG51bGwpLGY9UC5jKGMsMSxudWxsKSxhLmE/YS5hKGYsaCk6YS5jYWxsKG51bGwsZixoKSxiPUkoYiksYz1udWxsLGQ9MCksZT0wO2Vsc2UgcmV0dXJuIG51bGx9O2cudT1mdW5jdGlvbihhLGIpe3JldHVybiBMYS5jKHRoaXMsYixudWxsKX07Zy5DPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gbnVsbD09Yj90aGlzLlQ/dGhpcy5ZOmM6bnVsbD09dGhpcy5yb290P2M6dT90aGlzLnJvb3QuTWEoMCxUYihiKSxiLGMpOm51bGx9O1xuZy5aYT1mdW5jdGlvbihhLGIsYyl7YT10aGlzLlQ/Yi5jP2IuYyhjLG51bGwsdGhpcy5ZKTpiLmNhbGwobnVsbCxjLG51bGwsdGhpcy5ZKTpjO3JldHVybiBmYyhhKT9LLmI/Sy5iKGEpOksuY2FsbChudWxsLGEpOm51bGwhPXRoaXMucm9vdD90aGlzLnJvb3QuVGEoYixhKTp1P2E6bnVsbH07Zy5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuan07Zy5MPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ307Zy5CPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tO3JldHVybiBudWxsIT1hP2E6dGhpcy5tPWE9ZGModGhpcyl9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBNZSh0aGlzLGIpfTtnLldhPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyB5Zih7fSx0aGlzLnJvb3QsdGhpcy5nLHRoaXMuVCx0aGlzLlkpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gZWIoJGUsdGhpcy5qKX07XG5nLm5iPWZ1bmN0aW9uKGEsYil7aWYobnVsbD09YilyZXR1cm4gdGhpcy5UP25ldyB4Zih0aGlzLmosdGhpcy5nLTEsdGhpcy5yb290LCExLG51bGwsbnVsbCk6dGhpcztpZihudWxsPT10aGlzLnJvb3QpcmV0dXJuIHRoaXM7aWYodSl7dmFyIGM9dGhpcy5yb290LmZiKDAsVGIoYiksYik7cmV0dXJuIGM9PT10aGlzLnJvb3Q/dGhpczpuZXcgeGYodGhpcy5qLHRoaXMuZy0xLGMsdGhpcy5ULHRoaXMuWSxudWxsKX1yZXR1cm4gbnVsbH07XG5nLnVhPWZ1bmN0aW9uKGEsYixjKXtpZihudWxsPT1iKXJldHVybiB0aGlzLlQmJmM9PT10aGlzLlk/dGhpczpuZXcgeGYodGhpcy5qLHRoaXMuVD90aGlzLmc6dGhpcy5nKzEsdGhpcy5yb290LCEwLGMsbnVsbCk7YT1uZXcgZWY7Yj0obnVsbD09dGhpcy5yb290P29mOnRoaXMucm9vdCkuaGEoMCxUYihiKSxiLGMsYSk7cmV0dXJuIGI9PT10aGlzLnJvb3Q/dGhpczpuZXcgeGYodGhpcy5qLGEubD90aGlzLmcrMTp0aGlzLmcsYix0aGlzLlQsdGhpcy5ZLG51bGwpfTtnLmtiPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG51bGw9PWI/dGhpcy5UOm51bGw9PXRoaXMucm9vdD8hMTp1P3RoaXMucm9vdC5NYSgwLFRiKGIpLGIsTGMpIT09TGM6bnVsbH07Zy5IPWZ1bmN0aW9uKCl7aWYoMDx0aGlzLmcpe3ZhciBhPW51bGwhPXRoaXMucm9vdD90aGlzLnJvb3QuZWIoKTpudWxsO3JldHVybiB0aGlzLlQ/TShuZXcgVyhudWxsLDIsNSxYLFtudWxsLHRoaXMuWV0sbnVsbCksYSk6YX1yZXR1cm4gbnVsbH07XG5nLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IHhmKGIsdGhpcy5nLHRoaXMucm9vdCx0aGlzLlQsdGhpcy5ZLHRoaXMubSl9O2cuRz1mdW5jdGlvbihhLGIpe2lmKEhjKGIpKXJldHVybiBPYSh0aGlzLEQuYShiLDApLEQuYShiLDEpKTtmb3IodmFyIGM9dGhpcyxkPUUoYik7Oyl7aWYobnVsbD09ZClyZXR1cm4gYzt2YXIgZT1GKGQpO2lmKEhjKGUpKWM9T2EoYyxELmEoZSwwKSxELmEoZSwxKSksZD1JKGQpO2Vsc2UgdGhyb3cgRXJyb3IoXCJjb25qIG9uIGEgbWFwIHRha2VzIG1hcCBlbnRyaWVzIG9yIHNlcWFibGVzIG9mIG1hcCBlbnRyaWVzXCIpO319O1xuZy5jYWxsPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbDtyZXR1cm4gYT1mdW5jdGlvbihhLGMsZCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gdGhpcy51KG51bGwsYyk7Y2FzZSAzOnJldHVybiB0aGlzLkMobnVsbCxjLGQpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fX0oKTtnLmFwcGx5PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuY2FsbC5hcHBseSh0aGlzLFt0aGlzXS5jb25jYXQodmEoYikpKX07Zy5iPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnUobnVsbCxhKX07Zy5hPWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuQyhudWxsLGEsYil9O3ZhciAkZT1uZXcgeGYobnVsbCwwLG51bGwsITEsbnVsbCwwKTtmdW5jdGlvbiBzYyhhLGIpe2Zvcih2YXIgYz1hLmxlbmd0aCxkPTAsZT15YigkZSk7OylpZihkPGMpdmFyIGY9ZCsxLGU9ZS5jYihudWxsLGFbZF0sYltkXSksZD1mO2Vsc2UgcmV0dXJuIEFiKGUpfVxuZnVuY3Rpb24geWYoYSxiLGMsZCxlKXt0aGlzLnQ9YTt0aGlzLnJvb3Q9Yjt0aGlzLmNvdW50PWM7dGhpcy5UPWQ7dGhpcy5ZPWU7dGhpcy5xPTU2O3RoaXMuaT0yNTh9Zz15Zi5wcm90b3R5cGU7Zy5BYj1mdW5jdGlvbihhLGIpe2lmKHRoaXMudClpZihudWxsPT1iKXRoaXMuVCYmKHRoaXMuVD0hMSx0aGlzLlk9bnVsbCx0aGlzLmNvdW50LT0xKTtlbHNle2lmKG51bGwhPXRoaXMucm9vdCl7dmFyIGM9bmV3IGVmLGQ9dGhpcy5yb290LmdiKHRoaXMudCwwLFRiKGIpLGIsYyk7ZCE9PXRoaXMucm9vdCYmKHRoaXMucm9vdD1kKTtyKGNbMF0pJiYodGhpcy5jb3VudC09MSl9fWVsc2UgdGhyb3cgRXJyb3IoXCJkaXNzb2MhIGFmdGVyIHBlcnNpc3RlbnQhXCIpO3JldHVybiB0aGlzfTtnLmNiPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gemYodGhpcyxiLGMpfTtcbmcuS2E9ZnVuY3Rpb24oYSxiKXt2YXIgYzthOntpZih0aGlzLnQpe2lmKGI/Yi5pJjIwNDh8fGIuZGN8fChiLmk/MDpzKFNhLGIpKTpzKFNhLGIpKXtjPXpmKHRoaXMsY2YuYj9jZi5iKGIpOmNmLmNhbGwobnVsbCxiKSxkZi5iP2RmLmIoYik6ZGYuY2FsbChudWxsLGIpKTticmVhayBhfWM9RShiKTtmb3IodmFyIGQ9dGhpczs7KXt2YXIgZT1GKGMpO2lmKHIoZSkpYz1JKGMpLGQ9emYoZCxjZi5iP2NmLmIoZSk6Y2YuY2FsbChudWxsLGUpLGRmLmI/ZGYuYihlKTpkZi5jYWxsKG51bGwsZSkpO2Vsc2V7Yz1kO2JyZWFrIGF9fX1lbHNlIHRocm93IEVycm9yKFwiY29uaiEgYWZ0ZXIgcGVyc2lzdGVudFwiKTtjPXZvaWQgMH1yZXR1cm4gY307XG5nLk9hPWZ1bmN0aW9uKCl7dmFyIGE7aWYodGhpcy50KXRoaXMudD1udWxsLGE9bmV3IHhmKG51bGwsdGhpcy5jb3VudCx0aGlzLnJvb3QsdGhpcy5ULHRoaXMuWSxudWxsKTtlbHNlIHRocm93IEVycm9yKFwicGVyc2lzdGVudCEgY2FsbGVkIHR3aWNlXCIpO3JldHVybiBhfTtnLnU9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbnVsbD09Yj90aGlzLlQ/dGhpcy5ZOm51bGw6bnVsbD09dGhpcy5yb290P251bGw6dGhpcy5yb290Lk1hKDAsVGIoYiksYil9O2cuQz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIG51bGw9PWI/dGhpcy5UP3RoaXMuWTpjOm51bGw9PXRoaXMucm9vdD9jOnRoaXMucm9vdC5NYSgwLFRiKGIpLGIsYyl9O2cuTD1mdW5jdGlvbigpe2lmKHRoaXMudClyZXR1cm4gdGhpcy5jb3VudDt0aHJvdyBFcnJvcihcImNvdW50IGFmdGVyIHBlcnNpc3RlbnQhXCIpO307XG5mdW5jdGlvbiB6ZihhLGIsYyl7aWYoYS50KXtpZihudWxsPT1iKWEuWSE9PWMmJihhLlk9YyksYS5UfHwoYS5jb3VudCs9MSxhLlQ9ITApO2Vsc2V7dmFyIGQ9bmV3IGVmO2I9KG51bGw9PWEucm9vdD9vZjphLnJvb3QpLmlhKGEudCwwLFRiKGIpLGIsYyxkKTtiIT09YS5yb290JiYoYS5yb290PWIpO2QubCYmKGEuY291bnQrPTEpfXJldHVybiBhfXRocm93IEVycm9yKFwiYXNzb2MhIGFmdGVyIHBlcnNpc3RlbnQhXCIpO31mdW5jdGlvbiBBZihhLGIsYyl7Zm9yKHZhciBkPWI7OylpZihudWxsIT1hKWI9Yz9hLmxlZnQ6YS5yaWdodCxkPXBjLmEoZCxhKSxhPWI7ZWxzZSByZXR1cm4gZH1mdW5jdGlvbiBCZihhLGIsYyxkLGUpe3RoaXMuaj1hO3RoaXMuc3RhY2s9Yjt0aGlzLmliPWM7dGhpcy5nPWQ7dGhpcy5tPWU7dGhpcy5xPTA7dGhpcy5pPTMyMzc0ODYyfWc9QmYucHJvdG90eXBlO2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O2cuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmp9O1xuZy5MPWZ1bmN0aW9uKCl7cmV0dXJuIDA+dGhpcy5nP08oSSh0aGlzKSkrMTp0aGlzLmd9O2cuQj1mdW5jdGlvbigpe3ZhciBhPXRoaXMubTtyZXR1cm4gbnVsbCE9YT9hOnRoaXMubT1hPWNjKHRoaXMpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbGModGhpcyxiKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIE4oSCx0aGlzLmopfTtnLk49ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmMuYShiLHRoaXMpfTtnLk09ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBuYy5jKGIsYyx0aGlzKX07Zy5RPWZ1bmN0aW9uKCl7cmV0dXJuIHljKHRoaXMuc3RhY2spfTtnLlM9ZnVuY3Rpb24oKXt2YXIgYT1GKHRoaXMuc3RhY2spLGE9QWYodGhpcy5pYj9hLnJpZ2h0OmEubGVmdCxJKHRoaXMuc3RhY2spLHRoaXMuaWIpO3JldHVybiBudWxsIT1hP25ldyBCZihudWxsLGEsdGhpcy5pYix0aGlzLmctMSxudWxsKTpIfTtnLkg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc307XG5nLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IEJmKGIsdGhpcy5zdGFjayx0aGlzLmliLHRoaXMuZyx0aGlzLm0pfTtnLkc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTShiLHRoaXMpfTtmdW5jdGlvbiBDZihhLGIsYyl7cmV0dXJuIG5ldyBCZihudWxsLEFmKGEsbnVsbCxiKSxiLGMsbnVsbCl9ZnVuY3Rpb24gRGYoYSxiLGMsZCl7cmV0dXJuIGMgaW5zdGFuY2VvZiBZP2MubGVmdCBpbnN0YW5jZW9mIFk/bmV3IFkoYy5rZXksYy5sLGMubGVmdC5xYSgpLG5ldyAkKGEsYixjLnJpZ2h0LGQsbnVsbCksbnVsbCk6Yy5yaWdodCBpbnN0YW5jZW9mIFk/bmV3IFkoYy5yaWdodC5rZXksYy5yaWdodC5sLG5ldyAkKGMua2V5LGMubCxjLmxlZnQsYy5yaWdodC5sZWZ0LG51bGwpLG5ldyAkKGEsYixjLnJpZ2h0LnJpZ2h0LGQsbnVsbCksbnVsbCk6dT9uZXcgJChhLGIsYyxkLG51bGwpOm51bGw6bmV3ICQoYSxiLGMsZCxudWxsKX1cbmZ1bmN0aW9uIEVmKGEsYixjLGQpe3JldHVybiBkIGluc3RhbmNlb2YgWT9kLnJpZ2h0IGluc3RhbmNlb2YgWT9uZXcgWShkLmtleSxkLmwsbmV3ICQoYSxiLGMsZC5sZWZ0LG51bGwpLGQucmlnaHQucWEoKSxudWxsKTpkLmxlZnQgaW5zdGFuY2VvZiBZP25ldyBZKGQubGVmdC5rZXksZC5sZWZ0LmwsbmV3ICQoYSxiLGMsZC5sZWZ0LmxlZnQsbnVsbCksbmV3ICQoZC5rZXksZC5sLGQubGVmdC5yaWdodCxkLnJpZ2h0LG51bGwpLG51bGwpOnU/bmV3ICQoYSxiLGMsZCxudWxsKTpudWxsOm5ldyAkKGEsYixjLGQsbnVsbCl9XG5mdW5jdGlvbiBGZihhLGIsYyxkKXtpZihjIGluc3RhbmNlb2YgWSlyZXR1cm4gbmV3IFkoYSxiLGMucWEoKSxkLG51bGwpO2lmKGQgaW5zdGFuY2VvZiAkKXJldHVybiBFZihhLGIsYyxkLmhiKCkpO2lmKGQgaW5zdGFuY2VvZiBZJiZkLmxlZnQgaW5zdGFuY2VvZiAkKXJldHVybiBuZXcgWShkLmxlZnQua2V5LGQubGVmdC5sLG5ldyAkKGEsYixjLGQubGVmdC5sZWZ0LG51bGwpLEVmKGQua2V5LGQubCxkLmxlZnQucmlnaHQsZC5yaWdodC5oYigpKSxudWxsKTtpZih1KXRocm93IEVycm9yKFwicmVkLWJsYWNrIHRyZWUgaW52YXJpYW50IHZpb2xhdGlvblwiKTtyZXR1cm4gbnVsbH1cbnZhciBIZj1mdW5jdGlvbiBHZihiLGMsZCl7ZD1udWxsIT1iLmxlZnQ/R2YoYi5sZWZ0LGMsZCk6ZDtpZihmYyhkKSlyZXR1cm4gSy5iP0suYihkKTpLLmNhbGwobnVsbCxkKTtkPWMuYz9jLmMoZCxiLmtleSxiLmwpOmMuY2FsbChudWxsLGQsYi5rZXksYi5sKTtpZihmYyhkKSlyZXR1cm4gSy5iP0suYihkKTpLLmNhbGwobnVsbCxkKTtiPW51bGwhPWIucmlnaHQ/R2YoYi5yaWdodCxjLGQpOmQ7cmV0dXJuIGZjKGIpP0suYj9LLmIoYik6Sy5jYWxsKG51bGwsYik6Yn07ZnVuY3Rpb24gJChhLGIsYyxkLGUpe3RoaXMua2V5PWE7dGhpcy5sPWI7dGhpcy5sZWZ0PWM7dGhpcy5yaWdodD1kO3RoaXMubT1lO3RoaXMucT0wO3RoaXMuaT0zMjQwMjIwN31nPSQucHJvdG90eXBlO2cuSGI9ZnVuY3Rpb24oYSl7cmV0dXJuIGEuSmIodGhpcyl9O2cuaGI9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IFkodGhpcy5rZXksdGhpcy5sLHRoaXMubGVmdCx0aGlzLnJpZ2h0LG51bGwpfTtnLnFhPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9O1xuZy5HYj1mdW5jdGlvbihhKXtyZXR1cm4gYS5JYih0aGlzKX07Zy5yZXBsYWNlPWZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiBuZXcgJChhLGIsYyxkLG51bGwpfTtnLkliPWZ1bmN0aW9uKGEpe3JldHVybiBuZXcgJChhLmtleSxhLmwsdGhpcyxhLnJpZ2h0LG51bGwpfTtnLkpiPWZ1bmN0aW9uKGEpe3JldHVybiBuZXcgJChhLmtleSxhLmwsYS5sZWZ0LHRoaXMsbnVsbCl9O2cuVGE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gSGYodGhpcyxhLGIpfTtnLnU9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gRC5jKHRoaXMsYixudWxsKX07Zy5DPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gRC5jKHRoaXMsYixjKX07Zy5KPWZ1bmN0aW9uKGEsYil7cmV0dXJuIDA9PT1iP3RoaXMua2V5OjE9PT1iP3RoaXMubDpudWxsfTtnLmFhPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gMD09PWI/dGhpcy5rZXk6MT09PWI/dGhpcy5sOnU/YzpudWxsfTtcbmcuUGE9ZnVuY3Rpb24oYSxiLGMpe3JldHVybihuZXcgVyhudWxsLDIsNSxYLFt0aGlzLmtleSx0aGlzLmxdLG51bGwpKS5QYShudWxsLGIsYyl9O2cuRD1mdW5jdGlvbigpe3JldHVybiBudWxsfTtnLkw9ZnVuY3Rpb24oKXtyZXR1cm4gMn07Zy4kYT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmtleX07Zy5hYj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmx9O2cuSWE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sfTtnLkphPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBXKG51bGwsMSw1LFgsW3RoaXMua2V5XSxudWxsKX07Zy5CPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tO3JldHVybiBudWxsIT1hP2E6dGhpcy5tPWE9Y2ModGhpcyl9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBsYyh0aGlzLGIpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gcWV9O2cuTj1mdW5jdGlvbihhLGIpe3JldHVybiBnYy5hKHRoaXMsYil9O2cuTT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIGdjLmModGhpcyxiLGMpfTtcbmcudWE9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBSLmMobmV3IFcobnVsbCwyLDUsWCxbdGhpcy5rZXksdGhpcy5sXSxudWxsKSxiLGMpfTtnLkg9ZnVuY3Rpb24oKXtyZXR1cm4gRGEoRGEoSCx0aGlzLmwpLHRoaXMua2V5KX07Zy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIE4obmV3IFcobnVsbCwyLDUsWCxbdGhpcy5rZXksdGhpcy5sXSxudWxsKSxiKX07Zy5HPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBXKG51bGwsMyw1LFgsW3RoaXMua2V5LHRoaXMubCxiXSxudWxsKX07Zy5jYWxsPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbDtyZXR1cm4gYT1mdW5jdGlvbihhLGMsZCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gdGhpcy51KG51bGwsYyk7Y2FzZSAzOnJldHVybiB0aGlzLkMobnVsbCxjLGQpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fX0oKTtcbmcuYXBwbHk9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5jYWxsLmFwcGx5KHRoaXMsW3RoaXNdLmNvbmNhdCh2YShiKSkpfTtnLmI9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMudShudWxsLGEpfTtnLmE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5DKG51bGwsYSxiKX07ZnVuY3Rpb24gWShhLGIsYyxkLGUpe3RoaXMua2V5PWE7dGhpcy5sPWI7dGhpcy5sZWZ0PWM7dGhpcy5yaWdodD1kO3RoaXMubT1lO3RoaXMucT0wO3RoaXMuaT0zMjQwMjIwN31nPVkucHJvdG90eXBlO2cuSGI9ZnVuY3Rpb24oYSl7cmV0dXJuIG5ldyBZKHRoaXMua2V5LHRoaXMubCx0aGlzLmxlZnQsYSxudWxsKX07Zy5oYj1mdW5jdGlvbigpe3Rocm93IEVycm9yKFwicmVkLWJsYWNrIHRyZWUgaW52YXJpYW50IHZpb2xhdGlvblwiKTt9O2cucWE9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3ICQodGhpcy5rZXksdGhpcy5sLHRoaXMubGVmdCx0aGlzLnJpZ2h0LG51bGwpfTtcbmcuR2I9ZnVuY3Rpb24oYSl7cmV0dXJuIG5ldyBZKHRoaXMua2V5LHRoaXMubCxhLHRoaXMucmlnaHQsbnVsbCl9O2cucmVwbGFjZT1mdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4gbmV3IFkoYSxiLGMsZCxudWxsKX07Zy5JYj1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5sZWZ0IGluc3RhbmNlb2YgWT9uZXcgWSh0aGlzLmtleSx0aGlzLmwsdGhpcy5sZWZ0LnFhKCksbmV3ICQoYS5rZXksYS5sLHRoaXMucmlnaHQsYS5yaWdodCxudWxsKSxudWxsKTp0aGlzLnJpZ2h0IGluc3RhbmNlb2YgWT9uZXcgWSh0aGlzLnJpZ2h0LmtleSx0aGlzLnJpZ2h0LmwsbmV3ICQodGhpcy5rZXksdGhpcy5sLHRoaXMubGVmdCx0aGlzLnJpZ2h0LmxlZnQsbnVsbCksbmV3ICQoYS5rZXksYS5sLHRoaXMucmlnaHQucmlnaHQsYS5yaWdodCxudWxsKSxudWxsKTp1P25ldyAkKGEua2V5LGEubCx0aGlzLGEucmlnaHQsbnVsbCk6bnVsbH07XG5nLkpiPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnJpZ2h0IGluc3RhbmNlb2YgWT9uZXcgWSh0aGlzLmtleSx0aGlzLmwsbmV3ICQoYS5rZXksYS5sLGEubGVmdCx0aGlzLmxlZnQsbnVsbCksdGhpcy5yaWdodC5xYSgpLG51bGwpOnRoaXMubGVmdCBpbnN0YW5jZW9mIFk/bmV3IFkodGhpcy5sZWZ0LmtleSx0aGlzLmxlZnQubCxuZXcgJChhLmtleSxhLmwsYS5sZWZ0LHRoaXMubGVmdC5sZWZ0LG51bGwpLG5ldyAkKHRoaXMua2V5LHRoaXMubCx0aGlzLmxlZnQucmlnaHQsdGhpcy5yaWdodCxudWxsKSxudWxsKTp1P25ldyAkKGEua2V5LGEubCxhLmxlZnQsdGhpcyxudWxsKTpudWxsfTtnLlRhPWZ1bmN0aW9uKGEsYil7cmV0dXJuIEhmKHRoaXMsYSxiKX07Zy51PWZ1bmN0aW9uKGEsYil7cmV0dXJuIEQuYyh0aGlzLGIsbnVsbCl9O2cuQz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIEQuYyh0aGlzLGIsYyl9O1xuZy5KPWZ1bmN0aW9uKGEsYil7cmV0dXJuIDA9PT1iP3RoaXMua2V5OjE9PT1iP3RoaXMubDpudWxsfTtnLmFhPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gMD09PWI/dGhpcy5rZXk6MT09PWI/dGhpcy5sOnU/YzpudWxsfTtnLlBhPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4obmV3IFcobnVsbCwyLDUsWCxbdGhpcy5rZXksdGhpcy5sXSxudWxsKSkuUGEobnVsbCxiLGMpfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbH07Zy5MPWZ1bmN0aW9uKCl7cmV0dXJuIDJ9O2cuJGE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5rZXl9O2cuYWI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sfTtnLklhPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubH07Zy5KYT1mdW5jdGlvbigpe3JldHVybiBuZXcgVyhudWxsLDEsNSxYLFt0aGlzLmtleV0sbnVsbCl9O2cuQj1mdW5jdGlvbigpe3ZhciBhPXRoaXMubTtyZXR1cm4gbnVsbCE9YT9hOnRoaXMubT1hPWNjKHRoaXMpfTtcbmcudj1mdW5jdGlvbihhLGIpe3JldHVybiBsYyh0aGlzLGIpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gcWV9O2cuTj1mdW5jdGlvbihhLGIpe3JldHVybiBnYy5hKHRoaXMsYil9O2cuTT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIGdjLmModGhpcyxiLGMpfTtnLnVhPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gUi5jKG5ldyBXKG51bGwsMiw1LFgsW3RoaXMua2V5LHRoaXMubF0sbnVsbCksYixjKX07Zy5IPWZ1bmN0aW9uKCl7cmV0dXJuIERhKERhKEgsdGhpcy5sKSx0aGlzLmtleSl9O2cuRj1mdW5jdGlvbihhLGIpe3JldHVybiBOKG5ldyBXKG51bGwsMiw1LFgsW3RoaXMua2V5LHRoaXMubF0sbnVsbCksYil9O2cuRz1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgVyhudWxsLDMsNSxYLFt0aGlzLmtleSx0aGlzLmwsYl0sbnVsbCl9O1xuZy5jYWxsPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbDtyZXR1cm4gYT1mdW5jdGlvbihhLGMsZCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gdGhpcy51KG51bGwsYyk7Y2FzZSAzOnJldHVybiB0aGlzLkMobnVsbCxjLGQpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fX0oKTtnLmFwcGx5PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuY2FsbC5hcHBseSh0aGlzLFt0aGlzXS5jb25jYXQodmEoYikpKX07Zy5iPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnUobnVsbCxhKX07Zy5hPWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuQyhudWxsLGEsYil9O1xudmFyIEpmPWZ1bmN0aW9uIElmKGIsYyxkLGUsZil7aWYobnVsbD09YylyZXR1cm4gbmV3IFkoZCxlLG51bGwsbnVsbCxudWxsKTt2YXIgaD1iLmE/Yi5hKGQsYy5rZXkpOmIuY2FsbChudWxsLGQsYy5rZXkpO3JldHVybiAwPT09aD8oZlswXT1jLG51bGwpOjA+aD8oYj1JZihiLGMubGVmdCxkLGUsZiksbnVsbCE9Yj9jLkdiKGIpOm51bGwpOnU/KGI9SWYoYixjLnJpZ2h0LGQsZSxmKSxudWxsIT1iP2MuSGIoYik6bnVsbCk6bnVsbH0sTGY9ZnVuY3Rpb24gS2YoYixjKXtpZihudWxsPT1iKXJldHVybiBjO2lmKG51bGw9PWMpcmV0dXJuIGI7aWYoYiBpbnN0YW5jZW9mIFkpe2lmKGMgaW5zdGFuY2VvZiBZKXt2YXIgZD1LZihiLnJpZ2h0LGMubGVmdCk7cmV0dXJuIGQgaW5zdGFuY2VvZiBZP25ldyBZKGQua2V5LGQubCxuZXcgWShiLmtleSxiLmwsYi5sZWZ0LGQubGVmdCxudWxsKSxuZXcgWShjLmtleSxjLmwsZC5yaWdodCxjLnJpZ2h0LG51bGwpLG51bGwpOm5ldyBZKGIua2V5LGIubCxcbmIubGVmdCxuZXcgWShjLmtleSxjLmwsZCxjLnJpZ2h0LG51bGwpLG51bGwpfXJldHVybiBuZXcgWShiLmtleSxiLmwsYi5sZWZ0LEtmKGIucmlnaHQsYyksbnVsbCl9cmV0dXJuIGMgaW5zdGFuY2VvZiBZP25ldyBZKGMua2V5LGMubCxLZihiLGMubGVmdCksYy5yaWdodCxudWxsKTp1PyhkPUtmKGIucmlnaHQsYy5sZWZ0KSxkIGluc3RhbmNlb2YgWT9uZXcgWShkLmtleSxkLmwsbmV3ICQoYi5rZXksYi5sLGIubGVmdCxkLmxlZnQsbnVsbCksbmV3ICQoYy5rZXksYy5sLGQucmlnaHQsYy5yaWdodCxudWxsKSxudWxsKTpGZihiLmtleSxiLmwsYi5sZWZ0LG5ldyAkKGMua2V5LGMubCxkLGMucmlnaHQsbnVsbCkpKTpudWxsfSxOZj1mdW5jdGlvbiBNZihiLGMsZCxlKXtpZihudWxsIT1jKXt2YXIgZj1iLmE/Yi5hKGQsYy5rZXkpOmIuY2FsbChudWxsLGQsYy5rZXkpO2lmKDA9PT1mKXJldHVybiBlWzBdPWMsTGYoYy5sZWZ0LGMucmlnaHQpO2lmKDA+ZilyZXR1cm4gYj1NZihiLGMubGVmdCxcbmQsZSksbnVsbCE9Ynx8bnVsbCE9ZVswXT9jLmxlZnQgaW5zdGFuY2VvZiAkP0ZmKGMua2V5LGMubCxiLGMucmlnaHQpOm5ldyBZKGMua2V5LGMubCxiLGMucmlnaHQsbnVsbCk6bnVsbDtpZih1KXtiPU1mKGIsYy5yaWdodCxkLGUpO2lmKG51bGwhPWJ8fG51bGwhPWVbMF0paWYoYy5yaWdodCBpbnN0YW5jZW9mICQpaWYoZT1jLmtleSxkPWMubCxjPWMubGVmdCxiIGluc3RhbmNlb2YgWSljPW5ldyBZKGUsZCxjLGIucWEoKSxudWxsKTtlbHNlIGlmKGMgaW5zdGFuY2VvZiAkKWM9RGYoZSxkLGMuaGIoKSxiKTtlbHNlIGlmKGMgaW5zdGFuY2VvZiBZJiZjLnJpZ2h0IGluc3RhbmNlb2YgJCljPW5ldyBZKGMucmlnaHQua2V5LGMucmlnaHQubCxEZihjLmtleSxjLmwsYy5sZWZ0LmhiKCksYy5yaWdodC5sZWZ0KSxuZXcgJChlLGQsYy5yaWdodC5yaWdodCxiLG51bGwpLG51bGwpO2Vsc2V7aWYodSl0aHJvdyBFcnJvcihcInJlZC1ibGFjayB0cmVlIGludmFyaWFudCB2aW9sYXRpb25cIik7XG5jPW51bGx9ZWxzZSBjPW5ldyBZKGMua2V5LGMubCxjLmxlZnQsYixudWxsKTtlbHNlIGM9bnVsbDtyZXR1cm4gY319cmV0dXJuIG51bGx9LFBmPWZ1bmN0aW9uIE9mKGIsYyxkLGUpe3ZhciBmPWMua2V5LGg9Yi5hP2IuYShkLGYpOmIuY2FsbChudWxsLGQsZik7cmV0dXJuIDA9PT1oP2MucmVwbGFjZShmLGUsYy5sZWZ0LGMucmlnaHQpOjA+aD9jLnJlcGxhY2UoZixjLmwsT2YoYixjLmxlZnQsZCxlKSxjLnJpZ2h0KTp1P2MucmVwbGFjZShmLGMubCxjLmxlZnQsT2YoYixjLnJpZ2h0LGQsZSkpOm51bGx9O2Z1bmN0aW9uIFFmKGEsYixjLGQsZSl7dGhpcy5aPWE7dGhpcy5tYT1iO3RoaXMuZz1jO3RoaXMuaj1kO3RoaXMubT1lO3RoaXMuaT00MTg3NzY4NDc7dGhpcy5xPTgxOTJ9Zz1RZi5wcm90b3R5cGU7Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07Zy5rZXlzPWZ1bmN0aW9uKCl7cmV0dXJuIE9lKFZlLmI/VmUuYih0aGlzKTpWZS5jYWxsKG51bGwsdGhpcykpfTtcbmcuZW50cmllcz1mdW5jdGlvbigpe3JldHVybiBRZShFKHRoaXMpKX07Zy52YWx1ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gT2UoV2UuYj9XZS5iKHRoaXMpOldlLmNhbGwobnVsbCx0aGlzKSl9O2cuaGFzPWZ1bmN0aW9uKGEpe3JldHVybiBPYyh0aGlzLGEpfTtnLmdldD1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy51KG51bGwsYSl9O2cuZm9yRWFjaD1mdW5jdGlvbihhKXtmb3IodmFyIGI9RSh0aGlzKSxjPW51bGwsZD0wLGU9MDs7KWlmKGU8ZCl7dmFyIGY9Yy5KKG51bGwsZSksaD1QLmMoZiwwLG51bGwpLGY9UC5jKGYsMSxudWxsKTthLmE/YS5hKGYsaCk6YS5jYWxsKG51bGwsZixoKTtlKz0xfWVsc2UgaWYoYj1FKGIpKUljKGIpPyhjPUhiKGIpLGI9SWIoYiksaD1jLGQ9TyhjKSxjPWgpOihjPUYoYiksaD1QLmMoYywwLG51bGwpLGY9UC5jKGMsMSxudWxsKSxhLmE/YS5hKGYsaCk6YS5jYWxsKG51bGwsZixoKSxiPUkoYiksYz1udWxsLGQ9MCksZT0wO2Vsc2UgcmV0dXJuIG51bGx9O1xuZnVuY3Rpb24gUmYoYSxiKXtmb3IodmFyIGM9YS5tYTs7KWlmKG51bGwhPWMpe3ZhciBkPWEuWi5hP2EuWi5hKGIsYy5rZXkpOmEuWi5jYWxsKG51bGwsYixjLmtleSk7aWYoMD09PWQpcmV0dXJuIGM7aWYoMD5kKWM9Yy5sZWZ0O2Vsc2UgaWYodSljPWMucmlnaHQ7ZWxzZSByZXR1cm4gbnVsbH1lbHNlIHJldHVybiBudWxsfWcudT1mdW5jdGlvbihhLGIpe3JldHVybiBMYS5jKHRoaXMsYixudWxsKX07Zy5DPWZ1bmN0aW9uKGEsYixjKXthPVJmKHRoaXMsYik7cmV0dXJuIG51bGwhPWE/YS5sOmN9O2cuWmE9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBudWxsIT10aGlzLm1hP0hmKHRoaXMubWEsYixjKTpjfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5qfTtnLkw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nfTtnLlhhPWZ1bmN0aW9uKCl7cmV0dXJuIDA8dGhpcy5nP0NmKHRoaXMubWEsITEsdGhpcy5nKTpudWxsfTtcbmcuQj1mdW5jdGlvbigpe3ZhciBhPXRoaXMubTtyZXR1cm4gbnVsbCE9YT9hOnRoaXMubT1hPWRjKHRoaXMpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTWUodGhpcyxiKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIE4oU2YsdGhpcy5qKX07Zy5uYj1mdW5jdGlvbihhLGIpe3ZhciBjPVtudWxsXSxkPU5mKHRoaXMuWix0aGlzLm1hLGIsYyk7cmV0dXJuIG51bGw9PWQ/bnVsbD09UC5hKGMsMCk/dGhpczpuZXcgUWYodGhpcy5aLG51bGwsMCx0aGlzLmosbnVsbCk6bmV3IFFmKHRoaXMuWixkLnFhKCksdGhpcy5nLTEsdGhpcy5qLG51bGwpfTtcbmcudWE9ZnVuY3Rpb24oYSxiLGMpe2E9W251bGxdO3ZhciBkPUpmKHRoaXMuWix0aGlzLm1hLGIsYyxhKTtyZXR1cm4gbnVsbD09ZD8oYT1QLmEoYSwwKSxXYi5hKGMsYS5sKT90aGlzOm5ldyBRZih0aGlzLlosUGYodGhpcy5aLHRoaXMubWEsYixjKSx0aGlzLmcsdGhpcy5qLG51bGwpKTpuZXcgUWYodGhpcy5aLGQucWEoKSx0aGlzLmcrMSx0aGlzLmosbnVsbCl9O2cua2I9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbnVsbCE9UmYodGhpcyxiKX07Zy5IPWZ1bmN0aW9uKCl7cmV0dXJuIDA8dGhpcy5nP0NmKHRoaXMubWEsITAsdGhpcy5nKTpudWxsfTtnLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IFFmKHRoaXMuWix0aGlzLm1hLHRoaXMuZyxiLHRoaXMubSl9O1xuZy5HPWZ1bmN0aW9uKGEsYil7aWYoSGMoYikpcmV0dXJuIE9hKHRoaXMsRC5hKGIsMCksRC5hKGIsMSkpO2Zvcih2YXIgYz10aGlzLGQ9RShiKTs7KXtpZihudWxsPT1kKXJldHVybiBjO3ZhciBlPUYoZCk7aWYoSGMoZSkpYz1PYShjLEQuYShlLDApLEQuYShlLDEpKSxkPUkoZCk7ZWxzZSB0aHJvdyBFcnJvcihcImNvbmogb24gYSBtYXAgdGFrZXMgbWFwIGVudHJpZXMgb3Igc2VxYWJsZXMgb2YgbWFwIGVudHJpZXNcIik7fX07Zy5jYWxsPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbDtyZXR1cm4gYT1mdW5jdGlvbihhLGMsZCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gdGhpcy51KG51bGwsYyk7Y2FzZSAzOnJldHVybiB0aGlzLkMobnVsbCxjLGQpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fX0oKTtnLmFwcGx5PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuY2FsbC5hcHBseSh0aGlzLFt0aGlzXS5jb25jYXQodmEoYikpKX07XG5nLmI9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMudShudWxsLGEpfTtnLmE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5DKG51bGwsYSxiKX07Zy55Yj1mdW5jdGlvbihhLGIpe3JldHVybiAwPHRoaXMuZz9DZih0aGlzLm1hLGIsdGhpcy5nKTpudWxsfTtnLnpiPWZ1bmN0aW9uKGEsYixjKXtpZigwPHRoaXMuZyl7YT1udWxsO2Zvcih2YXIgZD10aGlzLm1hOzspaWYobnVsbCE9ZCl7dmFyIGU9dGhpcy5aLmE/dGhpcy5aLmEoYixkLmtleSk6dGhpcy5aLmNhbGwobnVsbCxiLGQua2V5KTtpZigwPT09ZSlyZXR1cm4gbmV3IEJmKG51bGwscGMuYShhLGQpLGMsLTEsbnVsbCk7aWYocihjKSkwPmU/KGE9cGMuYShhLGQpLGQ9ZC5sZWZ0KTpkPWQucmlnaHQ7ZWxzZSBpZih1KTA8ZT8oYT1wYy5hKGEsZCksZD1kLnJpZ2h0KTpkPWQubGVmdDtlbHNlIHJldHVybiBudWxsfWVsc2UgcmV0dXJuIG51bGw9PWE/bnVsbDpuZXcgQmYobnVsbCxhLGMsLTEsbnVsbCl9ZWxzZSByZXR1cm4gbnVsbH07XG5nLnhiPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGNmLmI/Y2YuYihiKTpjZi5jYWxsKG51bGwsYil9O2cud2I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5afTtcbnZhciBTZj1uZXcgUWYoWGIsbnVsbCwwLG51bGwsMCksVGY9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEpe3ZhciBkPW51bGw7MDxhcmd1bWVudHMubGVuZ3RoJiYoZD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywwKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGQpfWZ1bmN0aW9uIGIoYSl7YT1FKGEpO2Zvcih2YXIgYj15YigkZSk7OylpZihhKXt2YXIgZT1JKEkoYSkpLGI9eGQuYyhiLEYoYSksRihJKGEpKSk7YT1lfWVsc2UgcmV0dXJuIEFiKGIpfWEuaz0wO2EuZj1mdW5jdGlvbihhKXthPUUoYSk7cmV0dXJuIGIoYSl9O2EuZD1iO3JldHVybiBhfSgpLFVmPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhKXt2YXIgZD1udWxsOzA8YXJndW1lbnRzLmxlbmd0aCYmKGQ9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCksMCkpO3JldHVybiBiLmNhbGwodGhpcyxkKX1mdW5jdGlvbiBiKGEpe3JldHVybiBuZXcgbGEobnVsbCxZYyhPKGEpKSxTLmEod2EsXG5hKSxudWxsKX1hLms9MDthLmY9ZnVuY3Rpb24oYSl7YT1FKGEpO3JldHVybiBiKGEpfTthLmQ9YjtyZXR1cm4gYX0oKSxWZj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSl7dmFyIGQ9bnVsbDswPGFyZ3VtZW50cy5sZW5ndGgmJihkPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsZCl9ZnVuY3Rpb24gYihhKXthPUUoYSk7Zm9yKHZhciBiPVNmOzspaWYoYSl7dmFyIGU9SShJKGEpKSxiPVIuYyhiLEYoYSksRihJKGEpKSk7YT1lfWVsc2UgcmV0dXJuIGJ9YS5rPTA7YS5mPWZ1bmN0aW9uKGEpe2E9RShhKTtyZXR1cm4gYihhKX07YS5kPWI7cmV0dXJuIGF9KCksV2Y9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsZCl7dmFyIGU9bnVsbDsxPGFyZ3VtZW50cy5sZW5ndGgmJihlPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYSxlKX1mdW5jdGlvbiBiKGEsXG5iKXtmb3IodmFyIGU9RShiKSxmPW5ldyBRZihRYyhhKSxudWxsLDAsbnVsbCwwKTs7KWlmKGUpdmFyIGg9SShJKGUpKSxmPVIuYyhmLEYoZSksRihJKGUpKSksZT1oO2Vsc2UgcmV0dXJuIGZ9YS5rPTE7YS5mPWZ1bmN0aW9uKGEpe3ZhciBkPUYoYSk7YT1HKGEpO3JldHVybiBiKGQsYSl9O2EuZD1iO3JldHVybiBhfSgpO2Z1bmN0aW9uIFhmKGEsYil7dGhpcy5WPWE7dGhpcy5XPWI7dGhpcy5xPTA7dGhpcy5pPTMyMzc0OTg4fWc9WGYucHJvdG90eXBlO2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O2cuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLld9O2cuVT1mdW5jdGlvbigpe3ZhciBhPXRoaXMuVixhPShhP2EuaSYxMjh8fGEub2J8fChhLmk/MDpzKEphLGEpKTpzKEphLGEpKT90aGlzLlYuVShudWxsKTpJKHRoaXMuVik7cmV0dXJuIG51bGw9PWE/bnVsbDpuZXcgWGYoYSx0aGlzLlcpfTtnLkI9ZnVuY3Rpb24oKXtyZXR1cm4gY2ModGhpcyl9O1xuZy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGxjKHRoaXMsYil9O2cuST1mdW5jdGlvbigpe3JldHVybiBOKEgsdGhpcy5XKX07Zy5OPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5jLmEoYix0aGlzKX07Zy5NPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gbmMuYyhiLGMsdGhpcyl9O2cuUT1mdW5jdGlvbigpe3JldHVybiB0aGlzLlYuUShudWxsKS4kYShudWxsKX07Zy5TPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5WLGE9KGE/YS5pJjEyOHx8YS5vYnx8KGEuaT8wOnMoSmEsYSkpOnMoSmEsYSkpP3RoaXMuVi5VKG51bGwpOkkodGhpcy5WKTtyZXR1cm4gbnVsbCE9YT9uZXcgWGYoYSx0aGlzLlcpOkh9O2cuSD1mdW5jdGlvbigpe3JldHVybiB0aGlzfTtnLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IFhmKHRoaXMuVixiKX07Zy5HPWZ1bmN0aW9uKGEsYil7cmV0dXJuIE0oYix0aGlzKX07ZnVuY3Rpb24gVmUoYSl7cmV0dXJuKGE9RShhKSk/bmV3IFhmKGEsbnVsbCk6bnVsbH1cbmZ1bmN0aW9uIGNmKGEpe3JldHVybiBUYShhKX1mdW5jdGlvbiBZZihhLGIpe3RoaXMuVj1hO3RoaXMuVz1iO3RoaXMucT0wO3RoaXMuaT0zMjM3NDk4OH1nPVlmLnByb3RvdHlwZTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIExiKHRoaXMpfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5XfTtnLlU9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLlYsYT0oYT9hLmkmMTI4fHxhLm9ifHwoYS5pPzA6cyhKYSxhKSk6cyhKYSxhKSk/dGhpcy5WLlUobnVsbCk6SSh0aGlzLlYpO3JldHVybiBudWxsPT1hP251bGw6bmV3IFlmKGEsdGhpcy5XKX07Zy5CPWZ1bmN0aW9uKCl7cmV0dXJuIGNjKHRoaXMpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbGModGhpcyxiKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIE4oSCx0aGlzLlcpfTtnLk49ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmMuYShiLHRoaXMpfTtnLk09ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBuYy5jKGIsYyx0aGlzKX07Zy5RPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuVi5RKG51bGwpLmFiKG51bGwpfTtcbmcuUz1mdW5jdGlvbigpe3ZhciBhPXRoaXMuVixhPShhP2EuaSYxMjh8fGEub2J8fChhLmk/MDpzKEphLGEpKTpzKEphLGEpKT90aGlzLlYuVShudWxsKTpJKHRoaXMuVik7cmV0dXJuIG51bGwhPWE/bmV3IFlmKGEsdGhpcy5XKTpIfTtnLkg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc307Zy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBZZih0aGlzLlYsYil9O2cuRz1mdW5jdGlvbihhLGIpe3JldHVybiBNKGIsdGhpcyl9O2Z1bmN0aW9uIFdlKGEpe3JldHVybihhPUUoYSkpP25ldyBZZihhLG51bGwpOm51bGx9ZnVuY3Rpb24gZGYoYSl7cmV0dXJuIFVhKGEpfVxudmFyIFpmPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhKXt2YXIgZD1udWxsOzA8YXJndW1lbnRzLmxlbmd0aCYmKGQ9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCksMCkpO3JldHVybiBiLmNhbGwodGhpcyxkKX1mdW5jdGlvbiBiKGEpe3JldHVybiByKEVkKEZkLGEpKT9DLmEoZnVuY3Rpb24oYSxiKXtyZXR1cm4gcGMuYShyKGEpP2E6WWUsYil9LGEpOm51bGx9YS5rPTA7YS5mPWZ1bmN0aW9uKGEpe2E9RShhKTtyZXR1cm4gYihhKX07YS5kPWI7cmV0dXJuIGF9KCk7ZnVuY3Rpb24gJGYoYSxiLGMpe3RoaXMuaj1hO3RoaXMuU2E9Yjt0aGlzLm09Yzt0aGlzLmk9MTUwNzc2NDc7dGhpcy5xPTgxOTZ9Zz0kZi5wcm90b3R5cGU7Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07Zy5rZXlzPWZ1bmN0aW9uKCl7cmV0dXJuIE9lKEUodGhpcykpfTtnLmVudHJpZXM9ZnVuY3Rpb24oKXtyZXR1cm4gU2UoRSh0aGlzKSl9O2cudmFsdWVzPWZ1bmN0aW9uKCl7cmV0dXJuIE9lKEUodGhpcykpfTtcbmcuaGFzPWZ1bmN0aW9uKGEpe3JldHVybiBPYyh0aGlzLGEpfTtnLmZvckVhY2g9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPUUodGhpcyksYz1udWxsLGQ9MCxlPTA7OylpZihlPGQpe3ZhciBmPWMuSihudWxsLGUpLGg9UC5jKGYsMCxudWxsKSxmPVAuYyhmLDEsbnVsbCk7YS5hP2EuYShmLGgpOmEuY2FsbChudWxsLGYsaCk7ZSs9MX1lbHNlIGlmKGI9RShiKSlJYyhiKT8oYz1IYihiKSxiPUliKGIpLGg9YyxkPU8oYyksYz1oKTooYz1GKGIpLGg9UC5jKGMsMCxudWxsKSxmPVAuYyhjLDEsbnVsbCksYS5hP2EuYShmLGgpOmEuY2FsbChudWxsLGYsaCksYj1JKGIpLGM9bnVsbCxkPTApLGU9MDtlbHNlIHJldHVybiBudWxsfTtnLnU9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTGEuYyh0aGlzLGIsbnVsbCl9O2cuQz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIE5hKHRoaXMuU2EsYik/YjpjfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5qfTtnLkw9ZnVuY3Rpb24oKXtyZXR1cm4gQWEodGhpcy5TYSl9O1xuZy5CPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tO3JldHVybiBudWxsIT1hP2E6dGhpcy5tPWE9ZGModGhpcyl9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBEYyhiKSYmTyh0aGlzKT09PU8oYikmJkRkKGZ1bmN0aW9uKGEpe3JldHVybiBmdW5jdGlvbihiKXtyZXR1cm4gT2MoYSxiKX19KHRoaXMpLGIpfTtnLldhPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBhZyh5Yih0aGlzLlNhKSl9O2cuST1mdW5jdGlvbigpe3JldHVybiBOKGJnLHRoaXMuail9O2cudmI9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3ICRmKHRoaXMuaixRYSh0aGlzLlNhLGIpLG51bGwpfTtnLkg9ZnVuY3Rpb24oKXtyZXR1cm4gVmUodGhpcy5TYSl9O2cuRj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgJGYoYix0aGlzLlNhLHRoaXMubSl9O2cuRz1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgJGYodGhpcy5qLFIuYyh0aGlzLlNhLGIsbnVsbCksbnVsbCl9O1xuZy5jYWxsPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbDtyZXR1cm4gYT1mdW5jdGlvbihhLGMsZCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gdGhpcy51KG51bGwsYyk7Y2FzZSAzOnJldHVybiB0aGlzLkMobnVsbCxjLGQpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fX0oKTtnLmFwcGx5PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuY2FsbC5hcHBseSh0aGlzLFt0aGlzXS5jb25jYXQodmEoYikpKX07Zy5iPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnUobnVsbCxhKX07Zy5hPWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuQyhudWxsLGEsYil9O3ZhciBiZz1uZXcgJGYobnVsbCxZZSwwKTtmdW5jdGlvbiBhZyhhKXt0aGlzLmxhPWE7dGhpcy5pPTI1OTt0aGlzLnE9MTM2fWc9YWcucHJvdG90eXBlO1xuZy5jYWxsPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbDtyZXR1cm4gYT1mdW5jdGlvbihhLGMsZCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gTGEuYyh0aGlzLmxhLGMsTGMpPT09TGM/bnVsbDpjO2Nhc2UgMzpyZXR1cm4gTGEuYyh0aGlzLmxhLGMsTGMpPT09TGM/ZDpjfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fX0oKTtnLmFwcGx5PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuY2FsbC5hcHBseSh0aGlzLFt0aGlzXS5jb25jYXQodmEoYikpKX07Zy5iPWZ1bmN0aW9uKGEpe3JldHVybiBMYS5jKHRoaXMubGEsYSxMYyk9PT1MYz9udWxsOmF9O2cuYT1mdW5jdGlvbihhLGIpe3JldHVybiBMYS5jKHRoaXMubGEsYSxMYyk9PT1MYz9iOmF9O2cudT1mdW5jdGlvbihhLGIpe3JldHVybiBMYS5jKHRoaXMsYixudWxsKX07Zy5DPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gTGEuYyh0aGlzLmxhLGIsTGMpPT09TGM/YzpifTtcbmcuTD1mdW5jdGlvbigpe3JldHVybiBPKHRoaXMubGEpfTtnLk9iPWZ1bmN0aW9uKGEsYil7dGhpcy5sYT15ZC5hKHRoaXMubGEsYik7cmV0dXJuIHRoaXN9O2cuS2E9ZnVuY3Rpb24oYSxiKXt0aGlzLmxhPXhkLmModGhpcy5sYSxiLG51bGwpO3JldHVybiB0aGlzfTtnLk9hPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyAkZihudWxsLEFiKHRoaXMubGEpLG51bGwpfTtmdW5jdGlvbiBjZyhhLGIsYyl7dGhpcy5qPWE7dGhpcy5uYT1iO3RoaXMubT1jO3RoaXMuaT00MTc3MzA4MzE7dGhpcy5xPTgxOTJ9Zz1jZy5wcm90b3R5cGU7Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07Zy5rZXlzPWZ1bmN0aW9uKCl7cmV0dXJuIE9lKEUodGhpcykpfTtnLmVudHJpZXM9ZnVuY3Rpb24oKXtyZXR1cm4gU2UoRSh0aGlzKSl9O2cudmFsdWVzPWZ1bmN0aW9uKCl7cmV0dXJuIE9lKEUodGhpcykpfTtnLmhhcz1mdW5jdGlvbihhKXtyZXR1cm4gT2ModGhpcyxhKX07XG5nLmZvckVhY2g9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPUUodGhpcyksYz1udWxsLGQ9MCxlPTA7OylpZihlPGQpe3ZhciBmPWMuSihudWxsLGUpLGg9UC5jKGYsMCxudWxsKSxmPVAuYyhmLDEsbnVsbCk7YS5hP2EuYShmLGgpOmEuY2FsbChudWxsLGYsaCk7ZSs9MX1lbHNlIGlmKGI9RShiKSlJYyhiKT8oYz1IYihiKSxiPUliKGIpLGg9YyxkPU8oYyksYz1oKTooYz1GKGIpLGg9UC5jKGMsMCxudWxsKSxmPVAuYyhjLDEsbnVsbCksYS5hP2EuYShmLGgpOmEuY2FsbChudWxsLGYsaCksYj1JKGIpLGM9bnVsbCxkPTApLGU9MDtlbHNlIHJldHVybiBudWxsfTtnLnU9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTGEuYyh0aGlzLGIsbnVsbCl9O2cuQz1mdW5jdGlvbihhLGIsYyl7YT1SZih0aGlzLm5hLGIpO3JldHVybiBudWxsIT1hP2Eua2V5OmN9O2cuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmp9O2cuTD1mdW5jdGlvbigpe3JldHVybiBPKHRoaXMubmEpfTtcbmcuWGE9ZnVuY3Rpb24oKXtyZXR1cm4gMDxPKHRoaXMubmEpP0tkLmEoY2YscGIodGhpcy5uYSkpOm51bGx9O2cuQj1mdW5jdGlvbigpe3ZhciBhPXRoaXMubTtyZXR1cm4gbnVsbCE9YT9hOnRoaXMubT1hPWRjKHRoaXMpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gRGMoYikmJk8odGhpcyk9PT1PKGIpJiZEZChmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oYil7cmV0dXJuIE9jKGEsYil9fSh0aGlzKSxiKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIE4oZGcsdGhpcy5qKX07Zy52Yj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgY2codGhpcy5qLHRjLmEodGhpcy5uYSxiKSxudWxsKX07Zy5IPWZ1bmN0aW9uKCl7cmV0dXJuIFZlKHRoaXMubmEpfTtnLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IGNnKGIsdGhpcy5uYSx0aGlzLm0pfTtnLkc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IGNnKHRoaXMuaixSLmModGhpcy5uYSxiLG51bGwpLG51bGwpfTtcbmcuY2FsbD1mdW5jdGlvbigpe3ZhciBhPW51bGw7cmV0dXJuIGE9ZnVuY3Rpb24oYSxjLGQpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIHRoaXMudShudWxsLGMpO2Nhc2UgMzpyZXR1cm4gdGhpcy5DKG51bGwsYyxkKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO319KCk7Zy5hcHBseT1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmNhbGwuYXBwbHkodGhpcyxbdGhpc10uY29uY2F0KHZhKGIpKSl9O2cuYj1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy51KG51bGwsYSl9O2cuYT1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLkMobnVsbCxhLGIpfTtnLnliPWZ1bmN0aW9uKGEsYil7cmV0dXJuIEtkLmEoY2YscWIodGhpcy5uYSxiKSl9O2cuemI9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBLZC5hKGNmLHJiKHRoaXMubmEsYixjKSl9O2cueGI9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYn07Zy53Yj1mdW5jdGlvbigpe3JldHVybiB0Yih0aGlzLm5hKX07XG52YXIgZGc9bmV3IGNnKG51bGwsU2YsMCk7ZnVuY3Rpb24gZWcoYSl7YT1FKGEpO2lmKG51bGw9PWEpcmV0dXJuIGJnO2lmKGEgaW5zdGFuY2VvZiBhYyYmMD09PWEucCl7YT1hLmU7YTp7Zm9yKHZhciBiPTAsYz15YihiZyk7OylpZihiPGEubGVuZ3RoKXZhciBkPWIrMSxjPWMuS2EobnVsbCxhW2JdKSxiPWQ7ZWxzZXthPWM7YnJlYWsgYX1hPXZvaWQgMH1yZXR1cm4gYS5PYShudWxsKX1pZih1KWZvcihkPXliKGJnKTs7KWlmKG51bGwhPWEpYj1hLlUobnVsbCksZD1kLkthKG51bGwsYS5RKG51bGwpKSxhPWI7ZWxzZSByZXR1cm4gZC5PYShudWxsKTtlbHNlIHJldHVybiBudWxsfVxudmFyIGZnPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhKXt2YXIgZD1udWxsOzA8YXJndW1lbnRzLmxlbmd0aCYmKGQ9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCksMCkpO3JldHVybiBiLmNhbGwodGhpcyxkKX1mdW5jdGlvbiBiKGEpe3JldHVybiBDLmMoRGEsZGcsYSl9YS5rPTA7YS5mPWZ1bmN0aW9uKGEpe2E9RShhKTtyZXR1cm4gYihhKX07YS5kPWI7cmV0dXJuIGF9KCksZ2c9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsZCl7dmFyIGU9bnVsbDsxPGFyZ3VtZW50cy5sZW5ndGgmJihlPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYSxlKX1mdW5jdGlvbiBiKGEsYil7cmV0dXJuIEMuYyhEYSxuZXcgY2cobnVsbCxXZihhKSwwKSxiKX1hLms9MTthLmY9ZnVuY3Rpb24oYSl7dmFyIGQ9RihhKTthPUcoYSk7cmV0dXJuIGIoZCxhKX07YS5kPWI7cmV0dXJuIGF9KCk7XG5mdW5jdGlvbiBoZyhhKXtmb3IodmFyIGI9cWU7OylpZihJKGEpKWI9cGMuYShiLEYoYSkpLGE9SShhKTtlbHNlIHJldHVybiBFKGIpfWZ1bmN0aW9uIGlkKGEpe2lmKGEmJihhLnEmNDA5Nnx8YS5mYykpcmV0dXJuIGEubmFtZTtpZihcInN0cmluZ1wiPT09dHlwZW9mIGEpcmV0dXJuIGE7dGhyb3cgRXJyb3IoXCJEb2Vzbid0IHN1cHBvcnQgbmFtZTogXCIrQS5iKGEpKTt9XG52YXIgaWc9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjKXtyZXR1cm4oYS5iP2EuYihiKTphLmNhbGwobnVsbCxiKSk+KGEuYj9hLmIoYyk6YS5jYWxsKG51bGwsYykpP2I6Y312YXIgYj1udWxsLGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGIsZCxrLGwpe3ZhciBuPW51bGw7Mzxhcmd1bWVudHMubGVuZ3RoJiYobj1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywzKSwwKSk7cmV0dXJuIGMuY2FsbCh0aGlzLGIsZCxrLG4pfWZ1bmN0aW9uIGMoYSxkLGUsbCl7cmV0dXJuIEMuYyhmdW5jdGlvbihjLGQpe3JldHVybiBiLmMoYSxjLGQpfSxiLmMoYSxkLGUpLGwpfWEuaz0zO2EuZj1mdW5jdGlvbihhKXt2YXIgYj1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9SShhKTt2YXIgbD1GKGEpO2E9RyhhKTtyZXR1cm4gYyhiLGQsbCxhKX07YS5kPWM7cmV0dXJuIGF9KCksYj1mdW5jdGlvbihiLGUsZixoKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBlO1xuY2FzZSAzOnJldHVybiBhLmNhbGwodGhpcyxiLGUsZik7ZGVmYXVsdDpyZXR1cm4gYy5kKGIsZSxmLEooYXJndW1lbnRzLDMpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yi5rPTM7Yi5mPWMuZjtiLmE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYn07Yi5jPWE7Yi5kPWMuZDtyZXR1cm4gYn0oKSxqZz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGYpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7dmFyIGg9RShmKTtyZXR1cm4gaD9NKE1kKGEsaCksYy5jKGEsYixOZChiLGgpKSk6bnVsbH0sbnVsbCxudWxsKX1mdW5jdGlvbiBiKGEsYil7cmV0dXJuIGMuYyhhLGEsYil9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBiLmNhbGwodGhpcyxjLGUpO2Nhc2UgMzpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlLGYpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7XG59O2MuYT1iO2MuYz1hO3JldHVybiBjfSgpLGxnPWZ1bmN0aW9uIGtnKGIsYyl7cmV0dXJuIG5ldyBWKG51bGwsZnVuY3Rpb24oKXt2YXIgZD1FKGMpO3JldHVybiBkP3IoYi5iP2IuYihGKGQpKTpiLmNhbGwobnVsbCxGKGQpKSk/TShGKGQpLGtnKGIsRyhkKSkpOm51bGw6bnVsbH0sbnVsbCxudWxsKX07ZnVuY3Rpb24gbWcoYSxiLGMpe3JldHVybiBmdW5jdGlvbihkKXt2YXIgZT10YihhKTtyZXR1cm4gYi5hP2IuYShlLmE/ZS5hKHNiKGEsZCksYyk6ZS5jYWxsKG51bGwsc2IoYSxkKSxjKSwwKTpiLmNhbGwobnVsbCxlLmE/ZS5hKHNiKGEsZCksYyk6ZS5jYWxsKG51bGwsc2IoYSxkKSxjKSwwKX19XG52YXIgbmc9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjLGgsayl7dmFyIGw9cmIoYSxjLCEwKTtpZihyKGwpKXt2YXIgbj1QLmMobCwwLG51bGwpO3JldHVybiBsZyhtZyhhLGgsaykscihtZyhhLGIsYykuY2FsbChudWxsLG4pKT9sOkkobCkpfXJldHVybiBudWxsfWZ1bmN0aW9uIGIoYSxiLGMpe3ZhciBoPW1nKGEsYixjKSxrO2E6e2s9W1VjLFZjXTt2YXIgbD1rLmxlbmd0aDtpZihsPD1aZSlmb3IodmFyIG49MCxxPXliKFllKTs7KWlmKG48bCl2YXIgdD1uKzEscT1CYihxLGtbbl0sbnVsbCksbj10O2Vsc2V7az1uZXcgJGYobnVsbCxBYihxKSxudWxsKTticmVhayBhfWVsc2UgZm9yKG49MCxxPXliKGJnKTs7KWlmKG48bCl0PW4rMSxxPXpiKHEsa1tuXSksbj10O2Vsc2V7az1BYihxKTticmVhayBhfWs9dm9pZCAwfXJldHVybiByKGsuY2FsbChudWxsLGIpKT8oYT1yYihhLGMsITApLHIoYSk/KGI9UC5jKGEsMCxudWxsKSxyKGguYj9oLmIoYik6aC5jYWxsKG51bGwsYikpP2E6XG5JKGEpKTpudWxsKTpsZyhoLHFiKGEsITApKX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlLGYsaCxrKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAzOnJldHVybiBiLmNhbGwodGhpcyxjLGUsZik7Y2FzZSA1OnJldHVybiBhLmNhbGwodGhpcyxjLGUsZixoLGspfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmM9YjtjLnM9YTtyZXR1cm4gY30oKTtmdW5jdGlvbiBvZyhhLGIsYyxkLGUpe3RoaXMuaj1hO3RoaXMuc3RhcnQ9Yjt0aGlzLmVuZD1jO3RoaXMuc3RlcD1kO3RoaXMubT1lO3RoaXMuaT0zMjM3NTAwNjt0aGlzLnE9ODE5Mn1nPW9nLnByb3RvdHlwZTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIExiKHRoaXMpfTtcbmcuSj1mdW5jdGlvbihhLGIpe2lmKGI8QWEodGhpcykpcmV0dXJuIHRoaXMuc3RhcnQrYip0aGlzLnN0ZXA7aWYodGhpcy5zdGFydD50aGlzLmVuZCYmMD09PXRoaXMuc3RlcClyZXR1cm4gdGhpcy5zdGFydDt0aHJvdyBFcnJvcihcIkluZGV4IG91dCBvZiBib3VuZHNcIik7fTtnLmFhPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gYjxBYSh0aGlzKT90aGlzLnN0YXJ0K2IqdGhpcy5zdGVwOnRoaXMuc3RhcnQ+dGhpcy5lbmQmJjA9PT10aGlzLnN0ZXA/dGhpcy5zdGFydDpjfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5qfTtcbmcuVT1mdW5jdGlvbigpe3JldHVybiAwPHRoaXMuc3RlcD90aGlzLnN0YXJ0K3RoaXMuc3RlcDx0aGlzLmVuZD9uZXcgb2codGhpcy5qLHRoaXMuc3RhcnQrdGhpcy5zdGVwLHRoaXMuZW5kLHRoaXMuc3RlcCxudWxsKTpudWxsOnRoaXMuc3RhcnQrdGhpcy5zdGVwPnRoaXMuZW5kP25ldyBvZyh0aGlzLmosdGhpcy5zdGFydCt0aGlzLnN0ZXAsdGhpcy5lbmQsdGhpcy5zdGVwLG51bGwpOm51bGx9O2cuTD1mdW5jdGlvbigpe3JldHVybiBzYShsYih0aGlzKSk/MDpNYXRoLmNlaWwoKHRoaXMuZW5kLXRoaXMuc3RhcnQpL3RoaXMuc3RlcCl9O2cuQj1mdW5jdGlvbigpe3ZhciBhPXRoaXMubTtyZXR1cm4gbnVsbCE9YT9hOnRoaXMubT1hPWNjKHRoaXMpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbGModGhpcyxiKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIE4oSCx0aGlzLmopfTtnLk49ZnVuY3Rpb24oYSxiKXtyZXR1cm4gZ2MuYSh0aGlzLGIpfTtcbmcuTT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIGdjLmModGhpcyxiLGMpfTtnLlE9ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbD09bGIodGhpcyk/bnVsbDp0aGlzLnN0YXJ0fTtnLlM9ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbCE9bGIodGhpcyk/bmV3IG9nKHRoaXMuaix0aGlzLnN0YXJ0K3RoaXMuc3RlcCx0aGlzLmVuZCx0aGlzLnN0ZXAsbnVsbCk6SH07Zy5IPWZ1bmN0aW9uKCl7cmV0dXJuIDA8dGhpcy5zdGVwP3RoaXMuc3RhcnQ8dGhpcy5lbmQ/dGhpczpudWxsOnRoaXMuc3RhcnQ+dGhpcy5lbmQ/dGhpczpudWxsfTtnLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IG9nKGIsdGhpcy5zdGFydCx0aGlzLmVuZCx0aGlzLnN0ZXAsdGhpcy5tKX07Zy5HPWZ1bmN0aW9uKGEsYil7cmV0dXJuIE0oYix0aGlzKX07XG52YXIgcGc9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjKXtyZXR1cm4gbmV3IG9nKG51bGwsYSxiLGMsbnVsbCl9ZnVuY3Rpb24gYihhLGIpe3JldHVybiBlLmMoYSxiLDEpfWZ1bmN0aW9uIGMoYSl7cmV0dXJuIGUuYygwLGEsMSl9ZnVuY3Rpb24gZCgpe3JldHVybiBlLmMoMCxOdW1iZXIuTUFYX1ZBTFVFLDEpfXZhciBlPW51bGwsZT1mdW5jdGlvbihlLGgsayl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMDpyZXR1cm4gZC5jYWxsKHRoaXMpO2Nhc2UgMTpyZXR1cm4gYy5jYWxsKHRoaXMsZSk7Y2FzZSAyOnJldHVybiBiLmNhbGwodGhpcyxlLGgpO2Nhc2UgMzpyZXR1cm4gYS5jYWxsKHRoaXMsZSxoLGspfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtlLm89ZDtlLmI9YztlLmE9YjtlLmM9YTtyZXR1cm4gZX0oKSxxZz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtmb3IoOzspaWYoRShiKSYmMDxhKXt2YXIgYz1hLTEsaD1cbkkoYik7YT1jO2I9aH1lbHNlIHJldHVybiBudWxsfWZ1bmN0aW9uIGIoYSl7Zm9yKDs7KWlmKEUoYSkpYT1JKGEpO2Vsc2UgcmV0dXJuIG51bGx9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYi5jYWxsKHRoaXMsYyk7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxjLGUpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmI9YjtjLmE9YTtyZXR1cm4gY30oKSxyZz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtxZy5hKGEsYik7cmV0dXJuIGJ9ZnVuY3Rpb24gYihhKXtxZy5iKGEpO3JldHVybiBhfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGIuY2FsbCh0aGlzLGMpO2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO1xufTtjLmI9YjtjLmE9YTtyZXR1cm4gY30oKTtmdW5jdGlvbiBzZyhhLGIpe2lmKFwic3RyaW5nXCI9PT10eXBlb2YgYil7dmFyIGM9YS5leGVjKGIpO3JldHVybiBXYi5hKEYoYyksYik/MT09PU8oYyk/RihjKTp3ZShjKTpudWxsfXRocm93IG5ldyBUeXBlRXJyb3IoXCJyZS1tYXRjaGVzIG11c3QgbWF0Y2ggYWdhaW5zdCBhIHN0cmluZy5cIik7fWZ1bmN0aW9uIHRnKGEpe3ZhciBiO2I9L14oPzpcXChcXD8oW2lkbXN1eF0qKVxcKSk/KC4qKS87aWYoXCJzdHJpbmdcIj09PXR5cGVvZiBhKWE9Yi5leGVjKGEpLGI9bnVsbD09YT9udWxsOjE9PT1PKGEpP0YoYSk6d2UoYSk7ZWxzZSB0aHJvdyBuZXcgVHlwZUVycm9yKFwicmUtZmluZCBtdXN0IG1hdGNoIGFnYWluc3QgYSBzdHJpbmcuXCIpO1AuYyhiLDAsbnVsbCk7YT1QLmMoYiwxLG51bGwpO2I9UC5jKGIsMixudWxsKTtyZXR1cm4gbmV3IFJlZ0V4cChiLGEpfVxuZnVuY3Rpb24gdWcoYSxiLGMsZCxlLGYsaCl7dmFyIGs9amE7dHJ5e2phPW51bGw9PWphP251bGw6amEtMTtpZihudWxsIT1qYSYmMD5qYSlyZXR1cm4gdWIoYSxcIiNcIik7dWIoYSxjKTtFKGgpJiYoYi5jP2IuYyhGKGgpLGEsZik6Yi5jYWxsKG51bGwsRihoKSxhLGYpKTtmb3IodmFyIGw9SShoKSxuPXJhLmIoZiktMTs7KWlmKCFsfHxudWxsIT1uJiYwPT09bil7RShsKSYmMD09PW4mJih1YihhLGQpLHViKGEsXCIuLi5cIikpO2JyZWFrfWVsc2V7dWIoYSxkKTtiLmM/Yi5jKEYobCksYSxmKTpiLmNhbGwobnVsbCxGKGwpLGEsZik7dmFyIHE9SShsKTtjPW4tMTtsPXE7bj1jfXJldHVybiB1YihhLGUpfWZpbmFsbHl7amE9a319XG52YXIgdmc9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsZCl7dmFyIGU9bnVsbDsxPGFyZ3VtZW50cy5sZW5ndGgmJihlPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYSxlKX1mdW5jdGlvbiBiKGEsYil7Zm9yKHZhciBlPUUoYiksZj1udWxsLGg9MCxrPTA7OylpZihrPGgpe3ZhciBsPWYuSihudWxsLGspO3ViKGEsbCk7ays9MX1lbHNlIGlmKGU9RShlKSlmPWUsSWMoZik/KGU9SGIoZiksaD1JYihmKSxmPWUsbD1PKGUpLGU9aCxoPWwpOihsPUYoZiksdWIoYSxsKSxlPUkoZiksZj1udWxsLGg9MCksaz0wO2Vsc2UgcmV0dXJuIG51bGx9YS5rPTE7YS5mPWZ1bmN0aW9uKGEpe3ZhciBkPUYoYSk7YT1HKGEpO3JldHVybiBiKGQsYSl9O2EuZD1iO3JldHVybiBhfSgpLHdnPXsnXCInOidcXFxcXCInLFwiXFxcXFwiOlwiXFxcXFxcXFxcIixcIlxcYlwiOlwiXFxcXGJcIixcIlxcZlwiOlwiXFxcXGZcIixcIlxcblwiOlwiXFxcXG5cIixcIlxcclwiOlwiXFxcXHJcIixcIlxcdFwiOlwiXFxcXHRcIn07XG5mdW5jdGlvbiB4ZyhhKXtyZXR1cm4nXCInK0EuYihhLnJlcGxhY2UoUmVnRXhwKCdbXFxcXFxcXFxcIlxcYlxcZlxcblxcclxcdF0nLFwiZ1wiKSxmdW5jdGlvbihhKXtyZXR1cm4gd2dbYV19KSkrJ1wiJ31cbnZhciBBZz1mdW5jdGlvbiB5ZyhiLGMsZCl7aWYobnVsbD09YilyZXR1cm4gdWIoYyxcIm5pbFwiKTtpZih2b2lkIDA9PT1iKXJldHVybiB1YihjLFwiI1xceDNjdW5kZWZpbmVkXFx4M2VcIik7aWYodSl7cihmdW5jdGlvbigpe3ZhciBjPVEuYShkLHBhKTtyZXR1cm4gcihjKT8oYz1iP2IuaSYxMzEwNzJ8fGIuZWM/ITA6Yi5pPyExOnMoYmIsYik6cyhiYixiKSk/eGMoYik6YzpjfSgpKSYmKHViKGMsXCJeXCIpLHlnKHhjKGIpLGMsZCksdWIoYyxcIiBcIikpO2lmKG51bGw9PWIpcmV0dXJuIHViKGMsXCJuaWxcIik7aWYoYi5EYilyZXR1cm4gYi5UYihiLGMsZCk7aWYoYiYmKGIuaSYyMTQ3NDgzNjQ4fHxiLkspKXJldHVybiBiLncobnVsbCxjLGQpO2lmKHRhKGIpPT09Qm9vbGVhbnx8XCJudW1iZXJcIj09PXR5cGVvZiBiKXJldHVybiB1YihjLFwiXCIrQS5iKGIpKTtpZihudWxsIT1iJiZiLmNvbnN0cnVjdG9yPT09T2JqZWN0KXJldHVybiB1YihjLFwiI2pzIFwiKSx6Zy5uP3pnLm4oS2QuYShmdW5jdGlvbihjKXtyZXR1cm4gbmV3IFcobnVsbCxcbjIsNSxYLFtqZC5iKGMpLGJbY11dLG51bGwpfSxKYyhiKSkseWcsYyxkKTp6Zy5jYWxsKG51bGwsS2QuYShmdW5jdGlvbihjKXtyZXR1cm4gbmV3IFcobnVsbCwyLDUsWCxbamQuYihjKSxiW2NdXSxudWxsKX0sSmMoYikpLHlnLGMsZCk7aWYoYiBpbnN0YW5jZW9mIEFycmF5KXJldHVybiB1ZyhjLHlnLFwiI2pzIFtcIixcIiBcIixcIl1cIixkLGIpO2lmKFwic3RyaW5nXCI9PXR5cGVvZiBiKXJldHVybiByKG9hLmIoZCkpP3ViKGMseGcoYikpOnViKGMsYik7aWYodWMoYikpcmV0dXJuIHZnLmQoYyxKKFtcIiNcXHgzY1wiLFwiXCIrQS5iKGIpLFwiXFx4M2VcIl0sMCkpO2lmKGIgaW5zdGFuY2VvZiBEYXRlKXt2YXIgZT1mdW5jdGlvbihiLGMpe2Zvcih2YXIgZD1cIlwiK0EuYihiKTs7KWlmKE8oZCk8YylkPVwiMFwiK0EuYihkKTtlbHNlIHJldHVybiBkfTtyZXR1cm4gdmcuZChjLEooWycjaW5zdCBcIicsXCJcIitBLmIoYi5nZXRVVENGdWxsWWVhcigpKSxcIi1cIixlKGIuZ2V0VVRDTW9udGgoKSsxLDIpLFwiLVwiLGUoYi5nZXRVVENEYXRlKCksXG4yKSxcIlRcIixlKGIuZ2V0VVRDSG91cnMoKSwyKSxcIjpcIixlKGIuZ2V0VVRDTWludXRlcygpLDIpLFwiOlwiLGUoYi5nZXRVVENTZWNvbmRzKCksMiksXCIuXCIsZShiLmdldFVUQ01pbGxpc2Vjb25kcygpLDMpLFwiLVwiLCcwMDowMFwiJ10sMCkpfXJldHVybiBiIGluc3RhbmNlb2YgUmVnRXhwP3ZnLmQoYyxKKFsnI1wiJyxiLnNvdXJjZSwnXCInXSwwKSk6KGI/Yi5pJjIxNDc0ODM2NDh8fGIuS3x8KGIuaT8wOnModmIsYikpOnModmIsYikpP3diKGIsYyxkKTp1P3ZnLmQoYyxKKFtcIiNcXHgzY1wiLFwiXCIrQS5iKGIpLFwiXFx4M2VcIl0sMCkpOm51bGx9cmV0dXJuIG51bGx9O1xuZnVuY3Rpb24gQmcoYSxiKXt2YXIgYz1uZXcgZWE7YTp7dmFyIGQ9bmV3IEtiKGMpO0FnKEYoYSksZCxiKTtmb3IodmFyIGU9RShJKGEpKSxmPW51bGwsaD0wLGs9MDs7KWlmKGs8aCl7dmFyIGw9Zi5KKG51bGwsayk7dWIoZCxcIiBcIik7QWcobCxkLGIpO2srPTF9ZWxzZSBpZihlPUUoZSkpZj1lLEljKGYpPyhlPUhiKGYpLGg9SWIoZiksZj1lLGw9TyhlKSxlPWgsaD1sKToobD1GKGYpLHViKGQsXCIgXCIpLEFnKGwsZCxiKSxlPUkoZiksZj1udWxsLGg9MCksaz0wO2Vsc2UgYnJlYWsgYX1yZXR1cm4gY31cbnZhciBDZz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSl7dmFyIGQ9bnVsbDswPGFyZ3VtZW50cy5sZW5ndGgmJihkPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsZCl9ZnVuY3Rpb24gYihhKXt2YXIgYj1rYSgpO3JldHVybiBCYyhhKT9cIlwiOlwiXCIrQS5iKEJnKGEsYikpfWEuaz0wO2EuZj1mdW5jdGlvbihhKXthPUUoYSk7cmV0dXJuIGIoYSl9O2EuZD1iO3JldHVybiBhfSgpO2Z1bmN0aW9uIHpnKGEsYixjLGQpe3JldHVybiB1ZyhjLGZ1bmN0aW9uKGEsYyxkKXtiLmM/Yi5jKFRhKGEpLGMsZCk6Yi5jYWxsKG51bGwsVGEoYSksYyxkKTt1YihjLFwiIFwiKTtyZXR1cm4gYi5jP2IuYyhVYShhKSxjLGQpOmIuY2FsbChudWxsLFVhKGEpLGMsZCl9LFwie1wiLFwiLCBcIixcIn1cIixkLEUoYSkpfWFjLnByb3RvdHlwZS5LPSEwO1xuYWMucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB1ZyhiLEFnLFwiKFwiLFwiIFwiLFwiKVwiLGMsdGhpcyl9O1YucHJvdG90eXBlLks9ITA7Vi5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHVnKGIsQWcsXCIoXCIsXCIgXCIsXCIpXCIsYyx0aGlzKX07QmYucHJvdG90eXBlLks9ITA7QmYucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB1ZyhiLEFnLFwiKFwiLFwiIFwiLFwiKVwiLGMsdGhpcyl9O3ZmLnByb3RvdHlwZS5LPSEwO3ZmLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdWcoYixBZyxcIihcIixcIiBcIixcIilcIixjLHRoaXMpfTskLnByb3RvdHlwZS5LPSEwOyQucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB1ZyhiLEFnLFwiW1wiLFwiIFwiLFwiXVwiLGMsdGhpcyl9O1VlLnByb3RvdHlwZS5LPSEwO1VlLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdWcoYixBZyxcIihcIixcIiBcIixcIilcIixjLHRoaXMpfTtcbmNnLnByb3RvdHlwZS5LPSEwO2NnLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdWcoYixBZyxcIiN7XCIsXCIgXCIsXCJ9XCIsYyx0aGlzKX07eWUucHJvdG90eXBlLks9ITA7eWUucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB1ZyhiLEFnLFwiKFwiLFwiIFwiLFwiKVwiLGMsdGhpcyl9O2dkLnByb3RvdHlwZS5LPSEwO2dkLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdWcoYixBZyxcIihcIixcIiBcIixcIilcIixjLHRoaXMpfTtrYy5wcm90b3R5cGUuSz0hMDtrYy5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHVnKGIsQWcsXCIoXCIsXCIgXCIsXCIpXCIsYyx0aGlzKX07eGYucHJvdG90eXBlLks9ITA7eGYucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB6Zyh0aGlzLEFnLGIsYyl9O3dmLnByb3RvdHlwZS5LPSEwO3dmLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdWcoYixBZyxcIihcIixcIiBcIixcIilcIixjLHRoaXMpfTtcbkFlLnByb3RvdHlwZS5LPSEwO0FlLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdWcoYixBZyxcIltcIixcIiBcIixcIl1cIixjLHRoaXMpfTtRZi5wcm90b3R5cGUuSz0hMDtRZi5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHpnKHRoaXMsQWcsYixjKX07JGYucHJvdG90eXBlLks9ITA7JGYucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB1ZyhiLEFnLFwiI3tcIixcIiBcIixcIn1cIixjLHRoaXMpfTtvZC5wcm90b3R5cGUuSz0hMDtvZC5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHVnKGIsQWcsXCIoXCIsXCIgXCIsXCIpXCIsYyx0aGlzKX07WWYucHJvdG90eXBlLks9ITA7WWYucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB1ZyhiLEFnLFwiKFwiLFwiIFwiLFwiKVwiLGMsdGhpcyl9O1kucHJvdG90eXBlLks9ITA7WS5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHVnKGIsQWcsXCJbXCIsXCIgXCIsXCJdXCIsYyx0aGlzKX07XG5XLnByb3RvdHlwZS5LPSEwO1cucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB1ZyhiLEFnLFwiW1wiLFwiIFwiLFwiXVwiLGMsdGhpcyl9O0hlLnByb3RvdHlwZS5LPSEwO0hlLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdWcoYixBZyxcIihcIixcIiBcIixcIilcIixjLHRoaXMpfTtjZC5wcm90b3R5cGUuSz0hMDtjZC5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIpe3JldHVybiB1YihiLFwiKClcIil9O0llLnByb3RvdHlwZS5LPSEwO0llLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdWcoYixBZyxcIiNxdWV1ZSBbXCIsXCIgXCIsXCJdXCIsYyxFKHRoaXMpKX07bGEucHJvdG90eXBlLks9ITA7bGEucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB6Zyh0aGlzLEFnLGIsYyl9O29nLnByb3RvdHlwZS5LPSEwO29nLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdWcoYixBZyxcIihcIixcIiBcIixcIilcIixjLHRoaXMpfTtcblhmLnByb3RvdHlwZS5LPSEwO1hmLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdWcoYixBZyxcIihcIixcIiBcIixcIilcIixjLHRoaXMpfTtiZC5wcm90b3R5cGUuSz0hMDtiZC5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHVnKGIsQWcsXCIoXCIsXCIgXCIsXCIpXCIsYyx0aGlzKX07Vy5wcm90b3R5cGUubGI9ITA7Vy5wcm90b3R5cGUubWI9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gUGMuYSh0aGlzLGIpfTtBZS5wcm90b3R5cGUubGI9ITA7QWUucHJvdG90eXBlLm1iPWZ1bmN0aW9uKGEsYil7cmV0dXJuIFBjLmEodGhpcyxiKX07VC5wcm90b3R5cGUubGI9ITA7VC5wcm90b3R5cGUubWI9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gVmIodGhpcyxiKX07WmIucHJvdG90eXBlLmxiPSEwO1piLnByb3RvdHlwZS5tYj1mdW5jdGlvbihhLGIpe3JldHVybiBWYih0aGlzLGIpfTtcbmZ1bmN0aW9uIERnKGEsYil7aWYoYT9hLmdjOmEpcmV0dXJuIGEuZ2MoYSxiKTt2YXIgYztjPURnW20obnVsbD09YT9udWxsOmEpXTtpZighYyYmKGM9RGcuXywhYykpdGhyb3cgeChcIklSZXNldC4tcmVzZXQhXCIsYSk7cmV0dXJuIGMuY2FsbChudWxsLGEsYil9XG52YXIgRWc9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjLGQsZSl7aWYoYT9hLm5jOmEpcmV0dXJuIGEubmMoYSxiLGMsZCxlKTt2YXIgcTtxPUVnW20obnVsbD09YT9udWxsOmEpXTtpZighcSYmKHE9RWcuXywhcSkpdGhyb3cgeChcIklTd2FwLi1zd2FwIVwiLGEpO3JldHVybiBxLmNhbGwobnVsbCxhLGIsYyxkLGUpfWZ1bmN0aW9uIGIoYSxiLGMsZCl7aWYoYT9hLm1jOmEpcmV0dXJuIGEubWMoYSxiLGMsZCk7dmFyIGU7ZT1FZ1ttKG51bGw9PWE/bnVsbDphKV07aWYoIWUmJihlPUVnLl8sIWUpKXRocm93IHgoXCJJU3dhcC4tc3dhcCFcIixhKTtyZXR1cm4gZS5jYWxsKG51bGwsYSxiLGMsZCl9ZnVuY3Rpb24gYyhhLGIsYyl7aWYoYT9hLmxjOmEpcmV0dXJuIGEubGMoYSxiLGMpO3ZhciBkO2Q9RWdbbShudWxsPT1hP251bGw6YSldO2lmKCFkJiYoZD1FZy5fLCFkKSl0aHJvdyB4KFwiSVN3YXAuLXN3YXAhXCIsYSk7cmV0dXJuIGQuY2FsbChudWxsLGEsYixjKX1mdW5jdGlvbiBkKGEsYil7aWYoYT9cbmEua2M6YSlyZXR1cm4gYS5rYyhhLGIpO3ZhciBjO2M9RWdbbShudWxsPT1hP251bGw6YSldO2lmKCFjJiYoYz1FZy5fLCFjKSl0aHJvdyB4KFwiSVN3YXAuLXN3YXAhXCIsYSk7cmV0dXJuIGMuY2FsbChudWxsLGEsYil9dmFyIGU9bnVsbCxlPWZ1bmN0aW9uKGUsaCxrLGwsbil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gZC5jYWxsKHRoaXMsZSxoKTtjYXNlIDM6cmV0dXJuIGMuY2FsbCh0aGlzLGUsaCxrKTtjYXNlIDQ6cmV0dXJuIGIuY2FsbCh0aGlzLGUsaCxrLGwpO2Nhc2UgNTpyZXR1cm4gYS5jYWxsKHRoaXMsZSxoLGssbCxuKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307ZS5hPWQ7ZS5jPWM7ZS5uPWI7ZS5zPWE7cmV0dXJuIGV9KCk7ZnVuY3Rpb24gRmcoYSxiLGMsZCl7dGhpcy5zdGF0ZT1hO3RoaXMuaj1iO3RoaXMud2M9Yzt0aGlzLldiPWQ7dGhpcy5pPTIxNTM5Mzg5NDQ7dGhpcy5xPTE2Mzg2fWc9RmcucHJvdG90eXBlO1xuZy5CPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXNbYmFdfHwodGhpc1tiYV09KytjYSl9O2cuUmI9ZnVuY3Rpb24oYSxiLGMpe2E9RSh0aGlzLldiKTtmb3IodmFyIGQ9bnVsbCxlPTAsZj0wOzspaWYoZjxlKXt2YXIgaD1kLkoobnVsbCxmKSxrPVAuYyhoLDAsbnVsbCksaD1QLmMoaCwxLG51bGwpO2gubj9oLm4oayx0aGlzLGIsYyk6aC5jYWxsKG51bGwsayx0aGlzLGIsYyk7Zis9MX1lbHNlIGlmKGE9RShhKSlJYyhhKT8oZD1IYihhKSxhPUliKGEpLGs9ZCxlPU8oZCksZD1rKTooZD1GKGEpLGs9UC5jKGQsMCxudWxsKSxoPVAuYyhkLDEsbnVsbCksaC5uP2gubihrLHRoaXMsYixjKTpoLmNhbGwobnVsbCxrLHRoaXMsYixjKSxhPUkoYSksZD1udWxsLGU9MCksZj0wO2Vsc2UgcmV0dXJuIG51bGx9O2cudz1mdW5jdGlvbihhLGIsYyl7dWIoYixcIiNcXHgzY0F0b206IFwiKTtBZyh0aGlzLnN0YXRlLGIsYyk7cmV0dXJuIHViKGIsXCJcXHgzZVwiKX07Zy5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuan07XG5nLnViPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3RhdGV9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzPT09Yn07XG52YXIgSGc9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEpe3JldHVybiBuZXcgRmcoYSxudWxsLG51bGwsbnVsbCl9dmFyIGI9bnVsbCxjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShjLGQpe3ZhciBrPW51bGw7MTxhcmd1bWVudHMubGVuZ3RoJiYoaz1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGMsayl9ZnVuY3Rpb24gYihhLGMpe3ZhciBkPU1jKGMpP1MuYShUZixjKTpjLGU9US5hKGQsR2cpLGQ9US5hKGQscGEpO3JldHVybiBuZXcgRmcoYSxkLGUsbnVsbCl9YS5rPTE7YS5mPWZ1bmN0aW9uKGEpe3ZhciBjPUYoYSk7YT1HKGEpO3JldHVybiBiKGMsYSl9O2EuZD1iO3JldHVybiBhfSgpLGI9ZnVuY3Rpb24oYixlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBhLmNhbGwodGhpcyxiKTtkZWZhdWx0OnJldHVybiBjLmQoYixKKGFyZ3VtZW50cywxKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIitcbmFyZ3VtZW50cy5sZW5ndGgpO307Yi5rPTE7Yi5mPWMuZjtiLmI9YTtiLmQ9Yy5kO3JldHVybiBifSgpO2Z1bmN0aW9uIElnKGEsYil7aWYoYSBpbnN0YW5jZW9mIEZnKXt2YXIgYz1hLndjO2lmKG51bGwhPWMmJiFyKGMuYj9jLmIoYik6Yy5jYWxsKG51bGwsYikpKXRocm93IEVycm9yKFwiQXNzZXJ0IGZhaWxlZDogVmFsaWRhdG9yIHJlamVjdGVkIHJlZmVyZW5jZSBzdGF0ZVxcblwiK0EuYihDZy5kKEooW2ZkKG5ldyBaYihudWxsLFwidmFsaWRhdGVcIixcInZhbGlkYXRlXCIsMTQzOTIzMDcwMCxudWxsKSxuZXcgWmIobnVsbCxcIm5ldy12YWx1ZVwiLFwibmV3LXZhbHVlXCIsLTE1NjczOTc0MDEsbnVsbCkpXSwwKSkpKTtjPWEuc3RhdGU7YS5zdGF0ZT1iO251bGwhPWEuV2ImJnhiKGEsYyxiKTtyZXR1cm4gYn1yZXR1cm4gRGcoYSxiKX1mdW5jdGlvbiBLKGEpe3JldHVybiBhYihhKX1cbnZhciBKZz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMsZCl7cmV0dXJuIGEgaW5zdGFuY2VvZiBGZz9JZyhhLGIuYz9iLmMoYS5zdGF0ZSxjLGQpOmIuY2FsbChudWxsLGEuc3RhdGUsYyxkKSk6RWcubihhLGIsYyxkKX1mdW5jdGlvbiBiKGEsYixjKXtyZXR1cm4gYSBpbnN0YW5jZW9mIEZnP0lnKGEsYi5hP2IuYShhLnN0YXRlLGMpOmIuY2FsbChudWxsLGEuc3RhdGUsYykpOkVnLmMoYSxiLGMpfWZ1bmN0aW9uIGMoYSxiKXtyZXR1cm4gYSBpbnN0YW5jZW9mIEZnP0lnKGEsYi5iP2IuYihhLnN0YXRlKTpiLmNhbGwobnVsbCxhLnN0YXRlKSk6RWcuYShhLGIpfXZhciBkPW51bGwsZT1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYyxkLGUsZix0KXt2YXIgdj1udWxsOzQ8YXJndW1lbnRzLmxlbmd0aCYmKHY9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsNCksMCkpO3JldHVybiBiLmNhbGwodGhpcyxjLGQsZSxmLHYpfWZ1bmN0aW9uIGIoYSxjLGQsZSxmKXtyZXR1cm4gYSBpbnN0YW5jZW9mXG5GZz9JZyhhLFMucyhjLGEuc3RhdGUsZCxlLGYpKTpFZy5zKGEsYyxkLGUsZil9YS5rPTQ7YS5mPWZ1bmN0aW9uKGEpe3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1JKGEpO3ZhciBlPUYoYSk7YT1JKGEpO3ZhciBmPUYoYSk7YT1HKGEpO3JldHVybiBiKGMsZCxlLGYsYSl9O2EuZD1iO3JldHVybiBhfSgpLGQ9ZnVuY3Rpb24oZCxoLGssbCxuKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBjLmNhbGwodGhpcyxkLGgpO2Nhc2UgMzpyZXR1cm4gYi5jYWxsKHRoaXMsZCxoLGspO2Nhc2UgNDpyZXR1cm4gYS5jYWxsKHRoaXMsZCxoLGssbCk7ZGVmYXVsdDpyZXR1cm4gZS5kKGQsaCxrLGwsSihhcmd1bWVudHMsNCkpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtkLms9NDtkLmY9ZS5mO2QuYT1jO2QuYz1iO2Qubj1hO2QuZD1lLmQ7cmV0dXJuIGR9KCksS2c9e307XG5mdW5jdGlvbiBMZyhhKXtpZihhP2EuYWM6YSlyZXR1cm4gYS5hYyhhKTt2YXIgYjtiPUxnW20obnVsbD09YT9udWxsOmEpXTtpZighYiYmKGI9TGcuXywhYikpdGhyb3cgeChcIklFbmNvZGVKUy4tY2xqLVxceDNlanNcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9ZnVuY3Rpb24gTWcoYSl7cmV0dXJuKGE/cihyKG51bGwpP251bGw6YS4kYil8fChhLkNiPzA6cyhLZyxhKSk6cyhLZyxhKSk/TGcoYSk6XCJzdHJpbmdcIj09PXR5cGVvZiBhfHxcIm51bWJlclwiPT09dHlwZW9mIGF8fGEgaW5zdGFuY2VvZiBUfHxhIGluc3RhbmNlb2YgWmI/TmcuYj9OZy5iKGEpOk5nLmNhbGwobnVsbCxhKTpDZy5kKEooW2FdLDApKX1cbnZhciBOZz1mdW5jdGlvbiBPZyhiKXtpZihudWxsPT1iKXJldHVybiBudWxsO2lmKGI/cihyKG51bGwpP251bGw6Yi4kYil8fChiLkNiPzA6cyhLZyxiKSk6cyhLZyxiKSlyZXR1cm4gTGcoYik7aWYoYiBpbnN0YW5jZW9mIFQpcmV0dXJuIGlkKGIpO2lmKGIgaW5zdGFuY2VvZiBaYilyZXR1cm5cIlwiK0EuYihiKTtpZihHYyhiKSl7dmFyIGM9e307Yj1FKGIpO2Zvcih2YXIgZD1udWxsLGU9MCxmPTA7OylpZihmPGUpe3ZhciBoPWQuSihudWxsLGYpLGs9UC5jKGgsMCxudWxsKSxoPVAuYyhoLDEsbnVsbCk7Y1tNZyhrKV09T2coaCk7Zis9MX1lbHNlIGlmKGI9RShiKSlJYyhiKT8oZT1IYihiKSxiPUliKGIpLGQ9ZSxlPU8oZSkpOihlPUYoYiksZD1QLmMoZSwwLG51bGwpLGU9UC5jKGUsMSxudWxsKSxjW01nKGQpXT1PZyhlKSxiPUkoYiksZD1udWxsLGU9MCksZj0wO2Vsc2UgYnJlYWs7cmV0dXJuIGN9aWYoQ2MoYikpe2M9W107Yj1FKEtkLmEoT2csYikpO2Q9bnVsbDtmb3IoZj1lPTA7OylpZihmPFxuZSlrPWQuSihudWxsLGYpLGMucHVzaChrKSxmKz0xO2Vsc2UgaWYoYj1FKGIpKWQ9YixJYyhkKT8oYj1IYihkKSxmPUliKGQpLGQ9YixlPU8oYiksYj1mKTooYj1GKGQpLGMucHVzaChiKSxiPUkoZCksZD1udWxsLGU9MCksZj0wO2Vsc2UgYnJlYWs7cmV0dXJuIGN9cmV0dXJuIHU/YjpudWxsfSxQZz17fTtmdW5jdGlvbiBRZyhhLGIpe2lmKGE/YS5aYjphKXJldHVybiBhLlpiKGEsYik7dmFyIGM7Yz1RZ1ttKG51bGw9PWE/bnVsbDphKV07aWYoIWMmJihjPVFnLl8sIWMpKXRocm93IHgoXCJJRW5jb2RlQ2xvanVyZS4tanMtXFx4M2VjbGpcIixhKTtyZXR1cm4gYy5jYWxsKG51bGwsYSxiKX1cbnZhciBTZz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSl7cmV0dXJuIGIuZChhLEooW25ldyBsYShudWxsLDEsW1JnLCExXSxudWxsKV0sMCkpfXZhciBiPW51bGwsYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYyxkKXt2YXIgaz1udWxsOzE8YXJndW1lbnRzLmxlbmd0aCYmKGs9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSksMCkpO3JldHVybiBiLmNhbGwodGhpcyxjLGspfWZ1bmN0aW9uIGIoYSxjKXtpZihhP3IocihudWxsKT9udWxsOmEuQ2MpfHwoYS5DYj8wOnMoUGcsYSkpOnMoUGcsYSkpcmV0dXJuIFFnKGEsUy5hKFVmLGMpKTtpZihFKGMpKXt2YXIgZD1NYyhjKT9TLmEoVGYsYyk6YyxlPVEuYShkLFJnKTtyZXR1cm4gZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIGZ1bmN0aW9uIHkoZSl7cmV0dXJuIE1jKGUpP3JnLmIoS2QuYSh5LGUpKTpDYyhlKT9ZZChxYyhlKSxLZC5hKHksZSkpOmUgaW5zdGFuY2VvZiBBcnJheT93ZShLZC5hKHksZSkpOnRhKGUpPT09XG5PYmplY3Q/WWQoWWUsZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIGZ1bmN0aW9uIFJhKGYpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiBmdW5jdGlvbigpe2Zvcig7Oyl7dmFyIGE9RShmKTtpZihhKXtpZihJYyhhKSl7dmFyIGI9SGIoYSksYz1PKGIpLGg9bmV3IGxkKEFycmF5KGMpLDApO2E6e2Zvcih2YXIgaz0wOzspaWYoazxjKXt2YXIgbD1ELmEoYixrKSxsPW5ldyBXKG51bGwsMiw1LFgsW2QuYj9kLmIobCk6ZC5jYWxsKG51bGwsbCkseShlW2xdKV0sbnVsbCk7aC5hZGQobCk7ays9MX1lbHNle2I9ITA7YnJlYWsgYX1iPXZvaWQgMH1yZXR1cm4gYj9wZChoLmRhKCksUmEoSWIoYSkpKTpwZChoLmRhKCksbnVsbCl9aD1GKGEpO3JldHVybiBNKG5ldyBXKG51bGwsMiw1LFgsW2QuYj9kLmIoaCk6ZC5jYWxsKG51bGwsaCkseShlW2hdKV0sbnVsbCksUmEoRyhhKSkpfXJldHVybiBudWxsfX19KGEsYixjLGQpLG51bGwsXG5udWxsKX19KGEsYixjLGQpKEpjKGUpKX0oKSk6dT9lOm51bGx9fShjLGQsZSxyKGUpP2pkOkEpKGEpfXJldHVybiBudWxsfWEuaz0xO2EuZj1mdW5jdGlvbihhKXt2YXIgYz1GKGEpO2E9RyhhKTtyZXR1cm4gYihjLGEpfTthLmQ9YjtyZXR1cm4gYX0oKSxiPWZ1bmN0aW9uKGIsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYS5jYWxsKHRoaXMsYik7ZGVmYXVsdDpyZXR1cm4gYy5kKGIsSihhcmd1bWVudHMsMSkpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtiLms9MTtiLmY9Yy5mO2IuYj1hO2IuZD1jLmQ7cmV0dXJuIGJ9KCk7ZnVuY3Rpb24gVGcoYSl7dGhpcy5wYj1hO3RoaXMucT0wO3RoaXMuaT0yMTUzNzc1MTA0fVxuVGcucHJvdG90eXBlLkI9ZnVuY3Rpb24oKXtmb3IodmFyIGE9Q2cuZChKKFt0aGlzXSwwKSksYj0wLGM9MDtjPGEubGVuZ3RoOysrYyliPTMxKmIrYS5jaGFyQ29kZUF0KGMpLGIlPTQyOTQ5NjcyOTY7cmV0dXJuIGJ9O1RnLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHViKGIsJyN1dWlkIFwiJytBLmIodGhpcy5wYikrJ1wiJyl9O1RnLnByb3RvdHlwZS52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGIgaW5zdGFuY2VvZiBUZyYmdGhpcy5wYj09PWIucGJ9O1RnLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnBifTt2YXIgVWc9bmV3IFQobnVsbCxcInBwYXRoXCIsXCJwcGF0aFwiKSxWZz1uZXcgVChcInppcFwiLFwiYnJhbmNoP1wiLFwiemlwL2JyYW5jaD9cIiksV2c9bmV3IFQobnVsbCxcInJcIixcInJcIiksWGc9bmV3IFQoXCJ6aXBcIixcImNoaWxkcmVuXCIsXCJ6aXAvY2hpbGRyZW5cIikscGE9bmV3IFQobnVsbCxcIm1ldGFcIixcIm1ldGFcIikscWE9bmV3IFQobnVsbCxcImR1cFwiLFwiZHVwXCIpLHU9bmV3IFQobnVsbCxcImVsc2VcIixcImVsc2VcIiksR2c9bmV3IFQobnVsbCxcInZhbGlkYXRvclwiLFwidmFsaWRhdG9yXCIpLFliPW5ldyBUKG51bGwsXCJkZWZhdWx0XCIsXCJkZWZhdWx0XCIpLFlnPW5ldyBUKG51bGwsXCJzZXF1ZW50aWFsXCIsXCJzZXF1ZW50aWFsXCIpLG1hPW5ldyBUKG51bGwsXCJmbHVzaC1vbi1uZXdsaW5lXCIsXCJmbHVzaC1vbi1uZXdsaW5lXCIpLFpnPW5ldyBUKG51bGwsXCJsXCIsXCJsXCIpLCRnPW5ldyBUKFwiemlwXCIsXCJtYWtlLW5vZGVcIixcInppcC9tYWtlLW5vZGVcIiksb2E9bmV3IFQobnVsbCxcInJlYWRhYmx5XCIsXCJyZWFkYWJseVwiKSxyYT1uZXcgVChudWxsLFxuXCJwcmludC1sZW5ndGhcIixcInByaW50LWxlbmd0aFwiKSxhaD1uZXcgVChudWxsLFwicG5vZGVzXCIsXCJwbm9kZXNcIiksYmg9bmV3IFQobnVsbCxcImNoYW5nZWQ/XCIsXCJjaGFuZ2VkP1wiKSxjaD1uZXcgVChudWxsLFwidGFnXCIsXCJ0YWdcIiksZGg9bmV3IFQobnVsbCxcInNldFwiLFwic2V0XCIpLGVoPW5ldyBUKG51bGwsXCJlbmRcIixcImVuZFwiKSxmaD1uZXcgVChudWxsLFwiYXRvbVwiLFwiYXRvbVwiKSxSZz1uZXcgVChudWxsLFwia2V5d29yZGl6ZS1rZXlzXCIsXCJrZXl3b3JkaXplLWtleXNcIiksZ2g9bmV3IFQobnVsbCxcIm1hcFwiLFwibWFwXCIpLGhoPW5ldyBUKFwibW9yaVwiLFwibm90LWZvdW5kXCIsXCJtb3JpL25vdC1mb3VuZFwiKSxpaD1uZXcgVChcImNsanMuY29yZVwiLFwibm90LWZvdW5kXCIsXCJjbGpzLmNvcmUvbm90LWZvdW5kXCIpO3ZhciBqaCxraDtmdW5jdGlvbiBsaChhKXtyZXR1cm4gYS5vP2EubygpOmEuY2FsbChudWxsKX1mdW5jdGlvbiBtaChhKXtyZXR1cm4gYS5vP2EubygpOmEuY2FsbChudWxsKX12YXIgbmg9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjKXtyZXR1cm4gR2MoYyk/aGIoYyxhLGIpOm51bGw9PWM/YjpjIGluc3RhbmNlb2YgQXJyYXk/aGMuYyhjLGEsYik6dT9nYi5jKGMsYSxiKTpudWxsfWZ1bmN0aW9uIGIoYSxiKXtyZXR1cm4gYy5jKGEsYS5vP2EubygpOmEuY2FsbChudWxsKSxiKX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGIuY2FsbCh0aGlzLGMsZSk7Y2FzZSAzOnJldHVybiBhLmNhbGwodGhpcyxjLGUsZil9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYT1iO2MuYz1hO3JldHVybiBjfSgpO1xuZnVuY3Rpb24gb2goYSxiLGMsZCl7aWYoYT9hLkViOmEpcmV0dXJuIGEuRWIoYSxiLGMsZCk7dmFyIGU7ZT1vaFttKG51bGw9PWE/bnVsbDphKV07aWYoIWUmJihlPW9oLl8sIWUpKXRocm93IHgoXCJDb2xsRm9sZC5jb2xsLWZvbGRcIixhKTtyZXR1cm4gZS5jYWxsKG51bGwsYSxiLGMsZCl9XG52YXIgcWg9ZnVuY3Rpb24gcGgoYixjKXtcInVuZGVmaW5lZFwiPT09dHlwZW9mIGpoJiYoamg9ZnVuY3Rpb24oYixjLGYsaCl7dGhpcy4kPWI7dGhpcy5RYT1jO3RoaXMudWM9Zjt0aGlzLnNjPWg7dGhpcy5xPTA7dGhpcy5pPTkxNzUwNH0samguRGI9ITAsamguQmI9XCJjbG9qdXJlLmNvcmUucmVkdWNlcnMvdDYzMjJcIixqaC5UYj1mdW5jdGlvbihiLGMpe3JldHVybiB1YihjLFwiY2xvanVyZS5jb3JlLnJlZHVjZXJzL3Q2MzIyXCIpfSxqaC5wcm90b3R5cGUuTj1mdW5jdGlvbihiLGMpe3JldHVybiBnYi5jKHRoaXMsYyxjLm8/Yy5vKCk6Yy5jYWxsKG51bGwpKX0samgucHJvdG90eXBlLk09ZnVuY3Rpb24oYixjLGYpe3JldHVybiBnYi5jKHRoaXMuUWEsdGhpcy4kLmI/dGhpcy4kLmIoYyk6dGhpcy4kLmNhbGwobnVsbCxjKSxmKX0samgucHJvdG90eXBlLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zY30samgucHJvdG90eXBlLkY9ZnVuY3Rpb24oYixjKXtyZXR1cm4gbmV3IGpoKHRoaXMuJCxcbnRoaXMuUWEsdGhpcy51YyxjKX0pO3JldHVybiBuZXcgamgoYyxiLHBoLG51bGwpfSxzaD1mdW5jdGlvbiByaChiLGMpe1widW5kZWZpbmVkXCI9PT10eXBlb2Yga2gmJihraD1mdW5jdGlvbihiLGMsZixoKXt0aGlzLiQ9Yjt0aGlzLlFhPWM7dGhpcy5yYz1mO3RoaXMudGM9aDt0aGlzLnE9MDt0aGlzLmk9OTE3NTA0fSxraC5EYj0hMCxraC5CYj1cImNsb2p1cmUuY29yZS5yZWR1Y2Vycy90NjMyOFwiLGtoLlRiPWZ1bmN0aW9uKGIsYyl7cmV0dXJuIHViKGMsXCJjbG9qdXJlLmNvcmUucmVkdWNlcnMvdDYzMjhcIil9LGtoLnByb3RvdHlwZS5FYj1mdW5jdGlvbihiLGMsZixoKXtyZXR1cm4gb2godGhpcy5RYSxjLGYsdGhpcy4kLmI/dGhpcy4kLmIoaCk6dGhpcy4kLmNhbGwobnVsbCxoKSl9LGtoLnByb3RvdHlwZS5OPWZ1bmN0aW9uKGIsYyl7cmV0dXJuIGdiLmModGhpcy5RYSx0aGlzLiQuYj90aGlzLiQuYihjKTp0aGlzLiQuY2FsbChudWxsLGMpLGMubz9jLm8oKTpjLmNhbGwobnVsbCkpfSxcbmtoLnByb3RvdHlwZS5NPWZ1bmN0aW9uKGIsYyxmKXtyZXR1cm4gZ2IuYyh0aGlzLlFhLHRoaXMuJC5iP3RoaXMuJC5iKGMpOnRoaXMuJC5jYWxsKG51bGwsYyksZil9LGtoLnByb3RvdHlwZS5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudGN9LGtoLnByb3RvdHlwZS5GPWZ1bmN0aW9uKGIsYyl7cmV0dXJuIG5ldyBraCh0aGlzLiQsdGhpcy5RYSx0aGlzLnJjLGMpfSk7cmV0dXJuIG5ldyBraChjLGIscmgsbnVsbCl9LHRoPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3JldHVybiBzaChiLGZ1bmN0aW9uKGIpe3JldHVybiBmdW5jdGlvbigpe3ZhciBjPW51bGw7cmV0dXJuIGM9ZnVuY3Rpb24oYyxlLGgpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDA6cmV0dXJuIGIubz9iLm8oKTpiLmNhbGwobnVsbCk7Y2FzZSAyOnJldHVybiBiLmE/Yi5hKGMsYS5iP2EuYihlKTphLmNhbGwobnVsbCxlKSk6Yi5jYWxsKG51bGwsYyxhLmI/YS5iKGUpOmEuY2FsbChudWxsLGUpKTtjYXNlIDM6cmV0dXJuIGIuYT9cbmIuYShjLGEuYT9hLmEoZSxoKTphLmNhbGwobnVsbCxlLGgpKTpiLmNhbGwobnVsbCxjLGEuYT9hLmEoZSxoKTphLmNhbGwobnVsbCxlLGgpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO319KCl9KX1mdW5jdGlvbiBiKGEpe3JldHVybiBmdW5jdGlvbihiKXtyZXR1cm4gYy5hKGEsYil9fXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGIuY2FsbCh0aGlzLGMpO2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5iPWI7Yy5hPWE7cmV0dXJuIGN9KCksdWg9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7cmV0dXJuIHNoKGIsZnVuY3Rpb24oYil7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGM9bnVsbDtyZXR1cm4gYz1mdW5jdGlvbihjLGUsaCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMDpyZXR1cm4gYi5vP1xuYi5vKCk6Yi5jYWxsKG51bGwpO2Nhc2UgMjpyZXR1cm4gcihhLmI/YS5iKGUpOmEuY2FsbChudWxsLGUpKT9iLmE/Yi5hKGMsZSk6Yi5jYWxsKG51bGwsYyxlKTpjO2Nhc2UgMzpyZXR1cm4gcihhLmE/YS5hKGUsaCk6YS5jYWxsKG51bGwsZSxoKSk/Yi5jP2IuYyhjLGUsaCk6Yi5jYWxsKG51bGwsYyxlLGgpOmN9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9fSgpfSl9ZnVuY3Rpb24gYihhKXtyZXR1cm4gZnVuY3Rpb24oYil7cmV0dXJuIGMuYShhLGIpfX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBiLmNhbGwodGhpcyxjKTtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYj1iO2MuYT1hO3JldHVybiBjfSgpLHZoPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhKXtyZXR1cm4gc2goYSxcbmZ1bmN0aW9uKGEpe3JldHVybiBmdW5jdGlvbigpe3ZhciBiPW51bGw7cmV0dXJuIGI9ZnVuY3Rpb24oYixkKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAwOnJldHVybiBhLm8/YS5vKCk6YS5jYWxsKG51bGwpO2Nhc2UgMjpyZXR1cm4gRmMoZCk/Yy5iKGQpLk0obnVsbCxhLGIpOmEuYT9hLmEoYixkKTphLmNhbGwobnVsbCxiLGQpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fX0oKX0pfWZ1bmN0aW9uIGIoKXtyZXR1cm4gZnVuY3Rpb24oYSl7cmV0dXJuIGMuYihhKX19dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDA6cmV0dXJuIGIuY2FsbCh0aGlzKTtjYXNlIDE6cmV0dXJuIGEuY2FsbCh0aGlzLGMpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLm89YjtjLmI9YTtyZXR1cm4gY30oKSx3aD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxcbmIpe3JldHVybiB1aC5hKEdkKGEpLGIpfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIGZ1bmN0aW9uKGIpe3JldHVybiBjLmEoYSxiKX19dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYi5jYWxsKHRoaXMsYyk7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxjLGUpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmI9YjtjLmE9YTtyZXR1cm4gY30oKSx4aD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4gcWgoYixmdW5jdGlvbihiKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgYz1udWxsO3JldHVybiBjPWZ1bmN0aW9uKGMsZSxoKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAwOnJldHVybiBiLm8/Yi5vKCk6Yi5jYWxsKG51bGwpO2Nhc2UgMjpyZXR1cm4gcihhLmI/YS5iKGUpOmEuY2FsbChudWxsLGUpKT9iLmE/Yi5hKGMsZSk6Yi5jYWxsKG51bGwsYyxlKTpcbm5ldyBlYyhjKTtjYXNlIDM6cmV0dXJuIHIoYS5hP2EuYShlLGgpOmEuY2FsbChudWxsLGUsaCkpP2IuYz9iLmMoYyxlLGgpOmIuY2FsbChudWxsLGMsZSxoKTpuZXcgZWMoYyl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9fSgpfSl9ZnVuY3Rpb24gYihhKXtyZXR1cm4gZnVuY3Rpb24oYil7cmV0dXJuIGMuYShhLGIpfX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBiLmNhbGwodGhpcyxjKTtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYj1iO2MuYT1hO3JldHVybiBjfSgpLHloPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3JldHVybiBxaChiLGZ1bmN0aW9uKGIpe3JldHVybiBmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgYz1udWxsO3JldHVybiBjPVxuZnVuY3Rpb24oYyxkLGUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDA6cmV0dXJuIGIubz9iLm8oKTpiLmNhbGwobnVsbCk7Y2FzZSAyOnJldHVybiBKZy5hKGEsV2MpLDA+YWIoYSk/bmV3IGVjKGMpOmIuYT9iLmEoYyxkKTpiLmNhbGwobnVsbCxjLGQpO2Nhc2UgMzpyZXR1cm4gSmcuYShhLFdjKSwwPmFiKGEpP25ldyBlYyhjKTpiLmM/Yi5jKGMsZCxlKTpiLmNhbGwobnVsbCxjLGQsZSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9fSgpfShIZy5iKGEpKX0pfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIGZ1bmN0aW9uKGIpe3JldHVybiBjLmEoYSxiKX19dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYi5jYWxsKHRoaXMsYyk7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxjLGUpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7XG59O2MuYj1iO2MuYT1hO3JldHVybiBjfSgpLHpoPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3JldHVybiBxaChiLGZ1bmN0aW9uKGIpe3JldHVybiBmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgYz1udWxsO3JldHVybiBjPWZ1bmN0aW9uKGMsZCxlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAwOnJldHVybiBiLm8/Yi5vKCk6Yi5jYWxsKG51bGwpO2Nhc2UgMjpyZXR1cm4gSmcuYShhLFdjKSwwPmFiKGEpP2IuYT9iLmEoYyxkKTpiLmNhbGwobnVsbCxjLGQpOmM7Y2FzZSAzOnJldHVybiBKZy5hKGEsV2MpLDA+YWIoYSk/Yi5jP2IuYyhjLGQsZSk6Yi5jYWxsKG51bGwsYyxkLGUpOmN9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9fSgpfShIZy5iKGEpKX0pfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIGZ1bmN0aW9uKGIpe3JldHVybiBjLmEoYSxiKX19dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYi5jYWxsKHRoaXMsXG5jKTtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYj1iO2MuYT1hO3JldHVybiBjfSgpLEJoPWZ1bmN0aW9uIEFoKGIsYyxkLGUpe2lmKEJjKGIpKXJldHVybiBkLm8/ZC5vKCk6ZC5jYWxsKG51bGwpO2lmKE8oYik8PWMpcmV0dXJuIG5oLmMoZSxkLm8/ZC5vKCk6ZC5jYWxsKG51bGwpLGIpO2lmKHUpe3ZhciBmPVljKE8oYikpLGg9emUuYyhiLDAsZik7Yj16ZS5jKGIsZixPKGIpKTtyZXR1cm4gbGgoZnVuY3Rpb24oYixjLGUsZil7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGI9ZihjKSxoO2g9ZihlKTtyZXR1cm4gZC5hP2QuYShiLm8/Yi5vKCk6Yi5jYWxsKG51bGwpLG1oKGgpKTpkLmNhbGwobnVsbCxiLm8/Yi5vKCk6Yi5jYWxsKG51bGwpLG1oKGgpKX19KGYsaCxiLGZ1bmN0aW9uKGIsZixoKXtyZXR1cm4gZnVuY3Rpb24ocSl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIEFoKHEsXG5jLGQsZSl9fShiLGYsaCl9fShmLGgsYikpKX1yZXR1cm4gbnVsbH07Vy5wcm90b3R5cGUuRWI9ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIEJoKHRoaXMsYixjLGQpfTtvaC5vYmplY3Q9ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIG5oLmMoZCxjLm8/Yy5vKCk6Yy5jYWxsKG51bGwpLGEpfTtvaFtcIm51bGxcIl09ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBjLm8/Yy5vKCk6Yy5jYWxsKG51bGwpfTtmdW5jdGlvbiBDaChhLGIpe3ZhciBjPVMuYyhpZyxhLGIpO3JldHVybiBNKGMsVmQoZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKGIpe3JldHVybiBhPT09Yn19KGMpLGIpKX1cbnZhciBEaD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4gTyhhKTxPKGIpP0MuYyhwYyxiLGEpOkMuYyhwYyxhLGIpfXZhciBiPW51bGwsYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYyxkLGspe3ZhciBsPW51bGw7Mjxhcmd1bWVudHMubGVuZ3RoJiYobD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGMsZCxsKX1mdW5jdGlvbiBiKGEsYyxkKXthPUNoKE8scGMuZChkLGMsSihbYV0sMCkpKTtyZXR1cm4gQy5jKFlkLEYoYSksRyhhKSl9YS5rPTI7YS5mPWZ1bmN0aW9uKGEpe3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1HKGEpO3JldHVybiBiKGMsZCxhKX07YS5kPWI7cmV0dXJuIGF9KCksYj1mdW5jdGlvbihiLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMDpyZXR1cm4gYmc7Y2FzZSAxOnJldHVybiBiO2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsYixlKTtkZWZhdWx0OnJldHVybiBjLmQoYixcbmUsSihhcmd1bWVudHMsMikpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtiLms9MjtiLmY9Yy5mO2Iubz1mdW5jdGlvbigpe3JldHVybiBiZ307Yi5iPWZ1bmN0aW9uKGEpe3JldHVybiBhfTtiLmE9YTtiLmQ9Yy5kO3JldHVybiBifSgpLEVoPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe2Zvcig7OylpZihPKGIpPE8oYSkpe3ZhciBjPWE7YT1iO2I9Y31lbHNlIHJldHVybiBDLmMoZnVuY3Rpb24oYSxiKXtyZXR1cm4gZnVuY3Rpb24oYSxjKXtyZXR1cm4gT2MoYixjKT9hOkFjLmEoYSxjKX19KGEsYiksYSxhKX12YXIgYj1udWxsLGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGIsZCxrKXt2YXIgbD1udWxsOzI8YXJndW1lbnRzLmxlbmd0aCYmKGw9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMiksMCkpO3JldHVybiBjLmNhbGwodGhpcyxiLGQsbCl9ZnVuY3Rpb24gYyhhLGQsZSl7YT1DaChmdW5jdGlvbihhKXtyZXR1cm4tTyhhKX0sXG5wYy5kKGUsZCxKKFthXSwwKSkpO3JldHVybiBDLmMoYixGKGEpLEcoYSkpfWEuaz0yO2EuZj1mdW5jdGlvbihhKXt2YXIgYj1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9RyhhKTtyZXR1cm4gYyhiLGQsYSl9O2EuZD1jO3JldHVybiBhfSgpLGI9ZnVuY3Rpb24oYixlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGI7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxiLGUpO2RlZmF1bHQ6cmV0dXJuIGMuZChiLGUsSihhcmd1bWVudHMsMikpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtiLms9MjtiLmY9Yy5mO2IuYj1mdW5jdGlvbihhKXtyZXR1cm4gYX07Yi5hPWE7Yi5kPWMuZDtyZXR1cm4gYn0oKSxGaD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4gTyhhKTxPKGIpP0MuYyhmdW5jdGlvbihhLGMpe3JldHVybiBPYyhiLGMpP0FjLmEoYSxjKTphfSxhLGEpOkMuYyhBYyxhLGIpfXZhciBiPW51bGwsXG5jPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShiLGQsayl7dmFyIGw9bnVsbDsyPGFyZ3VtZW50cy5sZW5ndGgmJihsPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpLDApKTtyZXR1cm4gYy5jYWxsKHRoaXMsYixkLGwpfWZ1bmN0aW9uIGMoYSxkLGUpe3JldHVybiBDLmMoYixhLHBjLmEoZSxkKSl9YS5rPTI7YS5mPWZ1bmN0aW9uKGEpe3ZhciBiPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1HKGEpO3JldHVybiBjKGIsZCxhKX07YS5kPWM7cmV0dXJuIGF9KCksYj1mdW5jdGlvbihiLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYjtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGIsZSk7ZGVmYXVsdDpyZXR1cm4gYy5kKGIsZSxKKGFyZ3VtZW50cywyKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Iuaz0yO2IuZj1jLmY7Yi5iPWZ1bmN0aW9uKGEpe3JldHVybiBhfTtiLmE9YTtiLmQ9XG5jLmQ7cmV0dXJuIGJ9KCk7ZnVuY3Rpb24gR2goYSxiKXtyZXR1cm4gV2IuYShhLGIpP25ldyBXKG51bGwsMyw1LFgsW251bGwsbnVsbCxhXSxudWxsKTpuZXcgVyhudWxsLDMsNSxYLFthLGIsbnVsbF0sbnVsbCl9ZnVuY3Rpb24gSGgoYSl7cmV0dXJuIEUoYSk/Qy5jKGZ1bmN0aW9uKGEsYyl7dmFyIGQ9UC5jKGMsMCxudWxsKSxlPVAuYyhjLDEsbnVsbCk7cmV0dXJuIFIuYyhhLGQsZSl9LHdlKE9kLmEoUy5hKFhjLFZlKGEpKSxudWxsKSksYSk6bnVsbH1cbmZ1bmN0aW9uIEloKGEsYixjKXt2YXIgZD1RLmEoYSxjKSxlPVEuYShiLGMpLGY9SmguYT9KaC5hKGQsZSk6SmguY2FsbChudWxsLGQsZSksaD1QLmMoZiwwLG51bGwpLGs9UC5jKGYsMSxudWxsKSxmPVAuYyhmLDIsbnVsbCk7YT1PYyhhLGMpO2I9T2MoYixjKTtkPWEmJmImJihudWxsIT1mfHxudWxsPT1kJiZudWxsPT1lKTtyZXR1cm4gbmV3IFcobnVsbCwzLDUsWCxbIWF8fG51bGw9PWgmJmQ/bnVsbDpuZXcgYWYoW2MsaF0pLCFifHxudWxsPT1rJiZkP251bGw6bmV3IGFmKFtjLGtdKSxkP25ldyBhZihbYyxmXSk6bnVsbF0sbnVsbCl9XG52YXIgS2g9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjKXtyZXR1cm4gQy5jKGZ1bmN0aW9uKGEsYil7cmV0dXJuIHJnLmIoS2QuYyhaZixhLGIpKX0sbmV3IFcobnVsbCwzLDUsWCxbbnVsbCxudWxsLG51bGxdLG51bGwpLEtkLmEoSWQuYyhJaCxhLGIpLGMpKX1mdW5jdGlvbiBiKGEsYil7cmV0dXJuIGMuYyhhLGIsRGguYShWZShhKSxWZShiKSkpfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gYi5jYWxsKHRoaXMsYyxlKTtjYXNlIDM6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSxmKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5hPWI7Yy5jPWE7cmV0dXJuIGN9KCk7XG5mdW5jdGlvbiBMaChhLGIpe3JldHVybiB3ZShLZC5hKEhoLEtoLmMoSGMoYSk/YTp3ZShhKSxIYyhiKT9iOndlKGIpLHBnLmIoZnVuY3Rpb24oKXt2YXIgYz1PKGEpLGQ9TyhiKTtyZXR1cm4gYz5kP2M6ZH0oKSkpKSl9ZnVuY3Rpb24gTWgoYSxiKXtyZXR1cm4gbmV3IFcobnVsbCwzLDUsWCxbQ2QoRmguYShhLGIpKSxDZChGaC5hKGIsYSkpLENkKEVoLmEoYSxiKSldLG51bGwpfWZ1bmN0aW9uIE5oKGEpe2lmKGE/YS5xYzphKXJldHVybiBhLnFjKGEpO3ZhciBiO2I9TmhbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj1OaC5fLCFiKSl0aHJvdyB4KFwiRXF1YWxpdHlQYXJ0aXRpb24uZXF1YWxpdHktcGFydGl0aW9uXCIsYSk7cmV0dXJuIGIuY2FsbChudWxsLGEpfVxuZnVuY3Rpb24gT2goYSxiKXtpZihhP2EucGM6YSlyZXR1cm4gYS5wYyhhLGIpO3ZhciBjO2M9T2hbbShudWxsPT1hP251bGw6YSldO2lmKCFjJiYoYz1PaC5fLCFjKSl0aHJvdyB4KFwiRGlmZi5kaWZmLXNpbWlsYXJcIixhKTtyZXR1cm4gYy5jYWxsKG51bGwsYSxiKX1OaC5fPWZ1bmN0aW9uKGEpe3JldHVybihhP2EuaSYxMDI0fHxhLmNjfHwoYS5pPzA6cyhQYSxhKSk6cyhQYSxhKSk/Z2g6KGE/YS5pJjQwOTZ8fGEuamN8fChhLmk/MDpzKFZhLGEpKTpzKFZhLGEpKT9kaDooYT9hLmkmMTY3NzcyMTZ8fGEuaWN8fChhLmk/MDpzKG1iLGEpKTpzKG1iLGEpKT9ZZzpZYj9maDpudWxsfTtOaFtcImJvb2xlYW5cIl09ZnVuY3Rpb24oKXtyZXR1cm4gZmh9O05oW1wiZnVuY3Rpb25cIl09ZnVuY3Rpb24oKXtyZXR1cm4gZmh9O05oLmFycmF5PWZ1bmN0aW9uKCl7cmV0dXJuIFlnfTtOaC5udW1iZXI9ZnVuY3Rpb24oKXtyZXR1cm4gZmh9O05oLnN0cmluZz1mdW5jdGlvbigpe3JldHVybiBmaH07XG5OaFtcIm51bGxcIl09ZnVuY3Rpb24oKXtyZXR1cm4gZmh9O09oLl89ZnVuY3Rpb24oYSxiKXtyZXR1cm4gZnVuY3Rpb24oKXtzd2l0Y2goTmgoYSlpbnN0YW5jZW9mIFQ/TmgoYSkuc2E6bnVsbCl7Y2FzZSBcIm1hcFwiOnJldHVybiBLaDtjYXNlIFwic2VxdWVudGlhbFwiOnJldHVybiBMaDtjYXNlIFwic2V0XCI6cmV0dXJuIE1oO2Nhc2UgXCJhdG9tXCI6cmV0dXJuIEdoO2RlZmF1bHQ6dGhyb3cgRXJyb3IoXCJObyBtYXRjaGluZyBjbGF1c2U6IFwiK0EuYihOaChhKSkpO319KCkuY2FsbChudWxsLGEsYil9O09oW1wiYm9vbGVhblwiXT1mdW5jdGlvbihhLGIpe3JldHVybiBHaChhLGIpfTtPaFtcImZ1bmN0aW9uXCJdPWZ1bmN0aW9uKGEsYil7cmV0dXJuIEdoKGEsYil9O09oLmFycmF5PWZ1bmN0aW9uKGEsYil7cmV0dXJuIExoKGEsYil9O09oLm51bWJlcj1mdW5jdGlvbihhLGIpe3JldHVybiBHaChhLGIpfTtPaC5zdHJpbmc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gR2goYSxiKX07XG5PaFtcIm51bGxcIl09ZnVuY3Rpb24oYSxiKXtyZXR1cm4gR2goYSxiKX07ZnVuY3Rpb24gSmgoYSxiKXtyZXR1cm4gV2IuYShhLGIpP25ldyBXKG51bGwsMyw1LFgsW251bGwsbnVsbCxhXSxudWxsKTpXYi5hKE5oKGEpLE5oKGIpKT9PaChhLGIpOkdoKGEsYil9O2Z1bmN0aW9uIFBoKGEpe2lmKGE/YS5VYjphKXJldHVybiBhLlViKCk7dmFyIGI7Yj1QaFttKG51bGw9PWE/bnVsbDphKV07aWYoIWImJihiPVBoLl8sIWIpKXRocm93IHgoXCJQdXNoYmFja1JlYWRlci5yZWFkLWNoYXJcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9ZnVuY3Rpb24gUWgoYSxiKXtpZihhP2EuVmI6YSlyZXR1cm4gYS5WYigwLGIpO3ZhciBjO2M9UWhbbShudWxsPT1hP251bGw6YSldO2lmKCFjJiYoYz1RaC5fLCFjKSl0aHJvdyB4KFwiUHVzaGJhY2tSZWFkZXIudW5yZWFkXCIsYSk7cmV0dXJuIGMuY2FsbChudWxsLGEsYil9ZnVuY3Rpb24gUmgoYSxiLGMpe3RoaXMucj1hO3RoaXMuYnVmZmVyPWI7dGhpcy5GYj1jfVJoLnByb3RvdHlwZS5VYj1mdW5jdGlvbigpe3JldHVybiAwPT09dGhpcy5idWZmZXIubGVuZ3RoPyh0aGlzLkZiKz0xLHRoaXMuclt0aGlzLkZiXSk6dGhpcy5idWZmZXIucG9wKCl9O1JoLnByb3RvdHlwZS5WYj1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmJ1ZmZlci5wdXNoKGIpfTtcbmZ1bmN0aW9uIFNoKGEpe3ZhciBiPSEvW15cXHRcXG5cXHIgXS8udGVzdChhKTtyZXR1cm4gcihiKT9iOlwiLFwiPT09YX12YXIgVGg9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsZCl7dmFyIGU9bnVsbDsxPGFyZ3VtZW50cy5sZW5ndGgmJihlPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsMCxlKX1mdW5jdGlvbiBiKGEsYil7dGhyb3cgRXJyb3IoUy5hKEEsYikpO31hLms9MTthLmY9ZnVuY3Rpb24oYSl7RihhKTthPUcoYSk7cmV0dXJuIGIoMCxhKX07YS5kPWI7cmV0dXJuIGF9KCk7XG5mdW5jdGlvbiBVaChhLGIpe2Zvcih2YXIgYz1uZXcgZWEoYiksZD1QaChhKTs7KXt2YXIgZTtpZighKGU9bnVsbD09ZHx8U2goZCkpKXtlPWQ7dmFyIGY9XCIjXCIhPT1lO2U9Zj8oZj1cIidcIiE9PWUpPyhmPVwiOlwiIT09ZSk/VmguYj9WaC5iKGUpOlZoLmNhbGwobnVsbCxlKTpmOmY6Zn1pZihlKXJldHVybiBRaChhLGQpLGMudG9TdHJpbmcoKTtjLmFwcGVuZChkKTtkPVBoKGEpfX1mdW5jdGlvbiBXaChhKXtmb3IoOzspe3ZhciBiPVBoKGEpO2lmKFwiXFxuXCI9PT1ifHxcIlxcclwiPT09Ynx8bnVsbD09YilyZXR1cm4gYX19dmFyIFhoPXRnKFwiXihbLStdPykoPzooMCl8KFsxLTldWzAtOV0qKXwwW3hYXShbMC05QS1GYS1mXSspfDAoWzAtN10rKXwoWzEtOV1bMC05XT8pW3JSXShbMC05QS1aYS16XSspKShOKT8kXCIpLFloPXRnKFwiXihbLStdP1swLTldKykvKFswLTldKykkXCIpLFpoPXRnKFwiXihbLStdP1swLTldKyhcXFxcLlswLTldKik/KFtlRV1bLStdP1swLTldKyk/KShNKT8kXCIpLCRoPXRnKFwiXls6XT8oW14wLTkvXS4qLyk/KFteMC05L11bXi9dKikkXCIpO1xuZnVuY3Rpb24gYWkoYSxiKXt2YXIgYz1hLmV4ZWMoYik7cmV0dXJuIG51bGwhPWMmJmNbMF09PT1iPzE9PT1jLmxlbmd0aD9jWzBdOmM6bnVsbH12YXIgYmk9dGcoXCJeWzAtOUEtRmEtZl17Mn0kXCIpLGNpPXRnKFwiXlswLTlBLUZhLWZdezR9JFwiKTtmdW5jdGlvbiBkaShhLGIsYyxkKXtyZXR1cm4gcihzZyhhLGQpKT9kOlRoLmQoYixKKFtcIlVuZXhwZWN0ZWQgdW5pY29kZSBlc2NhcGUgXFxcXFwiLGMsZF0sMCkpfWZ1bmN0aW9uIGVpKGEpe3JldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKHBhcnNlSW50KGEsMTYpKX1cbmZ1bmN0aW9uIGZpKGEpe3ZhciBiPVBoKGEpLGM9XCJ0XCI9PT1iP1wiXFx0XCI6XCJyXCI9PT1iP1wiXFxyXCI6XCJuXCI9PT1iP1wiXFxuXCI6XCJcXFxcXCI9PT1iP1wiXFxcXFwiOidcIic9PT1iPydcIic6XCJiXCI9PT1iP1wiXFxiXCI6XCJmXCI9PT1iP1wiXFxmXCI6bnVsbDtyKGMpP2E9YzpcInhcIj09PWI/KGM9KG5ldyBlYShQaChhKSxQaChhKSkpLnRvU3RyaW5nKCksYT1laShkaShiaSxhLGIsYykpKTpcInVcIj09PWI/KGM9KG5ldyBlYShQaChhKSxQaChhKSxQaChhKSxQaChhKSkpLnRvU3RyaW5nKCksYT1laShkaShjaSxhLGIsYykpKTphPS9bXjAtOV0vLnRlc3QoYik/dT9UaC5kKGEsSihbXCJVbmV4cGVjdGVkIHVuaWNvZGUgZXNjYXBlIFxcXFxcIixiXSwwKSk6bnVsbDpTdHJpbmcuZnJvbUNoYXJDb2RlKGIpO3JldHVybiBhfVxuZnVuY3Rpb24gZ2koYSxiKXtmb3IodmFyIGM9eWIocWUpOzspe3ZhciBkO2E6e2Q9U2g7Zm9yKHZhciBlPWIsZj1QaChlKTs7KWlmKHIoZC5iP2QuYihmKTpkLmNhbGwobnVsbCxmKSkpZj1QaChlKTtlbHNle2Q9ZjticmVhayBhfWQ9dm9pZCAwfXIoZCl8fFRoLmQoYixKKFtcIkVPRiB3aGlsZSByZWFkaW5nXCJdLDApKTtpZihhPT09ZClyZXR1cm4gQWIoYyk7ZT1WaC5iP1ZoLmIoZCk6VmguY2FsbChudWxsLGQpO3IoZSk/ZD1lLmE/ZS5hKGIsZCk6ZS5jYWxsKG51bGwsYixkKTooUWgoYixkKSxkPWhpLm4/aGkubihiLCEwLG51bGwsITApOmhpLmNhbGwobnVsbCxiLCEwLG51bGwpKTtjPWQ9PT1iP2M6d2QuYShjLGQpfX1mdW5jdGlvbiBpaShhLGIpe3JldHVybiBUaC5kKGEsSihbXCJSZWFkZXIgZm9yIFwiLGIsXCIgbm90IGltcGxlbWVudGVkIHlldFwiXSwwKSl9XG5mdW5jdGlvbiBqaShhLGIpe3ZhciBjPVBoKGEpLGQ9a2kuYj9raS5iKGMpOmtpLmNhbGwobnVsbCxjKTtpZihyKGQpKXJldHVybiBkLmE/ZC5hKGEsYik6ZC5jYWxsKG51bGwsYSxiKTtkPWxpLmE/bGkuYShhLGMpOmxpLmNhbGwobnVsbCxhLGMpO3JldHVybiByKGQpP2Q6VGguZChhLEooW1wiTm8gZGlzcGF0Y2ggbWFjcm8gZm9yIFwiLGNdLDApKX1mdW5jdGlvbiBtaShhLGIpe3JldHVybiBUaC5kKGEsSihbXCJVbm1hY2hlZCBkZWxpbWl0ZXIgXCIsYl0sMCkpfWZ1bmN0aW9uIG5pKGEpe3JldHVybiBTLmEoZmQsZ2koXCIpXCIsYSkpfWZ1bmN0aW9uIG9pKGEpe3JldHVybiBnaShcIl1cIixhKX1cbmZ1bmN0aW9uIHBpKGEpe3ZhciBiPWdpKFwifVwiLGEpLGM9TyhiKTtpZihcIm51bWJlclwiIT09dHlwZW9mIGN8fGlzTmFOKGMpfHxJbmZpbml0eT09PWN8fHBhcnNlRmxvYXQoYykhPT1wYXJzZUludChjLDEwKSl0aHJvdyBFcnJvcihcIkFyZ3VtZW50IG11c3QgYmUgYW4gaW50ZWdlcjogXCIrQS5iKGMpKTswIT09KGMmMSkmJlRoLmQoYSxKKFtcIk1hcCBsaXRlcmFsIG11c3QgY29udGFpbiBhbiBldmVuIG51bWJlciBvZiBmb3Jtc1wiXSwwKSk7cmV0dXJuIFMuYShUZixiKX1mdW5jdGlvbiBxaShhKXtmb3IodmFyIGI9bmV3IGVhLGM9UGgoYSk7Oyl7aWYobnVsbD09YylyZXR1cm4gVGguZChhLEooW1wiRU9GIHdoaWxlIHJlYWRpbmdcIl0sMCkpO2lmKFwiXFxcXFwiPT09YyliLmFwcGVuZChmaShhKSksYz1QaChhKTtlbHNle2lmKCdcIic9PT1jKXJldHVybiBiLnRvU3RyaW5nKCk7aWYoWWIpYi5hcHBlbmQoYyksYz1QaChhKTtlbHNlIHJldHVybiBudWxsfX19XG5mdW5jdGlvbiByaShhKXtmb3IodmFyIGI9bmV3IGVhLGM9UGgoYSk7Oyl7aWYobnVsbD09YylyZXR1cm4gVGguZChhLEooW1wiRU9GIHdoaWxlIHJlYWRpbmdcIl0sMCkpO2lmKFwiXFxcXFwiPT09Yyl7Yi5hcHBlbmQoYyk7dmFyIGQ9UGgoYSk7aWYobnVsbD09ZClyZXR1cm4gVGguZChhLEooW1wiRU9GIHdoaWxlIHJlYWRpbmdcIl0sMCkpO3ZhciBlPWZ1bmN0aW9uKCl7dmFyIGE9YjthLmFwcGVuZChkKTtyZXR1cm4gYX0oKSxmPVBoKGEpLGI9ZSxjPWZ9ZWxzZXtpZignXCInPT09YylyZXR1cm4gYi50b1N0cmluZygpO2lmKHUpZT1mdW5jdGlvbigpe3ZhciBhPWI7YS5hcHBlbmQoYyk7cmV0dXJuIGF9KCksZj1QaChhKSxiPWUsYz1mO2Vsc2UgcmV0dXJuIG51bGx9fX1cbmZ1bmN0aW9uIHNpKGEsYil7dmFyIGM9VWgoYSxiKTtpZihyKC0xIT1jLmluZGV4T2YoXCIvXCIpKSljPSRiLmEoYWQuYyhjLDAsYy5pbmRleE9mKFwiL1wiKSksYWQuYyhjLGMuaW5kZXhPZihcIi9cIikrMSxjLmxlbmd0aCkpO2Vsc2UgdmFyIGQ9JGIuYihjKSxjPVwibmlsXCI9PT1jP251bGw6XCJ0cnVlXCI9PT1jPyEwOlwiZmFsc2VcIj09PWM/ITE6dT9kOm51bGw7cmV0dXJuIGN9ZnVuY3Rpb24gdGkoYSl7dmFyIGI9VWgoYSxQaChhKSksYz1haSgkaCxiKSxiPWNbMF0sZD1jWzFdLGM9Y1syXTtyZXR1cm4gdm9pZCAwIT09ZCYmXCI6L1wiPT09ZC5zdWJzdHJpbmcoZC5sZW5ndGgtMixkLmxlbmd0aCl8fFwiOlwiPT09Y1tjLmxlbmd0aC0xXXx8LTEhPT1iLmluZGV4T2YoXCI6OlwiLDEpP1RoLmQoYSxKKFtcIkludmFsaWQgdG9rZW46IFwiLGJdLDApKTpudWxsIT1kJiYwPGQubGVuZ3RoP2pkLmEoZC5zdWJzdHJpbmcoMCxkLmluZGV4T2YoXCIvXCIpKSxjKTpqZC5iKGIpfVxuZnVuY3Rpb24gdWkoYSl7cmV0dXJuIGZ1bmN0aW9uKGIpe3JldHVybiBEYShEYShILGhpLm4/aGkubihiLCEwLG51bGwsITApOmhpLmNhbGwobnVsbCxiLCEwLG51bGwpKSxhKX19ZnVuY3Rpb24gdmkoKXtyZXR1cm4gZnVuY3Rpb24oYSl7cmV0dXJuIFRoLmQoYSxKKFtcIlVucmVhZGFibGUgZm9ybVwiXSwwKSl9fVxuZnVuY3Rpb24gd2koYSl7dmFyIGI7Yj1oaS5uP2hpLm4oYSwhMCxudWxsLCEwKTpoaS5jYWxsKG51bGwsYSwhMCxudWxsKTtiPWIgaW5zdGFuY2VvZiBaYj9uZXcgbGEobnVsbCwxLFtjaCxiXSxudWxsKTpcInN0cmluZ1wiPT09dHlwZW9mIGI/bmV3IGxhKG51bGwsMSxbY2gsYl0sbnVsbCk6YiBpbnN0YW5jZW9mIFQ/bmV3IGFmKFtiLCEwXSk6dT9iOm51bGw7R2MoYil8fFRoLmQoYSxKKFtcIk1ldGFkYXRhIG11c3QgYmUgU3ltYm9sLEtleXdvcmQsU3RyaW5nIG9yIE1hcFwiXSwwKSk7dmFyIGM9aGkubj9oaS5uKGEsITAsbnVsbCwhMCk6aGkuY2FsbChudWxsLGEsITAsbnVsbCk7cmV0dXJuKGM/Yy5pJjI2MjE0NHx8Yy5vY3x8KGMuaT8wOnMoZGIsYykpOnMoZGIsYykpP04oYyxaZi5kKEooW3hjKGMpLGJdLDApKSk6VGguZChhLEooW1wiTWV0YWRhdGEgY2FuIG9ubHkgYmUgYXBwbGllZCB0byBJV2l0aE1ldGFzXCJdLDApKX1mdW5jdGlvbiB4aShhKXtyZXR1cm4gZWcoZ2koXCJ9XCIsYSkpfVxuZnVuY3Rpb24geWkoYSl7cmV0dXJuIHRnKHJpKGEpKX1mdW5jdGlvbiB6aShhKXtoaS5uP2hpLm4oYSwhMCxudWxsLCEwKTpoaS5jYWxsKG51bGwsYSwhMCxudWxsKTtyZXR1cm4gYX1mdW5jdGlvbiBWaChhKXtyZXR1cm4nXCInPT09YT9xaTpcIjpcIj09PWE/dGk6XCI7XCI9PT1hP1doOlwiJ1wiPT09YT91aShuZXcgWmIobnVsbCxcInF1b3RlXCIsXCJxdW90ZVwiLDEzNzc5MTYyODIsbnVsbCkpOlwiQFwiPT09YT91aShuZXcgWmIobnVsbCxcImRlcmVmXCIsXCJkZXJlZlwiLDE0OTQ5NDQ3MzIsbnVsbCkpOlwiXlwiPT09YT93aTpcImBcIj09PWE/aWk6XCJ+XCI9PT1hP2lpOlwiKFwiPT09YT9uaTpcIilcIj09PWE/bWk6XCJbXCI9PT1hP29pOlwiXVwiPT09YT9taTpcIntcIj09PWE/cGk6XCJ9XCI9PT1hP21pOlwiXFxcXFwiPT09YT9QaDpcIiNcIj09PWE/amk6bnVsbH1mdW5jdGlvbiBraShhKXtyZXR1cm5cIntcIj09PWE/eGk6XCJcXHgzY1wiPT09YT92aSgpOidcIic9PT1hP3lpOlwiIVwiPT09YT9XaDpcIl9cIj09PWE/emk6bnVsbH1cbmZ1bmN0aW9uIGhpKGEsYixjKXtmb3IoOzspe3ZhciBkPVBoKGEpO2lmKG51bGw9PWQpcmV0dXJuIHIoYik/VGguZChhLEooW1wiRU9GIHdoaWxlIHJlYWRpbmdcIl0sMCkpOmM7aWYoIVNoKGQpKWlmKFwiO1wiPT09ZClhPVdoLmE/V2guYShhLGQpOldoLmNhbGwobnVsbCxhKTtlbHNlIGlmKHUpe3ZhciBlPVZoKGQpO2lmKHIoZSkpZT1lLmE/ZS5hKGEsZCk6ZS5jYWxsKG51bGwsYSxkKTtlbHNle3ZhciBlPWEsZj12b2lkIDA7IShmPSEvW14wLTldLy50ZXN0KGQpKSYmKGY9dm9pZCAwLGY9XCIrXCI9PT1kfHxcIi1cIj09PWQpJiYoZj1QaChlKSxRaChlLGYpLGY9IS9bXjAtOV0vLnRlc3QoZikpO2lmKGYpYTp7ZT1hO2Q9bmV3IGVhKGQpO2ZvcihmPVBoKGUpOzspe3ZhciBoO2g9bnVsbD09ZjtofHwoaD0oaD1TaChmKSk/aDpWaC5iP1ZoLmIoZik6VmguY2FsbChudWxsLGYpKTtpZihyKGgpKXtRaChlLGYpO2Y9ZD1kLnRvU3RyaW5nKCk7aD12b2lkIDA7aWYocihhaShYaCxmKSkpaWYoZj1haShYaCxcbmYpLG51bGwhPWZbMl0paD0wO2Vsc2V7aD1yKGZbM10pP1tmWzNdLDEwXTpyKGZbNF0pP1tmWzRdLDE2XTpyKGZbNV0pP1tmWzVdLDhdOnIoZls2XSk/W2ZbN10scGFyc2VJbnQoZls2XSwxMCldOnU/W251bGwsbnVsbF06bnVsbDt2YXIgaz1oWzBdO251bGw9PWs/aD1udWxsOihoPXBhcnNlSW50KGssaFsxXSksaD1cIi1cIj09PWZbMV0/LWg6aCl9ZWxzZSBoPXZvaWQgMCxyKGFpKFloLGYpKT8oZj1haShZaCxmKSxoPXBhcnNlSW50KGZbMV0sMTApL3BhcnNlSW50KGZbMl0sMTApKTpoPXIoYWkoWmgsZikpP3BhcnNlRmxvYXQoZik6bnVsbDtmPWg7ZT1yKGYpP2Y6VGguZChlLEooW1wiSW52YWxpZCBudW1iZXIgZm9ybWF0IFtcIixkLFwiXVwiXSwwKSk7YnJlYWsgYX1kLmFwcGVuZChmKTtmPVBoKGUpfWU9dm9pZCAwfWVsc2UgZT11P3NpKGEsZCk6bnVsbH1pZihlIT09YSlyZXR1cm4gZX1lbHNlIHJldHVybiBudWxsfX1cbmZ1bmN0aW9uIEFpKGEpe2lmKFdiLmEoMyxPKGEpKSlyZXR1cm4gYTtpZigzPE8oYSkpcmV0dXJuIGFkLmMoYSwwLDMpO2lmKHUpZm9yKGE9bmV3IGVhKGEpOzspaWYoMz5hLlZhLmxlbmd0aClhPWEuYXBwZW5kKFwiMFwiKTtlbHNlIHJldHVybiBhLnRvU3RyaW5nKCk7ZWxzZSByZXR1cm4gbnVsbH12YXIgQmk9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gZnVuY3Rpb24oYyxkKXtyZXR1cm4gUS5hKHIoZCk/YjphLGMpfX0obmV3IFcobnVsbCwxMyw1LFgsW251bGwsMzEsMjgsMzEsMzAsMzEsMzAsMzEsMzEsMzAsMzEsMzAsMzFdLG51bGwpLG5ldyBXKG51bGwsMTMsNSxYLFtudWxsLDMxLDI5LDMxLDMwLDMxLDMwLDMxLDMxLDMwLDMxLDMwLDMxXSxudWxsKSksQ2k9LyhcXGRcXGRcXGRcXGQpKD86LShcXGRcXGQpKD86LShcXGRcXGQpKD86W1RdKFxcZFxcZCkoPzo6KFxcZFxcZCkoPzo6KFxcZFxcZCkoPzpbLl0oXFxkKykpPyk/KT8pPyk/KT8oPzpbWl18KFstK10pKFxcZFxcZCk6KFxcZFxcZCkpPy87XG5mdW5jdGlvbiBEaShhKXthPXBhcnNlSW50KGEsMTApO3JldHVybiBzYShpc05hTihhKSk/YTpudWxsfWZ1bmN0aW9uIEVpKGEsYixjLGQpe2E8PWImJmI8PWN8fFRoLmQobnVsbCxKKFtcIlwiK0EuYihkKStcIiBGYWlsZWQ6ICBcIitBLmIoYSkrXCJcXHgzY1xceDNkXCIrQS5iKGIpK1wiXFx4M2NcXHgzZFwiK0EuYihjKV0sMCkpO3JldHVybiBifVxuZnVuY3Rpb24gRmkoYSl7dmFyIGI9c2coQ2ksYSk7UC5jKGIsMCxudWxsKTt2YXIgYz1QLmMoYiwxLG51bGwpLGQ9UC5jKGIsMixudWxsKSxlPVAuYyhiLDMsbnVsbCksZj1QLmMoYiw0LG51bGwpLGg9UC5jKGIsNSxudWxsKSxrPVAuYyhiLDYsbnVsbCksbD1QLmMoYiw3LG51bGwpLG49UC5jKGIsOCxudWxsKSxxPVAuYyhiLDksbnVsbCksdD1QLmMoYiwxMCxudWxsKTtpZihzYShiKSlyZXR1cm4gVGguZChudWxsLEooW1wiVW5yZWNvZ25pemVkIGRhdGUvdGltZSBzeW50YXg6IFwiK0EuYihhKV0sMCkpO2E9RGkoYyk7dmFyIGI9ZnVuY3Rpb24oKXt2YXIgYT1EaShkKTtyZXR1cm4gcihhKT9hOjF9KCksYz1mdW5jdGlvbigpe3ZhciBhPURpKGUpO3JldHVybiByKGEpP2E6MX0oKSx2PWZ1bmN0aW9uKCl7dmFyIGE9RGkoZik7cmV0dXJuIHIoYSk/YTowfSgpLHc9ZnVuY3Rpb24oKXt2YXIgYT1EaShoKTtyZXR1cm4gcihhKT9hOjB9KCkseT1mdW5jdGlvbigpe3ZhciBhPURpKGspO3JldHVybiByKGEpP1xuYTowfSgpLEI9ZnVuY3Rpb24oKXt2YXIgYT1EaShBaShsKSk7cmV0dXJuIHIoYSk/YTowfSgpLG49KFdiLmEobixcIi1cIik/LTE6MSkqKDYwKmZ1bmN0aW9uKCl7dmFyIGE9RGkocSk7cmV0dXJuIHIoYSk/YTowfSgpK2Z1bmN0aW9uKCl7dmFyIGE9RGkodCk7cmV0dXJuIHIoYSk/YTowfSgpKTtyZXR1cm4gbmV3IFcobnVsbCw4LDUsWCxbYSxFaSgxLGIsMTIsXCJ0aW1lc3RhbXAgbW9udGggZmllbGQgbXVzdCBiZSBpbiByYW5nZSAxLi4xMlwiKSxFaSgxLGMsQmkuYT9CaS5hKGIsMD09PShhJTQrNCklNCYmKDAhPT0oYSUxMDArMTAwKSUxMDB8fDA9PT0oYSU0MDArNDAwKSU0MDApKTpCaS5jYWxsKG51bGwsYiwwPT09KGElNCs0KSU0JiYoMCE9PShhJTEwMCsxMDApJTEwMHx8MD09PShhJTQwMCs0MDApJTQwMCkpLFwidGltZXN0YW1wIGRheSBmaWVsZCBtdXN0IGJlIGluIHJhbmdlIDEuLmxhc3QgZGF5IGluIG1vbnRoXCIpLEVpKDAsdiwyMyxcInRpbWVzdGFtcCBob3VyIGZpZWxkIG11c3QgYmUgaW4gcmFuZ2UgMC4uMjNcIiksXG5FaSgwLHcsNTksXCJ0aW1lc3RhbXAgbWludXRlIGZpZWxkIG11c3QgYmUgaW4gcmFuZ2UgMC4uNTlcIiksRWkoMCx5LFdiLmEodyw1OSk/NjA6NTksXCJ0aW1lc3RhbXAgc2Vjb25kIGZpZWxkIG11c3QgYmUgaW4gcmFuZ2UgMC4uNjBcIiksRWkoMCxCLDk5OSxcInRpbWVzdGFtcCBtaWxsaXNlY29uZCBmaWVsZCBtdXN0IGJlIGluIHJhbmdlIDAuLjk5OVwiKSxuXSxudWxsKX1cbnZhciBHaT1IZy5iKG5ldyBsYShudWxsLDQsW1wiaW5zdFwiLGZ1bmN0aW9uKGEpe3ZhciBiO2lmKFwic3RyaW5nXCI9PT10eXBlb2YgYSlpZihiPUZpKGEpLHIoYikpe2E9UC5jKGIsMCxudWxsKTt2YXIgYz1QLmMoYiwxLG51bGwpLGQ9UC5jKGIsMixudWxsKSxlPVAuYyhiLDMsbnVsbCksZj1QLmMoYiw0LG51bGwpLGg9UC5jKGIsNSxudWxsKSxrPVAuYyhiLDYsbnVsbCk7Yj1QLmMoYiw3LG51bGwpO2I9bmV3IERhdGUoRGF0ZS5VVEMoYSxjLTEsZCxlLGYsaCxrKS02RTQqYil9ZWxzZSBiPVRoLmQobnVsbCxKKFtcIlVucmVjb2duaXplZCBkYXRlL3RpbWUgc3ludGF4OiBcIitBLmIoYSldLDApKTtlbHNlIGI9VGguZChudWxsLEooW1wiSW5zdGFuY2UgbGl0ZXJhbCBleHBlY3RzIGEgc3RyaW5nIGZvciBpdHMgdGltZXN0YW1wLlwiXSwwKSk7cmV0dXJuIGJ9LFwidXVpZFwiLGZ1bmN0aW9uKGEpe3JldHVyblwic3RyaW5nXCI9PT10eXBlb2YgYT9uZXcgVGcoYSk6VGguZChudWxsLEooW1wiVVVJRCBsaXRlcmFsIGV4cGVjdHMgYSBzdHJpbmcgYXMgaXRzIHJlcHJlc2VudGF0aW9uLlwiXSxcbjApKX0sXCJxdWV1ZVwiLGZ1bmN0aW9uKGEpe3JldHVybiBIYyhhKT9ZZChKZSxhKTpUaC5kKG51bGwsSihbXCJRdWV1ZSBsaXRlcmFsIGV4cGVjdHMgYSB2ZWN0b3IgZm9yIGl0cyBlbGVtZW50cy5cIl0sMCkpfSxcImpzXCIsZnVuY3Rpb24oYSl7aWYoSGMoYSkpe3ZhciBiPVtdO2E9RShhKTtmb3IodmFyIGM9bnVsbCxkPTAsZT0wOzspaWYoZTxkKXt2YXIgZj1jLkoobnVsbCxlKTtiLnB1c2goZik7ZSs9MX1lbHNlIGlmKGE9RShhKSljPWEsSWMoYyk/KGE9SGIoYyksZT1JYihjKSxjPWEsZD1PKGEpLGE9ZSk6KGE9RihjKSxiLnB1c2goYSksYT1JKGMpLGM9bnVsbCxkPTApLGU9MDtlbHNlIGJyZWFrO3JldHVybiBifWlmKEdjKGEpKXtiPXt9O2E9RShhKTtjPW51bGw7Zm9yKGU9ZD0wOzspaWYoZTxkKXt2YXIgaD1jLkoobnVsbCxlKSxmPVAuYyhoLDAsbnVsbCksaD1QLmMoaCwxLG51bGwpO2JbaWQoZildPWg7ZSs9MX1lbHNlIGlmKGE9RShhKSlJYyhhKT8oZD1IYihhKSxhPUliKGEpLGM9ZCxcbmQ9TyhkKSk6KGQ9RihhKSxjPVAuYyhkLDAsbnVsbCksZD1QLmMoZCwxLG51bGwpLGJbaWQoYyldPWQsYT1JKGEpLGM9bnVsbCxkPTApLGU9MDtlbHNlIGJyZWFrO3JldHVybiBifXJldHVybiB1P1RoLmQobnVsbCxKKFtcIkpTIGxpdGVyYWwgZXhwZWN0cyBhIHZlY3RvciBvciBtYXAgY29udGFpbmluZyBvbmx5IHN0cmluZyBvciB1bnF1YWxpZmllZCBrZXl3b3JkIGtleXNcIl0sMCkpOm51bGx9XSxudWxsKSksSGk9SGcuYihudWxsKTtcbmZ1bmN0aW9uIGxpKGEsYil7dmFyIGM9c2koYSxiKSxkPVEuYShhYihHaSksXCJcIitBLmIoYykpLGU9YWIoSGkpO3JldHVybiByKGQpP2QuYj9kLmIoaGkoYSwhMCxudWxsKSk6ZC5jYWxsKG51bGwsaGkoYSwhMCxudWxsKSk6cihlKT9lLmE/ZS5hKGMsaGkoYSwhMCxudWxsKSk6ZS5jYWxsKG51bGwsYyxoaShhLCEwLG51bGwpKTp1P1RoLmQoYSxKKFtcIkNvdWxkIG5vdCBmaW5kIHRhZyBwYXJzZXIgZm9yIFwiLFwiXCIrQS5iKGMpLFwiIGluIFwiLENnLmQoSihbVmUoYWIoR2kpKV0sMCkpXSwwKSk6bnVsbH07cChcIm1vcmkuYXBwbHlcIixTKTtwKFwibW9yaS5jb3VudFwiLE8pO3AoXCJtb3JpLmRpc3RpbmN0XCIsZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uIGMoYSxlKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbihhLGQpe2Zvcig7Oyl7dmFyIGU9YSxsPVAuYyhlLDAsbnVsbCk7aWYoZT1FKGUpKWlmKE9jKGQsbCkpbD1HKGUpLGU9ZCxhPWwsZD1lO2Vsc2UgcmV0dXJuIE0obCxjKEcoZSkscGMuYShkLGwpKSk7ZWxzZSByZXR1cm4gbnVsbH19LmNhbGwobnVsbCxhLGUpfSxudWxsLG51bGwpfShhLGJnKX0pO3AoXCJtb3JpLmVtcHR5XCIscWMpO3AoXCJtb3JpLmZpcnN0XCIsRik7cChcIm1vcmkucmVzdFwiLEcpO3AoXCJtb3JpLnNlcVwiLEUpO3AoXCJtb3JpLmNvbmpcIixwYyk7cChcIm1vcmkuY29uc1wiLE0pO1xucChcIm1vcmkuZmluZFwiLGZ1bmN0aW9uKGEsYil7cmV0dXJuIG51bGwhPWEmJkVjKGEpJiZPYyhhLGIpP25ldyBXKG51bGwsMiw1LFgsW2IsUS5hKGEsYildLG51bGwpOm51bGx9KTtwKFwibW9yaS5udGhcIixQKTtwKFwibW9yaS5sYXN0XCIsb2MpO3AoXCJtb3JpLmFzc29jXCIsUik7cChcIm1vcmkuZGlzc29jXCIsdGMpO3AoXCJtb3JpLmdldF9pblwiLCRkKTtwKFwibW9yaS51cGRhdGVfaW5cIixhZSk7cChcIm1vcmkuYXNzb2NfaW5cIixmdW5jdGlvbiBJaShiLGMsZCl7dmFyIGU9UC5jKGMsMCxudWxsKTtyZXR1cm4oYz0kYyhjKSk/Ui5jKGIsZSxJaShRLmEoYixlKSxjLGQpKTpSLmMoYixlLGQpfSk7cChcIm1vcmkuZm5pbFwiLEpkKTtwKFwibW9yaS5kaXNqXCIsQWMpO3AoXCJtb3JpLnBvcFwiLHpjKTtwKFwibW9yaS5wZWVrXCIseWMpO3AoXCJtb3JpLmhhc2hcIixUYik7cChcIm1vcmkuZ2V0XCIsUSk7cChcIm1vcmkuaGFzX2tleVwiLE9jKTtwKFwibW9yaS5pc19lbXB0eVwiLEJjKTtwKFwibW9yaS5yZXZlcnNlXCIsZWQpO1xucChcIm1vcmkudGFrZVwiLE1kKTtwKFwibW9yaS5kcm9wXCIsTmQpO3AoXCJtb3JpLnRha2VfbnRoXCIsZnVuY3Rpb24gSmkoYixjKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbigpe3ZhciBkPUUoYyk7cmV0dXJuIGQ/TShGKGQpLEppKGIsTmQoYixkKSkpOm51bGx9LG51bGwsbnVsbCl9KTtwKFwibW9yaS5wYXJ0aXRpb25cIixaZCk7cChcIm1vcmkucGFydGl0aW9uX2FsbFwiLGpnKTtwKFwibW9yaS5wYXJ0aXRpb25fYnlcIixmdW5jdGlvbiBLaShiLGMpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7dmFyIGQ9RShjKTtpZihkKXt2YXIgZT1GKGQpLGY9Yi5iP2IuYihlKTpiLmNhbGwobnVsbCxlKSxlPU0oZSxsZyhmdW5jdGlvbihjLGQpe3JldHVybiBmdW5jdGlvbihjKXtyZXR1cm4gV2IuYShkLGIuYj9iLmIoYyk6Yi5jYWxsKG51bGwsYykpfX0oZSxmLGQsZCksSShkKSkpO3JldHVybiBNKGUsS2koYixFKE5kKE8oZSksZCkpKSl9cmV0dXJuIG51bGx9LG51bGwsbnVsbCl9KTtcbnAoXCJtb3JpLml0ZXJhdGVcIixmdW5jdGlvbiBMaShiLGMpe3JldHVybiBNKGMsbmV3IFYobnVsbCxmdW5jdGlvbigpe3JldHVybiBMaShiLGIuYj9iLmIoYyk6Yi5jYWxsKG51bGwsYykpfSxudWxsLG51bGwpKX0pO3AoXCJtb3JpLmludG9cIixZZCk7cChcIm1vcmkubWVyZ2VcIixaZik7cChcIm1vcmkuc3VidmVjXCIsemUpO3AoXCJtb3JpLnRha2Vfd2hpbGVcIixsZyk7cChcIm1vcmkuZHJvcF93aGlsZVwiLGZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBWKG51bGwsZnVuY3Rpb24oYyl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGMoYSxiKX19KGZ1bmN0aW9uKGEsYil7Zm9yKDs7KXt2YXIgZT1FKGIpLGY7Zj0oZj1lKT9hLmI/YS5iKEYoZSkpOmEuY2FsbChudWxsLEYoZSkpOmY7aWYocihmKSlmPWEsZT1HKGUpLGE9ZixiPWU7ZWxzZSByZXR1cm4gZX19KSxudWxsLG51bGwpfSk7XG5wKFwibW9yaS5ncm91cF9ieVwiLGZ1bmN0aW9uKGEsYil7cmV0dXJuIEMuYyhmdW5jdGlvbihiLGQpe3ZhciBlPWEuYj9hLmIoZCk6YS5jYWxsKG51bGwsZCk7cmV0dXJuIFIuYyhiLGUscGMuYShRLmMoYixlLHFlKSxkKSl9LFllLGIpfSk7cChcIm1vcmkuaW50ZXJwb3NlXCIsZnVuY3Rpb24oYSxiKXtyZXR1cm4gTmQoMSxRZC5hKE9kLmIoYSksYikpfSk7cChcIm1vcmkuaW50ZXJsZWF2ZVwiLFFkKTtwKFwibW9yaS5jb25jYXRcIix0ZCk7cChcIm1vcmkuY29uajFcIixmdW5jdGlvbihhLGIpe3JldHVybiBhLkcobnVsbCxiKX0pO2Z1bmN0aW9uIFhkKGEpe3JldHVybiBhIGluc3RhbmNlb2YgQXJyYXl8fEZjKGEpfXAoXCJtb3JpLmZsYXR0ZW5cIixmdW5jdGlvbihhKXtyZXR1cm4gVWQoZnVuY3Rpb24oYSl7cmV0dXJuIVhkKGEpfSxHKFdkKGEpKSl9KTtwKFwibW9yaS5sYXp5X3NlcVwiLGZ1bmN0aW9uKGEpe3JldHVybiBuZXcgVihudWxsLGEsbnVsbCxudWxsKX0pO3AoXCJtb3JpLmtleXNcIixWZSk7XG5wKFwibW9yaS5zZWxlY3Rfa2V5c1wiLGZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPVllLGQ9RShiKTs7KWlmKGQpdmFyIGU9RihkKSxmPVEuYyhhLGUsaWgpLGM9QmQuYShmLGloKT9SLmMoYyxlLGYpOmMsZD1JKGQpO2Vsc2UgcmV0dXJuIGN9KTtwKFwibW9yaS52YWxzXCIsV2UpO3AoXCJtb3JpLnByaW1fc2VxXCIsbWMpO3AoXCJtb3JpLm1hcFwiLEtkKTtwKFwibW9yaS5tYXBjYXRcIixTZCk7cChcIm1vcmkucmVkdWNlXCIsQyk7cChcIm1vcmkucmVkdWNlX2t2XCIsZnVuY3Rpb24oYSxiLGMpe3JldHVybiBudWxsIT1jP2hiKGMsYSxiKTpifSk7cChcIm1vcmkuZmlsdGVyXCIsVWQpO3AoXCJtb3JpLnJlbW92ZVwiLFZkKTtwKFwibW9yaS5zb21lXCIsRWQpO3AoXCJtb3JpLmV2ZXJ5XCIsRGQpO3AoXCJtb3JpLmVxdWFsc1wiLFdiKTtwKFwibW9yaS5yYW5nZVwiLHBnKTtwKFwibW9yaS5yZXBlYXRcIixPZCk7cChcIm1vcmkucmVwZWF0ZWRseVwiLFBkKTtwKFwibW9yaS5zb3J0XCIsU2MpO3AoXCJtb3JpLnNvcnRfYnlcIixUYyk7XG5wKFwibW9yaS5pbnRvX2FycmF5XCIseGEpO3AoXCJtb3JpLnN1YnNlcVwiLG5nKTtwKFwibW9yaS5ybWFwXCIsdGgpO3AoXCJtb3JpLnJmaWx0ZXJcIix1aCk7cChcIm1vcmkucnJlbW92ZVwiLHdoKTtwKFwibW9yaS5ydGFrZVwiLHloKTtwKFwibW9yaS5ydGFrZV93aGlsZVwiLHhoKTtwKFwibW9yaS5yZHJvcFwiLHpoKTtwKFwibW9yaS5yZmxhdHRlblwiLHZoKTtwKFwibW9yaS5saXN0XCIsZmQpO3AoXCJtb3JpLnZlY3RvclwiLHhlKTtwKFwibW9yaS5hcnJheV9tYXBcIixVZik7cChcIm1vcmkuaGFzaF9tYXBcIixUZik7cChcIm1vcmkuc2V0XCIsZWcpO3AoXCJtb3JpLnNvcnRlZF9zZXRcIixmZyk7cChcIm1vcmkuc29ydGVkX3NldF9ieVwiLGdnKTtwKFwibW9yaS5zb3J0ZWRfbWFwXCIsVmYpO3AoXCJtb3JpLnNvcnRlZF9tYXBfYnlcIixXZik7XG5wKFwibW9yaS5xdWV1ZVwiLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhKXt2YXIgZD1udWxsOzA8YXJndW1lbnRzLmxlbmd0aCYmKGQ9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCksMCkpO3JldHVybiBiLmNhbGwodGhpcyxkKX1mdW5jdGlvbiBiKGEpe3JldHVybiBZZC5hP1lkLmEoSmUsYSk6WWQuY2FsbChudWxsLEplLGEpfWEuaz0wO2EuZj1mdW5jdGlvbihhKXthPUUoYSk7cmV0dXJuIGIoYSl9O2EuZD1iO3JldHVybiBhfSgpKTtwKFwibW9yaS5rZXl3b3JkXCIsamQpO3AoXCJtb3JpLnN5bWJvbFwiLCRiKTtwKFwibW9yaS56aXBtYXBcIixmdW5jdGlvbihhLGIpe2Zvcih2YXIgYz15YihZZSksZD1FKGEpLGU9RShiKTs7KWlmKGQmJmUpYz14ZC5jKGMsRihkKSxGKGUpKSxkPUkoZCksZT1JKGUpO2Vsc2UgcmV0dXJuIEFiKGMpfSk7XG5wKFwibW9yaS5pc19saXN0XCIsZnVuY3Rpb24oYSl7cmV0dXJuIGE/YS5pJjMzNTU0NDMyfHxhLkVjPyEwOmEuaT8hMTpzKG5iLGEpOnMobmIsYSl9KTtwKFwibW9yaS5pc19zZXFcIixNYyk7cChcIm1vcmkuaXNfdmVjdG9yXCIsSGMpO3AoXCJtb3JpLmlzX21hcFwiLEdjKTtwKFwibW9yaS5pc19zZXRcIixEYyk7cChcIm1vcmkuaXNfa2V5d29yZFwiLGZ1bmN0aW9uKGEpe3JldHVybiBhIGluc3RhbmNlb2YgVH0pO3AoXCJtb3JpLmlzX3N5bWJvbFwiLGZ1bmN0aW9uKGEpe3JldHVybiBhIGluc3RhbmNlb2YgWmJ9KTtwKFwibW9yaS5pc19jb2xsZWN0aW9uXCIsQ2MpO3AoXCJtb3JpLmlzX3NlcXVlbnRpYWxcIixGYyk7cChcIm1vcmkuaXNfYXNzb2NpYXRpdmVcIixFYyk7cChcIm1vcmkuaXNfY291bnRlZFwiLGljKTtwKFwibW9yaS5pc19pbmRleGVkXCIsamMpO3AoXCJtb3JpLmlzX3JlZHVjZWFibGVcIixmdW5jdGlvbihhKXtyZXR1cm4gYT9hLmkmNTI0Mjg4fHxhLk5iPyEwOmEuaT8hMTpzKGZiLGEpOnMoZmIsYSl9KTtcbnAoXCJtb3JpLmlzX3NlcWFibGVcIixmdW5jdGlvbihhKXtyZXR1cm4gYT9hLmkmODM4ODYwOHx8YS5oYz8hMDphLmk/ITE6cyhrYixhKTpzKGtiLGEpfSk7cChcIm1vcmkuaXNfcmV2ZXJzaWJsZVwiLGRkKTtwKFwibW9yaS51bmlvblwiLERoKTtwKFwibW9yaS5pbnRlcnNlY3Rpb25cIixFaCk7cChcIm1vcmkuZGlmZmVyZW5jZVwiLEZoKTtwKFwibW9yaS5pc19zdWJzZXRcIixmdW5jdGlvbihhLGIpe3JldHVybiBPKGEpPD1PKGIpJiZEZChmdW5jdGlvbihhKXtyZXR1cm4gT2MoYixhKX0sYSl9KTtwKFwibW9yaS5pc19zdXBlcnNldFwiLGZ1bmN0aW9uKGEsYil7cmV0dXJuIE8oYSk+PU8oYikmJkRkKGZ1bmN0aW9uKGIpe3JldHVybiBPYyhhLGIpfSxiKX0pO3AoXCJtb3JpLnBhcnRpYWxcIixJZCk7cChcIm1vcmkuY29tcFwiLEhkKTtcbnAoXCJtb3JpLnBpcGVsaW5lXCIsZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEpe3ZhciBkPW51bGw7MDxhcmd1bWVudHMubGVuZ3RoJiYoZD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywwKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGQpfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIEMuYT9DLmEoZnVuY3Rpb24oYSxiKXtyZXR1cm4gYi5iP2IuYihhKTpiLmNhbGwobnVsbCxhKX0sYSk6Qy5jYWxsKG51bGwsZnVuY3Rpb24oYSxiKXtyZXR1cm4gYi5iP2IuYihhKTpiLmNhbGwobnVsbCxhKX0sYSl9YS5rPTA7YS5mPWZ1bmN0aW9uKGEpe2E9RShhKTtyZXR1cm4gYihhKX07YS5kPWI7cmV0dXJuIGF9KCkpO1xucChcIm1vcmkuY3VycnlcIixmdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxkKXt2YXIgZT1udWxsOzE8YXJndW1lbnRzLmxlbmd0aCYmKGU9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSksMCkpO3JldHVybiBiLmNhbGwodGhpcyxhLGUpfWZ1bmN0aW9uIGIoYSxiKXtyZXR1cm4gZnVuY3Rpb24oZSl7cmV0dXJuIFMuYShhLE0uYT9NLmEoZSxiKTpNLmNhbGwobnVsbCxlLGIpKX19YS5rPTE7YS5mPWZ1bmN0aW9uKGEpe3ZhciBkPUYoYSk7YT1HKGEpO3JldHVybiBiKGQsYSl9O2EuZD1iO3JldHVybiBhfSgpKTtcbnAoXCJtb3JpLmp1eHRcIixmdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSl7dmFyIGQ9bnVsbDswPGFyZ3VtZW50cy5sZW5ndGgmJihkPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsZCl9ZnVuY3Rpb24gYihhKXtyZXR1cm4gZnVuY3Rpb24oKXtmdW5jdGlvbiBiKGEpe3ZhciBjPW51bGw7MDxhcmd1bWVudHMubGVuZ3RoJiYoYz1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywwKSwwKSk7cmV0dXJuIGUuY2FsbCh0aGlzLGMpfWZ1bmN0aW9uIGUoYil7cmV0dXJuIHhhLmI/eGEuYihLZC5hP0tkLmEoZnVuY3Rpb24oYSl7cmV0dXJuIFMuYShhLGIpfSxhKTpLZC5jYWxsKG51bGwsZnVuY3Rpb24oYSl7cmV0dXJuIFMuYShhLGIpfSxhKSk6eGEuY2FsbChudWxsLEtkLmE/S2QuYShmdW5jdGlvbihhKXtyZXR1cm4gUy5hKGEsYil9LGEpOktkLmNhbGwobnVsbCxmdW5jdGlvbihhKXtyZXR1cm4gUy5hKGEsXG5iKX0sYSkpfWIuaz0wO2IuZj1mdW5jdGlvbihhKXthPUUoYSk7cmV0dXJuIGUoYSl9O2IuZD1lO3JldHVybiBifSgpfWEuaz0wO2EuZj1mdW5jdGlvbihhKXthPUUoYSk7cmV0dXJuIGIoYSl9O2EuZD1iO3JldHVybiBhfSgpKTtcbnAoXCJtb3JpLmtuaXRcIixmdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSl7dmFyIGQ9bnVsbDswPGFyZ3VtZW50cy5sZW5ndGgmJihkPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsZCl9ZnVuY3Rpb24gYihhKXtyZXR1cm4gZnVuY3Rpb24oYil7cmV0dXJuIHhhLmI/eGEuYihLZC5jP0tkLmMoZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS5iP2EuYihiKTphLmNhbGwobnVsbCxiKX0sYSxiKTpLZC5jYWxsKG51bGwsZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS5iP2EuYihiKTphLmNhbGwobnVsbCxiKX0sYSxiKSk6eGEuY2FsbChudWxsLEtkLmM/S2QuYyhmdW5jdGlvbihhLGIpe3JldHVybiBhLmI/YS5iKGIpOmEuY2FsbChudWxsLGIpfSxhLGIpOktkLmNhbGwobnVsbCxmdW5jdGlvbihhLGIpe3JldHVybiBhLmI/YS5iKGIpOmEuY2FsbChudWxsLGIpfSxhLGIpKX19YS5rPTA7YS5mPWZ1bmN0aW9uKGEpe2E9RShhKTtyZXR1cm4gYihhKX07XG5hLmQ9YjtyZXR1cm4gYX0oKSk7cChcIm1vcmkuZGlmZlwiLEpoKTtwKFwibW9yaS5zdW1cIixmdW5jdGlvbihhLGIpe3JldHVybiBhK2J9KTtwKFwibW9yaS5pbmNcIixmdW5jdGlvbihhKXtyZXR1cm4gYSsxfSk7cChcIm1vcmkuZGVjXCIsZnVuY3Rpb24oYSl7cmV0dXJuIGEtMX0pO3AoXCJtb3JpLmlzX2V2ZW5cIixmdW5jdGlvbihhKXtyZXR1cm4gMD09PShhJTIrMiklMn0pO3AoXCJtb3JpLmlzX29kZFwiLGZ1bmN0aW9uKGEpe3JldHVybiAxPT09KGElMisyKSUyfSk7cChcIm1vcmkuZWFjaFwiLGZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPUUoYSksZD1udWxsLGU9MCxmPTA7OylpZihmPGUpe3ZhciBoPWQuSihudWxsLGYpO2IuYj9iLmIoaCk6Yi5jYWxsKG51bGwsaCk7Zis9MX1lbHNlIGlmKGM9RShjKSlkPWMsSWMoZCk/KGM9SGIoZCksZT1JYihkKSxkPWMsaD1PKGMpLGM9ZSxlPWgpOihoPUYoZCksYi5iP2IuYihoKTpiLmNhbGwobnVsbCxoKSxjPUkoZCksZD1udWxsLGU9MCksZj0wO2Vsc2UgcmV0dXJuIG51bGx9KTtcbnAoXCJtb3JpLmlkZW50aXR5XCIsRmQpO3AoXCJtb3JpLmNvbnN0YW50bHlcIixmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oKXtmdW5jdGlvbiBiKGIpezA8YXJndW1lbnRzLmxlbmd0aCYmSihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCksMCk7cmV0dXJuIGF9Yi5rPTA7Yi5mPWZ1bmN0aW9uKGIpe0UoYik7cmV0dXJuIGF9O2IuZD1mdW5jdGlvbigpe3JldHVybiBhfTtyZXR1cm4gYn0oKX0pO3AoXCJtb3JpLmNsal90b19qc1wiLE5nKTtcbnAoXCJtb3JpLmpzX3RvX2NsalwiLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3JldHVybiBTZy5kKGEsSihbUmcsYl0sMCkpfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIFNnLmIoYSl9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYi5jYWxsKHRoaXMsYyk7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxjLGUpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmI9YjtjLmE9YTtyZXR1cm4gY30oKSk7cChcIm1vcmkucGFyc2VcIixmdW5jdGlvbihhKXtyZXR1cm4gaGkobmV3IFJoKGEsW10sLTEpLCExLG51bGwpfSk7XG5wKFwibW9yaS5jb25maWd1cmVcIixmdW5jdGlvbihhLGIpe3N3aXRjaChhKXtjYXNlIFwicHJpbnQtbGVuZ3RoXCI6cmV0dXJuIGlhPWI7Y2FzZSBcInByaW50LWxldmVsXCI6cmV0dXJuIGphPWI7ZGVmYXVsdDp0aHJvdyBFcnJvcihcIk5vIG1hdGNoaW5nIGNsYXVzZTogXCIrQS5iKGEpKTt9fSk7XG5wKFwibW9yaS5wcm94eVwiLGZ1bmN0aW9uKGEpe2lmKFwidW5kZWZpbmVkXCIhPT10eXBlb2YgUHJveHkpcmV0dXJuIFByb3h5LmNyZWF0ZShmdW5jdGlvbigpe3JldHVybntoYXM6ZnVuY3Rpb24oYil7cmV0dXJuIE9jKGEsYil9LGhhc093bjpmdW5jdGlvbihiKXtyZXR1cm4gT2MoYSxiKX0sZ2V0OmZ1bmN0aW9uKGIsYyl7dmFyIGQ9US5jP1EuYyhhLGMsaGgpOlEuY2FsbChudWxsLGEsYyxoaCk7cmV0dXJuIGhkKGQsaGgpP2ljKGEpJiZcImxlbmd0aFwiPT09Yz9PLmI/Ty5iKGEpOk8uY2FsbChudWxsLGEpOm51bGw6dT9kOm51bGx9LHNldDpmdW5jdGlvbigpe3JldHVybiBudWxsfSxlbnVtZXJhdGU6ZnVuY3Rpb24oKXtyZXR1cm4geGEuYj94YS5iKFZlLmI/VmUuYihhKTpWZS5jYWxsKG51bGwsYSkpOnhhLmNhbGwobnVsbCxWZS5iP1ZlLmIoYSk6VmUuY2FsbChudWxsLGEpKX0sa2V5czpmdW5jdGlvbigpe3JldHVybiBHYyhhKT94YS5iP3hhLmIoVmUuYj9WZS5iKGEpOlZlLmNhbGwobnVsbCxcbmEpKTp4YS5jYWxsKG51bGwsVmUuYj9WZS5iKGEpOlZlLmNhbGwobnVsbCxhKSk6SGMoYSk/eGEuYj94YS5iKHBnLmI/cGcuYihPLmI/Ty5iKGEpOk8uY2FsbChudWxsLGEpKTpwZy5jYWxsKG51bGwsTy5iP08uYihhKTpPLmNhbGwobnVsbCxhKSkpOnhhLmNhbGwobnVsbCxwZy5iP3BnLmIoTy5iP08uYihhKTpPLmNhbGwobnVsbCxhKSk6cGcuY2FsbChudWxsLE8uYj9PLmIoYSk6Ty5jYWxsKG51bGwsYSkpKTpudWxsfX19KCkpO3Rocm93IEVycm9yKFwiRVM2IFByb3h5IG5vdCBzdXBwb3J0ZWQhXCIpO30pO1YucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTthYy5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvU3RyaW5nKCl9O2tjLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07QmYucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTtcbnZmLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07d2YucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTtiZC5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvU3RyaW5nKCl9O2dkLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07Y2QucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTtXLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07b2QucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTt5ZS5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvU3RyaW5nKCl9O0FlLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07XG4kLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07WS5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvU3RyaW5nKCl9O2xhLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07eGYucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTtRZi5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvU3RyaW5nKCl9OyRmLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07Y2cucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTtvZy5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvU3RyaW5nKCl9O1QucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTtcblpiLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07SWUucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTtIZS5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvU3RyaW5nKCl9O3AoXCJtb3JpLl9lcXVpdlwiLGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEuSGMoYil9KTtwKFwibW9yaS5fa2V5c1wiLGZ1bmN0aW9uKGEpe3JldHVybiBhLmtleXMoKX0pO3AoXCJtb3JpLl92YWx1ZXNcIixmdW5jdGlvbihhKXtyZXR1cm4gYS52YWx1ZXMoKX0pO3AoXCJtb3JpLl9lbnRyaWVzXCIsZnVuY3Rpb24oYSl7cmV0dXJuIGEuZW50cmllcygpfSk7cChcIm1vcmkuX2hhc1wiLGZ1bmN0aW9uKGEpe3JldHVybiBhLmhhcygpfSk7cChcIm1vcmkuX2dldFwiLGZ1bmN0aW9uKGEpe3JldHVybiBhLmdldCgpfSk7cChcIm1vcmkuX2ZvckVhY2hcIixmdW5jdGlvbihhKXtyZXR1cm4gYS5mb3JFYWNoKCl9KTtcbnAoXCJtb3JpLl9uZXh0XCIsZnVuY3Rpb24oYSl7cmV0dXJuIGEubmV4dCgpfSk7cChcIm1vcmkubXV0YWJsZS50aGF3XCIsZnVuY3Rpb24oYSl7cmV0dXJuIHliKGEpfSk7cChcIm1vcmkubXV0YWJsZS5mcmVlemVcIix2ZCk7cChcIm1vcmkubXV0YWJsZS5jb25qMVwiLGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEuS2EobnVsbCxiKX0pO3AoXCJtb3JpLm11dGFibGUuY29ualwiLHdkKTtwKFwibW9yaS5tdXRhYmxlLmFzc29jXCIseGQpO3AoXCJtb3JpLm11dGFibGUuZGlzc29jXCIseWQpO3AoXCJtb3JpLm11dGFibGUucG9wXCIsZnVuY3Rpb24oYSl7cmV0dXJuIEViKGEpfSk7cChcIm1vcmkubXV0YWJsZS5kaXNqXCIsemQpO2Z1bmN0aW9uIE1pKGEsYixjLGQpe3JldHVybiBOKG5ldyBXKG51bGwsMiw1LFgsW2QsbnVsbF0sbnVsbCksbmV3IGxhKG51bGwsMyxbJGcsYyxYZyxiLFZnLGFdLG51bGwpKX1mdW5jdGlvbiBOaShhKXtyZXR1cm4gYS5iP2EuYigwKTphLmNhbGwobnVsbCwwKX1mdW5jdGlvbiBPaShhKXtyZXR1cm4gVmcuYih4YyhhKSkuY2FsbChudWxsLE5pKGEpKX1mdW5jdGlvbiBQaShhKXtpZihyKE9pKGEpKSlyZXR1cm4gWGcuYih4YyhhKSkuY2FsbChudWxsLE5pKGEpKTt0aHJvd1wiY2FsbGVkIGNoaWxkcmVuIG9uIGEgbGVhZiBub2RlXCI7fWZ1bmN0aW9uIFFpKGEsYixjKXtyZXR1cm4gJGcuYih4YyhhKSkuY2FsbChudWxsLGIsYyl9XG5mdW5jdGlvbiBSaShhKXtpZihyKE9pKGEpKSl7dmFyIGI9UC5jKGEsMCxudWxsKSxjPVAuYyhhLDEsbnVsbCksZD1QaShhKSxlPVAuYyhkLDAsbnVsbCksZj0kYyhkKTtyZXR1cm4gcihkKT9OKG5ldyBXKG51bGwsMiw1LFgsW2UsbmV3IGxhKG51bGwsNCxbWmcscWUsYWgscihjKT9wYy5hKGFoLmIoYyksYik6bmV3IFcobnVsbCwxLDUsWCxbYl0sbnVsbCksVWcsYyxXZyxmXSxudWxsKV0sbnVsbCkseGMoYSkpOm51bGx9cmV0dXJuIG51bGx9XG5mdW5jdGlvbiBTaShhKXt2YXIgYj1QLmMoYSwwLG51bGwpLGM9UC5jKGEsMSxudWxsKSxkPU1jKGMpP1MuYShUZixjKTpjLGM9US5hKGQsWmcpLGU9US5hKGQsVWcpLGY9US5hKGQsYWgpLGg9US5hKGQsV2cpLGQ9US5hKGQsYmgpO3JldHVybiByKGYpPyhmPXljKGYpLE4ocihkKT9uZXcgVyhudWxsLDIsNSxYLFtRaShhLGYsdGQuYShjLE0oYixoKSkpLHIoZSk/Ui5jKGUsYmgsITApOmVdLG51bGwpOm5ldyBXKG51bGwsMiw1LFgsW2YsZV0sbnVsbCkseGMoYSkpKTpudWxsfWZ1bmN0aW9uIFRpKGEpe3ZhciBiPVAuYyhhLDAsbnVsbCksYz1QLmMoYSwxLG51bGwpLGM9TWMoYyk/Uy5hKFRmLGMpOmMsZD1RLmEoYyxaZyksZT1RLmEoYyxXZyksZj1QLmMoZSwwLG51bGwpLGg9JGMoZSk7cmV0dXJuIHIocihjKT9lOmMpP04obmV3IFcobnVsbCwyLDUsWCxbZixSLmQoYyxaZyxwYy5hKGQsYiksSihbV2csaF0sMCkpXSxudWxsKSx4YyhhKSk6bnVsbH1cbmZ1bmN0aW9uIFVpKGEpe3ZhciBiPVAuYyhhLDAsbnVsbCksYz1QLmMoYSwxLG51bGwpLGM9TWMoYyk/Uy5hKFRmLGMpOmMsZD1RLmEoYyxaZyksZT1RLmEoYyxXZyk7cmV0dXJuIHIocihjKT9lOmMpP04obmV3IFcobnVsbCwyLDUsWCxbb2MoZSksUi5kKGMsWmcsUy5uKHBjLGQsYixoZyhlKSksSihbV2csbnVsbF0sMCkpXSxudWxsKSx4YyhhKSk6YX1mdW5jdGlvbiBWaShhKXt2YXIgYj1QLmMoYSwwLG51bGwpLGM9UC5jKGEsMSxudWxsKSxjPU1jKGMpP1MuYShUZixjKTpjLGQ9US5hKGMsWmcpLGU9US5hKGMsV2cpO3JldHVybiByKHIoYyk/RShkKTpjKT9OKG5ldyBXKG51bGwsMiw1LFgsW3ljKGQpLFIuZChjLFpnLHpjKGQpLEooW1dnLE0oYixlKV0sMCkpXSxudWxsKSx4YyhhKSk6bnVsbH1cbmZ1bmN0aW9uIFdpKGEsYil7UC5jKGEsMCxudWxsKTt2YXIgYz1QLmMoYSwxLG51bGwpO3JldHVybiBOKG5ldyBXKG51bGwsMiw1LFgsW2IsUi5jKGMsYmgsITApXSxudWxsKSx4YyhhKSl9dmFyIFhpPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGQsZSl7dmFyIGY9bnVsbDsyPGFyZ3VtZW50cy5sZW5ndGgmJihmPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYSxkLGYpfWZ1bmN0aW9uIGIoYSxiLGUpe3JldHVybiBXaShhLFMuYyhiLE5pKGEpLGUpKX1hLms9MjthLmY9ZnVuY3Rpb24oYSl7dmFyIGQ9RihhKTthPUkoYSk7dmFyIGU9RihhKTthPUcoYSk7cmV0dXJuIGIoZCxlLGEpfTthLmQ9YjtyZXR1cm4gYX0oKTtwKFwibW9yaS56aXAuemlwcGVyXCIsTWkpO3AoXCJtb3JpLnppcC5zZXFfemlwXCIsZnVuY3Rpb24oYSl7cmV0dXJuIE1pKE1jLEZkLGZ1bmN0aW9uKGEsYyl7cmV0dXJuIE4oYyx4YyhhKSl9LGEpfSk7cChcIm1vcmkuemlwLnZlY3Rvcl96aXBcIixmdW5jdGlvbihhKXtyZXR1cm4gTWkoSGMsRSxmdW5jdGlvbihhLGMpe3JldHVybiBOKHdlKGMpLHhjKGEpKX0sYSl9KTtwKFwibW9yaS56aXAubm9kZVwiLE5pKTtwKFwibW9yaS56aXAuaXNfYnJhbmNoXCIse30ueGMpO3AoXCJtb3JpLnppcC5jaGlsZHJlblwiLFBpKTtwKFwibW9yaS56aXAubWFrZV9ub2RlXCIsUWkpO3AoXCJtb3JpLnppcC5wYXRoXCIsZnVuY3Rpb24oYSl7cmV0dXJuIGFoLmIoYS5iP2EuYigxKTphLmNhbGwobnVsbCwxKSl9KTtwKFwibW9yaS56aXAubGVmdHNcIixmdW5jdGlvbihhKXtyZXR1cm4gRShaZy5iKGEuYj9hLmIoMSk6YS5jYWxsKG51bGwsMSkpKX0pO1xucChcIm1vcmkuemlwLnJpZ2h0c1wiLGZ1bmN0aW9uKGEpe3JldHVybiBXZy5iKGEuYj9hLmIoMSk6YS5jYWxsKG51bGwsMSkpfSk7cChcIm1vcmkuemlwLmRvd25cIixSaSk7cChcIm1vcmkuemlwLnVwXCIsU2kpO3AoXCJtb3JpLnppcC5yb290XCIsZnVuY3Rpb24oYSl7Zm9yKDs7KXtpZihXYi5hKGVoLGEuYj9hLmIoMSk6YS5jYWxsKG51bGwsMSkpKXJldHVybiBOaShhKTt2YXIgYj1TaShhKTtpZihyKGIpKWE9YjtlbHNlIHJldHVybiBOaShhKX19KTtwKFwibW9yaS56aXAucmlnaHRcIixUaSk7cChcIm1vcmkuemlwLnJpZ2h0bW9zdFwiLFVpKTtwKFwibW9yaS56aXAubGVmdFwiLFZpKTtcbnAoXCJtb3JpLnppcC5sZWZ0bW9zdFwiLGZ1bmN0aW9uKGEpe3ZhciBiPVAuYyhhLDAsbnVsbCksYz1QLmMoYSwxLG51bGwpLGM9TWMoYyk/Uy5hKFRmLGMpOmMsZD1RLmEoYyxaZyksZT1RLmEoYyxXZyk7cmV0dXJuIHIocihjKT9FKGQpOmMpP04obmV3IFcobnVsbCwyLDUsWCxbRihkKSxSLmQoYyxaZyxxZSxKKFtXZyx0ZC5kKEcoZCksbmV3IFcobnVsbCwxLDUsWCxbYl0sbnVsbCksSihbZV0sMCkpXSwwKSldLG51bGwpLHhjKGEpKTphfSk7cChcIm1vcmkuemlwLmluc2VydF9sZWZ0XCIsZnVuY3Rpb24oYSxiKXt2YXIgYz1QLmMoYSwwLG51bGwpLGQ9UC5jKGEsMSxudWxsKSxkPU1jKGQpP1MuYShUZixkKTpkLGU9US5hKGQsWmcpO2lmKG51bGw9PWQpdGhyb3dcIkluc2VydCBhdCB0b3BcIjtyZXR1cm4gTihuZXcgVyhudWxsLDIsNSxYLFtjLFIuZChkLFpnLHBjLmEoZSxiKSxKKFtiaCwhMF0sMCkpXSxudWxsKSx4YyhhKSl9KTtcbnAoXCJtb3JpLnppcC5pbnNlcnRfcmlnaHRcIixmdW5jdGlvbihhLGIpe3ZhciBjPVAuYyhhLDAsbnVsbCksZD1QLmMoYSwxLG51bGwpLGQ9TWMoZCk/Uy5hKFRmLGQpOmQsZT1RLmEoZCxXZyk7aWYobnVsbD09ZCl0aHJvd1wiSW5zZXJ0IGF0IHRvcFwiO3JldHVybiBOKG5ldyBXKG51bGwsMiw1LFgsW2MsUi5kKGQsV2csTShiLGUpLEooW2JoLCEwXSwwKSldLG51bGwpLHhjKGEpKX0pO3AoXCJtb3JpLnppcC5yZXBsYWNlXCIsV2kpO3AoXCJtb3JpLnppcC5lZGl0XCIsWGkpO3AoXCJtb3JpLnppcC5pbnNlcnRfY2hpbGRcIixmdW5jdGlvbihhLGIpe3JldHVybiBXaShhLFFpKGEsTmkoYSksTShiLFBpKGEpKSkpfSk7cChcIm1vcmkuemlwLmFwcGVuZF9jaGlsZFwiLGZ1bmN0aW9uKGEsYil7cmV0dXJuIFdpKGEsUWkoYSxOaShhKSx0ZC5hKFBpKGEpLG5ldyBXKG51bGwsMSw1LFgsW2JdLG51bGwpKSkpfSk7XG5wKFwibW9yaS56aXAubmV4dFwiLGZ1bmN0aW9uKGEpe2lmKFdiLmEoZWgsYS5iP2EuYigxKTphLmNhbGwobnVsbCwxKSkpcmV0dXJuIGE7dmFyIGI7Yj1PaShhKTtiPXIoYik/UmkoYSk6YjtpZihyKGIpKXJldHVybiBiO2I9VGkoYSk7aWYocihiKSlyZXR1cm4gYjtmb3IoOzspaWYocihTaShhKSkpe2I9VGkoU2koYSkpO2lmKHIoYikpcmV0dXJuIGI7YT1TaShhKX1lbHNlIHJldHVybiBuZXcgVyhudWxsLDIsNSxYLFtOaShhKSxlaF0sbnVsbCl9KTtwKFwibW9yaS56aXAucHJldlwiLGZ1bmN0aW9uKGEpe3ZhciBiPVZpKGEpO2lmKHIoYikpZm9yKGE9Yjs7KWlmKGI9T2koYSksYj1yKGIpP1JpKGEpOmIscihiKSlhPVVpKGIpO2Vsc2UgcmV0dXJuIGE7ZWxzZSByZXR1cm4gU2koYSl9KTtwKFwibW9yaS56aXAuaXNfZW5kXCIsZnVuY3Rpb24oYSl7cmV0dXJuIFdiLmEoZWgsYS5iP2EuYigxKTphLmNhbGwobnVsbCwxKSl9KTtcbnAoXCJtb3JpLnppcC5yZW1vdmVcIixmdW5jdGlvbihhKXtQLmMoYSwwLG51bGwpO3ZhciBiPVAuYyhhLDEsbnVsbCksYj1NYyhiKT9TLmEoVGYsYik6YixjPVEuYShiLFpnKSxkPVEuYShiLFVnKSxlPVEuYShiLGFoKSxmPVEuYShiLFdnKTtpZihudWxsPT1iKXRocm93XCJSZW1vdmUgYXQgdG9wXCI7aWYoMDxPKGMpKWZvcihhPU4obmV3IFcobnVsbCwyLDUsWCxbeWMoYyksUi5kKGIsWmcsemMoYyksSihbYmgsITBdLDApKV0sbnVsbCkseGMoYSkpOzspaWYoYj1PaShhKSxiPXIoYik/UmkoYSk6YixyKGIpKWE9VWkoYik7ZWxzZSByZXR1cm4gYTtlbHNlIHJldHVybiBOKG5ldyBXKG51bGwsMiw1LFgsW1FpKGEseWMoZSksZikscihkKT9SLmMoZCxiaCwhMCk6ZF0sbnVsbCkseGMoYSkpfSk7O3JldHVybiB0aGlzLm1vcmk7fS5jYWxsKHt9KTt9KTtcbiIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBQcm9taXNlLFxuICBPcHRpb25zXG4pIHtcblxuICB2YXIgVW5pdFNlcXVlbmNlciA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKFVuaXRTZXF1ZW5jZXIucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyAgICAgICAgICAgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB0aGlzLl9zZXF1ZW5jZSA9IG9wdHMuZ2V0T3JFbHNlKFwiaW5pdGlhbFNlcXVlbmNlXCIsIDApO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBBZHZhbmNlcyBpdHMgc2VxdWVuY2UgYnkgYGJ5YCwgb3IgYnkgYDFgIGlmIGBieWAgaXMgbm90IHByb3ZpZGVkLlxuICAgICAqXG4gICAgICogQHBhcmFtIGJ5IHtudW1iZXJ9IHRoZSBhbW91bnQgdG8gYWR2YW5jZSBieS4gRGVmYXVsdHMgdG8gYDFgLlxuICAgICAqIEBhc3luY1xuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPHVuZGVmaW5lZD59XG4gICAgICovXG4gICAgYWR2YW5jZTogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oYnkpIHtcbiAgICAgIC8vIFdhaGggd2FoaCAtIGRvbid0IHVzZSBgYnkgfHwgMWAsIG9yIHlvdSBjYW4ndCBhZHZhbmNlIGJ5IDAsIHdoaWNoIGlzIHNpbGx5XG4gICAgICAvLyBidXQgcG90ZW50aWFsbHkgbmVjZXNzYXJ5LlxuICAgICAgYnkgICAgICAgICAgICAgPSBfLmlzVW5kZWZpbmVkKGJ5KSA/IDEgOiBieTtcblxuICAgICAgaWYgKGJ5IDwgMCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJVbml0U2VxdWVuY2VyI2FkdmFuY2UoKSByZXF1aXJlcyBwb3NpdGl2ZSBgYnlgIG9mZnNldFwiKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5fc2VxdWVuY2UgPSB0aGlzLl9zZXF1ZW5jZSArIGJ5O1xuICAgIH0pLFxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgY3VycmVudCBzZXF1ZW5jZS4gVGhpcyB2YWx1ZSBzaG91bGQgYWx3YXlzIGJlIHRoZSBzYW1lXG4gICAgICogb3IgZ3JlYXRlciB0aGFuIGEgdmFsdWUgcmV0dXJuZWQgcHJldmlvdXNseSAoaW4gdGltZSkuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSB0aGUgY3VycmVudCBzZXF1ZW5jZVxuICAgICAqL1xuICAgIHZhbHVlOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zZXF1ZW5jZTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBVbml0U2VxdWVuY2VyO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiYmx1ZWJpcmRcIiksXG4gIHJlcXVpcmUoXCIuLi9vcHRpb25zXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFByb21pc2UsXG4gIE9wdGlvbnNcbikge1xuXG4gIC8qKlxuICAgKiBBIFVuaXRTZXF1ZW5jZXIgd2hpY2ggcmVwb3J0cyBpdHMgc2VxdWVuY2Ugc3VtbWVkIHdpdGggdGhlIHNlcXVlbmNlc1xuICAgKiBvZiBpdHMgaW50ZXJuYWwgY29sbGVjdGlvbiBvZiBzZXF1ZW5jZXJzLlxuICAgKlxuICAgKiBUaGlzIGRldmljZSBpcyB1c2VmdWwgZm9yIHRyYWNraW5nIHRoZSBzdGF0ZSBvZiBkYXRhIGNvbXByaXNlZCBmcm9tIG11bHRpcGxlXG4gICAqIHNvdXJjZXMuIEZvciBpbnN0YW5jZSwgeW91IG1pZ2h0IGhhdmUgQ2FjaGluZ0RhdGFTdG9yZShBKSBzdG9yaW5nIGRhdGFcbiAgICogZnJvbSBTb3VyY2UoQSksIHRyYWNrZWQgYnkgU2VxdWVuY2VyKEEpLCBhbmQgQ2FjaGluZ0RhdGFTdG9yZShCKSBzdG9yaW5nXG4gICAqIGRhdGEgZnJvbSBTb3VyY2UoQiksIHRyYWNrZWQgYnkgU2VxdWVuY2VyKEIpLiBNZWFud2hpbGUsIHlvdSBtYXkgaGF2ZVxuICAgKiBDYWNoaW5nRGF0YVN0b3JlKEMpLCBzdG9yaW5nIGRhdGEgZnJvbSBTb3VyY2UoQSArIEIpLCBhbmQgdHJhY2tlZCBieVxuICAgKiBTZXF1ZW5jZXIoQykgPSBTZXF1ZW5jZXIoQSArIEIpIC0gYSBEZWxlZ2F0aW5nQ29tcG9zaXRlU2VxdWVuY2VyLlxuICAgKlxuICAgKiBUaHVzLCBpZiBTZXF1ZW5jZXIoQSkgaXMgYWR2YW5jZWQsIGl0IG1heSBpbnZhbGlkYXRlIENhY2hpbmdEYXRhU3RvcmUoQSkgb3JcbiAgICogQ2FjaGluZ0RhdGFTdG9yZShDKSBvciBib3RoLlxuICAgKlxuICAgKiBOb3RlIHRoaXMgcGFydGljdWxhciB1c2FnZSBpcyBnZW5lcmFsbHkgb25seSB1c2VmdWwgZm9yIFVuaXQgc2VxdWVuY2Vycy5cbiAgICpcbiAgICogSWYgeW91J2QgbGlrZSB0aGUgYWJvdmUgZnVuY3Rpb25hbGl0eSwgYnV0IHdpdGggU2VxdWVuY2VyKEEpIGFuZFxuICAgKiBTZXF1ZW5jZXIoQikgYXMgQ2xvY2tTZXF1ZW5jZXJzLCBhbmQgU2VxdWVuY2VyKEMpIG1lcmVseSB0cmFja2luZ1xuICAgKiBtb2RpZmljYXRpb24sIHlvdSdkIG5lZWQgdG8gdXNlIGEgRGVsZWdhdGluZ0ZvcndhcmRpbmdTZXF1ZW5jZXIgZm9yIEEgYW5kIEIsXG4gICAqIGZvcndhcmRpbmcgdGhlbSB0byBVbml0U2VxdWVuY2VyKEMpLlxuICAgKlxuICAgKiBEZWxlZ2F0aW5nQ29tcG9zaXRlU2VxdWVuY2VyIGFuZCBEZWxlZ2F0aW5nRm9yd2FyZGluZ1NlcXVlbmNlciBhcmUgZWZmZWN0aXZseVxuICAgKiBvcHBvc2l0ZXMgb2YgZWFjaCBvdGhlci4gRGVsZWdhdGluZ0NvbXBvc2l0ZVNlcXVlbmNlciBjb21wb3NlcyB0aGUgYHZhbHVlYFxuICAgKiBvZiBtdWx0aXBsZSB1bmRlcmx5aW5nIHNlcXVlbmNlcnMgKHB1bGwpLCBhbmQgRGVsZWdhdGluZ0ZvcndhcmRpbmdTZXF1ZW5jZXJcbiAgICogZm9yd2FyZHMgdGhlIGBhZHZhbmNlYCBjYWxsIHRvIG11bHRpcGxlIHRhcmdldHMgKHB1c2gpLlxuICAgKi9cbiAgdmFyIERlbGVnYXRpbmdDb21wb3NpdGVTZXF1ZW5jZXIgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChEZWxlZ2F0aW5nQ29tcG9zaXRlU2VxdWVuY2VyLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB0aGlzLl9kZWxlZ2F0ZVNlcXVlbmNlciA9IG9wdHMuZ2V0T3JFcnJvcihcImRlbGVnYXRlXCIpO1xuICAgICAgdGhpcy5fc2VxdWVuY2VycyA9IF8uY2xvbmUob3B0cy5nZXRPckVsc2UoXCJzZXF1ZW5jZXJzXCIsIFtdKSk7XG4gICAgfSxcbiAgICBhZGRTZXF1ZW5jZXI6IGZ1bmN0aW9uKHNlcSkge1xuICAgICAgdGhpcy5fc2VxdWVuY2Vycy5wdXNoKHNlcSk7XG4gICAgfSxcbiAgICBhZHZhbmNlOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBzID0gdGhpcy5fZGVsZWdhdGVTZXF1ZW5jZXI7XG4gICAgICByZXR1cm4gcy5hZHZhbmNlLmFwcGx5KHMsIGFyZ3VtZW50cyk7XG4gICAgfSxcbiAgICB2YWx1ZTogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gX1xuICAgICAgICAuY2hhaW4odGhpcy5fc2VxdWVuY2VycylcbiAgICAgICAgLmludm9rZShcInZhbHVlXCIpXG4gICAgICAgIC5yZWR1Y2UoZnVuY3Rpb24oc3VtLCBuKSB7XG4gICAgICAgICAgcmV0dXJuIHN1bSArIG47XG4gICAgICAgIH0sIDApXG4gICAgICAgIC52YWx1ZSgpICsgdGhpcy5fZGVsZWdhdGVTZXF1ZW5jZXIudmFsdWUoKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBEZWxlZ2F0aW5nQ29tcG9zaXRlU2VxdWVuY2VyO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiYmx1ZWJpcmRcIiksXG4gIHJlcXVpcmUoXCIuLi9vcHRpb25zXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFByb21pc2UsXG4gIE9wdGlvbnNcbikge1xuXG4gIC8qKlxuICAgKiBBIFNlcXVlbmNlciB3aGljaCBhZHZhbmNlcyBieSByZWFkaW5nIGZyb20gYSBDbG9jay5cbiAgICogTm90ZSB0aGF0IHRoaXMgQ2xvY2tTZXF1ZW5jZXIgcmVsaWVzIG9uIHRoZSBDbG9jayBwcm90b2NvbCwgd2hpY2hcbiAgICogb25seSBwcm92aWRlcyBgQ2xvY2sjZ2V0VGltZSgpYC4gSXQgZG9lcyBub3QgbW9kaWZ5IHRoZSBjbG9jayBpdHNlbGYuXG4gICAqIFRoaXMgbWVhbnMgaWYgeW91J3JlIHVzaW5nIGEgTG9naWNhbENsb2NrLCBpdCdzIHN0aWxsIHVwIHRvIHRoZSBjbG9jaydzXG4gICAqIG93bmVyIHRvIGFkdmFuY2UgdGhlIGNsb2NrIGZvciB0aGUgc2VxdWVuY2VyIHRvIGFkdmFuY2UuXG4gICAqL1xuICB2YXIgQ2xvY2tTZXF1ZW5jZXIgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfVxuXG4gIF8uZXh0ZW5kKENsb2NrU2VxdWVuY2VyLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG5cbiAgICAgIHRoaXMuX2Nsb2NrICAgID0gb3B0cy5nZXRPckVycm9yKFwiY2xvY2tcIik7XG4gICAgICB0aGlzLl9zZXF1ZW5jZSA9IG9wdHMuZ2V0T3JFbHNlKFwiaW5pdGlhbFNlcXVlbmNlXCIsIDApO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBBZHZhbmNlcyBieSBzZXR0aW5nIGl0cyBzZXF1ZW5jZSB0byB0aGUgYmFja2luZyBjbG9jaydzIHRpbWUuXG4gICAgICogTm90ZSB0aGF0IGlmIHRoaXMgbWV0aG9kIGlzIGNhbGxlZCB0d2ljZSB3aXRoaW4gdGhlIHNhbWUgdGltZSB1bml0LFxuICAgICAqIHRoZSBzZXF1ZW5jZSB3aWxsIG5vdCBhY3R1YWxseSBhZHZhbmNlLCBzaW5jZSB1bmlxdWUgdGltZSBpcyBub3RcbiAgICAgKiBndWFyYW50ZWVkIGJ5IG91ciBjbG9ja3MuXG4gICAgICpcbiAgICAgKiBAYXN5bmNcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTw+fVxuICAgICAqL1xuICAgIGFkdmFuY2U6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIFByb21pc2VcbiAgICAgICAgLmJpbmQodGhpcylcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX2Nsb2NrLmdldFRpbWUoKTtcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24odCkge1xuICAgICAgICAgIHRoaXMuX3NlcXVlbmNlID0gdDtcbiAgICAgICAgfSk7XG4gICAgfSksXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBjdXJyZW50IHNlcXVlbmNlLiBUaGlzIHZhbHVlIHNob3VsZCBhbHdheXMgYmUgdGhlIHNhbWVcbiAgICAgKiBvciBncmVhdGVyIHRoYW4gYSB2YWx1ZSByZXR1cm5lZCBwcmV2aW91c2x5IChpbiB0aW1lKS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IHRoZSBjdXJyZW50IHNlcXVlbmNlXG4gICAgICovXG4gICAgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3NlcXVlbmNlO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIENsb2NrU2VxdWVuY2VyO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiYmx1ZWJpcmRcIiksXG4gIHJlcXVpcmUoXCIuLi9vcHRpb25zXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFByb21pc2UsXG4gIE9wdGlvbnNcbikge1xuXG4gIHZhciBEZWxlZ2F0aW5nRm9yd2FyZGluZ1NlcXVlbmNlciA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKERlbGVnYXRpbmdGb3J3YXJkaW5nU2VxdWVuY2VyLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB0aGlzLl9kZWxlZ2F0ZVNlcXVlbmNlciA9IG9wdHMuZ2V0T3JFcnJvcihcImRlbGVnYXRlXCIpO1xuICAgICAgdGhpcy5fZm9yd2FyZFRhcmdldHMgPSBfLmNsb25lKG9wdHMuZ2V0T3JFbHNlKFwidGFyZ2V0c1wiLCBbXSkpO1xuICAgIH0sXG4gICAgYWRkVGFyZ2V0OiBmdW5jdGlvbihzZXEpIHtcbiAgICAgIHRoaXMuX2ZvcndhcmRUYXJnZXRzLnB1c2goc2VxKTtcbiAgICB9LFxuICAgIGFkdmFuY2U6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHMgPSB0aGlzLl9kZWxlZ2F0ZVNlcXVlbmNlcjtcbiAgICAgIHJldHVybiBzLmFkdmFuY2UuYXBwbHkocywgYXJndW1lbnRzKVxuICAgICAgLmJpbmQodGhpcylcbiAgICAgIC50aGVuKGZ1bmN0aW9uKHZhbCkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZVxuICAgICAgICAgIC5hbGwoXy5pbnZva2UodGhpcy5fZm9yd2FyZFRhcmdldHMsIFwiYWR2YW5jZVwiKSlcbiAgICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIC8vIFJldHVybiB0aGUgdmFsdWUgcmV0dXJuZWQgYnkgdGhlIGRlbGVnYXRlIHNlcXVlbmNlcidzXG4gICAgICAgICAgICAvLyBhZHZhbmNlIGNhbGwgKGlmIGFueSkuIFRoZSBhZHZhbmNlbWVudCBvZiB0aGUgZm9yd2FyZFxuICAgICAgICAgICAgLy8gdGFyZ2V0cyBzaG91bGQgYmUgdHJhbnNwYXJlbnQuXG4gICAgICAgICAgICByZXR1cm4gdmFsO1xuICAgICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSksXG4gICAgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHMgPSB0aGlzLl9kZWxlZ2F0ZVNlcXVlbmNlcjtcbiAgICAgIHJldHVybiBzLnZhbHVlLmFwcGx5KHMsIGFyZ3VtZW50cyk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gRGVsZWdhdGluZ0ZvcndhcmRpbmdTZXF1ZW5jZXI7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJibHVlYmlyZFwiKSxcbiAgcmVxdWlyZShcIi4uL29wdGlvbnNcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgUHJvbWlzZSxcbiAgT3B0aW9uc1xuKSB7XG4gIC8qKlxuICAgKiBBIENsb2NrIHdoaWNoIGFsbG93cyBtYW51YWxseSBtYW5pcHVsYXRpbmcgdGhlIHVuZGVybHlpbmcgdGltZSB2YWx1ZSxcbiAgICogaXJyZXNwZWN0aXZlIG9mIHJlYWwgdGltZS4gVXNlZnVsIGZvciB0ZXN0aW5nLlxuICAgKi9cbiAgdmFyIExvZ2ljYWxDbG9jayA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKExvZ2ljYWxDbG9jay5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdGhpcy5fY3VycmVudFRpbWUgPSBvcHRzLmdldE9yRWxzZShcImluaXRpYWxUaW1lXCIsIDApO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBAYXN5bmNcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxudW1iZXI+fSBUaW1lIGluIG1pbGxpc2Vjb25kcyBzaW5jZSBlcG9jaFxuICAgICAqIEBzZWUgQ2xvY2sjZ2V0VGltZSgpXG4gICAgICovXG4gICAgZ2V0VGltZTogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fY3VycmVudFRpbWU7XG4gICAgfSksXG5cbiAgICAvKipcbiAgICAgKiBBZHZhbmNlcyBpbnRlcm5hbCB0aW1lLCBlaXRoZXIgYG9wdHMuYnlgIGEgY2VydGFpbiBvZmZzZXQsIG9yXG4gICAgICogYG9wdHMudG9gIGEgcGFydGljdWxhciBhYnNvbHV0ZSB0aW1lLiBJZiBzdWNjZXNzZnVsLCByZXR1cm5zIHRoZSByZXN1bHRcbiAgICAgKiBvZiBjYWxsaW5nIGBMb2dpY2FsQ2xvY2sjZ2V0VGltZSgpYCBhcyBhIGNvbnZlbmllbmNlLlxuICAgICAqXG4gICAgICogQHBhcmFtIG9wdHMudG8ge251bWJlcn0gYWJzb2x1dGUgdGltZSB0byBzZXQgY2xvY2sgdG8uIE11c3QgYmUgbGFyZ2VyXG4gICAgICogICAgICAgICAgICAgICAgICAgICAgICAgdGhhbiB0aGUgY3VycmVudCB0aW1lXG4gICAgICogQHBhcmFtIG9wdHMuYnkge251bWJlcn0gb2Zmc2V0IHRvIGFkZCB0byBjdXJyZW50IHRpbWUuIE11c3QgYmUgcG9zaXRpdmUuXG4gICAgICogICAgICAgICAgICAgICAgICAgICAgICAgRGVmYXVsdHMgdG8gYDFgIGlmIG5laXRoZXIgYG9wdHMudG9gIG9yIGBvcHRzLmJ5YFxuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgIGFyZSBzcGVjaWZpZWQuXG4gICAgICogQGFzeW5jXG4gICAgICogQHJldHVybnMge1Byb21pc2U8bnVtYmVyPn0gcmVzdWx0IG9mIGBMb2dpY2FsQ2xvY2sjZ2V0VGltZSgpYFxuICAgICAqL1xuICAgIGFkdmFuY2VUaW1lOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbihvcHRzKXtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB2YXIgYnkgPSBvcHRzLmdldE9yRWxzZShcImJ5XCIsIDEpLFxuICAgICAgICAgIHRvID0gb3B0cy5nZXRPckVsc2UoXCJ0b1wiLCB1bmRlZmluZWQpO1xuICAgICAgaWYgKCFfLmlzVW5kZWZpbmVkKHRvKSkge1xuICAgICAgICBpZiAodG8gPCB0aGlzLl9jdXJyZW50VGltZSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkxvZ2ljYWxDbG9jayNhZHZhbmNlVGltZSgpIHJlcXVpcmVzIGZvcndhcmQgbW92ZW1lbnQgb2YgdGltZVwiKVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2N1cnJlbnRUaW1lID0gdG87XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoYnkgPCAwKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTG9naWNhbENsb2NrI2FkdmFuY2VUaW1lKCkgcmVxdWlyZXMgZm9yd2FyZCBtb3ZlbWVudCBvZiB0aW1lXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2N1cnJlbnRUaW1lID0gdGhpcy5fY3VycmVudFRpbWUgKyBieTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLmdldFRpbWUoKTtcbiAgICB9KVxuICB9KTtcblxuICByZXR1cm4gTG9naWNhbENsb2NrO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiYmx1ZWJpcmRcIiksXG4gIHJlcXVpcmUoXCIuLi8uLi9jb3JlL29wdGlvbnNcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgUHJvbWlzZVxuKSB7XG5cbiAgLyoqXG4gICAqIEEgQ2xvY2sgd2hpY2ggZGVsZWdhdGVzIHRvIHRoZSBzeXN0ZW0gY2xvY2suXG4gICAqL1xuICB2YXIgU3lzdGVtQ2xvY2sgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChTeXN0ZW1DbG9jay5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbigpIHt9LFxuICAgIC8qKlxuICAgICAqIEBhc3luY1xuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPG51bWJlcj59IFRpbWUgaW4gbWlsbGlzZWNvbmRzIHNpbmNlIGVwb2NoXG4gICAgICogQHNlZSBDbG9jayNnZXRUaW1lKClcbiAgICAgKi9cbiAgICBnZXRUaW1lOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBEYXRlLm5vdygpO1xuICAgIH0pXG4gIH0pO1xuXG4gIHJldHVybiBTeXN0ZW1DbG9jaztcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcImJsdWViaXJkXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFNjb3BlZENvbmZpZ3VyYXRpb25cbikge1xuXG4gIC8qKlxuICAgKiBBIGRldmljZSBmb3IgcmVzb2x2aW5nIGEgc2V0IG9mIHJhdyBjb25maWd1cmF0aW9ucyBnaXZlbiBhIHNldCBvZlxuICAgKiBzY29wZXMuXG4gICAqXG4gICAqIFRoaXMgaXMgdXNlZnVsIGZvciBoYXZpbmcgdGhpbmdzIGxpa2UgcmVnaW9uLSBvciBzdGFnZS1zcGVjaWZpYyAoYW5kL29yIGJvdGgpXG4gICAqIGNvbmZpZ3VyYXRpb25zLlxuICAgKlxuICAgKiBHaXZlbiBzZXRzIG9mIHJhdyBjb25maWd1cmF0aW9ucyBvZiB0aGUgZm9ybTpcbiAgICpcbiAgICogICB7XG4gICAqICAgICBcInNjb3BlLTFcIiA6IHtcbiAgICogICAgICAgXCJrZXkxXCIgOiBcInZhbDFcIlxuICAgKiAgICAgfSxcbiAgICogICAgIFwic2NvcGUtMStlbnYxXCI6IHtcbiAgICogICAgICAgXCJrZXkyXCIgOiBcInZhbC1lbnYtMVwiXG4gICAqICAgICB9LFxuICAgKiAgICAgXCJzY29wZS0xK2VudjJcIjoge1xuICAgKiAgICAgICBcImtleTJcIiA6IFwidmFsLWVudi0yXCJcbiAgICogICAgIH1cbiAgICogICB9XG4gICAqXG4gICAqIGByZXNvbHZlKFtcInNjb3BlLTFcIl0pYCB3aWxsIHJldHVybjpcbiAgICpcbiAgICogICB7XG4gICAqICAgICBcImtleTFcIiA6IFwidmFsMlwiXG4gICAqICAgfVxuICAgKlxuICAgKiBgcmVzb2x2ZShbXCJzY29wZS0xXCIsIFwiZW52LTFcIl0pYCB3aWxsIHJldHVybjpcbiAgICpcbiAgICogICB7XG4gICAqICAgICBcImtleTFcIiA6IFwidmFsMVwiLFxuICAgKiAgICAgXCJrZXkyXCIgOiBcInZhbC1lbnYtMVwiXG4gICAqICAgfVxuICAgKlxuICAgKiBgcmVzb2x2ZShbXCJzY29wZS0xXCIsIFwiZW52LTJcIl0pYCB3aWxsIHJldHVybjpcbiAgICpcbiAgICogICB7XG4gICAqICAgICBcImtleTFcIiA6IFwidmFsMVwiLFxuICAgKiAgICAgXCJrZXkyXCIgOiBcInZhbC1lbnYtMlwiXG4gICAqICAgfVxuICAgKlxuICAgKiBTY29wZXMgdW5pb25zIGFyZSByZXNvbHZlZCBpbiB0aGUgZm9sbG93aW5nIG1hbm5lcjpcbiAgICogICAxLiBhIGdpdmVuIHNjb3BlIHVuaW9uJ3MgcGFydHMgYXJlIHNvcnRlZFxuICAgKiAgIDIuIHNjb3BlIHVuaW9ucyBhcyBhIHdob2xlIGFyZSBhcHBsaWVkIGluIHNvcnRlZCBvcmRlclxuICAgKiAgIDMuIHJlcGVhdCB0aGUgcHJvY2VzcyBmb3IgYSBnaXZlbiBjb25maWd1cmF0aW9uXG4gICAqXG4gICAqIFNvLCBnaXZlbiB0aHJlZSBjb25maWdzOlxuICAgKlxuICAgKiAge1xuICAgKiAgICBcImFhYVwiOiAuLi4gLy8gMVxuICAgKiAgICBcImNjY1wiOiAuLi4gLy8gMlxuICAgKiAgfVxuICAgKlxuICAgKiAge1xuICAgKiAgICBcImFhYStjY2NcIjogLi4uIC8vIDNcbiAgICogICAgXCJjY2NcIiAgICA6IC4uLiAvLyA0XG4gICAqICB9XG4gICAqXG4gICAqICB7XG4gICAqICAgIFwiYWFhK2JiYlwiOiAuLi4gLy8gNVxuICAgKiAgICBcImJiYlwiICAgIDogLi4uIC8vIDZcbiAgICogIH1cbiAgICpcbiAgICogVGhlIHJlc3VsdGluZyBvcmRlciB3aWxsIGJlOlxuICAgKiAgIDEsIDIsIDQsIDMsIDYsIDVcbiAgICpcbiAgICogTm90aWNlIDMgY29tZXMgYmVmb3JlIDUgZXZlbiB0aG91Z2ggaXQncyBsb2dpY2FsbHkgXCJhZnRlclwiIGluIHNvcnRlZCBvcmRlcixcbiAgICogYmVjYXVzZSBjb25maWd1cmF0aW9uIG9yZGVyIG92ZXJyaWRlcyBzY29wZSBvcmRlci4gVGhhdCBpcywgc2NvcGUgdW5pb25zXG4gICAqIGFyZSBvcmRlcmVkIHdpdGhpbiBhIGNvbmZpZywgYW5kIHRoZW4gaW4gY29uZmlnIG9yZGVyLlxuICAgKlxuICAgKi9cbiAgdmFyIFNjb3BlZENvbmZpZ3VyYXRpb25SZXNvbHZlciA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9XG5cbiAgXy5leHRlbmQoU2NvcGVkQ29uZmlndXJhdGlvblJlc29sdmVyLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fY29uZmlncyA9IFtdO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBBIHJhd0NvbmZpZyBpcyBhIHNldCBvZiBjb25maWd1cmF0aW9uIHNjb3BlcyBhbmQgdGhlaXIgY29uZmlndXJhdGlvblxuICAgICAqIHZhbHVlcywgZS5nLjpcbiAgICAgKlxuICAgICAqICAge1xuICAgICAqICAgICBcInNjb3BlLTFcIiA6IHtcbiAgICAgKiAgICAgICBcImtleTFcIiA6IFwidmFsMVwiXG4gICAgICogICAgIH0sXG4gICAgICogICAgIFwic2NvcGUtMStlbnYxXCI6IHtcbiAgICAgKiAgICAgICBcImtleTJcIiA6IFwidmFsLWVudi0xXCJcbiAgICAgKiAgICAgfSxcbiAgICAgKiAgICAgXCJzY29wZS0xK2VudjJcIjoge1xuICAgICAqICAgICAgIFwia2V5MlwiIDogXCJ2YWwtZW52LTJcIlxuICAgICAqICAgICB9XG4gICAgICogICB9XG4gICAgICpcbiAgICAgKiBOb3RlIHRoYXQgdGhlIHBsdXMgKCspIHNpZ24gaXMgcmVzZXJ2ZWQgZm9yIHNwZWNpZnlpbmcgc2NvcGUgdW5pb25zLlxuICAgICAqXG4gICAgICogQHBhcmFtIHJhd0NvbmZpZyB7b2JqZWN0fSAocmVxdWlyZWQpXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB0aGlzXG4gICAgICovXG4gICAgYWRkOiBmdW5jdGlvbihyYXdDb25maWcpIHtcbiAgICAgIHRoaXMuX2NvbmZpZ3MucHVzaChuZXcgU2NvcGVkQ29uZmlndXJhdGlvbihyYXdDb25maWcpKTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBSZXNvbHZlcyBhIGNvbXB1dGVkIGZpbmFsIGNvbmZpZ3VyYXRpb24gZ2l2ZW4gYSBzZXQgb2Ygc2NvcGVzIHRvIGFwcGx5LFxuICAgICAqIGFuZCBhIHNldCBvZiBjb25maWdzIGxvYWRlZCB2aWEgYFNjb3BlZENvbmZpZ3VyYXRpb25SZXNvbHZlciNhZGQoKWAuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gc2NvcGVzIHtBcnJheTxzdHJpbmc+fVxuICAgICAqXG4gICAgICogQHJldHVybnMge29iamVjdH0gdGhlIGNvbXB1dGVkIGNvbmZpZ3VyYXRpb25cbiAgICAgKi9cbiAgICByZXNvbHZlOiBmdW5jdGlvbihzY29wZXMpIHtcbiAgICAgIHNjb3BlcyA9IHBvd2Vyc2V0KF8uY2xvbmUoc2NvcGVzKS5zb3J0KCkpO1xuICAgICAgc2NvcGVzLnNoaWZ0KCk7IC8vIEdldCByaWQgb2YgdGhlIGVtcHR5IHNldC5cblxuICAgICAgc2NvcGVzID0gXy5jb2xsZWN0KHNjb3BlcywgZnVuY3Rpb24ocykge1xuICAgICAgICByZXR1cm4gcy5qb2luKFwiK1wiKTtcbiAgICAgIH0pO1xuXG4gICAgICB2YXIgcmVsZXZhbnRDb25maWdzID0gX1xuICAgICAgICAuY2hhaW4odGhpcy5fY29uZmlncylcbiAgICAgICAgLmNvbGxlY3QoZnVuY3Rpb24oYykge1xuICAgICAgICAgIHJldHVybiBfLmNvbGxlY3Qoc2NvcGVzLCBmdW5jdGlvbihzY29wZSkge1xuICAgICAgICAgICAgcmV0dXJuIGMuYmxvYkZvclNjb3BlKHNjb3BlKTtcbiAgICAgICAgICB9KVxuICAgICAgICB9KS5mbGF0dGVuKCkudmFsdWUoKTtcblxuICAgICAgcmVsZXZhbnRDb25maWdzLnVuc2hpZnQoe30pO1xuICAgICAgcmV0dXJuIF8uZXh0ZW5kLmFwcGx5KF8sIHJlbGV2YW50Q29uZmlncyk7XG4gICAgfVxuICB9KTtcblxuICB2YXIgcG93ZXJzZXQgPSBmdW5jdGlvbiAoYXJ5KSB7XG4gICAgICB2YXIgcHMgPSBbW11dO1xuICAgICAgZm9yICh2YXIgaT0wOyBpIDwgYXJ5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgZm9yICh2YXIgaiA9IDAsIGxlbiA9IHBzLmxlbmd0aDsgaiA8IGxlbjsgaisrKSB7XG4gICAgICAgICAgICAgIHBzLnB1c2gocHNbal0uY29uY2F0KGFyeVtpXSkpO1xuICAgICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBwcztcbiAgfVxuXG4gIHJldHVybiBTY29wZWRDb25maWd1cmF0aW9uUmVzb2x2ZXI7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCIuL3Njb3BlZC1jb25maWd1cmF0aW9uXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF9cbikge1xuXG4gIC8qKlxuICAgKiBHaXZlbiBhIHJhdyBjb25maWcsIGVuc3VyZXMgYmxvYnMgY2FuIGJlIGZldGNoZWQgcmVnYXJkbGVzcyBvZlxuICAgKiBzY29wZSB1bmlvbiBzY29wZSAoaS5lLiwgZG9lcyB1bmlvbiBjYW5vbmljYWxpemF0aW9uKS5cbiAgICpcbiAgICogRm9yIGV4YW1wbGUsIGEgY29uZmlnIHdpdGggc2NvcGUgdW5pb24gYFwiYmJiK2FhYVwiYCBjYW4gbGF0ZXIgYmVcbiAgICogZmV0Y2hlZCB1c2luZyBlaXRoZXIgYFwiYWFhK2JiYlwiYCBvciBgXCJiYmIrYWFhXCJgLiBJdCBkb2VzIHRoaXNcbiAgICogYnkgdW5pZm9ybWx5IG9yZGVyaW5nIHRoZSB1bmlvbidzIGNvbXBvc2l0ZSBzY29wZXMuXG4gICAqXG4gICAqIFRoaXMgcHJvYmFibHkgaXNuJ3QgYSB1c2VmdWwgY2xhc3Mgb24gaXRzIG93bi4gSW5zdGVhZCwgZGVmZXIgdG9cbiAgICogYFNjb3BlZENvbmZpZ3VyYXRpb25SZXNvbHZlcmAgb3IgYENvbmZpZ3VyYXRpb25NYWdpY2AuXG4gICAqL1xuICB2YXIgU2NvcGVkQ29uZmlndXJhdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9XG5cbiAgXy5leHRlbmQoU2NvcGVkQ29uZmlndXJhdGlvbi5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihyYXdDb25maWcpIHtcbiAgICAgIHJhd0NvbmZpZyA9IHJhd0NvbmZpZyB8fCB7fTtcbiAgICAgIHRoaXMuX3Njb3BlcyA9IHt9O1xuICAgICAgLy8gU29ydCB0aGUgc2NvcGUgc3RyaW5nc1xuICAgICAgXy5lYWNoKHJhd0NvbmZpZywgZnVuY3Rpb24oY29uZmlnLCBzY29wZVN0cmluZykge1xuICAgICAgICB2YXIgc2NvcGUgPSBzY29wZVN0cmluZy5zcGxpdChcIitcIikuc29ydCgpLmpvaW4oXCIrXCIpO1xuICAgICAgICB0aGlzLl9zY29wZXNbc2NvcGVdID0gY29uZmlnO1xuICAgICAgfSwgdGhpcyk7XG4gICAgfSxcblxuICAgIGJsb2JGb3JTY29wZTogZnVuY3Rpb24oc2NvcGUpIHtcbiAgICAgIHJldHVybiBfLmNsb25lKHRoaXMuX3Njb3Blc1tzY29wZS5zcGxpdChcIitcIikuc29ydCgpLmpvaW4oXCIrXCIpXSB8fCB7fSk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gU2NvcGVkQ29uZmlndXJhdGlvbjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBSZWYsXG4gIE9wdGlvbnNcbikge1xuXG4gIHZhciBMb2dnZXIgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChMb2dnZXIucHJvdG90eXBlLCB7XG5cbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdGhpcy5fbmFtZSAgICAgICAgID0gb3B0cy5nZXRPckVsc2UoXCJuYW1lXCIsIFwiRGVmYXVsdFwiKTtcbiAgICAgIHRoaXMuX2xvZ0xldmVsICAgICA9IG9wdHMuZ2V0T3JFbHNlKFwibG9nTGV2ZWxcIiwgTG9nVXRpbC5MZXZlbC5JbmZvKTtcbiAgICAgIHRoaXMuX3BhcmVudCAgICAgICA9IG9wdHMuZ2V0T3JFbHNlRm4oXCJyZWZQYXJlbnRcIiwgZnVuY3Rpb24oKSB7IHJldHVybiBSZWYobnVsbCkgfSk7XG5cbiAgICAgIHRoaXMuX2FwcGVuZGVycyA9IFtdO1xuICAgIH0sXG5cbiAgICB0cmFjZTogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9sb2coTG9nVXRpbC5MZXZlbC5UcmFjZSwgXy50b0FycmF5KGFyZ3VtZW50cykpO1xuICAgIH0sXG5cbiAgICBkZWJ1ZzogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9sb2coTG9nVXRpbC5MZXZlbC5EZWJ1ZywgXy50b0FycmF5KGFyZ3VtZW50cykpO1xuICAgIH0sXG5cbiAgICBpbmZvOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX2xvZyhMb2dVdGlsLkxldmVsLkluZm8sIF8udG9BcnJheShhcmd1bWVudHMpKTtcbiAgICB9LFxuXG4gICAgd2FybjogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9sb2coTG9nVXRpbC5MZXZlbC5XYXJuLCBfLnRvQXJyYXkoYXJndW1lbnRzKSk7XG4gICAgfSxcblxuICAgIGVycm9yOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX2xvZyhMb2dVdGlsLkxldmVsLkVycm9yLCBfLnRvQXJyYXkoYXJndW1lbnRzKSk7XG4gICAgfSxcblxuICAgIGZhdGFsOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX2xvZyhMb2dVdGlsLkxldmVsLkZhdGFsLCBfLnRvQXJyYXkoYXJndW1lbnRzKSk7XG4gICAgfSxcblxuICAgIGlzVHJhY2VFbmFibGVkOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLmlzTG9nTGV2ZWxFbmFibGVkKExvZ1V0aWwuTGV2ZWwuVHJhY2UpO1xuICAgIH0sXG5cbiAgICBpc0RlYnVnRW5hYmxlZDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5pc0xvZ0xldmVsRW5hYmxlZChMb2dVdGlsLkxldmVsLkRlYnVnKTtcbiAgICB9LFxuXG4gICAgaXNJbmZvRW5hYmxlZDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5pc0xvZ0xldmVsRW5hYmxlZChMb2dVdGlsLkxldmVsLkluZm8pO1xuICAgIH0sXG5cbiAgICBpc1dhcm5FbmFibGVkOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLmlzTG9nTGV2ZWxFbmFibGVkKExvZ1V0aWwuTGV2ZWwuV2Fybik7XG4gICAgfSxcblxuICAgIGlzRXJyb3JFbmFibGVkOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLmlzTG9nTGV2ZWxFbmFibGVkKExvZ1V0aWwuTGV2ZWwuRXJyb3IpO1xuICAgIH0sXG5cbiAgICBpc0ZhdGFsRW5hYmxlZDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5pc0xvZ0xldmVsRW5hYmxlZChMb2dVdGlsLkxldmVsLkZhdGFsKTtcbiAgICB9LFxuXG4gICAgaXNMb2dMZXZlbEVuYWJsZWQ6IGZ1bmN0aW9uKGxvZ0xldmVsKSB7XG4gICAgICB2YXIgY29lcmNlZExvZ0xldmVsID0gYihsb2dMZXZlbCk7XG4gICAgICByZXR1cm4gKHRoaXMuX2xvZ0xldmVsICYgY29lcmNlZExvZ0xldmVsKSA9PT0gY29lcmNlZExvZ0xldmVsO1xuICAgIH0sXG5cbiAgICBhZGRBcHBlbmRlcjogZnVuY3Rpb24oYXBwZW5kZXIpIHtcbiAgICAgIHRoaXMuX2FwcGVuZGVycy5wdXNoKGFwcGVuZGVyKTtcbiAgICB9LFxuXG4gICAgc2V0TG9nTGV2ZWw6IGZ1bmN0aW9uKGxvZ0xldmVsKSB7XG4gICAgICAvLyBTYXZlIGEgY29weSBmb3IgdGhlIHBvdGVudGlhbCBlcnJvciBtZXNzYWdlXG4gICAgICB2YXIgb3JpZ2luYWxMb2dMZXZlbCA9IGxvZ0xldmVsO1xuXG4gICAgICAvLyBJZiBuYW1lIGlzIHNwZWNpZmllZCwgZS5nLiwgXCJJbmZvXCIsIGNvbnZlcnQgdG9cbiAgICAgIC8vIGludFxuICAgICAgaWYgKF8uaXNTdHJpbmcobG9nTGV2ZWwpKSB7XG4gICAgICAgIGxvZ0xldmVsID0gTG9nVXRpbC5MZXZlbFtsb2dMZXZlbF1cbiAgICAgIH1cblxuICAgICAgdmFyIGV4aXN0cyA9IF8uZGV0ZWN0KExvZ1V0aWwuTGV2ZWwsIGZ1bmN0aW9uKGxldmVsLCBuYW1lKSB7XG4gICAgICAgIHJldHVybiBsZXZlbCA9PT0gbG9nTGV2ZWw7XG4gICAgICB9KTtcblxuICAgICAgaWYgKCFleGlzdHMpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBsb2dMZXZlbDogXCIgKyBvcmlnaW5hbExvZ0xldmVsKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5fbG9nTGV2ZWwgPSBsb2dMZXZlbDtcbiAgICB9LFxuXG5cbiAgICBfbG9nOiBmdW5jdGlvbihsb2dMZXZlbCwgbG9nQXJncykge1xuICAgICAgdGhpcy5fbG9nV2l0aE1ldGFkYXRhKFtdLCBsb2dMZXZlbCwgbG9nQXJncyk7XG4gICAgfSxcblxuICAgIF9sb2dXaXRoTWV0YWRhdGE6IGZ1bmN0aW9uKGRlc2NlbmRhbnRzLCBsb2dMZXZlbCwgYXJncykge1xuICAgICAgaWYgKHRoaXMuaXNMb2dMZXZlbEVuYWJsZWQobG9nTGV2ZWwpKSB7XG4gICAgICAgIF8uZWFjaCh0aGlzLl9hcHBlbmRlcnMsIGZ1bmN0aW9uKGFwcGVuZGVyKSB7XG4gICAgICAgICAgYXBwZW5kZXIubG9nKHRoaXMuX25hbWUsIGRlc2NlbmRhbnRzLCBsb2dMZXZlbCwgTG9nVXRpbC5fTGFiZWxbbG9nTGV2ZWxdLCBhcmdzKTtcbiAgICAgICAgfSwgdGhpcyk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLl9wYXJlbnQuZ2V0KCkpIHtcbiAgICAgICAgdGhpcy5fcGFyZW50LmdldCgpLl9sb2dXaXRoTWV0YWRhdGEoW3RoaXMuX25hbWVdLmNvbmNhdChkZXNjZW5kYW50cyksIGxvZ0xldmVsLCBhcmdzKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIHZhciBMb2dVdGlsID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgLy8gQ29lcmNlIChqdXN0IHVzZSByaWdodG1vc3QgOCBiaXRzKSE7IGJlY2F1c2UgSlMgaXMgZHVtYiwgYW5kIGV2ZXJ5dGhpbmcgaXNcbiAgLy8gYWN0dWFsbHkgYSBmbG9hdCB3aXRoIDUzLWJpdCBwcmVjaXNpb25cbiAgdmFyIGIgPSBmdW5jdGlvbih2KSB7XG4gICAgcmV0dXJuIDB4RkYgJiB2O1xuICB9O1xuXG4gIF8uZXh0ZW5kKExvZ1V0aWwsIHtcbiAgICBMZXZlbDoge1xuICAgICAgVHJhY2U6IGIocGFyc2VJbnQoXCIxMTExMTFcIiwgMikpLFxuICAgICAgRGVidWc6IGIocGFyc2VJbnQoXCIwMTExMTFcIiwgMikpLFxuICAgICAgSW5mbzogIGIocGFyc2VJbnQoXCIwMDExMTFcIiwgMikpLFxuICAgICAgV2FybjogIGIocGFyc2VJbnQoXCIwMDAxMTFcIiwgMikpLFxuICAgICAgRXJyb3I6IGIocGFyc2VJbnQoXCIwMDAwMTFcIiwgMikpLFxuICAgICAgRmF0YWw6IGIocGFyc2VJbnQoXCIwMDAwMDFcIiwgMikpXG4gICAgfVxuICB9KTtcblxuICBfLmV4dGVuZChMb2dVdGlsLnByb3RvdHlwZSwge1xuICAgIExldmVsOiBMb2dVdGlsLkxldmVsLFxuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fcm9vdExvZ2dlciA9IFJlZihuZXcgTG9nZ2VyKHtcbiAgICAgICAgbmFtZTogXCJSb290XCJcbiAgICAgIH0pKTtcbiAgICB9LFxuXG4gICAgY3JlYXRlOiBmdW5jdGlvbihuYW1lLCBvcHRzKSB7XG4gICAgICBvcHRzID0gXy5jbG9uZShvcHRzIHx8IHt9KTtcblxuICAgICAgdmFyIHBhcmVudDtcbiAgICAgIGlmIChvcHRzLnBhcmVudCkge1xuICAgICAgICBwYXJlbnQgPSBSZWYob3B0cy5wYXJlbnQpO1xuICAgICAgICBkZWxldGUob3B0cy5wYXJlbnQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcGFyZW50ID0gUmVmLmRlbGVnYXRpbmcodGhpcy5fcm9vdExvZ2dlcik7XG4gICAgICB9XG5cbiAgICAgIG9wdHMucmVmUGFyZW50ID0gcGFyZW50O1xuXG4gICAgICBvcHRzLm5hbWUgPSBuYW1lO1xuXG4gICAgICByZXR1cm4gbmV3IExvZ2dlcihvcHRzKTtcbiAgICB9LFxuXG4gICAgcm9vdDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fcm9vdExvZ2dlci5nZXQoKTtcbiAgICB9LFxuXG4gICAgcmVzZXRSb290TG9nZ2VyOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX3Jvb3RMb2dnZXIuc2V0KG5ldyBMb2dnZXIoe1xuICAgICAgICBuYW1lOiBcIlJvb3RcIlxuICAgICAgfSkpO1xuICAgIH1cbiAgfSk7XG5cblxuICBMb2dVdGlsLl9MYWJlbCA9IF8ucmVkdWNlKExvZ1V0aWwuTGV2ZWwsIGZ1bmN0aW9uKG1lbW8sIHZhbCwga2V5KSB7XG4gICAgbWVtb1t2YWxdID0ga2V5O1xuICAgIHJldHVybiBtZW1vO1xuICB9LCB7fSk7XG5cbiAgcmV0dXJuIG5ldyBMb2dVdGlsKCk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCIuLi9yZWZcIiksXG4gIHJlcXVpcmUoXCIuLi9vcHRpb25zXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIE0sXG4gIFVVSUQsXG4gIE9wdGlvbnMsXG4gIFN0YXRlR3VhcmRcbikge1xuXG4gIHZhciBDaGFubmVsID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoQ2hhbm5lbC5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuXG4gICAgICB0aGlzLl9zZW50aW5lbCAgICAgID0gb3B0cy5nZXRPckVycm9yKFwic2VudGluZWxcIik7XG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkICAgID0gbmV3IFN0YXRlR3VhcmQoW1wiZGlzcG9zZWRcIl0pO1xuICAgICAgdGhpcy5fc3Vic2NyaXB0aW9ucyA9IE0uaGFzaF9tYXAoKTtcbiAgICB9LFxuXG4gICAgcmVzZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgTS5lYWNoKHRoaXMuX3N1YnNjcmlwdGlvbnMsIGZ1bmN0aW9uKHBhaXIpIHtcbiAgICAgICAgTS5udGgocGFpciwgMSkuZGlzcG9zZSgpO1xuICAgICAgfSk7XG4gICAgICB0aGlzLl9zdWJzY3JpcHRpb25zID0gTS5oYXNoX21hcCgpO1xuICAgIH0sXG5cbiAgICBwdWJsaXNoOiBmdW5jdGlvbihzZW50aW5lbCwgbXNnKSB7XG4gICAgICByZXR1cm4gdGhpcy5fcHVibGlzaC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH0sXG5cblxuICAgIHN1YnNjcmliZTogZnVuY3Rpb24oaGFuZGxlcikge1xuICAgICAgcmV0dXJuIHRoaXMuX3N1YnNjcmliZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH0sXG5cblxuICAgIGRpc3Bvc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2Rpc3Bvc2UuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9LFxuXG5cbiAgICBpc0Rpc3Bvc2VkOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zdGF0ZUd1YXJkLmFwcGxpZWQoXCJkaXNwb3NlZFwiKTtcbiAgICB9LFxuXG5cbiAgICBfcHVibGlzaDogZnVuY3Rpb24oc2VudGluZWwsIG1zZykge1xuICAgICAgdGhpcy5fc3RhdGVHdWFyZC5kZW55KFwiZGlzcG9zZWRcIik7XG5cbiAgICAgIGlmICh0aGlzLl9zZW50aW5lbCAhPT0gc2VudGluZWwpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBzZW50aW5lbCBwcm92aWRlZDsgcHVibGlzaGVyIG11c3QgaGF2ZSBzYW1lIHNlbnRpbmVsIHByb3ZpZGVkIGR1cmluZyBpbnN0YW50aWF0aW9uLlwiKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuX2Rpc3BhdGNoKG1zZyk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9LFxuXG5cbiAgICBfc3Vic2NyaWJlOiBmdW5jdGlvbihoYW5kbGVyKSB7XG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkLmRlbnkoXCJkaXNwb3NlZFwiKTtcblxuICAgICAgdmFyIHN1YiA9IG5ldyBTdWJzY3JpcHRpb24odGhpcywgaGFuZGxlciksXG4gICAgICAgICAgaWQgID0gc3ViLmlkKCk7XG5cbiAgICAgIHRoaXMuX3N1YnNjcmlwdGlvbnMgPSBNLmFzc29jKHRoaXMuX3N1YnNjcmlwdGlvbnMsIGlkLCBzdWIpO1xuXG4gICAgICByZXR1cm4gc3ViO1xuICAgIH0sXG5cblxuICAgIF9kaXNwb3NlOiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICh0aGlzLl9zdGF0ZUd1YXJkLmFwcGxpZWQoXCJkaXNwb3NlZFwiKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIEduYXJseSwgYXMgdGhpcyBob3BzIGJhY2sgYW5kIGZvcnRoIGJldHdlZW4gdGhlIGNoYW5uZWwgYW5kIHRoZSBzdWIsIGJ1dFxuICAgICAgLy8gZWFzaWVyIHRoYW4gc3BsaXR0aW5nIHRoZSBkaXNwb3NlIGxvZ2ljIGludG8gdHdvIG1ldGhvZHMgaW4gdGhlIHN1Yi5cbiAgICAgIE0uZWFjaCh0aGlzLl9zdWJzY3JpcHRpb25zLCBmdW5jdGlvbihwYWlyKSB7XG4gICAgICAgIE0ubnRoKHBhaXIsIDEpLmRpc3Bvc2UoKTtcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLl9zdWJzY3JpcHRpb25zID0gTS5oYXNoX21hcCgpO1xuXG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkLmFwcGx5KFwiZGlzcG9zZWRcIik7XG4gICAgfSxcblxuXG4gICAgX2Rpc3BhdGNoOiBmdW5jdGlvbihtc2cpIHtcbiAgICAgIE0uZWFjaCh0aGlzLl9zdWJzY3JpcHRpb25zLCBmdW5jdGlvbihwYWlyKSB7XG4gICAgICAgIE0ubnRoKHBhaXIsIDEpLmRpc3BhdGNoKG1zZyk7XG4gICAgICB9KTtcbiAgICB9LFxuXG5cbiAgICBfZGlzcG9zZUhhbmRsZTogZnVuY3Rpb24oaWQpIHtcbiAgICAgIHRoaXMuX3N1YnNjcmlwdGlvbnMgPSBNLmRpc3NvYyh0aGlzLl9zdWJzY3JpcHRpb25zLCBpZCk7XG4gICAgfVxuICB9KTtcblxuICB2YXIgU3Vic2NyaXB0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoU3Vic2NyaXB0aW9uLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKGNoYW5uZWwsIGhhbmRsZXIpIHtcbiAgICAgIHRoaXMuX2lkICAgICAgICAgPSBVVUlELnY0KCk7XG4gICAgICB0aGlzLl9jaGFubmVsICAgID0gY2hhbm5lbDtcbiAgICAgIHRoaXMuX2hhbmRsZXIgICAgPSBoYW5kbGVyO1xuICAgICAgdGhpcy5fc3RhdGVHdWFyZCA9IG5ldyBTdGF0ZUd1YXJkKFtcImRpc3Bvc2VkXCJdKTtcblxuICAgICAgXy5iaW5kQWxsKHRoaXMsIFwiZGlzcG9zZVwiKTtcbiAgICB9LFxuXG5cbiAgICBkaXNwb3NlOiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICh0aGlzLl9zdGF0ZUd1YXJkLmFwcGxpZWQoXCJkaXNwb3NlZFwiKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuX2NoYW5uZWwuX2Rpc3Bvc2VIYW5kbGUodGhpcy5faWQpO1xuXG4gICAgICB0aGlzLl9oYW5kbGVyID0gbnVsbDtcbiAgICAgIHRoaXMuX2NoYW5uZWwgPSBudWxsO1xuXG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkLmFwcGx5KFwiZGlzcG9zZWRcIik7XG4gICAgfSxcblxuXG4gICAgaWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2lkO1xuICAgIH0sXG5cblxuICAgIGRpc3BhdGNoOiBmdW5jdGlvbihtc2cpIHtcbiAgICAgIGlmICh0aGlzLl9zdGF0ZUd1YXJkLmFwcGxpZWQoXCJkaXNwb3NlZFwiKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuX2hhbmRsZXIobXNnKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBDaGFubmVsO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwibW9yaVwiKSxcbiAgcmVxdWlyZShcIi4uL3V1aWRcIiksXG4gIHJlcXVpcmUoXCIuLi9vcHRpb25zXCIpLFxuICByZXF1aXJlKFwiLi4vc3RhdGUtZ3VhcmRcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgTSxcbiAgT3B0aW9ucyxcbiAgQ2hhbm5lbFxuKSB7XG5cbiAgdmFyIENoYWluZWRDaGFubmVsID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoQ2hhaW5lZENoYW5uZWwucHJvdG90eXBlLCBDaGFubmVsLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIENoYW5uZWwucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG5cbiAgICAgIF8uYmluZEFsbCh0aGlzLCBcIl9mb3J3YXJkXCIpO1xuICAgICAgdGhpcy5fY2hhaW5lZFN1YnMgPSBNLnZlY3RvcigpO1xuXG4gICAgICB2YXIgaW5pdGlhbGx5Q2hhaW5lZFRvID0gb3B0cy5nZXRPckVsc2UoXCJjaGFpblRvXCIpO1xuICAgICAgaWYgKGluaXRpYWxseUNoYWluZWRUbykge1xuICAgICAgICB0aGlzLmNoYWluVG8oaW5pdGlhbGx5Q2hhaW5lZFRvKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgY2hhaW5UbzogZnVuY3Rpb24ob3RoZXJDaGFubmVsKSB7XG4gICAgICB0aGlzLl9jaGFpbmVkU3VicyA9IE0uY29uaih0aGlzLl9jaGFpbmVkU3Vicywgb3RoZXJDaGFubmVsLnN1YnNjcmliZSh0aGlzLl9mb3J3YXJkKSk7XG4gICAgfSxcblxuICAgIGRpc3Bvc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHN1YnMgPSB0aGlzLl9jaGFpbmVkU3VicztcblxuICAgICAgdGhpcy5fY2hhaW5lZFN1YnMgPSBNLnZlY3RvcigpO1xuXG4gICAgICBNLmVhY2goc3VicywgZnVuY3Rpb24oc3ViKSB7XG4gICAgICAgIHN1Yi5kaXNwb3NlKCk7XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIHRoaXMuX2Rpc3Bvc2UuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9LFxuXG4gICAgX2ZvcndhcmQ6IGZ1bmN0aW9uKG1zZykge1xuICAgICAgdGhpcy5fcHVibGlzaCh0aGlzLl9zZW50aW5lbCwgbXNnKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBDaGFpbmVkQ2hhbm5lbDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcIm1vcmlcIiksXG4gIHJlcXVpcmUoXCIuLi9vcHRpb25zXCIpLFxuICByZXF1aXJlKFwiLi9jaGFubmVsXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIE0sXG4gIE9wdGlvbnMsXG4gIENoYW5uZWxcbikge1xuXG4gIHZhciBDb21wb3NpdGVDaGFubmVsID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoQ29tcG9zaXRlQ2hhbm5lbC5wcm90b3R5cGUsIENoYW5uZWwucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgQ2hhbm5lbC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcblxuICAgICAgdGhpcy5fZm9yd2FyZGluZyA9IE0uaGFzaF9tYXAoKTtcblxuICAgICAgdmFyIGxpc3RlbiA9IG9wdHMuZ2V0T3JFbHNlKFwibGlzdGVuXCIsIFtdKTtcbiAgICAgIGlmICghXy5pc0FycmF5KGxpc3RlbikpIHtcbiAgICAgICAgbGlzdGVuID0gW2xpc3Rlbl07XG4gICAgICB9XG5cbiAgICAgIF8uZWFjaChsaXN0ZW4sIF8uYmluZChmdW5jdGlvbihjKSB7XG4gICAgICAgIHRoaXMubGlzdGVuKGMpO1xuICAgICAgfSwgdGhpcykpO1xuICAgIH0sXG5cblxuICAgIGRpc3Bvc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgQ2hhbm5lbC5wcm90b3R5cGUuZGlzcG9zZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgdmFyIGZvcndhcmRpbmcgPSB0aGlzLl9mb3J3YXJkaW5nO1xuICAgICAgdGhpcy5fZm9yd2FyZGluZyA9IE0uaGFzaF9tYXAoKTtcblxuICAgICAgTS5lYWNoKGZvcndhcmRpbmcsIF8uYmluZChmdW5jdGlvbihwYWlyKSB7XG4gICAgICAgIE0ubnRoKHBhaXIsIDEpLmRpc3Bvc2UoKTtcbiAgICAgIH0sIHRoaXMpKTtcbiAgICB9LFxuXG5cbiAgICBsaXN0ZW46IGZ1bmN0aW9uKGNoYW5uZWwpIHtcbiAgICAgIHZhciBzdWIgPSBjaGFubmVsLnN1YnNjcmliZShfLmJpbmQoZnVuY3Rpb24obXNnKSB7XG4gICAgICAgIHRoaXMuX2ZvcndhcmQobXNnKVxuICAgICAgfSwgdGhpcykpO1xuICAgICAgdGhpcy5fZm9yd2FyZGluZyA9IE0uYXNzb2ModGhpcy5fZm9yd2FyZGluZywgY2hhbm5lbCwgc3ViKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZGlzcG9zZTogXy5iaW5kKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHRoaXMuX2ZvcndhcmRpbmcgPSBNLmRpc3NvYyh0aGlzLl9mb3J3YXJkaW5nLCBjaGFubmVsKTtcbiAgICAgICAgICBzdWIuZGlzcG9zZSgpO1xuICAgICAgICB9LCB0aGlzKVxuICAgICAgfTtcbiAgICB9LFxuXG5cbiAgICBfZm9yd2FyZDogZnVuY3Rpb24obXNnKSB7XG4gICAgICB0aGlzLnB1Ymxpc2godGhpcy5fc2VudGluZWwsIG1zZyk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gQ29tcG9zaXRlQ2hhbm5lbDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcIm1vcmlcIiksXG4gIHJlcXVpcmUoXCIuLi9vcHRpb25zXCIpLFxuICByZXF1aXJlKFwiLi9jaGFubmVsXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFByb21pc2UsXG4gIE0sXG4gIE9wdGlvbnMsXG4gIFVVSUQsXG4gIFN0YXRlR3VhcmQsXG4gIExvZ2dlclxuKSB7XG5cbiAgdmFyIEluTWVtb3J5RmliZXIgPSAoZnVuY3Rpb24oKSB7XG4gICAgdmFyIEtsYXNzID0gZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9O1xuXG4gICAgdmFyIExvZyA9IExvZ2dlci5jcmVhdGUoXCJJbk1lbW9yeUxvZ2dlclwiKTtcblxuICAgIF8uZXh0ZW5kKEtsYXNzLnByb3RvdHlwZSwge1xuICAgICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuXG4gICAgICAgIHRoaXMuX2VudGl0aWVzID0gTS5oYXNoX21hcCgpO1xuICAgICAgICB0aGlzLl9pZGVudGl0eSA9IG9wdHMuZ2V0T3JFbHNlKFwiaWRlbnRpdHlcIiwgVVVJRC52NCgpKTtcblxuICAgICAgICB0aGlzLl9zdGF0ZUd1YXJkID0gbmV3IFN0YXRlR3VhcmQoW1wiZGlzcG9zZWRcIl0pO1xuXG4gICAgICAgIF8uYmluZEFsbCh0aGlzLCBcIl9yZWNlaXZlXCIpO1xuICAgICAgfSxcblxuXG4gICAgICBpZDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pZGVudGl0eTtcbiAgICAgIH0sXG5cblxuICAgICAgZGlzcG9zZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLl9zdGF0ZUd1YXJkLmFwcGxpZWQoXCJkaXNwb3NlZFwiKSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9kaXNwb3NlKCk7XG4gICAgICAgIHRoaXMuX3N0YXRlR3VhcmQuYXBwbHkoXCJkaXNwb3NlZFwiKTtcbiAgICAgIH0sXG5cbiAgICAgIF9kaXNwb3NlOiBmdW5jdGlvbigpIHtcblxuICAgICAgICB2YXIgZW50aXRpZXMgPSB0aGlzLl9lbnRpdGllcztcbiAgICAgICAgTS5lYWNoKGVudGl0aWVzLCBmdW5jdGlvbihwYWlyKSB7XG4gICAgICAgICAgTS5udGgocGFpciwgMSkuZGlzcG9zZSgpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLl9lbnRpdGllcyA9IG51bGw7XG4gICAgICB9LFxuXG4gICAgICByZWdpc3RlckVudGl0eTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuXG4gICAgICAgIHZhciBpZGVudGl0eSA9IG9wdHMuZ2V0T3JFcnJvcihcImlkZW50aXR5XCIpLFxuICAgICAgICAgICAgZW50aXR5ICAgPSBuZXcgTG9jYWxFbnRpdHkoe1xuICAgICAgICAgICAgICBpZGVudGl0eTogaWRlbnRpdHksXG4gICAgICAgICAgICAgIGRlbGVnYXRlOiBvcHRzLmdldE9yRXJyb3IoXCJkZWxlZ2F0ZVwiKVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5fZW50aXRpZXMgPSBNLmFzc29jKHRoaXMuX2VudGl0aWVzLCBpZGVudGl0eSwgZW50aXR5KTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9LFxuXG4gICAgICAvKipcbiAgICAgICAqIFJldHVybnMgYSBwcm9taXNlIHdoaWNoIGlzIGZ1bGZpbGxlZCB3aGVuIHRoZSBtZXNzYWdlIGlzXG4gICAgICAgKiBzZW50LCBub3QgcmVjZWl2ZWQgYnkgdGhlIHJlbW90ZSBlbmQuIFRoaXMgdG8gbGV0IHRoZVxuICAgICAgICogY2FsbGVyIGtub3cgd2hldGhlciBvciBub3QgdGhlIG1lc3NhZ2UgaXMgc3R1Y2tcbiAgICAgICAqIGluIGEgYnVmZmVyIHNvbWV3aGVyZSB3aGVuIGNhbGN1bGF0aW5nIGl0cyB0aW1lb3V0cy5cbiAgICAgICAqL1xuICAgICAgc2VuZDogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24ob3B0cykge1xuICAgICAgICB0aGlzLl9zdGF0ZUd1YXJkLmRlbnkoXCJkaXNwb3NlZFwiKTtcblxuICAgICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgICB2YXIgZnJvbSAgID0gb3B0cy5nZXRPckVycm9yKFwiZnJvbVwiKSxcbiAgICAgICAgICAgIHRvICAgICA9IG9wdHMuZ2V0T3JFcnJvcihcInRvXCIpLFxuICAgICAgICAgICAgYm9keSAgID0gb3B0cy5nZXRPckVycm9yKFwiYm9keVwiKSxcbiAgICAgICAgICAgIG1zZ0lkICA9IG9wdHMuZ2V0T3JFcnJvcihcIm1zZ0lkXCIpLFxuXG4gICAgICAgICAgICBtVCAgICAgPSBvcHRzLmdldE9yRWxzZShcIm1UXCIpLFxuICAgICAgICAgICAgck1zZ0lkID0gb3B0cy5nZXRPckVsc2UoXCJyTXNnSWRcIik7XG5cblxuICAgICAgICAvL1hYWDogVGhpcyBpcyBpbi1tZW1vcnksIHNvIGl0J3MgYXMgc2ltcGxlXG4gICAgICAgIC8vIGFzIGludm9raW5nIF9yZWNlaXZlIGluIGEgZnV0dXJlIGNhbGwgc3RhY2tcbiAgICAgICAgcmV0dXJuIFByb21pc2VcbiAgICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgXy5kZWZlcih0aGlzLl9yZWNlaXZlLCB7XG4gICAgICAgICAgICAgIGZyb206ICAgZnJvbSxcbiAgICAgICAgICAgICAgdG86ICAgICB0byxcbiAgICAgICAgICAgICAgYm9keTogICBib2R5LFxuICAgICAgICAgICAgICBtc2dJZDogIG1zZ0lkLFxuICAgICAgICAgICAgICBtVDogICAgIG1ULFxuICAgICAgICAgICAgICByTXNnSWQ6IHJNc2dJZCxcbiAgICAgICAgICAgICAgb0ZpYjogICB0aGlzLl9pZGVudGl0eVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBtc2dJZDtcbiAgICAgICAgICB9KTtcbiAgICAgIH0pLFxuXG4gICAgICBfcmVjZWl2ZTogZnVuY3Rpb24oZW52KSB7XG4gICAgICAgIGlmICh0aGlzLl9zdGF0ZUd1YXJkLmFwcGxpZWQoXCJkaXNwb3NlZFwiKSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGVudiA9IE9wdGlvbnMuZnJvbU9iamVjdChlbnYpO1xuICAgICAgICB2YXIgdG8sIGZyb20sIGJvZHksIG1zZ0lkLCBvcmlnaW5GaWJlciwgbVQsIHJNc2dJZDtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgIHRvICAgICAgICAgID0gZW52LmdldE9yRXJyb3IoXCJ0b1wiKTtcbiAgICAgICAgICBmcm9tICAgICAgICA9IGVudi5nZXRPckVycm9yKFwiZnJvbVwiKTtcbiAgICAgICAgICBib2R5ICAgICAgICA9IGVudi5nZXRPckVycm9yKFwiYm9keVwiKTtcbiAgICAgICAgICBtc2dJZCAgICAgICA9IGVudi5nZXRPckVycm9yKFwibXNnSWRcIik7XG5cbiAgICAgICAgICAvLyBGdXR1cmUtcHJvb2ZpbmcgZm9yIG11bHRpLWZpYmVyIGZhYnJpYy5cbiAgICAgICAgICBvcmlnaW5GaWJlciA9IGVudi5nZXRPckVycm9yKFwib0ZpYlwiKTtcblxuICAgICAgICAgIG1UICAgICA9IGVudi5nZXRPckVsc2UoXCJtVFwiKTtcbiAgICAgICAgICByTXNnSWQgPSBlbnYuZ2V0T3JFbHNlKFwick1zZ0lkXCIpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgTG9nLmVycm9yKFwiUmVjZWl2ZWQgbWFsZm9ybWVkIG1lc3NhZ2VcIiwgZW52KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBlbnRpdHkgPSBNLmdldCh0aGlzLl9lbnRpdGllcywgdG8pO1xuXG4gICAgICAgIGlmIChlbnRpdHkpIHtcbiAgICAgICAgICBlbnRpdHkuZGlzcGF0Y2goe1xuICAgICAgICAgICAgdG86ICAgICB0byxcbiAgICAgICAgICAgIGZyb206ICAgZnJvbSxcbiAgICAgICAgICAgIGJvZHk6ICAgYm9keSxcbiAgICAgICAgICAgIG1zZ0lkOiAgbXNnSWQsXG4gICAgICAgICAgICByTXNnSWQ6IHJNc2dJZCxcbiAgICAgICAgICAgIG9GaWI6ICAgb3JpZ2luRmliZXIsXG4gICAgICAgICAgICBoRmliOiAgIHRoaXMuX2lkZW50aXR5LFxuICAgICAgICAgICAgbVQ6IG1UXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBLbGFzcztcbiAgfSkoKTtcblxuXG5cbiAgdmFyIExvY2FsRW50aXR5ID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoTG9jYWxFbnRpdHkucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcblxuICAgICAgdGhpcy5faWRlbnRpdHkgPSBvcHRzLmdldE9yRXJyb3IoXCJpZGVudGl0eVwiKTtcbiAgICAgIHRoaXMuX2RlbGVnYXRlID0gb3B0cy5nZXRPckVycm9yKFwiZGVsZWdhdGVcIik7XG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkID0gbmV3IFN0YXRlR3VhcmQoW1wiZGlzcG9zZWRcIl0pO1xuICAgIH0sXG4gICAgZGlzcG9zZTogZnVuY3Rpb24oKSB7XG4gICAgICBpZiAodGhpcy5fc3RhdGVHdWFyZC5hcHBsaWVkKFwiZGlzcG9zZWRcIikpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9kZWxlZ2F0ZSA9IG51bGw7XG5cbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQuYXBwbHkoXCJkaXNwb3NlZFwiKTtcbiAgICB9LFxuICAgIGRpc3BhdGNoOiBmdW5jdGlvbihlbnYpIHtcbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQuZGVueShcImRpc3Bvc2VkXCIpO1xuXG4gICAgICB0aGlzLl9kZWxlZ2F0ZS5yZWNlaXZlRmliZXJNZXNzYWdlKGVudik7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gSW5NZW1vcnlGaWJlcjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcImJsdWViaXJkXCIpLFxuICByZXF1aXJlKFwibW9yaVwiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvdXVpZFwiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvc3RhdGUtZ3VhcmRcIiksXG4gIHJlcXVpcmUoXCIuLi8uLi9jb3JlL2xvZ2dpbmcvbG9nZ2VyXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFByb21pc2UsXG4gIE0sXG4gIE9wdGlvbnMsXG4gIEluTWVtb3J5RmliZXIsXG4gIENoYW5uZWwsXG4gIENvbXBvc2l0ZUNoYW5uZWxcbikge1xuXG4gIC8qKlxuICAgKiBMaW5rYWJsZUZpYmVyIGlzIGEgcmVmZXJlbmNlIGltcGxlbWVudGF0aW9uIGZvciBpbXBsZW1lbnRpbmcgYSBtdWx0aS1maWJlciBcImZhYnJpY1wiLlxuICAgKi9cbiAgdmFyIExpbmthYmxlRmliZXIgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChMaW5rYWJsZUZpYmVyLnByb3RvdHlwZSwgSW5NZW1vcnlGaWJlci5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBJbk1lbW9yeUZpYmVyLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuXG5cbiAgICAgIHRoaXMuX2xvY2FsRGlzcGF0Y2ggID0gbmV3IENoYW5uZWwoeyBzZW50aW5lbDogdGhpcyB9KTtcbiAgICAgIHRoaXMuX2luZ3Jlc3NDaGFubmVsID0gbmV3IENvbXBvc2l0ZUNoYW5uZWwoe1xuICAgICAgICBzZW50aW5lbDogdGhpcyxcbiAgICAgICAgbGlzdGVuOiAgIHRoaXMuX2xvY2FsRGlzcGF0Y2hcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLl9lZ3Jlc3NDaGFubmVsICA9IG5ldyBDaGFubmVsKHsgc2VudGluZWw6IHRoaXMgfSk7XG5cbiAgICAgIC8vIF9yZWNlaXZlIGlzIGRlZmluZWQgYW5kIGJvdW5kIGluIEluTWVtb3J5RmliZXIgKFwicHJvdGVjdGVkXCIgbWV0aG9kKVxuICAgICAgdGhpcy5faW5ncmVzc0NoYW5uZWwuc3Vic2NyaWJlKHRoaXMuX3JlY2VpdmUpO1xuICAgIH0sXG5cblxuICAgIGxpc3RlbjogZnVuY3Rpb24oY2hhbm5lbCkge1xuICAgICAgdGhpcy5faW5ncmVzc0NoYW5uZWwubGlzdGVuKGNoYW5uZWwpO1xuICAgIH0sXG5cblxuICAgIGVncmVzc0NoYW5uZWw6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2VncmVzc0NoYW5uZWw7XG4gICAgfSxcblxuXG4gICAgX2Rpc3Bvc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgSW5NZW1vcnlGaWJlci5wcm90b3R5cGUuX2Rpc3Bvc2UuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9LFxuXG4gICAgc2VuZDogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24ob3B0cykge1xuICAgICAgdGhpcy5fc3RhdGVHdWFyZC5kZW55KFwiZGlzcG9zZWRcIik7XG5cbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG5cbiAgICAgIHZhciBmcm9tICAgPSBvcHRzLmdldE9yRXJyb3IoXCJmcm9tXCIpLFxuICAgICAgICAgIHRvICAgICA9IG9wdHMuZ2V0T3JFcnJvcihcInRvXCIpLFxuICAgICAgICAgIGJvZHkgICA9IG9wdHMuZ2V0T3JFcnJvcihcImJvZHlcIiksXG4gICAgICAgICAgbXNnSWQgID0gb3B0cy5nZXRPckVycm9yKFwibXNnSWRcIiksXG4gICAgICAgICAgbVQgICAgID0gb3B0cy5nZXRPckVsc2UoXCJtVFwiKSxcbiAgICAgICAgICByTXNnSWQgPSBvcHRzLmdldE9yRWxzZShcInJNc2dJZFwiKSxcbiAgICAgICAgICBjaGFuICAgPSBudWxsO1xuXG4gICAgICB2YXIgbXNnID0ge1xuICAgICAgICBmcm9tOiAgIGZyb20sXG4gICAgICAgIHRvOiAgICAgdG8sXG4gICAgICAgIGJvZHk6ICAgYm9keSxcbiAgICAgICAgbXNnSWQ6ICBtc2dJZCxcbiAgICAgICAgbVQ6ICAgICBtVCxcbiAgICAgICAgck1zZ0lkOiByTXNnSWQsXG4gICAgICAgIG9GaWI6ICAgdGhpcy5faWRlbnRpdHlcbiAgICAgIH07XG5cbiAgICAgIC8vIExvY2FsIGRpc3BhdGNoLCBza2lwIHRoZSByb3VuZC10cmlwXG4gICAgICBpZiAoTS5nZXQodGhpcy5fZW50aXRpZXMsIHRvKSkge1xuICAgICAgICBjaGFuID0gdGhpcy5fbG9jYWxEaXNwYXRjaDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNoYW4gPSB0aGlzLl9lZ3Jlc3NDaGFubmVsO1xuICAgICAgfVxuXG4gICAgICBfLmRlZmVyKF8uYmluZChmdW5jdGlvbigpIHtcbiAgICAgICAgY2hhbi5wdWJsaXNoKHRoaXMsIG1zZyk7XG4gICAgICB9LCB0aGlzKSk7XG5cbiAgICAgIHJldHVybiBtc2dJZDtcbiAgICB9KVxuXG5cbiAgfSk7XG5cbiAgcmV0dXJuIExpbmthYmxlRmliZXI7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJibHVlYmlyZFwiKSxcbiAgcmVxdWlyZShcIm1vcmlcIiksXG4gIHJlcXVpcmUoXCIuLi8uLi9jb3JlL29wdGlvbnNcIiksXG4gIHJlcXVpcmUoXCIuL2luLW1lbW9yeS1maWJlclwiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvY2hhbm5lbC9jaGFubmVsXCIpLFxuICByZXF1aXJlKFwiLi4vLi4vY29yZS9jaGFubmVsL2NvbXBvc2l0ZS1jaGFubmVsXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF9cbikge1xuXG4gIHZhciBKU09OU2VyZGUgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChKU09OU2VyZGUucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7fSxcblxuXG4gICAgc2VyaWFsaXplOiBmdW5jdGlvbihwYXlsb2FkLCBvcHRzKSB7XG4gICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkocGF5bG9hZCk7XG4gICAgfSxcblxuXG4gICAgZGVzZXJpYWxpemU6IGZ1bmN0aW9uKHBheWxvYWQsIG9wdHMpIHtcbiAgICAgIHJldHVybiBKU09OLnBhcnNlKHBheWxvYWQpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIEpTT05TZXJkZTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBSZWYsXG4gIERlbGVnYXRpbmdSZWZcbikge1xuXG4gIHZhciBoZWxwZXIgPSBmdW5jdGlvbih2YWwpIHtcbiAgICByZXR1cm4gbmV3IFJlZih2YWwpO1xuICB9O1xuXG4gIGhlbHBlci5kZWxlZ2F0aW5nID0gZnVuY3Rpb24ocmVmKSB7XG4gICAgcmV0dXJuIG5ldyBEZWxlZ2F0aW5nUmVmKHJlZik7XG4gIH07XG5cbiAgcmV0dXJuIGhlbHBlcjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcIi4vcmVmXCIpLFxuICByZXF1aXJlKFwiLi9kZWxlZ2F0aW5nLXJlZlwiKVxuKTtcblxufSkoKSIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG52YXIgUHJvbWlzZSA9IHJlcXVpcmUoXCIuL3Byb21pc2UuanNcIikoKTtcbm1vZHVsZS5leHBvcnRzID0gUHJvbWlzZTsiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgT3B0aW9uc1xuKSB7XG5cbiAgdmFyIENvbnNvbGVMb2dBcHBlbmRlciA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIHZhciBwID0gZnVuY3Rpb24obnVtKSB7XG4gICAgaWYgKChcIlwiICsgbnVtKS5sZW5ndGggPT09IDEpIHtcbiAgICAgIHJldHVybiBcIjBcIiArIG51bTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG51bTtcbiAgICB9XG4gIH07XG5cbiAgXy5leHRlbmQoQ29uc29sZUxvZ0FwcGVuZGVyLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB0aGlzLl9jb25zb2xlID0gb3B0cy5nZXRPckVsc2UoXCJjb25zb2xlXCIsIGNvbnNvbGUpO1xuICAgICAgdGhpcy5fdGltZURlbGVnYXRlID0gb3B0cy5nZXRPckVsc2UoXCJ0aW1lRGVsZWdhdGVcIiwgZnVuY3Rpb24oKXtcbiAgICAgICAgdmFyIGQgPSBuZXcgRGF0ZSgpO1xuICAgICAgICByZXR1cm4gW2QuZ2V0VVRDRnVsbFllYXIoKSwgcChkLmdldFVUQ01vbnRoKCkpLCBwKGQuZ2V0VVRDRGF5KCkpXS5qb2luKFwiL1wiKSArXG4gICAgICAgICAgXCIgXCIgKyBbcChkLmdldFVUQ0hvdXJzKCkpLCBwKGQuZ2V0VVRDTWludXRlcygpKSwgcChkLmdldFVUQ1NlY29uZHMoKSldLmpvaW4oXCI6XCIpICtcbiAgICAgICAgICBcIi5cIiArIGQuZ2V0VVRDTWlsbGlzZWNvbmRzKCk7XG4gICAgICB9KTtcbiAgICB9LFxuXG4gICAgbG9nOiBmdW5jdGlvbihsb2dnZXJOYW1lLCBkZXNjZW5kYW50cywgbG9nTGV2ZWwsIGxvZ0xldmVsTmFtZSwgYXJncykge1xuICAgICAgLy8gVXNlIHRoZSBmdXJ0aGVzdCBhbmNlc3RvciBhcyB0aGUgbG9nZ2VkIG5hbWUgKHNpbmNlIGl0IG9yaWdpbmF0ZWQgdGhlcmUpXG4gICAgICB2YXIgZnVydGhlc3RBbmNlc3RvciA9IGRlc2NlbmRhbnRzW2Rlc2NlbmRhbnRzLmxlbmd0aCAtIDFdO1xuICAgICAgaWYgKGZ1cnRoZXN0QW5jZXN0b3IpIHtcbiAgICAgICAgbG9nZ2VyTmFtZSA9IGZ1cnRoZXN0QW5jZXN0b3I7XG4gICAgICB9XG4gICAgICB0aGlzLl9sb2coW1wiW1wiK2xvZ0xldmVsTmFtZStcIl1bXCIrdGhpcy5fZ2V0VGltZSgpK1wiXVtcIitsb2dnZXJOYW1lK1wiXVwiXS5jb25jYXQoYXJncykpO1xuICAgIH0sXG5cbiAgICBfZ2V0VGltZTogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fdGltZURlbGVnYXRlKCk7XG4gICAgfSxcblxuICAgIF9sb2c6IGZ1bmN0aW9uKGxvZ0l0ZW1zKSB7XG4gICAgICAvLyBXaHkgZG9lcyBoZSBkbyB0aGlzPyBJcyBoZSBpbnNhbmU/IFdlbGwsIHllcy5cbiAgICAgIC8vXG4gICAgICAvLyBCdXQgbW9zdGx5LCBJIGRvIHRoaXMgYmVjYXVzZSBjb25zb2xlLmxvZyBpc24ndCwgaW4gYWxsIGNhc2VzLFxuICAgICAgLy8gc29tZXRoaW5nIHlvdSBjYW4gY2FsbCAuYXBwbHkgb24uIExhc3QgSSBjaGVja2VkLCBpbiBJRSBjYWxsaW5nXG4gICAgICAvLyBjb25zb2xlLmxvZy5hcHBseShjb25zb2xlLCBbXSkgd2lsbCB0aHJvdyBhbiBlcnJvci4gU28gdGhhdCdzIHdoeSB0aGVcbiAgICAgIC8vIGJpZyB1Z2x5IHN3aXRjaC5cbiAgICAgIC8vXG4gICAgICAvLyBJZiB5b3UgbmVlZCBtb3JlIHRoYW4gNyBpdGVtcywgd2VsbCwgSSBjYW4ndCBoZWxwIHlvdSAoYnV0IHlvdSBjYW4gLSBhZGQgYW5vdGhlclxuICAgICAgLy8gc3dpdGNoIGNhc2UpLlxuICAgICAgc3dpdGNoKGxvZ0l0ZW1zLmxlbmd0aCkge1xuICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgdGhpcy5fY29uc29sZS5sb2coKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgIHRoaXMuX2NvbnNvbGUubG9nKGxvZ0l0ZW1zWzBdKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAyOlxuICAgICAgICAgIHRoaXMuX2NvbnNvbGUubG9nKGxvZ0l0ZW1zWzBdLCBsb2dJdGVtc1sxXSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMzpcbiAgICAgICAgICB0aGlzLl9jb25zb2xlLmxvZyhsb2dJdGVtc1swXSwgbG9nSXRlbXNbMV0sIGxvZ0l0ZW1zWzJdKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSA0OlxuICAgICAgICAgIHRoaXMuX2NvbnNvbGUubG9nKGxvZ0l0ZW1zWzBdLCBsb2dJdGVtc1sxXSwgbG9nSXRlbXNbMl0sIGxvZ0l0ZW1zWzNdKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSA1OlxuICAgICAgICAgIHRoaXMuX2NvbnNvbGUubG9nKGxvZ0l0ZW1zWzBdLCBsb2dJdGVtc1sxXSwgbG9nSXRlbXNbMl0sIGxvZ0l0ZW1zWzNdLCBsb2dJdGVtc1s0XSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgNjpcbiAgICAgICAgICB0aGlzLl9jb25zb2xlLmxvZyhsb2dJdGVtc1swXSwgbG9nSXRlbXNbMV0sIGxvZ0l0ZW1zWzJdLCBsb2dJdGVtc1szXSwgbG9nSXRlbXNbNF0sIGxvZ0l0ZW1zWzVdKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSA3OlxuICAgICAgICAgIHRoaXMuX2NvbnNvbGUubG9nKGxvZ0l0ZW1zWzBdLCBsb2dJdGVtc1sxXSwgbG9nSXRlbXNbMl0sIGxvZ0l0ZW1zWzNdLCBsb2dJdGVtc1s0XSwgbG9nSXRlbXNbNV0sIGxvZ0l0ZW1zWzZdKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICB2YXIgbGFiZWwgPSBsb2dJdGVtcy5zaGlmdCgpO1xuICAgICAgICAgIHRoaXMuX2NvbnNvbGUubG9nKGxhYmVsLCBsb2dJdGVtcyk7XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gQ29uc29sZUxvZ0FwcGVuZGVyO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiLi4vLi4vb3B0aW9uc1wiKVxuKTtcblxufSkoKSIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFByb21pc2UsXG4gIE9wdGlvbnMsXG4gIExvZ2dlcixcbiAgQ29uZmlndXJhdGlvbk1hZ2ljLFxuICBBcHBDb250YWluZXJcbikge1xuICB2YXIgTG9nID0gTG9nZ2VyLmNyZWF0ZShcIkJvb3RzdHJhcHBlclwiKTtcblxuICB2YXIgQm9vdHN0cmFwcGVyID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoQm9vdHN0cmFwcGVyLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB0aGlzLl9jb25maWdzID0gb3B0cy5nZXRPckVycm9yKFwiY29uZmlndXJhdGlvbnNcIik7XG4gICAgICB0aGlzLl9zY29wZXMgPSBvcHRzLmdldE9yRXJyb3IoXCJzY29wZXNcIik7XG4gICAgICB0aGlzLl9hcHBLbGFzcyA9IG9wdHMuZ2V0T3JFcnJvcihcImFwcGxpY2F0aW9uQ29uc3RydWN0b3JcIik7XG4gICAgfSxcbiAgICBib290c3RyYXA6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIFByb21pc2VcbiAgICAgICAgLmJpbmQodGhpcylcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyIGNvbmZpZyAgICAgICA9IENvbmZpZ3VyYXRpb25NYWdpYy5yZXNvbHZlQ29uZmlnKHRoaXMuX3Njb3BlcywgdGhpcy5fY29uZmlncyksXG4gICAgICAgICAgICAgIEFwcEtsYXNzICAgICA9IHRoaXMuX2FwcEtsYXNzO1xuXG4gICAgICAgICAgTG9nLmluZm8oXCJVc2luZyByZXNvbHZlZCBjb25maWd1cmF0aW9uOiBcIiwgSlNPTi5zdHJpbmdpZnkoY29uZmlnKSk7XG5cbiAgICAgICAgICB2YXIgYXBwICAgICAgICAgID0gbmV3IEFwcEtsYXNzKHtjb25maWd1cmF0aW9uOiBjb25maWd9KSxcbiAgICAgICAgICAgICAgYXBwQ29udGFpbmVyID0gbmV3IEFwcENvbnRhaW5lcih7YXBwOiBhcHB9KTtcblxuICAgICAgICAgIHJldHVybiBhcHBDb250YWluZXI7XG4gICAgICAgIH0pO1xuICAgIH0pXG4gIH0pO1xuXG4gIHJldHVybiBCb290c3RyYXBwZXI7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJibHVlYmlyZFwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvbG9nZ2luZy9sb2dnZXJcIiksXG4gIHJlcXVpcmUoXCIuL2NvbmZpZ3VyYXRpb24tbWFnaWNcIiksXG4gIHJlcXVpcmUoXCIuL3dlYi1hcHAtY29udGFpbmVyXCIpXG4pO1xuIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UsIHByb2Nlc3M6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBQcm9taXNlLFxuICBPcHRpb25zLFxuICBMb2dnZXJcbikge1xuXG4gIHZhciBMb2cgPSBMb2dnZXIuY3JlYXRlKFwiQXBwQ29udGFpbmVyXCIpO1xuXG4gIHZhciBXZWJBcHBDb250YWluZXIgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChXZWJBcHBDb250YWluZXIucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKVxuICAgICAgdGhpcy5fYXBwID0gb3B0cy5nZXRPckVycm9yKFwiYXBwXCIpO1xuICAgIH0sXG5cbiAgICBzdGFydDogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZVxuICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fYXBwLnN0YXJ0KCk7XG4gICAgICAgIH0pO1xuICAgIH0pLFxuXG4gICAgc3RvcDogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24ocmVhc29uKSB7XG4gICAgICByZXR1cm4gdGhpcy5fYXBwLnN0b3AoKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAocmVhc29uKSB7XG4gICAgICAgICAgTG9nLmVycm9yKFwiU3RvcHBpbmcgZHVlIHRvIHJlYXNvbjpcIiwgcmVhc29uKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSlcbiAgfSk7XG5cbiAgcmV0dXJuIFdlYkFwcENvbnRhaW5lcjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcImJsdWViaXJkXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9vcHRpb25zXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9sb2dnaW5nL2xvZ2dlclwiKVxuKTtcblxufSkoKSIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF9cbikge1xuXG4gIHZhciBXZWJTY2hlZHVsZXIgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChXZWJTY2hlZHVsZXIucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7fSxcblxuICAgIHJ1blNvb246IGZ1bmN0aW9uKGZuKSB7XG4gICAgICB0aGlzLnNjaGVkdWxlKGZuKTtcbiAgICB9LFxuXG4gICAgc2NoZWR1bGU6IGZ1bmN0aW9uKGZuLCBkZWxheSkge1xuICAgICAgZGVsYXkgPSBkZWxheSB8fCAxO1xuICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZm4sIGRlbGF5KTtcbiAgICB9LFxuXG4gICAgdW5zY2hlZHVsZTogZnVuY3Rpb24oaWQpIHtcbiAgICAgIHJldHVybiBjbGVhclRpbWVvdXQoaWQpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIFdlYlNjaGVkdWxlcjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKVxuKTtcbiIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBPcHRpb25zLFxuICBSZWYsXG4gIFNldFRpbWVvdXRTY2hlZHVsZXJcbikge1xuXG4gIHZhciBEZWZhdWx0UnVudGltZSA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKERlZmF1bHRSdW50aW1lLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG5cbiAgICAgIHRoaXMuX3NjaGVkdWxlclJlZiA9IFJlZihvcHRzLmdldE9yRWxzZUZuKFwic2NoZWR1bGVyXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gbmV3IFNldFRpbWVvdXRTY2hlZHVsZXIoKTtcbiAgICAgIH0pKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogQHJldHVybnMge1JlZjxTY2hlZHVsZXI+fVxuICAgICAqL1xuICAgIHNjaGVkdWxlcjogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gUmVmLmRlbGVnYXRpbmcodGhpcy5fc2NoZWR1bGVyUmVmKTtcbiAgICB9LFxuXG4gICAgc2V0U2NoZWR1bGVyOiBmdW5jdGlvbihzY2hlZHVsZXIpIHtcbiAgICAgIHRoaXMuX3NjaGVkdWxlclJlZi5zZXQoc2NoZWR1bGVyKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBEZWZhdWx0UnVudGltZTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvcmVmXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9zY2hlZHVsZXIvc2V0LXRpbWVvdXQtc2NoZWR1bGVyXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIE9wdGlvbnNcbikge1xuXG4gIHZhciBTdG9yZUVudHJ5ID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoU3RvcmVFbnRyeS5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgLy8gUGVyZmVjdGx5IGFjY2VwdGFibGUgdG8gcGFzcyBpbiB1bmRlZmluZWQuLi5cbiAgICAgIHRoaXMuX3ZhbHVlID0gb3B0cy5nZXRPckVsc2UoXCJ2YWx1ZVwiLCB1bmRlZmluZWQpO1xuICAgICAgdGhpcy5fbGFzdFNlcXVlbmNlID0gb3B0cy5nZXRPckVycm9yKFwiaW5pdGlhbFNlcXVlbmNlXCIpO1xuXG4gICAgICB0aGlzLl90dGwgPSBvcHRzLmdldE9yRWxzZShcInR0bFwiKTtcbiAgICB9LFxuXG4gICAgaXNFeHBpcmVkOiBmdW5jdGlvbihzZXF1ZW5jZSwgZmFsbGJhY2tUdGwpIHtcbiAgICAgIHZhciB0dGwgPSB0aGlzLl90dGwgfHwgZmFsbGJhY2tUdGw7XG4gICAgICBpZiAoIXR0bCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyBUVEwgc3BlY2lmaWVkIVwiKTtcbiAgICAgIH1cbiAgICAgIC8vIEUuZy4sIGxhc3RTZXF1ZW5jZSA9IDQsIHR0bCA9IDEsIHNlcXVlbmNlID0gNTogZXhwaXJlZFxuICAgICAgLy8gICAgICAgbGFzdFNlcXVlbmNlID0gNCwgdHRsID0gMSwgc2VxdWVuY2UgPSA0OiBub3QgZXhwaXJlZFxuICAgICAgLy8gICAgICAgbGFzdFNlcXVlbmNlID0gNCwgdHRsID0gMiwgc2VxdWVuY2UgPSA1OiBub3QgZXhwaXJlZFxuICAgICAgcmV0dXJuICEodGhpcy5fbGFzdFNlcXVlbmNlICsgdHRsID4gc2VxdWVuY2UpO1xuICAgIH0sXG5cbiAgICB0b3VjaDogZnVuY3Rpb24oc2VxdWVuY2UpIHtcbiAgICAgIHRoaXMuX2xhc3RTZXF1ZW5jZSA9IHNlcXVlbmNlO1xuICAgIH0sXG5cbiAgICB1cGRhdGU6IGZ1bmN0aW9uKHZhbCwgc2VxdWVuY2UsIG9wdHMpIHtcbiAgICAgIHRoaXMuX3ZhbHVlICAgICAgICA9IHZhbDtcbiAgICAgIHRoaXMuX2xhc3RTZXF1ZW5jZSA9IHNlcXVlbmNlO1xuXG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdGhpcy5fdHRsID0gb3B0cy5nZXRPckVsc2UoXCJ0dGxcIik7XG4gICAgfSxcblxuICAgIGRpc3Bvc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fdmFsdWUgICAgICAgID0gbnVsbDtcbiAgICAgIHRoaXMuX2xhc3RTZXF1ZW5jZSA9IG51bGw7XG4gICAgfSxcblxuICAgIHZhbHVlOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl92YWx1ZTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBTdG9yZUVudHJ5O1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiLi4vLi4vY29yZS9vcHRpb25zXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIExvZ2dlcixcbiAgT3B0aW9uc1xuKSB7XG5cbiAgdmFyIFRFTl9NSU5VVEVTX0lOX01JTExJU0VDT05EUyA9IDYwICogMTAwMCAqIDEwO1xuXG4gIHZhciBMb2cgPSBMb2dnZXIuY3JlYXRlKFwiUHJvY2Vzc0tlZXBBbGl2ZVwiKTtcblxuICB2YXIgUHJvY2Vzc0tlZXBBbGl2ZSA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKFByb2Nlc3NLZWVwQWxpdmUucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIHRoaXMuX3NjaGVkdWxlciA9IG9wdHMuZ2V0T3JFcnJvcihcInNjaGVkdWxlclwiKTtcbiAgICAgIHRoaXMuX3RpbWVvdXRJZCA9IG51bGw7XG5cbiAgICAgIF8uYmluZEFsbCh0aGlzLCBcIl9jeWNsZVwiKTtcbiAgICB9LFxuICAgIHN0YXJ0OiBmdW5jdGlvbigpIHtcbiAgICAgIExvZy5kZWJ1ZyhcIlN0YXJ0aW5nIFByb2Nlc3NLZWVwQWxpdmVcIik7XG4gICAgICB0aGlzLl9jeWNsZSgpO1xuICAgIH0sXG4gICAgc3RvcDogZnVuY3Rpb24oKSB7XG4gICAgICBMb2cuZGVidWcoXCJTdG9wcGluZyBQcm9jZXNzS2VlcEFsaXZlXCIpO1xuICAgICAgaWYgKHRoaXMuX3RpbWVvdXRJZCkge1xuICAgICAgICB0aGlzLl9zY2hlZHVsZXIuZ2V0KCkudW5zY2hlZHVsZSh0aGlzLl90aW1lb3V0SWQpO1xuICAgICAgICB0aGlzLl90aW1lb3V0SWQgPSBudWxsO1xuICAgICAgfVxuICAgIH0sXG4gICAgX2N5Y2xlOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX3RpbWVvdXRJZCA9IHRoaXMuX3NjaGVkdWxlci5nZXQoKS5zY2hlZHVsZShcbiAgICAgICAgdGhpcy5fY3ljbGUsXG4gICAgICAgIFRFTl9NSU5VVEVTX0lOX01JTExJU0VDT05EU1xuICAgICAgKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBQcm9jZXNzS2VlcEFsaXZlO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiLi4vLi4vY29yZS9sb2dnaW5nL2xvZ2dlclwiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvb3B0aW9uc1wiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBQcm9taXNlLFxuICBNLFxuICBPcHRpb25zLFxuICBVVUlELFxuICBDaGFpbmVkQ2hhbm5lbCxcbiAgQ2hhbm5lbCxcbiAgQ29tcG9zaXRlQ2hhbm5lbCxcbiAgU3RhdGVHdWFyZFxuKSB7XG5cblxuICB2YXIgTWFpbGJveCA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKE1haWxib3gucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIHRoaXMuX2lkICAgICAgICAgICAgICAgICAgICA9IFVVSUQudjQoKTtcbiAgICAgIHRoaXMuX293bmVySWRlbnRpdHkgICAgICAgICA9IG9wdHMuZ2V0T3JFcnJvcihcIm93bmVySWRlbnRpdHlcIik7XG4gICAgICB0aGlzLl9leGNoYW5nZSAgICAgICAgICAgICAgPSBvcHRzLmdldE9yRXJyb3IoXCJleGNoYW5nZVwiKTtcbiAgICAgIHRoaXMuX29uZVNob3RDaGFubmVsICAgICAgICA9IG5ldyBDaGFubmVsKHsgc2VudGluZWw6IHRoaXMgfSk7XG4gICAgICB0aGlzLl9yZXF1ZXN0UmVwbHlDaGFubmVsICAgPSBuZXcgQ2hhbm5lbCh7IHNlbnRpbmVsOiB0aGlzIH0pO1xuICAgICAgdGhpcy5faW5ncmVzc0NoYW5uZWwgICAgICAgID0gbmV3IENvbXBvc2l0ZUNoYW5uZWwoe1xuICAgICAgICBzZW50aW5lbDogdGhpcyxcbiAgICAgICAgbGlzdGVuOiBbdGhpcy5fb25lU2hvdENoYW5uZWwsIHRoaXMuX3JlcXVlc3RSZXBseUNoYW5uZWxdXG4gICAgICB9KTtcbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQgICAgICAgICAgICA9IG5ldyBTdGF0ZUd1YXJkKFtcImRpc3Bvc2VkXCJdKTtcblxuICAgICAgdGhpcy5fb3V0c3RhbmRpbmdSZXF1ZXN0SWRzID0gTS5zZXQoKTtcbiAgICB9LFxuXG4gICAgaWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2lkO1xuICAgIH0sXG5cbiAgICBvd25lcklkZW50aXR5OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9vd25lcklkZW50aXR5O1xuICAgIH0sXG5cbiAgICBkaXNwb3NlOiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICh0aGlzLl9zdGF0ZUd1YXJkLmFwcGxpZWQoXCJkaXNwb3NlZFwiKSl7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdGhpcy5fb25lU2hvdENoYW5uZWwuZGlzcG9zZSgpO1xuICAgICAgdGhpcy5fcmVxdWVzdFJlcGx5Q2hhbm5lbC5kaXNwb3NlKCk7XG4gICAgICB0aGlzLl9pbmdyZXNzQ2hhbm5lbC5kaXNwb3NlKCk7XG5cbiAgICAgIC8vIEF0dGVtcHQgdG8gY2FuY2VsIGFsbCBvdXRzdGFuZGluZyByZXF1ZXN0cy5cbiAgICAgIC8vIFRoaXMgaXMgYW4gYXN5bmMgcmVxdWVzdCwgc28gd2UganVzdCBoYXZlIHRvIGZpcmUgYW5kXG4gICAgICAvLyBmb3JnZSB0aGVtLlxuICAgICAgLy9cbiAgICAgIC8vIElmIHlvdSdyZSBkaXNwb3Npbmcgb2YgYSBtYWlsYm94IGJlZm9yZSByZXF1ZXN0c1xuICAgICAgLy8gY29tcGxldGUsIHlvdSBtaWdodCBoYXZlIGEgYmFkIHRpbWUuIFRoZSBnb29kXG4gICAgICAvLyBuZXdzIGlzIGJlY2F1c2UgcmVzcG9uc2VzIGFyZSBmZXJyaWVkIGJhY2sgZnJvbSB0aGUgZmliZXJcbiAgICAgIC8vIHRvIHRoZSBtYWlsYm94IGNhbGxlciB2aWEgdGhlIFByb21pc2UgaW50ZXJmYWNlIHJhdGhlclxuICAgICAgLy8gdGhhbiBjaGFubmVscywgdGhleSBzaG91bGQgc3RpbGwgZ2V0IENhbmNlbGxhdGlvbkVycm9yc1xuICAgICAgdmFyIHJlcXMgPSB0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RJZHM7XG4gICAgICB0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RJZHMgPSBNLnNldCgpO1xuXG4gICAgICBNLmVhY2gocmVxcywgXy5iaW5kKGZ1bmN0aW9uKHJlcUlkKSB7XG4gICAgICAgIHRoaXMuX2V4Y2hhbmdlLmNhbmNlbFNlbmRBbmRSZWNlaXZlKHJlcUlkKTtcbiAgICAgIH0sIHRoaXMpKTtcblxuICAgICAgdGhpcy5fb25lU2hvdENoYW5uZWwgICAgICA9IG51bGw7XG4gICAgICB0aGlzLl9yZXF1ZXN0UmVwbHlDaGFubmVsID0gbnVsbDtcbiAgICAgIHRoaXMuX2luZ3Jlc3NDaGFubmVsICAgICAgPSBudWxsO1xuXG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkLmFwcGx5KFwiZGlzcG9zZWRcIik7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBuZXcgQ2hhaW5lZENoYW5uZWwgY2hhaW5lZCB0byB0aGlzIE1haWxib3gnc1xuICAgICAqIHByaXZhdGVseS1vd25lZCBpbmJvdW5kIENoYW5uZWwuXG4gICAgICogQHJldHVybnMge0NoYWluZWRDaGFubmVsfVxuICAgICAqL1xuICAgIGluZ3Jlc3NDaGFubmVsOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9pbmdyZXNzQ2hhbm5lbDtcbiAgICB9LFxuXG4gICAgb25lU2hvdENoYW5uZWw6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX29uZVNob3RDaGFubmVsO1xuICAgIH0sXG5cbiAgICByZXF1ZXN0UmVwbHlDaGFubmVsOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0UmVwbHlDaGFubmVsO1xuICAgIH0sXG5cbiAgICBzZW5kOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbihlbnYpIHtcbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQuZGVueShcImRpc3Bvc2VkXCIpO1xuXG4gICAgICBlbnYgPSBfLmV4dGVuZCh7fSwgZW52IHx8IHt9LCB7XG4gICAgICAgIGZyb206IHRoaXMuX293bmVySWRlbnRpdHlcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHRoaXMuX2V4Y2hhbmdlLnNlbmQoZW52KTtcbiAgICB9KSxcblxuICAgIHJlcGx5OiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbihtc2dJZCwgZW52KSB7XG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkLmRlbnkoXCJkaXNwb3NlZFwiKTtcblxuICAgICAgZW52ID0gXy5leHRlbmQoe30sIGVudiB8fCB7fSwge1xuICAgICAgICByTXNnSWQ6IG1zZ0lkLFxuICAgICAgICBmcm9tOiB0aGlzLl9vd25lcklkZW50aXR5XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIHRoaXMuX2V4Y2hhbmdlLnJlcGx5KGVudik7XG4gICAgfSksXG5cbiAgICBzZW5kQW5kUmVjZWl2ZTogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oZW52LCBvcHRzKSB7XG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkLmRlbnkoXCJkaXNwb3NlZFwiKTtcblxuICAgICAgdmFyIHJlcUlkID0gKG9wdHMgfHwge30pLnJlcUlkIHx8IFVVSUQudjQoKTtcblxuICAgICAgZW52ID0gXy5leHRlbmQoe30sIGVudiB8fCB7fSwge1xuICAgICAgICBmcm9tOiB0aGlzLl9vd25lcklkZW50aXR5XG4gICAgICB9KTtcblxuICAgICAgb3B0cyA9IF8uZXh0ZW5kKHt9LCBvcHRzIHx8IHt9LCB7XG4gICAgICAgIHJlcUlkOiByZXFJZFxuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuX291dHN0YW5kaW5nUmVxdWVzdElkcyA9IE0uY29uaih0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RJZHMsIHJlcUlkKTtcblxuICAgICAgcmV0dXJuIHRoaXMuX2V4Y2hhbmdlXG4gICAgICAgIC5zZW5kQW5kUmVjZWl2ZShlbnYsIG9wdHMpXG4gICAgICAgIC5iaW5kKHRoaXMpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3ApIHtcbiAgICAgICAgICB0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RJZHMgPSBNLmRpc2oodGhpcy5fb3V0c3RhbmRpbmdSZXF1ZXN0SWRzLCByZXFJZCk7XG4gICAgICAgICAgcmV0dXJuIHJlc3A7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXVnaHQoUHJvbWlzZS5DYW5jZWxsYXRpb25FcnJvciwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgdGhpcy5fb3V0c3RhbmRpbmdSZXF1ZXN0SWRzID0gTS5kaXNqKHRoaXMuX291dHN0YW5kaW5nUmVxdWVzdElkcywgcmVxSWQpO1xuICAgICAgICAgIHRocm93IGVycjtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdWdodChQcm9taXNlLlRpbWVvdXRFcnJvciwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgdGhpcy5fb3V0c3RhbmRpbmdSZXF1ZXN0SWRzID0gTS5kaXNqKHRoaXMuX291dHN0YW5kaW5nUmVxdWVzdElkcywgcmVxSWQpO1xuICAgICAgICAgIHRocm93IGVycjtcbiAgICAgICAgfSk7XG4gICAgfSksXG5cblxuICAgIG91dHN0YW5kaW5nUmVxdWVzdENvdW50OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBNLmNvdW50KHRoaXMuX291dHN0YW5kaW5nUmVxdWVzdElkcyk7XG4gICAgfSxcblxuXG4gICAgY2FuY2VsU2VuZEFuZFJlY2VpdmU6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKHJlcUlkKSB7XG4gICAgICByZXR1cm4gdGhpcy5fZXhjaGFuZ2VcbiAgICAgICAgLmNhbmNlbFNlbmRBbmRSZWNlaXZlKHJlcUlkKVxuICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICB0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RJZHMgPSBNLmRpc2oodGhpcy5fb3V0c3RhbmRpbmdSZXF1ZXN0SWRzLCByZXFJZCk7XG4gICAgICAgIH0pO1xuICAgIH0pLFxuXG4gICAgX3JlY2VpdmVPbmVTaG90OiBmdW5jdGlvbihtc2cpIHtcbiAgICAgIHRoaXMuX29uZVNob3RDaGFubmVsLnB1Ymxpc2godGhpcywgbXNnKTtcbiAgICB9LFxuXG4gICAgX3JlY2VpdmVSZXF1ZXN0UmVwbHk6IGZ1bmN0aW9uKG1zZykge1xuICAgICAgdGhpcy5fcmVxdWVzdFJlcGx5Q2hhbm5lbC5wdWJsaXNoKHRoaXMsIG1zZyk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gTWFpbGJveDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcImJsdWViaXJkXCIpLFxuICByZXF1aXJlKFwibW9yaVwiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvdXVpZFwiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvY2hhbm5lbC9jaGFpbmVkLWNoYW5uZWxcIiksXG4gIHJlcXVpcmUoXCIuLi8uLi9jb3JlL2NoYW5uZWwvY2hhbm5lbFwiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvY2hhbm5lbC9jb21wb3NpdGUtY2hhbm5lbFwiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvc3RhdGUtZ3VhcmRcIilcbik7XG5cbn0pKCkiLCIvLyBzaGltIGZvciB1c2luZyBwcm9jZXNzIGluIGJyb3dzZXJcblxudmFyIHByb2Nlc3MgPSBtb2R1bGUuZXhwb3J0cyA9IHt9O1xuXG5wcm9jZXNzLm5leHRUaWNrID0gKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgY2FuU2V0SW1tZWRpYXRlID0gdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCdcbiAgICAmJiB3aW5kb3cuc2V0SW1tZWRpYXRlO1xuICAgIHZhciBjYW5Qb3N0ID0gdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCdcbiAgICAmJiB3aW5kb3cucG9zdE1lc3NhZ2UgJiYgd2luZG93LmFkZEV2ZW50TGlzdGVuZXJcbiAgICA7XG5cbiAgICBpZiAoY2FuU2V0SW1tZWRpYXRlKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gd2luZG93LnNldEltbWVkaWF0ZShmKSB9O1xuICAgIH1cblxuICAgIGlmIChjYW5Qb3N0KSB7XG4gICAgICAgIHZhciBxdWV1ZSA9IFtdO1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZ1bmN0aW9uIChldikge1xuICAgICAgICAgICAgdmFyIHNvdXJjZSA9IGV2LnNvdXJjZTtcbiAgICAgICAgICAgIGlmICgoc291cmNlID09PSB3aW5kb3cgfHwgc291cmNlID09PSBudWxsKSAmJiBldi5kYXRhID09PSAncHJvY2Vzcy10aWNrJykge1xuICAgICAgICAgICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIGlmIChxdWV1ZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmbiA9IHF1ZXVlLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgIGZuKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LCB0cnVlKTtcblxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gbmV4dFRpY2soZm4pIHtcbiAgICAgICAgICAgIHF1ZXVlLnB1c2goZm4pO1xuICAgICAgICAgICAgd2luZG93LnBvc3RNZXNzYWdlKCdwcm9jZXNzLXRpY2snLCAnKicpO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiBmdW5jdGlvbiBuZXh0VGljayhmbikge1xuICAgICAgICBzZXRUaW1lb3V0KGZuLCAwKTtcbiAgICB9O1xufSkoKTtcblxucHJvY2Vzcy50aXRsZSA9ICdicm93c2VyJztcbnByb2Nlc3MuYnJvd3NlciA9IHRydWU7XG5wcm9jZXNzLmVudiA9IHt9O1xucHJvY2Vzcy5hcmd2ID0gW107XG5cbnByb2Nlc3MuYmluZGluZyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmJpbmRpbmcgaXMgbm90IHN1cHBvcnRlZCcpO1xufVxuXG4vLyBUT0RPKHNodHlsbWFuKVxucHJvY2Vzcy5jd2QgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAnLycgfTtcbnByb2Nlc3MuY2hkaXIgPSBmdW5jdGlvbiAoZGlyKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmNoZGlyIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG4iLCIoZnVuY3Rpb24ocHJvY2Vzcyl7LyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbnZhciBvbGQ7XG5pZiAodHlwZW9mIFByb21pc2UgIT09IFwidW5kZWZpbmVkXCIpIG9sZCA9IFByb21pc2U7XG5mdW5jdGlvbiBub0NvbmZsaWN0KGJsdWViaXJkKSB7XG4gICAgdHJ5IHsgaWYgKFByb21pc2UgPT09IGJsdWViaXJkKSBQcm9taXNlID0gb2xkOyB9XG4gICAgY2F0Y2ggKGUpIHt9XG4gICAgcmV0dXJuIGJsdWViaXJkO1xufVxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpIHtcbnZhciB1dGlsID0gcmVxdWlyZShcIi4vdXRpbC5qc1wiKTtcbnZhciBhc3luYyA9IHJlcXVpcmUoXCIuL2FzeW5jLmpzXCIpO1xudmFyIGVycm9ycyA9IHJlcXVpcmUoXCIuL2Vycm9ycy5qc1wiKTtcblxudmFyIElOVEVSTkFMID0gZnVuY3Rpb24oKXt9O1xudmFyIEFQUExZID0ge307XG52YXIgTkVYVF9GSUxURVIgPSB7ZTogbnVsbH07XG5cbnZhciBjYXN0ID0gcmVxdWlyZShcIi4vdGhlbmFibGVzLmpzXCIpKFByb21pc2UsIElOVEVSTkFMKTtcbnZhciBQcm9taXNlQXJyYXkgPSByZXF1aXJlKFwiLi9wcm9taXNlX2FycmF5LmpzXCIpKFByb21pc2UsIElOVEVSTkFMLCBjYXN0KTtcbnZhciBDYXB0dXJlZFRyYWNlID0gcmVxdWlyZShcIi4vY2FwdHVyZWRfdHJhY2UuanNcIikoKTtcbnZhciBDYXRjaEZpbHRlciA9IHJlcXVpcmUoXCIuL2NhdGNoX2ZpbHRlci5qc1wiKShORVhUX0ZJTFRFUik7XG52YXIgUHJvbWlzZVJlc29sdmVyID0gcmVxdWlyZShcIi4vcHJvbWlzZV9yZXNvbHZlci5qc1wiKTtcblxudmFyIGlzQXJyYXkgPSB1dGlsLmlzQXJyYXk7XG5cbnZhciBlcnJvck9iaiA9IHV0aWwuZXJyb3JPYmo7XG52YXIgdHJ5Q2F0Y2gxID0gdXRpbC50cnlDYXRjaDE7XG52YXIgdHJ5Q2F0Y2gyID0gdXRpbC50cnlDYXRjaDI7XG52YXIgdHJ5Q2F0Y2hBcHBseSA9IHV0aWwudHJ5Q2F0Y2hBcHBseTtcbnZhciBSYW5nZUVycm9yID0gZXJyb3JzLlJhbmdlRXJyb3I7XG52YXIgVHlwZUVycm9yID0gZXJyb3JzLlR5cGVFcnJvcjtcbnZhciBDYW5jZWxsYXRpb25FcnJvciA9IGVycm9ycy5DYW5jZWxsYXRpb25FcnJvcjtcbnZhciBUaW1lb3V0RXJyb3IgPSBlcnJvcnMuVGltZW91dEVycm9yO1xudmFyIE9wZXJhdGlvbmFsRXJyb3IgPSBlcnJvcnMuT3BlcmF0aW9uYWxFcnJvcjtcbnZhciBvcmlnaW5hdGVzRnJvbVJlamVjdGlvbiA9IGVycm9ycy5vcmlnaW5hdGVzRnJvbVJlamVjdGlvbjtcbnZhciBtYXJrQXNPcmlnaW5hdGluZ0Zyb21SZWplY3Rpb24gPSBlcnJvcnMubWFya0FzT3JpZ2luYXRpbmdGcm9tUmVqZWN0aW9uO1xudmFyIGNhbkF0dGFjaCA9IGVycm9ycy5jYW5BdHRhY2g7XG52YXIgdGhyb3dlciA9IHV0aWwudGhyb3dlcjtcbnZhciBhcGlSZWplY3Rpb24gPSByZXF1aXJlKFwiLi9lcnJvcnNfYXBpX3JlamVjdGlvblwiKShQcm9taXNlKTtcblxuXG52YXIgbWFrZVNlbGZSZXNvbHV0aW9uRXJyb3IgPSBmdW5jdGlvbiBQcm9taXNlJF9tYWtlU2VsZlJlc29sdXRpb25FcnJvcigpIHtcbiAgICByZXR1cm4gbmV3IFR5cGVFcnJvcihcImNpcmN1bGFyIHByb21pc2UgcmVzb2x1dGlvbiBjaGFpblwiKTtcbn07XG5cbmZ1bmN0aW9uIFByb21pc2UocmVzb2x2ZXIpIHtcbiAgICBpZiAodHlwZW9mIHJlc29sdmVyICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcInRoZSBwcm9taXNlIGNvbnN0cnVjdG9yIHJlcXVpcmVzIGEgcmVzb2x2ZXIgZnVuY3Rpb25cIik7XG4gICAgfVxuICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yICE9PSBQcm9taXNlKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJ0aGUgcHJvbWlzZSBjb25zdHJ1Y3RvciBjYW5ub3QgYmUgaW52b2tlZCBkaXJlY3RseVwiKTtcbiAgICB9XG4gICAgdGhpcy5fYml0RmllbGQgPSAwO1xuICAgIHRoaXMuX2Z1bGZpbGxtZW50SGFuZGxlcjAgPSB2b2lkIDA7XG4gICAgdGhpcy5fcmVqZWN0aW9uSGFuZGxlcjAgPSB2b2lkIDA7XG4gICAgdGhpcy5fcHJvbWlzZTAgPSB2b2lkIDA7XG4gICAgdGhpcy5fcmVjZWl2ZXIwID0gdm9pZCAwO1xuICAgIHRoaXMuX3NldHRsZWRWYWx1ZSA9IHZvaWQgMDtcbiAgICB0aGlzLl9ib3VuZFRvID0gdm9pZCAwO1xuICAgIGlmIChyZXNvbHZlciAhPT0gSU5URVJOQUwpIHRoaXMuX3Jlc29sdmVGcm9tUmVzb2x2ZXIocmVzb2x2ZXIpO1xufVxuXG5Qcm9taXNlLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gUHJvbWlzZSRiaW5kKHRoaXNBcmcpIHtcbiAgICB2YXIgcmV0ID0gbmV3IFByb21pc2UoSU5URVJOQUwpO1xuICAgIHJldC5fZm9sbG93KHRoaXMpO1xuICAgIHJldC5fcHJvcGFnYXRlRnJvbSh0aGlzLCAyIHwgMSk7XG4gICAgcmV0Ll9zZXRCb3VuZFRvKHRoaXNBcmcpO1xuICAgIHJldHVybiByZXQ7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uIFByb21pc2UkdG9TdHJpbmcoKSB7XG4gICAgcmV0dXJuIFwiW29iamVjdCBQcm9taXNlXVwiO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuY2F1Z2h0ID0gUHJvbWlzZS5wcm90b3R5cGVbXCJjYXRjaFwiXSA9XG5mdW5jdGlvbiBQcm9taXNlJGNhdGNoKGZuKSB7XG4gICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gICAgaWYgKGxlbiA+IDEpIHtcbiAgICAgICAgdmFyIGNhdGNoSW5zdGFuY2VzID0gbmV3IEFycmF5KGxlbiAtIDEpLFxuICAgICAgICAgICAgaiA9IDAsIGk7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW4gLSAxOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gYXJndW1lbnRzW2ldO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBpdGVtID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICBjYXRjaEluc3RhbmNlc1tqKytdID0gaXRlbTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIGNhdGNoRmlsdGVyVHlwZUVycm9yID1cbiAgICAgICAgICAgICAgICAgICAgbmV3IFR5cGVFcnJvcihcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiQSBjYXRjaCBmaWx0ZXIgbXVzdCBiZSBhbiBlcnJvciBjb25zdHJ1Y3RvciBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgKyBcIm9yIGEgZmlsdGVyIGZ1bmN0aW9uXCIpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5fYXR0YWNoRXh0cmFUcmFjZShjYXRjaEZpbHRlclR5cGVFcnJvcik7XG4gICAgICAgICAgICAgICAgYXN5bmMuaW52b2tlKHRoaXMuX3JlamVjdCwgdGhpcywgY2F0Y2hGaWx0ZXJUeXBlRXJyb3IpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaEluc3RhbmNlcy5sZW5ndGggPSBqO1xuICAgICAgICBmbiA9IGFyZ3VtZW50c1tpXTtcblxuICAgICAgICB0aGlzLl9yZXNldFRyYWNlKCk7XG4gICAgICAgIHZhciBjYXRjaEZpbHRlciA9IG5ldyBDYXRjaEZpbHRlcihjYXRjaEluc3RhbmNlcywgZm4sIHRoaXMpO1xuICAgICAgICByZXR1cm4gdGhpcy5fdGhlbih2b2lkIDAsIGNhdGNoRmlsdGVyLmRvRmlsdGVyLCB2b2lkIDAsXG4gICAgICAgICAgICBjYXRjaEZpbHRlciwgdm9pZCAwKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuX3RoZW4odm9pZCAwLCBmbiwgdm9pZCAwLCB2b2lkIDAsIHZvaWQgMCk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS50aGVuID1cbmZ1bmN0aW9uIFByb21pc2UkdGhlbihkaWRGdWxmaWxsLCBkaWRSZWplY3QsIGRpZFByb2dyZXNzKSB7XG4gICAgcmV0dXJuIHRoaXMuX3RoZW4oZGlkRnVsZmlsbCwgZGlkUmVqZWN0LCBkaWRQcm9ncmVzcyxcbiAgICAgICAgdm9pZCAwLCB2b2lkIDApO1xufTtcblxuXG5Qcm9taXNlLnByb3RvdHlwZS5kb25lID1cbmZ1bmN0aW9uIFByb21pc2UkZG9uZShkaWRGdWxmaWxsLCBkaWRSZWplY3QsIGRpZFByb2dyZXNzKSB7XG4gICAgdmFyIHByb21pc2UgPSB0aGlzLl90aGVuKGRpZEZ1bGZpbGwsIGRpZFJlamVjdCwgZGlkUHJvZ3Jlc3MsXG4gICAgICAgIHZvaWQgMCwgdm9pZCAwKTtcbiAgICBwcm9taXNlLl9zZXRJc0ZpbmFsKCk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5zcHJlYWQgPSBmdW5jdGlvbiBQcm9taXNlJHNwcmVhZChkaWRGdWxmaWxsLCBkaWRSZWplY3QpIHtcbiAgICByZXR1cm4gdGhpcy5fdGhlbihkaWRGdWxmaWxsLCBkaWRSZWplY3QsIHZvaWQgMCxcbiAgICAgICAgQVBQTFksIHZvaWQgMCk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5pc0NhbmNlbGxhYmxlID0gZnVuY3Rpb24gUHJvbWlzZSRpc0NhbmNlbGxhYmxlKCkge1xuICAgIHJldHVybiAhdGhpcy5pc1Jlc29sdmVkKCkgJiZcbiAgICAgICAgdGhpcy5fY2FuY2VsbGFibGUoKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uIFByb21pc2UkdG9KU09OKCkge1xuICAgIHZhciByZXQgPSB7XG4gICAgICAgIGlzRnVsZmlsbGVkOiBmYWxzZSxcbiAgICAgICAgaXNSZWplY3RlZDogZmFsc2UsXG4gICAgICAgIGZ1bGZpbGxtZW50VmFsdWU6IHZvaWQgMCxcbiAgICAgICAgcmVqZWN0aW9uUmVhc29uOiB2b2lkIDBcbiAgICB9O1xuICAgIGlmICh0aGlzLmlzRnVsZmlsbGVkKCkpIHtcbiAgICAgICAgcmV0LmZ1bGZpbGxtZW50VmFsdWUgPSB0aGlzLl9zZXR0bGVkVmFsdWU7XG4gICAgICAgIHJldC5pc0Z1bGZpbGxlZCA9IHRydWU7XG4gICAgfSBlbHNlIGlmICh0aGlzLmlzUmVqZWN0ZWQoKSkge1xuICAgICAgICByZXQucmVqZWN0aW9uUmVhc29uID0gdGhpcy5fc2V0dGxlZFZhbHVlO1xuICAgICAgICByZXQuaXNSZWplY3RlZCA9IHRydWU7XG4gICAgfVxuICAgIHJldHVybiByZXQ7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5hbGwgPSBmdW5jdGlvbiBQcm9taXNlJGFsbCgpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2VBcnJheSh0aGlzKS5wcm9taXNlKCk7XG59O1xuXG5cblByb21pc2UuaXMgPSBmdW5jdGlvbiBQcm9taXNlJElzKHZhbCkge1xuICAgIHJldHVybiB2YWwgaW5zdGFuY2VvZiBQcm9taXNlO1xufTtcblxuUHJvbWlzZS5hbGwgPSBmdW5jdGlvbiBQcm9taXNlJEFsbChwcm9taXNlcykge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZUFycmF5KHByb21pc2VzKS5wcm9taXNlKCk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIFByb21pc2UkX2Vycm9yKGZuKSB7XG4gICAgcmV0dXJuIHRoaXMuY2F1Z2h0KG9yaWdpbmF0ZXNGcm9tUmVqZWN0aW9uLCBmbik7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fcmVzb2x2ZUZyb21TeW5jVmFsdWUgPVxuZnVuY3Rpb24gUHJvbWlzZSRfcmVzb2x2ZUZyb21TeW5jVmFsdWUodmFsdWUpIHtcbiAgICBpZiAodmFsdWUgPT09IGVycm9yT2JqKSB7XG4gICAgICAgIHRoaXMuX2NsZWFuVmFsdWVzKCk7XG4gICAgICAgIHRoaXMuX3NldFJlamVjdGVkKCk7XG4gICAgICAgIHRoaXMuX3NldHRsZWRWYWx1ZSA9IHZhbHVlLmU7XG4gICAgICAgIHRoaXMuX2Vuc3VyZVBvc3NpYmxlUmVqZWN0aW9uSGFuZGxlZCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBtYXliZVByb21pc2UgPSBjYXN0KHZhbHVlLCB2b2lkIDApO1xuICAgICAgICBpZiAobWF5YmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgICAgdGhpcy5fZm9sbG93KG1heWJlUHJvbWlzZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9jbGVhblZhbHVlcygpO1xuICAgICAgICAgICAgdGhpcy5fc2V0RnVsZmlsbGVkKCk7XG4gICAgICAgICAgICB0aGlzLl9zZXR0bGVkVmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cblByb21pc2UubWV0aG9kID0gZnVuY3Rpb24gUHJvbWlzZSRfTWV0aG9kKGZuKSB7XG4gICAgaWYgKHR5cGVvZiBmbiAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJmbiBtdXN0IGJlIGEgZnVuY3Rpb25cIik7XG4gICAgfVxuICAgIHJldHVybiBmdW5jdGlvbiBQcm9taXNlJF9tZXRob2QoKSB7XG4gICAgICAgIHZhciB2YWx1ZTtcbiAgICAgICAgc3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgICAgY2FzZSAwOiB2YWx1ZSA9IHRyeUNhdGNoMShmbiwgdGhpcywgdm9pZCAwKTsgYnJlYWs7XG4gICAgICAgIGNhc2UgMTogdmFsdWUgPSB0cnlDYXRjaDEoZm4sIHRoaXMsIGFyZ3VtZW50c1swXSk7IGJyZWFrO1xuICAgICAgICBjYXNlIDI6IHZhbHVlID0gdHJ5Q2F0Y2gyKGZuLCB0aGlzLCBhcmd1bWVudHNbMF0sIGFyZ3VtZW50c1sxXSk7IGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgdmFyICRfbGVuID0gYXJndW1lbnRzLmxlbmd0aDt2YXIgYXJncyA9IG5ldyBBcnJheSgkX2xlbik7IGZvcih2YXIgJF9pID0gMDsgJF9pIDwgJF9sZW47ICsrJF9pKSB7YXJnc1skX2ldID0gYXJndW1lbnRzWyRfaV07fVxuICAgICAgICAgICAgdmFsdWUgPSB0cnlDYXRjaEFwcGx5KGZuLCBhcmdzLCB0aGlzKTsgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJldCA9IG5ldyBQcm9taXNlKElOVEVSTkFMKTtcbiAgICAgICAgcmV0Ll9zZXRUcmFjZSh2b2lkIDApO1xuICAgICAgICByZXQuX3Jlc29sdmVGcm9tU3luY1ZhbHVlKHZhbHVlKTtcbiAgICAgICAgcmV0dXJuIHJldDtcbiAgICB9O1xufTtcblxuUHJvbWlzZS5hdHRlbXB0ID0gUHJvbWlzZVtcInRyeVwiXSA9IGZ1bmN0aW9uIFByb21pc2UkX1RyeShmbiwgYXJncywgY3R4KSB7XG4gICAgaWYgKHR5cGVvZiBmbiAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHJldHVybiBhcGlSZWplY3Rpb24oXCJmbiBtdXN0IGJlIGEgZnVuY3Rpb25cIik7XG4gICAgfVxuICAgIHZhciB2YWx1ZSA9IGlzQXJyYXkoYXJncylcbiAgICAgICAgPyB0cnlDYXRjaEFwcGx5KGZuLCBhcmdzLCBjdHgpXG4gICAgICAgIDogdHJ5Q2F0Y2gxKGZuLCBjdHgsIGFyZ3MpO1xuXG4gICAgdmFyIHJldCA9IG5ldyBQcm9taXNlKElOVEVSTkFMKTtcbiAgICByZXQuX3NldFRyYWNlKHZvaWQgMCk7XG4gICAgcmV0Ll9yZXNvbHZlRnJvbVN5bmNWYWx1ZSh2YWx1ZSk7XG4gICAgcmV0dXJuIHJldDtcbn07XG5cblByb21pc2UuZGVmZXIgPSBQcm9taXNlLnBlbmRpbmcgPSBmdW5jdGlvbiBQcm9taXNlJERlZmVyKCkge1xuICAgIHZhciBwcm9taXNlID0gbmV3IFByb21pc2UoSU5URVJOQUwpO1xuICAgIHByb21pc2UuX3NldFRyYWNlKHZvaWQgMCk7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlUmVzb2x2ZXIocHJvbWlzZSk7XG59O1xuXG5Qcm9taXNlLmJpbmQgPSBmdW5jdGlvbiBQcm9taXNlJEJpbmQodGhpc0FyZykge1xuICAgIHZhciByZXQgPSBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG4gICAgcmV0Ll9zZXRUcmFjZSh2b2lkIDApO1xuICAgIHJldC5fc2V0RnVsZmlsbGVkKCk7XG4gICAgcmV0Ll9zZXRCb3VuZFRvKHRoaXNBcmcpO1xuICAgIHJldHVybiByZXQ7XG59O1xuXG5Qcm9taXNlLmNhc3QgPSBmdW5jdGlvbiBQcm9taXNlJF9DYXN0KG9iaikge1xuICAgIHZhciByZXQgPSBjYXN0KG9iaiwgdm9pZCAwKTtcbiAgICBpZiAoIShyZXQgaW5zdGFuY2VvZiBQcm9taXNlKSkge1xuICAgICAgICB2YXIgdmFsID0gcmV0O1xuICAgICAgICByZXQgPSBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG4gICAgICAgIHJldC5fc2V0VHJhY2Uodm9pZCAwKTtcbiAgICAgICAgcmV0Ll9zZXRGdWxmaWxsZWQoKTtcbiAgICAgICAgcmV0Ll9jbGVhblZhbHVlcygpO1xuICAgICAgICByZXQuX3NldHRsZWRWYWx1ZSA9IHZhbDtcbiAgICB9XG4gICAgcmV0dXJuIHJldDtcbn07XG5cblByb21pc2UucmVzb2x2ZSA9IFByb21pc2UuZnVsZmlsbGVkID0gUHJvbWlzZS5jYXN0O1xuXG5Qcm9taXNlLnJlamVjdCA9IFByb21pc2UucmVqZWN0ZWQgPSBmdW5jdGlvbiBQcm9taXNlJFJlamVjdChyZWFzb24pIHtcbiAgICB2YXIgcmV0ID0gbmV3IFByb21pc2UoSU5URVJOQUwpO1xuICAgIHJldC5fc2V0VHJhY2Uodm9pZCAwKTtcbiAgICBtYXJrQXNPcmlnaW5hdGluZ0Zyb21SZWplY3Rpb24ocmVhc29uKTtcbiAgICByZXQuX2NsZWFuVmFsdWVzKCk7XG4gICAgcmV0Ll9zZXRSZWplY3RlZCgpO1xuICAgIHJldC5fc2V0dGxlZFZhbHVlID0gcmVhc29uO1xuICAgIGlmICghY2FuQXR0YWNoKHJlYXNvbikpIHtcbiAgICAgICAgdmFyIHRyYWNlID0gbmV3IEVycm9yKHJlYXNvbiArIFwiXCIpO1xuICAgICAgICByZXQuX3NldENhcnJpZWRTdGFja1RyYWNlKHRyYWNlKTtcbiAgICB9XG4gICAgcmV0Ll9lbnN1cmVQb3NzaWJsZVJlamVjdGlvbkhhbmRsZWQoKTtcbiAgICByZXR1cm4gcmV0O1xufTtcblxuUHJvbWlzZS5vblBvc3NpYmx5VW5oYW5kbGVkUmVqZWN0aW9uID1cbmZ1bmN0aW9uIFByb21pc2UkT25Qb3NzaWJseVVuaGFuZGxlZFJlamVjdGlvbihmbikge1xuICAgICAgICBDYXB0dXJlZFRyYWNlLnBvc3NpYmx5VW5oYW5kbGVkUmVqZWN0aW9uID0gdHlwZW9mIGZuID09PSBcImZ1bmN0aW9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGZuIDogdm9pZCAwO1xufTtcblxudmFyIHVuaGFuZGxlZFJlamVjdGlvbkhhbmRsZWQ7XG5Qcm9taXNlLm9uVW5oYW5kbGVkUmVqZWN0aW9uSGFuZGxlZCA9XG5mdW5jdGlvbiBQcm9taXNlJG9uVW5oYW5kbGVkUmVqZWN0aW9uSGFuZGxlZChmbikge1xuICAgIHVuaGFuZGxlZFJlamVjdGlvbkhhbmRsZWQgPSB0eXBlb2YgZm4gPT09IFwiZnVuY3Rpb25cIiA/IGZuIDogdm9pZCAwO1xufTtcblxudmFyIGRlYnVnZ2luZyA9IGZhbHNlIHx8ICEhKFxuICAgIHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiICYmXG4gICAgdHlwZW9mIHByb2Nlc3MuZXhlY1BhdGggPT09IFwic3RyaW5nXCIgJiZcbiAgICB0eXBlb2YgcHJvY2Vzcy5lbnYgPT09IFwib2JqZWN0XCIgJiZcbiAgICAocHJvY2Vzcy5lbnZbXCJCTFVFQklSRF9ERUJVR1wiXSB8fFxuICAgICAgICBwcm9jZXNzLmVudltcIk5PREVfRU5WXCJdID09PSBcImRldmVsb3BtZW50XCIpXG4pO1xuXG5cblByb21pc2UubG9uZ1N0YWNrVHJhY2VzID0gZnVuY3Rpb24gUHJvbWlzZSRMb25nU3RhY2tUcmFjZXMoKSB7XG4gICAgaWYgKGFzeW5jLmhhdmVJdGVtc1F1ZXVlZCgpICYmXG4gICAgICAgIGRlYnVnZ2luZyA9PT0gZmFsc2VcbiAgICkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJjYW5ub3QgZW5hYmxlIGxvbmcgc3RhY2sgdHJhY2VzIGFmdGVyIHByb21pc2VzIGhhdmUgYmVlbiBjcmVhdGVkXCIpO1xuICAgIH1cbiAgICBkZWJ1Z2dpbmcgPSBDYXB0dXJlZFRyYWNlLmlzU3VwcG9ydGVkKCk7XG59O1xuXG5Qcm9taXNlLmhhc0xvbmdTdGFja1RyYWNlcyA9IGZ1bmN0aW9uIFByb21pc2UkSGFzTG9uZ1N0YWNrVHJhY2VzKCkge1xuICAgIHJldHVybiBkZWJ1Z2dpbmcgJiYgQ2FwdHVyZWRUcmFjZS5pc1N1cHBvcnRlZCgpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3RoZW4gPVxuZnVuY3Rpb24gUHJvbWlzZSRfdGhlbihcbiAgICBkaWRGdWxmaWxsLFxuICAgIGRpZFJlamVjdCxcbiAgICBkaWRQcm9ncmVzcyxcbiAgICByZWNlaXZlcixcbiAgICBpbnRlcm5hbERhdGFcbikge1xuICAgIHZhciBoYXZlSW50ZXJuYWxEYXRhID0gaW50ZXJuYWxEYXRhICE9PSB2b2lkIDA7XG4gICAgdmFyIHJldCA9IGhhdmVJbnRlcm5hbERhdGEgPyBpbnRlcm5hbERhdGEgOiBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG5cbiAgICBpZiAoIWhhdmVJbnRlcm5hbERhdGEpIHtcbiAgICAgICAgaWYgKGRlYnVnZ2luZykge1xuICAgICAgICAgICAgdmFyIGhhdmVTYW1lQ29udGV4dCA9IHRoaXMuX3BlZWtDb250ZXh0KCkgPT09IHRoaXMuX3RyYWNlUGFyZW50O1xuICAgICAgICAgICAgcmV0Ll90cmFjZVBhcmVudCA9IGhhdmVTYW1lQ29udGV4dCA/IHRoaXMuX3RyYWNlUGFyZW50IDogdGhpcztcbiAgICAgICAgfVxuICAgICAgICByZXQuX3Byb3BhZ2F0ZUZyb20odGhpcywgNyk7XG4gICAgfVxuXG4gICAgdmFyIGNhbGxiYWNrSW5kZXggPVxuICAgICAgICB0aGlzLl9hZGRDYWxsYmFja3MoZGlkRnVsZmlsbCwgZGlkUmVqZWN0LCBkaWRQcm9ncmVzcywgcmV0LCByZWNlaXZlcik7XG5cbiAgICBpZiAodGhpcy5pc1Jlc29sdmVkKCkpIHtcbiAgICAgICAgYXN5bmMuaW52b2tlKHRoaXMuX3F1ZXVlU2V0dGxlQXQsIHRoaXMsIGNhbGxiYWNrSW5kZXgpO1xuICAgIH1cblxuICAgIHJldHVybiByZXQ7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fbGVuZ3RoID0gZnVuY3Rpb24gUHJvbWlzZSRfbGVuZ3RoKCkge1xuICAgIHJldHVybiB0aGlzLl9iaXRGaWVsZCAmIDI2MjE0Mztcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9pc0ZvbGxvd2luZ09yRnVsZmlsbGVkT3JSZWplY3RlZCA9XG5mdW5jdGlvbiBQcm9taXNlJF9pc0ZvbGxvd2luZ09yRnVsZmlsbGVkT3JSZWplY3RlZCgpIHtcbiAgICByZXR1cm4gKHRoaXMuX2JpdEZpZWxkICYgOTM5NTI0MDk2KSA+IDA7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5faXNGb2xsb3dpbmcgPSBmdW5jdGlvbiBQcm9taXNlJF9pc0ZvbGxvd2luZygpIHtcbiAgICByZXR1cm4gKHRoaXMuX2JpdEZpZWxkICYgNTM2ODcwOTEyKSA9PT0gNTM2ODcwOTEyO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3NldExlbmd0aCA9IGZ1bmN0aW9uIFByb21pc2UkX3NldExlbmd0aChsZW4pIHtcbiAgICB0aGlzLl9iaXRGaWVsZCA9ICh0aGlzLl9iaXRGaWVsZCAmIC0yNjIxNDQpIHxcbiAgICAgICAgKGxlbiAmIDI2MjE0Myk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fc2V0RnVsZmlsbGVkID0gZnVuY3Rpb24gUHJvbWlzZSRfc2V0RnVsZmlsbGVkKCkge1xuICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgfCAyNjg0MzU0NTY7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fc2V0UmVqZWN0ZWQgPSBmdW5jdGlvbiBQcm9taXNlJF9zZXRSZWplY3RlZCgpIHtcbiAgICB0aGlzLl9iaXRGaWVsZCA9IHRoaXMuX2JpdEZpZWxkIHwgMTM0MjE3NzI4O1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3NldEZvbGxvd2luZyA9IGZ1bmN0aW9uIFByb21pc2UkX3NldEZvbGxvd2luZygpIHtcbiAgICB0aGlzLl9iaXRGaWVsZCA9IHRoaXMuX2JpdEZpZWxkIHwgNTM2ODcwOTEyO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3NldElzRmluYWwgPSBmdW5jdGlvbiBQcm9taXNlJF9zZXRJc0ZpbmFsKCkge1xuICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgfCAzMzU1NDQzMjtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9pc0ZpbmFsID0gZnVuY3Rpb24gUHJvbWlzZSRfaXNGaW5hbCgpIHtcbiAgICByZXR1cm4gKHRoaXMuX2JpdEZpZWxkICYgMzM1NTQ0MzIpID4gMDtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9jYW5jZWxsYWJsZSA9IGZ1bmN0aW9uIFByb21pc2UkX2NhbmNlbGxhYmxlKCkge1xuICAgIHJldHVybiAodGhpcy5fYml0RmllbGQgJiA2NzEwODg2NCkgPiAwO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3NldENhbmNlbGxhYmxlID0gZnVuY3Rpb24gUHJvbWlzZSRfc2V0Q2FuY2VsbGFibGUoKSB7XG4gICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCB8IDY3MTA4ODY0O1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3Vuc2V0Q2FuY2VsbGFibGUgPSBmdW5jdGlvbiBQcm9taXNlJF91bnNldENhbmNlbGxhYmxlKCkge1xuICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgJiAofjY3MTA4ODY0KTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9zZXRSZWplY3Rpb25Jc1VuaGFuZGxlZCA9XG5mdW5jdGlvbiBQcm9taXNlJF9zZXRSZWplY3Rpb25Jc1VuaGFuZGxlZCgpIHtcbiAgICB0aGlzLl9iaXRGaWVsZCA9IHRoaXMuX2JpdEZpZWxkIHwgMjA5NzE1Mjtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl91bnNldFJlamVjdGlvbklzVW5oYW5kbGVkID1cbmZ1bmN0aW9uIFByb21pc2UkX3Vuc2V0UmVqZWN0aW9uSXNVbmhhbmRsZWQoKSB7XG4gICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCAmICh+MjA5NzE1Mik7XG4gICAgaWYgKHRoaXMuX2lzVW5oYW5kbGVkUmVqZWN0aW9uTm90aWZpZWQoKSkge1xuICAgICAgICB0aGlzLl91bnNldFVuaGFuZGxlZFJlamVjdGlvbklzTm90aWZpZWQoKTtcbiAgICAgICAgdGhpcy5fbm90aWZ5VW5oYW5kbGVkUmVqZWN0aW9uSXNIYW5kbGVkKCk7XG4gICAgfVxufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2lzUmVqZWN0aW9uVW5oYW5kbGVkID1cbmZ1bmN0aW9uIFByb21pc2UkX2lzUmVqZWN0aW9uVW5oYW5kbGVkKCkge1xuICAgIHJldHVybiAodGhpcy5fYml0RmllbGQgJiAyMDk3MTUyKSA+IDA7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fc2V0VW5oYW5kbGVkUmVqZWN0aW9uSXNOb3RpZmllZCA9XG5mdW5jdGlvbiBQcm9taXNlJF9zZXRVbmhhbmRsZWRSZWplY3Rpb25Jc05vdGlmaWVkKCkge1xuICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgfCA1MjQyODg7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fdW5zZXRVbmhhbmRsZWRSZWplY3Rpb25Jc05vdGlmaWVkID1cbmZ1bmN0aW9uIFByb21pc2UkX3Vuc2V0VW5oYW5kbGVkUmVqZWN0aW9uSXNOb3RpZmllZCgpIHtcbiAgICB0aGlzLl9iaXRGaWVsZCA9IHRoaXMuX2JpdEZpZWxkICYgKH41MjQyODgpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2lzVW5oYW5kbGVkUmVqZWN0aW9uTm90aWZpZWQgPVxuZnVuY3Rpb24gUHJvbWlzZSRfaXNVbmhhbmRsZWRSZWplY3Rpb25Ob3RpZmllZCgpIHtcbiAgICByZXR1cm4gKHRoaXMuX2JpdEZpZWxkICYgNTI0Mjg4KSA+IDA7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fc2V0Q2FycmllZFN0YWNrVHJhY2UgPVxuZnVuY3Rpb24gUHJvbWlzZSRfc2V0Q2FycmllZFN0YWNrVHJhY2UoY2FwdHVyZWRUcmFjZSkge1xuICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgfCAxMDQ4NTc2O1xuICAgIHRoaXMuX2Z1bGZpbGxtZW50SGFuZGxlcjAgPSBjYXB0dXJlZFRyYWNlO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3Vuc2V0Q2FycmllZFN0YWNrVHJhY2UgPVxuZnVuY3Rpb24gUHJvbWlzZSRfdW5zZXRDYXJyaWVkU3RhY2tUcmFjZSgpIHtcbiAgICB0aGlzLl9iaXRGaWVsZCA9IHRoaXMuX2JpdEZpZWxkICYgKH4xMDQ4NTc2KTtcbiAgICB0aGlzLl9mdWxmaWxsbWVudEhhbmRsZXIwID0gdm9pZCAwO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2lzQ2FycnlpbmdTdGFja1RyYWNlID1cbmZ1bmN0aW9uIFByb21pc2UkX2lzQ2FycnlpbmdTdGFja1RyYWNlKCkge1xuICAgIHJldHVybiAodGhpcy5fYml0RmllbGQgJiAxMDQ4NTc2KSA+IDA7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fZ2V0Q2FycmllZFN0YWNrVHJhY2UgPVxuZnVuY3Rpb24gUHJvbWlzZSRfZ2V0Q2FycmllZFN0YWNrVHJhY2UoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lzQ2FycnlpbmdTdGFja1RyYWNlKClcbiAgICAgICAgPyB0aGlzLl9mdWxmaWxsbWVudEhhbmRsZXIwXG4gICAgICAgIDogdm9pZCAwO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3JlY2VpdmVyQXQgPSBmdW5jdGlvbiBQcm9taXNlJF9yZWNlaXZlckF0KGluZGV4KSB7XG4gICAgdmFyIHJldCA9IGluZGV4ID09PSAwXG4gICAgICAgID8gdGhpcy5fcmVjZWl2ZXIwXG4gICAgICAgIDogdGhpc1soaW5kZXggPDwgMikgKyBpbmRleCAtIDUgKyA0XTtcbiAgICBpZiAodGhpcy5faXNCb3VuZCgpICYmIHJldCA9PT0gdm9pZCAwKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9ib3VuZFRvO1xuICAgIH1cbiAgICByZXR1cm4gcmV0O1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3Byb21pc2VBdCA9IGZ1bmN0aW9uIFByb21pc2UkX3Byb21pc2VBdChpbmRleCkge1xuICAgIHJldHVybiBpbmRleCA9PT0gMFxuICAgICAgICA/IHRoaXMuX3Byb21pc2UwXG4gICAgICAgIDogdGhpc1soaW5kZXggPDwgMikgKyBpbmRleCAtIDUgKyAzXTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9mdWxmaWxsbWVudEhhbmRsZXJBdCA9XG5mdW5jdGlvbiBQcm9taXNlJF9mdWxmaWxsbWVudEhhbmRsZXJBdChpbmRleCkge1xuICAgIHJldHVybiBpbmRleCA9PT0gMFxuICAgICAgICA/IHRoaXMuX2Z1bGZpbGxtZW50SGFuZGxlcjBcbiAgICAgICAgOiB0aGlzWyhpbmRleCA8PCAyKSArIGluZGV4IC0gNSArIDBdO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3JlamVjdGlvbkhhbmRsZXJBdCA9XG5mdW5jdGlvbiBQcm9taXNlJF9yZWplY3Rpb25IYW5kbGVyQXQoaW5kZXgpIHtcbiAgICByZXR1cm4gaW5kZXggPT09IDBcbiAgICAgICAgPyB0aGlzLl9yZWplY3Rpb25IYW5kbGVyMFxuICAgICAgICA6IHRoaXNbKGluZGV4IDw8IDIpICsgaW5kZXggLSA1ICsgMV07XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fYWRkQ2FsbGJhY2tzID0gZnVuY3Rpb24gUHJvbWlzZSRfYWRkQ2FsbGJhY2tzKFxuICAgIGZ1bGZpbGwsXG4gICAgcmVqZWN0LFxuICAgIHByb2dyZXNzLFxuICAgIHByb21pc2UsXG4gICAgcmVjZWl2ZXJcbikge1xuICAgIHZhciBpbmRleCA9IHRoaXMuX2xlbmd0aCgpO1xuXG4gICAgaWYgKGluZGV4ID49IDI2MjE0MyAtIDUpIHtcbiAgICAgICAgaW5kZXggPSAwO1xuICAgICAgICB0aGlzLl9zZXRMZW5ndGgoMCk7XG4gICAgfVxuXG4gICAgaWYgKGluZGV4ID09PSAwKSB7XG4gICAgICAgIHRoaXMuX3Byb21pc2UwID0gcHJvbWlzZTtcbiAgICAgICAgaWYgKHJlY2VpdmVyICE9PSB2b2lkIDApIHRoaXMuX3JlY2VpdmVyMCA9IHJlY2VpdmVyO1xuICAgICAgICBpZiAodHlwZW9mIGZ1bGZpbGwgPT09IFwiZnVuY3Rpb25cIiAmJiAhdGhpcy5faXNDYXJyeWluZ1N0YWNrVHJhY2UoKSlcbiAgICAgICAgICAgIHRoaXMuX2Z1bGZpbGxtZW50SGFuZGxlcjAgPSBmdWxmaWxsO1xuICAgICAgICBpZiAodHlwZW9mIHJlamVjdCA9PT0gXCJmdW5jdGlvblwiKSB0aGlzLl9yZWplY3Rpb25IYW5kbGVyMCA9IHJlamVjdDtcbiAgICAgICAgaWYgKHR5cGVvZiBwcm9ncmVzcyA9PT0gXCJmdW5jdGlvblwiKSB0aGlzLl9wcm9ncmVzc0hhbmRsZXIwID0gcHJvZ3Jlc3M7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIGJhc2UgPSAoaW5kZXggPDwgMikgKyBpbmRleCAtIDU7XG4gICAgICAgIHRoaXNbYmFzZSArIDNdID0gcHJvbWlzZTtcbiAgICAgICAgdGhpc1tiYXNlICsgNF0gPSByZWNlaXZlcjtcbiAgICAgICAgdGhpc1tiYXNlICsgMF0gPSB0eXBlb2YgZnVsZmlsbCA9PT0gXCJmdW5jdGlvblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gZnVsZmlsbCA6IHZvaWQgMDtcbiAgICAgICAgdGhpc1tiYXNlICsgMV0gPSB0eXBlb2YgcmVqZWN0ID09PSBcImZ1bmN0aW9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyByZWplY3QgOiB2b2lkIDA7XG4gICAgICAgIHRoaXNbYmFzZSArIDJdID0gdHlwZW9mIHByb2dyZXNzID09PSBcImZ1bmN0aW9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBwcm9ncmVzcyA6IHZvaWQgMDtcbiAgICB9XG4gICAgdGhpcy5fc2V0TGVuZ3RoKGluZGV4ICsgMSk7XG4gICAgcmV0dXJuIGluZGV4O1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3NldFByb3h5SGFuZGxlcnMgPVxuZnVuY3Rpb24gUHJvbWlzZSRfc2V0UHJveHlIYW5kbGVycyhyZWNlaXZlciwgcHJvbWlzZVNsb3RWYWx1ZSkge1xuICAgIHZhciBpbmRleCA9IHRoaXMuX2xlbmd0aCgpO1xuXG4gICAgaWYgKGluZGV4ID49IDI2MjE0MyAtIDUpIHtcbiAgICAgICAgaW5kZXggPSAwO1xuICAgICAgICB0aGlzLl9zZXRMZW5ndGgoMCk7XG4gICAgfVxuICAgIGlmIChpbmRleCA9PT0gMCkge1xuICAgICAgICB0aGlzLl9wcm9taXNlMCA9IHByb21pc2VTbG90VmFsdWU7XG4gICAgICAgIHRoaXMuX3JlY2VpdmVyMCA9IHJlY2VpdmVyO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBiYXNlID0gKGluZGV4IDw8IDIpICsgaW5kZXggLSA1O1xuICAgICAgICB0aGlzW2Jhc2UgKyAzXSA9IHByb21pc2VTbG90VmFsdWU7XG4gICAgICAgIHRoaXNbYmFzZSArIDRdID0gcmVjZWl2ZXI7XG4gICAgICAgIHRoaXNbYmFzZSArIDBdID1cbiAgICAgICAgdGhpc1tiYXNlICsgMV0gPVxuICAgICAgICB0aGlzW2Jhc2UgKyAyXSA9IHZvaWQgMDtcbiAgICB9XG4gICAgdGhpcy5fc2V0TGVuZ3RoKGluZGV4ICsgMSk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fcHJveHlQcm9taXNlQXJyYXkgPVxuZnVuY3Rpb24gUHJvbWlzZSRfcHJveHlQcm9taXNlQXJyYXkocHJvbWlzZUFycmF5LCBpbmRleCkge1xuICAgIHRoaXMuX3NldFByb3h5SGFuZGxlcnMocHJvbWlzZUFycmF5LCBpbmRleCk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fcHJveHlQcm9taXNlID0gZnVuY3Rpb24gUHJvbWlzZSRfcHJveHlQcm9taXNlKHByb21pc2UpIHtcbiAgICBwcm9taXNlLl9zZXRQcm94aWVkKCk7XG4gICAgdGhpcy5fc2V0UHJveHlIYW5kbGVycyhwcm9taXNlLCAtMSk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fc2V0Qm91bmRUbyA9IGZ1bmN0aW9uIFByb21pc2UkX3NldEJvdW5kVG8ob2JqKSB7XG4gICAgaWYgKG9iaiAhPT0gdm9pZCAwKSB7XG4gICAgICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgfCA4Mzg4NjA4O1xuICAgICAgICB0aGlzLl9ib3VuZFRvID0gb2JqO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgJiAofjgzODg2MDgpO1xuICAgIH1cbn07XG5cblByb21pc2UucHJvdG90eXBlLl9pc0JvdW5kID0gZnVuY3Rpb24gUHJvbWlzZSRfaXNCb3VuZCgpIHtcbiAgICByZXR1cm4gKHRoaXMuX2JpdEZpZWxkICYgODM4ODYwOCkgPT09IDgzODg2MDg7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fcmVzb2x2ZUZyb21SZXNvbHZlciA9XG5mdW5jdGlvbiBQcm9taXNlJF9yZXNvbHZlRnJvbVJlc29sdmVyKHJlc29sdmVyKSB7XG4gICAgdmFyIHByb21pc2UgPSB0aGlzO1xuICAgIHRoaXMuX3NldFRyYWNlKHZvaWQgMCk7XG4gICAgdGhpcy5fcHVzaENvbnRleHQoKTtcblxuICAgIGZ1bmN0aW9uIFByb21pc2UkX3Jlc29sdmVyKHZhbCkge1xuICAgICAgICBpZiAocHJvbWlzZS5fdHJ5Rm9sbG93KHZhbCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBwcm9taXNlLl9mdWxmaWxsKHZhbCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIFByb21pc2UkX3JlamVjdGVyKHZhbCkge1xuICAgICAgICB2YXIgdHJhY2UgPSBjYW5BdHRhY2godmFsKSA/IHZhbCA6IG5ldyBFcnJvcih2YWwgKyBcIlwiKTtcbiAgICAgICAgcHJvbWlzZS5fYXR0YWNoRXh0cmFUcmFjZSh0cmFjZSk7XG4gICAgICAgIG1hcmtBc09yaWdpbmF0aW5nRnJvbVJlamVjdGlvbih2YWwpO1xuICAgICAgICBwcm9taXNlLl9yZWplY3QodmFsLCB0cmFjZSA9PT0gdmFsID8gdm9pZCAwIDogdHJhY2UpO1xuICAgIH1cbiAgICB2YXIgciA9IHRyeUNhdGNoMihyZXNvbHZlciwgdm9pZCAwLCBQcm9taXNlJF9yZXNvbHZlciwgUHJvbWlzZSRfcmVqZWN0ZXIpO1xuICAgIHRoaXMuX3BvcENvbnRleHQoKTtcblxuICAgIGlmIChyICE9PSB2b2lkIDAgJiYgciA9PT0gZXJyb3JPYmopIHtcbiAgICAgICAgdmFyIGUgPSByLmU7XG4gICAgICAgIHZhciB0cmFjZSA9IGNhbkF0dGFjaChlKSA/IGUgOiBuZXcgRXJyb3IoZSArIFwiXCIpO1xuICAgICAgICBwcm9taXNlLl9yZWplY3QoZSwgdHJhY2UpO1xuICAgIH1cbn07XG5cblByb21pc2UucHJvdG90eXBlLl9zcHJlYWRTbG93Q2FzZSA9XG5mdW5jdGlvbiBQcm9taXNlJF9zcHJlYWRTbG93Q2FzZSh0YXJnZXRGbiwgcHJvbWlzZSwgdmFsdWVzLCBib3VuZFRvKSB7XG4gICAgdmFyIHByb21pc2VGb3JBbGwgPSBuZXcgUHJvbWlzZUFycmF5KHZhbHVlcykucHJvbWlzZSgpO1xuICAgIHZhciBwcm9taXNlMiA9IHByb21pc2VGb3JBbGwuX3RoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0YXJnZXRGbi5hcHBseShib3VuZFRvLCBhcmd1bWVudHMpO1xuICAgIH0sIHZvaWQgMCwgdm9pZCAwLCBBUFBMWSwgdm9pZCAwKTtcbiAgICBwcm9taXNlLl9mb2xsb3cocHJvbWlzZTIpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2NhbGxTcHJlYWQgPVxuZnVuY3Rpb24gUHJvbWlzZSRfY2FsbFNwcmVhZChoYW5kbGVyLCBwcm9taXNlLCB2YWx1ZSkge1xuICAgIHZhciBib3VuZFRvID0gdGhpcy5fYm91bmRUbztcbiAgICBpZiAoaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHZhbHVlLmxlbmd0aDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgICAgICBpZiAoY2FzdCh2YWx1ZVtpXSwgdm9pZCAwKSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zcHJlYWRTbG93Q2FzZShoYW5kbGVyLCBwcm9taXNlLCB2YWx1ZSwgYm91bmRUbyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHByb21pc2UuX3B1c2hDb250ZXh0KCk7XG4gICAgcmV0dXJuIHRyeUNhdGNoQXBwbHkoaGFuZGxlciwgdmFsdWUsIGJvdW5kVG8pO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2NhbGxIYW5kbGVyID1cbmZ1bmN0aW9uIFByb21pc2UkX2NhbGxIYW5kbGVyKFxuICAgIGhhbmRsZXIsIHJlY2VpdmVyLCBwcm9taXNlLCB2YWx1ZSkge1xuICAgIHZhciB4O1xuICAgIGlmIChyZWNlaXZlciA9PT0gQVBQTFkgJiYgIXRoaXMuaXNSZWplY3RlZCgpKSB7XG4gICAgICAgIHggPSB0aGlzLl9jYWxsU3ByZWFkKGhhbmRsZXIsIHByb21pc2UsIHZhbHVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBwcm9taXNlLl9wdXNoQ29udGV4dCgpO1xuICAgICAgICB4ID0gdHJ5Q2F0Y2gxKGhhbmRsZXIsIHJlY2VpdmVyLCB2YWx1ZSk7XG4gICAgfVxuICAgIHByb21pc2UuX3BvcENvbnRleHQoKTtcbiAgICByZXR1cm4geDtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9zZXR0bGVQcm9taXNlRnJvbUhhbmRsZXIgPVxuZnVuY3Rpb24gUHJvbWlzZSRfc2V0dGxlUHJvbWlzZUZyb21IYW5kbGVyKFxuICAgIGhhbmRsZXIsIHJlY2VpdmVyLCB2YWx1ZSwgcHJvbWlzZVxuKSB7XG4gICAgaWYgKCEocHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpKSB7XG4gICAgICAgIGhhbmRsZXIuY2FsbChyZWNlaXZlciwgdmFsdWUsIHByb21pc2UpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciB4ID0gdGhpcy5fY2FsbEhhbmRsZXIoaGFuZGxlciwgcmVjZWl2ZXIsIHByb21pc2UsIHZhbHVlKTtcbiAgICBpZiAocHJvbWlzZS5faXNGb2xsb3dpbmcoKSkgcmV0dXJuO1xuXG4gICAgaWYgKHggPT09IGVycm9yT2JqIHx8IHggPT09IHByb21pc2UgfHwgeCA9PT0gTkVYVF9GSUxURVIpIHtcbiAgICAgICAgdmFyIGVyciA9IHggPT09IHByb21pc2VcbiAgICAgICAgICAgICAgICAgICAgPyBtYWtlU2VsZlJlc29sdXRpb25FcnJvcigpXG4gICAgICAgICAgICAgICAgICAgIDogeC5lO1xuICAgICAgICB2YXIgdHJhY2UgPSBjYW5BdHRhY2goZXJyKSA/IGVyciA6IG5ldyBFcnJvcihlcnIgKyBcIlwiKTtcbiAgICAgICAgaWYgKHggIT09IE5FWFRfRklMVEVSKSBwcm9taXNlLl9hdHRhY2hFeHRyYVRyYWNlKHRyYWNlKTtcbiAgICAgICAgcHJvbWlzZS5fcmVqZWN0VW5jaGVja2VkKGVyciwgdHJhY2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBjYXN0VmFsdWUgPSBjYXN0KHgsIHByb21pc2UpO1xuICAgICAgICBpZiAoY2FzdFZhbHVlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgICAgaWYgKGNhc3RWYWx1ZS5pc1JlamVjdGVkKCkgJiZcbiAgICAgICAgICAgICAgICAhY2FzdFZhbHVlLl9pc0NhcnJ5aW5nU3RhY2tUcmFjZSgpICYmXG4gICAgICAgICAgICAgICAgIWNhbkF0dGFjaChjYXN0VmFsdWUuX3NldHRsZWRWYWx1ZSkpIHtcbiAgICAgICAgICAgICAgICB2YXIgdHJhY2UgPSBuZXcgRXJyb3IoY2FzdFZhbHVlLl9zZXR0bGVkVmFsdWUgKyBcIlwiKTtcbiAgICAgICAgICAgICAgICBwcm9taXNlLl9hdHRhY2hFeHRyYVRyYWNlKHRyYWNlKTtcbiAgICAgICAgICAgICAgICBjYXN0VmFsdWUuX3NldENhcnJpZWRTdGFja1RyYWNlKHRyYWNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHByb21pc2UuX2ZvbGxvdyhjYXN0VmFsdWUpO1xuICAgICAgICAgICAgcHJvbWlzZS5fcHJvcGFnYXRlRnJvbShjYXN0VmFsdWUsIDEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcHJvbWlzZS5fZnVsZmlsbFVuY2hlY2tlZCh4KTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cblByb21pc2UucHJvdG90eXBlLl9mb2xsb3cgPVxuZnVuY3Rpb24gUHJvbWlzZSRfZm9sbG93KHByb21pc2UpIHtcbiAgICB0aGlzLl9zZXRGb2xsb3dpbmcoKTtcblxuICAgIGlmIChwcm9taXNlLmlzUGVuZGluZygpKSB7XG4gICAgICAgIHRoaXMuX3Byb3BhZ2F0ZUZyb20ocHJvbWlzZSwgMSk7XG4gICAgICAgIHByb21pc2UuX3Byb3h5UHJvbWlzZSh0aGlzKTtcbiAgICB9IGVsc2UgaWYgKHByb21pc2UuaXNGdWxmaWxsZWQoKSkge1xuICAgICAgICB0aGlzLl9mdWxmaWxsVW5jaGVja2VkKHByb21pc2UuX3NldHRsZWRWYWx1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fcmVqZWN0VW5jaGVja2VkKHByb21pc2UuX3NldHRsZWRWYWx1ZSxcbiAgICAgICAgICAgIHByb21pc2UuX2dldENhcnJpZWRTdGFja1RyYWNlKCkpO1xuICAgIH1cblxuICAgIGlmIChwcm9taXNlLl9pc1JlamVjdGlvblVuaGFuZGxlZCgpKSBwcm9taXNlLl91bnNldFJlamVjdGlvbklzVW5oYW5kbGVkKCk7XG5cbiAgICBpZiAoZGVidWdnaW5nICYmXG4gICAgICAgIHByb21pc2UuX3RyYWNlUGFyZW50ID09IG51bGwpIHtcbiAgICAgICAgcHJvbWlzZS5fdHJhY2VQYXJlbnQgPSB0aGlzO1xuICAgIH1cbn07XG5cblByb21pc2UucHJvdG90eXBlLl90cnlGb2xsb3cgPVxuZnVuY3Rpb24gUHJvbWlzZSRfdHJ5Rm9sbG93KHZhbHVlKSB7XG4gICAgaWYgKHRoaXMuX2lzRm9sbG93aW5nT3JGdWxmaWxsZWRPclJlamVjdGVkKCkgfHxcbiAgICAgICAgdmFsdWUgPT09IHRoaXMpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgbWF5YmVQcm9taXNlID0gY2FzdCh2YWx1ZSwgdm9pZCAwKTtcbiAgICBpZiAoIShtYXliZVByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHRoaXMuX2ZvbGxvdyhtYXliZVByb21pc2UpO1xuICAgIHJldHVybiB0cnVlO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3Jlc2V0VHJhY2UgPSBmdW5jdGlvbiBQcm9taXNlJF9yZXNldFRyYWNlKCkge1xuICAgIGlmIChkZWJ1Z2dpbmcpIHtcbiAgICAgICAgdGhpcy5fdHJhY2UgPSBuZXcgQ2FwdHVyZWRUcmFjZSh0aGlzLl9wZWVrQ29udGV4dCgpID09PSB2b2lkIDApO1xuICAgIH1cbn07XG5cblByb21pc2UucHJvdG90eXBlLl9zZXRUcmFjZSA9IGZ1bmN0aW9uIFByb21pc2UkX3NldFRyYWNlKHBhcmVudCkge1xuICAgIGlmIChkZWJ1Z2dpbmcpIHtcbiAgICAgICAgdmFyIGNvbnRleHQgPSB0aGlzLl9wZWVrQ29udGV4dCgpO1xuICAgICAgICB0aGlzLl90cmFjZVBhcmVudCA9IGNvbnRleHQ7XG4gICAgICAgIHZhciBpc1RvcExldmVsID0gY29udGV4dCA9PT0gdm9pZCAwO1xuICAgICAgICBpZiAocGFyZW50ICE9PSB2b2lkIDAgJiZcbiAgICAgICAgICAgIHBhcmVudC5fdHJhY2VQYXJlbnQgPT09IGNvbnRleHQpIHtcbiAgICAgICAgICAgIHRoaXMuX3RyYWNlID0gcGFyZW50Ll90cmFjZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX3RyYWNlID0gbmV3IENhcHR1cmVkVHJhY2UoaXNUb3BMZXZlbCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fYXR0YWNoRXh0cmFUcmFjZSA9XG5mdW5jdGlvbiBQcm9taXNlJF9hdHRhY2hFeHRyYVRyYWNlKGVycm9yKSB7XG4gICAgaWYgKGRlYnVnZ2luZykge1xuICAgICAgICB2YXIgcHJvbWlzZSA9IHRoaXM7XG4gICAgICAgIHZhciBzdGFjayA9IGVycm9yLnN0YWNrO1xuICAgICAgICBzdGFjayA9IHR5cGVvZiBzdGFjayA9PT0gXCJzdHJpbmdcIiA/IHN0YWNrLnNwbGl0KFwiXFxuXCIpIDogW107XG4gICAgICAgIENhcHR1cmVkVHJhY2UucHJvdGVjdEVycm9yTWVzc2FnZU5ld2xpbmVzKHN0YWNrKTtcbiAgICAgICAgdmFyIGhlYWRlckxpbmVDb3VudCA9IDE7XG4gICAgICAgIHZhciBjb21iaW5lZFRyYWNlcyA9IDE7XG4gICAgICAgIHdoaWxlKHByb21pc2UgIT0gbnVsbCAmJlxuICAgICAgICAgICAgcHJvbWlzZS5fdHJhY2UgIT0gbnVsbCkge1xuICAgICAgICAgICAgc3RhY2sgPSBDYXB0dXJlZFRyYWNlLmNvbWJpbmUoXG4gICAgICAgICAgICAgICAgc3RhY2ssXG4gICAgICAgICAgICAgICAgcHJvbWlzZS5fdHJhY2Uuc3RhY2suc3BsaXQoXCJcXG5cIilcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBwcm9taXNlID0gcHJvbWlzZS5fdHJhY2VQYXJlbnQ7XG4gICAgICAgICAgICBjb21iaW5lZFRyYWNlcysrO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHN0YWNrVHJhY2VMaW1pdCA9IEVycm9yLnN0YWNrVHJhY2VMaW1pdCB8fCAxMDtcbiAgICAgICAgdmFyIG1heCA9IChzdGFja1RyYWNlTGltaXQgKyBoZWFkZXJMaW5lQ291bnQpICogY29tYmluZWRUcmFjZXM7XG4gICAgICAgIHZhciBsZW4gPSBzdGFjay5sZW5ndGg7XG4gICAgICAgIGlmIChsZW4gPiBtYXgpIHtcbiAgICAgICAgICAgIHN0YWNrLmxlbmd0aCA9IG1heDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChsZW4gPiAwKVxuICAgICAgICAgICAgc3RhY2tbMF0gPSBzdGFja1swXS5zcGxpdChcIlxcdTAwMDJcXHUwMDAwXFx1MDAwMVwiKS5qb2luKFwiXFxuXCIpO1xuXG4gICAgICAgIGlmIChzdGFjay5sZW5ndGggPD0gaGVhZGVyTGluZUNvdW50KSB7XG4gICAgICAgICAgICBlcnJvci5zdGFjayA9IFwiKE5vIHN0YWNrIHRyYWNlKVwiO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZXJyb3Iuc3RhY2sgPSBzdGFjay5qb2luKFwiXFxuXCIpO1xuICAgICAgICB9XG4gICAgfVxufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2NsZWFuVmFsdWVzID0gZnVuY3Rpb24gUHJvbWlzZSRfY2xlYW5WYWx1ZXMoKSB7XG4gICAgaWYgKHRoaXMuX2NhbmNlbGxhYmxlKCkpIHtcbiAgICAgICAgdGhpcy5fY2FuY2VsbGF0aW9uUGFyZW50ID0gdm9pZCAwO1xuICAgIH1cbn07XG5cblByb21pc2UucHJvdG90eXBlLl9wcm9wYWdhdGVGcm9tID1cbmZ1bmN0aW9uIFByb21pc2UkX3Byb3BhZ2F0ZUZyb20ocGFyZW50LCBmbGFncykge1xuICAgIGlmICgoZmxhZ3MgJiAxKSA+IDAgJiYgcGFyZW50Ll9jYW5jZWxsYWJsZSgpKSB7XG4gICAgICAgIHRoaXMuX3NldENhbmNlbGxhYmxlKCk7XG4gICAgICAgIHRoaXMuX2NhbmNlbGxhdGlvblBhcmVudCA9IHBhcmVudDtcbiAgICB9XG4gICAgaWYgKChmbGFncyAmIDQpID4gMCkge1xuICAgICAgICB0aGlzLl9zZXRCb3VuZFRvKHBhcmVudC5fYm91bmRUbyk7XG4gICAgfVxuICAgIGlmICgoZmxhZ3MgJiAyKSA+IDApIHtcbiAgICAgICAgdGhpcy5fc2V0VHJhY2UocGFyZW50KTtcbiAgICB9XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fZnVsZmlsbCA9IGZ1bmN0aW9uIFByb21pc2UkX2Z1bGZpbGwodmFsdWUpIHtcbiAgICBpZiAodGhpcy5faXNGb2xsb3dpbmdPckZ1bGZpbGxlZE9yUmVqZWN0ZWQoKSkgcmV0dXJuO1xuICAgIHRoaXMuX2Z1bGZpbGxVbmNoZWNrZWQodmFsdWUpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3JlamVjdCA9XG5mdW5jdGlvbiBQcm9taXNlJF9yZWplY3QocmVhc29uLCBjYXJyaWVkU3RhY2tUcmFjZSkge1xuICAgIGlmICh0aGlzLl9pc0ZvbGxvd2luZ09yRnVsZmlsbGVkT3JSZWplY3RlZCgpKSByZXR1cm47XG4gICAgdGhpcy5fcmVqZWN0VW5jaGVja2VkKHJlYXNvbiwgY2FycmllZFN0YWNrVHJhY2UpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3NldHRsZVByb21pc2VBdCA9IGZ1bmN0aW9uIFByb21pc2UkX3NldHRsZVByb21pc2VBdChpbmRleCkge1xuICAgIHZhciBoYW5kbGVyID0gdGhpcy5pc0Z1bGZpbGxlZCgpXG4gICAgICAgID8gdGhpcy5fZnVsZmlsbG1lbnRIYW5kbGVyQXQoaW5kZXgpXG4gICAgICAgIDogdGhpcy5fcmVqZWN0aW9uSGFuZGxlckF0KGluZGV4KTtcblxuICAgIHZhciB2YWx1ZSA9IHRoaXMuX3NldHRsZWRWYWx1ZTtcbiAgICB2YXIgcmVjZWl2ZXIgPSB0aGlzLl9yZWNlaXZlckF0KGluZGV4KTtcbiAgICB2YXIgcHJvbWlzZSA9IHRoaXMuX3Byb21pc2VBdChpbmRleCk7XG5cbiAgICBpZiAodHlwZW9mIGhhbmRsZXIgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICB0aGlzLl9zZXR0bGVQcm9taXNlRnJvbUhhbmRsZXIoaGFuZGxlciwgcmVjZWl2ZXIsIHZhbHVlLCBwcm9taXNlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgZG9uZSA9IGZhbHNlO1xuICAgICAgICB2YXIgaXNGdWxmaWxsZWQgPSB0aGlzLmlzRnVsZmlsbGVkKCk7XG4gICAgICAgIGlmIChyZWNlaXZlciAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgICBpZiAocmVjZWl2ZXIgaW5zdGFuY2VvZiBQcm9taXNlICYmXG4gICAgICAgICAgICAgICAgcmVjZWl2ZXIuX2lzUHJveGllZCgpKSB7XG4gICAgICAgICAgICAgICAgcmVjZWl2ZXIuX3Vuc2V0UHJveGllZCgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGlzRnVsZmlsbGVkKSByZWNlaXZlci5fZnVsZmlsbFVuY2hlY2tlZCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgZWxzZSByZWNlaXZlci5fcmVqZWN0VW5jaGVja2VkKHZhbHVlLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9nZXRDYXJyaWVkU3RhY2tUcmFjZSgpKTtcbiAgICAgICAgICAgICAgICBkb25lID0gdHJ1ZTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVjZWl2ZXIgaW5zdGFuY2VvZiBQcm9taXNlQXJyYXkpIHtcbiAgICAgICAgICAgICAgICBpZiAoaXNGdWxmaWxsZWQpIHJlY2VpdmVyLl9wcm9taXNlRnVsZmlsbGVkKHZhbHVlLCBwcm9taXNlKTtcbiAgICAgICAgICAgICAgICBlbHNlIHJlY2VpdmVyLl9wcm9taXNlUmVqZWN0ZWQodmFsdWUsIHByb21pc2UpO1xuICAgICAgICAgICAgICAgIGRvbmUgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFkb25lKSB7XG4gICAgICAgICAgICBpZiAoaXNGdWxmaWxsZWQpIHByb21pc2UuX2Z1bGZpbGwodmFsdWUpO1xuICAgICAgICAgICAgZWxzZSBwcm9taXNlLl9yZWplY3QodmFsdWUsIHRoaXMuX2dldENhcnJpZWRTdGFja1RyYWNlKCkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGluZGV4ID49IDI1Nikge1xuICAgICAgICB0aGlzLl9xdWV1ZUdDKCk7XG4gICAgfVxufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2lzUHJveGllZCA9IGZ1bmN0aW9uIFByb21pc2UkX2lzUHJveGllZCgpIHtcbiAgICByZXR1cm4gKHRoaXMuX2JpdEZpZWxkICYgNDE5NDMwNCkgPT09IDQxOTQzMDQ7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fc2V0UHJveGllZCA9IGZ1bmN0aW9uIFByb21pc2UkX3NldFByb3hpZWQoKSB7XG4gICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCB8IDQxOTQzMDQ7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fdW5zZXRQcm94aWVkID0gZnVuY3Rpb24gUHJvbWlzZSRfdW5zZXRQcm94aWVkKCkge1xuICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgJiAofjQxOTQzMDQpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2lzR2NRdWV1ZWQgPSBmdW5jdGlvbiBQcm9taXNlJF9pc0djUXVldWVkKCkge1xuICAgIHJldHVybiAodGhpcy5fYml0RmllbGQgJiAtMTA3Mzc0MTgyNCkgPT09IC0xMDczNzQxODI0O1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3NldEdjUXVldWVkID0gZnVuY3Rpb24gUHJvbWlzZSRfc2V0R2NRdWV1ZWQoKSB7XG4gICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCB8IC0xMDczNzQxODI0O1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3Vuc2V0R2NRdWV1ZWQgPSBmdW5jdGlvbiBQcm9taXNlJF91bnNldEdjUXVldWVkKCkge1xuICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgJiAofi0xMDczNzQxODI0KTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9xdWV1ZUdDID0gZnVuY3Rpb24gUHJvbWlzZSRfcXVldWVHQygpIHtcbiAgICBpZiAodGhpcy5faXNHY1F1ZXVlZCgpKSByZXR1cm47XG4gICAgdGhpcy5fc2V0R2NRdWV1ZWQoKTtcbiAgICBhc3luYy5pbnZva2VMYXRlcih0aGlzLl9nYywgdGhpcywgdm9pZCAwKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9nYyA9IGZ1bmN0aW9uIFByb21pc2UkZ2MoKSB7XG4gICAgdmFyIGxlbiA9IHRoaXMuX2xlbmd0aCgpICogNTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGRlbGV0ZSB0aGlzW2ldO1xuICAgIH1cbiAgICB0aGlzLl9zZXRMZW5ndGgoMCk7XG4gICAgdGhpcy5fdW5zZXRHY1F1ZXVlZCgpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3F1ZXVlU2V0dGxlQXQgPSBmdW5jdGlvbiBQcm9taXNlJF9xdWV1ZVNldHRsZUF0KGluZGV4KSB7XG4gICAgaWYgKHRoaXMuX2lzUmVqZWN0aW9uVW5oYW5kbGVkKCkpIHRoaXMuX3Vuc2V0UmVqZWN0aW9uSXNVbmhhbmRsZWQoKTtcbiAgICBhc3luYy5pbnZva2UodGhpcy5fc2V0dGxlUHJvbWlzZUF0LCB0aGlzLCBpbmRleCk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fZnVsZmlsbFVuY2hlY2tlZCA9XG5mdW5jdGlvbiBQcm9taXNlJF9mdWxmaWxsVW5jaGVja2VkKHZhbHVlKSB7XG4gICAgaWYgKCF0aGlzLmlzUGVuZGluZygpKSByZXR1cm47XG4gICAgaWYgKHZhbHVlID09PSB0aGlzKSB7XG4gICAgICAgIHZhciBlcnIgPSBtYWtlU2VsZlJlc29sdXRpb25FcnJvcigpO1xuICAgICAgICB0aGlzLl9hdHRhY2hFeHRyYVRyYWNlKGVycik7XG4gICAgICAgIHJldHVybiB0aGlzLl9yZWplY3RVbmNoZWNrZWQoZXJyLCB2b2lkIDApO1xuICAgIH1cbiAgICB0aGlzLl9jbGVhblZhbHVlcygpO1xuICAgIHRoaXMuX3NldEZ1bGZpbGxlZCgpO1xuICAgIHRoaXMuX3NldHRsZWRWYWx1ZSA9IHZhbHVlO1xuICAgIHZhciBsZW4gPSB0aGlzLl9sZW5ndGgoKTtcblxuICAgIGlmIChsZW4gPiAwKSB7XG4gICAgICAgIGFzeW5jLmludm9rZSh0aGlzLl9zZXR0bGVQcm9taXNlcywgdGhpcywgbGVuKTtcbiAgICB9XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fcmVqZWN0VW5jaGVja2VkQ2hlY2tFcnJvciA9XG5mdW5jdGlvbiBQcm9taXNlJF9yZWplY3RVbmNoZWNrZWRDaGVja0Vycm9yKHJlYXNvbikge1xuICAgIHZhciB0cmFjZSA9IGNhbkF0dGFjaChyZWFzb24pID8gcmVhc29uIDogbmV3IEVycm9yKHJlYXNvbiArIFwiXCIpO1xuICAgIHRoaXMuX3JlamVjdFVuY2hlY2tlZChyZWFzb24sIHRyYWNlID09PSByZWFzb24gPyB2b2lkIDAgOiB0cmFjZSk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fcmVqZWN0VW5jaGVja2VkID1cbmZ1bmN0aW9uIFByb21pc2UkX3JlamVjdFVuY2hlY2tlZChyZWFzb24sIHRyYWNlKSB7XG4gICAgaWYgKCF0aGlzLmlzUGVuZGluZygpKSByZXR1cm47XG4gICAgaWYgKHJlYXNvbiA9PT0gdGhpcykge1xuICAgICAgICB2YXIgZXJyID0gbWFrZVNlbGZSZXNvbHV0aW9uRXJyb3IoKTtcbiAgICAgICAgdGhpcy5fYXR0YWNoRXh0cmFUcmFjZShlcnIpO1xuICAgICAgICByZXR1cm4gdGhpcy5fcmVqZWN0VW5jaGVja2VkKGVycik7XG4gICAgfVxuICAgIHRoaXMuX2NsZWFuVmFsdWVzKCk7XG4gICAgdGhpcy5fc2V0UmVqZWN0ZWQoKTtcbiAgICB0aGlzLl9zZXR0bGVkVmFsdWUgPSByZWFzb247XG5cbiAgICBpZiAodGhpcy5faXNGaW5hbCgpKSB7XG4gICAgICAgIGFzeW5jLmludm9rZUxhdGVyKHRocm93ZXIsIHZvaWQgMCwgdHJhY2UgPT09IHZvaWQgMCA/IHJlYXNvbiA6IHRyYWNlKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgbGVuID0gdGhpcy5fbGVuZ3RoKCk7XG5cbiAgICBpZiAodHJhY2UgIT09IHZvaWQgMCkgdGhpcy5fc2V0Q2FycmllZFN0YWNrVHJhY2UodHJhY2UpO1xuXG4gICAgaWYgKGxlbiA+IDApIHtcbiAgICAgICAgYXN5bmMuaW52b2tlKHRoaXMuX3JlamVjdFByb21pc2VzLCB0aGlzLCBudWxsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl9lbnN1cmVQb3NzaWJsZVJlamVjdGlvbkhhbmRsZWQoKTtcbiAgICB9XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fcmVqZWN0UHJvbWlzZXMgPSBmdW5jdGlvbiBQcm9taXNlJF9yZWplY3RQcm9taXNlcygpIHtcbiAgICB0aGlzLl9zZXR0bGVQcm9taXNlcygpO1xuICAgIHRoaXMuX3Vuc2V0Q2FycmllZFN0YWNrVHJhY2UoKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9zZXR0bGVQcm9taXNlcyA9IGZ1bmN0aW9uIFByb21pc2UkX3NldHRsZVByb21pc2VzKCkge1xuICAgIHZhciBsZW4gPSB0aGlzLl9sZW5ndGgoKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIHRoaXMuX3NldHRsZVByb21pc2VBdChpKTtcbiAgICB9XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fZW5zdXJlUG9zc2libGVSZWplY3Rpb25IYW5kbGVkID1cbmZ1bmN0aW9uIFByb21pc2UkX2Vuc3VyZVBvc3NpYmxlUmVqZWN0aW9uSGFuZGxlZCgpIHtcbiAgICB0aGlzLl9zZXRSZWplY3Rpb25Jc1VuaGFuZGxlZCgpO1xuICAgIGlmIChDYXB0dXJlZFRyYWNlLnBvc3NpYmx5VW5oYW5kbGVkUmVqZWN0aW9uICE9PSB2b2lkIDApIHtcbiAgICAgICAgYXN5bmMuaW52b2tlTGF0ZXIodGhpcy5fbm90aWZ5VW5oYW5kbGVkUmVqZWN0aW9uLCB0aGlzLCB2b2lkIDApO1xuICAgIH1cbn07XG5cblByb21pc2UucHJvdG90eXBlLl9ub3RpZnlVbmhhbmRsZWRSZWplY3Rpb25Jc0hhbmRsZWQgPVxuZnVuY3Rpb24gUHJvbWlzZSRfbm90aWZ5VW5oYW5kbGVkUmVqZWN0aW9uSXNIYW5kbGVkKCkge1xuICAgIGlmICh0eXBlb2YgdW5oYW5kbGVkUmVqZWN0aW9uSGFuZGxlZCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIGFzeW5jLmludm9rZUxhdGVyKHVuaGFuZGxlZFJlamVjdGlvbkhhbmRsZWQsIHZvaWQgMCwgdGhpcyk7XG4gICAgfVxufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX25vdGlmeVVuaGFuZGxlZFJlamVjdGlvbiA9XG5mdW5jdGlvbiBQcm9taXNlJF9ub3RpZnlVbmhhbmRsZWRSZWplY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMuX2lzUmVqZWN0aW9uVW5oYW5kbGVkKCkpIHtcbiAgICAgICAgdmFyIHJlYXNvbiA9IHRoaXMuX3NldHRsZWRWYWx1ZTtcbiAgICAgICAgdmFyIHRyYWNlID0gdGhpcy5fZ2V0Q2FycmllZFN0YWNrVHJhY2UoKTtcblxuICAgICAgICB0aGlzLl9zZXRVbmhhbmRsZWRSZWplY3Rpb25Jc05vdGlmaWVkKCk7XG5cbiAgICAgICAgaWYgKHRyYWNlICE9PSB2b2lkIDApIHtcbiAgICAgICAgICAgIHRoaXMuX3Vuc2V0Q2FycmllZFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgIHJlYXNvbiA9IHRyYWNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgQ2FwdHVyZWRUcmFjZS5wb3NzaWJseVVuaGFuZGxlZFJlamVjdGlvbiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICBDYXB0dXJlZFRyYWNlLnBvc3NpYmx5VW5oYW5kbGVkUmVqZWN0aW9uKHJlYXNvbiwgdGhpcyk7XG4gICAgICAgIH1cbiAgICB9XG59O1xuXG52YXIgY29udGV4dFN0YWNrID0gW107XG5Qcm9taXNlLnByb3RvdHlwZS5fcGVla0NvbnRleHQgPSBmdW5jdGlvbiBQcm9taXNlJF9wZWVrQ29udGV4dCgpIHtcbiAgICB2YXIgbGFzdEluZGV4ID0gY29udGV4dFN0YWNrLmxlbmd0aCAtIDE7XG4gICAgaWYgKGxhc3RJbmRleCA+PSAwKSB7XG4gICAgICAgIHJldHVybiBjb250ZXh0U3RhY2tbbGFzdEluZGV4XTtcbiAgICB9XG4gICAgcmV0dXJuIHZvaWQgMDtcblxufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3B1c2hDb250ZXh0ID0gZnVuY3Rpb24gUHJvbWlzZSRfcHVzaENvbnRleHQoKSB7XG4gICAgaWYgKCFkZWJ1Z2dpbmcpIHJldHVybjtcbiAgICBjb250ZXh0U3RhY2sucHVzaCh0aGlzKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9wb3BDb250ZXh0ID0gZnVuY3Rpb24gUHJvbWlzZSRfcG9wQ29udGV4dCgpIHtcbiAgICBpZiAoIWRlYnVnZ2luZykgcmV0dXJuO1xuICAgIGNvbnRleHRTdGFjay5wb3AoKTtcbn07XG5cblByb21pc2Uubm9Db25mbGljdCA9IGZ1bmN0aW9uIFByb21pc2UkTm9Db25mbGljdCgpIHtcbiAgICByZXR1cm4gbm9Db25mbGljdChQcm9taXNlKTtcbn07XG5cblByb21pc2Uuc2V0U2NoZWR1bGVyID0gZnVuY3Rpb24oZm4pIHtcbiAgICBpZiAodHlwZW9mIGZuICE9PSBcImZ1bmN0aW9uXCIpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJmbiBtdXN0IGJlIGEgZnVuY3Rpb25cIik7XG4gICAgYXN5bmMuX3NjaGVkdWxlID0gZm47XG59O1xuXG5pZiAoIUNhcHR1cmVkVHJhY2UuaXNTdXBwb3J0ZWQoKSkge1xuICAgIFByb21pc2UubG9uZ1N0YWNrVHJhY2VzID0gZnVuY3Rpb24oKXt9O1xuICAgIGRlYnVnZ2luZyA9IGZhbHNlO1xufVxuXG5Qcm9taXNlLl9tYWtlU2VsZlJlc29sdXRpb25FcnJvciA9IG1ha2VTZWxmUmVzb2x1dGlvbkVycm9yO1xucmVxdWlyZShcIi4vZmluYWxseS5qc1wiKShQcm9taXNlLCBORVhUX0ZJTFRFUiwgY2FzdCk7XG5yZXF1aXJlKFwiLi9kaXJlY3RfcmVzb2x2ZS5qc1wiKShQcm9taXNlKTtcbnJlcXVpcmUoXCIuL3N5bmNocm9ub3VzX2luc3BlY3Rpb24uanNcIikoUHJvbWlzZSk7XG5yZXF1aXJlKFwiLi9qb2luLmpzXCIpKFByb21pc2UsIFByb21pc2VBcnJheSwgY2FzdCwgSU5URVJOQUwpO1xuUHJvbWlzZS5SYW5nZUVycm9yID0gUmFuZ2VFcnJvcjtcblByb21pc2UuQ2FuY2VsbGF0aW9uRXJyb3IgPSBDYW5jZWxsYXRpb25FcnJvcjtcblByb21pc2UuVGltZW91dEVycm9yID0gVGltZW91dEVycm9yO1xuUHJvbWlzZS5UeXBlRXJyb3IgPSBUeXBlRXJyb3I7XG5Qcm9taXNlLk9wZXJhdGlvbmFsRXJyb3IgPSBPcGVyYXRpb25hbEVycm9yO1xuUHJvbWlzZS5SZWplY3Rpb25FcnJvciA9IE9wZXJhdGlvbmFsRXJyb3I7XG5Qcm9taXNlLkFnZ3JlZ2F0ZUVycm9yID0gZXJyb3JzLkFnZ3JlZ2F0ZUVycm9yO1xuXG51dGlsLnRvRmFzdFByb3BlcnRpZXMoUHJvbWlzZSk7XG51dGlsLnRvRmFzdFByb3BlcnRpZXMoUHJvbWlzZS5wcm90b3R5cGUpO1xuUHJvbWlzZS5Qcm9taXNlID0gUHJvbWlzZTtcbnJlcXVpcmUoJy4vdGltZXJzLmpzJykoUHJvbWlzZSxJTlRFUk5BTCxjYXN0KTtcbnJlcXVpcmUoJy4vcmFjZS5qcycpKFByb21pc2UsSU5URVJOQUwsY2FzdCk7XG5yZXF1aXJlKCcuL2NhbGxfZ2V0LmpzJykoUHJvbWlzZSk7XG5yZXF1aXJlKCcuL2dlbmVyYXRvcnMuanMnKShQcm9taXNlLGFwaVJlamVjdGlvbixJTlRFUk5BTCxjYXN0KTtcbnJlcXVpcmUoJy4vbWFwLmpzJykoUHJvbWlzZSxQcm9taXNlQXJyYXksYXBpUmVqZWN0aW9uLGNhc3QsSU5URVJOQUwpO1xucmVxdWlyZSgnLi9ub2RlaWZ5LmpzJykoUHJvbWlzZSk7XG5yZXF1aXJlKCcuL3Byb21pc2lmeS5qcycpKFByb21pc2UsSU5URVJOQUwpO1xucmVxdWlyZSgnLi9wcm9wcy5qcycpKFByb21pc2UsUHJvbWlzZUFycmF5LGNhc3QpO1xucmVxdWlyZSgnLi9yZWR1Y2UuanMnKShQcm9taXNlLFByb21pc2VBcnJheSxhcGlSZWplY3Rpb24sY2FzdCxJTlRFUk5BTCk7XG5yZXF1aXJlKCcuL3NldHRsZS5qcycpKFByb21pc2UsUHJvbWlzZUFycmF5KTtcbnJlcXVpcmUoJy4vc29tZS5qcycpKFByb21pc2UsUHJvbWlzZUFycmF5LGFwaVJlamVjdGlvbik7XG5yZXF1aXJlKCcuL3Byb2dyZXNzLmpzJykoUHJvbWlzZSxQcm9taXNlQXJyYXkpO1xucmVxdWlyZSgnLi9jYW5jZWwuanMnKShQcm9taXNlLElOVEVSTkFMKTtcbnJlcXVpcmUoJy4vZmlsdGVyLmpzJykoUHJvbWlzZSxJTlRFUk5BTCk7XG5yZXF1aXJlKCcuL2FueS5qcycpKFByb21pc2UsUHJvbWlzZUFycmF5KTtcbnJlcXVpcmUoJy4vZWFjaC5qcycpKFByb21pc2UsSU5URVJOQUwpO1xucmVxdWlyZSgnLi91c2luZy5qcycpKFByb21pc2UsYXBpUmVqZWN0aW9uLGNhc3QpO1xuXG5Qcm9taXNlLnByb3RvdHlwZSA9IFByb21pc2UucHJvdG90eXBlO1xucmV0dXJuIFByb21pc2U7XG5cbn07XG5cbn0pKHJlcXVpcmUoXCJfX2Jyb3dzZXJpZnlfcHJvY2Vzc1wiKSkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgX1xuKSB7XG5cbiAgLyoqXG4gICAqIEEgYmFzaWMgUmVmIHNlcnZlcyBhcyBhIG1lYW5zIG9mIGluZGlyZWN0aW9uIGJldHdlZW4gcmVmZXJlbmNlcyBhbmQgdGhlaXJcbiAgICogdmFsdWVzLCBhbGxvd2luZyBhbiBvdXRzaWRlIGFnZW50IHRvIG1vZGlmeSB0aGUgdW5kZXJseWluZyB2YWx1ZS5cbiAgICovXG4gIHZhciBSZWYgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChSZWYucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24odmFsKSB7XG4gICAgICB0aGlzLl92YWwgPSB2YWw7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgdmFsdWUgYm94ZWQgYnkgdGhpcyBSZWZcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtkeW5hbWljfVxuICAgICAqL1xuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fdmFsO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBTZXQgYSBuZXcgYm94ZWQgdmFsdWUuIE5vdGUgdGhpcyBtZXRob2QgaXMgc3BlY2lmaWMgdG8gdGhpcyBSZWZcbiAgICAgKiBpbXBsZW1lbnRhdGlvbiwgYW5kIG5vdCB0aGUgUmVmIHByb3RvY29sLCB3aGljaCBvbmx5IGRlZmluZXNcbiAgICAgKiBgUmVmI2dldCgpYC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBuZXdWYWwge2R5bmFtaWN9IHRoZSB2YWx1ZSB0byBib3hcbiAgICAgKi9cbiAgICBzZXQ6IGZ1bmN0aW9uKG5ld1ZhbCkge1xuICAgICAgaWYgKG5ld1ZhbCBpbnN0YW5jZW9mIFJlZikge1xuICAgICAgICB0aGlzLl92YWwgPSBuZXdWYWwuZ2V0KCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl92YWwgPSBuZXdWYWw7XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gUmVmO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF9cbikge1xuXG4gIC8qKlxuICAgKiBBIHJlZiB3aG9zZSBib3hlZCB2YWx1ZSBpcyBhbm90aGVyIHJlZlxuICAgKi9cbiAgdmFyIERlbGVnYXRpbmdSZWYgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChEZWxlZ2F0aW5nUmVmLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKHJlZikge1xuICAgICAgdGhpcy5fZGVsZWdhdGVSZWYgPSByZWY7XG4gICAgfSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2RlbGVnYXRlUmVmLmdldCgpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIERlbGVnYXRpbmdSZWY7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgX1xuKSB7XG5cbiAgdmFyIE1UeXBlID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoTVR5cGUucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7fVxuICB9KTtcblxuICBfLmV4dGVuZChNVHlwZSwge1xuICAgIG1ha2U6IGZ1bmN0aW9uKG5hbWUsIG9iaikge1xuICAgICAgcmV0dXJuIF8uZXh0ZW5kKHt9LCBvYmosIHtcbiAgICAgICAgbVQ6IG5hbWVcbiAgICAgIH0pO1xuICAgIH1cbiAgfSlcblxuICByZXR1cm4gTVR5cGU7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIilcbik7XG5cbn0pKCkiLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlKSB7XG5mdW5jdGlvbiBQcm9taXNlSW5zcGVjdGlvbihwcm9taXNlKSB7XG4gICAgaWYgKHByb21pc2UgIT09IHZvaWQgMCkge1xuICAgICAgICB0aGlzLl9iaXRGaWVsZCA9IHByb21pc2UuX2JpdEZpZWxkO1xuICAgICAgICB0aGlzLl9zZXR0bGVkVmFsdWUgPSBwcm9taXNlLmlzUmVzb2x2ZWQoKVxuICAgICAgICAgICAgPyBwcm9taXNlLl9zZXR0bGVkVmFsdWVcbiAgICAgICAgICAgIDogdm9pZCAwO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdGhpcy5fYml0RmllbGQgPSAwO1xuICAgICAgICB0aGlzLl9zZXR0bGVkVmFsdWUgPSB2b2lkIDA7XG4gICAgfVxufVxuXG5Qcm9taXNlSW5zcGVjdGlvbi5wcm90b3R5cGUuaXNGdWxmaWxsZWQgPVxuUHJvbWlzZS5wcm90b3R5cGUuaXNGdWxmaWxsZWQgPSBmdW5jdGlvbiBQcm9taXNlJGlzRnVsZmlsbGVkKCkge1xuICAgIHJldHVybiAodGhpcy5fYml0RmllbGQgJiAyNjg0MzU0NTYpID4gMDtcbn07XG5cblByb21pc2VJbnNwZWN0aW9uLnByb3RvdHlwZS5pc1JlamVjdGVkID1cblByb21pc2UucHJvdG90eXBlLmlzUmVqZWN0ZWQgPSBmdW5jdGlvbiBQcm9taXNlJGlzUmVqZWN0ZWQoKSB7XG4gICAgcmV0dXJuICh0aGlzLl9iaXRGaWVsZCAmIDEzNDIxNzcyOCkgPiAwO1xufTtcblxuUHJvbWlzZUluc3BlY3Rpb24ucHJvdG90eXBlLmlzUGVuZGluZyA9XG5Qcm9taXNlLnByb3RvdHlwZS5pc1BlbmRpbmcgPSBmdW5jdGlvbiBQcm9taXNlJGlzUGVuZGluZygpIHtcbiAgICByZXR1cm4gKHRoaXMuX2JpdEZpZWxkICYgNDAyNjUzMTg0KSA9PT0gMDtcbn07XG5cblByb21pc2VJbnNwZWN0aW9uLnByb3RvdHlwZS52YWx1ZSA9XG5Qcm9taXNlLnByb3RvdHlwZS52YWx1ZSA9IGZ1bmN0aW9uIFByb21pc2UkdmFsdWUoKSB7XG4gICAgaWYgKCF0aGlzLmlzRnVsZmlsbGVkKCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcImNhbm5vdCBnZXQgZnVsZmlsbG1lbnQgdmFsdWUgb2YgYSBub24tZnVsZmlsbGVkIHByb21pc2VcIik7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLl9zZXR0bGVkVmFsdWU7XG59O1xuXG5Qcm9taXNlSW5zcGVjdGlvbi5wcm90b3R5cGUuZXJyb3IgPVxuUHJvbWlzZUluc3BlY3Rpb24ucHJvdG90eXBlLnJlYXNvbiA9XG5Qcm9taXNlLnByb3RvdHlwZS5yZWFzb24gPSBmdW5jdGlvbiBQcm9taXNlJHJlYXNvbigpIHtcbiAgICBpZiAoIXRoaXMuaXNSZWplY3RlZCgpKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJjYW5ub3QgZ2V0IHJlamVjdGlvbiByZWFzb24gb2YgYSBub24tcmVqZWN0ZWQgcHJvbWlzZVwiKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuX3NldHRsZWRWYWx1ZTtcbn07XG5cblByb21pc2VJbnNwZWN0aW9uLnByb3RvdHlwZS5pc1Jlc29sdmVkID1cblByb21pc2UucHJvdG90eXBlLmlzUmVzb2x2ZWQgPSBmdW5jdGlvbiBQcm9taXNlJGlzUmVzb2x2ZWQoKSB7XG4gICAgcmV0dXJuICh0aGlzLl9iaXRGaWVsZCAmIDQwMjY1MzE4NCkgPiAwO1xufTtcblxuUHJvbWlzZS5Qcm9taXNlSW5zcGVjdGlvbiA9IFByb21pc2VJbnNwZWN0aW9uO1xufTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UsIElOVEVSTkFMKSB7XG52YXIgUHJvbWlzZU1hcCA9IFByb21pc2UubWFwO1xuXG5Qcm9taXNlLnByb3RvdHlwZS5maWx0ZXIgPSBmdW5jdGlvbiBQcm9taXNlJGZpbHRlcihmbiwgb3B0aW9ucykge1xuICAgIHJldHVybiBQcm9taXNlTWFwKHRoaXMsIGZuLCBvcHRpb25zLCBJTlRFUk5BTCk7XG59O1xuXG5Qcm9taXNlLmZpbHRlciA9IGZ1bmN0aW9uIFByb21pc2UkRmlsdGVyKHByb21pc2VzLCBmbiwgb3B0aW9ucykge1xuICAgIHJldHVybiBQcm9taXNlTWFwKHByb21pc2VzLCBmbiwgb3B0aW9ucywgSU5URVJOQUwpO1xufTtcbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlKSB7XG52YXIgU29tZVByb21pc2VBcnJheSA9IFByb21pc2UuX1NvbWVQcm9taXNlQXJyYXk7XG5mdW5jdGlvbiBQcm9taXNlJF9BbnkocHJvbWlzZXMpIHtcbiAgICB2YXIgcmV0ID0gbmV3IFNvbWVQcm9taXNlQXJyYXkocHJvbWlzZXMpO1xuICAgIHZhciBwcm9taXNlID0gcmV0LnByb21pc2UoKTtcbiAgICBpZiAocHJvbWlzZS5pc1JlamVjdGVkKCkpIHtcbiAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgfVxuICAgIHJldC5zZXRIb3dNYW55KDEpO1xuICAgIHJldC5zZXRVbndyYXAoKTtcbiAgICByZXQuaW5pdCgpO1xuICAgIHJldHVybiBwcm9taXNlO1xufVxuXG5Qcm9taXNlLmFueSA9IGZ1bmN0aW9uIFByb21pc2UkQW55KHByb21pc2VzKSB7XG4gICAgcmV0dXJuIFByb21pc2UkX0FueShwcm9taXNlcyk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5hbnkgPSBmdW5jdGlvbiBQcm9taXNlJGFueSgpIHtcbiAgICByZXR1cm4gUHJvbWlzZSRfQW55KHRoaXMpO1xufTtcblxufTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UsIElOVEVSTkFMKSB7XG52YXIgUHJvbWlzZVJlZHVjZSA9IFByb21pc2UucmVkdWNlO1xuXG5Qcm9taXNlLnByb3RvdHlwZS5lYWNoID0gZnVuY3Rpb24gUHJvbWlzZSRlYWNoKGZuKSB7XG4gICAgcmV0dXJuIFByb21pc2VSZWR1Y2UodGhpcywgZm4sIG51bGwsIElOVEVSTkFMKTtcbn07XG5cblByb21pc2UuZWFjaCA9IGZ1bmN0aW9uIFByb21pc2UkRWFjaChwcm9taXNlcywgZm4pIHtcbiAgICByZXR1cm4gUHJvbWlzZVJlZHVjZShwcm9taXNlcywgZm4sIG51bGwsIElOVEVSTkFMKTtcbn07XG59O1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgX1xuKSB7XG5cbiAgdmFyIFNldFRpbWVvdXRTY2hlZHVsZXIgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfVxuXG4gIF8uZXh0ZW5kKFNldFRpbWVvdXRTY2hlZHVsZXIucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7fSxcblxuICAgIHJ1blNvb246IGZ1bmN0aW9uKGZuKSB7XG4gICAgICB0aGlzLnNjaGVkdWxlKGZuKTtcbiAgICB9LFxuICAgIHNjaGVkdWxlOiBmdW5jdGlvbihmbiwgZGVsYXkpIHtcbiAgICAgIGRlbGF5ID0gZGVsYXkgfHwgMTtcbiAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZuLCBkZWxheSk7XG4gICAgfSxcblxuICAgIHVuc2NoZWR1bGU6IGZ1bmN0aW9uKGlkKSB7XG4gICAgICByZXR1cm4gY2xlYXJUaW1lb3V0KGlkKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBTZXRUaW1lb3V0U2NoZWR1bGVyO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpXG4pO1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbnZhciBlczUgPSByZXF1aXJlKFwiLi9lczUuanNcIik7XG52YXIgaGF2ZUdldHRlcnMgPSAoZnVuY3Rpb24oKXtcbiAgICB0cnkge1xuICAgICAgICB2YXIgbyA9IHt9O1xuICAgICAgICBlczUuZGVmaW5lUHJvcGVydHkobywgXCJmXCIsIHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIG8uZiA9PT0gMztcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxufSkoKTtcbnZhciBjYW5FdmFsdWF0ZSA9IHR5cGVvZiBuYXZpZ2F0b3IgPT0gXCJ1bmRlZmluZWRcIjtcbnZhciBlcnJvck9iaiA9IHtlOiB7fX07XG5mdW5jdGlvbiB0cnlDYXRjaDEoZm4sIHJlY2VpdmVyLCBhcmcpIHtcbiAgICB0cnkgeyByZXR1cm4gZm4uY2FsbChyZWNlaXZlciwgYXJnKTsgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIGVycm9yT2JqLmUgPSBlO1xuICAgICAgICByZXR1cm4gZXJyb3JPYmo7XG4gICAgfVxufVxuXG5mdW5jdGlvbiB0cnlDYXRjaDIoZm4sIHJlY2VpdmVyLCBhcmcsIGFyZzIpIHtcbiAgICB0cnkgeyByZXR1cm4gZm4uY2FsbChyZWNlaXZlciwgYXJnLCBhcmcyKTsgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIGVycm9yT2JqLmUgPSBlO1xuICAgICAgICByZXR1cm4gZXJyb3JPYmo7XG4gICAgfVxufVxuXG5mdW5jdGlvbiB0cnlDYXRjaDMoZm4sIHJlY2VpdmVyLCBhcmcsIGFyZzIsIGFyZzMpIHtcbiAgICB0cnkgeyByZXR1cm4gZm4uY2FsbChyZWNlaXZlciwgYXJnLCBhcmcyLCBhcmczKTsgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIGVycm9yT2JqLmUgPSBlO1xuICAgICAgICByZXR1cm4gZXJyb3JPYmo7XG4gICAgfVxufVxuXG5mdW5jdGlvbiB0cnlDYXRjaDQoZm4sIHJlY2VpdmVyLCBhcmcsIGFyZzIsIGFyZzMsIGFyZzQpIHtcbiAgICB0cnkgeyByZXR1cm4gZm4uY2FsbChyZWNlaXZlciwgYXJnLCBhcmcyLCBhcmczLCBhcmc0KTsgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIGVycm9yT2JqLmUgPSBlO1xuICAgICAgICByZXR1cm4gZXJyb3JPYmo7XG4gICAgfVxufVxuXG5mdW5jdGlvbiB0cnlDYXRjaEFwcGx5KGZuLCBhcmdzLCByZWNlaXZlcikge1xuICAgIHRyeSB7IHJldHVybiBmbi5hcHBseShyZWNlaXZlciwgYXJncyk7IH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICBlcnJvck9iai5lID0gZTtcbiAgICAgICAgcmV0dXJuIGVycm9yT2JqO1xuICAgIH1cbn1cblxudmFyIGluaGVyaXRzID0gZnVuY3Rpb24oQ2hpbGQsIFBhcmVudCkge1xuICAgIHZhciBoYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHk7XG5cbiAgICBmdW5jdGlvbiBUKCkge1xuICAgICAgICB0aGlzLmNvbnN0cnVjdG9yID0gQ2hpbGQ7XG4gICAgICAgIHRoaXMuY29uc3RydWN0b3IkID0gUGFyZW50O1xuICAgICAgICBmb3IgKHZhciBwcm9wZXJ0eU5hbWUgaW4gUGFyZW50LnByb3RvdHlwZSkge1xuICAgICAgICAgICAgaWYgKGhhc1Byb3AuY2FsbChQYXJlbnQucHJvdG90eXBlLCBwcm9wZXJ0eU5hbWUpICYmXG4gICAgICAgICAgICAgICAgcHJvcGVydHlOYW1lLmNoYXJBdChwcm9wZXJ0eU5hbWUubGVuZ3RoLTEpICE9PSBcIiRcIlxuICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICB0aGlzW3Byb3BlcnR5TmFtZSArIFwiJFwiXSA9IFBhcmVudC5wcm90b3R5cGVbcHJvcGVydHlOYW1lXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBULnByb3RvdHlwZSA9IFBhcmVudC5wcm90b3R5cGU7XG4gICAgQ2hpbGQucHJvdG90eXBlID0gbmV3IFQoKTtcbiAgICByZXR1cm4gQ2hpbGQucHJvdG90eXBlO1xufTtcblxuZnVuY3Rpb24gYXNTdHJpbmcodmFsKSB7XG4gICAgcmV0dXJuIHR5cGVvZiB2YWwgPT09IFwic3RyaW5nXCIgPyB2YWwgOiAoXCJcIiArIHZhbCk7XG59XG5cbmZ1bmN0aW9uIGlzUHJpbWl0aXZlKHZhbCkge1xuICAgIHJldHVybiB2YWwgPT0gbnVsbCB8fCB2YWwgPT09IHRydWUgfHwgdmFsID09PSBmYWxzZSB8fFxuICAgICAgICB0eXBlb2YgdmFsID09PSBcInN0cmluZ1wiIHx8IHR5cGVvZiB2YWwgPT09IFwibnVtYmVyXCI7XG5cbn1cblxuZnVuY3Rpb24gaXNPYmplY3QodmFsdWUpIHtcbiAgICByZXR1cm4gIWlzUHJpbWl0aXZlKHZhbHVlKTtcbn1cblxuZnVuY3Rpb24gbWF5YmVXcmFwQXNFcnJvcihtYXliZUVycm9yKSB7XG4gICAgaWYgKCFpc1ByaW1pdGl2ZShtYXliZUVycm9yKSkgcmV0dXJuIG1heWJlRXJyb3I7XG5cbiAgICByZXR1cm4gbmV3IEVycm9yKGFzU3RyaW5nKG1heWJlRXJyb3IpKTtcbn1cblxuZnVuY3Rpb24gd2l0aEFwcGVuZGVkKHRhcmdldCwgYXBwZW5kZWUpIHtcbiAgICB2YXIgbGVuID0gdGFyZ2V0Lmxlbmd0aDtcbiAgICB2YXIgcmV0ID0gbmV3IEFycmF5KGxlbiArIDEpO1xuICAgIHZhciBpO1xuICAgIGZvciAoaSA9IDA7IGkgPCBsZW47ICsraSkge1xuICAgICAgICByZXRbaV0gPSB0YXJnZXRbaV07XG4gICAgfVxuICAgIHJldFtpXSA9IGFwcGVuZGVlO1xuICAgIHJldHVybiByZXQ7XG59XG5cbmZ1bmN0aW9uIGdldERhdGFQcm9wZXJ0eU9yRGVmYXVsdChvYmosIGtleSwgZGVmYXVsdFZhbHVlKSB7XG4gICAgaWYgKGVzNS5pc0VTNSkge1xuICAgICAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpO1xuICAgICAgICBpZiAoZGVzYyAhPSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4gZGVzYy5nZXQgPT0gbnVsbCAmJiBkZXNjLnNldCA9PSBudWxsXG4gICAgICAgICAgICAgICAgICAgID8gZGVzYy52YWx1ZVxuICAgICAgICAgICAgICAgICAgICA6IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB7fS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSA/IG9ialtrZXldIDogdm9pZCAwO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gbm90RW51bWVyYWJsZVByb3Aob2JqLCBuYW1lLCB2YWx1ZSkge1xuICAgIGlmIChpc1ByaW1pdGl2ZShvYmopKSByZXR1cm4gb2JqO1xuICAgIHZhciBkZXNjcmlwdG9yID0ge1xuICAgICAgICB2YWx1ZTogdmFsdWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIHdyaXRhYmxlOiB0cnVlXG4gICAgfTtcbiAgICBlczUuZGVmaW5lUHJvcGVydHkob2JqLCBuYW1lLCBkZXNjcmlwdG9yKTtcbiAgICByZXR1cm4gb2JqO1xufVxuXG5cbnZhciB3cmFwc1ByaW1pdGl2ZVJlY2VpdmVyID0gKGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzICE9PSBcInN0cmluZ1wiO1xufSkuY2FsbChcInN0cmluZ1wiKTtcblxuZnVuY3Rpb24gdGhyb3dlcihyKSB7XG4gICAgdGhyb3cgcjtcbn1cblxudmFyIGluaGVyaXRlZERhdGFLZXlzID0gKGZ1bmN0aW9uKCkge1xuICAgIGlmIChlczUuaXNFUzUpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKG9iaiwgb3B0cykge1xuICAgICAgICAgICAgdmFyIHJldCA9IFtdO1xuICAgICAgICAgICAgdmFyIHZpc2l0ZWRLZXlzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICAgICAgICAgIHZhciBnZXRLZXlzID0gT2JqZWN0KG9wdHMpLmluY2x1ZGVIaWRkZW5cbiAgICAgICAgICAgICAgICA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzXG4gICAgICAgICAgICAgICAgOiBPYmplY3Qua2V5cztcbiAgICAgICAgICAgIHdoaWxlIChvYmogIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHZhciBrZXlzO1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGtleXMgPSBnZXRLZXlzKG9iaik7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGtleSA9IGtleXNbaV07XG4gICAgICAgICAgICAgICAgICAgIGlmICh2aXNpdGVkS2V5c1trZXldKSBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgdmlzaXRlZEtleXNba2V5XSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkZXNjICE9IG51bGwgJiYgZGVzYy5nZXQgPT0gbnVsbCAmJiBkZXNjLnNldCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXQucHVzaChrZXkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG9iaiA9IGVzNS5nZXRQcm90b3R5cGVPZihvYmopO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgICAgICB2YXIgcmV0ID0gW107XG4gICAgICAgICAgICAvKmpzaGludCBmb3JpbjpmYWxzZSAqL1xuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgICAgICAgICAgICAgIHJldC5wdXNoKGtleSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9O1xuICAgIH1cblxufSkoKTtcblxuZnVuY3Rpb24gaXNDbGFzcyhmbikge1xuICAgIHRyeSB7XG4gICAgICAgIGlmICh0eXBlb2YgZm4gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgdmFyIGtleXMgPSBlczUua2V5cyhmbi5wcm90b3R5cGUpO1xuICAgICAgICAgICAgcmV0dXJuIGtleXMubGVuZ3RoID4gMCAmJlxuICAgICAgICAgICAgICAgICAgICEoa2V5cy5sZW5ndGggPT09IDEgJiYga2V5c1swXSA9PT0gXCJjb25zdHJ1Y3RvclwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxuXG5mdW5jdGlvbiB0b0Zhc3RQcm9wZXJ0aWVzKG9iaikge1xuICAgIC8qanNoaW50IC1XMDI3Ki9cbiAgICBmdW5jdGlvbiBmKCkge31cbiAgICBmLnByb3RvdHlwZSA9IG9iajtcbiAgICByZXR1cm4gZjtcbiAgICBldmFsKG9iaik7XG59XG5cbnZhciByaWRlbnQgPSAvXlthLXokX11bYS16JF8wLTldKiQvaTtcbmZ1bmN0aW9uIGlzSWRlbnRpZmllcihzdHIpIHtcbiAgICByZXR1cm4gcmlkZW50LnRlc3Qoc3RyKTtcbn1cblxuZnVuY3Rpb24gZmlsbGVkUmFuZ2UoY291bnQsIHByZWZpeCwgc3VmZml4KSB7XG4gICAgdmFyIHJldCA9IG5ldyBBcnJheShjb3VudCk7XG4gICAgZm9yKHZhciBpID0gMDsgaSA8IGNvdW50OyArK2kpIHtcbiAgICAgICAgcmV0W2ldID0gcHJlZml4ICsgaSArIHN1ZmZpeDtcbiAgICB9XG4gICAgcmV0dXJuIHJldDtcbn1cblxudmFyIHJldCA9IHtcbiAgICBpc0NsYXNzOiBpc0NsYXNzLFxuICAgIGlzSWRlbnRpZmllcjogaXNJZGVudGlmaWVyLFxuICAgIGluaGVyaXRlZERhdGFLZXlzOiBpbmhlcml0ZWREYXRhS2V5cyxcbiAgICBnZXREYXRhUHJvcGVydHlPckRlZmF1bHQ6IGdldERhdGFQcm9wZXJ0eU9yRGVmYXVsdCxcbiAgICB0aHJvd2VyOiB0aHJvd2VyLFxuICAgIGlzQXJyYXk6IGVzNS5pc0FycmF5LFxuICAgIGhhdmVHZXR0ZXJzOiBoYXZlR2V0dGVycyxcbiAgICBub3RFbnVtZXJhYmxlUHJvcDogbm90RW51bWVyYWJsZVByb3AsXG4gICAgaXNQcmltaXRpdmU6IGlzUHJpbWl0aXZlLFxuICAgIGlzT2JqZWN0OiBpc09iamVjdCxcbiAgICBjYW5FdmFsdWF0ZTogY2FuRXZhbHVhdGUsXG4gICAgZXJyb3JPYmo6IGVycm9yT2JqLFxuICAgIHRyeUNhdGNoMTogdHJ5Q2F0Y2gxLFxuICAgIHRyeUNhdGNoMjogdHJ5Q2F0Y2gyLFxuICAgIHRyeUNhdGNoMzogdHJ5Q2F0Y2gzLFxuICAgIHRyeUNhdGNoNDogdHJ5Q2F0Y2g0LFxuICAgIHRyeUNhdGNoQXBwbHk6IHRyeUNhdGNoQXBwbHksXG4gICAgaW5oZXJpdHM6IGluaGVyaXRzLFxuICAgIHdpdGhBcHBlbmRlZDogd2l0aEFwcGVuZGVkLFxuICAgIGFzU3RyaW5nOiBhc1N0cmluZyxcbiAgICBtYXliZVdyYXBBc0Vycm9yOiBtYXliZVdyYXBBc0Vycm9yLFxuICAgIHdyYXBzUHJpbWl0aXZlUmVjZWl2ZXI6IHdyYXBzUHJpbWl0aXZlUmVjZWl2ZXIsXG4gICAgdG9GYXN0UHJvcGVydGllczogdG9GYXN0UHJvcGVydGllcyxcbiAgICBmaWxsZWRSYW5nZTogZmlsbGVkUmFuZ2Vcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gcmV0O1xuIiwiKGZ1bmN0aW9uKHByb2Nlc3Mpey8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG52YXIgc2NoZWR1bGUgPSByZXF1aXJlKFwiLi9zY2hlZHVsZS5qc1wiKTtcbnZhciBRdWV1ZSA9IHJlcXVpcmUoXCIuL3F1ZXVlLmpzXCIpO1xudmFyIGVycm9yT2JqID0gcmVxdWlyZShcIi4vdXRpbC5qc1wiKS5lcnJvck9iajtcbnZhciB0cnlDYXRjaDEgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpLnRyeUNhdGNoMTtcbnZhciBfcHJvY2VzcyA9IHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiID8gcHJvY2VzcyA6IHZvaWQgMDtcblxuZnVuY3Rpb24gQXN5bmMoKSB7XG4gICAgdGhpcy5faXNUaWNrVXNlZCA9IGZhbHNlO1xuICAgIHRoaXMuX3NjaGVkdWxlID0gc2NoZWR1bGU7XG4gICAgdGhpcy5fbGVuZ3RoID0gMDtcbiAgICB0aGlzLl9sYXRlQnVmZmVyID0gbmV3IFF1ZXVlKDE2KTtcbiAgICB0aGlzLl9mdW5jdGlvbkJ1ZmZlciA9IG5ldyBRdWV1ZSg2NTUzNik7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHRoaXMuY29uc3VtZUZ1bmN0aW9uQnVmZmVyID0gZnVuY3Rpb24gQXN5bmMkY29uc3VtZUZ1bmN0aW9uQnVmZmVyKCkge1xuICAgICAgICBzZWxmLl9jb25zdW1lRnVuY3Rpb25CdWZmZXIoKTtcbiAgICB9O1xufVxuXG5Bc3luYy5wcm90b3R5cGUuaGF2ZUl0ZW1zUXVldWVkID0gZnVuY3Rpb24gQXN5bmMkaGF2ZUl0ZW1zUXVldWVkKCkge1xuICAgIHJldHVybiB0aGlzLl9sZW5ndGggPiAwO1xufTtcblxuQXN5bmMucHJvdG90eXBlLmludm9rZUxhdGVyID0gZnVuY3Rpb24gQXN5bmMkaW52b2tlTGF0ZXIoZm4sIHJlY2VpdmVyLCBhcmcpIHtcbiAgICBpZiAoX3Byb2Nlc3MgIT09IHZvaWQgMCAmJlxuICAgICAgICBfcHJvY2Vzcy5kb21haW4gIT0gbnVsbCAmJlxuICAgICAgICAhZm4uZG9tYWluKSB7XG4gICAgICAgIGZuID0gX3Byb2Nlc3MuZG9tYWluLmJpbmQoZm4pO1xuICAgIH1cbiAgICB0aGlzLl9sYXRlQnVmZmVyLnB1c2goZm4sIHJlY2VpdmVyLCBhcmcpO1xuICAgIHRoaXMuX3F1ZXVlVGljaygpO1xufTtcblxuQXN5bmMucHJvdG90eXBlLmludm9rZSA9IGZ1bmN0aW9uIEFzeW5jJGludm9rZShmbiwgcmVjZWl2ZXIsIGFyZykge1xuICAgIGlmIChfcHJvY2VzcyAhPT0gdm9pZCAwICYmXG4gICAgICAgIF9wcm9jZXNzLmRvbWFpbiAhPSBudWxsICYmXG4gICAgICAgICFmbi5kb21haW4pIHtcbiAgICAgICAgZm4gPSBfcHJvY2Vzcy5kb21haW4uYmluZChmbik7XG4gICAgfVxuICAgIHZhciBmdW5jdGlvbkJ1ZmZlciA9IHRoaXMuX2Z1bmN0aW9uQnVmZmVyO1xuICAgIGZ1bmN0aW9uQnVmZmVyLnB1c2goZm4sIHJlY2VpdmVyLCBhcmcpO1xuICAgIHRoaXMuX2xlbmd0aCA9IGZ1bmN0aW9uQnVmZmVyLmxlbmd0aCgpO1xuICAgIHRoaXMuX3F1ZXVlVGljaygpO1xufTtcblxuQXN5bmMucHJvdG90eXBlLl9jb25zdW1lRnVuY3Rpb25CdWZmZXIgPVxuZnVuY3Rpb24gQXN5bmMkX2NvbnN1bWVGdW5jdGlvbkJ1ZmZlcigpIHtcbiAgICB2YXIgZnVuY3Rpb25CdWZmZXIgPSB0aGlzLl9mdW5jdGlvbkJ1ZmZlcjtcbiAgICB3aGlsZSAoZnVuY3Rpb25CdWZmZXIubGVuZ3RoKCkgPiAwKSB7XG4gICAgICAgIHZhciBmbiA9IGZ1bmN0aW9uQnVmZmVyLnNoaWZ0KCk7XG4gICAgICAgIHZhciByZWNlaXZlciA9IGZ1bmN0aW9uQnVmZmVyLnNoaWZ0KCk7XG4gICAgICAgIHZhciBhcmcgPSBmdW5jdGlvbkJ1ZmZlci5zaGlmdCgpO1xuICAgICAgICBmbi5jYWxsKHJlY2VpdmVyLCBhcmcpO1xuICAgIH1cbiAgICB0aGlzLl9yZXNldCgpO1xuICAgIHRoaXMuX2NvbnN1bWVMYXRlQnVmZmVyKCk7XG59O1xuXG5Bc3luYy5wcm90b3R5cGUuX2NvbnN1bWVMYXRlQnVmZmVyID0gZnVuY3Rpb24gQXN5bmMkX2NvbnN1bWVMYXRlQnVmZmVyKCkge1xuICAgIHZhciBidWZmZXIgPSB0aGlzLl9sYXRlQnVmZmVyO1xuICAgIHdoaWxlKGJ1ZmZlci5sZW5ndGgoKSA+IDApIHtcbiAgICAgICAgdmFyIGZuID0gYnVmZmVyLnNoaWZ0KCk7XG4gICAgICAgIHZhciByZWNlaXZlciA9IGJ1ZmZlci5zaGlmdCgpO1xuICAgICAgICB2YXIgYXJnID0gYnVmZmVyLnNoaWZ0KCk7XG4gICAgICAgIHZhciByZXMgPSB0cnlDYXRjaDEoZm4sIHJlY2VpdmVyLCBhcmcpO1xuICAgICAgICBpZiAocmVzID09PSBlcnJvck9iaikge1xuICAgICAgICAgICAgdGhpcy5fcXVldWVUaWNrKCk7XG4gICAgICAgICAgICBpZiAoZm4uZG9tYWluICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBmbi5kb21haW4uZW1pdChcImVycm9yXCIsIHJlcy5lKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgcmVzLmU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59O1xuXG5Bc3luYy5wcm90b3R5cGUuX3F1ZXVlVGljayA9IGZ1bmN0aW9uIEFzeW5jJF9xdWV1ZSgpIHtcbiAgICBpZiAoIXRoaXMuX2lzVGlja1VzZWQpIHtcbiAgICAgICAgdGhpcy5fc2NoZWR1bGUodGhpcy5jb25zdW1lRnVuY3Rpb25CdWZmZXIpO1xuICAgICAgICB0aGlzLl9pc1RpY2tVc2VkID0gdHJ1ZTtcbiAgICB9XG59O1xuXG5Bc3luYy5wcm90b3R5cGUuX3Jlc2V0ID0gZnVuY3Rpb24gQXN5bmMkX3Jlc2V0KCkge1xuICAgIHRoaXMuX2lzVGlja1VzZWQgPSBmYWxzZTtcbiAgICB0aGlzLl9sZW5ndGggPSAwO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBuZXcgQXN5bmMoKTtcblxufSkocmVxdWlyZShcIl9fYnJvd3NlcmlmeV9wcm9jZXNzXCIpKSIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG52YXIgT2JqZWN0ZnJlZXplID0gcmVxdWlyZShcIi4vZXM1LmpzXCIpLmZyZWV6ZTtcbnZhciB1dGlsID0gcmVxdWlyZShcIi4vdXRpbC5qc1wiKTtcbnZhciBpbmhlcml0cyA9IHV0aWwuaW5oZXJpdHM7XG52YXIgbm90RW51bWVyYWJsZVByb3AgPSB1dGlsLm5vdEVudW1lcmFibGVQcm9wO1xuXG5mdW5jdGlvbiBtYXJrQXNPcmlnaW5hdGluZ0Zyb21SZWplY3Rpb24oZSkge1xuICAgIHRyeSB7XG4gICAgICAgIG5vdEVudW1lcmFibGVQcm9wKGUsIFwiaXNPcGVyYXRpb25hbFwiLCB0cnVlKTtcbiAgICB9XG4gICAgY2F0Y2goaWdub3JlKSB7fVxufVxuXG5mdW5jdGlvbiBvcmlnaW5hdGVzRnJvbVJlamVjdGlvbihlKSB7XG4gICAgaWYgKGUgPT0gbnVsbCkgcmV0dXJuIGZhbHNlO1xuICAgIHJldHVybiAoKGUgaW5zdGFuY2VvZiBPcGVyYXRpb25hbEVycm9yKSB8fFxuICAgICAgICBlW1wiaXNPcGVyYXRpb25hbFwiXSA9PT0gdHJ1ZSk7XG59XG5cbmZ1bmN0aW9uIGlzRXJyb3Iob2JqKSB7XG4gICAgcmV0dXJuIG9iaiBpbnN0YW5jZW9mIEVycm9yO1xufVxuXG5mdW5jdGlvbiBjYW5BdHRhY2gob2JqKSB7XG4gICAgcmV0dXJuIGlzRXJyb3Iob2JqKTtcbn1cblxuZnVuY3Rpb24gc3ViRXJyb3IobmFtZVByb3BlcnR5LCBkZWZhdWx0TWVzc2FnZSkge1xuICAgIGZ1bmN0aW9uIFN1YkVycm9yKG1lc3NhZ2UpIHtcbiAgICAgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFN1YkVycm9yKSkgcmV0dXJuIG5ldyBTdWJFcnJvcihtZXNzYWdlKTtcbiAgICAgICAgdGhpcy5tZXNzYWdlID0gdHlwZW9mIG1lc3NhZ2UgPT09IFwic3RyaW5nXCIgPyBtZXNzYWdlIDogZGVmYXVsdE1lc3NhZ2U7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWVQcm9wZXJ0eTtcbiAgICAgICAgaWYgKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKSB7XG4gICAgICAgICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCB0aGlzLmNvbnN0cnVjdG9yKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpbmhlcml0cyhTdWJFcnJvciwgRXJyb3IpO1xuICAgIHJldHVybiBTdWJFcnJvcjtcbn1cblxudmFyIF9UeXBlRXJyb3IsIF9SYW5nZUVycm9yO1xudmFyIENhbmNlbGxhdGlvbkVycm9yID0gc3ViRXJyb3IoXCJDYW5jZWxsYXRpb25FcnJvclwiLCBcImNhbmNlbGxhdGlvbiBlcnJvclwiKTtcbnZhciBUaW1lb3V0RXJyb3IgPSBzdWJFcnJvcihcIlRpbWVvdXRFcnJvclwiLCBcInRpbWVvdXQgZXJyb3JcIik7XG52YXIgQWdncmVnYXRlRXJyb3IgPSBzdWJFcnJvcihcIkFnZ3JlZ2F0ZUVycm9yXCIsIFwiYWdncmVnYXRlIGVycm9yXCIpO1xudHJ5IHtcbiAgICBfVHlwZUVycm9yID0gVHlwZUVycm9yO1xuICAgIF9SYW5nZUVycm9yID0gUmFuZ2VFcnJvcjtcbn0gY2F0Y2goZSkge1xuICAgIF9UeXBlRXJyb3IgPSBzdWJFcnJvcihcIlR5cGVFcnJvclwiLCBcInR5cGUgZXJyb3JcIik7XG4gICAgX1JhbmdlRXJyb3IgPSBzdWJFcnJvcihcIlJhbmdlRXJyb3JcIiwgXCJyYW5nZSBlcnJvclwiKTtcbn1cblxudmFyIG1ldGhvZHMgPSAoXCJqb2luIHBvcCBwdXNoIHNoaWZ0IHVuc2hpZnQgc2xpY2UgZmlsdGVyIGZvckVhY2ggc29tZSBcIiArXG4gICAgXCJldmVyeSBtYXAgaW5kZXhPZiBsYXN0SW5kZXhPZiByZWR1Y2UgcmVkdWNlUmlnaHQgc29ydCByZXZlcnNlXCIpLnNwbGl0KFwiIFwiKTtcblxuZm9yICh2YXIgaSA9IDA7IGkgPCBtZXRob2RzLmxlbmd0aDsgKytpKSB7XG4gICAgaWYgKHR5cGVvZiBBcnJheS5wcm90b3R5cGVbbWV0aG9kc1tpXV0gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICBBZ2dyZWdhdGVFcnJvci5wcm90b3R5cGVbbWV0aG9kc1tpXV0gPSBBcnJheS5wcm90b3R5cGVbbWV0aG9kc1tpXV07XG4gICAgfVxufVxuXG5BZ2dyZWdhdGVFcnJvci5wcm90b3R5cGUubGVuZ3RoID0gMDtcbkFnZ3JlZ2F0ZUVycm9yLnByb3RvdHlwZVtcImlzT3BlcmF0aW9uYWxcIl0gPSB0cnVlO1xudmFyIGxldmVsID0gMDtcbkFnZ3JlZ2F0ZUVycm9yLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBpbmRlbnQgPSBBcnJheShsZXZlbCAqIDQgKyAxKS5qb2luKFwiIFwiKTtcbiAgICB2YXIgcmV0ID0gXCJcXG5cIiArIGluZGVudCArIFwiQWdncmVnYXRlRXJyb3Igb2Y6XCIgKyBcIlxcblwiO1xuICAgIGxldmVsKys7XG4gICAgaW5kZW50ID0gQXJyYXkobGV2ZWwgKiA0ICsgMSkuam9pbihcIiBcIik7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgIHZhciBzdHIgPSB0aGlzW2ldID09PSB0aGlzID8gXCJbQ2lyY3VsYXIgQWdncmVnYXRlRXJyb3JdXCIgOiB0aGlzW2ldICsgXCJcIjtcbiAgICAgICAgdmFyIGxpbmVzID0gc3RyLnNwbGl0KFwiXFxuXCIpO1xuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGxpbmVzLmxlbmd0aDsgKytqKSB7XG4gICAgICAgICAgICBsaW5lc1tqXSA9IGluZGVudCArIGxpbmVzW2pdO1xuICAgICAgICB9XG4gICAgICAgIHN0ciA9IGxpbmVzLmpvaW4oXCJcXG5cIik7XG4gICAgICAgIHJldCArPSBzdHIgKyBcIlxcblwiO1xuICAgIH1cbiAgICBsZXZlbC0tO1xuICAgIHJldHVybiByZXQ7XG59O1xuXG5mdW5jdGlvbiBPcGVyYXRpb25hbEVycm9yKG1lc3NhZ2UpIHtcbiAgICB0aGlzLm5hbWUgPSBcIk9wZXJhdGlvbmFsRXJyb3JcIjtcbiAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgIHRoaXMuY2F1c2UgPSBtZXNzYWdlO1xuICAgIHRoaXNbXCJpc09wZXJhdGlvbmFsXCJdID0gdHJ1ZTtcblxuICAgIGlmIChtZXNzYWdlIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZS5tZXNzYWdlO1xuICAgICAgICB0aGlzLnN0YWNrID0gbWVzc2FnZS5zdGFjaztcbiAgICB9IGVsc2UgaWYgKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKSB7XG4gICAgICAgIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKHRoaXMsIHRoaXMuY29uc3RydWN0b3IpO1xuICAgIH1cblxufVxuaW5oZXJpdHMoT3BlcmF0aW9uYWxFcnJvciwgRXJyb3IpO1xuXG52YXIga2V5ID0gXCJfX0JsdWViaXJkRXJyb3JUeXBlc19fXCI7XG52YXIgZXJyb3JUeXBlcyA9IEVycm9yW2tleV07XG5pZiAoIWVycm9yVHlwZXMpIHtcbiAgICBlcnJvclR5cGVzID0gT2JqZWN0ZnJlZXplKHtcbiAgICAgICAgQ2FuY2VsbGF0aW9uRXJyb3I6IENhbmNlbGxhdGlvbkVycm9yLFxuICAgICAgICBUaW1lb3V0RXJyb3I6IFRpbWVvdXRFcnJvcixcbiAgICAgICAgT3BlcmF0aW9uYWxFcnJvcjogT3BlcmF0aW9uYWxFcnJvcixcbiAgICAgICAgUmVqZWN0aW9uRXJyb3I6IE9wZXJhdGlvbmFsRXJyb3IsXG4gICAgICAgIEFnZ3JlZ2F0ZUVycm9yOiBBZ2dyZWdhdGVFcnJvclxuICAgIH0pO1xuICAgIG5vdEVudW1lcmFibGVQcm9wKEVycm9yLCBrZXksIGVycm9yVHlwZXMpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgICBFcnJvcjogRXJyb3IsXG4gICAgVHlwZUVycm9yOiBfVHlwZUVycm9yLFxuICAgIFJhbmdlRXJyb3I6IF9SYW5nZUVycm9yLFxuICAgIENhbmNlbGxhdGlvbkVycm9yOiBlcnJvclR5cGVzLkNhbmNlbGxhdGlvbkVycm9yLFxuICAgIE9wZXJhdGlvbmFsRXJyb3I6IGVycm9yVHlwZXMuT3BlcmF0aW9uYWxFcnJvcixcbiAgICBUaW1lb3V0RXJyb3I6IGVycm9yVHlwZXMuVGltZW91dEVycm9yLFxuICAgIEFnZ3JlZ2F0ZUVycm9yOiBlcnJvclR5cGVzLkFnZ3JlZ2F0ZUVycm9yLFxuICAgIG9yaWdpbmF0ZXNGcm9tUmVqZWN0aW9uOiBvcmlnaW5hdGVzRnJvbVJlamVjdGlvbixcbiAgICBtYXJrQXNPcmlnaW5hdGluZ0Zyb21SZWplY3Rpb246IG1hcmtBc09yaWdpbmF0aW5nRnJvbVJlamVjdGlvbixcbiAgICBjYW5BdHRhY2g6IGNhbkF0dGFjaFxufTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UsIElOVEVSTkFMKSB7XG52YXIgdXRpbCA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIik7XG52YXIgY2FuQXR0YWNoID0gcmVxdWlyZShcIi4vZXJyb3JzLmpzXCIpLmNhbkF0dGFjaDtcbnZhciBlcnJvck9iaiA9IHV0aWwuZXJyb3JPYmo7XG52YXIgaXNPYmplY3QgPSB1dGlsLmlzT2JqZWN0O1xuXG5mdW5jdGlvbiBnZXRUaGVuKG9iaikge1xuICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBvYmoudGhlbjtcbiAgICB9XG4gICAgY2F0Y2goZSkge1xuICAgICAgICBlcnJvck9iai5lID0gZTtcbiAgICAgICAgcmV0dXJuIGVycm9yT2JqO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gUHJvbWlzZSRfQ2FzdChvYmosIG9yaWdpbmFsUHJvbWlzZSkge1xuICAgIGlmIChpc09iamVjdChvYmopKSB7XG4gICAgICAgIGlmIChvYmogaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGlzQW55Qmx1ZWJpcmRQcm9taXNlKG9iaikpIHtcbiAgICAgICAgICAgIHZhciByZXQgPSBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG4gICAgICAgICAgICByZXQuX3NldFRyYWNlKHZvaWQgMCk7XG4gICAgICAgICAgICBvYmouX3RoZW4oXG4gICAgICAgICAgICAgICAgcmV0Ll9mdWxmaWxsVW5jaGVja2VkLFxuICAgICAgICAgICAgICAgIHJldC5fcmVqZWN0VW5jaGVja2VkQ2hlY2tFcnJvcixcbiAgICAgICAgICAgICAgICByZXQuX3Byb2dyZXNzVW5jaGVja2VkLFxuICAgICAgICAgICAgICAgIHJldCxcbiAgICAgICAgICAgICAgICBudWxsXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgcmV0Ll9zZXRGb2xsb3dpbmcoKTtcbiAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHRoZW4gPSBnZXRUaGVuKG9iaik7XG4gICAgICAgIGlmICh0aGVuID09PSBlcnJvck9iaikge1xuICAgICAgICAgICAgaWYgKG9yaWdpbmFsUHJvbWlzZSAhPT0gdm9pZCAwICYmIGNhbkF0dGFjaCh0aGVuLmUpKSB7XG4gICAgICAgICAgICAgICAgb3JpZ2luYWxQcm9taXNlLl9hdHRhY2hFeHRyYVRyYWNlKHRoZW4uZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QodGhlbi5lKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdGhlbiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZSRfZG9UaGVuYWJsZShvYmosIHRoZW4sIG9yaWdpbmFsUHJvbWlzZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG9iajtcbn1cblxudmFyIGhhc1Byb3AgPSB7fS5oYXNPd25Qcm9wZXJ0eTtcbmZ1bmN0aW9uIGlzQW55Qmx1ZWJpcmRQcm9taXNlKG9iaikge1xuICAgIHJldHVybiBoYXNQcm9wLmNhbGwob2JqLCBcIl9wcm9taXNlMFwiKTtcbn1cblxuZnVuY3Rpb24gUHJvbWlzZSRfZG9UaGVuYWJsZSh4LCB0aGVuLCBvcmlnaW5hbFByb21pc2UpIHtcbiAgICB2YXIgcmVzb2x2ZXIgPSBQcm9taXNlLmRlZmVyKCk7XG4gICAgdmFyIGNhbGxlZCA9IGZhbHNlO1xuICAgIHRyeSB7XG4gICAgICAgIHRoZW4uY2FsbChcbiAgICAgICAgICAgIHgsXG4gICAgICAgICAgICBQcm9taXNlJF9yZXNvbHZlRnJvbVRoZW5hYmxlLFxuICAgICAgICAgICAgUHJvbWlzZSRfcmVqZWN0RnJvbVRoZW5hYmxlLFxuICAgICAgICAgICAgUHJvbWlzZSRfcHJvZ3Jlc3NGcm9tVGhlbmFibGVcbiAgICAgICAgKTtcbiAgICB9IGNhdGNoKGUpIHtcbiAgICAgICAgaWYgKCFjYWxsZWQpIHtcbiAgICAgICAgICAgIGNhbGxlZCA9IHRydWU7XG4gICAgICAgICAgICB2YXIgdHJhY2UgPSBjYW5BdHRhY2goZSkgPyBlIDogbmV3IEVycm9yKGUgKyBcIlwiKTtcbiAgICAgICAgICAgIGlmIChvcmlnaW5hbFByb21pc2UgIT09IHZvaWQgMCkge1xuICAgICAgICAgICAgICAgIG9yaWdpbmFsUHJvbWlzZS5fYXR0YWNoRXh0cmFUcmFjZSh0cmFjZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXNvbHZlci5wcm9taXNlLl9yZWplY3QoZSwgdHJhY2UpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXNvbHZlci5wcm9taXNlO1xuXG4gICAgZnVuY3Rpb24gUHJvbWlzZSRfcmVzb2x2ZUZyb21UaGVuYWJsZSh5KSB7XG4gICAgICAgIGlmIChjYWxsZWQpIHJldHVybjtcbiAgICAgICAgY2FsbGVkID0gdHJ1ZTtcblxuICAgICAgICBpZiAoeCA9PT0geSkge1xuICAgICAgICAgICAgdmFyIGUgPSBQcm9taXNlLl9tYWtlU2VsZlJlc29sdXRpb25FcnJvcigpO1xuICAgICAgICAgICAgaWYgKG9yaWdpbmFsUHJvbWlzZSAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgICAgICAgb3JpZ2luYWxQcm9taXNlLl9hdHRhY2hFeHRyYVRyYWNlKGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVzb2x2ZXIucHJvbWlzZS5fcmVqZWN0KGUsIHZvaWQgMCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgcmVzb2x2ZXIucmVzb2x2ZSh5KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBQcm9taXNlJF9yZWplY3RGcm9tVGhlbmFibGUocikge1xuICAgICAgICBpZiAoY2FsbGVkKSByZXR1cm47XG4gICAgICAgIGNhbGxlZCA9IHRydWU7XG4gICAgICAgIHZhciB0cmFjZSA9IGNhbkF0dGFjaChyKSA/IHIgOiBuZXcgRXJyb3IociArIFwiXCIpO1xuICAgICAgICBpZiAob3JpZ2luYWxQcm9taXNlICE9PSB2b2lkIDApIHtcbiAgICAgICAgICAgIG9yaWdpbmFsUHJvbWlzZS5fYXR0YWNoRXh0cmFUcmFjZSh0cmFjZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmVzb2x2ZXIucHJvbWlzZS5fcmVqZWN0KHIsIHRyYWNlKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBQcm9taXNlJF9wcm9ncmVzc0Zyb21UaGVuYWJsZSh2KSB7XG4gICAgICAgIGlmIChjYWxsZWQpIHJldHVybjtcbiAgICAgICAgdmFyIHByb21pc2UgPSByZXNvbHZlci5wcm9taXNlO1xuICAgICAgICBpZiAodHlwZW9mIHByb21pc2UuX3Byb2dyZXNzID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHByb21pc2UuX3Byb2dyZXNzKHYpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5yZXR1cm4gUHJvbWlzZSRfQ2FzdDtcbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlLCBJTlRFUk5BTCwgY2FzdCkge1xudmFyIGNhbkF0dGFjaCA9IHJlcXVpcmUoXCIuL2Vycm9ycy5qc1wiKS5jYW5BdHRhY2g7XG52YXIgdXRpbCA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIik7XG52YXIgaXNBcnJheSA9IHV0aWwuaXNBcnJheTtcblxuZnVuY3Rpb24gdG9SZXNvbHV0aW9uVmFsdWUodmFsKSB7XG4gICAgc3dpdGNoKHZhbCkge1xuICAgIGNhc2UgLTE6IHJldHVybiB2b2lkIDA7XG4gICAgY2FzZSAtMjogcmV0dXJuIFtdO1xuICAgIGNhc2UgLTM6IHJldHVybiB7fTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIFByb21pc2VBcnJheSh2YWx1ZXMpIHtcbiAgICB2YXIgcHJvbWlzZSA9IHRoaXMuX3Byb21pc2UgPSBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG4gICAgdmFyIHBhcmVudCA9IHZvaWQgMDtcbiAgICBpZiAodmFsdWVzIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICBwYXJlbnQgPSB2YWx1ZXM7XG4gICAgICAgIHByb21pc2UuX3Byb3BhZ2F0ZUZyb20ocGFyZW50LCAxIHwgNCk7XG4gICAgfVxuICAgIHByb21pc2UuX3NldFRyYWNlKHBhcmVudCk7XG4gICAgdGhpcy5fdmFsdWVzID0gdmFsdWVzO1xuICAgIHRoaXMuX2xlbmd0aCA9IDA7XG4gICAgdGhpcy5fdG90YWxSZXNvbHZlZCA9IDA7XG4gICAgdGhpcy5faW5pdCh2b2lkIDAsIC0yKTtcbn1cblByb21pc2VBcnJheS5wcm90b3R5cGUubGVuZ3RoID0gZnVuY3Rpb24gUHJvbWlzZUFycmF5JGxlbmd0aCgpIHtcbiAgICByZXR1cm4gdGhpcy5fbGVuZ3RoO1xufTtcblxuUHJvbWlzZUFycmF5LnByb3RvdHlwZS5wcm9taXNlID0gZnVuY3Rpb24gUHJvbWlzZUFycmF5JHByb21pc2UoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3Byb21pc2U7XG59O1xuXG5Qcm9taXNlQXJyYXkucHJvdG90eXBlLl9pbml0ID1cbmZ1bmN0aW9uIFByb21pc2VBcnJheSRfaW5pdChfLCByZXNvbHZlVmFsdWVJZkVtcHR5KSB7XG4gICAgdmFyIHZhbHVlcyA9IGNhc3QodGhpcy5fdmFsdWVzLCB2b2lkIDApO1xuICAgIGlmICh2YWx1ZXMgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgIHRoaXMuX3ZhbHVlcyA9IHZhbHVlcztcbiAgICAgICAgdmFsdWVzLl9zZXRCb3VuZFRvKHRoaXMuX3Byb21pc2UuX2JvdW5kVG8pO1xuICAgICAgICBpZiAodmFsdWVzLmlzRnVsZmlsbGVkKCkpIHtcbiAgICAgICAgICAgIHZhbHVlcyA9IHZhbHVlcy5fc2V0dGxlZFZhbHVlO1xuICAgICAgICAgICAgaWYgKCFpc0FycmF5KHZhbHVlcykpIHtcbiAgICAgICAgICAgICAgICB2YXIgZXJyID0gbmV3IFByb21pc2UuVHlwZUVycm9yKFwiZXhwZWN0aW5nIGFuIGFycmF5LCBhIHByb21pc2Ugb3IgYSB0aGVuYWJsZVwiKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9faGFyZFJlamVjdF9fKGVycik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHZhbHVlcy5pc1BlbmRpbmcoKSkge1xuICAgICAgICAgICAgdmFsdWVzLl90aGVuKFxuICAgICAgICAgICAgICAgIFByb21pc2VBcnJheSRfaW5pdCxcbiAgICAgICAgICAgICAgICB0aGlzLl9yZWplY3QsXG4gICAgICAgICAgICAgICAgdm9pZCAwLFxuICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgcmVzb2x2ZVZhbHVlSWZFbXB0eVxuICAgICAgICAgICApO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFsdWVzLl91bnNldFJlamVjdGlvbklzVW5oYW5kbGVkKCk7XG4gICAgICAgICAgICB0aGlzLl9yZWplY3QodmFsdWVzLl9zZXR0bGVkVmFsdWUpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfSBlbHNlIGlmICghaXNBcnJheSh2YWx1ZXMpKSB7XG4gICAgICAgIHZhciBlcnIgPSBuZXcgUHJvbWlzZS5UeXBlRXJyb3IoXCJleHBlY3RpbmcgYW4gYXJyYXksIGEgcHJvbWlzZSBvciBhIHRoZW5hYmxlXCIpO1xuICAgICAgICB0aGlzLl9faGFyZFJlamVjdF9fKGVycik7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAodmFsdWVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBpZiAocmVzb2x2ZVZhbHVlSWZFbXB0eSA9PT0gLTUpIHtcbiAgICAgICAgICAgIHRoaXMuX3Jlc29sdmVFbXB0eUFycmF5KCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9yZXNvbHZlKHRvUmVzb2x1dGlvblZhbHVlKHJlc29sdmVWYWx1ZUlmRW1wdHkpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBsZW4gPSB0aGlzLmdldEFjdHVhbExlbmd0aCh2YWx1ZXMubGVuZ3RoKTtcbiAgICB2YXIgbmV3TGVuID0gbGVuO1xuICAgIHZhciBuZXdWYWx1ZXMgPSB0aGlzLnNob3VsZENvcHlWYWx1ZXMoKSA/IG5ldyBBcnJheShsZW4pIDogdGhpcy5fdmFsdWVzO1xuICAgIHZhciBpc0RpcmVjdFNjYW5OZWVkZWQgPSBmYWxzZTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgIHZhciBtYXliZVByb21pc2UgPSBjYXN0KHZhbHVlc1tpXSwgdm9pZCAwKTtcbiAgICAgICAgaWYgKG1heWJlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgICAgIGlmIChtYXliZVByb21pc2UuaXNQZW5kaW5nKCkpIHtcbiAgICAgICAgICAgICAgICBtYXliZVByb21pc2UuX3Byb3h5UHJvbWlzZUFycmF5KHRoaXMsIGkpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBtYXliZVByb21pc2UuX3Vuc2V0UmVqZWN0aW9uSXNVbmhhbmRsZWQoKTtcbiAgICAgICAgICAgICAgICBpc0RpcmVjdFNjYW5OZWVkZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaXNEaXJlY3RTY2FuTmVlZGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBuZXdWYWx1ZXNbaV0gPSBtYXliZVByb21pc2U7XG4gICAgfVxuICAgIHRoaXMuX3ZhbHVlcyA9IG5ld1ZhbHVlcztcbiAgICB0aGlzLl9sZW5ndGggPSBuZXdMZW47XG4gICAgaWYgKGlzRGlyZWN0U2Nhbk5lZWRlZCkge1xuICAgICAgICB0aGlzLl9zY2FuRGlyZWN0VmFsdWVzKGxlbik7XG4gICAgfVxufTtcblxuUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fc2V0dGxlUHJvbWlzZUF0ID1cbmZ1bmN0aW9uIFByb21pc2VBcnJheSRfc2V0dGxlUHJvbWlzZUF0KGluZGV4KSB7XG4gICAgdmFyIHZhbHVlID0gdGhpcy5fdmFsdWVzW2luZGV4XTtcbiAgICBpZiAoISh2YWx1ZSBpbnN0YW5jZW9mIFByb21pc2UpKSB7XG4gICAgICAgIHRoaXMuX3Byb21pc2VGdWxmaWxsZWQodmFsdWUsIGluZGV4KTtcbiAgICB9IGVsc2UgaWYgKHZhbHVlLmlzRnVsZmlsbGVkKCkpIHtcbiAgICAgICAgdGhpcy5fcHJvbWlzZUZ1bGZpbGxlZCh2YWx1ZS5fc2V0dGxlZFZhbHVlLCBpbmRleCk7XG4gICAgfSBlbHNlIGlmICh2YWx1ZS5pc1JlamVjdGVkKCkpIHtcbiAgICAgICAgdGhpcy5fcHJvbWlzZVJlamVjdGVkKHZhbHVlLl9zZXR0bGVkVmFsdWUsIGluZGV4KTtcbiAgICB9XG59O1xuXG5Qcm9taXNlQXJyYXkucHJvdG90eXBlLl9zY2FuRGlyZWN0VmFsdWVzID1cbmZ1bmN0aW9uIFByb21pc2VBcnJheSRfc2NhbkRpcmVjdFZhbHVlcyhsZW4pIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgIGlmICh0aGlzLl9pc1Jlc29sdmVkKCkpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3NldHRsZVByb21pc2VBdChpKTtcbiAgICB9XG59O1xuXG5Qcm9taXNlQXJyYXkucHJvdG90eXBlLl9pc1Jlc29sdmVkID0gZnVuY3Rpb24gUHJvbWlzZUFycmF5JF9pc1Jlc29sdmVkKCkge1xuICAgIHJldHVybiB0aGlzLl92YWx1ZXMgPT09IG51bGw7XG59O1xuXG5Qcm9taXNlQXJyYXkucHJvdG90eXBlLl9yZXNvbHZlID0gZnVuY3Rpb24gUHJvbWlzZUFycmF5JF9yZXNvbHZlKHZhbHVlKSB7XG4gICAgdGhpcy5fdmFsdWVzID0gbnVsbDtcbiAgICB0aGlzLl9wcm9taXNlLl9mdWxmaWxsKHZhbHVlKTtcbn07XG5cblByb21pc2VBcnJheS5wcm90b3R5cGUuX19oYXJkUmVqZWN0X18gPVxuUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fcmVqZWN0ID0gZnVuY3Rpb24gUHJvbWlzZUFycmF5JF9yZWplY3QocmVhc29uKSB7XG4gICAgdGhpcy5fdmFsdWVzID0gbnVsbDtcbiAgICB2YXIgdHJhY2UgPSBjYW5BdHRhY2gocmVhc29uKSA/IHJlYXNvbiA6IG5ldyBFcnJvcihyZWFzb24gKyBcIlwiKTtcbiAgICB0aGlzLl9wcm9taXNlLl9hdHRhY2hFeHRyYVRyYWNlKHRyYWNlKTtcbiAgICB0aGlzLl9wcm9taXNlLl9yZWplY3QocmVhc29uLCB0cmFjZSk7XG59O1xuXG5Qcm9taXNlQXJyYXkucHJvdG90eXBlLl9wcm9taXNlUHJvZ3Jlc3NlZCA9XG5mdW5jdGlvbiBQcm9taXNlQXJyYXkkX3Byb21pc2VQcm9ncmVzc2VkKHByb2dyZXNzVmFsdWUsIGluZGV4KSB7XG4gICAgaWYgKHRoaXMuX2lzUmVzb2x2ZWQoKSkgcmV0dXJuO1xuICAgIHRoaXMuX3Byb21pc2UuX3Byb2dyZXNzKHtcbiAgICAgICAgaW5kZXg6IGluZGV4LFxuICAgICAgICB2YWx1ZTogcHJvZ3Jlc3NWYWx1ZVxuICAgIH0pO1xufTtcblxuXG5Qcm9taXNlQXJyYXkucHJvdG90eXBlLl9wcm9taXNlRnVsZmlsbGVkID1cbmZ1bmN0aW9uIFByb21pc2VBcnJheSRfcHJvbWlzZUZ1bGZpbGxlZCh2YWx1ZSwgaW5kZXgpIHtcbiAgICBpZiAodGhpcy5faXNSZXNvbHZlZCgpKSByZXR1cm47XG4gICAgdGhpcy5fdmFsdWVzW2luZGV4XSA9IHZhbHVlO1xuICAgIHZhciB0b3RhbFJlc29sdmVkID0gKyt0aGlzLl90b3RhbFJlc29sdmVkO1xuICAgIGlmICh0b3RhbFJlc29sdmVkID49IHRoaXMuX2xlbmd0aCkge1xuICAgICAgICB0aGlzLl9yZXNvbHZlKHRoaXMuX3ZhbHVlcyk7XG4gICAgfVxufTtcblxuUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fcHJvbWlzZVJlamVjdGVkID1cbmZ1bmN0aW9uIFByb21pc2VBcnJheSRfcHJvbWlzZVJlamVjdGVkKHJlYXNvbiwgaW5kZXgpIHtcbiAgICBpZiAodGhpcy5faXNSZXNvbHZlZCgpKSByZXR1cm47XG4gICAgdGhpcy5fdG90YWxSZXNvbHZlZCsrO1xuICAgIHRoaXMuX3JlamVjdChyZWFzb24pO1xufTtcblxuUHJvbWlzZUFycmF5LnByb3RvdHlwZS5zaG91bGRDb3B5VmFsdWVzID1cbmZ1bmN0aW9uIFByb21pc2VBcnJheSRfc2hvdWxkQ29weVZhbHVlcygpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbn07XG5cblByb21pc2VBcnJheS5wcm90b3R5cGUuZ2V0QWN0dWFsTGVuZ3RoID1cbmZ1bmN0aW9uIFByb21pc2VBcnJheSRnZXRBY3R1YWxMZW5ndGgobGVuKSB7XG4gICAgcmV0dXJuIGxlbjtcbn07XG5cbnJldHVybiBQcm9taXNlQXJyYXk7XG59O1xuIiwiKGZ1bmN0aW9uKCl7LyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7XG52YXIgaW5oZXJpdHMgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpLmluaGVyaXRzO1xudmFyIGRlZmluZVByb3BlcnR5ID0gcmVxdWlyZShcIi4vZXM1LmpzXCIpLmRlZmluZVByb3BlcnR5O1xuXG52YXIgcmlnbm9yZSA9IG5ldyBSZWdFeHAoXG4gICAgXCJcXFxcYig/OlthLXpBLVowLTkuXStcXFxcJF9cXFxcdyt8XCIgK1xuICAgIFwidHJ5Q2F0Y2goPzoxfDJ8M3w0fEFwcGx5KXxuZXcgXFxcXHcqUHJvbWlzZUFycmF5fFwiICtcbiAgICBcIlxcXFx3KlByb21pc2VBcnJheVxcXFwuXFxcXHcqUHJvbWlzZUFycmF5fFwiICtcbiAgICBcInNldFRpbWVvdXR8Q2F0Y2hGaWx0ZXJcXFxcJF9cXFxcdyt8bWFrZU5vZGVQcm9taXNpZmllZHxwcm9jZXNzSW1tZWRpYXRlfFwiICtcbiAgICBcInByb2Nlc3MuX3RpY2tDYWxsYmFja3xuZXh0VGlja3xBc3luY1xcXFwkXFxcXHcrKVxcXFxiXCJcbik7XG5cbnZhciBydHJhY2VsaW5lID0gbnVsbDtcbnZhciBmb3JtYXRTdGFjayA9IG51bGw7XG5cbmZ1bmN0aW9uIGZvcm1hdE5vbkVycm9yKG9iaikge1xuICAgIHZhciBzdHI7XG4gICAgaWYgKHR5cGVvZiBvYmogPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICBzdHIgPSBcIltmdW5jdGlvbiBcIiArXG4gICAgICAgICAgICAob2JqLm5hbWUgfHwgXCJhbm9ueW1vdXNcIikgK1xuICAgICAgICAgICAgXCJdXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgc3RyID0gb2JqLnRvU3RyaW5nKCk7XG4gICAgICAgIHZhciBydXNlbGVzc1RvU3RyaW5nID0gL1xcW29iamVjdCBbYS16QS1aMC05JF9dK1xcXS87XG4gICAgICAgIGlmIChydXNlbGVzc1RvU3RyaW5nLnRlc3Qoc3RyKSkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB2YXIgbmV3U3RyID0gSlNPTi5zdHJpbmdpZnkob2JqKTtcbiAgICAgICAgICAgICAgICBzdHIgPSBuZXdTdHI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaChlKSB7XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RyLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgc3RyID0gXCIoZW1wdHkgYXJyYXkpXCI7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIChcIig8XCIgKyBzbmlwKHN0cikgKyBcIj4sIG5vIHN0YWNrIHRyYWNlKVwiKTtcbn1cblxuZnVuY3Rpb24gc25pcChzdHIpIHtcbiAgICB2YXIgbWF4Q2hhcnMgPSA0MTtcbiAgICBpZiAoc3RyLmxlbmd0aCA8IG1heENoYXJzKSB7XG4gICAgICAgIHJldHVybiBzdHI7XG4gICAgfVxuICAgIHJldHVybiBzdHIuc3Vic3RyKDAsIG1heENoYXJzIC0gMykgKyBcIi4uLlwiO1xufVxuXG5mdW5jdGlvbiBDYXB0dXJlZFRyYWNlKGlnbm9yZVVudGlsLCBpc1RvcExldmVsKSB7XG4gICAgdGhpcy5jYXB0dXJlU3RhY2tUcmFjZShDYXB0dXJlZFRyYWNlLCBpc1RvcExldmVsKTtcblxufVxuaW5oZXJpdHMoQ2FwdHVyZWRUcmFjZSwgRXJyb3IpO1xuXG5DYXB0dXJlZFRyYWNlLnByb3RvdHlwZS5jYXB0dXJlU3RhY2tUcmFjZSA9XG5mdW5jdGlvbiBDYXB0dXJlZFRyYWNlJGNhcHR1cmVTdGFja1RyYWNlKGlnbm9yZVVudGlsLCBpc1RvcExldmVsKSB7XG4gICAgY2FwdHVyZVN0YWNrVHJhY2UodGhpcywgaWdub3JlVW50aWwsIGlzVG9wTGV2ZWwpO1xufTtcblxuQ2FwdHVyZWRUcmFjZS5wb3NzaWJseVVuaGFuZGxlZFJlamVjdGlvbiA9XG5mdW5jdGlvbiBDYXB0dXJlZFRyYWNlJFBvc3NpYmx5VW5oYW5kbGVkUmVqZWN0aW9uKHJlYXNvbikge1xuICAgIGlmICh0eXBlb2YgY29uc29sZSA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICB2YXIgbWVzc2FnZTtcbiAgICAgICAgaWYgKHR5cGVvZiByZWFzb24gPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIHJlYXNvbiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICB2YXIgc3RhY2sgPSByZWFzb24uc3RhY2s7XG4gICAgICAgICAgICBtZXNzYWdlID0gXCJQb3NzaWJseSB1bmhhbmRsZWQgXCIgKyBmb3JtYXRTdGFjayhzdGFjaywgcmVhc29uKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1lc3NhZ2UgPSBcIlBvc3NpYmx5IHVuaGFuZGxlZCBcIiArIFN0cmluZyhyZWFzb24pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgY29uc29sZS5lcnJvciA9PT0gXCJmdW5jdGlvblwiIHx8XG4gICAgICAgICAgICB0eXBlb2YgY29uc29sZS5lcnJvciA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihtZXNzYWdlKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgY29uc29sZS5sb2cgPT09IFwiZnVuY3Rpb25cIiB8fFxuICAgICAgICAgICAgdHlwZW9mIGNvbnNvbGUubG9nID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhtZXNzYWdlKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cbkNhcHR1cmVkVHJhY2UuY29tYmluZSA9IGZ1bmN0aW9uIENhcHR1cmVkVHJhY2UkQ29tYmluZShjdXJyZW50LCBwcmV2KSB7XG4gICAgdmFyIGN1ckxhc3QgPSBjdXJyZW50Lmxlbmd0aCAtIDE7XG4gICAgZm9yICh2YXIgaSA9IHByZXYubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgICAgdmFyIGxpbmUgPSBwcmV2W2ldO1xuICAgICAgICBpZiAoY3VycmVudFtjdXJMYXN0XSA9PT0gbGluZSkge1xuICAgICAgICAgICAgY3VycmVudC5wb3AoKTtcbiAgICAgICAgICAgIGN1ckxhc3QtLTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY3VycmVudC5wdXNoKFwiRnJvbSBwcmV2aW91cyBldmVudDpcIik7XG4gICAgdmFyIGxpbmVzID0gY3VycmVudC5jb25jYXQocHJldik7XG5cbiAgICB2YXIgcmV0ID0gW107XG5cbiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gbGluZXMubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHtcblxuICAgICAgICBpZiAoKHJpZ25vcmUudGVzdChsaW5lc1tpXSkgfHxcbiAgICAgICAgICAgIChpID4gMCAmJiAhcnRyYWNlbGluZS50ZXN0KGxpbmVzW2ldKSkgJiZcbiAgICAgICAgICAgIGxpbmVzW2ldICE9PSBcIkZyb20gcHJldmlvdXMgZXZlbnQ6XCIpXG4gICAgICAgKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICByZXQucHVzaChsaW5lc1tpXSk7XG4gICAgfVxuICAgIHJldHVybiByZXQ7XG59O1xuXG5DYXB0dXJlZFRyYWNlLnByb3RlY3RFcnJvck1lc3NhZ2VOZXdsaW5lcyA9IGZ1bmN0aW9uKHN0YWNrKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdGFjay5sZW5ndGg7ICsraSkge1xuICAgICAgICBpZiAocnRyYWNlbGluZS50ZXN0KHN0YWNrW2ldKSkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoaSA8PSAxKSByZXR1cm47XG5cbiAgICB2YXIgZXJyb3JNZXNzYWdlTGluZXMgPSBbXTtcbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IGk7ICsraikge1xuICAgICAgICBlcnJvck1lc3NhZ2VMaW5lcy5wdXNoKHN0YWNrLnNoaWZ0KCkpO1xuICAgIH1cbiAgICBzdGFjay51bnNoaWZ0KGVycm9yTWVzc2FnZUxpbmVzLmpvaW4oXCJcXHUwMDAyXFx1MDAwMFxcdTAwMDFcIikpO1xufTtcblxuQ2FwdHVyZWRUcmFjZS5pc1N1cHBvcnRlZCA9IGZ1bmN0aW9uIENhcHR1cmVkVHJhY2UkSXNTdXBwb3J0ZWQoKSB7XG4gICAgcmV0dXJuIHR5cGVvZiBjYXB0dXJlU3RhY2tUcmFjZSA9PT0gXCJmdW5jdGlvblwiO1xufTtcblxudmFyIGNhcHR1cmVTdGFja1RyYWNlID0gKGZ1bmN0aW9uIHN0YWNrRGV0ZWN0aW9uKCkge1xuICAgIGlmICh0eXBlb2YgRXJyb3Iuc3RhY2tUcmFjZUxpbWl0ID09PSBcIm51bWJlclwiICYmXG4gICAgICAgIHR5cGVvZiBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHJ0cmFjZWxpbmUgPSAvXlxccyphdFxccyovO1xuICAgICAgICBmb3JtYXRTdGFjayA9IGZ1bmN0aW9uKHN0YWNrLCBlcnJvcikge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBzdGFjayA9PT0gXCJzdHJpbmdcIikgcmV0dXJuIHN0YWNrO1xuXG4gICAgICAgICAgICBpZiAoZXJyb3IubmFtZSAhPT0gdm9pZCAwICYmXG4gICAgICAgICAgICAgICAgZXJyb3IubWVzc2FnZSAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGVycm9yLm5hbWUgKyBcIi4gXCIgKyBlcnJvci5tZXNzYWdlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZvcm1hdE5vbkVycm9yKGVycm9yKTtcblxuXG4gICAgICAgIH07XG4gICAgICAgIHZhciBjYXB0dXJlU3RhY2tUcmFjZSA9IEVycm9yLmNhcHR1cmVTdGFja1RyYWNlO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gQ2FwdHVyZWRUcmFjZSRfY2FwdHVyZVN0YWNrVHJhY2UoXG4gICAgICAgICAgICByZWNlaXZlciwgaWdub3JlVW50aWwpIHtcbiAgICAgICAgICAgIGNhcHR1cmVTdGFja1RyYWNlKHJlY2VpdmVyLCBpZ25vcmVVbnRpbCk7XG4gICAgICAgIH07XG4gICAgfVxuICAgIHZhciBlcnIgPSBuZXcgRXJyb3IoKTtcblxuICAgIGlmICh0eXBlb2YgZXJyLnN0YWNrID09PSBcInN0cmluZ1wiICYmXG4gICAgICAgIHR5cGVvZiBcIlwiLnN0YXJ0c1dpdGggPT09IFwiZnVuY3Rpb25cIiAmJlxuICAgICAgICAoZXJyLnN0YWNrLnN0YXJ0c1dpdGgoXCJzdGFja0RldGVjdGlvbkBcIikpICYmXG4gICAgICAgIHN0YWNrRGV0ZWN0aW9uLm5hbWUgPT09IFwic3RhY2tEZXRlY3Rpb25cIikge1xuXG4gICAgICAgIGRlZmluZVByb3BlcnR5KEVycm9yLCBcInN0YWNrVHJhY2VMaW1pdFwiLCB7XG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgIHZhbHVlOiAyNVxuICAgICAgICB9KTtcbiAgICAgICAgcnRyYWNlbGluZSA9IC9ALztcbiAgICAgICAgdmFyIHJsaW5lID0gL1tAXFxuXS87XG5cbiAgICAgICAgZm9ybWF0U3RhY2sgPSBmdW5jdGlvbihzdGFjaywgZXJyb3IpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygc3RhY2sgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKGVycm9yLm5hbWUgKyBcIi4gXCIgKyBlcnJvci5tZXNzYWdlICsgXCJcXG5cIiArIHN0YWNrKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGVycm9yLm5hbWUgIT09IHZvaWQgMCAmJlxuICAgICAgICAgICAgICAgIGVycm9yLm1lc3NhZ2UgIT09IHZvaWQgMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBlcnJvci5uYW1lICsgXCIuIFwiICsgZXJyb3IubWVzc2FnZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmb3JtYXROb25FcnJvcihlcnJvcik7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIGNhcHR1cmVTdGFja1RyYWNlKG8pIHtcbiAgICAgICAgICAgIHZhciBzdGFjayA9IG5ldyBFcnJvcigpLnN0YWNrO1xuICAgICAgICAgICAgdmFyIHNwbGl0ID0gc3RhY2suc3BsaXQocmxpbmUpO1xuICAgICAgICAgICAgdmFyIGxlbiA9IHNwbGl0Lmxlbmd0aDtcbiAgICAgICAgICAgIHZhciByZXQgPSBcIlwiO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkgKz0gMikge1xuICAgICAgICAgICAgICAgIHJldCArPSBzcGxpdFtpXTtcbiAgICAgICAgICAgICAgICByZXQgKz0gXCJAXCI7XG4gICAgICAgICAgICAgICAgcmV0ICs9IHNwbGl0W2kgKyAxXTtcbiAgICAgICAgICAgICAgICByZXQgKz0gXCJcXG5cIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG8uc3RhY2sgPSByZXQ7XG4gICAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgICAgZm9ybWF0U3RhY2sgPSBmdW5jdGlvbihzdGFjaywgZXJyb3IpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygc3RhY2sgPT09IFwic3RyaW5nXCIpIHJldHVybiBzdGFjaztcblxuICAgICAgICAgICAgaWYgKCh0eXBlb2YgZXJyb3IgPT09IFwib2JqZWN0XCIgfHxcbiAgICAgICAgICAgICAgICB0eXBlb2YgZXJyb3IgPT09IFwiZnVuY3Rpb25cIikgJiZcbiAgICAgICAgICAgICAgICBlcnJvci5uYW1lICE9PSB2b2lkIDAgJiZcbiAgICAgICAgICAgICAgICBlcnJvci5tZXNzYWdlICE9PSB2b2lkIDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZXJyb3IubmFtZSArIFwiLiBcIiArIGVycm9yLm1lc3NhZ2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZm9ybWF0Tm9uRXJyb3IoZXJyb3IpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbn0pKCk7XG5cbnJldHVybiBDYXB0dXJlZFRyYWNlO1xufTtcblxufSkoKSIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKE5FWFRfRklMVEVSKSB7XG52YXIgdXRpbCA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIik7XG52YXIgZXJyb3JzID0gcmVxdWlyZShcIi4vZXJyb3JzLmpzXCIpO1xudmFyIHRyeUNhdGNoMSA9IHV0aWwudHJ5Q2F0Y2gxO1xudmFyIGVycm9yT2JqID0gdXRpbC5lcnJvck9iajtcbnZhciBrZXlzID0gcmVxdWlyZShcIi4vZXM1LmpzXCIpLmtleXM7XG52YXIgVHlwZUVycm9yID0gZXJyb3JzLlR5cGVFcnJvcjtcblxuZnVuY3Rpb24gQ2F0Y2hGaWx0ZXIoaW5zdGFuY2VzLCBjYWxsYmFjaywgcHJvbWlzZSkge1xuICAgIHRoaXMuX2luc3RhbmNlcyA9IGluc3RhbmNlcztcbiAgICB0aGlzLl9jYWxsYmFjayA9IGNhbGxiYWNrO1xuICAgIHRoaXMuX3Byb21pc2UgPSBwcm9taXNlO1xufVxuXG5mdW5jdGlvbiBDYXRjaEZpbHRlciRfc2FmZVByZWRpY2F0ZShwcmVkaWNhdGUsIGUpIHtcbiAgICB2YXIgc2FmZU9iamVjdCA9IHt9O1xuICAgIHZhciByZXRmaWx0ZXIgPSB0cnlDYXRjaDEocHJlZGljYXRlLCBzYWZlT2JqZWN0LCBlKTtcblxuICAgIGlmIChyZXRmaWx0ZXIgPT09IGVycm9yT2JqKSByZXR1cm4gcmV0ZmlsdGVyO1xuXG4gICAgdmFyIHNhZmVLZXlzID0ga2V5cyhzYWZlT2JqZWN0KTtcbiAgICBpZiAoc2FmZUtleXMubGVuZ3RoKSB7XG4gICAgICAgIGVycm9yT2JqLmUgPSBuZXcgVHlwZUVycm9yKFxuICAgICAgICAgICAgXCJDYXRjaCBmaWx0ZXIgbXVzdCBpbmhlcml0IGZyb20gRXJyb3IgXCJcbiAgICAgICAgICArIFwib3IgYmUgYSBzaW1wbGUgcHJlZGljYXRlIGZ1bmN0aW9uXCIpO1xuICAgICAgICByZXR1cm4gZXJyb3JPYmo7XG4gICAgfVxuICAgIHJldHVybiByZXRmaWx0ZXI7XG59XG5cbkNhdGNoRmlsdGVyLnByb3RvdHlwZS5kb0ZpbHRlciA9IGZ1bmN0aW9uIENhdGNoRmlsdGVyJF9kb0ZpbHRlcihlKSB7XG4gICAgdmFyIGNiID0gdGhpcy5fY2FsbGJhY2s7XG4gICAgdmFyIHByb21pc2UgPSB0aGlzLl9wcm9taXNlO1xuICAgIHZhciBib3VuZFRvID0gcHJvbWlzZS5fYm91bmRUbztcbiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gdGhpcy5faW5zdGFuY2VzLmxlbmd0aDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgIHZhciBpdGVtID0gdGhpcy5faW5zdGFuY2VzW2ldO1xuICAgICAgICB2YXIgaXRlbUlzRXJyb3JUeXBlID0gaXRlbSA9PT0gRXJyb3IgfHxcbiAgICAgICAgICAgIChpdGVtICE9IG51bGwgJiYgaXRlbS5wcm90b3R5cGUgaW5zdGFuY2VvZiBFcnJvcik7XG5cbiAgICAgICAgaWYgKGl0ZW1Jc0Vycm9yVHlwZSAmJiBlIGluc3RhbmNlb2YgaXRlbSkge1xuICAgICAgICAgICAgdmFyIHJldCA9IHRyeUNhdGNoMShjYiwgYm91bmRUbywgZSk7XG4gICAgICAgICAgICBpZiAocmV0ID09PSBlcnJvck9iaikge1xuICAgICAgICAgICAgICAgIE5FWFRfRklMVEVSLmUgPSByZXQuZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gTkVYVF9GSUxURVI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBpdGVtID09PSBcImZ1bmN0aW9uXCIgJiYgIWl0ZW1Jc0Vycm9yVHlwZSkge1xuICAgICAgICAgICAgdmFyIHNob3VsZEhhbmRsZSA9IENhdGNoRmlsdGVyJF9zYWZlUHJlZGljYXRlKGl0ZW0sIGUpO1xuICAgICAgICAgICAgaWYgKHNob3VsZEhhbmRsZSA9PT0gZXJyb3JPYmopIHtcbiAgICAgICAgICAgICAgICB2YXIgdHJhY2UgPSBlcnJvcnMuY2FuQXR0YWNoKGVycm9yT2JqLmUpXG4gICAgICAgICAgICAgICAgICAgID8gZXJyb3JPYmouZVxuICAgICAgICAgICAgICAgICAgICA6IG5ldyBFcnJvcihlcnJvck9iai5lICsgXCJcIik7XG4gICAgICAgICAgICAgICAgdGhpcy5fcHJvbWlzZS5fYXR0YWNoRXh0cmFUcmFjZSh0cmFjZSk7XG4gICAgICAgICAgICAgICAgZSA9IGVycm9yT2JqLmU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHNob3VsZEhhbmRsZSkge1xuICAgICAgICAgICAgICAgIHZhciByZXQgPSB0cnlDYXRjaDEoY2IsIGJvdW5kVG8sIGUpO1xuICAgICAgICAgICAgICAgIGlmIChyZXQgPT09IGVycm9yT2JqKSB7XG4gICAgICAgICAgICAgICAgICAgIE5FWFRfRklMVEVSLmUgPSByZXQuZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE5FWFRfRklMVEVSO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIE5FWFRfRklMVEVSLmUgPSBlO1xuICAgIHJldHVybiBORVhUX0ZJTFRFUjtcbn07XG5cbnJldHVybiBDYXRjaEZpbHRlcjtcbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xudmFyIHV0aWwgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpO1xudmFyIG1heWJlV3JhcEFzRXJyb3IgPSB1dGlsLm1heWJlV3JhcEFzRXJyb3I7XG52YXIgZXJyb3JzID0gcmVxdWlyZShcIi4vZXJyb3JzLmpzXCIpO1xudmFyIFRpbWVvdXRFcnJvciA9IGVycm9ycy5UaW1lb3V0RXJyb3I7XG52YXIgT3BlcmF0aW9uYWxFcnJvciA9IGVycm9ycy5PcGVyYXRpb25hbEVycm9yO1xudmFyIGFzeW5jID0gcmVxdWlyZShcIi4vYXN5bmMuanNcIik7XG52YXIgaGF2ZUdldHRlcnMgPSB1dGlsLmhhdmVHZXR0ZXJzO1xudmFyIGVzNSA9IHJlcXVpcmUoXCIuL2VzNS5qc1wiKTtcblxuZnVuY3Rpb24gaXNVbnR5cGVkRXJyb3Iob2JqKSB7XG4gICAgcmV0dXJuIG9iaiBpbnN0YW5jZW9mIEVycm9yICYmXG4gICAgICAgIGVzNS5nZXRQcm90b3R5cGVPZihvYmopID09PSBFcnJvci5wcm90b3R5cGU7XG59XG5cbmZ1bmN0aW9uIHdyYXBBc09wZXJhdGlvbmFsRXJyb3Iob2JqKSB7XG4gICAgdmFyIHJldDtcbiAgICBpZiAoaXNVbnR5cGVkRXJyb3Iob2JqKSkge1xuICAgICAgICByZXQgPSBuZXcgT3BlcmF0aW9uYWxFcnJvcihvYmopO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldCA9IG9iajtcbiAgICB9XG4gICAgZXJyb3JzLm1hcmtBc09yaWdpbmF0aW5nRnJvbVJlamVjdGlvbihyZXQpO1xuICAgIHJldHVybiByZXQ7XG59XG5cbmZ1bmN0aW9uIG5vZGViYWNrRm9yUHJvbWlzZShwcm9taXNlKSB7XG4gICAgZnVuY3Rpb24gUHJvbWlzZVJlc29sdmVyJF9jYWxsYmFjayhlcnIsIHZhbHVlKSB7XG4gICAgICAgIGlmIChwcm9taXNlID09PSBudWxsKSByZXR1cm47XG5cbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgdmFyIHdyYXBwZWQgPSB3cmFwQXNPcGVyYXRpb25hbEVycm9yKG1heWJlV3JhcEFzRXJyb3IoZXJyKSk7XG4gICAgICAgICAgICBwcm9taXNlLl9hdHRhY2hFeHRyYVRyYWNlKHdyYXBwZWQpO1xuICAgICAgICAgICAgcHJvbWlzZS5fcmVqZWN0KHdyYXBwZWQpO1xuICAgICAgICB9IGVsc2UgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAyKSB7XG4gICAgICAgICAgICB2YXIgJF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoO3ZhciBhcmdzID0gbmV3IEFycmF5KCRfbGVuIC0gMSk7IGZvcih2YXIgJF9pID0gMTsgJF9pIDwgJF9sZW47ICsrJF9pKSB7YXJnc1skX2kgLSAxXSA9IGFyZ3VtZW50c1skX2ldO31cbiAgICAgICAgICAgIHByb21pc2UuX2Z1bGZpbGwoYXJncyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBwcm9taXNlLl9mdWxmaWxsKHZhbHVlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHByb21pc2UgPSBudWxsO1xuICAgIH1cbiAgICByZXR1cm4gUHJvbWlzZVJlc29sdmVyJF9jYWxsYmFjaztcbn1cblxuXG52YXIgUHJvbWlzZVJlc29sdmVyO1xuaWYgKCFoYXZlR2V0dGVycykge1xuICAgIFByb21pc2VSZXNvbHZlciA9IGZ1bmN0aW9uIFByb21pc2VSZXNvbHZlcihwcm9taXNlKSB7XG4gICAgICAgIHRoaXMucHJvbWlzZSA9IHByb21pc2U7XG4gICAgICAgIHRoaXMuYXNDYWxsYmFjayA9IG5vZGViYWNrRm9yUHJvbWlzZShwcm9taXNlKTtcbiAgICAgICAgdGhpcy5jYWxsYmFjayA9IHRoaXMuYXNDYWxsYmFjaztcbiAgICB9O1xufVxuZWxzZSB7XG4gICAgUHJvbWlzZVJlc29sdmVyID0gZnVuY3Rpb24gUHJvbWlzZVJlc29sdmVyKHByb21pc2UpIHtcbiAgICAgICAgdGhpcy5wcm9taXNlID0gcHJvbWlzZTtcbiAgICB9O1xufVxuaWYgKGhhdmVHZXR0ZXJzKSB7XG4gICAgdmFyIHByb3AgPSB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gbm9kZWJhY2tGb3JQcm9taXNlKHRoaXMucHJvbWlzZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGVzNS5kZWZpbmVQcm9wZXJ0eShQcm9taXNlUmVzb2x2ZXIucHJvdG90eXBlLCBcImFzQ2FsbGJhY2tcIiwgcHJvcCk7XG4gICAgZXM1LmRlZmluZVByb3BlcnR5KFByb21pc2VSZXNvbHZlci5wcm90b3R5cGUsIFwiY2FsbGJhY2tcIiwgcHJvcCk7XG59XG5cblByb21pc2VSZXNvbHZlci5fbm9kZWJhY2tGb3JQcm9taXNlID0gbm9kZWJhY2tGb3JQcm9taXNlO1xuXG5Qcm9taXNlUmVzb2x2ZXIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gUHJvbWlzZVJlc29sdmVyJHRvU3RyaW5nKCkge1xuICAgIHJldHVybiBcIltvYmplY3QgUHJvbWlzZVJlc29sdmVyXVwiO1xufTtcblxuUHJvbWlzZVJlc29sdmVyLnByb3RvdHlwZS5yZXNvbHZlID1cblByb21pc2VSZXNvbHZlci5wcm90b3R5cGUuZnVsZmlsbCA9IGZ1bmN0aW9uIFByb21pc2VSZXNvbHZlciRyZXNvbHZlKHZhbHVlKSB7XG4gICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFByb21pc2VSZXNvbHZlcikpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIklsbGVnYWwgaW52b2NhdGlvbiwgcmVzb2x2ZXIgcmVzb2x2ZS9yZWplY3QgbXVzdCBiZSBjYWxsZWQgd2l0aGluIGEgcmVzb2x2ZXIgY29udGV4dC4gQ29uc2lkZXIgdXNpbmcgdGhlIHByb21pc2UgY29uc3RydWN0b3IgaW5zdGVhZC5cIik7XG4gICAgfVxuXG4gICAgdmFyIHByb21pc2UgPSB0aGlzLnByb21pc2U7XG4gICAgaWYgKHByb21pc2UuX3RyeUZvbGxvdyh2YWx1ZSkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBhc3luYy5pbnZva2UocHJvbWlzZS5fZnVsZmlsbCwgcHJvbWlzZSwgdmFsdWUpO1xufTtcblxuUHJvbWlzZVJlc29sdmVyLnByb3RvdHlwZS5yZWplY3QgPSBmdW5jdGlvbiBQcm9taXNlUmVzb2x2ZXIkcmVqZWN0KHJlYXNvbikge1xuICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBQcm9taXNlUmVzb2x2ZXIpKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJJbGxlZ2FsIGludm9jYXRpb24sIHJlc29sdmVyIHJlc29sdmUvcmVqZWN0IG11c3QgYmUgY2FsbGVkIHdpdGhpbiBhIHJlc29sdmVyIGNvbnRleHQuIENvbnNpZGVyIHVzaW5nIHRoZSBwcm9taXNlIGNvbnN0cnVjdG9yIGluc3RlYWQuXCIpO1xuICAgIH1cblxuICAgIHZhciBwcm9taXNlID0gdGhpcy5wcm9taXNlO1xuICAgIGVycm9ycy5tYXJrQXNPcmlnaW5hdGluZ0Zyb21SZWplY3Rpb24ocmVhc29uKTtcbiAgICB2YXIgdHJhY2UgPSBlcnJvcnMuY2FuQXR0YWNoKHJlYXNvbikgPyByZWFzb24gOiBuZXcgRXJyb3IocmVhc29uICsgXCJcIik7XG4gICAgcHJvbWlzZS5fYXR0YWNoRXh0cmFUcmFjZSh0cmFjZSk7XG4gICAgYXN5bmMuaW52b2tlKHByb21pc2UuX3JlamVjdCwgcHJvbWlzZSwgcmVhc29uKTtcbiAgICBpZiAodHJhY2UgIT09IHJlYXNvbikge1xuICAgICAgICBhc3luYy5pbnZva2UodGhpcy5fc2V0Q2FycmllZFN0YWNrVHJhY2UsIHRoaXMsIHRyYWNlKTtcbiAgICB9XG59O1xuXG5Qcm9taXNlUmVzb2x2ZXIucHJvdG90eXBlLnByb2dyZXNzID1cbmZ1bmN0aW9uIFByb21pc2VSZXNvbHZlciRwcm9ncmVzcyh2YWx1ZSkge1xuICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBQcm9taXNlUmVzb2x2ZXIpKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJJbGxlZ2FsIGludm9jYXRpb24sIHJlc29sdmVyIHJlc29sdmUvcmVqZWN0IG11c3QgYmUgY2FsbGVkIHdpdGhpbiBhIHJlc29sdmVyIGNvbnRleHQuIENvbnNpZGVyIHVzaW5nIHRoZSBwcm9taXNlIGNvbnN0cnVjdG9yIGluc3RlYWQuXCIpO1xuICAgIH1cbiAgICBhc3luYy5pbnZva2UodGhpcy5wcm9taXNlLl9wcm9ncmVzcywgdGhpcy5wcm9taXNlLCB2YWx1ZSk7XG59O1xuXG5Qcm9taXNlUmVzb2x2ZXIucHJvdG90eXBlLmNhbmNlbCA9IGZ1bmN0aW9uIFByb21pc2VSZXNvbHZlciRjYW5jZWwoKSB7XG4gICAgYXN5bmMuaW52b2tlKHRoaXMucHJvbWlzZS5jYW5jZWwsIHRoaXMucHJvbWlzZSwgdm9pZCAwKTtcbn07XG5cblByb21pc2VSZXNvbHZlci5wcm90b3R5cGUudGltZW91dCA9IGZ1bmN0aW9uIFByb21pc2VSZXNvbHZlciR0aW1lb3V0KCkge1xuICAgIHRoaXMucmVqZWN0KG5ldyBUaW1lb3V0RXJyb3IoXCJ0aW1lb3V0XCIpKTtcbn07XG5cblByb21pc2VSZXNvbHZlci5wcm90b3R5cGUuaXNSZXNvbHZlZCA9IGZ1bmN0aW9uIFByb21pc2VSZXNvbHZlciRpc1Jlc29sdmVkKCkge1xuICAgIHJldHVybiB0aGlzLnByb21pc2UuaXNSZXNvbHZlZCgpO1xufTtcblxuUHJvbWlzZVJlc29sdmVyLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiBQcm9taXNlUmVzb2x2ZXIkdG9KU09OKCkge1xuICAgIHJldHVybiB0aGlzLnByb21pc2UudG9KU09OKCk7XG59O1xuXG5Qcm9taXNlUmVzb2x2ZXIucHJvdG90eXBlLl9zZXRDYXJyaWVkU3RhY2tUcmFjZSA9XG5mdW5jdGlvbiBQcm9taXNlUmVzb2x2ZXIkX3NldENhcnJpZWRTdGFja1RyYWNlKHRyYWNlKSB7XG4gICAgaWYgKHRoaXMucHJvbWlzZS5pc1JlamVjdGVkKCkpIHtcbiAgICAgICAgdGhpcy5wcm9taXNlLl9zZXRDYXJyaWVkU3RhY2tUcmFjZSh0cmFjZSk7XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBQcm9taXNlUmVzb2x2ZXI7XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlLCBORVhUX0ZJTFRFUiwgY2FzdCkge1xudmFyIHV0aWwgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpO1xudmFyIHdyYXBzUHJpbWl0aXZlUmVjZWl2ZXIgPSB1dGlsLndyYXBzUHJpbWl0aXZlUmVjZWl2ZXI7XG52YXIgaXNQcmltaXRpdmUgPSB1dGlsLmlzUHJpbWl0aXZlO1xudmFyIHRocm93ZXIgPSB1dGlsLnRocm93ZXI7XG5cbmZ1bmN0aW9uIHJldHVyblRoaXMoKSB7XG4gICAgcmV0dXJuIHRoaXM7XG59XG5mdW5jdGlvbiB0aHJvd1RoaXMoKSB7XG4gICAgdGhyb3cgdGhpcztcbn1cbmZ1bmN0aW9uIHJldHVybiQocikge1xuICAgIHJldHVybiBmdW5jdGlvbiBQcm9taXNlJF9yZXR1cm5lcigpIHtcbiAgICAgICAgcmV0dXJuIHI7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIHRocm93JChyKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIFByb21pc2UkX3Rocm93ZXIoKSB7XG4gICAgICAgIHRocm93IHI7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIHByb21pc2VkRmluYWxseShyZXQsIHJlYXNvbk9yVmFsdWUsIGlzRnVsZmlsbGVkKSB7XG4gICAgdmFyIHRoZW47XG4gICAgaWYgKHdyYXBzUHJpbWl0aXZlUmVjZWl2ZXIgJiYgaXNQcmltaXRpdmUocmVhc29uT3JWYWx1ZSkpIHtcbiAgICAgICAgdGhlbiA9IGlzRnVsZmlsbGVkID8gcmV0dXJuJChyZWFzb25PclZhbHVlKSA6IHRocm93JChyZWFzb25PclZhbHVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0aGVuID0gaXNGdWxmaWxsZWQgPyByZXR1cm5UaGlzIDogdGhyb3dUaGlzO1xuICAgIH1cbiAgICByZXR1cm4gcmV0Ll90aGVuKHRoZW4sIHRocm93ZXIsIHZvaWQgMCwgcmVhc29uT3JWYWx1ZSwgdm9pZCAwKTtcbn1cblxuZnVuY3Rpb24gZmluYWxseUhhbmRsZXIocmVhc29uT3JWYWx1ZSkge1xuICAgIHZhciBwcm9taXNlID0gdGhpcy5wcm9taXNlO1xuICAgIHZhciBoYW5kbGVyID0gdGhpcy5oYW5kbGVyO1xuXG4gICAgdmFyIHJldCA9IHByb21pc2UuX2lzQm91bmQoKVxuICAgICAgICAgICAgICAgICAgICA/IGhhbmRsZXIuY2FsbChwcm9taXNlLl9ib3VuZFRvKVxuICAgICAgICAgICAgICAgICAgICA6IGhhbmRsZXIoKTtcblxuICAgIGlmIChyZXQgIT09IHZvaWQgMCkge1xuICAgICAgICB2YXIgbWF5YmVQcm9taXNlID0gY2FzdChyZXQsIHZvaWQgMCk7XG4gICAgICAgIGlmIChtYXliZVByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgICAgICByZXR1cm4gcHJvbWlzZWRGaW5hbGx5KG1heWJlUHJvbWlzZSwgcmVhc29uT3JWYWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb21pc2UuaXNGdWxmaWxsZWQoKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAocHJvbWlzZS5pc1JlamVjdGVkKCkpIHtcbiAgICAgICAgTkVYVF9GSUxURVIuZSA9IHJlYXNvbk9yVmFsdWU7XG4gICAgICAgIHJldHVybiBORVhUX0ZJTFRFUjtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gcmVhc29uT3JWYWx1ZTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHRhcEhhbmRsZXIodmFsdWUpIHtcbiAgICB2YXIgcHJvbWlzZSA9IHRoaXMucHJvbWlzZTtcbiAgICB2YXIgaGFuZGxlciA9IHRoaXMuaGFuZGxlcjtcblxuICAgIHZhciByZXQgPSBwcm9taXNlLl9pc0JvdW5kKClcbiAgICAgICAgICAgICAgICAgICAgPyBoYW5kbGVyLmNhbGwocHJvbWlzZS5fYm91bmRUbywgdmFsdWUpXG4gICAgICAgICAgICAgICAgICAgIDogaGFuZGxlcih2YWx1ZSk7XG5cbiAgICBpZiAocmV0ICE9PSB2b2lkIDApIHtcbiAgICAgICAgdmFyIG1heWJlUHJvbWlzZSA9IGNhc3QocmV0LCB2b2lkIDApO1xuICAgICAgICBpZiAobWF5YmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgICAgcmV0dXJuIHByb21pc2VkRmluYWxseShtYXliZVByb21pc2UsIHZhbHVlLCB0cnVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdmFsdWU7XG59XG5cblByb21pc2UucHJvdG90eXBlLl9wYXNzVGhyb3VnaEhhbmRsZXIgPVxuZnVuY3Rpb24gUHJvbWlzZSRfcGFzc1Rocm91Z2hIYW5kbGVyKGhhbmRsZXIsIGlzRmluYWxseSkge1xuICAgIGlmICh0eXBlb2YgaGFuZGxlciAhPT0gXCJmdW5jdGlvblwiKSByZXR1cm4gdGhpcy50aGVuKCk7XG5cbiAgICB2YXIgcHJvbWlzZUFuZEhhbmRsZXIgPSB7XG4gICAgICAgIHByb21pc2U6IHRoaXMsXG4gICAgICAgIGhhbmRsZXI6IGhhbmRsZXJcbiAgICB9O1xuXG4gICAgcmV0dXJuIHRoaXMuX3RoZW4oXG4gICAgICAgICAgICBpc0ZpbmFsbHkgPyBmaW5hbGx5SGFuZGxlciA6IHRhcEhhbmRsZXIsXG4gICAgICAgICAgICBpc0ZpbmFsbHkgPyBmaW5hbGx5SGFuZGxlciA6IHZvaWQgMCwgdm9pZCAwLFxuICAgICAgICAgICAgcHJvbWlzZUFuZEhhbmRsZXIsIHZvaWQgMCk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5sYXN0bHkgPVxuUHJvbWlzZS5wcm90b3R5cGVbXCJmaW5hbGx5XCJdID0gZnVuY3Rpb24gUHJvbWlzZSRmaW5hbGx5KGhhbmRsZXIpIHtcbiAgICByZXR1cm4gdGhpcy5fcGFzc1Rocm91Z2hIYW5kbGVyKGhhbmRsZXIsIHRydWUpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUudGFwID0gZnVuY3Rpb24gUHJvbWlzZSR0YXAoaGFuZGxlcikge1xuICAgIHJldHVybiB0aGlzLl9wYXNzVGhyb3VnaEhhbmRsZXIoaGFuZGxlciwgZmFsc2UpO1xufTtcbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xudmFyIHV0aWwgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpO1xudmFyIGlzUHJpbWl0aXZlID0gdXRpbC5pc1ByaW1pdGl2ZTtcbnZhciB3cmFwc1ByaW1pdGl2ZVJlY2VpdmVyID0gdXRpbC53cmFwc1ByaW1pdGl2ZVJlY2VpdmVyO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UpIHtcbnZhciByZXR1cm5lciA9IGZ1bmN0aW9uIFByb21pc2UkX3JldHVybmVyKCkge1xuICAgIHJldHVybiB0aGlzO1xufTtcbnZhciB0aHJvd2VyID0gZnVuY3Rpb24gUHJvbWlzZSRfdGhyb3dlcigpIHtcbiAgICB0aHJvdyB0aGlzO1xufTtcblxudmFyIHdyYXBwZXIgPSBmdW5jdGlvbiBQcm9taXNlJF93cmFwcGVyKHZhbHVlLCBhY3Rpb24pIHtcbiAgICBpZiAoYWN0aW9uID09PSAxKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBQcm9taXNlJF90aHJvd2VyKCkge1xuICAgICAgICAgICAgdGhyb3cgdmFsdWU7XG4gICAgICAgIH07XG4gICAgfSBlbHNlIGlmIChhY3Rpb24gPT09IDIpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIFByb21pc2UkX3JldHVybmVyKCkge1xuICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICB9O1xuICAgIH1cbn07XG5cblxuUHJvbWlzZS5wcm90b3R5cGVbXCJyZXR1cm5cIl0gPVxuUHJvbWlzZS5wcm90b3R5cGUudGhlblJldHVybiA9XG5mdW5jdGlvbiBQcm9taXNlJHRoZW5SZXR1cm4odmFsdWUpIHtcbiAgICBpZiAod3JhcHNQcmltaXRpdmVSZWNlaXZlciAmJiBpc1ByaW1pdGl2ZSh2YWx1ZSkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RoZW4oXG4gICAgICAgICAgICB3cmFwcGVyKHZhbHVlLCAyKSxcbiAgICAgICAgICAgIHZvaWQgMCxcbiAgICAgICAgICAgIHZvaWQgMCxcbiAgICAgICAgICAgIHZvaWQgMCxcbiAgICAgICAgICAgIHZvaWQgMFxuICAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLl90aGVuKHJldHVybmVyLCB2b2lkIDAsIHZvaWQgMCwgdmFsdWUsIHZvaWQgMCk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZVtcInRocm93XCJdID1cblByb21pc2UucHJvdG90eXBlLnRoZW5UaHJvdyA9XG5mdW5jdGlvbiBQcm9taXNlJHRoZW5UaHJvdyhyZWFzb24pIHtcbiAgICBpZiAod3JhcHNQcmltaXRpdmVSZWNlaXZlciAmJiBpc1ByaW1pdGl2ZShyZWFzb24pKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl90aGVuKFxuICAgICAgICAgICAgd3JhcHBlcihyZWFzb24sIDEpLFxuICAgICAgICAgICAgdm9pZCAwLFxuICAgICAgICAgICAgdm9pZCAwLFxuICAgICAgICAgICAgdm9pZCAwLFxuICAgICAgICAgICAgdm9pZCAwXG4gICAgICAgKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuX3RoZW4odGhyb3dlciwgdm9pZCAwLCB2b2lkIDAsIHJlYXNvbiwgdm9pZCAwKTtcbn07XG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID1cbmZ1bmN0aW9uKFByb21pc2UsIFByb21pc2VBcnJheSwgY2FzdCwgSU5URVJOQUwpIHtcbnZhciB1dGlsID0gcmVxdWlyZShcIi4vdXRpbC5qc1wiKTtcbnZhciBjYW5FdmFsdWF0ZSA9IHV0aWwuY2FuRXZhbHVhdGU7XG52YXIgdHJ5Q2F0Y2gxID0gdXRpbC50cnlDYXRjaDE7XG52YXIgZXJyb3JPYmogPSB1dGlsLmVycm9yT2JqO1xuXG5cbmlmIChjYW5FdmFsdWF0ZSkge1xuICAgIHZhciB0aGVuQ2FsbGJhY2sgPSBmdW5jdGlvbihpKSB7XG4gICAgICAgIHJldHVybiBuZXcgRnVuY3Rpb24oXCJ2YWx1ZVwiLCBcImhvbGRlclwiLCBcIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICd1c2Ugc3RyaWN0JzsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIGhvbGRlci5wSW5kZXggPSB2YWx1ZTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIGhvbGRlci5jaGVja0Z1bGZpbGxtZW50KHRoaXMpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIFwiLnJlcGxhY2UoL0luZGV4L2csIGkpKTtcbiAgICB9O1xuXG4gICAgdmFyIGNhbGxlciA9IGZ1bmN0aW9uKGNvdW50KSB7XG4gICAgICAgIHZhciB2YWx1ZXMgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPD0gY291bnQ7ICsraSkgdmFsdWVzLnB1c2goXCJob2xkZXIucFwiICsgaSk7XG4gICAgICAgIHJldHVybiBuZXcgRnVuY3Rpb24oXCJob2xkZXJcIiwgXCIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAndXNlIHN0cmljdCc7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICB2YXIgY2FsbGJhY2sgPSBob2xkZXIuZm47ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICByZXR1cm4gY2FsbGJhY2sodmFsdWVzKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICBcIi5yZXBsYWNlKC92YWx1ZXMvZywgdmFsdWVzLmpvaW4oXCIsIFwiKSkpO1xuICAgIH07XG4gICAgdmFyIHRoZW5DYWxsYmFja3MgPSBbXTtcbiAgICB2YXIgY2FsbGVycyA9IFt2b2lkIDBdO1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDw9IDU7ICsraSkge1xuICAgICAgICB0aGVuQ2FsbGJhY2tzLnB1c2godGhlbkNhbGxiYWNrKGkpKTtcbiAgICAgICAgY2FsbGVycy5wdXNoKGNhbGxlcihpKSk7XG4gICAgfVxuXG4gICAgdmFyIEhvbGRlciA9IGZ1bmN0aW9uKHRvdGFsLCBmbikge1xuICAgICAgICB0aGlzLnAxID0gdGhpcy5wMiA9IHRoaXMucDMgPSB0aGlzLnA0ID0gdGhpcy5wNSA9IG51bGw7XG4gICAgICAgIHRoaXMuZm4gPSBmbjtcbiAgICAgICAgdGhpcy50b3RhbCA9IHRvdGFsO1xuICAgICAgICB0aGlzLm5vdyA9IDA7XG4gICAgfTtcblxuICAgIEhvbGRlci5wcm90b3R5cGUuY2FsbGVycyA9IGNhbGxlcnM7XG4gICAgSG9sZGVyLnByb3RvdHlwZS5jaGVja0Z1bGZpbGxtZW50ID0gZnVuY3Rpb24ocHJvbWlzZSkge1xuICAgICAgICB2YXIgbm93ID0gdGhpcy5ub3c7XG4gICAgICAgIG5vdysrO1xuICAgICAgICB2YXIgdG90YWwgPSB0aGlzLnRvdGFsO1xuICAgICAgICBpZiAobm93ID49IHRvdGFsKSB7XG4gICAgICAgICAgICB2YXIgaGFuZGxlciA9IHRoaXMuY2FsbGVyc1t0b3RhbF07XG4gICAgICAgICAgICB2YXIgcmV0ID0gdHJ5Q2F0Y2gxKGhhbmRsZXIsIHZvaWQgMCwgdGhpcyk7XG4gICAgICAgICAgICBpZiAocmV0ID09PSBlcnJvck9iaikge1xuICAgICAgICAgICAgICAgIHByb21pc2UuX3JlamVjdFVuY2hlY2tlZChyZXQuZSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFwcm9taXNlLl90cnlGb2xsb3cocmV0KSkge1xuICAgICAgICAgICAgICAgIHByb21pc2UuX2Z1bGZpbGxVbmNoZWNrZWQocmV0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubm93ID0gbm93O1xuICAgICAgICB9XG4gICAgfTtcbn1cblxuXG5cblxuUHJvbWlzZS5qb2luID0gZnVuY3Rpb24gUHJvbWlzZSRKb2luKCkge1xuICAgIHZhciBsYXN0ID0gYXJndW1lbnRzLmxlbmd0aCAtIDE7XG4gICAgdmFyIGZuO1xuICAgIGlmIChsYXN0ID4gMCAmJiB0eXBlb2YgYXJndW1lbnRzW2xhc3RdID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgZm4gPSBhcmd1bWVudHNbbGFzdF07XG4gICAgICAgIGlmIChsYXN0IDwgNiAmJiBjYW5FdmFsdWF0ZSkge1xuICAgICAgICAgICAgdmFyIHJldCA9IG5ldyBQcm9taXNlKElOVEVSTkFMKTtcbiAgICAgICAgICAgIHJldC5fc2V0VHJhY2Uodm9pZCAwKTtcbiAgICAgICAgICAgIHZhciBob2xkZXIgPSBuZXcgSG9sZGVyKGxhc3QsIGZuKTtcbiAgICAgICAgICAgIHZhciByZWplY3QgPSByZXQuX3JlamVjdDtcbiAgICAgICAgICAgIHZhciBjYWxsYmFja3MgPSB0aGVuQ2FsbGJhY2tzO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsYXN0OyArK2kpIHtcbiAgICAgICAgICAgICAgICB2YXIgbWF5YmVQcm9taXNlID0gY2FzdChhcmd1bWVudHNbaV0sIHZvaWQgMCk7XG4gICAgICAgICAgICAgICAgaWYgKG1heWJlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1heWJlUHJvbWlzZS5pc1BlbmRpbmcoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWF5YmVQcm9taXNlLl90aGVuKGNhbGxiYWNrc1tpXSwgcmVqZWN0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgMCwgcmV0LCBob2xkZXIpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG1heWJlUHJvbWlzZS5pc0Z1bGZpbGxlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFja3NbaV0uY2FsbChyZXQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXliZVByb21pc2UuX3NldHRsZWRWYWx1ZSwgaG9sZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldC5fcmVqZWN0KG1heWJlUHJvbWlzZS5fc2V0dGxlZFZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1heWJlUHJvbWlzZS5fdW5zZXRSZWplY3Rpb25Jc1VuaGFuZGxlZCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2tzW2ldLmNhbGwocmV0LCBtYXliZVByb21pc2UsIGhvbGRlcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YXIgJF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoO3ZhciBhcmdzID0gbmV3IEFycmF5KCRfbGVuKTsgZm9yKHZhciAkX2kgPSAwOyAkX2kgPCAkX2xlbjsgKyskX2kpIHthcmdzWyRfaV0gPSBhcmd1bWVudHNbJF9pXTt9XG4gICAgdmFyIHJldCA9IG5ldyBQcm9taXNlQXJyYXkoYXJncykucHJvbWlzZSgpO1xuICAgIHJldHVybiBmbiAhPT0gdm9pZCAwID8gcmV0LnNwcmVhZChmbikgOiByZXQ7XG59O1xuXG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSwgSU5URVJOQUwsIGNhc3QpIHtcbnZhciBhcGlSZWplY3Rpb24gPSByZXF1aXJlKFwiLi9lcnJvcnNfYXBpX3JlamVjdGlvbi5qc1wiKShQcm9taXNlKTtcbnZhciBpc0FycmF5ID0gcmVxdWlyZShcIi4vdXRpbC5qc1wiKS5pc0FycmF5O1xuXG52YXIgcmFjZUxhdGVyID0gZnVuY3Rpb24gUHJvbWlzZSRfcmFjZUxhdGVyKHByb21pc2UpIHtcbiAgICByZXR1cm4gcHJvbWlzZS50aGVuKGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlJF9SYWNlKGFycmF5LCBwcm9taXNlKTtcbiAgICB9KTtcbn07XG5cbnZhciBoYXNPd24gPSB7fS5oYXNPd25Qcm9wZXJ0eTtcbmZ1bmN0aW9uIFByb21pc2UkX1JhY2UocHJvbWlzZXMsIHBhcmVudCkge1xuICAgIHZhciBtYXliZVByb21pc2UgPSBjYXN0KHByb21pc2VzLCB2b2lkIDApO1xuXG4gICAgaWYgKG1heWJlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgcmV0dXJuIHJhY2VMYXRlcihtYXliZVByb21pc2UpO1xuICAgIH0gZWxzZSBpZiAoIWlzQXJyYXkocHJvbWlzZXMpKSB7XG4gICAgICAgIHJldHVybiBhcGlSZWplY3Rpb24oXCJleHBlY3RpbmcgYW4gYXJyYXksIGEgcHJvbWlzZSBvciBhIHRoZW5hYmxlXCIpO1xuICAgIH1cblxuICAgIHZhciByZXQgPSBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG4gICAgaWYgKHBhcmVudCAhPT0gdm9pZCAwKSB7XG4gICAgICAgIHJldC5fcHJvcGFnYXRlRnJvbShwYXJlbnQsIDcpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldC5fc2V0VHJhY2Uodm9pZCAwKTtcbiAgICB9XG4gICAgdmFyIGZ1bGZpbGwgPSByZXQuX2Z1bGZpbGw7XG4gICAgdmFyIHJlamVjdCA9IHJldC5fcmVqZWN0O1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBwcm9taXNlcy5sZW5ndGg7IGkgPCBsZW47ICsraSkge1xuICAgICAgICB2YXIgdmFsID0gcHJvbWlzZXNbaV07XG5cbiAgICAgICAgaWYgKHZhbCA9PT0gdm9pZCAwICYmICEoaGFzT3duLmNhbGwocHJvbWlzZXMsIGkpKSkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICBQcm9taXNlLmNhc3QodmFsKS5fdGhlbihmdWxmaWxsLCByZWplY3QsIHZvaWQgMCwgcmV0LCBudWxsKTtcbiAgICB9XG4gICAgcmV0dXJuIHJldDtcbn1cblxuUHJvbWlzZS5yYWNlID0gZnVuY3Rpb24gUHJvbWlzZSRSYWNlKHByb21pc2VzKSB7XG4gICAgcmV0dXJuIFByb21pc2UkX1JhY2UocHJvbWlzZXMsIHZvaWQgMCk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5yYWNlID0gZnVuY3Rpb24gUHJvbWlzZSRyYWNlKCkge1xuICAgIHJldHVybiBQcm9taXNlJF9SYWNlKHRoaXMsIHZvaWQgMCk7XG59O1xuXG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbnZhciBjciA9IE9iamVjdC5jcmVhdGU7XG5pZiAoY3IpIHtcbiAgICB2YXIgY2FsbGVyQ2FjaGUgPSBjcihudWxsKTtcbiAgICB2YXIgZ2V0dGVyQ2FjaGUgPSBjcihudWxsKTtcbiAgICBjYWxsZXJDYWNoZVtcIiBzaXplXCJdID0gZ2V0dGVyQ2FjaGVbXCIgc2l6ZVwiXSA9IDA7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSkge1xudmFyIHV0aWwgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpO1xudmFyIGNhbkV2YWx1YXRlID0gdXRpbC5jYW5FdmFsdWF0ZTtcbnZhciBpc0lkZW50aWZpZXIgPSB1dGlsLmlzSWRlbnRpZmllcjtcblxuZnVuY3Rpb24gbWFrZU1ldGhvZENhbGxlciAobWV0aG9kTmFtZSkge1xuICAgIHJldHVybiBuZXcgRnVuY3Rpb24oXCJvYmpcIiwgXCIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAndXNlIHN0cmljdCcgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICB2YXIgbGVuID0gdGhpcy5sZW5ndGg7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICBzd2l0Y2gobGVuKSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgY2FzZSAxOiByZXR1cm4gb2JqLm1ldGhvZE5hbWUodGhpc1swXSk7ICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgY2FzZSAyOiByZXR1cm4gb2JqLm1ldGhvZE5hbWUodGhpc1swXSwgdGhpc1sxXSk7ICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gb2JqLm1ldGhvZE5hbWUodGhpc1swXSwgdGhpc1sxXSwgdGhpc1syXSk7ICAgICAgICBcXG5cXFxuICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gb2JqLm1ldGhvZE5hbWUoKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgZGVmYXVsdDogcmV0dXJuIG9iai5tZXRob2ROYW1lLmFwcGx5KG9iaiwgdGhpcyk7ICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICB9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICBcIi5yZXBsYWNlKC9tZXRob2ROYW1lL2csIG1ldGhvZE5hbWUpKTtcbn1cblxuZnVuY3Rpb24gbWFrZUdldHRlciAocHJvcGVydHlOYW1lKSB7XG4gICAgcmV0dXJuIG5ldyBGdW5jdGlvbihcIm9ialwiLCBcIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICd1c2Ugc3RyaWN0JzsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgIHJldHVybiBvYmoucHJvcGVydHlOYW1lOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgIFwiLnJlcGxhY2UoXCJwcm9wZXJ0eU5hbWVcIiwgcHJvcGVydHlOYW1lKSk7XG59XG5cbmZ1bmN0aW9uIGdldENvbXBpbGVkKG5hbWUsIGNvbXBpbGVyLCBjYWNoZSkge1xuICAgIHZhciByZXQgPSBjYWNoZVtuYW1lXTtcbiAgICBpZiAodHlwZW9mIHJldCAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIGlmICghaXNJZGVudGlmaWVyKG5hbWUpKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXQgPSBjb21waWxlcihuYW1lKTtcbiAgICAgICAgY2FjaGVbbmFtZV0gPSByZXQ7XG4gICAgICAgIGNhY2hlW1wiIHNpemVcIl0rKztcbiAgICAgICAgaWYgKGNhY2hlW1wiIHNpemVcIl0gPiA1MTIpIHtcbiAgICAgICAgICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoY2FjaGUpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAyNTY7ICsraSkgZGVsZXRlIGNhY2hlW2tleXNbaV1dO1xuICAgICAgICAgICAgY2FjaGVbXCIgc2l6ZVwiXSA9IGtleXMubGVuZ3RoIC0gMjU2O1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXQ7XG59XG5cbmZ1bmN0aW9uIGdldE1ldGhvZENhbGxlcihuYW1lKSB7XG4gICAgcmV0dXJuIGdldENvbXBpbGVkKG5hbWUsIG1ha2VNZXRob2RDYWxsZXIsIGNhbGxlckNhY2hlKTtcbn1cblxuZnVuY3Rpb24gZ2V0R2V0dGVyKG5hbWUpIHtcbiAgICByZXR1cm4gZ2V0Q29tcGlsZWQobmFtZSwgbWFrZUdldHRlciwgZ2V0dGVyQ2FjaGUpO1xufVxuXG5mdW5jdGlvbiBjYWxsZXIob2JqKSB7XG4gICAgcmV0dXJuIG9ialt0aGlzLnBvcCgpXS5hcHBseShvYmosIHRoaXMpO1xufVxuUHJvbWlzZS5wcm90b3R5cGUuY2FsbCA9IGZ1bmN0aW9uIFByb21pc2UkY2FsbChtZXRob2ROYW1lKSB7XG4gICAgdmFyICRfbGVuID0gYXJndW1lbnRzLmxlbmd0aDt2YXIgYXJncyA9IG5ldyBBcnJheSgkX2xlbiAtIDEpOyBmb3IodmFyICRfaSA9IDE7ICRfaSA8ICRfbGVuOyArKyRfaSkge2FyZ3NbJF9pIC0gMV0gPSBhcmd1bWVudHNbJF9pXTt9XG4gICAgaWYgKGNhbkV2YWx1YXRlKSB7XG4gICAgICAgIHZhciBtYXliZUNhbGxlciA9IGdldE1ldGhvZENhbGxlcihtZXRob2ROYW1lKTtcbiAgICAgICAgaWYgKG1heWJlQ2FsbGVyICE9PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdGhlbihtYXliZUNhbGxlciwgdm9pZCAwLCB2b2lkIDAsIGFyZ3MsIHZvaWQgMCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYXJncy5wdXNoKG1ldGhvZE5hbWUpO1xuICAgIHJldHVybiB0aGlzLl90aGVuKGNhbGxlciwgdm9pZCAwLCB2b2lkIDAsIGFyZ3MsIHZvaWQgMCk7XG59O1xuXG5mdW5jdGlvbiBuYW1lZEdldHRlcihvYmopIHtcbiAgICByZXR1cm4gb2JqW3RoaXNdO1xufVxuZnVuY3Rpb24gaW5kZXhlZEdldHRlcihvYmopIHtcbiAgICByZXR1cm4gb2JqW3RoaXNdO1xufVxuUHJvbWlzZS5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gUHJvbWlzZSRnZXQocHJvcGVydHlOYW1lKSB7XG4gICAgdmFyIGlzSW5kZXggPSAodHlwZW9mIHByb3BlcnR5TmFtZSA9PT0gXCJudW1iZXJcIik7XG4gICAgdmFyIGdldHRlcjtcbiAgICBpZiAoIWlzSW5kZXgpIHtcbiAgICAgICAgaWYgKGNhbkV2YWx1YXRlKSB7XG4gICAgICAgICAgICB2YXIgbWF5YmVHZXR0ZXIgPSBnZXRHZXR0ZXIocHJvcGVydHlOYW1lKTtcbiAgICAgICAgICAgIGdldHRlciA9IG1heWJlR2V0dGVyICE9PSBudWxsID8gbWF5YmVHZXR0ZXIgOiBuYW1lZEdldHRlcjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGdldHRlciA9IG5hbWVkR2V0dGVyO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgZ2V0dGVyID0gaW5kZXhlZEdldHRlcjtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuX3RoZW4oZ2V0dGVyLCB2b2lkIDAsIHZvaWQgMCwgcHJvcGVydHlOYW1lLCB2b2lkIDApO1xufTtcbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlLCBhcGlSZWplY3Rpb24sIElOVEVSTkFMLCBjYXN0KSB7XG52YXIgZXJyb3JzID0gcmVxdWlyZShcIi4vZXJyb3JzLmpzXCIpO1xudmFyIFR5cGVFcnJvciA9IGVycm9ycy5UeXBlRXJyb3I7XG52YXIgZGVwcmVjYXRlZCA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIikuZGVwcmVjYXRlZDtcbnZhciB1dGlsID0gcmVxdWlyZShcIi4vdXRpbC5qc1wiKTtcbnZhciBlcnJvck9iaiA9IHV0aWwuZXJyb3JPYmo7XG52YXIgdHJ5Q2F0Y2gxID0gdXRpbC50cnlDYXRjaDE7XG52YXIgeWllbGRIYW5kbGVycyA9IFtdO1xuXG5mdW5jdGlvbiBwcm9taXNlRnJvbVlpZWxkSGFuZGxlcih2YWx1ZSwgeWllbGRIYW5kbGVycykge1xuICAgIHZhciBfZXJyb3JPYmogPSBlcnJvck9iajtcbiAgICB2YXIgX1Byb21pc2UgPSBQcm9taXNlO1xuICAgIHZhciBsZW4gPSB5aWVsZEhhbmRsZXJzLmxlbmd0aDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSB0cnlDYXRjaDEoeWllbGRIYW5kbGVyc1tpXSwgdm9pZCAwLCB2YWx1ZSk7XG4gICAgICAgIGlmIChyZXN1bHQgPT09IF9lcnJvck9iaikge1xuICAgICAgICAgICAgcmV0dXJuIF9Qcm9taXNlLnJlamVjdChfZXJyb3JPYmouZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG1heWJlUHJvbWlzZSA9IGNhc3QocmVzdWx0LCBwcm9taXNlRnJvbVlpZWxkSGFuZGxlcik7XG4gICAgICAgIGlmIChtYXliZVByb21pc2UgaW5zdGFuY2VvZiBfUHJvbWlzZSkgcmV0dXJuIG1heWJlUHJvbWlzZTtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG59XG5cbmZ1bmN0aW9uIFByb21pc2VTcGF3bihnZW5lcmF0b3JGdW5jdGlvbiwgcmVjZWl2ZXIsIHlpZWxkSGFuZGxlcikge1xuICAgIHZhciBwcm9taXNlID0gdGhpcy5fcHJvbWlzZSA9IG5ldyBQcm9taXNlKElOVEVSTkFMKTtcbiAgICBwcm9taXNlLl9zZXRUcmFjZSh2b2lkIDApO1xuICAgIHRoaXMuX2dlbmVyYXRvckZ1bmN0aW9uID0gZ2VuZXJhdG9yRnVuY3Rpb247XG4gICAgdGhpcy5fcmVjZWl2ZXIgPSByZWNlaXZlcjtcbiAgICB0aGlzLl9nZW5lcmF0b3IgPSB2b2lkIDA7XG4gICAgdGhpcy5feWllbGRIYW5kbGVycyA9IHR5cGVvZiB5aWVsZEhhbmRsZXIgPT09IFwiZnVuY3Rpb25cIlxuICAgICAgICA/IFt5aWVsZEhhbmRsZXJdLmNvbmNhdCh5aWVsZEhhbmRsZXJzKVxuICAgICAgICA6IHlpZWxkSGFuZGxlcnM7XG59XG5cblByb21pc2VTcGF3bi5wcm90b3R5cGUucHJvbWlzZSA9IGZ1bmN0aW9uIFByb21pc2VTcGF3biRwcm9taXNlKCkge1xuICAgIHJldHVybiB0aGlzLl9wcm9taXNlO1xufTtcblxuUHJvbWlzZVNwYXduLnByb3RvdHlwZS5fcnVuID0gZnVuY3Rpb24gUHJvbWlzZVNwYXduJF9ydW4oKSB7XG4gICAgdGhpcy5fZ2VuZXJhdG9yID0gdGhpcy5fZ2VuZXJhdG9yRnVuY3Rpb24uY2FsbCh0aGlzLl9yZWNlaXZlcik7XG4gICAgdGhpcy5fcmVjZWl2ZXIgPVxuICAgICAgICB0aGlzLl9nZW5lcmF0b3JGdW5jdGlvbiA9IHZvaWQgMDtcbiAgICB0aGlzLl9uZXh0KHZvaWQgMCk7XG59O1xuXG5Qcm9taXNlU3Bhd24ucHJvdG90eXBlLl9jb250aW51ZSA9IGZ1bmN0aW9uIFByb21pc2VTcGF3biRfY29udGludWUocmVzdWx0KSB7XG4gICAgaWYgKHJlc3VsdCA9PT0gZXJyb3JPYmopIHtcbiAgICAgICAgdGhpcy5fZ2VuZXJhdG9yID0gdm9pZCAwO1xuICAgICAgICB2YXIgdHJhY2UgPSBlcnJvcnMuY2FuQXR0YWNoKHJlc3VsdC5lKVxuICAgICAgICAgICAgPyByZXN1bHQuZSA6IG5ldyBFcnJvcihyZXN1bHQuZSArIFwiXCIpO1xuICAgICAgICB0aGlzLl9wcm9taXNlLl9hdHRhY2hFeHRyYVRyYWNlKHRyYWNlKTtcbiAgICAgICAgdGhpcy5fcHJvbWlzZS5fcmVqZWN0KHJlc3VsdC5lLCB0cmFjZSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgdmFsdWUgPSByZXN1bHQudmFsdWU7XG4gICAgaWYgKHJlc3VsdC5kb25lID09PSB0cnVlKSB7XG4gICAgICAgIHRoaXMuX2dlbmVyYXRvciA9IHZvaWQgMDtcbiAgICAgICAgaWYgKCF0aGlzLl9wcm9taXNlLl90cnlGb2xsb3codmFsdWUpKSB7XG4gICAgICAgICAgICB0aGlzLl9wcm9taXNlLl9mdWxmaWxsKHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBtYXliZVByb21pc2UgPSBjYXN0KHZhbHVlLCB2b2lkIDApO1xuICAgICAgICBpZiAoIShtYXliZVByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSkge1xuICAgICAgICAgICAgbWF5YmVQcm9taXNlID1cbiAgICAgICAgICAgICAgICBwcm9taXNlRnJvbVlpZWxkSGFuZGxlcihtYXliZVByb21pc2UsIHRoaXMuX3lpZWxkSGFuZGxlcnMpO1xuICAgICAgICAgICAgaWYgKG1heWJlUHJvbWlzZSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3Rocm93KG5ldyBUeXBlRXJyb3IoXCJBIHZhbHVlIHdhcyB5aWVsZGVkIHRoYXQgY291bGQgbm90IGJlIHRyZWF0ZWQgYXMgYSBwcm9taXNlXCIpKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbWF5YmVQcm9taXNlLl90aGVuKFxuICAgICAgICAgICAgdGhpcy5fbmV4dCxcbiAgICAgICAgICAgIHRoaXMuX3Rocm93LFxuICAgICAgICAgICAgdm9pZCAwLFxuICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgIG51bGxcbiAgICAgICApO1xuICAgIH1cbn07XG5cblByb21pc2VTcGF3bi5wcm90b3R5cGUuX3Rocm93ID0gZnVuY3Rpb24gUHJvbWlzZVNwYXduJF90aHJvdyhyZWFzb24pIHtcbiAgICBpZiAoZXJyb3JzLmNhbkF0dGFjaChyZWFzb24pKVxuICAgICAgICB0aGlzLl9wcm9taXNlLl9hdHRhY2hFeHRyYVRyYWNlKHJlYXNvbik7XG4gICAgdGhpcy5fY29udGludWUoXG4gICAgICAgIHRyeUNhdGNoMSh0aGlzLl9nZW5lcmF0b3JbXCJ0aHJvd1wiXSwgdGhpcy5fZ2VuZXJhdG9yLCByZWFzb24pXG4gICApO1xufTtcblxuUHJvbWlzZVNwYXduLnByb3RvdHlwZS5fbmV4dCA9IGZ1bmN0aW9uIFByb21pc2VTcGF3biRfbmV4dCh2YWx1ZSkge1xuICAgIHRoaXMuX2NvbnRpbnVlKFxuICAgICAgICB0cnlDYXRjaDEodGhpcy5fZ2VuZXJhdG9yLm5leHQsIHRoaXMuX2dlbmVyYXRvciwgdmFsdWUpXG4gICApO1xufTtcblxuUHJvbWlzZS5jb3JvdXRpbmUgPVxuZnVuY3Rpb24gUHJvbWlzZSRDb3JvdXRpbmUoZ2VuZXJhdG9yRnVuY3Rpb24sIG9wdGlvbnMpIHtcbiAgICBpZiAodHlwZW9mIGdlbmVyYXRvckZ1bmN0aW9uICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcImdlbmVyYXRvckZ1bmN0aW9uIG11c3QgYmUgYSBmdW5jdGlvblwiKTtcbiAgICB9XG4gICAgdmFyIHlpZWxkSGFuZGxlciA9IE9iamVjdChvcHRpb25zKS55aWVsZEhhbmRsZXI7XG4gICAgdmFyIFByb21pc2VTcGF3biQgPSBQcm9taXNlU3Bhd247XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGdlbmVyYXRvciA9IGdlbmVyYXRvckZ1bmN0aW9uLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgIHZhciBzcGF3biA9IG5ldyBQcm9taXNlU3Bhd24kKHZvaWQgMCwgdm9pZCAwLCB5aWVsZEhhbmRsZXIpO1xuICAgICAgICBzcGF3bi5fZ2VuZXJhdG9yID0gZ2VuZXJhdG9yO1xuICAgICAgICBzcGF3bi5fbmV4dCh2b2lkIDApO1xuICAgICAgICByZXR1cm4gc3Bhd24ucHJvbWlzZSgpO1xuICAgIH07XG59O1xuXG5Qcm9taXNlLmNvcm91dGluZS5hZGRZaWVsZEhhbmRsZXIgPSBmdW5jdGlvbihmbikge1xuICAgIGlmICh0eXBlb2YgZm4gIT09IFwiZnVuY3Rpb25cIikgdGhyb3cgbmV3IFR5cGVFcnJvcihcImZuIG11c3QgYmUgYSBmdW5jdGlvblwiKTtcbiAgICB5aWVsZEhhbmRsZXJzLnB1c2goZm4pO1xufTtcblxuUHJvbWlzZS5zcGF3biA9IGZ1bmN0aW9uIFByb21pc2UkU3Bhd24oZ2VuZXJhdG9yRnVuY3Rpb24pIHtcbiAgICBkZXByZWNhdGVkKFwiUHJvbWlzZS5zcGF3biBpcyBkZXByZWNhdGVkLiBVc2UgUHJvbWlzZS5jb3JvdXRpbmUgaW5zdGVhZC5cIik7XG4gICAgaWYgKHR5cGVvZiBnZW5lcmF0b3JGdW5jdGlvbiAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHJldHVybiBhcGlSZWplY3Rpb24oXCJnZW5lcmF0b3JGdW5jdGlvbiBtdXN0IGJlIGEgZnVuY3Rpb25cIik7XG4gICAgfVxuICAgIHZhciBzcGF3biA9IG5ldyBQcm9taXNlU3Bhd24oZ2VuZXJhdG9yRnVuY3Rpb24sIHRoaXMpO1xuICAgIHZhciByZXQgPSBzcGF3bi5wcm9taXNlKCk7XG4gICAgc3Bhd24uX3J1bihQcm9taXNlLnNwYXduKTtcbiAgICByZXR1cm4gcmV0O1xufTtcbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlLCBQcm9taXNlQXJyYXksIGFwaVJlamVjdGlvbiwgY2FzdCwgSU5URVJOQUwpIHtcbnZhciB1dGlsID0gcmVxdWlyZShcIi4vdXRpbC5qc1wiKTtcbnZhciB0cnlDYXRjaDMgPSB1dGlsLnRyeUNhdGNoMztcbnZhciBlcnJvck9iaiA9IHV0aWwuZXJyb3JPYmo7XG52YXIgUEVORElORyA9IHt9O1xudmFyIEVNUFRZX0FSUkFZID0gW107XG5cbmZ1bmN0aW9uIE1hcHBpbmdQcm9taXNlQXJyYXkocHJvbWlzZXMsIGZuLCBsaW1pdCwgX2ZpbHRlcikge1xuICAgIHRoaXMuY29uc3RydWN0b3IkKHByb21pc2VzKTtcbiAgICB0aGlzLl9jYWxsYmFjayA9IGZuO1xuICAgIHRoaXMuX3ByZXNlcnZlZFZhbHVlcyA9IF9maWx0ZXIgPT09IElOVEVSTkFMXG4gICAgICAgID8gbmV3IEFycmF5KHRoaXMubGVuZ3RoKCkpXG4gICAgICAgIDogbnVsbDtcbiAgICB0aGlzLl9saW1pdCA9IGxpbWl0O1xuICAgIHRoaXMuX2luRmxpZ2h0ID0gMDtcbiAgICB0aGlzLl9xdWV1ZSA9IGxpbWl0ID49IDEgPyBbXSA6IEVNUFRZX0FSUkFZO1xuICAgIHRoaXMuX2luaXQkKHZvaWQgMCwgLTIpO1xufVxudXRpbC5pbmhlcml0cyhNYXBwaW5nUHJvbWlzZUFycmF5LCBQcm9taXNlQXJyYXkpO1xuXG5NYXBwaW5nUHJvbWlzZUFycmF5LnByb3RvdHlwZS5faW5pdCA9IGZ1bmN0aW9uIE1hcHBpbmdQcm9taXNlQXJyYXkkX2luaXQoKSB7fTtcblxuTWFwcGluZ1Byb21pc2VBcnJheS5wcm90b3R5cGUuX3Byb21pc2VGdWxmaWxsZWQgPVxuZnVuY3Rpb24gTWFwcGluZ1Byb21pc2VBcnJheSRfcHJvbWlzZUZ1bGZpbGxlZCh2YWx1ZSwgaW5kZXgpIHtcbiAgICB2YXIgdmFsdWVzID0gdGhpcy5fdmFsdWVzO1xuICAgIGlmICh2YWx1ZXMgPT09IG51bGwpIHJldHVybjtcblxuICAgIHZhciBsZW5ndGggPSB0aGlzLmxlbmd0aCgpO1xuICAgIHZhciBwcmVzZXJ2ZWRWYWx1ZXMgPSB0aGlzLl9wcmVzZXJ2ZWRWYWx1ZXM7XG4gICAgdmFyIGxpbWl0ID0gdGhpcy5fbGltaXQ7XG4gICAgaWYgKHZhbHVlc1tpbmRleF0gPT09IFBFTkRJTkcpIHtcbiAgICAgICAgdmFsdWVzW2luZGV4XSA9IHZhbHVlO1xuICAgICAgICBpZiAobGltaXQgPj0gMSkge1xuICAgICAgICAgICAgdGhpcy5faW5GbGlnaHQtLTtcbiAgICAgICAgICAgIHRoaXMuX2RyYWluUXVldWUoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLl9pc1Jlc29sdmVkKCkpIHJldHVybjtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChsaW1pdCA+PSAxICYmIHRoaXMuX2luRmxpZ2h0ID49IGxpbWl0KSB7XG4gICAgICAgICAgICB2YWx1ZXNbaW5kZXhdID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLl9xdWV1ZS5wdXNoKGluZGV4KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAocHJlc2VydmVkVmFsdWVzICE9PSBudWxsKSBwcmVzZXJ2ZWRWYWx1ZXNbaW5kZXhdID0gdmFsdWU7XG5cbiAgICAgICAgdmFyIGNhbGxiYWNrID0gdGhpcy5fY2FsbGJhY2s7XG4gICAgICAgIHZhciByZWNlaXZlciA9IHRoaXMuX3Byb21pc2UuX2JvdW5kVG87XG4gICAgICAgIHZhciByZXQgPSB0cnlDYXRjaDMoY2FsbGJhY2ssIHJlY2VpdmVyLCB2YWx1ZSwgaW5kZXgsIGxlbmd0aCk7XG4gICAgICAgIGlmIChyZXQgPT09IGVycm9yT2JqKSByZXR1cm4gdGhpcy5fcmVqZWN0KHJldC5lKTtcblxuICAgICAgICB2YXIgbWF5YmVQcm9taXNlID0gY2FzdChyZXQsIHZvaWQgMCk7XG4gICAgICAgIGlmIChtYXliZVByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgICAgICBpZiAobWF5YmVQcm9taXNlLmlzUGVuZGluZygpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGxpbWl0ID49IDEpIHRoaXMuX2luRmxpZ2h0Kys7XG4gICAgICAgICAgICAgICAgdmFsdWVzW2luZGV4XSA9IFBFTkRJTkc7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1heWJlUHJvbWlzZS5fcHJveHlQcm9taXNlQXJyYXkodGhpcywgaW5kZXgpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChtYXliZVByb21pc2UuaXNGdWxmaWxsZWQoKSkge1xuICAgICAgICAgICAgICAgIHJldCA9IG1heWJlUHJvbWlzZS52YWx1ZSgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBtYXliZVByb21pc2UuX3Vuc2V0UmVqZWN0aW9uSXNVbmhhbmRsZWQoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVqZWN0KG1heWJlUHJvbWlzZS5yZWFzb24oKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFsdWVzW2luZGV4XSA9IHJldDtcbiAgICB9XG4gICAgdmFyIHRvdGFsUmVzb2x2ZWQgPSArK3RoaXMuX3RvdGFsUmVzb2x2ZWQ7XG4gICAgaWYgKHRvdGFsUmVzb2x2ZWQgPj0gbGVuZ3RoKSB7XG4gICAgICAgIGlmIChwcmVzZXJ2ZWRWYWx1ZXMgIT09IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuX2ZpbHRlcih2YWx1ZXMsIHByZXNlcnZlZFZhbHVlcyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9yZXNvbHZlKHZhbHVlcyk7XG4gICAgICAgIH1cblxuICAgIH1cbn07XG5cbk1hcHBpbmdQcm9taXNlQXJyYXkucHJvdG90eXBlLl9kcmFpblF1ZXVlID1cbmZ1bmN0aW9uIE1hcHBpbmdQcm9taXNlQXJyYXkkX2RyYWluUXVldWUoKSB7XG4gICAgdmFyIHF1ZXVlID0gdGhpcy5fcXVldWU7XG4gICAgdmFyIGxpbWl0ID0gdGhpcy5fbGltaXQ7XG4gICAgdmFyIHZhbHVlcyA9IHRoaXMuX3ZhbHVlcztcbiAgICB3aGlsZSAocXVldWUubGVuZ3RoID4gMCAmJiB0aGlzLl9pbkZsaWdodCA8IGxpbWl0KSB7XG4gICAgICAgIHZhciBpbmRleCA9IHF1ZXVlLnBvcCgpO1xuICAgICAgICB0aGlzLl9wcm9taXNlRnVsZmlsbGVkKHZhbHVlc1tpbmRleF0sIGluZGV4KTtcbiAgICB9XG59O1xuXG5NYXBwaW5nUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fZmlsdGVyID1cbmZ1bmN0aW9uIE1hcHBpbmdQcm9taXNlQXJyYXkkX2ZpbHRlcihib29sZWFucywgdmFsdWVzKSB7XG4gICAgdmFyIGxlbiA9IHZhbHVlcy5sZW5ndGg7XG4gICAgdmFyIHJldCA9IG5ldyBBcnJheShsZW4pO1xuICAgIHZhciBqID0gMDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgIGlmIChib29sZWFuc1tpXSkgcmV0W2orK10gPSB2YWx1ZXNbaV07XG4gICAgfVxuICAgIHJldC5sZW5ndGggPSBqO1xuICAgIHRoaXMuX3Jlc29sdmUocmV0KTtcbn07XG5cbk1hcHBpbmdQcm9taXNlQXJyYXkucHJvdG90eXBlLnByZXNlcnZlZFZhbHVlcyA9XG5mdW5jdGlvbiBNYXBwaW5nUHJvbWlzZUFycmF5JHByZXNlcnZlVmFsdWVzKCkge1xuICAgIHJldHVybiB0aGlzLl9wcmVzZXJ2ZWRWYWx1ZXM7XG59O1xuXG5mdW5jdGlvbiBtYXAocHJvbWlzZXMsIGZuLCBvcHRpb25zLCBfZmlsdGVyKSB7XG4gICAgdmFyIGxpbWl0ID0gdHlwZW9mIG9wdGlvbnMgPT09IFwib2JqZWN0XCIgJiYgb3B0aW9ucyAhPT0gbnVsbFxuICAgICAgICA/IG9wdGlvbnMuY29uY3VycmVuY3lcbiAgICAgICAgOiAwO1xuICAgIGxpbWl0ID0gdHlwZW9mIGxpbWl0ID09PSBcIm51bWJlclwiICYmXG4gICAgICAgIGlzRmluaXRlKGxpbWl0KSAmJiBsaW1pdCA+PSAxID8gbGltaXQgOiAwO1xuICAgIHJldHVybiBuZXcgTWFwcGluZ1Byb21pc2VBcnJheShwcm9taXNlcywgZm4sIGxpbWl0LCBfZmlsdGVyKTtcbn1cblxuUHJvbWlzZS5wcm90b3R5cGUubWFwID0gZnVuY3Rpb24gUHJvbWlzZSRtYXAoZm4sIG9wdGlvbnMpIHtcbiAgICBpZiAodHlwZW9mIGZuICE9PSBcImZ1bmN0aW9uXCIpIHJldHVybiBhcGlSZWplY3Rpb24oXCJmbiBtdXN0IGJlIGEgZnVuY3Rpb25cIik7XG5cbiAgICByZXR1cm4gbWFwKHRoaXMsIGZuLCBvcHRpb25zLCBudWxsKS5wcm9taXNlKCk7XG59O1xuXG5Qcm9taXNlLm1hcCA9IGZ1bmN0aW9uIFByb21pc2UkTWFwKHByb21pc2VzLCBmbiwgb3B0aW9ucywgX2ZpbHRlcikge1xuICAgIGlmICh0eXBlb2YgZm4gIT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIGFwaVJlamVjdGlvbihcImZuIG11c3QgYmUgYSBmdW5jdGlvblwiKTtcbiAgICByZXR1cm4gbWFwKHByb21pc2VzLCBmbiwgb3B0aW9ucywgX2ZpbHRlcikucHJvbWlzZSgpO1xufTtcblxuXG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSkge1xudmFyIHV0aWwgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpO1xudmFyIGFzeW5jID0gcmVxdWlyZShcIi4vYXN5bmMuanNcIik7XG52YXIgdHJ5Q2F0Y2gyID0gdXRpbC50cnlDYXRjaDI7XG52YXIgdHJ5Q2F0Y2gxID0gdXRpbC50cnlDYXRjaDE7XG52YXIgZXJyb3JPYmogPSB1dGlsLmVycm9yT2JqO1xuXG5mdW5jdGlvbiB0aHJvd2VyKHIpIHtcbiAgICB0aHJvdyByO1xufVxuXG5mdW5jdGlvbiBQcm9taXNlJF9zcHJlYWRBZGFwdGVyKHZhbCwgcmVjZWl2ZXIpIHtcbiAgICBpZiAoIXV0aWwuaXNBcnJheSh2YWwpKSByZXR1cm4gUHJvbWlzZSRfc3VjY2Vzc0FkYXB0ZXIodmFsLCByZWNlaXZlcik7XG4gICAgdmFyIHJldCA9IHV0aWwudHJ5Q2F0Y2hBcHBseSh0aGlzLCBbbnVsbF0uY29uY2F0KHZhbCksIHJlY2VpdmVyKTtcbiAgICBpZiAocmV0ID09PSBlcnJvck9iaikge1xuICAgICAgICBhc3luYy5pbnZva2VMYXRlcih0aHJvd2VyLCB2b2lkIDAsIHJldC5lKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIFByb21pc2UkX3N1Y2Nlc3NBZGFwdGVyKHZhbCwgcmVjZWl2ZXIpIHtcbiAgICB2YXIgbm9kZWJhY2sgPSB0aGlzO1xuICAgIHZhciByZXQgPSB2YWwgPT09IHZvaWQgMFxuICAgICAgICA/IHRyeUNhdGNoMShub2RlYmFjaywgcmVjZWl2ZXIsIG51bGwpXG4gICAgICAgIDogdHJ5Q2F0Y2gyKG5vZGViYWNrLCByZWNlaXZlciwgbnVsbCwgdmFsKTtcbiAgICBpZiAocmV0ID09PSBlcnJvck9iaikge1xuICAgICAgICBhc3luYy5pbnZva2VMYXRlcih0aHJvd2VyLCB2b2lkIDAsIHJldC5lKTtcbiAgICB9XG59XG5mdW5jdGlvbiBQcm9taXNlJF9lcnJvckFkYXB0ZXIocmVhc29uLCByZWNlaXZlcikge1xuICAgIHZhciBub2RlYmFjayA9IHRoaXM7XG4gICAgdmFyIHJldCA9IHRyeUNhdGNoMShub2RlYmFjaywgcmVjZWl2ZXIsIHJlYXNvbik7XG4gICAgaWYgKHJldCA9PT0gZXJyb3JPYmopIHtcbiAgICAgICAgYXN5bmMuaW52b2tlTGF0ZXIodGhyb3dlciwgdm9pZCAwLCByZXQuZSk7XG4gICAgfVxufVxuXG5Qcm9taXNlLnByb3RvdHlwZS5ub2RlaWZ5ID0gZnVuY3Rpb24gUHJvbWlzZSRub2RlaWZ5KG5vZGViYWNrLCBvcHRpb25zKSB7XG4gICAgaWYgKHR5cGVvZiBub2RlYmFjayA9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgdmFyIGFkYXB0ZXIgPSBQcm9taXNlJF9zdWNjZXNzQWRhcHRlcjtcbiAgICAgICAgaWYgKG9wdGlvbnMgIT09IHZvaWQgMCAmJiBPYmplY3Qob3B0aW9ucykuc3ByZWFkKSB7XG4gICAgICAgICAgICBhZGFwdGVyID0gUHJvbWlzZSRfc3ByZWFkQWRhcHRlcjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl90aGVuKFxuICAgICAgICAgICAgYWRhcHRlcixcbiAgICAgICAgICAgIFByb21pc2UkX2Vycm9yQWRhcHRlcixcbiAgICAgICAgICAgIHZvaWQgMCxcbiAgICAgICAgICAgIG5vZGViYWNrLFxuICAgICAgICAgICAgdGhpcy5fYm91bmRUb1xuICAgICAgICApO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbn07XG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSwgUHJvbWlzZUFycmF5LCBhcGlSZWplY3Rpb24sIGNhc3QsIElOVEVSTkFMKSB7XG52YXIgdXRpbCA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIik7XG52YXIgdHJ5Q2F0Y2g0ID0gdXRpbC50cnlDYXRjaDQ7XG52YXIgdHJ5Q2F0Y2gzID0gdXRpbC50cnlDYXRjaDM7XG52YXIgZXJyb3JPYmogPSB1dGlsLmVycm9yT2JqO1xuZnVuY3Rpb24gUmVkdWN0aW9uUHJvbWlzZUFycmF5KHByb21pc2VzLCBmbiwgYWNjdW0sIF9lYWNoKSB7XG4gICAgdGhpcy5jb25zdHJ1Y3RvciQocHJvbWlzZXMpO1xuICAgIHRoaXMuX3ByZXNlcnZlZFZhbHVlcyA9IF9lYWNoID09PSBJTlRFUk5BTCA/IFtdIDogbnVsbDtcbiAgICB0aGlzLl96ZXJvdGhJc0FjY3VtID0gKGFjY3VtID09PSB2b2lkIDApO1xuICAgIHRoaXMuX2dvdEFjY3VtID0gZmFsc2U7XG4gICAgdGhpcy5fcmVkdWNpbmdJbmRleCA9ICh0aGlzLl96ZXJvdGhJc0FjY3VtID8gMSA6IDApO1xuICAgIHRoaXMuX3ZhbHVlc1BoYXNlID0gdW5kZWZpbmVkO1xuXG4gICAgdmFyIG1heWJlUHJvbWlzZSA9IGNhc3QoYWNjdW0sIHZvaWQgMCk7XG4gICAgdmFyIHJlamVjdGVkID0gZmFsc2U7XG4gICAgdmFyIGlzUHJvbWlzZSA9IG1heWJlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2U7XG4gICAgaWYgKGlzUHJvbWlzZSkge1xuICAgICAgICBpZiAobWF5YmVQcm9taXNlLmlzUGVuZGluZygpKSB7XG4gICAgICAgICAgICBtYXliZVByb21pc2UuX3Byb3h5UHJvbWlzZUFycmF5KHRoaXMsIC0xKTtcbiAgICAgICAgfSBlbHNlIGlmIChtYXliZVByb21pc2UuaXNGdWxmaWxsZWQoKSkge1xuICAgICAgICAgICAgYWNjdW0gPSBtYXliZVByb21pc2UudmFsdWUoKTtcbiAgICAgICAgICAgIHRoaXMuX2dvdEFjY3VtID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1heWJlUHJvbWlzZS5fdW5zZXRSZWplY3Rpb25Jc1VuaGFuZGxlZCgpO1xuICAgICAgICAgICAgdGhpcy5fcmVqZWN0KG1heWJlUHJvbWlzZS5yZWFzb24oKSk7XG4gICAgICAgICAgICByZWplY3RlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKCEoaXNQcm9taXNlIHx8IHRoaXMuX3plcm90aElzQWNjdW0pKSB0aGlzLl9nb3RBY2N1bSA9IHRydWU7XG4gICAgdGhpcy5fY2FsbGJhY2sgPSBmbjtcbiAgICB0aGlzLl9hY2N1bSA9IGFjY3VtO1xuICAgIGlmICghcmVqZWN0ZWQpIHRoaXMuX2luaXQkKHZvaWQgMCwgLTUpO1xufVxudXRpbC5pbmhlcml0cyhSZWR1Y3Rpb25Qcm9taXNlQXJyYXksIFByb21pc2VBcnJheSk7XG5cblJlZHVjdGlvblByb21pc2VBcnJheS5wcm90b3R5cGUuX2luaXQgPVxuZnVuY3Rpb24gUmVkdWN0aW9uUHJvbWlzZUFycmF5JF9pbml0KCkge307XG5cblJlZHVjdGlvblByb21pc2VBcnJheS5wcm90b3R5cGUuX3Jlc29sdmVFbXB0eUFycmF5ID1cbmZ1bmN0aW9uIFJlZHVjdGlvblByb21pc2VBcnJheSRfcmVzb2x2ZUVtcHR5QXJyYXkoKSB7XG4gICAgaWYgKHRoaXMuX2dvdEFjY3VtIHx8IHRoaXMuX3plcm90aElzQWNjdW0pIHtcbiAgICAgICAgdGhpcy5fcmVzb2x2ZSh0aGlzLl9wcmVzZXJ2ZWRWYWx1ZXMgIT09IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgID8gW10gOiB0aGlzLl9hY2N1bSk7XG4gICAgfVxufTtcblxuUmVkdWN0aW9uUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fcHJvbWlzZUZ1bGZpbGxlZCA9XG5mdW5jdGlvbiBSZWR1Y3Rpb25Qcm9taXNlQXJyYXkkX3Byb21pc2VGdWxmaWxsZWQodmFsdWUsIGluZGV4KSB7XG4gICAgdmFyIHZhbHVlcyA9IHRoaXMuX3ZhbHVlcztcbiAgICBpZiAodmFsdWVzID09PSBudWxsKSByZXR1cm47XG4gICAgdmFyIGxlbmd0aCA9IHRoaXMubGVuZ3RoKCk7XG4gICAgdmFyIHByZXNlcnZlZFZhbHVlcyA9IHRoaXMuX3ByZXNlcnZlZFZhbHVlcztcbiAgICB2YXIgaXNFYWNoID0gcHJlc2VydmVkVmFsdWVzICE9PSBudWxsO1xuICAgIHZhciBnb3RBY2N1bSA9IHRoaXMuX2dvdEFjY3VtO1xuICAgIHZhciB2YWx1ZXNQaGFzZSA9IHRoaXMuX3ZhbHVlc1BoYXNlO1xuICAgIHZhciB2YWx1ZXNQaGFzZUluZGV4O1xuICAgIGlmICghdmFsdWVzUGhhc2UpIHtcbiAgICAgICAgdmFsdWVzUGhhc2UgPSB0aGlzLl92YWx1ZXNQaGFzZSA9IEFycmF5KGxlbmd0aCk7XG4gICAgICAgIGZvciAodmFsdWVzUGhhc2VJbmRleD0wOyB2YWx1ZXNQaGFzZUluZGV4PGxlbmd0aDsgKyt2YWx1ZXNQaGFzZUluZGV4KSB7XG4gICAgICAgICAgICB2YWx1ZXNQaGFzZVt2YWx1ZXNQaGFzZUluZGV4XSA9IDA7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmFsdWVzUGhhc2VJbmRleCA9IHZhbHVlc1BoYXNlW2luZGV4XTtcblxuICAgIGlmIChpbmRleCA9PT0gMCAmJiB0aGlzLl96ZXJvdGhJc0FjY3VtKSB7XG4gICAgICAgIGlmICghZ290QWNjdW0pIHtcbiAgICAgICAgICAgIHRoaXMuX2FjY3VtID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLl9nb3RBY2N1bSA9IGdvdEFjY3VtID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICB2YWx1ZXNQaGFzZVtpbmRleF0gPSAoKHZhbHVlc1BoYXNlSW5kZXggPT09IDApXG4gICAgICAgICAgICA/IDEgOiAyKTtcbiAgICB9IGVsc2UgaWYgKGluZGV4ID09PSAtMSkge1xuICAgICAgICBpZiAoIWdvdEFjY3VtKSB7XG4gICAgICAgICAgICB0aGlzLl9hY2N1bSA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5fZ290QWNjdW0gPSBnb3RBY2N1bSA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBpZiAodmFsdWVzUGhhc2VJbmRleCA9PT0gMCkge1xuICAgICAgICAgICAgdmFsdWVzUGhhc2VbaW5kZXhdID0gMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhbHVlc1BoYXNlW2luZGV4XSA9IDI7XG4gICAgICAgICAgICBpZiAoZ290QWNjdW0pIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9hY2N1bSA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGlmICghZ290QWNjdW0pIHJldHVybjtcblxuICAgIHZhciBjYWxsYmFjayA9IHRoaXMuX2NhbGxiYWNrO1xuICAgIHZhciByZWNlaXZlciA9IHRoaXMuX3Byb21pc2UuX2JvdW5kVG87XG4gICAgdmFyIHJldDtcblxuICAgIGZvciAodmFyIGkgPSB0aGlzLl9yZWR1Y2luZ0luZGV4OyBpIDwgbGVuZ3RoOyArK2kpIHtcbiAgICAgICAgdmFsdWVzUGhhc2VJbmRleCA9IHZhbHVlc1BoYXNlW2ldO1xuICAgICAgICBpZiAodmFsdWVzUGhhc2VJbmRleCA9PT0gMikge1xuICAgICAgICAgICAgdGhpcy5fcmVkdWNpbmdJbmRleCA9IGkgKyAxO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZhbHVlc1BoYXNlSW5kZXggIT09IDEpIHJldHVybjtcblxuICAgICAgICB2YWx1ZSA9IHZhbHVlc1tpXTtcbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlLmlzRnVsZmlsbGVkKCkpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLl9zZXR0bGVkVmFsdWU7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlLmlzUGVuZGluZygpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YWx1ZS5fdW5zZXRSZWplY3Rpb25Jc1VuaGFuZGxlZCgpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZWplY3QodmFsdWUucmVhc29uKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGlzRWFjaCkge1xuICAgICAgICAgICAgcHJlc2VydmVkVmFsdWVzLnB1c2godmFsdWUpO1xuICAgICAgICAgICAgcmV0ID0gdHJ5Q2F0Y2gzKGNhbGxiYWNrLCByZWNlaXZlciwgdmFsdWUsIGksIGxlbmd0aCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXQgPSB0cnlDYXRjaDQoY2FsbGJhY2ssIHJlY2VpdmVyLCB0aGlzLl9hY2N1bSwgdmFsdWUsIGksIGxlbmd0aCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocmV0ID09PSBlcnJvck9iaikgcmV0dXJuIHRoaXMuX3JlamVjdChyZXQuZSk7XG5cbiAgICAgICAgdmFyIG1heWJlUHJvbWlzZSA9IGNhc3QocmV0LCB2b2lkIDApO1xuICAgICAgICBpZiAobWF5YmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgICAgaWYgKG1heWJlUHJvbWlzZS5pc1BlbmRpbmcoKSkge1xuICAgICAgICAgICAgICAgIHZhbHVlc1BoYXNlW2ldID0gNDtcbiAgICAgICAgICAgICAgICByZXR1cm4gbWF5YmVQcm9taXNlLl9wcm94eVByb21pc2VBcnJheSh0aGlzLCBpKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobWF5YmVQcm9taXNlLmlzRnVsZmlsbGVkKCkpIHtcbiAgICAgICAgICAgICAgICByZXQgPSBtYXliZVByb21pc2UudmFsdWUoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbWF5YmVQcm9taXNlLl91bnNldFJlamVjdGlvbklzVW5oYW5kbGVkKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlamVjdChtYXliZVByb21pc2UucmVhc29uKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fcmVkdWNpbmdJbmRleCA9IGkgKyAxO1xuICAgICAgICB0aGlzLl9hY2N1bSA9IHJldDtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5fcmVkdWNpbmdJbmRleCA8IGxlbmd0aCkgcmV0dXJuO1xuICAgIHRoaXMuX3Jlc29sdmUoaXNFYWNoID8gcHJlc2VydmVkVmFsdWVzIDogdGhpcy5fYWNjdW0pO1xufTtcblxuZnVuY3Rpb24gcmVkdWNlKHByb21pc2VzLCBmbiwgaW5pdGlhbFZhbHVlLCBfZWFjaCkge1xuICAgIGlmICh0eXBlb2YgZm4gIT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIGFwaVJlamVjdGlvbihcImZuIG11c3QgYmUgYSBmdW5jdGlvblwiKTtcbiAgICB2YXIgYXJyYXkgPSBuZXcgUmVkdWN0aW9uUHJvbWlzZUFycmF5KHByb21pc2VzLCBmbiwgaW5pdGlhbFZhbHVlLCBfZWFjaCk7XG4gICAgcmV0dXJuIGFycmF5LnByb21pc2UoKTtcbn1cblxuUHJvbWlzZS5wcm90b3R5cGUucmVkdWNlID0gZnVuY3Rpb24gUHJvbWlzZSRyZWR1Y2UoZm4sIGluaXRpYWxWYWx1ZSkge1xuICAgIHJldHVybiByZWR1Y2UodGhpcywgZm4sIGluaXRpYWxWYWx1ZSwgbnVsbCk7XG59O1xuXG5Qcm9taXNlLnJlZHVjZSA9IGZ1bmN0aW9uIFByb21pc2UkUmVkdWNlKHByb21pc2VzLCBmbiwgaW5pdGlhbFZhbHVlLCBfZWFjaCkge1xuICAgIHJldHVybiByZWR1Y2UocHJvbWlzZXMsIGZuLCBpbml0aWFsVmFsdWUsIF9lYWNoKTtcbn07XG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID1cbiAgICBmdW5jdGlvbihQcm9taXNlLCBQcm9taXNlQXJyYXkpIHtcbnZhciBQcm9taXNlSW5zcGVjdGlvbiA9IFByb21pc2UuUHJvbWlzZUluc3BlY3Rpb247XG52YXIgdXRpbCA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIik7XG5cbmZ1bmN0aW9uIFNldHRsZWRQcm9taXNlQXJyYXkodmFsdWVzKSB7XG4gICAgdGhpcy5jb25zdHJ1Y3RvciQodmFsdWVzKTtcbn1cbnV0aWwuaW5oZXJpdHMoU2V0dGxlZFByb21pc2VBcnJheSwgUHJvbWlzZUFycmF5KTtcblxuU2V0dGxlZFByb21pc2VBcnJheS5wcm90b3R5cGUuX3Byb21pc2VSZXNvbHZlZCA9XG5mdW5jdGlvbiBTZXR0bGVkUHJvbWlzZUFycmF5JF9wcm9taXNlUmVzb2x2ZWQoaW5kZXgsIGluc3BlY3Rpb24pIHtcbiAgICB0aGlzLl92YWx1ZXNbaW5kZXhdID0gaW5zcGVjdGlvbjtcbiAgICB2YXIgdG90YWxSZXNvbHZlZCA9ICsrdGhpcy5fdG90YWxSZXNvbHZlZDtcbiAgICBpZiAodG90YWxSZXNvbHZlZCA+PSB0aGlzLl9sZW5ndGgpIHtcbiAgICAgICAgdGhpcy5fcmVzb2x2ZSh0aGlzLl92YWx1ZXMpO1xuICAgIH1cbn07XG5cblNldHRsZWRQcm9taXNlQXJyYXkucHJvdG90eXBlLl9wcm9taXNlRnVsZmlsbGVkID1cbmZ1bmN0aW9uIFNldHRsZWRQcm9taXNlQXJyYXkkX3Byb21pc2VGdWxmaWxsZWQodmFsdWUsIGluZGV4KSB7XG4gICAgaWYgKHRoaXMuX2lzUmVzb2x2ZWQoKSkgcmV0dXJuO1xuICAgIHZhciByZXQgPSBuZXcgUHJvbWlzZUluc3BlY3Rpb24oKTtcbiAgICByZXQuX2JpdEZpZWxkID0gMjY4NDM1NDU2O1xuICAgIHJldC5fc2V0dGxlZFZhbHVlID0gdmFsdWU7XG4gICAgdGhpcy5fcHJvbWlzZVJlc29sdmVkKGluZGV4LCByZXQpO1xufTtcblNldHRsZWRQcm9taXNlQXJyYXkucHJvdG90eXBlLl9wcm9taXNlUmVqZWN0ZWQgPVxuZnVuY3Rpb24gU2V0dGxlZFByb21pc2VBcnJheSRfcHJvbWlzZVJlamVjdGVkKHJlYXNvbiwgaW5kZXgpIHtcbiAgICBpZiAodGhpcy5faXNSZXNvbHZlZCgpKSByZXR1cm47XG4gICAgdmFyIHJldCA9IG5ldyBQcm9taXNlSW5zcGVjdGlvbigpO1xuICAgIHJldC5fYml0RmllbGQgPSAxMzQyMTc3Mjg7XG4gICAgcmV0Ll9zZXR0bGVkVmFsdWUgPSByZWFzb247XG4gICAgdGhpcy5fcHJvbWlzZVJlc29sdmVkKGluZGV4LCByZXQpO1xufTtcblxuUHJvbWlzZS5zZXR0bGUgPSBmdW5jdGlvbiBQcm9taXNlJFNldHRsZShwcm9taXNlcykge1xuICAgIHJldHVybiBuZXcgU2V0dGxlZFByb21pc2VBcnJheShwcm9taXNlcykucHJvbWlzZSgpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuc2V0dGxlID0gZnVuY3Rpb24gUHJvbWlzZSRzZXR0bGUoKSB7XG4gICAgcmV0dXJuIG5ldyBTZXR0bGVkUHJvbWlzZUFycmF5KHRoaXMpLnByb21pc2UoKTtcbn07XG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID1cbmZ1bmN0aW9uKFByb21pc2UsIFByb21pc2VBcnJheSwgYXBpUmVqZWN0aW9uKSB7XG52YXIgdXRpbCA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIik7XG52YXIgUmFuZ2VFcnJvciA9IHJlcXVpcmUoXCIuL2Vycm9ycy5qc1wiKS5SYW5nZUVycm9yO1xudmFyIEFnZ3JlZ2F0ZUVycm9yID0gcmVxdWlyZShcIi4vZXJyb3JzLmpzXCIpLkFnZ3JlZ2F0ZUVycm9yO1xudmFyIGlzQXJyYXkgPSB1dGlsLmlzQXJyYXk7XG5cblxuZnVuY3Rpb24gU29tZVByb21pc2VBcnJheSh2YWx1ZXMpIHtcbiAgICB0aGlzLmNvbnN0cnVjdG9yJCh2YWx1ZXMpO1xuICAgIHRoaXMuX2hvd01hbnkgPSAwO1xuICAgIHRoaXMuX3Vud3JhcCA9IGZhbHNlO1xuICAgIHRoaXMuX2luaXRpYWxpemVkID0gZmFsc2U7XG59XG51dGlsLmluaGVyaXRzKFNvbWVQcm9taXNlQXJyYXksIFByb21pc2VBcnJheSk7XG5cblNvbWVQcm9taXNlQXJyYXkucHJvdG90eXBlLl9pbml0ID0gZnVuY3Rpb24gU29tZVByb21pc2VBcnJheSRfaW5pdCgpIHtcbiAgICBpZiAoIXRoaXMuX2luaXRpYWxpemVkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHRoaXMuX2hvd01hbnkgPT09IDApIHtcbiAgICAgICAgdGhpcy5fcmVzb2x2ZShbXSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5faW5pdCQodm9pZCAwLCAtNSk7XG4gICAgdmFyIGlzQXJyYXlSZXNvbHZlZCA9IGlzQXJyYXkodGhpcy5fdmFsdWVzKTtcbiAgICBpZiAoIXRoaXMuX2lzUmVzb2x2ZWQoKSAmJlxuICAgICAgICBpc0FycmF5UmVzb2x2ZWQgJiZcbiAgICAgICAgdGhpcy5faG93TWFueSA+IHRoaXMuX2NhblBvc3NpYmx5RnVsZmlsbCgpKSB7XG4gICAgICAgIHRoaXMuX3JlamVjdCh0aGlzLl9nZXRSYW5nZUVycm9yKHRoaXMubGVuZ3RoKCkpKTtcbiAgICB9XG59O1xuXG5Tb21lUHJvbWlzZUFycmF5LnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gU29tZVByb21pc2VBcnJheSRpbml0KCkge1xuICAgIHRoaXMuX2luaXRpYWxpemVkID0gdHJ1ZTtcbiAgICB0aGlzLl9pbml0KCk7XG59O1xuXG5Tb21lUHJvbWlzZUFycmF5LnByb3RvdHlwZS5zZXRVbndyYXAgPSBmdW5jdGlvbiBTb21lUHJvbWlzZUFycmF5JHNldFVud3JhcCgpIHtcbiAgICB0aGlzLl91bndyYXAgPSB0cnVlO1xufTtcblxuU29tZVByb21pc2VBcnJheS5wcm90b3R5cGUuaG93TWFueSA9IGZ1bmN0aW9uIFNvbWVQcm9taXNlQXJyYXkkaG93TWFueSgpIHtcbiAgICByZXR1cm4gdGhpcy5faG93TWFueTtcbn07XG5cblNvbWVQcm9taXNlQXJyYXkucHJvdG90eXBlLnNldEhvd01hbnkgPVxuZnVuY3Rpb24gU29tZVByb21pc2VBcnJheSRzZXRIb3dNYW55KGNvdW50KSB7XG4gICAgaWYgKHRoaXMuX2lzUmVzb2x2ZWQoKSkgcmV0dXJuO1xuICAgIHRoaXMuX2hvd01hbnkgPSBjb3VudDtcbn07XG5cblNvbWVQcm9taXNlQXJyYXkucHJvdG90eXBlLl9wcm9taXNlRnVsZmlsbGVkID1cbmZ1bmN0aW9uIFNvbWVQcm9taXNlQXJyYXkkX3Byb21pc2VGdWxmaWxsZWQodmFsdWUpIHtcbiAgICBpZiAodGhpcy5faXNSZXNvbHZlZCgpKSByZXR1cm47XG4gICAgdGhpcy5fYWRkRnVsZmlsbGVkKHZhbHVlKTtcbiAgICBpZiAodGhpcy5fZnVsZmlsbGVkKCkgPT09IHRoaXMuaG93TWFueSgpKSB7XG4gICAgICAgIHRoaXMuX3ZhbHVlcy5sZW5ndGggPSB0aGlzLmhvd01hbnkoKTtcbiAgICAgICAgaWYgKHRoaXMuaG93TWFueSgpID09PSAxICYmIHRoaXMuX3Vud3JhcCkge1xuICAgICAgICAgICAgdGhpcy5fcmVzb2x2ZSh0aGlzLl92YWx1ZXNbMF0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fcmVzb2x2ZSh0aGlzLl92YWx1ZXMpO1xuICAgICAgICB9XG4gICAgfVxuXG59O1xuU29tZVByb21pc2VBcnJheS5wcm90b3R5cGUuX3Byb21pc2VSZWplY3RlZCA9XG5mdW5jdGlvbiBTb21lUHJvbWlzZUFycmF5JF9wcm9taXNlUmVqZWN0ZWQocmVhc29uKSB7XG4gICAgaWYgKHRoaXMuX2lzUmVzb2x2ZWQoKSkgcmV0dXJuO1xuICAgIHRoaXMuX2FkZFJlamVjdGVkKHJlYXNvbik7XG4gICAgaWYgKHRoaXMuaG93TWFueSgpID4gdGhpcy5fY2FuUG9zc2libHlGdWxmaWxsKCkpIHtcbiAgICAgICAgdmFyIGUgPSBuZXcgQWdncmVnYXRlRXJyb3IoKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IHRoaXMubGVuZ3RoKCk7IGkgPCB0aGlzLl92YWx1ZXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIGUucHVzaCh0aGlzLl92YWx1ZXNbaV0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3JlamVjdChlKTtcbiAgICB9XG59O1xuXG5Tb21lUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fZnVsZmlsbGVkID0gZnVuY3Rpb24gU29tZVByb21pc2VBcnJheSRfZnVsZmlsbGVkKCkge1xuICAgIHJldHVybiB0aGlzLl90b3RhbFJlc29sdmVkO1xufTtcblxuU29tZVByb21pc2VBcnJheS5wcm90b3R5cGUuX3JlamVjdGVkID0gZnVuY3Rpb24gU29tZVByb21pc2VBcnJheSRfcmVqZWN0ZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3ZhbHVlcy5sZW5ndGggLSB0aGlzLmxlbmd0aCgpO1xufTtcblxuU29tZVByb21pc2VBcnJheS5wcm90b3R5cGUuX2FkZFJlamVjdGVkID1cbmZ1bmN0aW9uIFNvbWVQcm9taXNlQXJyYXkkX2FkZFJlamVjdGVkKHJlYXNvbikge1xuICAgIHRoaXMuX3ZhbHVlcy5wdXNoKHJlYXNvbik7XG59O1xuXG5Tb21lUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fYWRkRnVsZmlsbGVkID1cbmZ1bmN0aW9uIFNvbWVQcm9taXNlQXJyYXkkX2FkZEZ1bGZpbGxlZCh2YWx1ZSkge1xuICAgIHRoaXMuX3ZhbHVlc1t0aGlzLl90b3RhbFJlc29sdmVkKytdID0gdmFsdWU7XG59O1xuXG5Tb21lUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fY2FuUG9zc2libHlGdWxmaWxsID1cbmZ1bmN0aW9uIFNvbWVQcm9taXNlQXJyYXkkX2NhblBvc3NpYmx5RnVsZmlsbCgpIHtcbiAgICByZXR1cm4gdGhpcy5sZW5ndGgoKSAtIHRoaXMuX3JlamVjdGVkKCk7XG59O1xuXG5Tb21lUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fZ2V0UmFuZ2VFcnJvciA9XG5mdW5jdGlvbiBTb21lUHJvbWlzZUFycmF5JF9nZXRSYW5nZUVycm9yKGNvdW50KSB7XG4gICAgdmFyIG1lc3NhZ2UgPSBcIklucHV0IGFycmF5IG11c3QgY29udGFpbiBhdCBsZWFzdCBcIiArXG4gICAgICAgICAgICB0aGlzLl9ob3dNYW55ICsgXCIgaXRlbXMgYnV0IGNvbnRhaW5zIG9ubHkgXCIgKyBjb3VudCArIFwiIGl0ZW1zXCI7XG4gICAgcmV0dXJuIG5ldyBSYW5nZUVycm9yKG1lc3NhZ2UpO1xufTtcblxuU29tZVByb21pc2VBcnJheS5wcm90b3R5cGUuX3Jlc29sdmVFbXB0eUFycmF5ID1cbmZ1bmN0aW9uIFNvbWVQcm9taXNlQXJyYXkkX3Jlc29sdmVFbXB0eUFycmF5KCkge1xuICAgIHRoaXMuX3JlamVjdCh0aGlzLl9nZXRSYW5nZUVycm9yKDApKTtcbn07XG5cbmZ1bmN0aW9uIFByb21pc2UkX1NvbWUocHJvbWlzZXMsIGhvd01hbnkpIHtcbiAgICBpZiAoKGhvd01hbnkgfCAwKSAhPT0gaG93TWFueSB8fCBob3dNYW55IDwgMCkge1xuICAgICAgICByZXR1cm4gYXBpUmVqZWN0aW9uKFwiZXhwZWN0aW5nIGEgcG9zaXRpdmUgaW50ZWdlclwiKTtcbiAgICB9XG4gICAgdmFyIHJldCA9IG5ldyBTb21lUHJvbWlzZUFycmF5KHByb21pc2VzKTtcbiAgICB2YXIgcHJvbWlzZSA9IHJldC5wcm9taXNlKCk7XG4gICAgaWYgKHByb21pc2UuaXNSZWplY3RlZCgpKSB7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH1cbiAgICByZXQuc2V0SG93TWFueShob3dNYW55KTtcbiAgICByZXQuaW5pdCgpO1xuICAgIHJldHVybiBwcm9taXNlO1xufVxuXG5Qcm9taXNlLnNvbWUgPSBmdW5jdGlvbiBQcm9taXNlJFNvbWUocHJvbWlzZXMsIGhvd01hbnkpIHtcbiAgICByZXR1cm4gUHJvbWlzZSRfU29tZShwcm9taXNlcywgaG93TWFueSk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5zb21lID0gZnVuY3Rpb24gUHJvbWlzZSRzb21lKGhvd01hbnkpIHtcbiAgICByZXR1cm4gUHJvbWlzZSRfU29tZSh0aGlzLCBob3dNYW55KTtcbn07XG5cblByb21pc2UuX1NvbWVQcm9taXNlQXJyYXkgPSBTb21lUHJvbWlzZUFycmF5O1xufTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UsIFByb21pc2VBcnJheSkge1xudmFyIHV0aWwgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpO1xudmFyIGFzeW5jID0gcmVxdWlyZShcIi4vYXN5bmMuanNcIik7XG52YXIgZXJyb3JzID0gcmVxdWlyZShcIi4vZXJyb3JzLmpzXCIpO1xudmFyIHRyeUNhdGNoMSA9IHV0aWwudHJ5Q2F0Y2gxO1xudmFyIGVycm9yT2JqID0gdXRpbC5lcnJvck9iajtcblxuUHJvbWlzZS5wcm90b3R5cGUucHJvZ3Jlc3NlZCA9IGZ1bmN0aW9uIFByb21pc2UkcHJvZ3Jlc3NlZChoYW5kbGVyKSB7XG4gICAgcmV0dXJuIHRoaXMuX3RoZW4odm9pZCAwLCB2b2lkIDAsIGhhbmRsZXIsIHZvaWQgMCwgdm9pZCAwKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9wcm9ncmVzcyA9IGZ1bmN0aW9uIFByb21pc2UkX3Byb2dyZXNzKHByb2dyZXNzVmFsdWUpIHtcbiAgICBpZiAodGhpcy5faXNGb2xsb3dpbmdPckZ1bGZpbGxlZE9yUmVqZWN0ZWQoKSkgcmV0dXJuO1xuICAgIHRoaXMuX3Byb2dyZXNzVW5jaGVja2VkKHByb2dyZXNzVmFsdWUpO1xuXG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fcHJvZ3Jlc3NIYW5kbGVyQXQgPVxuZnVuY3Rpb24gUHJvbWlzZSRfcHJvZ3Jlc3NIYW5kbGVyQXQoaW5kZXgpIHtcbiAgICByZXR1cm4gaW5kZXggPT09IDBcbiAgICAgICAgPyB0aGlzLl9wcm9ncmVzc0hhbmRsZXIwXG4gICAgICAgIDogdGhpc1soaW5kZXggPDwgMikgKyBpbmRleCAtIDUgKyAyXTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9kb1Byb2dyZXNzV2l0aCA9XG5mdW5jdGlvbiBQcm9taXNlJF9kb1Byb2dyZXNzV2l0aChwcm9ncmVzc2lvbikge1xuICAgIHZhciBwcm9ncmVzc1ZhbHVlID0gcHJvZ3Jlc3Npb24udmFsdWU7XG4gICAgdmFyIGhhbmRsZXIgPSBwcm9ncmVzc2lvbi5oYW5kbGVyO1xuICAgIHZhciBwcm9taXNlID0gcHJvZ3Jlc3Npb24ucHJvbWlzZTtcbiAgICB2YXIgcmVjZWl2ZXIgPSBwcm9ncmVzc2lvbi5yZWNlaXZlcjtcblxuICAgIHZhciByZXQgPSB0cnlDYXRjaDEoaGFuZGxlciwgcmVjZWl2ZXIsIHByb2dyZXNzVmFsdWUpO1xuICAgIGlmIChyZXQgPT09IGVycm9yT2JqKSB7XG4gICAgICAgIGlmIChyZXQuZSAhPSBudWxsICYmXG4gICAgICAgICAgICByZXQuZS5uYW1lICE9PSBcIlN0b3BQcm9ncmVzc1Byb3BhZ2F0aW9uXCIpIHtcbiAgICAgICAgICAgIHZhciB0cmFjZSA9IGVycm9ycy5jYW5BdHRhY2gocmV0LmUpXG4gICAgICAgICAgICAgICAgPyByZXQuZSA6IG5ldyBFcnJvcihyZXQuZSArIFwiXCIpO1xuICAgICAgICAgICAgcHJvbWlzZS5fYXR0YWNoRXh0cmFUcmFjZSh0cmFjZSk7XG4gICAgICAgICAgICBwcm9taXNlLl9wcm9ncmVzcyhyZXQuZSk7XG4gICAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHJldCBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgcmV0Ll90aGVuKHByb21pc2UuX3Byb2dyZXNzLCBudWxsLCBudWxsLCBwcm9taXNlLCB2b2lkIDApO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHByb21pc2UuX3Byb2dyZXNzKHJldCk7XG4gICAgfVxufTtcblxuXG5Qcm9taXNlLnByb3RvdHlwZS5fcHJvZ3Jlc3NVbmNoZWNrZWQgPVxuZnVuY3Rpb24gUHJvbWlzZSRfcHJvZ3Jlc3NVbmNoZWNrZWQocHJvZ3Jlc3NWYWx1ZSkge1xuICAgIGlmICghdGhpcy5pc1BlbmRpbmcoKSkgcmV0dXJuO1xuICAgIHZhciBsZW4gPSB0aGlzLl9sZW5ndGgoKTtcbiAgICB2YXIgcHJvZ3Jlc3MgPSB0aGlzLl9wcm9ncmVzcztcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIHZhciBoYW5kbGVyID0gdGhpcy5fcHJvZ3Jlc3NIYW5kbGVyQXQoaSk7XG4gICAgICAgIHZhciBwcm9taXNlID0gdGhpcy5fcHJvbWlzZUF0KGkpO1xuICAgICAgICBpZiAoIShwcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHZhciByZWNlaXZlciA9IHRoaXMuX3JlY2VpdmVyQXQoaSk7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGhhbmRsZXIgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgIGhhbmRsZXIuY2FsbChyZWNlaXZlciwgcHJvZ3Jlc3NWYWx1ZSwgcHJvbWlzZSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlY2VpdmVyIGluc3RhbmNlb2YgUHJvbWlzZSAmJiByZWNlaXZlci5faXNQcm94aWVkKCkpIHtcbiAgICAgICAgICAgICAgICByZWNlaXZlci5fcHJvZ3Jlc3NVbmNoZWNrZWQocHJvZ3Jlc3NWYWx1ZSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlY2VpdmVyIGluc3RhbmNlb2YgUHJvbWlzZUFycmF5KSB7XG4gICAgICAgICAgICAgICAgcmVjZWl2ZXIuX3Byb21pc2VQcm9ncmVzc2VkKHByb2dyZXNzVmFsdWUsIHByb21pc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodHlwZW9mIGhhbmRsZXIgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgYXN5bmMuaW52b2tlKHRoaXMuX2RvUHJvZ3Jlc3NXaXRoLCB0aGlzLCB7XG4gICAgICAgICAgICAgICAgaGFuZGxlcjogaGFuZGxlcixcbiAgICAgICAgICAgICAgICBwcm9taXNlOiBwcm9taXNlLFxuICAgICAgICAgICAgICAgIHJlY2VpdmVyOiB0aGlzLl9yZWNlaXZlckF0KGkpLFxuICAgICAgICAgICAgICAgIHZhbHVlOiBwcm9ncmVzc1ZhbHVlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGFzeW5jLmludm9rZShwcm9ncmVzcywgcHJvbWlzZSwgcHJvZ3Jlc3NWYWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG59O1xufTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UsIElOVEVSTkFMKSB7XG52YXIgZXJyb3JzID0gcmVxdWlyZShcIi4vZXJyb3JzLmpzXCIpO1xudmFyIGNhbkF0dGFjaCA9IGVycm9ycy5jYW5BdHRhY2g7XG52YXIgYXN5bmMgPSByZXF1aXJlKFwiLi9hc3luYy5qc1wiKTtcbnZhciBDYW5jZWxsYXRpb25FcnJvciA9IGVycm9ycy5DYW5jZWxsYXRpb25FcnJvcjtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2NhbmNlbCA9IGZ1bmN0aW9uIFByb21pc2UkX2NhbmNlbChyZWFzb24pIHtcbiAgICBpZiAoIXRoaXMuaXNDYW5jZWxsYWJsZSgpKSByZXR1cm4gdGhpcztcbiAgICB2YXIgcGFyZW50O1xuICAgIHZhciBwcm9taXNlVG9SZWplY3QgPSB0aGlzO1xuICAgIHdoaWxlICgocGFyZW50ID0gcHJvbWlzZVRvUmVqZWN0Ll9jYW5jZWxsYXRpb25QYXJlbnQpICE9PSB2b2lkIDAgJiZcbiAgICAgICAgcGFyZW50LmlzQ2FuY2VsbGFibGUoKSkge1xuICAgICAgICBwcm9taXNlVG9SZWplY3QgPSBwYXJlbnQ7XG4gICAgfVxuICAgIHByb21pc2VUb1JlamVjdC5fYXR0YWNoRXh0cmFUcmFjZShyZWFzb24pO1xuICAgIHByb21pc2VUb1JlamVjdC5fcmVqZWN0VW5jaGVja2VkKHJlYXNvbik7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5jYW5jZWwgPSBmdW5jdGlvbiBQcm9taXNlJGNhbmNlbChyZWFzb24pIHtcbiAgICBpZiAoIXRoaXMuaXNDYW5jZWxsYWJsZSgpKSByZXR1cm4gdGhpcztcbiAgICByZWFzb24gPSByZWFzb24gIT09IHZvaWQgMFxuICAgICAgICA/IChjYW5BdHRhY2gocmVhc29uKSA/IHJlYXNvbiA6IG5ldyBFcnJvcihyZWFzb24gKyBcIlwiKSlcbiAgICAgICAgOiBuZXcgQ2FuY2VsbGF0aW9uRXJyb3IoKTtcbiAgICBhc3luYy5pbnZva2VMYXRlcih0aGlzLl9jYW5jZWwsIHRoaXMsIHJlYXNvbik7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5jYW5jZWxsYWJsZSA9IGZ1bmN0aW9uIFByb21pc2UkY2FuY2VsbGFibGUoKSB7XG4gICAgaWYgKHRoaXMuX2NhbmNlbGxhYmxlKCkpIHJldHVybiB0aGlzO1xuICAgIHRoaXMuX3NldENhbmNlbGxhYmxlKCk7XG4gICAgdGhpcy5fY2FuY2VsbGF0aW9uUGFyZW50ID0gdm9pZCAwO1xuICAgIHJldHVybiB0aGlzO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUudW5jYW5jZWxsYWJsZSA9IGZ1bmN0aW9uIFByb21pc2UkdW5jYW5jZWxsYWJsZSgpIHtcbiAgICB2YXIgcmV0ID0gbmV3IFByb21pc2UoSU5URVJOQUwpO1xuICAgIHJldC5fcHJvcGFnYXRlRnJvbSh0aGlzLCAyIHwgNCk7XG4gICAgcmV0Ll9mb2xsb3codGhpcyk7XG4gICAgcmV0Ll91bnNldENhbmNlbGxhYmxlKCk7XG4gICAgcmV0dXJuIHJldDtcbn07XG5cblByb21pc2UucHJvdG90eXBlLmZvcmsgPVxuZnVuY3Rpb24gUHJvbWlzZSRmb3JrKGRpZEZ1bGZpbGwsIGRpZFJlamVjdCwgZGlkUHJvZ3Jlc3MpIHtcbiAgICB2YXIgcmV0ID0gdGhpcy5fdGhlbihkaWRGdWxmaWxsLCBkaWRSZWplY3QsIGRpZFByb2dyZXNzLFxuICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgMCwgdm9pZCAwKTtcblxuICAgIHJldC5fc2V0Q2FuY2VsbGFibGUoKTtcbiAgICByZXQuX2NhbmNlbGxhdGlvblBhcmVudCA9IHZvaWQgMDtcbiAgICByZXR1cm4gcmV0O1xufTtcbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoUHJvbWlzZSwgYXBpUmVqZWN0aW9uLCBjYXN0KSB7XG4gICAgdmFyIFR5cGVFcnJvciA9IHJlcXVpcmUoXCIuL2Vycm9ycy5qc1wiKS5UeXBlRXJyb3I7XG4gICAgdmFyIGluaGVyaXRzID0gcmVxdWlyZShcIi4vdXRpbC5qc1wiKS5pbmhlcml0cztcbiAgICB2YXIgUHJvbWlzZUluc3BlY3Rpb24gPSBQcm9taXNlLlByb21pc2VJbnNwZWN0aW9uO1xuXG4gICAgZnVuY3Rpb24gaW5zcGVjdGlvbk1hcHBlcihpbnNwZWN0aW9ucykge1xuICAgICAgICB2YXIgbGVuID0gaW5zcGVjdGlvbnMubGVuZ3RoO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgICAgICB2YXIgaW5zcGVjdGlvbiA9IGluc3BlY3Rpb25zW2ldO1xuICAgICAgICAgICAgaWYgKGluc3BlY3Rpb24uaXNSZWplY3RlZCgpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGluc3BlY3Rpb24uZXJyb3IoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpbnNwZWN0aW9uc1tpXSA9IGluc3BlY3Rpb24udmFsdWUoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaW5zcGVjdGlvbnM7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdGhyb3dlcihlKSB7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXt0aHJvdyBlO30sIDApO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRpc3Bvc2UocmVzb3VyY2VzLCBpbnNwZWN0aW9uKSB7XG4gICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgdmFyIGxlbiA9IHJlc291cmNlcy5sZW5ndGg7XG4gICAgICAgIHZhciByZXQgPSBQcm9taXNlLmRlZmVyKCk7XG4gICAgICAgIGZ1bmN0aW9uIGl0ZXJhdG9yKCkge1xuICAgICAgICAgICAgaWYgKGkgPj0gbGVuKSByZXR1cm4gcmV0LnJlc29sdmUoKTtcbiAgICAgICAgICAgIHZhciBtYXliZVByb21pc2UgPSBjYXN0KHJlc291cmNlc1tpKytdLCB2b2lkIDApO1xuICAgICAgICAgICAgaWYgKG1heWJlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UgJiZcbiAgICAgICAgICAgICAgICBtYXliZVByb21pc2UuX2lzRGlzcG9zYWJsZSgpKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgbWF5YmVQcm9taXNlID0gY2FzdChtYXliZVByb21pc2UuX2dldERpc3Bvc2VyKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudHJ5RGlzcG9zZShpbnNwZWN0aW9uKSwgdm9pZCAwKTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aHJvd2VyKGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobWF5YmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWF5YmVQcm9taXNlLl90aGVuKGl0ZXJhdG9yLCB0aHJvd2VyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bGwsIG51bGwsIG51bGwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGl0ZXJhdG9yKCk7XG4gICAgICAgIH1cbiAgICAgICAgaXRlcmF0b3IoKTtcbiAgICAgICAgcmV0dXJuIHJldC5wcm9taXNlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRpc3Bvc2VyU3VjY2Vzcyh2YWx1ZSkge1xuICAgICAgICB2YXIgaW5zcGVjdGlvbiA9IG5ldyBQcm9taXNlSW5zcGVjdGlvbigpO1xuICAgICAgICBpbnNwZWN0aW9uLl9zZXR0bGVkVmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgaW5zcGVjdGlvbi5fYml0RmllbGQgPSAyNjg0MzU0NTY7XG4gICAgICAgIHJldHVybiBkaXNwb3NlKHRoaXMsIGluc3BlY3Rpb24pLnRoZW5SZXR1cm4odmFsdWUpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRpc3Bvc2VyRmFpbChyZWFzb24pIHtcbiAgICAgICAgdmFyIGluc3BlY3Rpb24gPSBuZXcgUHJvbWlzZUluc3BlY3Rpb24oKTtcbiAgICAgICAgaW5zcGVjdGlvbi5fc2V0dGxlZFZhbHVlID0gcmVhc29uO1xuICAgICAgICBpbnNwZWN0aW9uLl9iaXRGaWVsZCA9IDEzNDIxNzcyODtcbiAgICAgICAgcmV0dXJuIGRpc3Bvc2UodGhpcywgaW5zcGVjdGlvbikudGhlblRocm93KHJlYXNvbik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gRGlzcG9zZXIoZGF0YSwgcHJvbWlzZSkge1xuICAgICAgICB0aGlzLl9kYXRhID0gZGF0YTtcbiAgICAgICAgdGhpcy5fcHJvbWlzZSA9IHByb21pc2U7XG4gICAgfVxuXG4gICAgRGlzcG9zZXIucHJvdG90eXBlLmRhdGEgPSBmdW5jdGlvbiBEaXNwb3NlciRkYXRhKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZGF0YTtcbiAgICB9O1xuXG4gICAgRGlzcG9zZXIucHJvdG90eXBlLnByb21pc2UgPSBmdW5jdGlvbiBEaXNwb3NlciRwcm9taXNlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcHJvbWlzZTtcbiAgICB9O1xuXG4gICAgRGlzcG9zZXIucHJvdG90eXBlLnJlc291cmNlID0gZnVuY3Rpb24gRGlzcG9zZXIkcmVzb3VyY2UoKSB7XG4gICAgICAgIGlmICh0aGlzLnByb21pc2UoKS5pc0Z1bGZpbGxlZCgpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9taXNlKCkudmFsdWUoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuXG4gICAgRGlzcG9zZXIucHJvdG90eXBlLnRyeURpc3Bvc2UgPSBmdW5jdGlvbihpbnNwZWN0aW9uKSB7XG4gICAgICAgIHZhciByZXNvdXJjZSA9IHRoaXMucmVzb3VyY2UoKTtcbiAgICAgICAgdmFyIHJldCA9IHJlc291cmNlICE9PSBudWxsXG4gICAgICAgICAgICA/IHRoaXMuZG9EaXNwb3NlKHJlc291cmNlLCBpbnNwZWN0aW9uKSA6IG51bGw7XG4gICAgICAgIHRoaXMuX3Byb21pc2UuX3Vuc2V0RGlzcG9zYWJsZSgpO1xuICAgICAgICB0aGlzLl9kYXRhID0gdGhpcy5fcHJvbWlzZSA9IG51bGw7XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIEZ1bmN0aW9uRGlzcG9zZXIoZm4sIHByb21pc2UpIHtcbiAgICAgICAgdGhpcy5jb25zdHJ1Y3RvciQoZm4sIHByb21pc2UpO1xuICAgIH1cbiAgICBpbmhlcml0cyhGdW5jdGlvbkRpc3Bvc2VyLCBEaXNwb3Nlcik7XG5cbiAgICBGdW5jdGlvbkRpc3Bvc2VyLnByb3RvdHlwZS5kb0Rpc3Bvc2UgPSBmdW5jdGlvbiAocmVzb3VyY2UsIGluc3BlY3Rpb24pIHtcbiAgICAgICAgdmFyIGZuID0gdGhpcy5kYXRhKCk7XG4gICAgICAgIHJldHVybiBmbi5jYWxsKHJlc291cmNlLCByZXNvdXJjZSwgaW5zcGVjdGlvbik7XG4gICAgfTtcblxuICAgIFByb21pc2UudXNpbmcgPSBmdW5jdGlvbiBQcm9taXNlJHVzaW5nKCkge1xuICAgICAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aDtcbiAgICAgICAgaWYgKGxlbiA8IDIpIHJldHVybiBhcGlSZWplY3Rpb24oXG4gICAgICAgICAgICAgICAgICAgICAgICBcInlvdSBtdXN0IHBhc3MgYXQgbGVhc3QgMiBhcmd1bWVudHMgdG8gUHJvbWlzZS51c2luZ1wiKTtcbiAgICAgICAgdmFyIGZuID0gYXJndW1lbnRzW2xlbiAtIDFdO1xuICAgICAgICBpZiAodHlwZW9mIGZuICE9PSBcImZ1bmN0aW9uXCIpIHJldHVybiBhcGlSZWplY3Rpb24oXCJmbiBtdXN0IGJlIGEgZnVuY3Rpb25cIik7XG4gICAgICAgIGxlbi0tO1xuICAgICAgICB2YXIgcmVzb3VyY2VzID0gbmV3IEFycmF5KGxlbik7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyArK2kpIHtcbiAgICAgICAgICAgIHZhciByZXNvdXJjZSA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgICAgIGlmIChyZXNvdXJjZSBpbnN0YW5jZW9mIERpc3Bvc2VyKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRpc3Bvc2VyID0gcmVzb3VyY2U7XG4gICAgICAgICAgICAgICAgcmVzb3VyY2UgPSByZXNvdXJjZS5wcm9taXNlKCk7XG4gICAgICAgICAgICAgICAgcmVzb3VyY2UuX3NldERpc3Bvc2FibGUoZGlzcG9zZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVzb3VyY2VzW2ldID0gcmVzb3VyY2U7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gUHJvbWlzZS5zZXR0bGUocmVzb3VyY2VzKVxuICAgICAgICAgICAgLnRoZW4oaW5zcGVjdGlvbk1hcHBlcilcbiAgICAgICAgICAgIC5zcHJlYWQoZm4pXG4gICAgICAgICAgICAuX3RoZW4oZGlzcG9zZXJTdWNjZXNzLCBkaXNwb3NlckZhaWwsIHZvaWQgMCwgcmVzb3VyY2VzLCB2b2lkIDApO1xuICAgIH07XG5cbiAgICBQcm9taXNlLnByb3RvdHlwZS5fc2V0RGlzcG9zYWJsZSA9XG4gICAgZnVuY3Rpb24gUHJvbWlzZSRfc2V0RGlzcG9zYWJsZShkaXNwb3Nlcikge1xuICAgICAgICB0aGlzLl9iaXRGaWVsZCA9IHRoaXMuX2JpdEZpZWxkIHwgMjYyMTQ0O1xuICAgICAgICB0aGlzLl9kaXNwb3NlciA9IGRpc3Bvc2VyO1xuICAgIH07XG5cbiAgICBQcm9taXNlLnByb3RvdHlwZS5faXNEaXNwb3NhYmxlID0gZnVuY3Rpb24gUHJvbWlzZSRfaXNEaXNwb3NhYmxlKCkge1xuICAgICAgICByZXR1cm4gKHRoaXMuX2JpdEZpZWxkICYgMjYyMTQ0KSA+IDA7XG4gICAgfTtcblxuICAgIFByb21pc2UucHJvdG90eXBlLl9nZXREaXNwb3NlciA9IGZ1bmN0aW9uIFByb21pc2UkX2dldERpc3Bvc2VyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZGlzcG9zZXI7XG4gICAgfTtcblxuICAgIFByb21pc2UucHJvdG90eXBlLl91bnNldERpc3Bvc2FibGUgPSBmdW5jdGlvbiBQcm9taXNlJF91bnNldERpc3Bvc2FibGUoKSB7XG4gICAgICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgJiAofjI2MjE0NCk7XG4gICAgICAgIHRoaXMuX2Rpc3Bvc2VyID0gdm9pZCAwO1xuICAgIH07XG5cbiAgICBQcm9taXNlLnByb3RvdHlwZS5kaXNwb3NlciA9IGZ1bmN0aW9uIFByb21pc2UkZGlzcG9zZXIoZm4pIHtcbiAgICAgICAgaWYgKHR5cGVvZiBmbiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEZ1bmN0aW9uRGlzcG9zZXIoZm4sIHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoKTtcbiAgICB9O1xuXG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSkge1xudmFyIFR5cGVFcnJvciA9IHJlcXVpcmUoJy4vZXJyb3JzLmpzJykuVHlwZUVycm9yO1xuXG5mdW5jdGlvbiBhcGlSZWplY3Rpb24obXNnKSB7XG4gICAgdmFyIGVycm9yID0gbmV3IFR5cGVFcnJvcihtc2cpO1xuICAgIHZhciByZXQgPSBQcm9taXNlLnJlamVjdGVkKGVycm9yKTtcbiAgICB2YXIgcGFyZW50ID0gcmV0Ll9wZWVrQ29udGV4dCgpO1xuICAgIGlmIChwYXJlbnQgIT0gbnVsbCkge1xuICAgICAgICBwYXJlbnQuX2F0dGFjaEV4dHJhVHJhY2UoZXJyb3IpO1xuICAgIH1cbiAgICByZXR1cm4gcmV0O1xufVxuXG5yZXR1cm4gYXBpUmVqZWN0aW9uO1xufTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX3NldFRpbWVvdXQgPSBmdW5jdGlvbihmbiwgbXMpIHtcbiAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aDtcbiAgICB2YXIgYXJnMCA9IGFyZ3VtZW50c1syXTtcbiAgICB2YXIgYXJnMSA9IGFyZ3VtZW50c1szXTtcbiAgICB2YXIgYXJnMiA9IGxlbiA+PSA1ID8gYXJndW1lbnRzWzRdIDogdm9pZCAwO1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgIGZuKGFyZzAsIGFyZzEsIGFyZzIpO1xuICAgIH0sIG1zKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSwgSU5URVJOQUwsIGNhc3QpIHtcbnZhciB1dGlsID0gcmVxdWlyZShcIi4vdXRpbC5qc1wiKTtcbnZhciBlcnJvcnMgPSByZXF1aXJlKFwiLi9lcnJvcnMuanNcIik7XG52YXIgYXBpUmVqZWN0aW9uID0gcmVxdWlyZShcIi4vZXJyb3JzX2FwaV9yZWplY3Rpb25cIikoUHJvbWlzZSk7XG52YXIgVGltZW91dEVycm9yID0gUHJvbWlzZS5UaW1lb3V0RXJyb3I7XG5cbnZhciBhZnRlclRpbWVvdXQgPSBmdW5jdGlvbiBQcm9taXNlJF9hZnRlclRpbWVvdXQocHJvbWlzZSwgbWVzc2FnZSwgbXMpIHtcbiAgICBpZiAoIXByb21pc2UuaXNQZW5kaW5nKCkpIHJldHVybjtcbiAgICBpZiAodHlwZW9mIG1lc3NhZ2UgIT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgbWVzc2FnZSA9IFwib3BlcmF0aW9uIHRpbWVkIG91dCBhZnRlclwiICsgXCIgXCIgKyBtcyArIFwiIG1zXCJcbiAgICB9XG4gICAgdmFyIGVyciA9IG5ldyBUaW1lb3V0RXJyb3IobWVzc2FnZSk7XG4gICAgZXJyb3JzLm1hcmtBc09yaWdpbmF0aW5nRnJvbVJlamVjdGlvbihlcnIpO1xuICAgIHByb21pc2UuX2F0dGFjaEV4dHJhVHJhY2UoZXJyKTtcbiAgICBwcm9taXNlLl9jYW5jZWwoZXJyKTtcbn07XG5cbnZhciBhZnRlckRlbGF5ID0gZnVuY3Rpb24gUHJvbWlzZSRfYWZ0ZXJEZWxheSh2YWx1ZSwgcHJvbWlzZSkge1xuICAgIHByb21pc2UuX2Z1bGZpbGwodmFsdWUpO1xufTtcblxudmFyIGRlbGF5ID0gUHJvbWlzZS5kZWxheSA9IGZ1bmN0aW9uIFByb21pc2UkRGVsYXkodmFsdWUsIG1zKSB7XG4gICAgaWYgKG1zID09PSB2b2lkIDApIHtcbiAgICAgICAgbXMgPSB2YWx1ZTtcbiAgICAgICAgdmFsdWUgPSB2b2lkIDA7XG4gICAgfVxuICAgIG1zID0gK21zO1xuICAgIHZhciBtYXliZVByb21pc2UgPSBjYXN0KHZhbHVlLCB2b2lkIDApO1xuICAgIHZhciBwcm9taXNlID0gbmV3IFByb21pc2UoSU5URVJOQUwpO1xuXG4gICAgaWYgKG1heWJlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgcHJvbWlzZS5fcHJvcGFnYXRlRnJvbShtYXliZVByb21pc2UsIDcpO1xuICAgICAgICBwcm9taXNlLl9mb2xsb3cobWF5YmVQcm9taXNlKTtcbiAgICAgICAgcmV0dXJuIHByb21pc2UudGhlbihmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuZGVsYXkodmFsdWUsIG1zKTtcbiAgICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcHJvbWlzZS5fc2V0VHJhY2Uodm9pZCAwKTtcbiAgICAgICAgX3NldFRpbWVvdXQoYWZ0ZXJEZWxheSwgbXMsIHZhbHVlLCBwcm9taXNlKTtcbiAgICB9XG4gICAgcmV0dXJuIHByb21pc2U7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5kZWxheSA9IGZ1bmN0aW9uIFByb21pc2UkZGVsYXkobXMpIHtcbiAgICByZXR1cm4gZGVsYXkodGhpcywgbXMpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUudGltZW91dCA9IGZ1bmN0aW9uIFByb21pc2UkdGltZW91dChtcywgbWVzc2FnZSkge1xuICAgIG1zID0gK21zO1xuXG4gICAgdmFyIHJldCA9IG5ldyBQcm9taXNlKElOVEVSTkFMKTtcbiAgICByZXQuX3Byb3BhZ2F0ZUZyb20odGhpcywgNyk7XG4gICAgcmV0Ll9mb2xsb3codGhpcyk7XG4gICAgX3NldFRpbWVvdXQoYWZ0ZXJUaW1lb3V0LCBtcywgcmV0LCBtZXNzYWdlLCBtcyk7XG4gICAgcmV0dXJuIHJldC5jYW5jZWxsYWJsZSgpO1xufTtcblxufTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UsIElOVEVSTkFMKSB7XG52YXIgVEhJUyA9IHt9O1xudmFyIHV0aWwgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpO1xudmFyIG5vZGViYWNrRm9yUHJvbWlzZSA9IHJlcXVpcmUoXCIuL3Byb21pc2VfcmVzb2x2ZXIuanNcIilcbiAgICAuX25vZGViYWNrRm9yUHJvbWlzZTtcbnZhciB3aXRoQXBwZW5kZWQgPSB1dGlsLndpdGhBcHBlbmRlZDtcbnZhciBtYXliZVdyYXBBc0Vycm9yID0gdXRpbC5tYXliZVdyYXBBc0Vycm9yO1xudmFyIGNhbkV2YWx1YXRlID0gdXRpbC5jYW5FdmFsdWF0ZTtcbnZhciBUeXBlRXJyb3IgPSByZXF1aXJlKFwiLi9lcnJvcnNcIikuVHlwZUVycm9yO1xudmFyIGRlZmF1bHRTdWZmaXggPSBcIkFzeW5jXCI7XG52YXIgZGVmYXVsdEZpbHRlciA9IGZ1bmN0aW9uKG5hbWUsIGZ1bmMpIHtcbiAgICByZXR1cm4gdXRpbC5pc0lkZW50aWZpZXIobmFtZSkgJiZcbiAgICAgICAgbmFtZS5jaGFyQXQoMCkgIT09IFwiX1wiICYmXG4gICAgICAgICF1dGlsLmlzQ2xhc3MoZnVuYyk7XG59O1xudmFyIGRlZmF1bHRQcm9taXNpZmllZCA9IHtfX2lzUHJvbWlzaWZpZWRfXzogdHJ1ZX07XG5cblxuZnVuY3Rpb24gZXNjYXBlSWRlbnRSZWdleChzdHIpIHtcbiAgICByZXR1cm4gc3RyLnJlcGxhY2UoLyhbJF0pLywgXCJcXFxcJFwiKTtcbn1cblxuZnVuY3Rpb24gaXNQcm9taXNpZmllZChmbikge1xuICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBmbi5fX2lzUHJvbWlzaWZpZWRfXyA9PT0gdHJ1ZTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gaGFzUHJvbWlzaWZpZWQob2JqLCBrZXksIHN1ZmZpeCkge1xuICAgIHZhciB2YWwgPSB1dGlsLmdldERhdGFQcm9wZXJ0eU9yRGVmYXVsdChvYmosIGtleSArIHN1ZmZpeCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFByb21pc2lmaWVkKTtcbiAgICByZXR1cm4gdmFsID8gaXNQcm9taXNpZmllZCh2YWwpIDogZmFsc2U7XG59XG5mdW5jdGlvbiBjaGVja1ZhbGlkKHJldCwgc3VmZml4LCBzdWZmaXhSZWdleHApIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJldC5sZW5ndGg7IGkgKz0gMikge1xuICAgICAgICB2YXIga2V5ID0gcmV0W2ldO1xuICAgICAgICBpZiAoc3VmZml4UmVnZXhwLnRlc3Qoa2V5KSkge1xuICAgICAgICAgICAgdmFyIGtleVdpdGhvdXRBc3luY1N1ZmZpeCA9IGtleS5yZXBsYWNlKHN1ZmZpeFJlZ2V4cCwgXCJcIik7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHJldC5sZW5ndGg7IGogKz0gMikge1xuICAgICAgICAgICAgICAgIGlmIChyZXRbal0gPT09IGtleVdpdGhvdXRBc3luY1N1ZmZpeCkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IHByb21pc2lmeSBhbiBBUEkgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0aGF0IGhhcyBub3JtYWwgbWV0aG9kcyB3aXRoICdcIitzdWZmaXgrXCInLXN1ZmZpeFwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmZ1bmN0aW9uIHByb21pc2lmaWFibGVNZXRob2RzKG9iaiwgc3VmZml4LCBzdWZmaXhSZWdleHAsIGZpbHRlcikge1xuICAgIHZhciBrZXlzID0gdXRpbC5pbmhlcml0ZWREYXRhS2V5cyhvYmopO1xuICAgIHZhciByZXQgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgdmFyIGtleSA9IGtleXNbaV07XG4gICAgICAgIHZhciB2YWx1ZSA9IG9ialtrZXldO1xuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcImZ1bmN0aW9uXCIgJiZcbiAgICAgICAgICAgICFpc1Byb21pc2lmaWVkKHZhbHVlKSAmJlxuICAgICAgICAgICAgIWhhc1Byb21pc2lmaWVkKG9iaiwga2V5LCBzdWZmaXgpICYmXG4gICAgICAgICAgICBmaWx0ZXIoa2V5LCB2YWx1ZSwgb2JqKSkge1xuICAgICAgICAgICAgcmV0LnB1c2goa2V5LCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2hlY2tWYWxpZChyZXQsIHN1ZmZpeCwgc3VmZml4UmVnZXhwKTtcbiAgICByZXR1cm4gcmV0O1xufVxuXG5mdW5jdGlvbiBzd2l0Y2hDYXNlQXJndW1lbnRPcmRlcihsaWtlbHlBcmd1bWVudENvdW50KSB7XG4gICAgdmFyIHJldCA9IFtsaWtlbHlBcmd1bWVudENvdW50XTtcbiAgICB2YXIgbWluID0gTWF0aC5tYXgoMCwgbGlrZWx5QXJndW1lbnRDb3VudCAtIDEgLSA1KTtcbiAgICBmb3IodmFyIGkgPSBsaWtlbHlBcmd1bWVudENvdW50IC0gMTsgaSA+PSBtaW47IC0taSkge1xuICAgICAgICBpZiAoaSA9PT0gbGlrZWx5QXJndW1lbnRDb3VudCkgY29udGludWU7XG4gICAgICAgIHJldC5wdXNoKGkpO1xuICAgIH1cbiAgICBmb3IodmFyIGkgPSBsaWtlbHlBcmd1bWVudENvdW50ICsgMTsgaSA8PSA1OyArK2kpIHtcbiAgICAgICAgcmV0LnB1c2goaSk7XG4gICAgfVxuICAgIHJldHVybiByZXQ7XG59XG5cbmZ1bmN0aW9uIGFyZ3VtZW50U2VxdWVuY2UoYXJndW1lbnRDb3VudCkge1xuICAgIHJldHVybiB1dGlsLmZpbGxlZFJhbmdlKGFyZ3VtZW50Q291bnQsIFwiYXJndW1lbnRzW1wiLCBcIl1cIik7XG59XG5cbmZ1bmN0aW9uIHBhcmFtZXRlckRlY2xhcmF0aW9uKHBhcmFtZXRlckNvdW50KSB7XG4gICAgcmV0dXJuIHV0aWwuZmlsbGVkUmFuZ2UocGFyYW1ldGVyQ291bnQsIFwiX2FyZ1wiLCBcIlwiKTtcbn1cblxuZnVuY3Rpb24gcGFyYW1ldGVyQ291bnQoZm4pIHtcbiAgICBpZiAodHlwZW9mIGZuLmxlbmd0aCA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICByZXR1cm4gTWF0aC5tYXgoTWF0aC5taW4oZm4ubGVuZ3RoLCAxMDIzICsgMSksIDApO1xuICAgIH1cbiAgICByZXR1cm4gMDtcbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVQcm9wZXJ0eUFjY2VzcyhrZXkpIHtcbiAgICBpZiAodXRpbC5pc0lkZW50aWZpZXIoa2V5KSkge1xuICAgICAgICByZXR1cm4gXCIuXCIgKyBrZXk7XG4gICAgfVxuICAgIGVsc2UgcmV0dXJuIFwiWydcIiArIGtleS5yZXBsYWNlKC8oWydcXFxcXSkvZywgXCJcXFxcJDFcIikgKyBcIiddXCI7XG59XG5cbmZ1bmN0aW9uIG1ha2VOb2RlUHJvbWlzaWZpZWRFdmFsKGNhbGxiYWNrLCByZWNlaXZlciwgb3JpZ2luYWxOYW1lLCBmbiwgc3VmZml4KSB7XG4gICAgdmFyIG5ld1BhcmFtZXRlckNvdW50ID0gTWF0aC5tYXgoMCwgcGFyYW1ldGVyQ291bnQoZm4pIC0gMSk7XG4gICAgdmFyIGFyZ3VtZW50T3JkZXIgPSBzd2l0Y2hDYXNlQXJndW1lbnRPcmRlcihuZXdQYXJhbWV0ZXJDb3VudCk7XG4gICAgdmFyIGNhbGxiYWNrTmFtZSA9XG4gICAgICAgICh0eXBlb2Ygb3JpZ2luYWxOYW1lID09PSBcInN0cmluZ1wiICYmIHV0aWwuaXNJZGVudGlmaWVyKG9yaWdpbmFsTmFtZSlcbiAgICAgICAgICAgID8gb3JpZ2luYWxOYW1lICsgc3VmZml4XG4gICAgICAgICAgICA6IFwicHJvbWlzaWZpZWRcIik7XG5cbiAgICBmdW5jdGlvbiBnZW5lcmF0ZUNhbGxGb3JBcmd1bWVudENvdW50KGNvdW50KSB7XG4gICAgICAgIHZhciBhcmdzID0gYXJndW1lbnRTZXF1ZW5jZShjb3VudCkuam9pbihcIiwgXCIpO1xuICAgICAgICB2YXIgY29tbWEgPSBjb3VudCA+IDAgPyBcIiwgXCIgOiBcIlwiO1xuICAgICAgICB2YXIgcmV0O1xuICAgICAgICBpZiAodHlwZW9mIGNhbGxiYWNrID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICByZXQgPSBcIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgICAgIHRoaXMubWV0aG9kKGFyZ3MsIGZuKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgICAgIGJyZWFrOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgXCIucmVwbGFjZShcIi5tZXRob2RcIiwgZ2VuZXJhdGVQcm9wZXJ0eUFjY2VzcyhjYWxsYmFjaykpO1xuICAgICAgICB9IGVsc2UgaWYgKHJlY2VpdmVyID09PSBUSElTKSB7XG4gICAgICAgICAgICByZXQgPSAgXCIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgICAgIGNhbGxiYWNrLmNhbGwodGhpcywgYXJncywgZm4pOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgICAgIGJyZWFrOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgXCI7XG4gICAgICAgIH0gZWxzZSBpZiAocmVjZWl2ZXIgIT09IHZvaWQgMCkge1xuICAgICAgICAgICAgcmV0ID0gIFwiICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICAgICBjYWxsYmFjay5jYWxsKHJlY2VpdmVyLCBhcmdzLCBmbik7ICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICAgICBicmVhazsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIFwiO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0ID0gIFwiICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhhcmdzLCBmbik7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICAgICBicmVhazsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIFwiO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXQucmVwbGFjZShcImFyZ3NcIiwgYXJncykucmVwbGFjZShcIiwgXCIsIGNvbW1hKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZW5lcmF0ZUFyZ3VtZW50U3dpdGNoQ2FzZSgpIHtcbiAgICAgICAgdmFyIHJldCA9IFwiXCI7XG4gICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBhcmd1bWVudE9yZGVyLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICByZXQgKz0gXCJjYXNlIFwiICsgYXJndW1lbnRPcmRlcltpXSArXCI6XCIgK1xuICAgICAgICAgICAgICAgIGdlbmVyYXRlQ2FsbEZvckFyZ3VtZW50Q291bnQoYXJndW1lbnRPcmRlcltpXSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNvZGVGb3JDYWxsO1xuICAgICAgICBpZiAodHlwZW9mIGNhbGxiYWNrID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICBjb2RlRm9yQ2FsbCA9IFwiICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgICAgIHRoaXMucHJvcGVydHkuYXBwbHkodGhpcywgYXJncyk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgXCJcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcIi5wcm9wZXJ0eVwiLCBnZW5lcmF0ZVByb3BlcnR5QWNjZXNzKGNhbGxiYWNrKSk7XG4gICAgICAgIH0gZWxzZSBpZiAocmVjZWl2ZXIgPT09IFRISVMpIHtcbiAgICAgICAgICAgIGNvZGVGb3JDYWxsID0gXCIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAgICAgY2FsbGJhY2suYXBwbHkodGhpcywgYXJncyk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICBcIjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvZGVGb3JDYWxsID0gXCIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAgICAgY2FsbGJhY2suYXBwbHkocmVjZWl2ZXIsIGFyZ3MpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICBcIjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldCArPSBcIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICBkZWZhdWx0OiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkobGVuICsgMSk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgdmFyIGkgPSAwOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47ICsraSkgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgICAgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgYXJnc1tpXSA9IGZuOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgW0NvZGVGb3JDYWxsXSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgYnJlYWs7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICBcIi5yZXBsYWNlKFwiW0NvZGVGb3JDYWxsXVwiLCBjb2RlRm9yQ2FsbCk7XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5ldyBGdW5jdGlvbihcIlByb21pc2VcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY2FsbGJhY2tcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmVjZWl2ZXJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwid2l0aEFwcGVuZGVkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm1heWJlV3JhcEFzRXJyb3JcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibm9kZWJhY2tGb3JQcm9taXNlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIklOVEVSTkFMXCIsXCIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgIHZhciByZXQgPSBmdW5jdGlvbiBGdW5jdGlvbk5hbWUoUGFyYW1ldGVycykgeyAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAndXNlIHN0cmljdCc7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKElOVEVSTkFMKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICBwcm9taXNlLl9zZXRUcmFjZSh2b2lkIDApOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICB2YXIgZm4gPSBub2RlYmFja0ZvclByb21pc2UocHJvbWlzZSk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICB0cnkgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAgICAgc3dpdGNoKGxlbikgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAgICAgICAgIFtDb2RlRm9yU3dpdGNoQ2FzZV0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAgICAgdmFyIHdyYXBwZWQgPSBtYXliZVdyYXBBc0Vycm9yKGUpOyAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAgICAgcHJvbWlzZS5fYXR0YWNoRXh0cmFUcmFjZSh3cmFwcGVkKTsgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAgICAgcHJvbWlzZS5fcmVqZWN0KHdyYXBwZWQpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICB9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICByZXR1cm4gcHJvbWlzZTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgIH07ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgIHJldC5fX2lzUHJvbWlzaWZpZWRfXyA9IHRydWU7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgIHJldHVybiByZXQ7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgIFwiXG4gICAgICAgIC5yZXBsYWNlKFwiRnVuY3Rpb25OYW1lXCIsIGNhbGxiYWNrTmFtZSlcbiAgICAgICAgLnJlcGxhY2UoXCJQYXJhbWV0ZXJzXCIsIHBhcmFtZXRlckRlY2xhcmF0aW9uKG5ld1BhcmFtZXRlckNvdW50KSlcbiAgICAgICAgLnJlcGxhY2UoXCJbQ29kZUZvclN3aXRjaENhc2VdXCIsIGdlbmVyYXRlQXJndW1lbnRTd2l0Y2hDYXNlKCkpKShcbiAgICAgICAgICAgIFByb21pc2UsXG4gICAgICAgICAgICBjYWxsYmFjayxcbiAgICAgICAgICAgIHJlY2VpdmVyLFxuICAgICAgICAgICAgd2l0aEFwcGVuZGVkLFxuICAgICAgICAgICAgbWF5YmVXcmFwQXNFcnJvcixcbiAgICAgICAgICAgIG5vZGViYWNrRm9yUHJvbWlzZSxcbiAgICAgICAgICAgIElOVEVSTkFMXG4gICAgICAgICk7XG59XG5cbmZ1bmN0aW9uIG1ha2VOb2RlUHJvbWlzaWZpZWRDbG9zdXJlKGNhbGxiYWNrLCByZWNlaXZlcikge1xuICAgIGZ1bmN0aW9uIHByb21pc2lmaWVkKCkge1xuICAgICAgICB2YXIgX3JlY2VpdmVyID0gcmVjZWl2ZXI7XG4gICAgICAgIGlmIChyZWNlaXZlciA9PT0gVEhJUykgX3JlY2VpdmVyID0gdGhpcztcbiAgICAgICAgaWYgKHR5cGVvZiBjYWxsYmFjayA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgY2FsbGJhY2sgPSBfcmVjZWl2ZXJbY2FsbGJhY2tdO1xuICAgICAgICB9XG4gICAgICAgIHZhciBwcm9taXNlID0gbmV3IFByb21pc2UoSU5URVJOQUwpO1xuICAgICAgICBwcm9taXNlLl9zZXRUcmFjZSh2b2lkIDApO1xuICAgICAgICB2YXIgZm4gPSBub2RlYmFja0ZvclByb21pc2UocHJvbWlzZSk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjYWxsYmFjay5hcHBseShfcmVjZWl2ZXIsIHdpdGhBcHBlbmRlZChhcmd1bWVudHMsIGZuKSk7XG4gICAgICAgIH0gY2F0Y2goZSkge1xuICAgICAgICAgICAgdmFyIHdyYXBwZWQgPSBtYXliZVdyYXBBc0Vycm9yKGUpO1xuICAgICAgICAgICAgcHJvbWlzZS5fYXR0YWNoRXh0cmFUcmFjZSh3cmFwcGVkKTtcbiAgICAgICAgICAgIHByb21pc2UuX3JlamVjdCh3cmFwcGVkKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICB9XG4gICAgcHJvbWlzaWZpZWQuX19pc1Byb21pc2lmaWVkX18gPSB0cnVlO1xuICAgIHJldHVybiBwcm9taXNpZmllZDtcbn1cblxudmFyIG1ha2VOb2RlUHJvbWlzaWZpZWQgPSBjYW5FdmFsdWF0ZVxuICAgID8gbWFrZU5vZGVQcm9taXNpZmllZEV2YWxcbiAgICA6IG1ha2VOb2RlUHJvbWlzaWZpZWRDbG9zdXJlO1xuXG5mdW5jdGlvbiBwcm9taXNpZnlBbGwob2JqLCBzdWZmaXgsIGZpbHRlciwgcHJvbWlzaWZpZXIpIHtcbiAgICB2YXIgc3VmZml4UmVnZXhwID0gbmV3IFJlZ0V4cChlc2NhcGVJZGVudFJlZ2V4KHN1ZmZpeCkgKyBcIiRcIik7XG4gICAgdmFyIG1ldGhvZHMgPVxuICAgICAgICBwcm9taXNpZmlhYmxlTWV0aG9kcyhvYmosIHN1ZmZpeCwgc3VmZml4UmVnZXhwLCBmaWx0ZXIpO1xuXG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IG1ldGhvZHMubGVuZ3RoOyBpIDwgbGVuOyBpKz0gMikge1xuICAgICAgICB2YXIga2V5ID0gbWV0aG9kc1tpXTtcbiAgICAgICAgdmFyIGZuID0gbWV0aG9kc1tpKzFdO1xuICAgICAgICB2YXIgcHJvbWlzaWZpZWRLZXkgPSBrZXkgKyBzdWZmaXg7XG4gICAgICAgIG9ialtwcm9taXNpZmllZEtleV0gPSBwcm9taXNpZmllciA9PT0gbWFrZU5vZGVQcm9taXNpZmllZFxuICAgICAgICAgICAgICAgID8gbWFrZU5vZGVQcm9taXNpZmllZChrZXksIFRISVMsIGtleSwgZm4sIHN1ZmZpeClcbiAgICAgICAgICAgICAgICA6IHByb21pc2lmaWVyKGZuKTtcbiAgICB9XG4gICAgdXRpbC50b0Zhc3RQcm9wZXJ0aWVzKG9iaik7XG4gICAgcmV0dXJuIG9iajtcbn1cblxuZnVuY3Rpb24gcHJvbWlzaWZ5KGNhbGxiYWNrLCByZWNlaXZlcikge1xuICAgIHJldHVybiBtYWtlTm9kZVByb21pc2lmaWVkKGNhbGxiYWNrLCByZWNlaXZlciwgdm9pZCAwLCBjYWxsYmFjayk7XG59XG5cblByb21pc2UucHJvbWlzaWZ5ID0gZnVuY3Rpb24gUHJvbWlzZSRQcm9taXNpZnkoZm4sIHJlY2VpdmVyKSB7XG4gICAgaWYgKHR5cGVvZiBmbiAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJmbiBtdXN0IGJlIGEgZnVuY3Rpb25cIik7XG4gICAgfVxuICAgIGlmIChpc1Byb21pc2lmaWVkKGZuKSkge1xuICAgICAgICByZXR1cm4gZm47XG4gICAgfVxuICAgIHJldHVybiBwcm9taXNpZnkoZm4sIGFyZ3VtZW50cy5sZW5ndGggPCAyID8gVEhJUyA6IHJlY2VpdmVyKTtcbn07XG5cblByb21pc2UucHJvbWlzaWZ5QWxsID0gZnVuY3Rpb24gUHJvbWlzZSRQcm9taXNpZnlBbGwodGFyZ2V0LCBvcHRpb25zKSB7XG4gICAgaWYgKHR5cGVvZiB0YXJnZXQgIT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgdGFyZ2V0ICE9PSBcIm9iamVjdFwiKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJ0aGUgdGFyZ2V0IG9mIHByb21pc2lmeUFsbCBtdXN0IGJlIGFuIG9iamVjdCBvciBhIGZ1bmN0aW9uXCIpO1xuICAgIH1cbiAgICBvcHRpb25zID0gT2JqZWN0KG9wdGlvbnMpO1xuICAgIHZhciBzdWZmaXggPSBvcHRpb25zLnN1ZmZpeDtcbiAgICBpZiAodHlwZW9mIHN1ZmZpeCAhPT0gXCJzdHJpbmdcIikgc3VmZml4ID0gZGVmYXVsdFN1ZmZpeDtcbiAgICB2YXIgZmlsdGVyID0gb3B0aW9ucy5maWx0ZXI7XG4gICAgaWYgKHR5cGVvZiBmaWx0ZXIgIT09IFwiZnVuY3Rpb25cIikgZmlsdGVyID0gZGVmYXVsdEZpbHRlcjtcbiAgICB2YXIgcHJvbWlzaWZpZXIgPSBvcHRpb25zLnByb21pc2lmaWVyO1xuICAgIGlmICh0eXBlb2YgcHJvbWlzaWZpZXIgIT09IFwiZnVuY3Rpb25cIikgcHJvbWlzaWZpZXIgPSBtYWtlTm9kZVByb21pc2lmaWVkO1xuXG4gICAgaWYgKCF1dGlsLmlzSWRlbnRpZmllcihzdWZmaXgpKSB7XG4gICAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKFwic3VmZml4IG11c3QgYmUgYSB2YWxpZCBpZGVudGlmaWVyXCIpO1xuICAgIH1cblxuICAgIHZhciBrZXlzID0gdXRpbC5pbmhlcml0ZWREYXRhS2V5cyh0YXJnZXQsIHtpbmNsdWRlSGlkZGVuOiB0cnVlfSk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IHRhcmdldFtrZXlzW2ldXTtcbiAgICAgICAgaWYgKGtleXNbaV0gIT09IFwiY29uc3RydWN0b3JcIiAmJlxuICAgICAgICAgICAgdXRpbC5pc0NsYXNzKHZhbHVlKSkge1xuICAgICAgICAgICAgcHJvbWlzaWZ5QWxsKHZhbHVlLnByb3RvdHlwZSwgc3VmZml4LCBmaWx0ZXIsIHByb21pc2lmaWVyKTtcbiAgICAgICAgICAgIHByb21pc2lmeUFsbCh2YWx1ZSwgc3VmZml4LCBmaWx0ZXIsIHByb21pc2lmaWVyKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBwcm9taXNpZnlBbGwodGFyZ2V0LCBzdWZmaXgsIGZpbHRlciwgcHJvbWlzaWZpZXIpO1xufTtcbn07XG5cbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UsIFByb21pc2VBcnJheSwgY2FzdCkge1xudmFyIHV0aWwgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpO1xudmFyIGFwaVJlamVjdGlvbiA9IHJlcXVpcmUoXCIuL2Vycm9yc19hcGlfcmVqZWN0aW9uXCIpKFByb21pc2UpO1xudmFyIGlzT2JqZWN0ID0gdXRpbC5pc09iamVjdDtcbnZhciBlczUgPSByZXF1aXJlKFwiLi9lczUuanNcIik7XG5cbmZ1bmN0aW9uIFByb3BlcnRpZXNQcm9taXNlQXJyYXkob2JqKSB7XG4gICAgdmFyIGtleXMgPSBlczUua2V5cyhvYmopO1xuICAgIHZhciBsZW4gPSBrZXlzLmxlbmd0aDtcbiAgICB2YXIgdmFsdWVzID0gbmV3IEFycmF5KGxlbiAqIDIpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyArK2kpIHtcbiAgICAgICAgdmFyIGtleSA9IGtleXNbaV07XG4gICAgICAgIHZhbHVlc1tpXSA9IG9ialtrZXldO1xuICAgICAgICB2YWx1ZXNbaSArIGxlbl0gPSBrZXk7XG4gICAgfVxuICAgIHRoaXMuY29uc3RydWN0b3IkKHZhbHVlcyk7XG59XG51dGlsLmluaGVyaXRzKFByb3BlcnRpZXNQcm9taXNlQXJyYXksIFByb21pc2VBcnJheSk7XG5cblByb3BlcnRpZXNQcm9taXNlQXJyYXkucHJvdG90eXBlLl9pbml0ID1cbmZ1bmN0aW9uIFByb3BlcnRpZXNQcm9taXNlQXJyYXkkX2luaXQoKSB7XG4gICAgdGhpcy5faW5pdCQodm9pZCAwLCAtMykgO1xufTtcblxuUHJvcGVydGllc1Byb21pc2VBcnJheS5wcm90b3R5cGUuX3Byb21pc2VGdWxmaWxsZWQgPVxuZnVuY3Rpb24gUHJvcGVydGllc1Byb21pc2VBcnJheSRfcHJvbWlzZUZ1bGZpbGxlZCh2YWx1ZSwgaW5kZXgpIHtcbiAgICBpZiAodGhpcy5faXNSZXNvbHZlZCgpKSByZXR1cm47XG4gICAgdGhpcy5fdmFsdWVzW2luZGV4XSA9IHZhbHVlO1xuICAgIHZhciB0b3RhbFJlc29sdmVkID0gKyt0aGlzLl90b3RhbFJlc29sdmVkO1xuICAgIGlmICh0b3RhbFJlc29sdmVkID49IHRoaXMuX2xlbmd0aCkge1xuICAgICAgICB2YXIgdmFsID0ge307XG4gICAgICAgIHZhciBrZXlPZmZzZXQgPSB0aGlzLmxlbmd0aCgpO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gdGhpcy5sZW5ndGgoKTsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgICAgICB2YWxbdGhpcy5fdmFsdWVzW2kgKyBrZXlPZmZzZXRdXSA9IHRoaXMuX3ZhbHVlc1tpXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9yZXNvbHZlKHZhbCk7XG4gICAgfVxufTtcblxuUHJvcGVydGllc1Byb21pc2VBcnJheS5wcm90b3R5cGUuX3Byb21pc2VQcm9ncmVzc2VkID1cbmZ1bmN0aW9uIFByb3BlcnRpZXNQcm9taXNlQXJyYXkkX3Byb21pc2VQcm9ncmVzc2VkKHZhbHVlLCBpbmRleCkge1xuICAgIGlmICh0aGlzLl9pc1Jlc29sdmVkKCkpIHJldHVybjtcblxuICAgIHRoaXMuX3Byb21pc2UuX3Byb2dyZXNzKHtcbiAgICAgICAga2V5OiB0aGlzLl92YWx1ZXNbaW5kZXggKyB0aGlzLmxlbmd0aCgpXSxcbiAgICAgICAgdmFsdWU6IHZhbHVlXG4gICAgfSk7XG59O1xuXG5Qcm9wZXJ0aWVzUHJvbWlzZUFycmF5LnByb3RvdHlwZS5zaG91bGRDb3B5VmFsdWVzID1cbmZ1bmN0aW9uIFByb3BlcnRpZXNQcm9taXNlQXJyYXkkX3Nob3VsZENvcHlWYWx1ZXMoKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xufTtcblxuUHJvcGVydGllc1Byb21pc2VBcnJheS5wcm90b3R5cGUuZ2V0QWN0dWFsTGVuZ3RoID1cbmZ1bmN0aW9uIFByb3BlcnRpZXNQcm9taXNlQXJyYXkkZ2V0QWN0dWFsTGVuZ3RoKGxlbikge1xuICAgIHJldHVybiBsZW4gPj4gMTtcbn07XG5cbmZ1bmN0aW9uIFByb21pc2UkX1Byb3BzKHByb21pc2VzKSB7XG4gICAgdmFyIHJldDtcbiAgICB2YXIgY2FzdFZhbHVlID0gY2FzdChwcm9taXNlcywgdm9pZCAwKTtcblxuICAgIGlmICghaXNPYmplY3QoY2FzdFZhbHVlKSkge1xuICAgICAgICByZXR1cm4gYXBpUmVqZWN0aW9uKFwiY2Fubm90IGF3YWl0IHByb3BlcnRpZXMgb2YgYSBub24tb2JqZWN0XCIpO1xuICAgIH0gZWxzZSBpZiAoY2FzdFZhbHVlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICByZXQgPSBjYXN0VmFsdWUuX3RoZW4oUHJvbWlzZS5wcm9wcywgdm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgdm9pZCAwKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXQgPSBuZXcgUHJvcGVydGllc1Byb21pc2VBcnJheShjYXN0VmFsdWUpLnByb21pc2UoKTtcbiAgICB9XG5cbiAgICBpZiAoY2FzdFZhbHVlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICByZXQuX3Byb3BhZ2F0ZUZyb20oY2FzdFZhbHVlLCA0KTtcbiAgICB9XG4gICAgcmV0dXJuIHJldDtcbn1cblxuUHJvbWlzZS5wcm90b3R5cGUucHJvcHMgPSBmdW5jdGlvbiBQcm9taXNlJHByb3BzKCkge1xuICAgIHJldHVybiBQcm9taXNlJF9Qcm9wcyh0aGlzKTtcbn07XG5cblByb21pc2UucHJvcHMgPSBmdW5jdGlvbiBQcm9taXNlJFByb3BzKHByb21pc2VzKSB7XG4gICAgcmV0dXJuIFByb21pc2UkX1Byb3BzKHByb21pc2VzKTtcbn07XG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG52YXIgaXNFUzUgPSAoZnVuY3Rpb24oKXtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICByZXR1cm4gdGhpcyA9PT0gdm9pZCAwO1xufSkoKTtcblxuaWYgKGlzRVM1KSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSB7XG4gICAgICAgIGZyZWV6ZTogT2JqZWN0LmZyZWV6ZSxcbiAgICAgICAgZGVmaW5lUHJvcGVydHk6IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSxcbiAgICAgICAga2V5czogT2JqZWN0LmtleXMsXG4gICAgICAgIGdldFByb3RvdHlwZU9mOiBPYmplY3QuZ2V0UHJvdG90eXBlT2YsXG4gICAgICAgIGlzQXJyYXk6IEFycmF5LmlzQXJyYXksXG4gICAgICAgIGlzRVM1OiBpc0VTNVxuICAgIH07XG59IGVsc2Uge1xuICAgIHZhciBoYXMgPSB7fS5oYXNPd25Qcm9wZXJ0eTtcbiAgICB2YXIgc3RyID0ge30udG9TdHJpbmc7XG4gICAgdmFyIHByb3RvID0ge30uY29uc3RydWN0b3IucHJvdG90eXBlO1xuXG4gICAgdmFyIE9iamVjdEtleXMgPSBmdW5jdGlvbiBPYmplY3RLZXlzKG8pIHtcbiAgICAgICAgdmFyIHJldCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBrZXkgaW4gbykge1xuICAgICAgICAgICAgaWYgKGhhcy5jYWxsKG8sIGtleSkpIHtcbiAgICAgICAgICAgICAgICByZXQucHVzaChrZXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgfVxuXG4gICAgdmFyIE9iamVjdERlZmluZVByb3BlcnR5ID0gZnVuY3Rpb24gT2JqZWN0RGVmaW5lUHJvcGVydHkobywga2V5LCBkZXNjKSB7XG4gICAgICAgIG9ba2V5XSA9IGRlc2MudmFsdWU7XG4gICAgICAgIHJldHVybiBvO1xuICAgIH1cblxuICAgIHZhciBPYmplY3RGcmVlemUgPSBmdW5jdGlvbiBPYmplY3RGcmVlemUob2JqKSB7XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgfVxuXG4gICAgdmFyIE9iamVjdEdldFByb3RvdHlwZU9mID0gZnVuY3Rpb24gT2JqZWN0R2V0UHJvdG90eXBlT2Yob2JqKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gT2JqZWN0KG9iaikuY29uc3RydWN0b3IucHJvdG90eXBlO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICByZXR1cm4gcHJvdG87XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgQXJyYXlJc0FycmF5ID0gZnVuY3Rpb24gQXJyYXlJc0FycmF5KG9iaikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIHN0ci5jYWxsKG9iaikgPT09IFwiW29iamVjdCBBcnJheV1cIjtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaChlKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBtb2R1bGUuZXhwb3J0cyA9IHtcbiAgICAgICAgaXNBcnJheTogQXJyYXlJc0FycmF5LFxuICAgICAgICBrZXlzOiBPYmplY3RLZXlzLFxuICAgICAgICBkZWZpbmVQcm9wZXJ0eTogT2JqZWN0RGVmaW5lUHJvcGVydHksXG4gICAgICAgIGZyZWV6ZTogT2JqZWN0RnJlZXplLFxuICAgICAgICBnZXRQcm90b3R5cGVPZjogT2JqZWN0R2V0UHJvdG90eXBlT2YsXG4gICAgICAgIGlzRVM1OiBpc0VTNVxuICAgIH07XG59XG4iLCIoZnVuY3Rpb24ocHJvY2Vzcyl7LyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbnZhciBzY2hlZHVsZTtcbnZhciBfTXV0YXRpb25PYnNlcnZlcjtcbmlmICh0eXBlb2YgcHJvY2VzcyA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgcHJvY2Vzcy52ZXJzaW9uID09PSBcInN0cmluZ1wiKSB7XG4gICAgc2NoZWR1bGUgPSBmdW5jdGlvbiBQcm9taXNlJF9TY2hlZHVsZXIoZm4pIHtcbiAgICAgICAgcHJvY2Vzcy5uZXh0VGljayhmbik7XG4gICAgfTtcbn1cbmVsc2UgaWYgKCh0eXBlb2YgTXV0YXRpb25PYnNlcnZlciAhPT0gXCJ1bmRlZmluZWRcIiAmJlxuICAgICAgICAgKF9NdXRhdGlvbk9ic2VydmVyID0gTXV0YXRpb25PYnNlcnZlcikpIHx8XG4gICAgICAgICAodHlwZW9mIFdlYktpdE11dGF0aW9uT2JzZXJ2ZXIgIT09IFwidW5kZWZpbmVkXCIgJiZcbiAgICAgICAgIChfTXV0YXRpb25PYnNlcnZlciA9IFdlYktpdE11dGF0aW9uT2JzZXJ2ZXIpKSkge1xuICAgIHNjaGVkdWxlID0gKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgdmFyIHF1ZXVlZEZuID0gdm9pZCAwO1xuICAgICAgICB2YXIgb2JzZXJ2ZXIgPSBuZXcgX011dGF0aW9uT2JzZXJ2ZXIoXG4gICAgICAgICAgICBmdW5jdGlvbiBQcm9taXNlJF9TY2hlZHVsZXIoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZuID0gcXVldWVkRm47XG4gICAgICAgICAgICAgICAgcXVldWVkRm4gPSB2b2lkIDA7XG4gICAgICAgICAgICAgICAgZm4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICApO1xuICAgICAgICBvYnNlcnZlci5vYnNlcnZlKGRpdiwge1xuICAgICAgICAgICAgYXR0cmlidXRlczogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIFByb21pc2UkX1NjaGVkdWxlcihmbikge1xuICAgICAgICAgICAgcXVldWVkRm4gPSBmbjtcbiAgICAgICAgICAgIGRpdi5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcImZvb1wiKTtcbiAgICAgICAgfTtcblxuICAgIH0pKCk7XG59XG5lbHNlIGlmICh0eXBlb2Ygc2V0VGltZW91dCAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIHNjaGVkdWxlID0gZnVuY3Rpb24gUHJvbWlzZSRfU2NoZWR1bGVyKGZuKSB7XG4gICAgICAgIHNldFRpbWVvdXQoZm4sIDApO1xuICAgIH07XG59XG5lbHNlIHRocm93IG5ldyBFcnJvcihcIm5vIGFzeW5jIHNjaGVkdWxlciBhdmFpbGFibGVcIik7XG5tb2R1bGUuZXhwb3J0cyA9IHNjaGVkdWxlO1xuXG59KShyZXF1aXJlKFwiX19icm93c2VyaWZ5X3Byb2Nlc3NcIikpIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbmZ1bmN0aW9uIGFycmF5Q29weShzcmMsIHNyY0luZGV4LCBkc3QsIGRzdEluZGV4LCBsZW4pIHtcbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IGxlbjsgKytqKSB7XG4gICAgICAgIGRzdFtqICsgZHN0SW5kZXhdID0gc3JjW2ogKyBzcmNJbmRleF07XG4gICAgfVxufVxuXG5mdW5jdGlvbiBRdWV1ZShjYXBhY2l0eSkge1xuICAgIHRoaXMuX2NhcGFjaXR5ID0gY2FwYWNpdHk7XG4gICAgdGhpcy5fbGVuZ3RoID0gMDtcbiAgICB0aGlzLl9mcm9udCA9IDA7XG4gICAgdGhpcy5fbWFrZUNhcGFjaXR5KCk7XG59XG5cblF1ZXVlLnByb3RvdHlwZS5fd2lsbEJlT3ZlckNhcGFjaXR5ID1cbmZ1bmN0aW9uIFF1ZXVlJF93aWxsQmVPdmVyQ2FwYWNpdHkoc2l6ZSkge1xuICAgIHJldHVybiB0aGlzLl9jYXBhY2l0eSA8IHNpemU7XG59O1xuXG5RdWV1ZS5wcm90b3R5cGUuX3B1c2hPbmUgPSBmdW5jdGlvbiBRdWV1ZSRfcHVzaE9uZShhcmcpIHtcbiAgICB2YXIgbGVuZ3RoID0gdGhpcy5sZW5ndGgoKTtcbiAgICB0aGlzLl9jaGVja0NhcGFjaXR5KGxlbmd0aCArIDEpO1xuICAgIHZhciBpID0gKHRoaXMuX2Zyb250ICsgbGVuZ3RoKSAmICh0aGlzLl9jYXBhY2l0eSAtIDEpO1xuICAgIHRoaXNbaV0gPSBhcmc7XG4gICAgdGhpcy5fbGVuZ3RoID0gbGVuZ3RoICsgMTtcbn07XG5cblF1ZXVlLnByb3RvdHlwZS5wdXNoID0gZnVuY3Rpb24gUXVldWUkcHVzaChmbiwgcmVjZWl2ZXIsIGFyZykge1xuICAgIHZhciBsZW5ndGggPSB0aGlzLmxlbmd0aCgpICsgMztcbiAgICBpZiAodGhpcy5fd2lsbEJlT3ZlckNhcGFjaXR5KGxlbmd0aCkpIHtcbiAgICAgICAgdGhpcy5fcHVzaE9uZShmbik7XG4gICAgICAgIHRoaXMuX3B1c2hPbmUocmVjZWl2ZXIpO1xuICAgICAgICB0aGlzLl9wdXNoT25lKGFyZyk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIGogPSB0aGlzLl9mcm9udCArIGxlbmd0aCAtIDM7XG4gICAgdGhpcy5fY2hlY2tDYXBhY2l0eShsZW5ndGgpO1xuICAgIHZhciB3cmFwTWFzayA9IHRoaXMuX2NhcGFjaXR5IC0gMTtcbiAgICB0aGlzWyhqICsgMCkgJiB3cmFwTWFza10gPSBmbjtcbiAgICB0aGlzWyhqICsgMSkgJiB3cmFwTWFza10gPSByZWNlaXZlcjtcbiAgICB0aGlzWyhqICsgMikgJiB3cmFwTWFza10gPSBhcmc7XG4gICAgdGhpcy5fbGVuZ3RoID0gbGVuZ3RoO1xufTtcblxuUXVldWUucHJvdG90eXBlLnNoaWZ0ID0gZnVuY3Rpb24gUXVldWUkc2hpZnQoKSB7XG4gICAgdmFyIGZyb250ID0gdGhpcy5fZnJvbnQsXG4gICAgICAgIHJldCA9IHRoaXNbZnJvbnRdO1xuXG4gICAgdGhpc1tmcm9udF0gPSB2b2lkIDA7XG4gICAgdGhpcy5fZnJvbnQgPSAoZnJvbnQgKyAxKSAmICh0aGlzLl9jYXBhY2l0eSAtIDEpO1xuICAgIHRoaXMuX2xlbmd0aC0tO1xuICAgIHJldHVybiByZXQ7XG59O1xuXG5RdWV1ZS5wcm90b3R5cGUubGVuZ3RoID0gZnVuY3Rpb24gUXVldWUkbGVuZ3RoKCkge1xuICAgIHJldHVybiB0aGlzLl9sZW5ndGg7XG59O1xuXG5RdWV1ZS5wcm90b3R5cGUuX21ha2VDYXBhY2l0eSA9IGZ1bmN0aW9uIFF1ZXVlJF9tYWtlQ2FwYWNpdHkoKSB7XG4gICAgdmFyIGxlbiA9IHRoaXMuX2NhcGFjaXR5O1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyArK2kpIHtcbiAgICAgICAgdGhpc1tpXSA9IHZvaWQgMDtcbiAgICB9XG59O1xuXG5RdWV1ZS5wcm90b3R5cGUuX2NoZWNrQ2FwYWNpdHkgPSBmdW5jdGlvbiBRdWV1ZSRfY2hlY2tDYXBhY2l0eShzaXplKSB7XG4gICAgaWYgKHRoaXMuX2NhcGFjaXR5IDwgc2l6ZSkge1xuICAgICAgICB0aGlzLl9yZXNpemVUbyh0aGlzLl9jYXBhY2l0eSA8PCAzKTtcbiAgICB9XG59O1xuXG5RdWV1ZS5wcm90b3R5cGUuX3Jlc2l6ZVRvID0gZnVuY3Rpb24gUXVldWUkX3Jlc2l6ZVRvKGNhcGFjaXR5KSB7XG4gICAgdmFyIG9sZEZyb250ID0gdGhpcy5fZnJvbnQ7XG4gICAgdmFyIG9sZENhcGFjaXR5ID0gdGhpcy5fY2FwYWNpdHk7XG4gICAgdmFyIG9sZFF1ZXVlID0gbmV3IEFycmF5KG9sZENhcGFjaXR5KTtcbiAgICB2YXIgbGVuZ3RoID0gdGhpcy5sZW5ndGgoKTtcblxuICAgIGFycmF5Q29weSh0aGlzLCAwLCBvbGRRdWV1ZSwgMCwgb2xkQ2FwYWNpdHkpO1xuICAgIHRoaXMuX2NhcGFjaXR5ID0gY2FwYWNpdHk7XG4gICAgdGhpcy5fbWFrZUNhcGFjaXR5KCk7XG4gICAgdGhpcy5fZnJvbnQgPSAwO1xuICAgIGlmIChvbGRGcm9udCArIGxlbmd0aCA8PSBvbGRDYXBhY2l0eSkge1xuICAgICAgICBhcnJheUNvcHkob2xkUXVldWUsIG9sZEZyb250LCB0aGlzLCAwLCBsZW5ndGgpO1xuICAgIH0gZWxzZSB7ICAgICAgICB2YXIgbGVuZ3RoQmVmb3JlV3JhcHBpbmcgPVxuICAgICAgICAgICAgbGVuZ3RoIC0gKChvbGRGcm9udCArIGxlbmd0aCkgJiAob2xkQ2FwYWNpdHkgLSAxKSk7XG5cbiAgICAgICAgYXJyYXlDb3B5KG9sZFF1ZXVlLCBvbGRGcm9udCwgdGhpcywgMCwgbGVuZ3RoQmVmb3JlV3JhcHBpbmcpO1xuICAgICAgICBhcnJheUNvcHkob2xkUXVldWUsIDAsIHRoaXMsIGxlbmd0aEJlZm9yZVdyYXBwaW5nLFxuICAgICAgICAgICAgICAgICAgICBsZW5ndGggLSBsZW5ndGhCZWZvcmVXcmFwcGluZyk7XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBRdWV1ZTtcbiJdfQ==
;